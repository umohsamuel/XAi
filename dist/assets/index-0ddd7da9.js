var _k=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var CCe=_k((is,ns)=>{function bk(e,t){for(var i=0;i<t.length;i++){const n=t[i];if(typeof n!="string"&&!Array.isArray(n)){for(const r in n)if(r!=="default"&&!(r in e)){const s=Object.getOwnPropertyDescriptor(n,r);s&&Object.defineProperty(e,r,s.get?s:{enumerable:!0,get:()=>n[r]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function i(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=i(r);fetch(r.href,s)}})();function wk(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var LL={exports:{}},Tx={},RL={exports:{}},Ft={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j0=Symbol.for("react.element"),Sk=Symbol.for("react.portal"),Mk=Symbol.for("react.fragment"),Ck=Symbol.for("react.strict_mode"),Ek=Symbol.for("react.profiler"),Ak=Symbol.for("react.provider"),Tk=Symbol.for("react.context"),Pk=Symbol.for("react.forward_ref"),Dk=Symbol.for("react.suspense"),Lk=Symbol.for("react.memo"),Rk=Symbol.for("react.lazy"),l4=Symbol.iterator;function Ik(e){return e===null||typeof e!="object"?null:(e=l4&&e[l4]||e["@@iterator"],typeof e=="function"?e:null)}var IL={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},OL=Object.assign,BL={};function Fp(e,t,i){this.props=e,this.context=t,this.refs=BL,this.updater=i||IL}Fp.prototype.isReactComponent={};Fp.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Fp.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function NL(){}NL.prototype=Fp.prototype;function JM(e,t,i){this.props=e,this.context=t,this.refs=BL,this.updater=i||IL}var eC=JM.prototype=new NL;eC.constructor=JM;OL(eC,Fp.prototype);eC.isPureReactComponent=!0;var c4=Array.isArray,UL=Object.prototype.hasOwnProperty,tC={current:null},FL={key:!0,ref:!0,__self:!0,__source:!0};function zL(e,t,i){var n,r={},s=null,a=null;if(t!=null)for(n in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)UL.call(t,n)&&!FL.hasOwnProperty(n)&&(r[n]=t[n]);var o=arguments.length-2;if(o===1)r.children=i;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];r.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)r[n]===void 0&&(r[n]=o[n]);return{$$typeof:j0,type:e,key:s,ref:a,props:r,_owner:tC.current}}function Ok(e,t){return{$$typeof:j0,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function iC(e){return typeof e=="object"&&e!==null&&e.$$typeof===j0}function Bk(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(i){return t[i]})}var h4=/\/+/g;function U2(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Bk(""+e.key):t.toString(36)}function wv(e,t,i,n,r){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case j0:case Sk:a=!0}}if(a)return a=e,r=r(a),e=n===""?"."+U2(a,0):n,c4(r)?(i="",e!=null&&(i=e.replace(h4,"$&/")+"/"),wv(r,t,i,"",function(c){return c})):r!=null&&(iC(r)&&(r=Ok(r,i+(!r.key||a&&a.key===r.key?"":(""+r.key).replace(h4,"$&/")+"/")+e)),t.push(r)),1;if(a=0,n=n===""?".":n+":",c4(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+U2(s,o);a+=wv(s,t,i,l,r)}else if(l=Ik(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+U2(s,o++),a+=wv(s,t,i,l,r);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function vg(e,t,i){if(e==null)return e;var n=[],r=0;return wv(e,n,"","",function(s){return t.call(i,s,r++)}),n}function Nk(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(i){(e._status===0||e._status===-1)&&(e._status=1,e._result=i)},function(i){(e._status===0||e._status===-1)&&(e._status=2,e._result=i)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var vr={current:null},Sv={transition:null},Uk={ReactCurrentDispatcher:vr,ReactCurrentBatchConfig:Sv,ReactCurrentOwner:tC};Ft.Children={map:vg,forEach:function(e,t,i){vg(e,function(){t.apply(this,arguments)},i)},count:function(e){var t=0;return vg(e,function(){t++}),t},toArray:function(e){return vg(e,function(t){return t})||[]},only:function(e){if(!iC(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ft.Component=Fp;Ft.Fragment=Mk;Ft.Profiler=Ek;Ft.PureComponent=JM;Ft.StrictMode=Ck;Ft.Suspense=Dk;Ft.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Uk;Ft.cloneElement=function(e,t,i){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=OL({},e.props),r=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=tC.current),t.key!==void 0&&(r=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)UL.call(t,l)&&!FL.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=i;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:j0,type:e.type,key:r,ref:s,props:n,_owner:a}};Ft.createContext=function(e){return e={$$typeof:Tk,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Ak,_context:e},e.Consumer=e};Ft.createElement=zL;Ft.createFactory=function(e){var t=zL.bind(null,e);return t.type=e,t};Ft.createRef=function(){return{current:null}};Ft.forwardRef=function(e){return{$$typeof:Pk,render:e}};Ft.isValidElement=iC;Ft.lazy=function(e){return{$$typeof:Rk,_payload:{_status:-1,_result:e},_init:Nk}};Ft.memo=function(e,t){return{$$typeof:Lk,type:e,compare:t===void 0?null:t}};Ft.startTransition=function(e){var t=Sv.transition;Sv.transition={};try{e()}finally{Sv.transition=t}};Ft.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Ft.useCallback=function(e,t){return vr.current.useCallback(e,t)};Ft.useContext=function(e){return vr.current.useContext(e)};Ft.useDebugValue=function(){};Ft.useDeferredValue=function(e){return vr.current.useDeferredValue(e)};Ft.useEffect=function(e,t){return vr.current.useEffect(e,t)};Ft.useId=function(){return vr.current.useId()};Ft.useImperativeHandle=function(e,t,i){return vr.current.useImperativeHandle(e,t,i)};Ft.useInsertionEffect=function(e,t){return vr.current.useInsertionEffect(e,t)};Ft.useLayoutEffect=function(e,t){return vr.current.useLayoutEffect(e,t)};Ft.useMemo=function(e,t){return vr.current.useMemo(e,t)};Ft.useReducer=function(e,t,i){return vr.current.useReducer(e,t,i)};Ft.useRef=function(e){return vr.current.useRef(e)};Ft.useState=function(e){return vr.current.useState(e)};Ft.useSyncExternalStore=function(e,t,i){return vr.current.useSyncExternalStore(e,t,i)};Ft.useTransition=function(){return vr.current.useTransition()};Ft.version="18.2.0";RL.exports=Ft;var ze=RL.exports;const zp=wk(ze),Fk=bk({__proto__:null,default:zp},[ze]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zk=ze,kk=Symbol.for("react.element"),Vk=Symbol.for("react.fragment"),Hk=Object.prototype.hasOwnProperty,Gk=zk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,jk={key:!0,ref:!0,__self:!0,__source:!0};function kL(e,t,i){var n,r={},s=null,a=null;i!==void 0&&(s=""+i),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(n in t)Hk.call(t,n)&&!jk.hasOwnProperty(n)&&(r[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)r[n]===void 0&&(r[n]=t[n]);return{$$typeof:kk,type:e,key:s,ref:a,props:r,_owner:Gk.current}}Tx.Fragment=Vk;Tx.jsx=kL;Tx.jsxs=kL;LL.exports=Tx;var ee=LL.exports,Xw={},VL={exports:{}},hs={},HL={exports:{}},GL={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(O,H){var k=O.length;O.push(H);e:for(;0<k;){var N=k-1>>>1,F=O[N];if(0<r(F,H))O[N]=H,O[k]=F,k=N;else break e}}function i(O){return O.length===0?null:O[0]}function n(O){if(O.length===0)return null;var H=O[0],k=O.pop();if(k!==H){O[0]=k;e:for(var N=0,F=O.length,Q=F>>>1;N<Q;){var G=2*(N+1)-1,K=O[G],W=G+1,se=O[W];if(0>r(K,k))W<F&&0>r(se,K)?(O[N]=se,O[W]=k,N=W):(O[N]=K,O[G]=k,N=G);else if(W<F&&0>r(se,k))O[N]=se,O[W]=k,N=W;else break e}}return H}function r(O,H){var k=O.sortIndex-H.sortIndex;return k!==0?k:O.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,h=null,d=3,p=!1,f=!1,v=!1,m=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(O){for(var H=i(c);H!==null;){if(H.callback===null)n(c);else if(H.startTime<=O)n(c),H.sortIndex=H.expirationTime,t(l,H);else break;H=i(c)}}function _(O){if(v=!1,x(O),!f)if(i(l)!==null)f=!0,j(b);else{var H=i(c);H!==null&&z(_,H.startTime-O)}}function b(O,H){f=!1,v&&(v=!1,g(S),S=-1),p=!0;var k=d;try{for(x(H),h=i(l);h!==null&&(!(h.expirationTime>H)||O&&!P());){var N=h.callback;if(typeof N=="function"){h.callback=null,d=h.priorityLevel;var F=N(h.expirationTime<=H);H=e.unstable_now(),typeof F=="function"?h.callback=F:h===i(l)&&n(l),x(H)}else n(l);h=i(l)}if(h!==null)var Q=!0;else{var G=i(c);G!==null&&z(_,G.startTime-H),Q=!1}return Q}finally{h=null,d=k,p=!1}}var w=!1,M=null,S=-1,C=5,E=-1;function P(){return!(e.unstable_now()-E<C)}function I(){if(M!==null){var O=e.unstable_now();E=O;var H=!0;try{H=M(!0,O)}finally{H?D():(w=!1,M=null)}}else w=!1}var D;if(typeof y=="function")D=function(){y(I)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,B=L.port2;L.port1.onmessage=I,D=function(){B.postMessage(null)}}else D=function(){m(I,0)};function j(O){M=O,w||(w=!0,D())}function z(O,H){S=m(function(){O(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(O){O.callback=null},e.unstable_continueExecution=function(){f||p||(f=!0,j(b))},e.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<O?Math.floor(1e3/O):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return i(l)},e.unstable_next=function(O){switch(d){case 1:case 2:case 3:var H=3;break;default:H=d}var k=d;d=H;try{return O()}finally{d=k}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(O,H){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var k=d;d=O;try{return H()}finally{d=k}},e.unstable_scheduleCallback=function(O,H,k){var N=e.unstable_now();switch(typeof k=="object"&&k!==null?(k=k.delay,k=typeof k=="number"&&0<k?N+k:N):k=N,O){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=k+F,O={id:u++,callback:H,priorityLevel:O,startTime:k,expirationTime:F,sortIndex:-1},k>N?(O.sortIndex=k,t(c,O),i(l)===null&&O===i(c)&&(v?(g(S),S=-1):v=!0,z(_,k-N))):(O.sortIndex=F,t(l,O),f||p||(f=!0,j(b))),O},e.unstable_shouldYield=P,e.unstable_wrapCallback=function(O){var H=d;return function(){var k=d;d=H;try{return O.apply(this,arguments)}finally{d=k}}}})(GL);HL.exports=GL;var Wk=HL.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jL=ze,as=Wk;function Ge(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var WL=new Set,t0={};function Jh(e,t){hp(e,t),hp(e+"Capture",t)}function hp(e,t){for(t0[e]=t,e=0;e<t.length;e++)WL.add(t[e])}var sl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qw=Object.prototype.hasOwnProperty,Xk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,u4={},d4={};function qk(e){return qw.call(d4,e)?!0:qw.call(u4,e)?!1:Xk.test(e)?d4[e]=!0:(u4[e]=!0,!1)}function Yk(e,t,i,n){if(i!==null&&i.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:i!==null?!i.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Zk(e,t,i,n){if(t===null||typeof t>"u"||Yk(e,t,i,n))return!0;if(n)return!1;if(i!==null)switch(i.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function yr(e,t,i,n,r,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var Rn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Rn[e]=new yr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Rn[t]=new yr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Rn[e]=new yr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Rn[e]=new yr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Rn[e]=new yr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Rn[e]=new yr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Rn[e]=new yr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Rn[e]=new yr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Rn[e]=new yr(e,5,!1,e.toLowerCase(),null,!1,!1)});var nC=/[\-:]([a-z])/g;function rC(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(nC,rC);Rn[t]=new yr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(nC,rC);Rn[t]=new yr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(nC,rC);Rn[t]=new yr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Rn[e]=new yr(e,1,!1,e.toLowerCase(),null,!1,!1)});Rn.xlinkHref=new yr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Rn[e]=new yr(e,1,!1,e.toLowerCase(),null,!0,!0)});function sC(e,t,i,n){var r=Rn.hasOwnProperty(t)?Rn[t]:null;(r!==null?r.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Zk(t,i,r,n)&&(i=null),n||r===null?qk(t)&&(i===null?e.removeAttribute(t):e.setAttribute(t,""+i)):r.mustUseProperty?e[r.propertyName]=i===null?r.type===3?!1:"":i:(t=r.attributeName,n=r.attributeNamespace,i===null?e.removeAttribute(t):(r=r.type,i=r===3||r===4&&i===!0?"":""+i,n?e.setAttributeNS(n,t,i):e.setAttribute(t,i))))}var dl=jL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,yg=Symbol.for("react.element"),fd=Symbol.for("react.portal"),md=Symbol.for("react.fragment"),aC=Symbol.for("react.strict_mode"),Yw=Symbol.for("react.profiler"),XL=Symbol.for("react.provider"),qL=Symbol.for("react.context"),oC=Symbol.for("react.forward_ref"),Zw=Symbol.for("react.suspense"),Qw=Symbol.for("react.suspense_list"),lC=Symbol.for("react.memo"),Ul=Symbol.for("react.lazy"),YL=Symbol.for("react.offscreen"),p4=Symbol.iterator;function df(e){return e===null||typeof e!="object"?null:(e=p4&&e[p4]||e["@@iterator"],typeof e=="function"?e:null)}var Mi=Object.assign,F2;function sm(e){if(F2===void 0)try{throw Error()}catch(i){var t=i.stack.trim().match(/\n( *(at )?)/);F2=t&&t[1]||""}return`
`+F2+e}var z2=!1;function k2(e,t){if(!e||z2)return"";z2=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),s=n.stack.split(`
`),a=r.length-1,o=s.length-1;1<=a&&0<=o&&r[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(r[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||r[a]!==s[o]){var l=`
`+r[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=o);break}}}finally{z2=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?sm(e):""}function Qk(e){switch(e.tag){case 5:return sm(e.type);case 16:return sm("Lazy");case 13:return sm("Suspense");case 19:return sm("SuspenseList");case 0:case 2:case 15:return e=k2(e.type,!1),e;case 11:return e=k2(e.type.render,!1),e;case 1:return e=k2(e.type,!0),e;default:return""}}function Kw(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case md:return"Fragment";case fd:return"Portal";case Yw:return"Profiler";case aC:return"StrictMode";case Zw:return"Suspense";case Qw:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case qL:return(e.displayName||"Context")+".Consumer";case XL:return(e._context.displayName||"Context")+".Provider";case oC:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case lC:return t=e.displayName||null,t!==null?t:Kw(e.type)||"Memo";case Ul:t=e._payload,e=e._init;try{return Kw(e(t))}catch{}}return null}function Kk(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Kw(t);case 8:return t===aC?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Cc(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function ZL(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function $k(e){var t=ZL(e)?"checked":"value",i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var r=i.get,s=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(a){n=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(a){n=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function xg(e){e._valueTracker||(e._valueTracker=$k(e))}function QL(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var i=t.getValue(),n="";return e&&(n=ZL(e)?e.checked?"true":"false":e.value),e=n,e!==i?(t.setValue(e),!0):!1}function Qv(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function $w(e,t){var i=t.checked;return Mi({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i??e._wrapperState.initialChecked})}function f4(e,t){var i=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;i=Cc(t.value!=null?t.value:i),e._wrapperState={initialChecked:n,initialValue:i,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function KL(e,t){t=t.checked,t!=null&&sC(e,"checked",t,!1)}function Jw(e,t){KL(e,t);var i=Cc(t.value),n=t.type;if(i!=null)n==="number"?(i===0&&e.value===""||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?e3(e,t.type,i):t.hasOwnProperty("defaultValue")&&e3(e,t.type,Cc(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function m4(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}i=e.name,i!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,i!==""&&(e.name=i)}function e3(e,t,i){(t!=="number"||Qv(e.ownerDocument)!==e)&&(i==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var am=Array.isArray;function zd(e,t,i,n){if(e=e.options,t){t={};for(var r=0;r<i.length;r++)t["$"+i[r]]=!0;for(i=0;i<e.length;i++)r=t.hasOwnProperty("$"+e[i].value),e[i].selected!==r&&(e[i].selected=r),r&&n&&(e[i].defaultSelected=!0)}else{for(i=""+Cc(i),t=null,r=0;r<e.length;r++){if(e[r].value===i){e[r].selected=!0,n&&(e[r].defaultSelected=!0);return}t!==null||e[r].disabled||(t=e[r])}t!==null&&(t.selected=!0)}}function t3(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ge(91));return Mi({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function g4(e,t){var i=t.value;if(i==null){if(i=t.children,t=t.defaultValue,i!=null){if(t!=null)throw Error(Ge(92));if(am(i)){if(1<i.length)throw Error(Ge(93));i=i[0]}t=i}t==null&&(t=""),i=t}e._wrapperState={initialValue:Cc(i)}}function $L(e,t){var i=Cc(t.value),n=Cc(t.defaultValue);i!=null&&(i=""+i,i!==e.value&&(e.value=i),t.defaultValue==null&&e.defaultValue!==i&&(e.defaultValue=i)),n!=null&&(e.defaultValue=""+n)}function v4(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function JL(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function i3(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?JL(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var _g,eR=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,i,n,r){MSApp.execUnsafeLocalFunction(function(){return e(t,i,n,r)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(_g=_g||document.createElement("div"),_g.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=_g.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function i0(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===3){i.nodeValue=t;return}}e.textContent=t}var _m={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Jk=["Webkit","ms","Moz","O"];Object.keys(_m).forEach(function(e){Jk.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),_m[t]=_m[e]})});function tR(e,t,i){return t==null||typeof t=="boolean"||t===""?"":i||typeof t!="number"||t===0||_m.hasOwnProperty(e)&&_m[e]?(""+t).trim():t+"px"}function iR(e,t){e=e.style;for(var i in t)if(t.hasOwnProperty(i)){var n=i.indexOf("--")===0,r=tR(i,t[i],n);i==="float"&&(i="cssFloat"),n?e.setProperty(i,r):e[i]=r}}var eV=Mi({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function n3(e,t){if(t){if(eV[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ge(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ge(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ge(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ge(62))}}function r3(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var s3=null;function cC(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var a3=null,kd=null,Vd=null;function y4(e){if(e=q0(e)){if(typeof a3!="function")throw Error(Ge(280));var t=e.stateNode;t&&(t=Ix(t),a3(e.stateNode,e.type,t))}}function nR(e){kd?Vd?Vd.push(e):Vd=[e]:kd=e}function rR(){if(kd){var e=kd,t=Vd;if(Vd=kd=null,y4(e),t)for(e=0;e<t.length;e++)y4(t[e])}}function sR(e,t){return e(t)}function aR(){}var V2=!1;function oR(e,t,i){if(V2)return e(t,i);V2=!0;try{return sR(e,t,i)}finally{V2=!1,(kd!==null||Vd!==null)&&(aR(),rR())}}function n0(e,t){var i=e.stateNode;if(i===null)return null;var n=Ix(i);if(n===null)return null;i=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(i&&typeof i!="function")throw Error(Ge(231,t,typeof i));return i}var o3=!1;if(sl)try{var pf={};Object.defineProperty(pf,"passive",{get:function(){o3=!0}}),window.addEventListener("test",pf,pf),window.removeEventListener("test",pf,pf)}catch{o3=!1}function tV(e,t,i,n,r,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(i,c)}catch(u){this.onError(u)}}var bm=!1,Kv=null,$v=!1,l3=null,iV={onError:function(e){bm=!0,Kv=e}};function nV(e,t,i,n,r,s,a,o,l){bm=!1,Kv=null,tV.apply(iV,arguments)}function rV(e,t,i,n,r,s,a,o,l){if(nV.apply(this,arguments),bm){if(bm){var c=Kv;bm=!1,Kv=null}else throw Error(Ge(198));$v||($v=!0,l3=c)}}function eu(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(i=t.return),e=t.return;while(e)}return t.tag===3?i:null}function lR(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function x4(e){if(eu(e)!==e)throw Error(Ge(188))}function sV(e){var t=e.alternate;if(!t){if(t=eu(e),t===null)throw Error(Ge(188));return t!==e?null:e}for(var i=e,n=t;;){var r=i.return;if(r===null)break;var s=r.alternate;if(s===null){if(n=r.return,n!==null){i=n;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===i)return x4(r),e;if(s===n)return x4(r),t;s=s.sibling}throw Error(Ge(188))}if(i.return!==n.return)i=r,n=s;else{for(var a=!1,o=r.child;o;){if(o===i){a=!0,i=r,n=s;break}if(o===n){a=!0,n=r,i=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===i){a=!0,i=s,n=r;break}if(o===n){a=!0,n=s,i=r;break}o=o.sibling}if(!a)throw Error(Ge(189))}}if(i.alternate!==n)throw Error(Ge(190))}if(i.tag!==3)throw Error(Ge(188));return i.stateNode.current===i?e:t}function cR(e){return e=sV(e),e!==null?hR(e):null}function hR(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=hR(e);if(t!==null)return t;e=e.sibling}return null}var uR=as.unstable_scheduleCallback,_4=as.unstable_cancelCallback,aV=as.unstable_shouldYield,oV=as.unstable_requestPaint,Ui=as.unstable_now,lV=as.unstable_getCurrentPriorityLevel,hC=as.unstable_ImmediatePriority,dR=as.unstable_UserBlockingPriority,Jv=as.unstable_NormalPriority,cV=as.unstable_LowPriority,pR=as.unstable_IdlePriority,Px=null,Ka=null;function hV(e){if(Ka&&typeof Ka.onCommitFiberRoot=="function")try{Ka.onCommitFiberRoot(Px,e,void 0,(e.current.flags&128)===128)}catch{}}var pa=Math.clz32?Math.clz32:pV,uV=Math.log,dV=Math.LN2;function pV(e){return e>>>=0,e===0?32:31-(uV(e)/dV|0)|0}var bg=64,wg=4194304;function om(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ey(e,t){var i=e.pendingLanes;if(i===0)return 0;var n=0,r=e.suspendedLanes,s=e.pingedLanes,a=i&268435455;if(a!==0){var o=a&~r;o!==0?n=om(o):(s&=a,s!==0&&(n=om(s)))}else a=i&~r,a!==0?n=om(a):s!==0&&(n=om(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&r)&&(r=n&-n,s=t&-t,r>=s||r===16&&(s&4194240)!==0))return t;if(n&4&&(n|=i&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)i=31-pa(t),r=1<<i,n|=e[i],t&=~r;return n}function fV(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function mV(e,t){for(var i=e.suspendedLanes,n=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-pa(s),o=1<<a,l=r[a];l===-1?(!(o&i)||o&n)&&(r[a]=fV(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function c3(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function fR(){var e=bg;return bg<<=1,!(bg&4194240)&&(bg=64),e}function H2(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function W0(e,t,i){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-pa(t),e[t]=i}function gV(e,t){var i=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<i;){var r=31-pa(i),s=1<<r;t[r]=0,n[r]=-1,e[r]=-1,i&=~s}}function uC(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var n=31-pa(i),r=1<<n;r&t|e[n]&t&&(e[n]|=t),i&=~r}}var Kt=0;function mR(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var gR,dC,vR,yR,xR,h3=!1,Sg=[],ac=null,oc=null,lc=null,r0=new Map,s0=new Map,Hl=[],vV="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function b4(e,t){switch(e){case"focusin":case"focusout":ac=null;break;case"dragenter":case"dragleave":oc=null;break;case"mouseover":case"mouseout":lc=null;break;case"pointerover":case"pointerout":r0.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":s0.delete(t.pointerId)}}function ff(e,t,i,n,r,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:i,eventSystemFlags:n,nativeEvent:s,targetContainers:[r]},t!==null&&(t=q0(t),t!==null&&dC(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,r!==null&&t.indexOf(r)===-1&&t.push(r),e)}function yV(e,t,i,n,r){switch(t){case"focusin":return ac=ff(ac,e,t,i,n,r),!0;case"dragenter":return oc=ff(oc,e,t,i,n,r),!0;case"mouseover":return lc=ff(lc,e,t,i,n,r),!0;case"pointerover":var s=r.pointerId;return r0.set(s,ff(r0.get(s)||null,e,t,i,n,r)),!0;case"gotpointercapture":return s=r.pointerId,s0.set(s,ff(s0.get(s)||null,e,t,i,n,r)),!0}return!1}function _R(e){var t=gh(e.target);if(t!==null){var i=eu(t);if(i!==null){if(t=i.tag,t===13){if(t=lR(i),t!==null){e.blockedOn=t,xR(e.priority,function(){vR(i)});return}}else if(t===3&&i.stateNode.current.memoizedState.isDehydrated){e.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Mv(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var i=u3(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(i===null){i=e.nativeEvent;var n=new i.constructor(i.type,i);s3=n,i.target.dispatchEvent(n),s3=null}else return t=q0(i),t!==null&&dC(t),e.blockedOn=i,!1;t.shift()}return!0}function w4(e,t,i){Mv(e)&&i.delete(t)}function xV(){h3=!1,ac!==null&&Mv(ac)&&(ac=null),oc!==null&&Mv(oc)&&(oc=null),lc!==null&&Mv(lc)&&(lc=null),r0.forEach(w4),s0.forEach(w4)}function mf(e,t){e.blockedOn===t&&(e.blockedOn=null,h3||(h3=!0,as.unstable_scheduleCallback(as.unstable_NormalPriority,xV)))}function a0(e){function t(r){return mf(r,e)}if(0<Sg.length){mf(Sg[0],e);for(var i=1;i<Sg.length;i++){var n=Sg[i];n.blockedOn===e&&(n.blockedOn=null)}}for(ac!==null&&mf(ac,e),oc!==null&&mf(oc,e),lc!==null&&mf(lc,e),r0.forEach(t),s0.forEach(t),i=0;i<Hl.length;i++)n=Hl[i],n.blockedOn===e&&(n.blockedOn=null);for(;0<Hl.length&&(i=Hl[0],i.blockedOn===null);)_R(i),i.blockedOn===null&&Hl.shift()}var Hd=dl.ReactCurrentBatchConfig,ty=!0;function _V(e,t,i,n){var r=Kt,s=Hd.transition;Hd.transition=null;try{Kt=1,pC(e,t,i,n)}finally{Kt=r,Hd.transition=s}}function bV(e,t,i,n){var r=Kt,s=Hd.transition;Hd.transition=null;try{Kt=4,pC(e,t,i,n)}finally{Kt=r,Hd.transition=s}}function pC(e,t,i,n){if(ty){var r=u3(e,t,i,n);if(r===null)$2(e,t,n,iy,i),b4(e,n);else if(yV(r,e,t,i,n))n.stopPropagation();else if(b4(e,n),t&4&&-1<vV.indexOf(e)){for(;r!==null;){var s=q0(r);if(s!==null&&gR(s),s=u3(e,t,i,n),s===null&&$2(e,t,n,iy,i),s===r)break;r=s}r!==null&&n.stopPropagation()}else $2(e,t,n,null,i)}}var iy=null;function u3(e,t,i,n){if(iy=null,e=cC(n),e=gh(e),e!==null)if(t=eu(e),t===null)e=null;else if(i=t.tag,i===13){if(e=lR(t),e!==null)return e;e=null}else if(i===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return iy=e,null}function bR(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(lV()){case hC:return 1;case dR:return 4;case Jv:case cV:return 16;case pR:return 536870912;default:return 16}default:return 16}}var ql=null,fC=null,Cv=null;function wR(){if(Cv)return Cv;var e,t=fC,i=t.length,n,r="value"in ql?ql.value:ql.textContent,s=r.length;for(e=0;e<i&&t[e]===r[e];e++);var a=i-e;for(n=1;n<=a&&t[i-n]===r[s-n];n++);return Cv=r.slice(e,1<n?1-n:void 0)}function Ev(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Mg(){return!0}function S4(){return!1}function us(e){function t(i,n,r,s,a){this._reactName=i,this._targetInst=r,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(i=e[o],this[o]=i?i(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Mg:S4,this.isPropagationStopped=S4,this}return Mi(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=Mg)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=Mg)},persist:function(){},isPersistent:Mg}),t}var kp={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},mC=us(kp),X0=Mi({},kp,{view:0,detail:0}),wV=us(X0),G2,j2,gf,Dx=Mi({},X0,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gC,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==gf&&(gf&&e.type==="mousemove"?(G2=e.screenX-gf.screenX,j2=e.screenY-gf.screenY):j2=G2=0,gf=e),G2)},movementY:function(e){return"movementY"in e?e.movementY:j2}}),M4=us(Dx),SV=Mi({},Dx,{dataTransfer:0}),MV=us(SV),CV=Mi({},X0,{relatedTarget:0}),W2=us(CV),EV=Mi({},kp,{animationName:0,elapsedTime:0,pseudoElement:0}),AV=us(EV),TV=Mi({},kp,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),PV=us(TV),DV=Mi({},kp,{data:0}),C4=us(DV),LV={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},RV={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},IV={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function OV(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=IV[e])?!!t[e]:!1}function gC(){return OV}var BV=Mi({},X0,{key:function(e){if(e.key){var t=LV[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ev(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?RV[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gC,charCode:function(e){return e.type==="keypress"?Ev(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ev(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),NV=us(BV),UV=Mi({},Dx,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),E4=us(UV),FV=Mi({},X0,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gC}),zV=us(FV),kV=Mi({},kp,{propertyName:0,elapsedTime:0,pseudoElement:0}),VV=us(kV),HV=Mi({},Dx,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),GV=us(HV),jV=[9,13,27,32],vC=sl&&"CompositionEvent"in window,wm=null;sl&&"documentMode"in document&&(wm=document.documentMode);var WV=sl&&"TextEvent"in window&&!wm,SR=sl&&(!vC||wm&&8<wm&&11>=wm),A4=String.fromCharCode(32),T4=!1;function MR(e,t){switch(e){case"keyup":return jV.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function CR(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var gd=!1;function XV(e,t){switch(e){case"compositionend":return CR(t);case"keypress":return t.which!==32?null:(T4=!0,A4);case"textInput":return e=t.data,e===A4&&T4?null:e;default:return null}}function qV(e,t){if(gd)return e==="compositionend"||!vC&&MR(e,t)?(e=wR(),Cv=fC=ql=null,gd=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return SR&&t.locale!=="ko"?null:t.data;default:return null}}var YV={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function P4(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!YV[e.type]:t==="textarea"}function ER(e,t,i,n){nR(n),t=ny(t,"onChange"),0<t.length&&(i=new mC("onChange","change",null,i,n),e.push({event:i,listeners:t}))}var Sm=null,o0=null;function ZV(e){UR(e,0)}function Lx(e){var t=xd(e);if(QL(t))return e}function QV(e,t){if(e==="change")return t}var AR=!1;if(sl){var X2;if(sl){var q2="oninput"in document;if(!q2){var D4=document.createElement("div");D4.setAttribute("oninput","return;"),q2=typeof D4.oninput=="function"}X2=q2}else X2=!1;AR=X2&&(!document.documentMode||9<document.documentMode)}function L4(){Sm&&(Sm.detachEvent("onpropertychange",TR),o0=Sm=null)}function TR(e){if(e.propertyName==="value"&&Lx(o0)){var t=[];ER(t,o0,e,cC(e)),oR(ZV,t)}}function KV(e,t,i){e==="focusin"?(L4(),Sm=t,o0=i,Sm.attachEvent("onpropertychange",TR)):e==="focusout"&&L4()}function $V(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Lx(o0)}function JV(e,t){if(e==="click")return Lx(t)}function eH(e,t){if(e==="input"||e==="change")return Lx(t)}function tH(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ga=typeof Object.is=="function"?Object.is:tH;function l0(e,t){if(ga(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++){var r=i[n];if(!qw.call(t,r)||!ga(e[r],t[r]))return!1}return!0}function R4(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function I4(e,t){var i=R4(e);e=0;for(var n;i;){if(i.nodeType===3){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=R4(i)}}function PR(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?PR(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function DR(){for(var e=window,t=Qv();t instanceof e.HTMLIFrameElement;){try{var i=typeof t.contentWindow.location.href=="string"}catch{i=!1}if(i)e=t.contentWindow;else break;t=Qv(e.document)}return t}function yC(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function iH(e){var t=DR(),i=e.focusedElem,n=e.selectionRange;if(t!==i&&i&&i.ownerDocument&&PR(i.ownerDocument.documentElement,i)){if(n!==null&&yC(i)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in i)i.selectionStart=t,i.selectionEnd=Math.min(e,i.value.length);else if(e=(t=i.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var r=i.textContent.length,s=Math.min(n.start,r);n=n.end===void 0?s:Math.min(n.end,r),!e.extend&&s>n&&(r=n,n=s,s=r),r=I4(i,s);var a=I4(i,n);r&&a&&(e.rangeCount!==1||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(r.node,r.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=i;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<t.length;i++)e=t[i],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var nH=sl&&"documentMode"in document&&11>=document.documentMode,vd=null,d3=null,Mm=null,p3=!1;function O4(e,t,i){var n=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;p3||vd==null||vd!==Qv(n)||(n=vd,"selectionStart"in n&&yC(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Mm&&l0(Mm,n)||(Mm=n,n=ny(d3,"onSelect"),0<n.length&&(t=new mC("onSelect","select",null,t,i),e.push({event:t,listeners:n}),t.target=vd)))}function Cg(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var yd={animationend:Cg("Animation","AnimationEnd"),animationiteration:Cg("Animation","AnimationIteration"),animationstart:Cg("Animation","AnimationStart"),transitionend:Cg("Transition","TransitionEnd")},Y2={},LR={};sl&&(LR=document.createElement("div").style,"AnimationEvent"in window||(delete yd.animationend.animation,delete yd.animationiteration.animation,delete yd.animationstart.animation),"TransitionEvent"in window||delete yd.transitionend.transition);function Rx(e){if(Y2[e])return Y2[e];if(!yd[e])return e;var t=yd[e],i;for(i in t)if(t.hasOwnProperty(i)&&i in LR)return Y2[e]=t[i];return e}var RR=Rx("animationend"),IR=Rx("animationiteration"),OR=Rx("animationstart"),BR=Rx("transitionend"),NR=new Map,B4="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ic(e,t){NR.set(e,t),Jh(t,[e])}for(var Z2=0;Z2<B4.length;Z2++){var Q2=B4[Z2],rH=Q2.toLowerCase(),sH=Q2[0].toUpperCase()+Q2.slice(1);Ic(rH,"on"+sH)}Ic(RR,"onAnimationEnd");Ic(IR,"onAnimationIteration");Ic(OR,"onAnimationStart");Ic("dblclick","onDoubleClick");Ic("focusin","onFocus");Ic("focusout","onBlur");Ic(BR,"onTransitionEnd");hp("onMouseEnter",["mouseout","mouseover"]);hp("onMouseLeave",["mouseout","mouseover"]);hp("onPointerEnter",["pointerout","pointerover"]);hp("onPointerLeave",["pointerout","pointerover"]);Jh("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Jh("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Jh("onBeforeInput",["compositionend","keypress","textInput","paste"]);Jh("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Jh("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Jh("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aH=new Set("cancel close invalid load scroll toggle".split(" ").concat(lm));function N4(e,t,i){var n=e.type||"unknown-event";e.currentTarget=i,rV(n,t,void 0,e),e.currentTarget=null}function UR(e,t){t=(t&4)!==0;for(var i=0;i<e.length;i++){var n=e[i],r=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var a=n.length-1;0<=a;a--){var o=n[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&r.isPropagationStopped())break e;N4(r,o,c),s=l}else for(a=0;a<n.length;a++){if(o=n[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&r.isPropagationStopped())break e;N4(r,o,c),s=l}}}if($v)throw e=l3,$v=!1,l3=null,e}function fi(e,t){var i=t[y3];i===void 0&&(i=t[y3]=new Set);var n=e+"__bubble";i.has(n)||(FR(t,e,2,!1),i.add(n))}function K2(e,t,i){var n=0;t&&(n|=4),FR(i,e,n,t)}var Eg="_reactListening"+Math.random().toString(36).slice(2);function c0(e){if(!e[Eg]){e[Eg]=!0,WL.forEach(function(i){i!=="selectionchange"&&(aH.has(i)||K2(i,!1,e),K2(i,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Eg]||(t[Eg]=!0,K2("selectionchange",!1,t))}}function FR(e,t,i,n){switch(bR(t)){case 1:var r=_V;break;case 4:r=bV;break;default:r=pC}i=r.bind(null,t,i,e),r=void 0,!o3||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(r=!0),n?r!==void 0?e.addEventListener(t,i,{capture:!0,passive:r}):e.addEventListener(t,i,!0):r!==void 0?e.addEventListener(t,i,{passive:r}):e.addEventListener(t,i,!1)}function $2(e,t,i,n,r){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var a=n.tag;if(a===3||a===4){var o=n.stateNode.containerInfo;if(o===r||o.nodeType===8&&o.parentNode===r)break;if(a===4)for(a=n.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;a=a.return}for(;o!==null;){if(a=gh(o),a===null)return;if(l=a.tag,l===5||l===6){n=s=a;continue e}o=o.parentNode}}n=n.return}oR(function(){var c=s,u=cC(i),h=[];e:{var d=NR.get(e);if(d!==void 0){var p=mC,f=e;switch(e){case"keypress":if(Ev(i)===0)break e;case"keydown":case"keyup":p=NV;break;case"focusin":f="focus",p=W2;break;case"focusout":f="blur",p=W2;break;case"beforeblur":case"afterblur":p=W2;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=M4;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=MV;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=zV;break;case RR:case IR:case OR:p=AV;break;case BR:p=VV;break;case"scroll":p=wV;break;case"wheel":p=GV;break;case"copy":case"cut":case"paste":p=PV;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=E4}var v=(t&4)!==0,m=!v&&e==="scroll",g=v?d!==null?d+"Capture":null:d;v=[];for(var y=c,x;y!==null;){x=y;var _=x.stateNode;if(x.tag===5&&_!==null&&(x=_,g!==null&&(_=n0(y,g),_!=null&&v.push(h0(y,_,x)))),m)break;y=y.return}0<v.length&&(d=new p(d,f,null,i,u),h.push({event:d,listeners:v}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",d&&i!==s3&&(f=i.relatedTarget||i.fromElement)&&(gh(f)||f[al]))break e;if((p||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,p?(f=i.relatedTarget||i.toElement,p=c,f=f?gh(f):null,f!==null&&(m=eu(f),f!==m||f.tag!==5&&f.tag!==6)&&(f=null)):(p=null,f=c),p!==f)){if(v=M4,_="onMouseLeave",g="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(v=E4,_="onPointerLeave",g="onPointerEnter",y="pointer"),m=p==null?d:xd(p),x=f==null?d:xd(f),d=new v(_,y+"leave",p,i,u),d.target=m,d.relatedTarget=x,_=null,gh(u)===c&&(v=new v(g,y+"enter",f,i,u),v.target=x,v.relatedTarget=m,_=v),m=_,p&&f)t:{for(v=p,g=f,y=0,x=v;x;x=hu(x))y++;for(x=0,_=g;_;_=hu(_))x++;for(;0<y-x;)v=hu(v),y--;for(;0<x-y;)g=hu(g),x--;for(;y--;){if(v===g||g!==null&&v===g.alternate)break t;v=hu(v),g=hu(g)}v=null}else v=null;p!==null&&U4(h,d,p,v,!1),f!==null&&m!==null&&U4(h,m,f,v,!0)}}e:{if(d=c?xd(c):window,p=d.nodeName&&d.nodeName.toLowerCase(),p==="select"||p==="input"&&d.type==="file")var b=QV;else if(P4(d))if(AR)b=eH;else{b=$V;var w=KV}else(p=d.nodeName)&&p.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(b=JV);if(b&&(b=b(e,c))){ER(h,b,i,u);break e}w&&w(e,d,c),e==="focusout"&&(w=d._wrapperState)&&w.controlled&&d.type==="number"&&e3(d,"number",d.value)}switch(w=c?xd(c):window,e){case"focusin":(P4(w)||w.contentEditable==="true")&&(vd=w,d3=c,Mm=null);break;case"focusout":Mm=d3=vd=null;break;case"mousedown":p3=!0;break;case"contextmenu":case"mouseup":case"dragend":p3=!1,O4(h,i,u);break;case"selectionchange":if(nH)break;case"keydown":case"keyup":O4(h,i,u)}var M;if(vC)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else gd?MR(e,i)&&(S="onCompositionEnd"):e==="keydown"&&i.keyCode===229&&(S="onCompositionStart");S&&(SR&&i.locale!=="ko"&&(gd||S!=="onCompositionStart"?S==="onCompositionEnd"&&gd&&(M=wR()):(ql=u,fC="value"in ql?ql.value:ql.textContent,gd=!0)),w=ny(c,S),0<w.length&&(S=new C4(S,e,null,i,u),h.push({event:S,listeners:w}),M?S.data=M:(M=CR(i),M!==null&&(S.data=M)))),(M=WV?XV(e,i):qV(e,i))&&(c=ny(c,"onBeforeInput"),0<c.length&&(u=new C4("onBeforeInput","beforeinput",null,i,u),h.push({event:u,listeners:c}),u.data=M))}UR(h,t)})}function h0(e,t,i){return{instance:e,listener:t,currentTarget:i}}function ny(e,t){for(var i=t+"Capture",n=[];e!==null;){var r=e,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=n0(e,i),s!=null&&n.unshift(h0(e,s,r)),s=n0(e,t),s!=null&&n.push(h0(e,s,r))),e=e.return}return n}function hu(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function U4(e,t,i,n,r){for(var s=t._reactName,a=[];i!==null&&i!==n;){var o=i,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,r?(l=n0(i,s),l!=null&&a.unshift(h0(i,l,o))):r||(l=n0(i,s),l!=null&&a.push(h0(i,l,o)))),i=i.return}a.length!==0&&e.push({event:t,listeners:a})}var oH=/\r\n?/g,lH=/\u0000|\uFFFD/g;function F4(e){return(typeof e=="string"?e:""+e).replace(oH,`
`).replace(lH,"")}function Ag(e,t,i){if(t=F4(t),F4(e)!==t&&i)throw Error(Ge(425))}function ry(){}var f3=null,m3=null;function g3(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var v3=typeof setTimeout=="function"?setTimeout:void 0,cH=typeof clearTimeout=="function"?clearTimeout:void 0,z4=typeof Promise=="function"?Promise:void 0,hH=typeof queueMicrotask=="function"?queueMicrotask:typeof z4<"u"?function(e){return z4.resolve(null).then(e).catch(uH)}:v3;function uH(e){setTimeout(function(){throw e})}function J2(e,t){var i=t,n=0;do{var r=i.nextSibling;if(e.removeChild(i),r&&r.nodeType===8)if(i=r.data,i==="/$"){if(n===0){e.removeChild(r),a0(t);return}n--}else i!=="$"&&i!=="$?"&&i!=="$!"||n++;i=r}while(i);a0(t)}function cc(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function k4(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="$"||i==="$!"||i==="$?"){if(t===0)return e;t--}else i==="/$"&&t++}e=e.previousSibling}return null}var Vp=Math.random().toString(36).slice(2),Ga="__reactFiber$"+Vp,u0="__reactProps$"+Vp,al="__reactContainer$"+Vp,y3="__reactEvents$"+Vp,dH="__reactListeners$"+Vp,pH="__reactHandles$"+Vp;function gh(e){var t=e[Ga];if(t)return t;for(var i=e.parentNode;i;){if(t=i[al]||i[Ga]){if(i=t.alternate,t.child!==null||i!==null&&i.child!==null)for(e=k4(e);e!==null;){if(i=e[Ga])return i;e=k4(e)}return t}e=i,i=e.parentNode}return null}function q0(e){return e=e[Ga]||e[al],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function xd(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ge(33))}function Ix(e){return e[u0]||null}var x3=[],_d=-1;function Oc(e){return{current:e}}function vi(e){0>_d||(e.current=x3[_d],x3[_d]=null,_d--)}function di(e,t){_d++,x3[_d]=e.current,e.current=t}var Ec={},Yn=Oc(Ec),Dr=Oc(!1),Fh=Ec;function up(e,t){var i=e.type.contextTypes;if(!i)return Ec;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in i)r[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function Lr(e){return e=e.childContextTypes,e!=null}function sy(){vi(Dr),vi(Yn)}function V4(e,t,i){if(Yn.current!==Ec)throw Error(Ge(168));di(Yn,t),di(Dr,i)}function zR(e,t,i){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return i;n=n.getChildContext();for(var r in n)if(!(r in t))throw Error(Ge(108,Kk(e)||"Unknown",r));return Mi({},i,n)}function ay(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ec,Fh=Yn.current,di(Yn,e),di(Dr,Dr.current),!0}function H4(e,t,i){var n=e.stateNode;if(!n)throw Error(Ge(169));i?(e=zR(e,t,Fh),n.__reactInternalMemoizedMergedChildContext=e,vi(Dr),vi(Yn),di(Yn,e)):vi(Dr),di(Dr,i)}var Vo=null,Ox=!1,e_=!1;function kR(e){Vo===null?Vo=[e]:Vo.push(e)}function fH(e){Ox=!0,kR(e)}function Bc(){if(!e_&&Vo!==null){e_=!0;var e=0,t=Kt;try{var i=Vo;for(Kt=1;e<i.length;e++){var n=i[e];do n=n(!0);while(n!==null)}Vo=null,Ox=!1}catch(r){throw Vo!==null&&(Vo=Vo.slice(e+1)),uR(hC,Bc),r}finally{Kt=t,e_=!1}}return null}var bd=[],wd=0,oy=null,ly=0,Ms=[],Cs=0,zh=null,Xo=1,qo="";function eh(e,t){bd[wd++]=ly,bd[wd++]=oy,oy=e,ly=t}function VR(e,t,i){Ms[Cs++]=Xo,Ms[Cs++]=qo,Ms[Cs++]=zh,zh=e;var n=Xo;e=qo;var r=32-pa(n)-1;n&=~(1<<r),i+=1;var s=32-pa(t)+r;if(30<s){var a=r-r%5;s=(n&(1<<a)-1).toString(32),n>>=a,r-=a,Xo=1<<32-pa(t)+r|i<<r|n,qo=s+e}else Xo=1<<s|i<<r|n,qo=e}function xC(e){e.return!==null&&(eh(e,1),VR(e,1,0))}function _C(e){for(;e===oy;)oy=bd[--wd],bd[wd]=null,ly=bd[--wd],bd[wd]=null;for(;e===zh;)zh=Ms[--Cs],Ms[Cs]=null,qo=Ms[--Cs],Ms[Cs]=null,Xo=Ms[--Cs],Ms[Cs]=null}var rs=null,$r=null,yi=!1,ta=null;function HR(e,t){var i=Ds(5,null,null,0);i.elementType="DELETED",i.stateNode=t,i.return=e,t=e.deletions,t===null?(e.deletions=[i],e.flags|=16):t.push(i)}function G4(e,t){switch(e.tag){case 5:var i=e.type;return t=t.nodeType!==1||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,rs=e,$r=cc(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,rs=e,$r=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(i=zh!==null?{id:Xo,overflow:qo}:null,e.memoizedState={dehydrated:t,treeContext:i,retryLane:1073741824},i=Ds(18,null,null,0),i.stateNode=t,i.return=e,e.child=i,rs=e,$r=null,!0):!1;default:return!1}}function _3(e){return(e.mode&1)!==0&&(e.flags&128)===0}function b3(e){if(yi){var t=$r;if(t){var i=t;if(!G4(e,t)){if(_3(e))throw Error(Ge(418));t=cc(i.nextSibling);var n=rs;t&&G4(e,t)?HR(n,i):(e.flags=e.flags&-4097|2,yi=!1,rs=e)}}else{if(_3(e))throw Error(Ge(418));e.flags=e.flags&-4097|2,yi=!1,rs=e}}}function j4(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;rs=e}function Tg(e){if(e!==rs)return!1;if(!yi)return j4(e),yi=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!g3(e.type,e.memoizedProps)),t&&(t=$r)){if(_3(e))throw GR(),Error(Ge(418));for(;t;)HR(e,t),t=cc(t.nextSibling)}if(j4(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ge(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var i=e.data;if(i==="/$"){if(t===0){$r=cc(e.nextSibling);break e}t--}else i!=="$"&&i!=="$!"&&i!=="$?"||t++}e=e.nextSibling}$r=null}}else $r=rs?cc(e.stateNode.nextSibling):null;return!0}function GR(){for(var e=$r;e;)e=cc(e.nextSibling)}function dp(){$r=rs=null,yi=!1}function bC(e){ta===null?ta=[e]:ta.push(e)}var mH=dl.ReactCurrentBatchConfig;function Js(e,t){if(e&&e.defaultProps){t=Mi({},t),e=e.defaultProps;for(var i in e)t[i]===void 0&&(t[i]=e[i]);return t}return t}var cy=Oc(null),hy=null,Sd=null,wC=null;function SC(){wC=Sd=hy=null}function MC(e){var t=cy.current;vi(cy),e._currentValue=t}function w3(e,t,i){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===i)break;e=e.return}}function Gd(e,t){hy=e,wC=Sd=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Er=!0),e.firstContext=null)}function Bs(e){var t=e._currentValue;if(wC!==e)if(e={context:e,memoizedValue:t,next:null},Sd===null){if(hy===null)throw Error(Ge(308));Sd=e,hy.dependencies={lanes:0,firstContext:e}}else Sd=Sd.next=e;return t}var vh=null;function CC(e){vh===null?vh=[e]:vh.push(e)}function jR(e,t,i,n){var r=t.interleaved;return r===null?(i.next=i,CC(t)):(i.next=r.next,r.next=i),t.interleaved=i,ol(e,n)}function ol(e,t){e.lanes|=t;var i=e.alternate;for(i!==null&&(i.lanes|=t),i=e,e=e.return;e!==null;)e.childLanes|=t,i=e.alternate,i!==null&&(i.childLanes|=t),i=e,e=e.return;return i.tag===3?i.stateNode:null}var Fl=!1;function EC(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function WR(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function $o(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function hc(e,t,i){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ht&2){var r=n.pending;return r===null?t.next=t:(t.next=r.next,r.next=t),n.pending=t,ol(e,i)}return r=n.interleaved,r===null?(t.next=t,CC(n)):(t.next=r.next,r.next=t),n.interleaved=t,ol(e,i)}function Av(e,t,i){if(t=t.updateQueue,t!==null&&(t=t.shared,(i&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,i|=n,t.lanes=i,uC(e,i)}}function W4(e,t){var i=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,i===n)){var r=null,s=null;if(i=i.firstBaseUpdate,i!==null){do{var a={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};s===null?r=s=a:s=s.next=a,i=i.next}while(i!==null);s===null?r=s=t:s=s.next=t}else r=s=t;i={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=i;return}e=i.lastBaseUpdate,e===null?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function uy(e,t,i,n){var r=e.updateQueue;Fl=!1;var s=r.firstBaseUpdate,a=r.lastBaseUpdate,o=r.shared.pending;if(o!==null){r.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var h=r.baseState;a=0,u=c=l=null,o=s;do{var d=o.lane,p=o.eventTime;if((n&d)===d){u!==null&&(u=u.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,v=o;switch(d=t,p=i,v.tag){case 1:if(f=v.payload,typeof f=="function"){h=f.call(p,h,d);break e}h=f;break e;case 3:f.flags=f.flags&-65537|128;case 0:if(f=v.payload,d=typeof f=="function"?f.call(p,h,d):f,d==null)break e;h=Mi({},h,d);break e;case 2:Fl=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,d=r.effects,d===null?r.effects=[o]:d.push(o))}else p={eventTime:p,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=p,l=h):u=u.next=p,a|=d;if(o=o.next,o===null){if(o=r.shared.pending,o===null)break;d=o,o=d.next,d.next=null,r.lastBaseUpdate=d,r.shared.pending=null}}while(1);if(u===null&&(l=h),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,t=r.shared.interleaved,t!==null){r=t;do a|=r.lane,r=r.next;while(r!==t)}else s===null&&(r.shared.lanes=0);Vh|=a,e.lanes=a,e.memoizedState=h}}function X4(e,t,i){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],r=n.callback;if(r!==null){if(n.callback=null,n=i,typeof r!="function")throw Error(Ge(191,r));r.call(n)}}}var XR=new jL.Component().refs;function S3(e,t,i,n){t=e.memoizedState,i=i(n,t),i=i==null?t:Mi({},t,i),e.memoizedState=i,e.lanes===0&&(e.updateQueue.baseState=i)}var Bx={isMounted:function(e){return(e=e._reactInternals)?eu(e)===e:!1},enqueueSetState:function(e,t,i){e=e._reactInternals;var n=pr(),r=dc(e),s=$o(n,r);s.payload=t,i!=null&&(s.callback=i),t=hc(e,s,r),t!==null&&(fa(t,e,r,n),Av(t,e,r))},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var n=pr(),r=dc(e),s=$o(n,r);s.tag=1,s.payload=t,i!=null&&(s.callback=i),t=hc(e,s,r),t!==null&&(fa(t,e,r,n),Av(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=pr(),n=dc(e),r=$o(i,n);r.tag=2,t!=null&&(r.callback=t),t=hc(e,r,n),t!==null&&(fa(t,e,n,i),Av(t,e,n))}};function q4(e,t,i,n,r,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,a):t.prototype&&t.prototype.isPureReactComponent?!l0(i,n)||!l0(r,s):!0}function qR(e,t,i){var n=!1,r=Ec,s=t.contextType;return typeof s=="object"&&s!==null?s=Bs(s):(r=Lr(t)?Fh:Yn.current,n=t.contextTypes,s=(n=n!=null)?up(e,r):Ec),t=new t(i,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Bx,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=s),t}function Y4(e,t,i,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(i,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(i,n),t.state!==e&&Bx.enqueueReplaceState(t,t.state,null)}function M3(e,t,i,n){var r=e.stateNode;r.props=i,r.state=e.memoizedState,r.refs=XR,EC(e);var s=t.contextType;typeof s=="object"&&s!==null?r.context=Bs(s):(s=Lr(t)?Fh:Yn.current,r.context=up(e,s)),r.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(S3(e,t,s,i),r.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(t=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),t!==r.state&&Bx.enqueueReplaceState(r,r.state,null),uy(e,i,r,n),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308)}function vf(e,t,i){if(e=i.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(Ge(309));var n=i.stateNode}if(!n)throw Error(Ge(147,e));var r=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var o=r.refs;o===XR&&(o=r.refs={}),a===null?delete o[s]:o[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(Ge(284));if(!i._owner)throw Error(Ge(290,e))}return e}function Pg(e,t){throw e=Object.prototype.toString.call(t),Error(Ge(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Z4(e){var t=e._init;return t(e._payload)}function YR(e){function t(g,y){if(e){var x=g.deletions;x===null?(g.deletions=[y],g.flags|=16):x.push(y)}}function i(g,y){if(!e)return null;for(;y!==null;)t(g,y),y=y.sibling;return null}function n(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function r(g,y){return g=pc(g,y),g.index=0,g.sibling=null,g}function s(g,y,x){return g.index=x,e?(x=g.alternate,x!==null?(x=x.index,x<y?(g.flags|=2,y):x):(g.flags|=2,y)):(g.flags|=1048576,y)}function a(g){return e&&g.alternate===null&&(g.flags|=2),g}function o(g,y,x,_){return y===null||y.tag!==6?(y=o_(x,g.mode,_),y.return=g,y):(y=r(y,x),y.return=g,y)}function l(g,y,x,_){var b=x.type;return b===md?u(g,y,x.props.children,_,x.key):y!==null&&(y.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Ul&&Z4(b)===y.type)?(_=r(y,x.props),_.ref=vf(g,y,x),_.return=g,_):(_=Iv(x.type,x.key,x.props,null,g.mode,_),_.ref=vf(g,y,x),_.return=g,_)}function c(g,y,x,_){return y===null||y.tag!==4||y.stateNode.containerInfo!==x.containerInfo||y.stateNode.implementation!==x.implementation?(y=l_(x,g.mode,_),y.return=g,y):(y=r(y,x.children||[]),y.return=g,y)}function u(g,y,x,_,b){return y===null||y.tag!==7?(y=Eh(x,g.mode,_,b),y.return=g,y):(y=r(y,x),y.return=g,y)}function h(g,y,x){if(typeof y=="string"&&y!==""||typeof y=="number")return y=o_(""+y,g.mode,x),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case yg:return x=Iv(y.type,y.key,y.props,null,g.mode,x),x.ref=vf(g,null,y),x.return=g,x;case fd:return y=l_(y,g.mode,x),y.return=g,y;case Ul:var _=y._init;return h(g,_(y._payload),x)}if(am(y)||df(y))return y=Eh(y,g.mode,x,null),y.return=g,y;Pg(g,y)}return null}function d(g,y,x,_){var b=y!==null?y.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return b!==null?null:o(g,y,""+x,_);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case yg:return x.key===b?l(g,y,x,_):null;case fd:return x.key===b?c(g,y,x,_):null;case Ul:return b=x._init,d(g,y,b(x._payload),_)}if(am(x)||df(x))return b!==null?null:u(g,y,x,_,null);Pg(g,x)}return null}function p(g,y,x,_,b){if(typeof _=="string"&&_!==""||typeof _=="number")return g=g.get(x)||null,o(y,g,""+_,b);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case yg:return g=g.get(_.key===null?x:_.key)||null,l(y,g,_,b);case fd:return g=g.get(_.key===null?x:_.key)||null,c(y,g,_,b);case Ul:var w=_._init;return p(g,y,x,w(_._payload),b)}if(am(_)||df(_))return g=g.get(x)||null,u(y,g,_,b,null);Pg(y,_)}return null}function f(g,y,x,_){for(var b=null,w=null,M=y,S=y=0,C=null;M!==null&&S<x.length;S++){M.index>S?(C=M,M=null):C=M.sibling;var E=d(g,M,x[S],_);if(E===null){M===null&&(M=C);break}e&&M&&E.alternate===null&&t(g,M),y=s(E,y,S),w===null?b=E:w.sibling=E,w=E,M=C}if(S===x.length)return i(g,M),yi&&eh(g,S),b;if(M===null){for(;S<x.length;S++)M=h(g,x[S],_),M!==null&&(y=s(M,y,S),w===null?b=M:w.sibling=M,w=M);return yi&&eh(g,S),b}for(M=n(g,M);S<x.length;S++)C=p(M,g,S,x[S],_),C!==null&&(e&&C.alternate!==null&&M.delete(C.key===null?S:C.key),y=s(C,y,S),w===null?b=C:w.sibling=C,w=C);return e&&M.forEach(function(P){return t(g,P)}),yi&&eh(g,S),b}function v(g,y,x,_){var b=df(x);if(typeof b!="function")throw Error(Ge(150));if(x=b.call(x),x==null)throw Error(Ge(151));for(var w=b=null,M=y,S=y=0,C=null,E=x.next();M!==null&&!E.done;S++,E=x.next()){M.index>S?(C=M,M=null):C=M.sibling;var P=d(g,M,E.value,_);if(P===null){M===null&&(M=C);break}e&&M&&P.alternate===null&&t(g,M),y=s(P,y,S),w===null?b=P:w.sibling=P,w=P,M=C}if(E.done)return i(g,M),yi&&eh(g,S),b;if(M===null){for(;!E.done;S++,E=x.next())E=h(g,E.value,_),E!==null&&(y=s(E,y,S),w===null?b=E:w.sibling=E,w=E);return yi&&eh(g,S),b}for(M=n(g,M);!E.done;S++,E=x.next())E=p(M,g,S,E.value,_),E!==null&&(e&&E.alternate!==null&&M.delete(E.key===null?S:E.key),y=s(E,y,S),w===null?b=E:w.sibling=E,w=E);return e&&M.forEach(function(I){return t(g,I)}),yi&&eh(g,S),b}function m(g,y,x,_){if(typeof x=="object"&&x!==null&&x.type===md&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case yg:e:{for(var b=x.key,w=y;w!==null;){if(w.key===b){if(b=x.type,b===md){if(w.tag===7){i(g,w.sibling),y=r(w,x.props.children),y.return=g,g=y;break e}}else if(w.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Ul&&Z4(b)===w.type){i(g,w.sibling),y=r(w,x.props),y.ref=vf(g,w,x),y.return=g,g=y;break e}i(g,w);break}else t(g,w);w=w.sibling}x.type===md?(y=Eh(x.props.children,g.mode,_,x.key),y.return=g,g=y):(_=Iv(x.type,x.key,x.props,null,g.mode,_),_.ref=vf(g,y,x),_.return=g,g=_)}return a(g);case fd:e:{for(w=x.key;y!==null;){if(y.key===w)if(y.tag===4&&y.stateNode.containerInfo===x.containerInfo&&y.stateNode.implementation===x.implementation){i(g,y.sibling),y=r(y,x.children||[]),y.return=g,g=y;break e}else{i(g,y);break}else t(g,y);y=y.sibling}y=l_(x,g.mode,_),y.return=g,g=y}return a(g);case Ul:return w=x._init,m(g,y,w(x._payload),_)}if(am(x))return f(g,y,x,_);if(df(x))return v(g,y,x,_);Pg(g,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,y!==null&&y.tag===6?(i(g,y.sibling),y=r(y,x),y.return=g,g=y):(i(g,y),y=o_(x,g.mode,_),y.return=g,g=y),a(g)):i(g,y)}return m}var pp=YR(!0),ZR=YR(!1),Y0={},$a=Oc(Y0),d0=Oc(Y0),p0=Oc(Y0);function yh(e){if(e===Y0)throw Error(Ge(174));return e}function AC(e,t){switch(di(p0,t),di(d0,e),di($a,Y0),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:i3(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=i3(t,e)}vi($a),di($a,t)}function fp(){vi($a),vi(d0),vi(p0)}function QR(e){yh(p0.current);var t=yh($a.current),i=i3(t,e.type);t!==i&&(di(d0,e),di($a,i))}function TC(e){d0.current===e&&(vi($a),vi(d0))}var _i=Oc(0);function dy(e){for(var t=e;t!==null;){if(t.tag===13){var i=t.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var t_=[];function PC(){for(var e=0;e<t_.length;e++)t_[e]._workInProgressVersionPrimary=null;t_.length=0}var Tv=dl.ReactCurrentDispatcher,i_=dl.ReactCurrentBatchConfig,kh=0,Si=null,sn=null,_n=null,py=!1,Cm=!1,f0=0,gH=0;function Bn(){throw Error(Ge(321))}function DC(e,t){if(t===null)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!ga(e[i],t[i]))return!1;return!0}function LC(e,t,i,n,r,s){if(kh=s,Si=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Tv.current=e===null||e.memoizedState===null?_H:bH,e=i(n,r),Cm){s=0;do{if(Cm=!1,f0=0,25<=s)throw Error(Ge(301));s+=1,_n=sn=null,t.updateQueue=null,Tv.current=wH,e=i(n,r)}while(Cm)}if(Tv.current=fy,t=sn!==null&&sn.next!==null,kh=0,_n=sn=Si=null,py=!1,t)throw Error(Ge(300));return e}function RC(){var e=f0!==0;return f0=0,e}function Na(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _n===null?Si.memoizedState=_n=e:_n=_n.next=e,_n}function Ns(){if(sn===null){var e=Si.alternate;e=e!==null?e.memoizedState:null}else e=sn.next;var t=_n===null?Si.memoizedState:_n.next;if(t!==null)_n=t,sn=e;else{if(e===null)throw Error(Ge(310));sn=e,e={memoizedState:sn.memoizedState,baseState:sn.baseState,baseQueue:sn.baseQueue,queue:sn.queue,next:null},_n===null?Si.memoizedState=_n=e:_n=_n.next=e}return _n}function m0(e,t){return typeof t=="function"?t(e):t}function n_(e){var t=Ns(),i=t.queue;if(i===null)throw Error(Ge(311));i.lastRenderedReducer=e;var n=sn,r=n.baseQueue,s=i.pending;if(s!==null){if(r!==null){var a=r.next;r.next=s.next,s.next=a}n.baseQueue=r=s,i.pending=null}if(r!==null){s=r.next,n=n.baseState;var o=a=null,l=null,c=s;do{var u=c.lane;if((kh&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=h,a=n):l=l.next=h,Si.lanes|=u,Vh|=u}c=c.next}while(c!==null&&c!==s);l===null?a=n:l.next=o,ga(n,t.memoizedState)||(Er=!0),t.memoizedState=n,t.baseState=a,t.baseQueue=l,i.lastRenderedState=n}if(e=i.interleaved,e!==null){r=e;do s=r.lane,Si.lanes|=s,Vh|=s,r=r.next;while(r!==e)}else r===null&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function r_(e){var t=Ns(),i=t.queue;if(i===null)throw Error(Ge(311));i.lastRenderedReducer=e;var n=i.dispatch,r=i.pending,s=t.memoizedState;if(r!==null){i.pending=null;var a=r=r.next;do s=e(s,a.action),a=a.next;while(a!==r);ga(s,t.memoizedState)||(Er=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),i.lastRenderedState=s}return[s,n]}function KR(){}function $R(e,t){var i=Si,n=Ns(),r=t(),s=!ga(n.memoizedState,r);if(s&&(n.memoizedState=r,Er=!0),n=n.queue,IC(tI.bind(null,i,n,e),[e]),n.getSnapshot!==t||s||_n!==null&&_n.memoizedState.tag&1){if(i.flags|=2048,g0(9,eI.bind(null,i,n,r,t),void 0,null),Mn===null)throw Error(Ge(349));kh&30||JR(i,t,r)}return r}function JR(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},t=Si.updateQueue,t===null?(t={lastEffect:null,stores:null},Si.updateQueue=t,t.stores=[e]):(i=t.stores,i===null?t.stores=[e]:i.push(e))}function eI(e,t,i,n){t.value=i,t.getSnapshot=n,iI(t)&&nI(e)}function tI(e,t,i){return i(function(){iI(t)&&nI(e)})}function iI(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!ga(e,i)}catch{return!0}}function nI(e){var t=ol(e,1);t!==null&&fa(t,e,1,-1)}function Q4(e){var t=Na();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:m0,lastRenderedState:e},t.queue=e,e=e.dispatch=xH.bind(null,Si,e),[t.memoizedState,e]}function g0(e,t,i,n){return e={tag:e,create:t,destroy:i,deps:n,next:null},t=Si.updateQueue,t===null?(t={lastEffect:null,stores:null},Si.updateQueue=t,t.lastEffect=e.next=e):(i=t.lastEffect,i===null?t.lastEffect=e.next=e:(n=i.next,i.next=e,e.next=n,t.lastEffect=e)),e}function rI(){return Ns().memoizedState}function Pv(e,t,i,n){var r=Na();Si.flags|=e,r.memoizedState=g0(1|t,i,void 0,n===void 0?null:n)}function Nx(e,t,i,n){var r=Ns();n=n===void 0?null:n;var s=void 0;if(sn!==null){var a=sn.memoizedState;if(s=a.destroy,n!==null&&DC(n,a.deps)){r.memoizedState=g0(t,i,s,n);return}}Si.flags|=e,r.memoizedState=g0(1|t,i,s,n)}function K4(e,t){return Pv(8390656,8,e,t)}function IC(e,t){return Nx(2048,8,e,t)}function sI(e,t){return Nx(4,2,e,t)}function aI(e,t){return Nx(4,4,e,t)}function oI(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function lI(e,t,i){return i=i!=null?i.concat([e]):null,Nx(4,4,oI.bind(null,t,e),i)}function OC(){}function cI(e,t){var i=Ns();t=t===void 0?null:t;var n=i.memoizedState;return n!==null&&t!==null&&DC(t,n[1])?n[0]:(i.memoizedState=[e,t],e)}function hI(e,t){var i=Ns();t=t===void 0?null:t;var n=i.memoizedState;return n!==null&&t!==null&&DC(t,n[1])?n[0]:(e=e(),i.memoizedState=[e,t],e)}function uI(e,t,i){return kh&21?(ga(i,t)||(i=fR(),Si.lanes|=i,Vh|=i,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Er=!0),e.memoizedState=i)}function vH(e,t){var i=Kt;Kt=i!==0&&4>i?i:4,e(!0);var n=i_.transition;i_.transition={};try{e(!1),t()}finally{Kt=i,i_.transition=n}}function dI(){return Ns().memoizedState}function yH(e,t,i){var n=dc(e);if(i={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null},pI(e))fI(t,i);else if(i=jR(e,t,i,n),i!==null){var r=pr();fa(i,e,n,r),mI(i,t,n)}}function xH(e,t,i){var n=dc(e),r={lane:n,action:i,hasEagerState:!1,eagerState:null,next:null};if(pI(e))fI(t,r);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,o=s(a,i);if(r.hasEagerState=!0,r.eagerState=o,ga(o,a)){var l=t.interleaved;l===null?(r.next=r,CC(t)):(r.next=l.next,l.next=r),t.interleaved=r;return}}catch{}finally{}i=jR(e,t,r,n),i!==null&&(r=pr(),fa(i,e,n,r),mI(i,t,n))}}function pI(e){var t=e.alternate;return e===Si||t!==null&&t===Si}function fI(e,t){Cm=py=!0;var i=e.pending;i===null?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function mI(e,t,i){if(i&4194240){var n=t.lanes;n&=e.pendingLanes,i|=n,t.lanes=i,uC(e,i)}}var fy={readContext:Bs,useCallback:Bn,useContext:Bn,useEffect:Bn,useImperativeHandle:Bn,useInsertionEffect:Bn,useLayoutEffect:Bn,useMemo:Bn,useReducer:Bn,useRef:Bn,useState:Bn,useDebugValue:Bn,useDeferredValue:Bn,useTransition:Bn,useMutableSource:Bn,useSyncExternalStore:Bn,useId:Bn,unstable_isNewReconciler:!1},_H={readContext:Bs,useCallback:function(e,t){return Na().memoizedState=[e,t===void 0?null:t],e},useContext:Bs,useEffect:K4,useImperativeHandle:function(e,t,i){return i=i!=null?i.concat([e]):null,Pv(4194308,4,oI.bind(null,t,e),i)},useLayoutEffect:function(e,t){return Pv(4194308,4,e,t)},useInsertionEffect:function(e,t){return Pv(4,2,e,t)},useMemo:function(e,t){var i=Na();return t=t===void 0?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var n=Na();return t=i!==void 0?i(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=yH.bind(null,Si,e),[n.memoizedState,e]},useRef:function(e){var t=Na();return e={current:e},t.memoizedState=e},useState:Q4,useDebugValue:OC,useDeferredValue:function(e){return Na().memoizedState=e},useTransition:function(){var e=Q4(!1),t=e[0];return e=vH.bind(null,e[1]),Na().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,i){var n=Si,r=Na();if(yi){if(i===void 0)throw Error(Ge(407));i=i()}else{if(i=t(),Mn===null)throw Error(Ge(349));kh&30||JR(n,t,i)}r.memoizedState=i;var s={value:i,getSnapshot:t};return r.queue=s,K4(tI.bind(null,n,s,e),[e]),n.flags|=2048,g0(9,eI.bind(null,n,s,i,t),void 0,null),i},useId:function(){var e=Na(),t=Mn.identifierPrefix;if(yi){var i=qo,n=Xo;i=(n&~(1<<32-pa(n)-1)).toString(32)+i,t=":"+t+"R"+i,i=f0++,0<i&&(t+="H"+i.toString(32)),t+=":"}else i=gH++,t=":"+t+"r"+i.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},bH={readContext:Bs,useCallback:cI,useContext:Bs,useEffect:IC,useImperativeHandle:lI,useInsertionEffect:sI,useLayoutEffect:aI,useMemo:hI,useReducer:n_,useRef:rI,useState:function(){return n_(m0)},useDebugValue:OC,useDeferredValue:function(e){var t=Ns();return uI(t,sn.memoizedState,e)},useTransition:function(){var e=n_(m0)[0],t=Ns().memoizedState;return[e,t]},useMutableSource:KR,useSyncExternalStore:$R,useId:dI,unstable_isNewReconciler:!1},wH={readContext:Bs,useCallback:cI,useContext:Bs,useEffect:IC,useImperativeHandle:lI,useInsertionEffect:sI,useLayoutEffect:aI,useMemo:hI,useReducer:r_,useRef:rI,useState:function(){return r_(m0)},useDebugValue:OC,useDeferredValue:function(e){var t=Ns();return sn===null?t.memoizedState=e:uI(t,sn.memoizedState,e)},useTransition:function(){var e=r_(m0)[0],t=Ns().memoizedState;return[e,t]},useMutableSource:KR,useSyncExternalStore:$R,useId:dI,unstable_isNewReconciler:!1};function mp(e,t){try{var i="",n=t;do i+=Qk(n),n=n.return;while(n);var r=i}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:r,digest:null}}function s_(e,t,i){return{value:e,source:null,stack:i??null,digest:t??null}}function C3(e,t){try{console.error(t.value)}catch(i){setTimeout(function(){throw i})}}var SH=typeof WeakMap=="function"?WeakMap:Map;function gI(e,t,i){i=$o(-1,i),i.tag=3,i.payload={element:null};var n=t.value;return i.callback=function(){gy||(gy=!0,B3=n),C3(e,t)},i}function vI(e,t,i){i=$o(-1,i),i.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var r=t.value;i.payload=function(){return n(r)},i.callback=function(){C3(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(i.callback=function(){C3(e,t),typeof n!="function"&&(uc===null?uc=new Set([this]):uc.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),i}function $4(e,t,i){var n=e.pingCache;if(n===null){n=e.pingCache=new SH;var r=new Set;n.set(t,r)}else r=n.get(t),r===void 0&&(r=new Set,n.set(t,r));r.has(i)||(r.add(i),e=UH.bind(null,e,t,i),t.then(e,e))}function J4(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function eT(e,t,i,n,r){return e.mode&1?(e.flags|=65536,e.lanes=r,e):(e===t?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(t=$o(-1,1),t.tag=2,hc(i,t,1))),i.lanes|=1),e)}var MH=dl.ReactCurrentOwner,Er=!1;function rr(e,t,i,n){t.child=e===null?ZR(t,null,i,n):pp(t,e.child,i,n)}function tT(e,t,i,n,r){i=i.render;var s=t.ref;return Gd(t,r),n=LC(e,t,i,n,s,r),i=RC(),e!==null&&!Er?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,ll(e,t,r)):(yi&&i&&xC(t),t.flags|=1,rr(e,t,n,r),t.child)}function iT(e,t,i,n,r){if(e===null){var s=i.type;return typeof s=="function"&&!HC(s)&&s.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(t.tag=15,t.type=s,yI(e,t,s,n,r)):(e=Iv(i.type,null,n,t,t.mode,r),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&r)){var a=s.memoizedProps;if(i=i.compare,i=i!==null?i:l0,i(a,n)&&e.ref===t.ref)return ll(e,t,r)}return t.flags|=1,e=pc(s,n),e.ref=t.ref,e.return=t,t.child=e}function yI(e,t,i,n,r){if(e!==null){var s=e.memoizedProps;if(l0(s,n)&&e.ref===t.ref)if(Er=!1,t.pendingProps=n=s,(e.lanes&r)!==0)e.flags&131072&&(Er=!0);else return t.lanes=e.lanes,ll(e,t,r)}return E3(e,t,i,n,r)}function xI(e,t,i){var n=t.pendingProps,r=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},di(Cd,Yr),Yr|=i;else{if(!(i&1073741824))return e=s!==null?s.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,di(Cd,Yr),Yr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:i,di(Cd,Yr),Yr|=n}else s!==null?(n=s.baseLanes|i,t.memoizedState=null):n=i,di(Cd,Yr),Yr|=n;return rr(e,t,r,i),t.child}function _I(e,t){var i=t.ref;(e===null&&i!==null||e!==null&&e.ref!==i)&&(t.flags|=512,t.flags|=2097152)}function E3(e,t,i,n,r){var s=Lr(i)?Fh:Yn.current;return s=up(t,s),Gd(t,r),i=LC(e,t,i,n,s,r),n=RC(),e!==null&&!Er?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,ll(e,t,r)):(yi&&n&&xC(t),t.flags|=1,rr(e,t,i,r),t.child)}function nT(e,t,i,n,r){if(Lr(i)){var s=!0;ay(t)}else s=!1;if(Gd(t,r),t.stateNode===null)Dv(e,t),qR(t,i,n),M3(t,i,n,r),n=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=i.contextType;typeof c=="object"&&c!==null?c=Bs(c):(c=Lr(i)?Fh:Yn.current,c=up(t,c));var u=i.getDerivedStateFromProps,h=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==n||l!==c)&&Y4(t,a,n,c),Fl=!1;var d=t.memoizedState;a.state=d,uy(t,n,a,r),l=t.memoizedState,o!==n||d!==l||Dr.current||Fl?(typeof u=="function"&&(S3(t,i,u,n),l=t.memoizedState),(o=Fl||q4(t,i,o,n,d,l,c))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),a.props=n,a.state=l,a.context=c,n=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,WR(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Js(t.type,o),a.props=c,h=t.pendingProps,d=a.context,l=i.contextType,typeof l=="object"&&l!==null?l=Bs(l):(l=Lr(i)?Fh:Yn.current,l=up(t,l));var p=i.getDerivedStateFromProps;(u=typeof p=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||d!==l)&&Y4(t,a,n,l),Fl=!1,d=t.memoizedState,a.state=d,uy(t,n,a,r);var f=t.memoizedState;o!==h||d!==f||Dr.current||Fl?(typeof p=="function"&&(S3(t,i,p,n),f=t.memoizedState),(c=Fl||q4(t,i,c,n,d,f,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(n,f,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(n,f,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=f),a.props=n,a.state=f,a.context=l,n=c):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return A3(e,t,i,n,s,r)}function A3(e,t,i,n,r,s){_I(e,t);var a=(t.flags&128)!==0;if(!n&&!a)return r&&H4(t,i,!1),ll(e,t,s);n=t.stateNode,MH.current=t;var o=a&&typeof i.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&a?(t.child=pp(t,e.child,null,s),t.child=pp(t,null,o,s)):rr(e,t,o,s),t.memoizedState=n.state,r&&H4(t,i,!0),t.child}function bI(e){var t=e.stateNode;t.pendingContext?V4(e,t.pendingContext,t.pendingContext!==t.context):t.context&&V4(e,t.context,!1),AC(e,t.containerInfo)}function rT(e,t,i,n,r){return dp(),bC(r),t.flags|=256,rr(e,t,i,n),t.child}var T3={dehydrated:null,treeContext:null,retryLane:0};function P3(e){return{baseLanes:e,cachePool:null,transitions:null}}function wI(e,t,i){var n=t.pendingProps,r=_i.current,s=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(r&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(r|=1),di(_i,r&1),e===null)return b3(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=n.children,e=n.fallback,s?(n=t.mode,s=t.child,a={mode:"hidden",children:a},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=zx(a,n,0,null),e=Eh(e,n,i,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=P3(i),t.memoizedState=T3,e):BC(t,a));if(r=e.memoizedState,r!==null&&(o=r.dehydrated,o!==null))return CH(e,t,a,n,o,r,i);if(s){s=n.fallback,a=t.mode,r=e.child,o=r.sibling;var l={mode:"hidden",children:n.children};return!(a&1)&&t.child!==r?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=pc(r,l),n.subtreeFlags=r.subtreeFlags&14680064),o!==null?s=pc(o,s):(s=Eh(s,a,i,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,a=e.child.memoizedState,a=a===null?P3(i):{baseLanes:a.baseLanes|i,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~i,t.memoizedState=T3,n}return s=e.child,e=s.sibling,n=pc(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=i),n.return=t,n.sibling=null,e!==null&&(i=t.deletions,i===null?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=n,t.memoizedState=null,n}function BC(e,t){return t=zx({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Dg(e,t,i,n){return n!==null&&bC(n),pp(t,e.child,null,i),e=BC(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function CH(e,t,i,n,r,s,a){if(i)return t.flags&256?(t.flags&=-257,n=s_(Error(Ge(422))),Dg(e,t,a,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,r=t.mode,n=zx({mode:"visible",children:n.children},r,0,null),s=Eh(s,r,a,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&pp(t,e.child,null,a),t.child.memoizedState=P3(a),t.memoizedState=T3,s);if(!(t.mode&1))return Dg(e,t,a,null);if(r.data==="$!"){if(n=r.nextSibling&&r.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(Ge(419)),n=s_(s,n,void 0),Dg(e,t,a,n)}if(o=(a&e.childLanes)!==0,Er||o){if(n=Mn,n!==null){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(n.suspendedLanes|a)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,ol(e,r),fa(n,e,r,-1))}return VC(),n=s_(Error(Ge(421))),Dg(e,t,a,n)}return r.data==="$?"?(t.flags|=128,t.child=e.child,t=FH.bind(null,e),r._reactRetry=t,null):(e=s.treeContext,$r=cc(r.nextSibling),rs=t,yi=!0,ta=null,e!==null&&(Ms[Cs++]=Xo,Ms[Cs++]=qo,Ms[Cs++]=zh,Xo=e.id,qo=e.overflow,zh=t),t=BC(t,n.children),t.flags|=4096,t)}function sT(e,t,i){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),w3(e.return,t,i)}function a_(e,t,i,n,r){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:i,tailMode:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=i,s.tailMode=r)}function SI(e,t,i){var n=t.pendingProps,r=n.revealOrder,s=n.tail;if(rr(e,t,n.children,i),n=_i.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&sT(e,i,t);else if(e.tag===19)sT(e,i,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(di(_i,n),!(t.mode&1))t.memoizedState=null;else switch(r){case"forwards":for(i=t.child,r=null;i!==null;)e=i.alternate,e!==null&&dy(e)===null&&(r=i),i=i.sibling;i=r,i===null?(r=t.child,t.child=null):(r=i.sibling,i.sibling=null),a_(t,!1,r,i,s);break;case"backwards":for(i=null,r=t.child,t.child=null;r!==null;){if(e=r.alternate,e!==null&&dy(e)===null){t.child=r;break}e=r.sibling,r.sibling=i,i=r,r=e}a_(t,!0,i,null,s);break;case"together":a_(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Dv(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ll(e,t,i){if(e!==null&&(t.dependencies=e.dependencies),Vh|=t.lanes,!(i&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ge(153));if(t.child!==null){for(e=t.child,i=pc(e,e.pendingProps),t.child=i,i.return=t;e.sibling!==null;)e=e.sibling,i=i.sibling=pc(e,e.pendingProps),i.return=t;i.sibling=null}return t.child}function EH(e,t,i){switch(t.tag){case 3:bI(t),dp();break;case 5:QR(t);break;case 1:Lr(t.type)&&ay(t);break;case 4:AC(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,r=t.memoizedProps.value;di(cy,n._currentValue),n._currentValue=r;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(di(_i,_i.current&1),t.flags|=128,null):i&t.child.childLanes?wI(e,t,i):(di(_i,_i.current&1),e=ll(e,t,i),e!==null?e.sibling:null);di(_i,_i.current&1);break;case 19:if(n=(i&t.childLanes)!==0,e.flags&128){if(n)return SI(e,t,i);t.flags|=128}if(r=t.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),di(_i,_i.current),n)break;return null;case 22:case 23:return t.lanes=0,xI(e,t,i)}return ll(e,t,i)}var MI,D3,CI,EI;MI=function(e,t){for(var i=t.child;i!==null;){if(i.tag===5||i.tag===6)e.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};D3=function(){};CI=function(e,t,i,n){var r=e.memoizedProps;if(r!==n){e=t.stateNode,yh($a.current);var s=null;switch(i){case"input":r=$w(e,r),n=$w(e,n),s=[];break;case"select":r=Mi({},r,{value:void 0}),n=Mi({},n,{value:void 0}),s=[];break;case"textarea":r=t3(e,r),n=t3(e,n),s=[];break;default:typeof r.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=ry)}n3(i,n);var a;i=null;for(c in r)if(!n.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var o=r[c];for(a in o)o.hasOwnProperty(a)&&(i||(i={}),i[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(t0.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=r!=null?r[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(i||(i={}),i[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(i||(i={}),i[a]=l[a])}else i||(s||(s=[]),s.push(c,i)),i=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(t0.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&fi("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}i&&(s=s||[]).push("style",i);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};EI=function(e,t,i,n){i!==n&&(t.flags|=4)};function yf(e,t){if(!yi)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var n=null;i!==null;)i.alternate!==null&&(n=i),i=i.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Nn(e){var t=e.alternate!==null&&e.alternate.child===e.child,i=0,n=0;if(t)for(var r=e.child;r!==null;)i|=r.lanes|r.childLanes,n|=r.subtreeFlags&14680064,n|=r.flags&14680064,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)i|=r.lanes|r.childLanes,n|=r.subtreeFlags,n|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=n,e.childLanes=i,t}function AH(e,t,i){var n=t.pendingProps;switch(_C(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nn(t),null;case 1:return Lr(t.type)&&sy(),Nn(t),null;case 3:return n=t.stateNode,fp(),vi(Dr),vi(Yn),PC(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Tg(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ta!==null&&(F3(ta),ta=null))),D3(e,t),Nn(t),null;case 5:TC(t);var r=yh(p0.current);if(i=t.type,e!==null&&t.stateNode!=null)CI(e,t,i,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Ge(166));return Nn(t),null}if(e=yh($a.current),Tg(t)){n=t.stateNode,i=t.type;var s=t.memoizedProps;switch(n[Ga]=t,n[u0]=s,e=(t.mode&1)!==0,i){case"dialog":fi("cancel",n),fi("close",n);break;case"iframe":case"object":case"embed":fi("load",n);break;case"video":case"audio":for(r=0;r<lm.length;r++)fi(lm[r],n);break;case"source":fi("error",n);break;case"img":case"image":case"link":fi("error",n),fi("load",n);break;case"details":fi("toggle",n);break;case"input":f4(n,s),fi("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},fi("invalid",n);break;case"textarea":g4(n,s),fi("invalid",n)}n3(i,s),r=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&Ag(n.textContent,o,e),r=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&Ag(n.textContent,o,e),r=["children",""+o]):t0.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&fi("scroll",n)}switch(i){case"input":xg(n),m4(n,s,!0);break;case"textarea":xg(n),v4(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=ry)}n=r,t.updateQueue=n,n!==null&&(t.flags|=4)}else{a=r.nodeType===9?r:r.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=JL(i)),e==="http://www.w3.org/1999/xhtml"?i==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=a.createElement(i,{is:n.is}):(e=a.createElement(i),i==="select"&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,i),e[Ga]=t,e[u0]=n,MI(e,t,!1,!1),t.stateNode=e;e:{switch(a=r3(i,n),i){case"dialog":fi("cancel",e),fi("close",e),r=n;break;case"iframe":case"object":case"embed":fi("load",e),r=n;break;case"video":case"audio":for(r=0;r<lm.length;r++)fi(lm[r],e);r=n;break;case"source":fi("error",e),r=n;break;case"img":case"image":case"link":fi("error",e),fi("load",e),r=n;break;case"details":fi("toggle",e),r=n;break;case"input":f4(e,n),r=$w(e,n),fi("invalid",e);break;case"option":r=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},r=Mi({},n,{value:void 0}),fi("invalid",e);break;case"textarea":g4(e,n),r=t3(e,n),fi("invalid",e);break;default:r=n}n3(i,r),o=r;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?iR(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&eR(e,l)):s==="children"?typeof l=="string"?(i!=="textarea"||l!=="")&&i0(e,l):typeof l=="number"&&i0(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(t0.hasOwnProperty(s)?l!=null&&s==="onScroll"&&fi("scroll",e):l!=null&&sC(e,s,l,a))}switch(i){case"input":xg(e),m4(e,n,!1);break;case"textarea":xg(e),v4(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Cc(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?zd(e,!!n.multiple,s,!1):n.defaultValue!=null&&zd(e,!!n.multiple,n.defaultValue,!0);break;default:typeof r.onClick=="function"&&(e.onclick=ry)}switch(i){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Nn(t),null;case 6:if(e&&t.stateNode!=null)EI(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Ge(166));if(i=yh(p0.current),yh($a.current),Tg(t)){if(n=t.stateNode,i=t.memoizedProps,n[Ga]=t,(s=n.nodeValue!==i)&&(e=rs,e!==null))switch(e.tag){case 3:Ag(n.nodeValue,i,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ag(n.nodeValue,i,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(i.nodeType===9?i:i.ownerDocument).createTextNode(n),n[Ga]=t,t.stateNode=n}return Nn(t),null;case 13:if(vi(_i),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(yi&&$r!==null&&t.mode&1&&!(t.flags&128))GR(),dp(),t.flags|=98560,s=!1;else if(s=Tg(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(Ge(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Ge(317));s[Ga]=t}else dp(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Nn(t),s=!1}else ta!==null&&(F3(ta),ta=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=i,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||_i.current&1?on===0&&(on=3):VC())),t.updateQueue!==null&&(t.flags|=4),Nn(t),null);case 4:return fp(),D3(e,t),e===null&&c0(t.stateNode.containerInfo),Nn(t),null;case 10:return MC(t.type._context),Nn(t),null;case 17:return Lr(t.type)&&sy(),Nn(t),null;case 19:if(vi(_i),s=t.memoizedState,s===null)return Nn(t),null;if(n=(t.flags&128)!==0,a=s.rendering,a===null)if(n)yf(s,!1);else{if(on!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=dy(e),a!==null){for(t.flags|=128,yf(s,!1),n=a.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=i,i=t.child;i!==null;)s=i,e=n,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return di(_i,_i.current&1|2),t.child}e=e.sibling}s.tail!==null&&Ui()>gp&&(t.flags|=128,n=!0,yf(s,!1),t.lanes=4194304)}else{if(!n)if(e=dy(a),e!==null){if(t.flags|=128,n=!0,i=e.updateQueue,i!==null&&(t.updateQueue=i,t.flags|=4),yf(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!yi)return Nn(t),null}else 2*Ui()-s.renderingStartTime>gp&&i!==1073741824&&(t.flags|=128,n=!0,yf(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(i=s.last,i!==null?i.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Ui(),t.sibling=null,i=_i.current,di(_i,n?i&1|2:i&1),t):(Nn(t),null);case 22:case 23:return kC(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Yr&1073741824&&(Nn(t),t.subtreeFlags&6&&(t.flags|=8192)):Nn(t),null;case 24:return null;case 25:return null}throw Error(Ge(156,t.tag))}function TH(e,t){switch(_C(t),t.tag){case 1:return Lr(t.type)&&sy(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return fp(),vi(Dr),vi(Yn),PC(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return TC(t),null;case 13:if(vi(_i),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ge(340));dp()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return vi(_i),null;case 4:return fp(),null;case 10:return MC(t.type._context),null;case 22:case 23:return kC(),null;case 24:return null;default:return null}}var Lg=!1,kn=!1,PH=typeof WeakSet=="function"?WeakSet:Set,nt=null;function Md(e,t){var i=e.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(n){Ai(e,t,n)}else i.current=null}function L3(e,t,i){try{i()}catch(n){Ai(e,t,n)}}var aT=!1;function DH(e,t){if(f3=ty,e=DR(),yC(e)){if("selectionStart"in e)var i={start:e.selectionStart,end:e.selectionEnd};else e:{i=(i=e.ownerDocument)&&i.defaultView||window;var n=i.getSelection&&i.getSelection();if(n&&n.rangeCount!==0){i=n.anchorNode;var r=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{i.nodeType,s.nodeType}catch{i=null;break e}var a=0,o=-1,l=-1,c=0,u=0,h=e,d=null;t:for(;;){for(var p;h!==i||r!==0&&h.nodeType!==3||(o=a+r),h!==s||n!==0&&h.nodeType!==3||(l=a+n),h.nodeType===3&&(a+=h.nodeValue.length),(p=h.firstChild)!==null;)d=h,h=p;for(;;){if(h===e)break t;if(d===i&&++c===r&&(o=a),d===s&&++u===n&&(l=a),(p=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=p}i=o===-1||l===-1?null:{start:o,end:l}}else i=null}i=i||{start:0,end:0}}else i=null;for(m3={focusedElem:e,selectionRange:i},ty=!1,nt=t;nt!==null;)if(t=nt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,nt=e;else for(;nt!==null;){t=nt;try{var f=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var v=f.memoizedProps,m=f.memoizedState,g=t.stateNode,y=g.getSnapshotBeforeUpdate(t.elementType===t.type?v:Js(t.type,v),m);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ge(163))}}catch(_){Ai(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,nt=e;break}nt=t.return}return f=aT,aT=!1,f}function Em(e,t,i){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var r=n=n.next;do{if((r.tag&e)===e){var s=r.destroy;r.destroy=void 0,s!==void 0&&L3(t,i,s)}r=r.next}while(r!==n)}}function Ux(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var i=t=t.next;do{if((i.tag&e)===e){var n=i.create;i.destroy=n()}i=i.next}while(i!==t)}}function R3(e){var t=e.ref;if(t!==null){var i=e.stateNode;switch(e.tag){case 5:e=i;break;default:e=i}typeof t=="function"?t(e):t.current=e}}function AI(e){var t=e.alternate;t!==null&&(e.alternate=null,AI(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ga],delete t[u0],delete t[y3],delete t[dH],delete t[pH])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function TI(e){return e.tag===5||e.tag===3||e.tag===4}function oT(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||TI(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function I3(e,t,i){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?i.nodeType===8?i.parentNode.insertBefore(e,t):i.insertBefore(e,t):(i.nodeType===8?(t=i.parentNode,t.insertBefore(e,i)):(t=i,t.appendChild(e)),i=i._reactRootContainer,i!=null||t.onclick!==null||(t.onclick=ry));else if(n!==4&&(e=e.child,e!==null))for(I3(e,t,i),e=e.sibling;e!==null;)I3(e,t,i),e=e.sibling}function O3(e,t,i){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?i.insertBefore(e,t):i.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(O3(e,t,i),e=e.sibling;e!==null;)O3(e,t,i),e=e.sibling}var Pn=null,ea=!1;function gl(e,t,i){for(i=i.child;i!==null;)PI(e,t,i),i=i.sibling}function PI(e,t,i){if(Ka&&typeof Ka.onCommitFiberUnmount=="function")try{Ka.onCommitFiberUnmount(Px,i)}catch{}switch(i.tag){case 5:kn||Md(i,t);case 6:var n=Pn,r=ea;Pn=null,gl(e,t,i),Pn=n,ea=r,Pn!==null&&(ea?(e=Pn,i=i.stateNode,e.nodeType===8?e.parentNode.removeChild(i):e.removeChild(i)):Pn.removeChild(i.stateNode));break;case 18:Pn!==null&&(ea?(e=Pn,i=i.stateNode,e.nodeType===8?J2(e.parentNode,i):e.nodeType===1&&J2(e,i),a0(e)):J2(Pn,i.stateNode));break;case 4:n=Pn,r=ea,Pn=i.stateNode.containerInfo,ea=!0,gl(e,t,i),Pn=n,ea=r;break;case 0:case 11:case 14:case 15:if(!kn&&(n=i.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){r=n=n.next;do{var s=r,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&L3(i,t,a),r=r.next}while(r!==n)}gl(e,t,i);break;case 1:if(!kn&&(Md(i,t),n=i.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=i.memoizedProps,n.state=i.memoizedState,n.componentWillUnmount()}catch(o){Ai(i,t,o)}gl(e,t,i);break;case 21:gl(e,t,i);break;case 22:i.mode&1?(kn=(n=kn)||i.memoizedState!==null,gl(e,t,i),kn=n):gl(e,t,i);break;default:gl(e,t,i)}}function lT(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var i=e.stateNode;i===null&&(i=e.stateNode=new PH),t.forEach(function(n){var r=zH.bind(null,e,n);i.has(n)||(i.add(n),n.then(r,r))})}}function ks(e,t){var i=t.deletions;if(i!==null)for(var n=0;n<i.length;n++){var r=i[n];try{var s=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:Pn=o.stateNode,ea=!1;break e;case 3:Pn=o.stateNode.containerInfo,ea=!0;break e;case 4:Pn=o.stateNode.containerInfo,ea=!0;break e}o=o.return}if(Pn===null)throw Error(Ge(160));PI(s,a,r),Pn=null,ea=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){Ai(r,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)DI(t,e),t=t.sibling}function DI(e,t){var i=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ks(t,e),wa(e),n&4){try{Em(3,e,e.return),Ux(3,e)}catch(v){Ai(e,e.return,v)}try{Em(5,e,e.return)}catch(v){Ai(e,e.return,v)}}break;case 1:ks(t,e),wa(e),n&512&&i!==null&&Md(i,i.return);break;case 5:if(ks(t,e),wa(e),n&512&&i!==null&&Md(i,i.return),e.flags&32){var r=e.stateNode;try{i0(r,"")}catch(v){Ai(e,e.return,v)}}if(n&4&&(r=e.stateNode,r!=null)){var s=e.memoizedProps,a=i!==null?i.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&KL(r,s),r3(o,a);var c=r3(o,s);for(a=0;a<l.length;a+=2){var u=l[a],h=l[a+1];u==="style"?iR(r,h):u==="dangerouslySetInnerHTML"?eR(r,h):u==="children"?i0(r,h):sC(r,u,h,c)}switch(o){case"input":Jw(r,s);break;case"textarea":$L(r,s);break;case"select":var d=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?zd(r,!!s.multiple,p,!1):d!==!!s.multiple&&(s.defaultValue!=null?zd(r,!!s.multiple,s.defaultValue,!0):zd(r,!!s.multiple,s.multiple?[]:"",!1))}r[u0]=s}catch(v){Ai(e,e.return,v)}}break;case 6:if(ks(t,e),wa(e),n&4){if(e.stateNode===null)throw Error(Ge(162));r=e.stateNode,s=e.memoizedProps;try{r.nodeValue=s}catch(v){Ai(e,e.return,v)}}break;case 3:if(ks(t,e),wa(e),n&4&&i!==null&&i.memoizedState.isDehydrated)try{a0(t.containerInfo)}catch(v){Ai(e,e.return,v)}break;case 4:ks(t,e),wa(e);break;case 13:ks(t,e),wa(e),r=e.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(FC=Ui())),n&4&&lT(e);break;case 22:if(u=i!==null&&i.memoizedState!==null,e.mode&1?(kn=(c=kn)||u,ks(t,e),kn=c):ks(t,e),wa(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(nt=e,u=e.child;u!==null;){for(h=nt=u;nt!==null;){switch(d=nt,p=d.child,d.tag){case 0:case 11:case 14:case 15:Em(4,d,d.return);break;case 1:Md(d,d.return);var f=d.stateNode;if(typeof f.componentWillUnmount=="function"){n=d,i=d.return;try{t=n,f.props=t.memoizedProps,f.state=t.memoizedState,f.componentWillUnmount()}catch(v){Ai(n,i,v)}}break;case 5:Md(d,d.return);break;case 22:if(d.memoizedState!==null){hT(h);continue}}p!==null?(p.return=d,nt=p):hT(h)}u=u.sibling}e:for(u=null,h=e;;){if(h.tag===5){if(u===null){u=h;try{r=h.stateNode,c?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=tR("display",a))}catch(v){Ai(e,e.return,v)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(v){Ai(e,e.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ks(t,e),wa(e),n&4&&lT(e);break;case 21:break;default:ks(t,e),wa(e)}}function wa(e){var t=e.flags;if(t&2){try{e:{for(var i=e.return;i!==null;){if(TI(i)){var n=i;break e}i=i.return}throw Error(Ge(160))}switch(n.tag){case 5:var r=n.stateNode;n.flags&32&&(i0(r,""),n.flags&=-33);var s=oT(e);O3(e,s,r);break;case 3:case 4:var a=n.stateNode.containerInfo,o=oT(e);I3(e,o,a);break;default:throw Error(Ge(161))}}catch(l){Ai(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function LH(e,t,i){nt=e,LI(e)}function LI(e,t,i){for(var n=(e.mode&1)!==0;nt!==null;){var r=nt,s=r.child;if(r.tag===22&&n){var a=r.memoizedState!==null||Lg;if(!a){var o=r.alternate,l=o!==null&&o.memoizedState!==null||kn;o=Lg;var c=kn;if(Lg=a,(kn=l)&&!c)for(nt=r;nt!==null;)a=nt,l=a.child,a.tag===22&&a.memoizedState!==null?uT(r):l!==null?(l.return=a,nt=l):uT(r);for(;s!==null;)nt=s,LI(s),s=s.sibling;nt=r,Lg=o,kn=c}cT(e)}else r.subtreeFlags&8772&&s!==null?(s.return=r,nt=s):cT(e)}}function cT(e){for(;nt!==null;){var t=nt;if(t.flags&8772){var i=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:kn||Ux(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!kn)if(i===null)n.componentDidMount();else{var r=t.elementType===t.type?i.memoizedProps:Js(t.type,i.memoizedProps);n.componentDidUpdate(r,i.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&X4(t,s,n);break;case 3:var a=t.updateQueue;if(a!==null){if(i=null,t.child!==null)switch(t.child.tag){case 5:i=t.child.stateNode;break;case 1:i=t.child.stateNode}X4(t,a,i)}break;case 5:var o=t.stateNode;if(i===null&&t.flags&4){i=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&i.focus();break;case"img":l.src&&(i.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&a0(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ge(163))}kn||t.flags&512&&R3(t)}catch(d){Ai(t,t.return,d)}}if(t===e){nt=null;break}if(i=t.sibling,i!==null){i.return=t.return,nt=i;break}nt=t.return}}function hT(e){for(;nt!==null;){var t=nt;if(t===e){nt=null;break}var i=t.sibling;if(i!==null){i.return=t.return,nt=i;break}nt=t.return}}function uT(e){for(;nt!==null;){var t=nt;try{switch(t.tag){case 0:case 11:case 15:var i=t.return;try{Ux(4,t)}catch(l){Ai(t,i,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var r=t.return;try{n.componentDidMount()}catch(l){Ai(t,r,l)}}var s=t.return;try{R3(t)}catch(l){Ai(t,s,l)}break;case 5:var a=t.return;try{R3(t)}catch(l){Ai(t,a,l)}}}catch(l){Ai(t,t.return,l)}if(t===e){nt=null;break}var o=t.sibling;if(o!==null){o.return=t.return,nt=o;break}nt=t.return}}var RH=Math.ceil,my=dl.ReactCurrentDispatcher,NC=dl.ReactCurrentOwner,Ls=dl.ReactCurrentBatchConfig,Ht=0,Mn=null,Yi=null,Ln=0,Yr=0,Cd=Oc(0),on=0,v0=null,Vh=0,Fx=0,UC=0,Am=null,br=null,FC=0,gp=1/0,Uo=null,gy=!1,B3=null,uc=null,Rg=!1,Yl=null,vy=0,Tm=0,N3=null,Lv=-1,Rv=0;function pr(){return Ht&6?Ui():Lv!==-1?Lv:Lv=Ui()}function dc(e){return e.mode&1?Ht&2&&Ln!==0?Ln&-Ln:mH.transition!==null?(Rv===0&&(Rv=fR()),Rv):(e=Kt,e!==0||(e=window.event,e=e===void 0?16:bR(e.type)),e):1}function fa(e,t,i,n){if(50<Tm)throw Tm=0,N3=null,Error(Ge(185));W0(e,i,n),(!(Ht&2)||e!==Mn)&&(e===Mn&&(!(Ht&2)&&(Fx|=i),on===4&&Gl(e,Ln)),Rr(e,n),i===1&&Ht===0&&!(t.mode&1)&&(gp=Ui()+500,Ox&&Bc()))}function Rr(e,t){var i=e.callbackNode;mV(e,t);var n=ey(e,e===Mn?Ln:0);if(n===0)i!==null&&_4(i),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(i!=null&&_4(i),t===1)e.tag===0?fH(dT.bind(null,e)):kR(dT.bind(null,e)),hH(function(){!(Ht&6)&&Bc()}),i=null;else{switch(mR(n)){case 1:i=hC;break;case 4:i=dR;break;case 16:i=Jv;break;case 536870912:i=pR;break;default:i=Jv}i=zI(i,RI.bind(null,e))}e.callbackPriority=t,e.callbackNode=i}}function RI(e,t){if(Lv=-1,Rv=0,Ht&6)throw Error(Ge(327));var i=e.callbackNode;if(jd()&&e.callbackNode!==i)return null;var n=ey(e,e===Mn?Ln:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=yy(e,n);else{t=n;var r=Ht;Ht|=2;var s=OI();(Mn!==e||Ln!==t)&&(Uo=null,gp=Ui()+500,Ch(e,t));do try{BH();break}catch(o){II(e,o)}while(1);SC(),my.current=s,Ht=r,Yi!==null?t=0:(Mn=null,Ln=0,t=on)}if(t!==0){if(t===2&&(r=c3(e),r!==0&&(n=r,t=U3(e,r))),t===1)throw i=v0,Ch(e,0),Gl(e,n),Rr(e,Ui()),i;if(t===6)Gl(e,n);else{if(r=e.current.alternate,!(n&30)&&!IH(r)&&(t=yy(e,n),t===2&&(s=c3(e),s!==0&&(n=s,t=U3(e,s))),t===1))throw i=v0,Ch(e,0),Gl(e,n),Rr(e,Ui()),i;switch(e.finishedWork=r,e.finishedLanes=n,t){case 0:case 1:throw Error(Ge(345));case 2:th(e,br,Uo);break;case 3:if(Gl(e,n),(n&130023424)===n&&(t=FC+500-Ui(),10<t)){if(ey(e,0)!==0)break;if(r=e.suspendedLanes,(r&n)!==n){pr(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=v3(th.bind(null,e,br,Uo),t);break}th(e,br,Uo);break;case 4:if(Gl(e,n),(n&4194240)===n)break;for(t=e.eventTimes,r=-1;0<n;){var a=31-pa(n);s=1<<a,a=t[a],a>r&&(r=a),n&=~s}if(n=r,n=Ui()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*RH(n/1960))-n,10<n){e.timeoutHandle=v3(th.bind(null,e,br,Uo),n);break}th(e,br,Uo);break;case 5:th(e,br,Uo);break;default:throw Error(Ge(329))}}}return Rr(e,Ui()),e.callbackNode===i?RI.bind(null,e):null}function U3(e,t){var i=Am;return e.current.memoizedState.isDehydrated&&(Ch(e,t).flags|=256),e=yy(e,t),e!==2&&(t=br,br=i,t!==null&&F3(t)),e}function F3(e){br===null?br=e:br.push.apply(br,e)}function IH(e){for(var t=e;;){if(t.flags&16384){var i=t.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var n=0;n<i.length;n++){var r=i[n],s=r.getSnapshot;r=r.value;try{if(!ga(s(),r))return!1}catch{return!1}}}if(i=t.child,t.subtreeFlags&16384&&i!==null)i.return=t,t=i;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Gl(e,t){for(t&=~UC,t&=~Fx,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-pa(t),n=1<<i;e[i]=-1,t&=~n}}function dT(e){if(Ht&6)throw Error(Ge(327));jd();var t=ey(e,0);if(!(t&1))return Rr(e,Ui()),null;var i=yy(e,t);if(e.tag!==0&&i===2){var n=c3(e);n!==0&&(t=n,i=U3(e,n))}if(i===1)throw i=v0,Ch(e,0),Gl(e,t),Rr(e,Ui()),i;if(i===6)throw Error(Ge(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,th(e,br,Uo),Rr(e,Ui()),null}function zC(e,t){var i=Ht;Ht|=1;try{return e(t)}finally{Ht=i,Ht===0&&(gp=Ui()+500,Ox&&Bc())}}function Hh(e){Yl!==null&&Yl.tag===0&&!(Ht&6)&&jd();var t=Ht;Ht|=1;var i=Ls.transition,n=Kt;try{if(Ls.transition=null,Kt=1,e)return e()}finally{Kt=n,Ls.transition=i,Ht=t,!(Ht&6)&&Bc()}}function kC(){Yr=Cd.current,vi(Cd)}function Ch(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(i!==-1&&(e.timeoutHandle=-1,cH(i)),Yi!==null)for(i=Yi.return;i!==null;){var n=i;switch(_C(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&sy();break;case 3:fp(),vi(Dr),vi(Yn),PC();break;case 5:TC(n);break;case 4:fp();break;case 13:vi(_i);break;case 19:vi(_i);break;case 10:MC(n.type._context);break;case 22:case 23:kC()}i=i.return}if(Mn=e,Yi=e=pc(e.current,null),Ln=Yr=t,on=0,v0=null,UC=Fx=Vh=0,br=Am=null,vh!==null){for(t=0;t<vh.length;t++)if(i=vh[t],n=i.interleaved,n!==null){i.interleaved=null;var r=n.next,s=i.pending;if(s!==null){var a=s.next;s.next=r,n.next=a}i.pending=n}vh=null}return e}function II(e,t){do{var i=Yi;try{if(SC(),Tv.current=fy,py){for(var n=Si.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}py=!1}if(kh=0,_n=sn=Si=null,Cm=!1,f0=0,NC.current=null,i===null||i.return===null){on=1,v0=t,Yi=null;break}e:{var s=e,a=i.return,o=i,l=t;if(t=Ln,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var p=J4(a);if(p!==null){p.flags&=-257,eT(p,a,o,s,t),p.mode&1&&$4(s,c,t),t=p,l=c;var f=t.updateQueue;if(f===null){var v=new Set;v.add(l),t.updateQueue=v}else f.add(l);break e}else{if(!(t&1)){$4(s,c,t),VC();break e}l=Error(Ge(426))}}else if(yi&&o.mode&1){var m=J4(a);if(m!==null){!(m.flags&65536)&&(m.flags|=256),eT(m,a,o,s,t),bC(mp(l,o));break e}}s=l=mp(l,o),on!==4&&(on=2),Am===null?Am=[s]:Am.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var g=gI(s,l,t);W4(s,g);break e;case 1:o=l;var y=s.type,x=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(uc===null||!uc.has(x)))){s.flags|=65536,t&=-t,s.lanes|=t;var _=vI(s,o,t);W4(s,_);break e}}s=s.return}while(s!==null)}NI(i)}catch(b){t=b,Yi===i&&i!==null&&(Yi=i=i.return);continue}break}while(1)}function OI(){var e=my.current;return my.current=fy,e===null?fy:e}function VC(){(on===0||on===3||on===2)&&(on=4),Mn===null||!(Vh&268435455)&&!(Fx&268435455)||Gl(Mn,Ln)}function yy(e,t){var i=Ht;Ht|=2;var n=OI();(Mn!==e||Ln!==t)&&(Uo=null,Ch(e,t));do try{OH();break}catch(r){II(e,r)}while(1);if(SC(),Ht=i,my.current=n,Yi!==null)throw Error(Ge(261));return Mn=null,Ln=0,on}function OH(){for(;Yi!==null;)BI(Yi)}function BH(){for(;Yi!==null&&!aV();)BI(Yi)}function BI(e){var t=FI(e.alternate,e,Yr);e.memoizedProps=e.pendingProps,t===null?NI(e):Yi=t,NC.current=null}function NI(e){var t=e;do{var i=t.alternate;if(e=t.return,t.flags&32768){if(i=TH(i,t),i!==null){i.flags&=32767,Yi=i;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{on=6,Yi=null;return}}else if(i=AH(i,t,Yr),i!==null){Yi=i;return}if(t=t.sibling,t!==null){Yi=t;return}Yi=t=e}while(t!==null);on===0&&(on=5)}function th(e,t,i){var n=Kt,r=Ls.transition;try{Ls.transition=null,Kt=1,NH(e,t,i,n)}finally{Ls.transition=r,Kt=n}return null}function NH(e,t,i,n){do jd();while(Yl!==null);if(Ht&6)throw Error(Ge(327));i=e.finishedWork;var r=e.finishedLanes;if(i===null)return null;if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(Ge(177));e.callbackNode=null,e.callbackPriority=0;var s=i.lanes|i.childLanes;if(gV(e,s),e===Mn&&(Yi=Mn=null,Ln=0),!(i.subtreeFlags&2064)&&!(i.flags&2064)||Rg||(Rg=!0,zI(Jv,function(){return jd(),null})),s=(i.flags&15990)!==0,i.subtreeFlags&15990||s){s=Ls.transition,Ls.transition=null;var a=Kt;Kt=1;var o=Ht;Ht|=4,NC.current=null,DH(e,i),DI(i,e),iH(m3),ty=!!f3,m3=f3=null,e.current=i,LH(i),oV(),Ht=o,Kt=a,Ls.transition=s}else e.current=i;if(Rg&&(Rg=!1,Yl=e,vy=r),s=e.pendingLanes,s===0&&(uc=null),hV(i.stateNode),Rr(e,Ui()),t!==null)for(n=e.onRecoverableError,i=0;i<t.length;i++)r=t[i],n(r.value,{componentStack:r.stack,digest:r.digest});if(gy)throw gy=!1,e=B3,B3=null,e;return vy&1&&e.tag!==0&&jd(),s=e.pendingLanes,s&1?e===N3?Tm++:(Tm=0,N3=e):Tm=0,Bc(),null}function jd(){if(Yl!==null){var e=mR(vy),t=Ls.transition,i=Kt;try{if(Ls.transition=null,Kt=16>e?16:e,Yl===null)var n=!1;else{if(e=Yl,Yl=null,vy=0,Ht&6)throw Error(Ge(331));var r=Ht;for(Ht|=4,nt=e.current;nt!==null;){var s=nt,a=s.child;if(nt.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(nt=c;nt!==null;){var u=nt;switch(u.tag){case 0:case 11:case 15:Em(8,u,s)}var h=u.child;if(h!==null)h.return=u,nt=h;else for(;nt!==null;){u=nt;var d=u.sibling,p=u.return;if(AI(u),u===c){nt=null;break}if(d!==null){d.return=p,nt=d;break}nt=p}}}var f=s.alternate;if(f!==null){var v=f.child;if(v!==null){f.child=null;do{var m=v.sibling;v.sibling=null,v=m}while(v!==null)}}nt=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,nt=a;else e:for(;nt!==null;){if(s=nt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Em(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,nt=g;break e}nt=s.return}}var y=e.current;for(nt=y;nt!==null;){a=nt;var x=a.child;if(a.subtreeFlags&2064&&x!==null)x.return=a,nt=x;else e:for(a=y;nt!==null;){if(o=nt,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Ux(9,o)}}catch(b){Ai(o,o.return,b)}if(o===a){nt=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,nt=_;break e}nt=o.return}}if(Ht=r,Bc(),Ka&&typeof Ka.onPostCommitFiberRoot=="function")try{Ka.onPostCommitFiberRoot(Px,e)}catch{}n=!0}return n}finally{Kt=i,Ls.transition=t}}return!1}function pT(e,t,i){t=mp(i,t),t=gI(e,t,1),e=hc(e,t,1),t=pr(),e!==null&&(W0(e,1,t),Rr(e,t))}function Ai(e,t,i){if(e.tag===3)pT(e,e,i);else for(;t!==null;){if(t.tag===3){pT(t,e,i);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(uc===null||!uc.has(n))){e=mp(i,e),e=vI(t,e,1),t=hc(t,e,1),e=pr(),t!==null&&(W0(t,1,e),Rr(t,e));break}}t=t.return}}function UH(e,t,i){var n=e.pingCache;n!==null&&n.delete(t),t=pr(),e.pingedLanes|=e.suspendedLanes&i,Mn===e&&(Ln&i)===i&&(on===4||on===3&&(Ln&130023424)===Ln&&500>Ui()-FC?Ch(e,0):UC|=i),Rr(e,t)}function UI(e,t){t===0&&(e.mode&1?(t=wg,wg<<=1,!(wg&130023424)&&(wg=4194304)):t=1);var i=pr();e=ol(e,t),e!==null&&(W0(e,t,i),Rr(e,i))}function FH(e){var t=e.memoizedState,i=0;t!==null&&(i=t.retryLane),UI(e,i)}function zH(e,t){var i=0;switch(e.tag){case 13:var n=e.stateNode,r=e.memoizedState;r!==null&&(i=r.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Ge(314))}n!==null&&n.delete(t),UI(e,i)}var FI;FI=function(e,t,i){if(e!==null)if(e.memoizedProps!==t.pendingProps||Dr.current)Er=!0;else{if(!(e.lanes&i)&&!(t.flags&128))return Er=!1,EH(e,t,i);Er=!!(e.flags&131072)}else Er=!1,yi&&t.flags&1048576&&VR(t,ly,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Dv(e,t),e=t.pendingProps;var r=up(t,Yn.current);Gd(t,i),r=LC(null,t,n,e,r,i);var s=RC();return t.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Lr(n)?(s=!0,ay(t)):s=!1,t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,EC(t),r.updater=Bx,t.stateNode=r,r._reactInternals=t,M3(t,n,e,i),t=A3(null,t,n,!0,s,i)):(t.tag=0,yi&&s&&xC(t),rr(null,t,r,i),t=t.child),t;case 16:n=t.elementType;e:{switch(Dv(e,t),e=t.pendingProps,r=n._init,n=r(n._payload),t.type=n,r=t.tag=VH(n),e=Js(n,e),r){case 0:t=E3(null,t,n,e,i);break e;case 1:t=nT(null,t,n,e,i);break e;case 11:t=tT(null,t,n,e,i);break e;case 14:t=iT(null,t,n,Js(n.type,e),i);break e}throw Error(Ge(306,n,""))}return t;case 0:return n=t.type,r=t.pendingProps,r=t.elementType===n?r:Js(n,r),E3(e,t,n,r,i);case 1:return n=t.type,r=t.pendingProps,r=t.elementType===n?r:Js(n,r),nT(e,t,n,r,i);case 3:e:{if(bI(t),e===null)throw Error(Ge(387));n=t.pendingProps,s=t.memoizedState,r=s.element,WR(e,t),uy(t,n,null,i);var a=t.memoizedState;if(n=a.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){r=mp(Error(Ge(423)),t),t=rT(e,t,n,i,r);break e}else if(n!==r){r=mp(Error(Ge(424)),t),t=rT(e,t,n,i,r);break e}else for($r=cc(t.stateNode.containerInfo.firstChild),rs=t,yi=!0,ta=null,i=ZR(t,null,n,i),t.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(dp(),n===r){t=ll(e,t,i);break e}rr(e,t,n,i)}t=t.child}return t;case 5:return QR(t),e===null&&b3(t),n=t.type,r=t.pendingProps,s=e!==null?e.memoizedProps:null,a=r.children,g3(n,r)?a=null:s!==null&&g3(n,s)&&(t.flags|=32),_I(e,t),rr(e,t,a,i),t.child;case 6:return e===null&&b3(t),null;case 13:return wI(e,t,i);case 4:return AC(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=pp(t,null,n,i):rr(e,t,n,i),t.child;case 11:return n=t.type,r=t.pendingProps,r=t.elementType===n?r:Js(n,r),tT(e,t,n,r,i);case 7:return rr(e,t,t.pendingProps,i),t.child;case 8:return rr(e,t,t.pendingProps.children,i),t.child;case 12:return rr(e,t,t.pendingProps.children,i),t.child;case 10:e:{if(n=t.type._context,r=t.pendingProps,s=t.memoizedProps,a=r.value,di(cy,n._currentValue),n._currentValue=a,s!==null)if(ga(s.value,a)){if(s.children===r.children&&!Dr.current){t=ll(e,t,i);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=$o(-1,i&-i),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=i,l=s.alternate,l!==null&&(l.lanes|=i),w3(s.return,i,t),o.lanes|=i;break}l=l.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Ge(341));a.lanes|=i,o=a.alternate,o!==null&&(o.lanes|=i),w3(a,i,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}rr(e,t,r.children,i),t=t.child}return t;case 9:return r=t.type,n=t.pendingProps.children,Gd(t,i),r=Bs(r),n=n(r),t.flags|=1,rr(e,t,n,i),t.child;case 14:return n=t.type,r=Js(n,t.pendingProps),r=Js(n.type,r),iT(e,t,n,r,i);case 15:return yI(e,t,t.type,t.pendingProps,i);case 17:return n=t.type,r=t.pendingProps,r=t.elementType===n?r:Js(n,r),Dv(e,t),t.tag=1,Lr(n)?(e=!0,ay(t)):e=!1,Gd(t,i),qR(t,n,r),M3(t,n,r,i),A3(null,t,n,!0,e,i);case 19:return SI(e,t,i);case 22:return xI(e,t,i)}throw Error(Ge(156,t.tag))};function zI(e,t){return uR(e,t)}function kH(e,t,i,n){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ds(e,t,i,n){return new kH(e,t,i,n)}function HC(e){return e=e.prototype,!(!e||!e.isReactComponent)}function VH(e){if(typeof e=="function")return HC(e)?1:0;if(e!=null){if(e=e.$$typeof,e===oC)return 11;if(e===lC)return 14}return 2}function pc(e,t){var i=e.alternate;return i===null?(i=Ds(e.tag,t,e.key,e.mode),i.elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=e.flags&14680064,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function Iv(e,t,i,n,r,s){var a=2;if(n=e,typeof e=="function")HC(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case md:return Eh(i.children,r,s,t);case aC:a=8,r|=8;break;case Yw:return e=Ds(12,i,t,r|2),e.elementType=Yw,e.lanes=s,e;case Zw:return e=Ds(13,i,t,r),e.elementType=Zw,e.lanes=s,e;case Qw:return e=Ds(19,i,t,r),e.elementType=Qw,e.lanes=s,e;case YL:return zx(i,r,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case XL:a=10;break e;case qL:a=9;break e;case oC:a=11;break e;case lC:a=14;break e;case Ul:a=16,n=null;break e}throw Error(Ge(130,e==null?e:typeof e,""))}return t=Ds(a,i,t,r),t.elementType=e,t.type=n,t.lanes=s,t}function Eh(e,t,i,n){return e=Ds(7,e,n,t),e.lanes=i,e}function zx(e,t,i,n){return e=Ds(22,e,n,t),e.elementType=YL,e.lanes=i,e.stateNode={isHidden:!1},e}function o_(e,t,i){return e=Ds(6,e,null,t),e.lanes=i,e}function l_(e,t,i){return t=Ds(4,e.children!==null?e.children:[],e.key,t),t.lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function HH(e,t,i,n,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=H2(0),this.expirationTimes=H2(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=H2(0),this.identifierPrefix=n,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function GC(e,t,i,n,r,s,a,o,l){return e=new HH(e,t,i,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Ds(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},EC(s),e}function GH(e,t,i){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:fd,key:n==null?null:""+n,children:e,containerInfo:t,implementation:i}}function kI(e){if(!e)return Ec;e=e._reactInternals;e:{if(eu(e)!==e||e.tag!==1)throw Error(Ge(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Lr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ge(171))}if(e.tag===1){var i=e.type;if(Lr(i))return zR(e,i,t)}return t}function VI(e,t,i,n,r,s,a,o,l){return e=GC(i,n,!0,e,r,s,a,o,l),e.context=kI(null),i=e.current,n=pr(),r=dc(i),s=$o(n,r),s.callback=t??null,hc(i,s,r),e.current.lanes=r,W0(e,r,n),Rr(e,n),e}function kx(e,t,i,n){var r=t.current,s=pr(),a=dc(r);return i=kI(i),t.context===null?t.context=i:t.pendingContext=i,t=$o(s,a),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=hc(r,t,a),e!==null&&(fa(e,r,a,s),Av(e,r,a)),a}function xy(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function fT(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var i=e.retryLane;e.retryLane=i!==0&&i<t?i:t}}function jC(e,t){fT(e,t),(e=e.alternate)&&fT(e,t)}function jH(){return null}var HI=typeof reportError=="function"?reportError:function(e){console.error(e)};function WC(e){this._internalRoot=e}Vx.prototype.render=WC.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ge(409));kx(e,t,null,null)};Vx.prototype.unmount=WC.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Hh(function(){kx(null,e,null,null)}),t[al]=null}};function Vx(e){this._internalRoot=e}Vx.prototype.unstable_scheduleHydration=function(e){if(e){var t=yR();e={blockedOn:null,target:e,priority:t};for(var i=0;i<Hl.length&&t!==0&&t<Hl[i].priority;i++);Hl.splice(i,0,e),i===0&&_R(e)}};function XC(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Hx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function mT(){}function WH(e,t,i,n,r){if(r){if(typeof n=="function"){var s=n;n=function(){var c=xy(a);s.call(c)}}var a=VI(t,n,e,0,null,!1,!1,"",mT);return e._reactRootContainer=a,e[al]=a.current,c0(e.nodeType===8?e.parentNode:e),Hh(),a}for(;r=e.lastChild;)e.removeChild(r);if(typeof n=="function"){var o=n;n=function(){var c=xy(l);o.call(c)}}var l=GC(e,0,!1,null,null,!1,!1,"",mT);return e._reactRootContainer=l,e[al]=l.current,c0(e.nodeType===8?e.parentNode:e),Hh(function(){kx(t,l,i,n)}),l}function Gx(e,t,i,n,r){var s=i._reactRootContainer;if(s){var a=s;if(typeof r=="function"){var o=r;r=function(){var l=xy(a);o.call(l)}}kx(t,a,e,r)}else a=WH(i,t,e,r,n);return xy(a)}gR=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var i=om(t.pendingLanes);i!==0&&(uC(t,i|1),Rr(t,Ui()),!(Ht&6)&&(gp=Ui()+500,Bc()))}break;case 13:Hh(function(){var n=ol(e,1);if(n!==null){var r=pr();fa(n,e,1,r)}}),jC(e,1)}};dC=function(e){if(e.tag===13){var t=ol(e,134217728);if(t!==null){var i=pr();fa(t,e,134217728,i)}jC(e,134217728)}};vR=function(e){if(e.tag===13){var t=dc(e),i=ol(e,t);if(i!==null){var n=pr();fa(i,e,t,n)}jC(e,t)}};yR=function(){return Kt};xR=function(e,t){var i=Kt;try{return Kt=e,t()}finally{Kt=i}};a3=function(e,t,i){switch(t){case"input":if(Jw(e,i),t=i.name,i.type==="radio"&&t!=null){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var n=i[t];if(n!==e&&n.form===e.form){var r=Ix(n);if(!r)throw Error(Ge(90));QL(n),Jw(n,r)}}}break;case"textarea":$L(e,i);break;case"select":t=i.value,t!=null&&zd(e,!!i.multiple,t,!1)}};sR=zC;aR=Hh;var XH={usingClientEntryPoint:!1,Events:[q0,xd,Ix,nR,rR,zC]},xf={findFiberByHostInstance:gh,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},qH={bundleType:xf.bundleType,version:xf.version,rendererPackageName:xf.rendererPackageName,rendererConfig:xf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:dl.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=cR(e),e===null?null:e.stateNode},findFiberByHostInstance:xf.findFiberByHostInstance||jH,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ig=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ig.isDisabled&&Ig.supportsFiber)try{Px=Ig.inject(qH),Ka=Ig}catch{}}hs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XH;hs.createPortal=function(e,t){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!XC(t))throw Error(Ge(200));return GH(e,t,null,i)};hs.createRoot=function(e,t){if(!XC(e))throw Error(Ge(299));var i=!1,n="",r=HI;return t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(r=t.onRecoverableError)),t=GC(e,1,!1,null,null,i,!1,n,r),e[al]=t.current,c0(e.nodeType===8?e.parentNode:e),new WC(t)};hs.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ge(188)):(e=Object.keys(e).join(","),Error(Ge(268,e)));return e=cR(t),e=e===null?null:e.stateNode,e};hs.flushSync=function(e){return Hh(e)};hs.hydrate=function(e,t,i){if(!Hx(t))throw Error(Ge(200));return Gx(null,e,t,!0,i)};hs.hydrateRoot=function(e,t,i){if(!XC(e))throw Error(Ge(405));var n=i!=null&&i.hydratedSources||null,r=!1,s="",a=HI;if(i!=null&&(i.unstable_strictMode===!0&&(r=!0),i.identifierPrefix!==void 0&&(s=i.identifierPrefix),i.onRecoverableError!==void 0&&(a=i.onRecoverableError)),t=VI(t,null,e,1,i??null,r,!1,s,a),e[al]=t.current,c0(e),n)for(e=0;e<n.length;e++)i=n[e],r=i._getVersion,r=r(i._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[i,r]:t.mutableSourceEagerHydrationData.push(i,r);return new Vx(t)};hs.render=function(e,t,i){if(!Hx(t))throw Error(Ge(200));return Gx(null,e,t,!1,i)};hs.unmountComponentAtNode=function(e){if(!Hx(e))throw Error(Ge(40));return e._reactRootContainer?(Hh(function(){Gx(null,null,e,!1,function(){e._reactRootContainer=null,e[al]=null})}),!0):!1};hs.unstable_batchedUpdates=zC;hs.unstable_renderSubtreeIntoContainer=function(e,t,i,n){if(!Hx(i))throw Error(Ge(200));if(e==null||e._reactInternals===void 0)throw Error(Ge(38));return Gx(e,t,i,!1,n)};hs.version="18.2.0-next-9e3b772b8-20220608";function GI(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(GI)}catch(e){console.error(e)}}GI(),VL.exports=hs;var YH=VL.exports,gT=YH;Xw.createRoot=gT.createRoot,Xw.hydrateRoot=gT.hydrateRoot;/**
 * @remix-run/router v1.8.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _y(){return _y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},_y.apply(this,arguments)}var Zl;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Zl||(Zl={}));const vT="popstate";function ZH(e){e===void 0&&(e={});function t(n,r){let{pathname:s,search:a,hash:o}=n.location;return z3("",{pathname:s,search:a,hash:o},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function i(n,r){return typeof r=="string"?r:jI(r)}return KH(t,i,null,e)}function Ur(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function qC(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function QH(){return Math.random().toString(36).substr(2,8)}function yT(e,t){return{usr:e.state,key:e.key,idx:t}}function z3(e,t,i,n){return i===void 0&&(i=null),_y({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?jx(t):t,{state:i,key:t&&t.key||n||QH()})}function jI(e){let{pathname:t="/",search:i="",hash:n=""}=e;return i&&i!=="?"&&(t+=i.charAt(0)==="?"?i:"?"+i),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function jx(e){let t={};if(e){let i=e.indexOf("#");i>=0&&(t.hash=e.substr(i),e=e.substr(0,i));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function KH(e,t,i,n){n===void 0&&(n={});let{window:r=document.defaultView,v5Compat:s=!1}=n,a=r.history,o=Zl.Pop,l=null,c=u();c==null&&(c=0,a.replaceState(_y({},a.state,{idx:c}),""));function u(){return(a.state||{idx:null}).idx}function h(){o=Zl.Pop;let m=u(),g=m==null?null:m-c;c=m,l&&l({action:o,location:v.location,delta:g})}function d(m,g){o=Zl.Push;let y=z3(v.location,m,g);i&&i(y,m),c=u()+1;let x=yT(y,c),_=v.createHref(y);try{a.pushState(x,"",_)}catch(b){if(b instanceof DOMException&&b.name==="DataCloneError")throw b;r.location.assign(_)}s&&l&&l({action:o,location:v.location,delta:1})}function p(m,g){o=Zl.Replace;let y=z3(v.location,m,g);i&&i(y,m),c=u();let x=yT(y,c),_=v.createHref(y);a.replaceState(x,"",_),s&&l&&l({action:o,location:v.location,delta:0})}function f(m){let g=r.location.origin!=="null"?r.location.origin:r.location.href,y=typeof m=="string"?m:jI(m);return Ur(g,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,g)}let v={get action(){return o},get location(){return e(r,a)},listen(m){if(l)throw new Error("A history only accepts one active listener");return r.addEventListener(vT,h),l=m,()=>{r.removeEventListener(vT,h),l=null}},createHref(m){return t(r,m)},createURL:f,encodeLocation(m){let g=f(m);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:d,replace:p,go(m){return a.go(m)}};return v}var xT;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(xT||(xT={}));function $H(e,t,i){i===void 0&&(i="/");let n=typeof t=="string"?jx(t):t,r=qI(n.pathname||"/",i);if(r==null)return null;let s=WI(e);JH(s);let a=null;for(let o=0;a==null&&o<s.length;++o)a=lG(s[o],uG(r));return a}function WI(e,t,i,n){t===void 0&&(t=[]),i===void 0&&(i=[]),n===void 0&&(n="");let r=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(Ur(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=Wd([n,l.relativePath]),u=i.concat(l);s.children&&s.children.length>0&&(Ur(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),WI(s.children,t,u,c)),!(s.path==null&&!s.index)&&t.push({path:c,score:aG(c,s.index),routesMeta:u})};return e.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))r(s,a);else for(let l of XI(s.path))r(s,a,l)}),t}function XI(e){let t=e.split("/");if(t.length===0)return[];let[i,...n]=t,r=i.endsWith("?"),s=i.replace(/\?$/,"");if(n.length===0)return r?[s,""]:[s];let a=XI(n.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),r&&o.push(...a),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function JH(e){e.sort((t,i)=>t.score!==i.score?i.score-t.score:oG(t.routesMeta.map(n=>n.childrenIndex),i.routesMeta.map(n=>n.childrenIndex)))}const eG=/^:\w+$/,tG=3,iG=2,nG=1,rG=10,sG=-2,_T=e=>e==="*";function aG(e,t){let i=e.split("/"),n=i.length;return i.some(_T)&&(n+=sG),t&&(n+=iG),i.filter(r=>!_T(r)).reduce((r,s)=>r+(eG.test(s)?tG:s===""?nG:rG),n)}function oG(e,t){return e.length===t.length&&e.slice(0,-1).every((n,r)=>n===t[r])?e[e.length-1]-t[t.length-1]:0}function lG(e,t){let{routesMeta:i}=e,n={},r="/",s=[];for(let a=0;a<i.length;++a){let o=i[a],l=a===i.length-1,c=r==="/"?t:t.slice(r.length)||"/",u=cG({path:o.relativePath,caseSensitive:o.caseSensitive,end:l},c);if(!u)return null;Object.assign(n,u.params);let h=o.route;s.push({params:n,pathname:Wd([r,u.pathname]),pathnameBase:pG(Wd([r,u.pathnameBase])),route:h}),u.pathnameBase!=="/"&&(r=Wd([r,u.pathnameBase]))}return s}function cG(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[i,n]=hG(e.path,e.caseSensitive,e.end),r=t.match(i);if(!r)return null;let s=r[0],a=s.replace(/(.)\/+$/,"$1"),o=r.slice(1);return{params:n.reduce((c,u,h)=>{if(u==="*"){let d=o[h]||"";a=s.slice(0,s.length-d.length).replace(/(.)\/+$/,"$1")}return c[u]=dG(o[h]||"",u),c},{}),pathname:s,pathnameBase:a,pattern:e}}function hG(e,t,i){t===void 0&&(t=!1),i===void 0&&(i=!0),qC(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(a,o)=>(n.push(o),"/([^\\/]+)"));return e.endsWith("*")?(n.push("*"),r+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?r+="\\/*$":e!==""&&e!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),n]}function uG(e){try{return decodeURI(e)}catch(t){return qC(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function dG(e,t){try{return decodeURIComponent(e)}catch(i){return qC(!1,'The value for the URL param "'+t+'" will not be decoded because'+(' the string "'+e+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+i+").")),e}}function qI(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let i=t.endsWith("/")?t.length-1:t.length,n=e.charAt(i);return n&&n!=="/"?null:e.slice(i)||"/"}const Wd=e=>e.join("/").replace(/\/\/+/g,"/"),pG=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/");function fG(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const YI=["post","put","patch","delete"];new Set(YI);const mG=["get",...YI];new Set(mG);/**
 * React Router v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function k3(){return k3=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},k3.apply(this,arguments)}const gG=ze.createContext(null),vG=ze.createContext(null),ZI=ze.createContext(null),Wx=ze.createContext(null),Xx=ze.createContext({outlet:null,matches:[],isDataRoute:!1}),QI=ze.createContext(null);function YC(){return ze.useContext(Wx)!=null}function yG(){return YC()||Ur(!1),ze.useContext(Wx).location}function xG(e,t){return _G(e,t)}function _G(e,t,i){YC()||Ur(!1);let{navigator:n}=ze.useContext(ZI),{matches:r}=ze.useContext(Xx),s=r[r.length-1],a=s?s.params:{};s&&s.pathname;let o=s?s.pathnameBase:"/";s&&s.route;let l=yG(),c;if(t){var u;let v=typeof t=="string"?jx(t):t;o==="/"||(u=v.pathname)!=null&&u.startsWith(o)||Ur(!1),c=v}else c=l;let h=c.pathname||"/",d=o==="/"?h:h.slice(o.length)||"/",p=$H(e,{pathname:d}),f=CG(p&&p.map(v=>Object.assign({},v,{params:Object.assign({},a,v.params),pathname:Wd([o,n.encodeLocation?n.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?o:Wd([o,n.encodeLocation?n.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),r,i);return t&&f?ze.createElement(Wx.Provider,{value:{location:k3({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:Zl.Pop}},f):f}function bG(){let e=PG(),t=fG(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),i=e instanceof Error?e.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},s=null;return ze.createElement(ze.Fragment,null,ze.createElement("h2",null,"Unexpected Application Error!"),ze.createElement("h3",{style:{fontStyle:"italic"}},t),i?ze.createElement("pre",{style:r},i):null,s)}const wG=ze.createElement(bG,null);class SG extends ze.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,i){return i.location!==t.location||i.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error||i.error,location:i.location,revalidation:t.revalidation||i.revalidation}}componentDidCatch(t,i){console.error("React Router caught the following error during render",t,i)}render(){return this.state.error?ze.createElement(Xx.Provider,{value:this.props.routeContext},ze.createElement(QI.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function MG(e){let{routeContext:t,match:i,children:n}=e,r=ze.useContext(gG);return r&&r.static&&r.staticContext&&(i.route.errorElement||i.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=i.route.id),ze.createElement(Xx.Provider,{value:t},n)}function CG(e,t,i){var n;if(t===void 0&&(t=[]),i===void 0&&(i=null),e==null){var r;if((r=i)!=null&&r.errors)e=i.matches;else return null}let s=e,a=(n=i)==null?void 0:n.errors;if(a!=null){let o=s.findIndex(l=>l.route.id&&(a==null?void 0:a[l.route.id]));o>=0||Ur(!1),s=s.slice(0,Math.min(s.length,o+1))}return s.reduceRight((o,l,c)=>{let u=l.route.id?a==null?void 0:a[l.route.id]:null,h=null;i&&(h=l.route.errorElement||wG);let d=t.concat(s.slice(0,c+1)),p=()=>{let f;return u?f=h:l.route.Component?f=ze.createElement(l.route.Component,null):l.route.element?f=l.route.element:f=o,ze.createElement(MG,{match:l,routeContext:{outlet:o,matches:d,isDataRoute:i!=null},children:f})};return i&&(l.route.ErrorBoundary||l.route.errorElement||c===0)?ze.createElement(SG,{location:i.location,revalidation:i.revalidation,component:h,error:u,children:p(),routeContext:{outlet:null,matches:d,isDataRoute:!0}}):p()},null)}var V3=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(V3||{});function EG(e){let t=ze.useContext(vG);return t||Ur(!1),t}function AG(e){let t=ze.useContext(Xx);return t||Ur(!1),t}function TG(e){let t=AG(),i=t.matches[t.matches.length-1];return i.route.id||Ur(!1),i.route.id}function PG(){var e;let t=ze.useContext(QI),i=EG(V3.UseRouteError),n=TG(V3.UseRouteError);return t||((e=i.errors)==null?void 0:e[n])}function KI(e){Ur(!1)}function DG(e){let{basename:t="/",children:i=null,location:n,navigationType:r=Zl.Pop,navigator:s,static:a=!1}=e;YC()&&Ur(!1);let o=t.replace(/^\/*/,"/"),l=ze.useMemo(()=>({basename:o,navigator:s,static:a}),[o,s,a]);typeof n=="string"&&(n=jx(n));let{pathname:c="/",search:u="",hash:h="",state:d=null,key:p="default"}=n,f=ze.useMemo(()=>{let v=qI(c,o);return v==null?null:{location:{pathname:v,search:u,hash:h,state:d,key:p},navigationType:r}},[o,c,u,h,d,p,r]);return f==null?null:ze.createElement(ZI.Provider,{value:l},ze.createElement(Wx.Provider,{children:i,value:f}))}function LG(e){let{children:t,location:i}=e;return xG(H3(t),i)}new Promise(()=>{});function H3(e,t){t===void 0&&(t=[]);let i=[];return ze.Children.forEach(e,(n,r)=>{if(!ze.isValidElement(n))return;let s=[...t,r];if(n.type===ze.Fragment){i.push.apply(i,H3(n.props.children,s));return}n.type!==KI&&Ur(!1),!n.props.index||!n.props.children||Ur(!1);let a={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(a.children=H3(n.props.children,s)),i.push(a)}),i}/**
 * React Router DOM v6.15.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const RG="startTransition",bT=Fk[RG];function IG(e){let{basename:t,children:i,future:n,window:r}=e,s=ze.useRef();s.current==null&&(s.current=ZH({window:r,v5Compat:!0}));let a=s.current,[o,l]=ze.useState({action:a.action,location:a.location}),{v7_startTransition:c}=n||{},u=ze.useCallback(h=>{c&&bT?bT(()=>l(h)):l(h)},[l,c]);return ze.useLayoutEffect(()=>a.listen(u),[a,u]),ze.createElement(DG,{basename:t,children:i,location:o.location,navigationType:o.action,navigator:a})}var wT;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher"})(wT||(wT={}));var ST;(function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(ST||(ST={}));const OG="/assets/bg1p1-3c31f403.mp4",BG="/assets/placeholder-157c0f93.mp4",NG="/assets/placeholderdown-7d81cb56.mp4",UG="/assets/bottom-d5c2cb12.png",FG="/assets/boy-cfe0cf5a.png",zG="/assets/exchangevid-f6d5f11a.mp4",kG="/assets/postcommunity-316fe266.gif",VG="/assets/unstablepage-273313e0.mp4",HG="/assets/unstabletwo-eccdcfac.mp4",qx={bg1p1:OG,placeholder:BG,placeholderdown:NG,bottom:UG,boy:FG,exchangevid:zG,postcommunity:kG,unstablepage:VG,unstabletwo:HG},ZC=ze.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),Yx=ze.createContext({}),QC=ze.createContext(null),Zx=typeof document<"u",KC=Zx?ze.useLayoutEffect:ze.useEffect,$I=ze.createContext({strict:!1});function GG(e,t,i,n){const{visualElement:r}=ze.useContext(Yx),s=ze.useContext($I),a=ze.useContext(QC),o=ze.useContext(ZC).reducedMotion,l=ze.useRef();n=n||s.renderer,!l.current&&n&&(l.current=n(e,{visualState:t,parent:r,props:i,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:o}));const c=l.current;ze.useInsertionEffect(()=>{c&&c.update(i,a)});const u=ze.useRef(!!window.HandoffAppearAnimations);return KC(()=>{c&&(c.render(),u.current&&c.animationState&&c.animationState.animateChanges())}),ze.useEffect(()=>{c&&(c.updateFeatures(),!u.current&&c.animationState&&c.animationState.animateChanges(),window.HandoffAppearAnimations=void 0,u.current=!1)}),c}function Ed(e){return typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function jG(e,t,i){return ze.useCallback(n=>{n&&e.mount&&e.mount(n),t&&(n?t.mount(n):t.unmount()),i&&(typeof i=="function"?i(n):Ed(i)&&(i.current=n))},[t])}function y0(e){return typeof e=="string"||Array.isArray(e)}function Qx(e){return typeof e=="object"&&typeof e.start=="function"}const $C=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],JC=["initial",...$C];function Kx(e){return Qx(e.animate)||JC.some(t=>y0(e[t]))}function JI(e){return!!(Kx(e)||e.variants)}function WG(e,t){if(Kx(e)){const{initial:i,animate:n}=e;return{initial:i===!1||y0(i)?i:void 0,animate:y0(n)?n:void 0}}return e.inherit!==!1?t:{}}function XG(e){const{initial:t,animate:i}=WG(e,ze.useContext(Yx));return ze.useMemo(()=>({initial:t,animate:i}),[MT(t),MT(i)])}function MT(e){return Array.isArray(e)?e.join(" "):e}const CT={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},x0={};for(const e in CT)x0[e]={isEnabled:t=>CT[e].some(i=>!!t[i])};function qG(e){for(const t in e)x0[t]={...x0[t],...e[t]}}const eO=ze.createContext({}),tO=ze.createContext({}),YG=Symbol.for("motionComponentSymbol");function ZG({preloadedFeatures:e,createVisualElement:t,useRender:i,useVisualState:n,Component:r}){e&&qG(e);function s(o,l){let c;const u={...ze.useContext(ZC),...o,layoutId:QG(o)},{isStatic:h}=u,d=XG(o),p=n(o,h);if(!h&&Zx){d.visualElement=GG(r,p,u,t);const f=ze.useContext(tO),v=ze.useContext($I).strict;d.visualElement&&(c=d.visualElement.loadFeatures(u,v,e,f))}return ze.createElement(Yx.Provider,{value:d},c&&d.visualElement?ze.createElement(c,{visualElement:d.visualElement,...u}):null,i(r,o,jG(p,d.visualElement,l),p,h,d.visualElement))}const a=ze.forwardRef(s);return a[YG]=r,a}function QG({layoutId:e}){const t=ze.useContext(eO).id;return t&&e!==void 0?t+"-"+e:e}function KG(e){function t(n,r={}){return ZG(e(n,r))}if(typeof Proxy>"u")return t;const i=new Map;return new Proxy(t,{get:(n,r)=>(i.has(r)||i.set(r,t(r)),i.get(r))})}const $G=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function eE(e){return typeof e!="string"||e.includes("-")?!1:!!($G.indexOf(e)>-1||/[A-Z]/.test(e))}const by={};function JG(e){Object.assign(by,e)}const Z0=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],tu=new Set(Z0);function iO(e,{layout:t,layoutId:i}){return tu.has(e)||e.startsWith("origin")||(t||i!==void 0)&&(!!by[e]||e==="opacity")}const Fr=e=>!!(e&&e.getVelocity),ej={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},tj=Z0.length;function ij(e,{enableHardwareAcceleration:t=!0,allowTransformNone:i=!0},n,r){let s="";for(let a=0;a<tj;a++){const o=Z0[a];if(e[o]!==void 0){const l=ej[o]||o;s+=`${l}(${e[o]}) `}}return t&&!e.z&&(s+="translateZ(0)"),s=s.trim(),r?s=r(e,n?"":s):i&&n&&(s="none"),s}const nO=e=>t=>typeof t=="string"&&t.startsWith(e),rO=nO("--"),G3=nO("var(--"),nj=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,rj=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Ac=(e,t,i)=>Math.min(Math.max(i,e),t),iu={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Pm={...iu,transform:e=>Ac(0,1,e)},Og={...iu,default:1},Dm=e=>Math.round(e*1e5)/1e5,$x=/(-)?([\d]*\.?[\d])+/g,sO=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,sj=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Q0(e){return typeof e=="string"}const K0=e=>({test:t=>Q0(t)&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Bl=K0("deg"),Ja=K0("%"),xt=K0("px"),aj=K0("vh"),oj=K0("vw"),ET={...Ja,parse:e=>Ja.parse(e)/100,transform:e=>Ja.transform(e*100)},AT={...iu,transform:Math.round},aO={borderWidth:xt,borderTopWidth:xt,borderRightWidth:xt,borderBottomWidth:xt,borderLeftWidth:xt,borderRadius:xt,radius:xt,borderTopLeftRadius:xt,borderTopRightRadius:xt,borderBottomRightRadius:xt,borderBottomLeftRadius:xt,width:xt,maxWidth:xt,height:xt,maxHeight:xt,size:xt,top:xt,right:xt,bottom:xt,left:xt,padding:xt,paddingTop:xt,paddingRight:xt,paddingBottom:xt,paddingLeft:xt,margin:xt,marginTop:xt,marginRight:xt,marginBottom:xt,marginLeft:xt,rotate:Bl,rotateX:Bl,rotateY:Bl,rotateZ:Bl,scale:Og,scaleX:Og,scaleY:Og,scaleZ:Og,skew:Bl,skewX:Bl,skewY:Bl,distance:xt,translateX:xt,translateY:xt,translateZ:xt,x:xt,y:xt,z:xt,perspective:xt,transformPerspective:xt,opacity:Pm,originX:ET,originY:ET,originZ:xt,zIndex:AT,fillOpacity:Pm,strokeOpacity:Pm,numOctaves:AT};function tE(e,t,i,n){const{style:r,vars:s,transform:a,transformOrigin:o}=e;let l=!1,c=!1,u=!0;for(const h in t){const d=t[h];if(rO(h)){s[h]=d;continue}const p=aO[h],f=rj(d,p);if(tu.has(h)){if(l=!0,a[h]=f,!u)continue;d!==(p.default||0)&&(u=!1)}else h.startsWith("origin")?(c=!0,o[h]=f):r[h]=f}if(t.transform||(l||n?r.transform=ij(e.transform,i,u,n):r.transform&&(r.transform="none")),c){const{originX:h="50%",originY:d="50%",originZ:p=0}=o;r.transformOrigin=`${h} ${d} ${p}`}}const iE=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function oO(e,t,i){for(const n in t)!Fr(t[n])&&!iO(n,i)&&(e[n]=t[n])}function lj({transformTemplate:e},t,i){return ze.useMemo(()=>{const n=iE();return tE(n,t,{enableHardwareAcceleration:!i},e),Object.assign({},n.vars,n.style)},[t])}function cj(e,t,i){const n=e.style||{},r={};return oO(r,n,e),Object.assign(r,lj(e,t,i)),e.transformValues?e.transformValues(r):r}function hj(e,t,i){const n={},r=cj(e,t,i);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const uj=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onLayoutAnimationStart","onLayoutAnimationComplete","onLayoutMeasure","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","ignoreStrict","viewport"]);function wy(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||uj.has(e)}let lO=e=>!wy(e);function dj(e){e&&(lO=t=>t.startsWith("on")?!wy(t):e(t))}try{dj(require("@emotion/is-prop-valid").default)}catch{}function pj(e,t,i){const n={};for(const r in e)r==="values"&&typeof e.values=="object"||(lO(r)||i===!0&&wy(r)||!t&&!wy(r)||e.draggable&&r.startsWith("onDrag"))&&(n[r]=e[r]);return n}function TT(e,t,i){return typeof e=="string"?e:xt.transform(t+i*e)}function fj(e,t,i){const n=TT(t,e.x,e.width),r=TT(i,e.y,e.height);return`${n} ${r}`}const mj={offset:"stroke-dashoffset",array:"stroke-dasharray"},gj={offset:"strokeDashoffset",array:"strokeDasharray"};function vj(e,t,i=1,n=0,r=!0){e.pathLength=1;const s=r?mj:gj;e[s.offset]=xt.transform(-n);const a=xt.transform(t),o=xt.transform(i);e[s.array]=`${a} ${o}`}function nE(e,{attrX:t,attrY:i,attrScale:n,originX:r,originY:s,pathLength:a,pathSpacing:o=1,pathOffset:l=0,...c},u,h,d){if(tE(e,c,u,d),h){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:p,style:f,dimensions:v}=e;p.transform&&(v&&(f.transform=p.transform),delete p.transform),v&&(r!==void 0||s!==void 0||f.transform)&&(f.transformOrigin=fj(v,r!==void 0?r:.5,s!==void 0?s:.5)),t!==void 0&&(p.x=t),i!==void 0&&(p.y=i),n!==void 0&&(p.scale=n),a!==void 0&&vj(p,a,o,l,!1)}const cO=()=>({...iE(),attrs:{}}),rE=e=>typeof e=="string"&&e.toLowerCase()==="svg";function yj(e,t,i,n){const r=ze.useMemo(()=>{const s=cO();return nE(s,t,{enableHardwareAcceleration:!1},rE(n),e.transformTemplate),{...s.attrs,style:{...s.style}}},[t]);if(e.style){const s={};oO(s,e.style,e),r.style={...s,...r.style}}return r}function xj(e=!1){return(i,n,r,{latestValues:s},a)=>{const l=(eE(i)?yj:hj)(n,s,a,i),u={...pj(n,typeof i=="string",e),...l,ref:r},{children:h}=n,d=ze.useMemo(()=>Fr(h)?h.get():h,[h]);return ze.createElement(i,{...u,children:d})}}const sE=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();function hO(e,{style:t,vars:i},n,r){Object.assign(e.style,t,r&&r.getProjectionStyles(n));for(const s in i)e.style.setProperty(s,i[s])}const uO=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function dO(e,t,i,n){hO(e,t,void 0,n);for(const r in t.attrs)e.setAttribute(uO.has(r)?r:sE(r),t.attrs[r])}function aE(e,t){const{style:i}=e,n={};for(const r in i)(Fr(i[r])||t.style&&Fr(t.style[r])||iO(r,e))&&(n[r]=i[r]);return n}function pO(e,t){const i=aE(e,t);for(const n in e)if(Fr(e[n])||Fr(t[n])){const r=Z0.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;i[r]=e[n]}return i}function oE(e,t,i,n={},r={}){return typeof t=="function"&&(t=t(i!==void 0?i:e.custom,n,r)),typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"&&(t=t(i!==void 0?i:e.custom,n,r)),t}function Jx(e){const t=ze.useRef(null);return t.current===null&&(t.current=e()),t.current}const Sy=e=>Array.isArray(e),_j=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),bj=e=>Sy(e)?e[e.length-1]||0:e;function Ov(e){const t=Fr(e)?e.get():e;return _j(t)?t.toValue():t}function wj({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:i},n,r,s){const a={latestValues:Sj(n,r,s,e),renderState:t()};return i&&(a.mount=o=>i(n,o,a)),a}const fO=e=>(t,i)=>{const n=ze.useContext(Yx),r=ze.useContext(QC),s=()=>wj(e,t,n,r);return i?s():Jx(s)};function Sj(e,t,i,n){const r={},s=n(e,{});for(const d in s)r[d]=Ov(s[d]);let{initial:a,animate:o}=e;const l=Kx(e),c=JI(e);t&&c&&!l&&e.inherit!==!1&&(a===void 0&&(a=t.initial),o===void 0&&(o=t.animate));let u=i?i.initial===!1:!1;u=u||a===!1;const h=u?o:a;return h&&typeof h!="boolean"&&!Qx(h)&&(Array.isArray(h)?h:[h]).forEach(p=>{const f=oE(e,p);if(!f)return;const{transitionEnd:v,transition:m,...g}=f;for(const y in g){let x=g[y];if(Array.isArray(x)){const _=u?x.length-1:0;x=x[_]}x!==null&&(r[y]=x)}for(const y in v)r[y]=v[y]}),r}const Pi=e=>e;class PT{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){const i=this.order.indexOf(t);i!==-1&&(this.order.splice(i,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}}function Mj(e){let t=new PT,i=new PT,n=0,r=!1,s=!1;const a=new WeakSet,o={schedule:(l,c=!1,u=!1)=>{const h=u&&r,d=h?t:i;return c&&a.add(l),d.add(l)&&h&&r&&(n=t.order.length),l},cancel:l=>{i.remove(l),a.delete(l)},process:l=>{if(r){s=!0;return}if(r=!0,[t,i]=[i,t],i.clear(),n=t.order.length,n)for(let c=0;c<n;c++){const u=t.order[c];u(l),a.has(u)&&(o.schedule(u),e())}r=!1,s&&(s=!1,o.process(l))}};return o}const Bg=["prepare","read","update","preRender","render","postRender"],Cj=40;function Ej(e,t){let i=!1,n=!0;const r={delta:0,timestamp:0,isProcessing:!1},s=Bg.reduce((h,d)=>(h[d]=Mj(()=>i=!0),h),{}),a=h=>s[h].process(r),o=()=>{const h=performance.now();i=!1,r.delta=n?1e3/60:Math.max(Math.min(h-r.timestamp,Cj),1),r.timestamp=h,r.isProcessing=!0,Bg.forEach(a),r.isProcessing=!1,i&&t&&(n=!1,e(o))},l=()=>{i=!0,n=!0,r.isProcessing||e(o)};return{schedule:Bg.reduce((h,d)=>{const p=s[d];return h[d]=(f,v=!1,m=!1)=>(i||l(),p.schedule(f,v,m)),h},{}),cancel:h=>Bg.forEach(d=>s[d].cancel(h)),state:r,steps:s}}const{schedule:Xt,cancel:va,state:rn,steps:c_}=Ej(typeof requestAnimationFrame<"u"?requestAnimationFrame:Pi,!0),Aj={useVisualState:fO({scrapeMotionValuesFromProps:pO,createRenderState:cO,onMount:(e,t,{renderState:i,latestValues:n})=>{Xt.read(()=>{try{i.dimensions=typeof t.getBBox=="function"?t.getBBox():t.getBoundingClientRect()}catch{i.dimensions={x:0,y:0,width:0,height:0}}}),Xt.render(()=>{nE(i,n,{enableHardwareAcceleration:!1},rE(t.tagName),e.transformTemplate),dO(t,i)})}})},Tj={useVisualState:fO({scrapeMotionValuesFromProps:aE,createRenderState:iE})};function Pj(e,{forwardMotionProps:t=!1},i,n){return{...eE(e)?Aj:Tj,preloadedFeatures:i,useRender:xj(t),createVisualElement:n,Component:e}}function Yo(e,t,i,n={passive:!0}){return e.addEventListener(t,i,n),()=>e.removeEventListener(t,i)}const mO=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function e2(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}const Dj=e=>t=>mO(t)&&e(t,e2(t));function Jo(e,t,i,n){return Yo(e,t,Dj(i),n)}const Lj=(e,t)=>i=>t(e(i)),fc=(...e)=>e.reduce(Lj);function gO(e){let t=null;return()=>{const i=()=>{t=null};return t===null?(t=e,i):!1}}const DT=gO("dragHorizontal"),LT=gO("dragVertical");function vO(e){let t=!1;if(e==="y")t=LT();else if(e==="x")t=DT();else{const i=DT(),n=LT();i&&n?t=()=>{i(),n()}:(i&&i(),n&&n())}return t}function yO(){const e=vO(!0);return e?(e(),!1):!0}class Nc{constructor(t){this.isMounted=!1,this.node=t}update(){}}function RT(e,t){const i="pointer"+(t?"enter":"leave"),n="onHover"+(t?"Start":"End"),r=(s,a)=>{if(s.type==="touch"||yO())return;const o=e.getProps();e.animationState&&o.whileHover&&e.animationState.setActive("whileHover",t),o[n]&&Xt.update(()=>o[n](s,a))};return Jo(e.current,i,r,{passive:!e.getProps()[n]})}class Rj extends Nc{mount(){this.unmount=fc(RT(this.node,!0),RT(this.node,!1))}unmount(){}}class Ij extends Nc{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=fc(Yo(this.node.current,"focus",()=>this.onFocus()),Yo(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const xO=(e,t)=>t?e===t?!0:xO(e,t.parentElement):!1;function h_(e,t){if(!t)return;const i=new PointerEvent("pointer"+e);t(i,e2(i))}class Oj extends Nc{constructor(){super(...arguments),this.removeStartListeners=Pi,this.removeEndListeners=Pi,this.removeAccessibleListeners=Pi,this.startPointerPress=(t,i)=>{if(this.removeEndListeners(),this.isPressing)return;const n=this.node.getProps(),s=Jo(window,"pointerup",(o,l)=>{if(!this.checkPressEnd())return;const{onTap:c,onTapCancel:u}=this.node.getProps();Xt.update(()=>{xO(this.node.current,o.target)?c&&c(o,l):u&&u(o,l)})},{passive:!(n.onTap||n.onPointerUp)}),a=Jo(window,"pointercancel",(o,l)=>this.cancelPress(o,l),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=fc(s,a),this.startPress(t,i)},this.startAccessiblePress=()=>{const t=s=>{if(s.key!=="Enter"||this.isPressing)return;const a=o=>{o.key!=="Enter"||!this.checkPressEnd()||h_("up",(l,c)=>{const{onTap:u}=this.node.getProps();u&&Xt.update(()=>u(l,c))})};this.removeEndListeners(),this.removeEndListeners=Yo(this.node.current,"keyup",a),h_("down",(o,l)=>{this.startPress(o,l)})},i=Yo(this.node.current,"keydown",t),n=()=>{this.isPressing&&h_("cancel",(s,a)=>this.cancelPress(s,a))},r=Yo(this.node.current,"blur",n);this.removeAccessibleListeners=fc(i,r)}}startPress(t,i){this.isPressing=!0;const{onTapStart:n,whileTap:r}=this.node.getProps();r&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&Xt.update(()=>n(t,i))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!yO()}cancelPress(t,i){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&Xt.update(()=>n(t,i))}mount(){const t=this.node.getProps(),i=Jo(this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),n=Yo(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=fc(i,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const j3=new WeakMap,u_=new WeakMap,Bj=e=>{const t=j3.get(e.target);t&&t(e)},Nj=e=>{e.forEach(Bj)};function Uj({root:e,...t}){const i=e||document;u_.has(i)||u_.set(i,{});const n=u_.get(i),r=JSON.stringify(t);return n[r]||(n[r]=new IntersectionObserver(Nj,{root:e,...t})),n[r]}function Fj(e,t,i){const n=Uj(t);return j3.set(e,i),n.observe(e),()=>{j3.delete(e),n.unobserve(e)}}const zj={some:0,all:1};class kj extends Nc{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:i,margin:n,amount:r="some",once:s}=t,a={root:i?i.current:void 0,rootMargin:n,threshold:typeof r=="number"?r:zj[r]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,s&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),d=c?u:h;d&&d(l)};return Fj(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:i}=this.node;["amount","margin","root"].some(Vj(t,i))&&this.startObserver()}unmount(){}}function Vj({viewport:e={}},{viewport:t={}}={}){return i=>e[i]!==t[i]}const Hj={inView:{Feature:kj},tap:{Feature:Oj},focus:{Feature:Ij},hover:{Feature:Rj}};function _O(e,t){if(!Array.isArray(t))return!1;const i=t.length;if(i!==e.length)return!1;for(let n=0;n<i;n++)if(t[n]!==e[n])return!1;return!0}function Gj(e){const t={};return e.values.forEach((i,n)=>t[n]=i.get()),t}function jj(e){const t={};return e.values.forEach((i,n)=>t[n]=i.getVelocity()),t}function t2(e,t,i){const n=e.getProps();return oE(n,t,i!==void 0?i:n.custom,Gj(e),jj(e))}const Wj="framerAppearId",Xj="data-"+sE(Wj);let bO=Pi,i2=Pi;const mc=e=>e*1e3,el=e=>e/1e3,qj={current:!1},wO=e=>Array.isArray(e)&&typeof e[0]=="number";function SO(e){return!!(!e||typeof e=="string"&&MO[e]||wO(e)||Array.isArray(e)&&e.every(SO))}const cm=([e,t,i,n])=>`cubic-bezier(${e}, ${t}, ${i}, ${n})`,MO={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cm([0,.65,.55,1]),circOut:cm([.55,0,1,.45]),backIn:cm([.31,.01,.66,-.59]),backOut:cm([.33,1.53,.69,.99])};function CO(e){if(e)return wO(e)?cm(e):Array.isArray(e)?e.map(CO):MO[e]}function Yj(e,t,i,{delay:n=0,duration:r,repeat:s=0,repeatType:a="loop",ease:o,times:l}={}){const c={[t]:i};l&&(c.offset=l);const u=CO(o);return Array.isArray(u)&&(c.easing=u),e.animate(c,{delay:n,duration:r,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:s+1,direction:a==="reverse"?"alternate":"normal"})}function Zj(e,{repeat:t,repeatType:i="loop"}){const n=t&&i!=="loop"&&t%2===1?0:e.length-1;return e[n]}const EO=(e,t,i)=>(((1-3*i+3*t)*e+(3*i-6*t))*e+3*t)*e,Qj=1e-7,Kj=12;function $j(e,t,i,n,r){let s,a,o=0;do a=t+(i-t)/2,s=EO(a,n,r)-e,s>0?i=a:t=a;while(Math.abs(s)>Qj&&++o<Kj);return a}function $0(e,t,i,n){if(e===t&&i===n)return Pi;const r=s=>$j(s,0,1,e,i);return s=>s===0||s===1?s:EO(r(s),t,n)}const Jj=$0(.42,0,1,1),eW=$0(0,0,.58,1),AO=$0(.42,0,.58,1),tW=e=>Array.isArray(e)&&typeof e[0]!="number",TO=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,PO=e=>t=>1-e(1-t),DO=e=>1-Math.sin(Math.acos(e)),lE=PO(DO),iW=TO(lE),LO=$0(.33,1.53,.69,.99),cE=PO(LO),nW=TO(cE),rW=e=>(e*=2)<1?.5*cE(e):.5*(2-Math.pow(2,-10*(e-1))),sW={linear:Pi,easeIn:Jj,easeInOut:AO,easeOut:eW,circIn:DO,circInOut:iW,circOut:lE,backIn:cE,backInOut:nW,backOut:LO,anticipate:rW},IT=e=>{if(Array.isArray(e)){i2(e.length===4);const[t,i,n,r]=e;return $0(t,i,n,r)}else if(typeof e=="string")return sW[e];return e},hE=(e,t)=>i=>!!(Q0(i)&&sj.test(i)&&i.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(i,t)),RO=(e,t,i)=>n=>{if(!Q0(n))return n;const[r,s,a,o]=n.match($x);return{[e]:parseFloat(r),[t]:parseFloat(s),[i]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},aW=e=>Ac(0,255,e),d_={...iu,transform:e=>Math.round(aW(e))},xh={test:hE("rgb","red"),parse:RO("red","green","blue"),transform:({red:e,green:t,blue:i,alpha:n=1})=>"rgba("+d_.transform(e)+", "+d_.transform(t)+", "+d_.transform(i)+", "+Dm(Pm.transform(n))+")"};function oW(e){let t="",i="",n="",r="";return e.length>5?(t=e.substring(1,3),i=e.substring(3,5),n=e.substring(5,7),r=e.substring(7,9)):(t=e.substring(1,2),i=e.substring(2,3),n=e.substring(3,4),r=e.substring(4,5),t+=t,i+=i,n+=n,r+=r),{red:parseInt(t,16),green:parseInt(i,16),blue:parseInt(n,16),alpha:r?parseInt(r,16)/255:1}}const W3={test:hE("#"),parse:oW,transform:xh.transform},Ad={test:hE("hsl","hue"),parse:RO("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:i,alpha:n=1})=>"hsla("+Math.round(e)+", "+Ja.transform(Dm(t))+", "+Ja.transform(Dm(i))+", "+Dm(Pm.transform(n))+")"},nr={test:e=>xh.test(e)||W3.test(e)||Ad.test(e),parse:e=>xh.test(e)?xh.parse(e):Ad.test(e)?Ad.parse(e):W3.parse(e),transform:e=>Q0(e)?e:e.hasOwnProperty("red")?xh.transform(e):Ad.transform(e)},bi=(e,t,i)=>-i*e+i*t+e;function p_(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*(2/3-i)*6:e}function lW({hue:e,saturation:t,lightness:i,alpha:n}){e/=360,t/=100,i/=100;let r=0,s=0,a=0;if(!t)r=s=a=i;else{const o=i<.5?i*(1+t):i+t-i*t,l=2*i-o;r=p_(l,o,e+1/3),s=p_(l,o,e),a=p_(l,o,e-1/3)}return{red:Math.round(r*255),green:Math.round(s*255),blue:Math.round(a*255),alpha:n}}const f_=(e,t,i)=>{const n=e*e;return Math.sqrt(Math.max(0,i*(t*t-n)+n))},cW=[W3,xh,Ad],hW=e=>cW.find(t=>t.test(e));function OT(e){const t=hW(e);let i=t.parse(e);return t===Ad&&(i=lW(i)),i}const IO=(e,t)=>{const i=OT(e),n=OT(t),r={...i};return s=>(r.red=f_(i.red,n.red,s),r.green=f_(i.green,n.green,s),r.blue=f_(i.blue,n.blue,s),r.alpha=bi(i.alpha,n.alpha,s),xh.transform(r))};function uW(e){var t,i;return isNaN(e)&&Q0(e)&&(((t=e.match($x))===null||t===void 0?void 0:t.length)||0)+(((i=e.match(sO))===null||i===void 0?void 0:i.length)||0)>0}const OO={regex:nj,countKey:"Vars",token:"${v}",parse:Pi},BO={regex:sO,countKey:"Colors",token:"${c}",parse:nr.parse},NO={regex:$x,countKey:"Numbers",token:"${n}",parse:iu.parse};function m_(e,{regex:t,countKey:i,token:n,parse:r}){const s=e.tokenised.match(t);s&&(e["num"+i]=s.length,e.tokenised=e.tokenised.replace(t,n),e.values.push(...s.map(r)))}function My(e){const t=e.toString(),i={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return i.value.includes("var(--")&&m_(i,OO),m_(i,BO),m_(i,NO),i}function UO(e){return My(e).values}function FO(e){const{values:t,numColors:i,numVars:n,tokenised:r}=My(e),s=t.length;return a=>{let o=r;for(let l=0;l<s;l++)l<n?o=o.replace(OO.token,a[l]):l<n+i?o=o.replace(BO.token,nr.transform(a[l])):o=o.replace(NO.token,Dm(a[l]));return o}}const dW=e=>typeof e=="number"?0:e;function pW(e){const t=UO(e);return FO(e)(t.map(dW))}const Tc={test:uW,parse:UO,createTransformer:FO,getAnimatableNone:pW},zO=(e,t)=>i=>`${i>0?t:e}`;function kO(e,t){return typeof e=="number"?i=>bi(e,t,i):nr.test(e)?IO(e,t):e.startsWith("var(")?zO(e,t):HO(e,t)}const VO=(e,t)=>{const i=[...e],n=i.length,r=e.map((s,a)=>kO(s,t[a]));return s=>{for(let a=0;a<n;a++)i[a]=r[a](s);return i}},fW=(e,t)=>{const i={...e,...t},n={};for(const r in i)e[r]!==void 0&&t[r]!==void 0&&(n[r]=kO(e[r],t[r]));return r=>{for(const s in n)i[s]=n[s](r);return i}},HO=(e,t)=>{const i=Tc.createTransformer(t),n=My(e),r=My(t);return n.numVars===r.numVars&&n.numColors===r.numColors&&n.numNumbers>=r.numNumbers?fc(VO(n.values,r.values),i):zO(e,t)},vp=(e,t,i)=>{const n=t-e;return n===0?1:(i-e)/n},BT=(e,t)=>i=>bi(e,t,i);function mW(e){return typeof e=="number"?BT:typeof e=="string"?nr.test(e)?IO:HO:Array.isArray(e)?VO:typeof e=="object"?fW:BT}function gW(e,t,i){const n=[],r=i||mW(e[0]),s=e.length-1;for(let a=0;a<s;a++){let o=r(e[a],e[a+1]);if(t){const l=Array.isArray(t)?t[a]||Pi:t;o=fc(l,o)}n.push(o)}return n}function n2(e,t,{clamp:i=!0,ease:n,mixer:r}={}){const s=e.length;if(i2(s===t.length),s===1)return()=>t[0];e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());const a=gW(t,n,r),o=a.length,l=c=>{let u=0;if(o>1)for(;u<e.length-2&&!(c<e[u+1]);u++);const h=vp(e[u],e[u+1],c);return a[u](h)};return i?c=>l(Ac(e[0],e[s-1],c)):l}function vW(e,t){const i=e[e.length-1];for(let n=1;n<=t;n++){const r=vp(0,t,n);e.push(bi(i,1,r))}}function GO(e){const t=[0];return vW(t,e.length-1),t}function yW(e,t){return e.map(i=>i*t)}function xW(e,t){return e.map(()=>t||AO).splice(0,e.length-1)}function Cy({duration:e=300,keyframes:t,times:i,ease:n="easeInOut"}){const r=tW(n)?n.map(IT):IT(n),s={done:!1,value:t[0]},a=yW(i&&i.length===t.length?i:GO(t),e),o=n2(a,t,{ease:Array.isArray(r)?r:xW(t,r)});return{calculatedDuration:e,next:l=>(s.value=o(l),s.done=l>=e,s)}}function uE(e,t){return t?e*(1e3/t):0}const _W=5;function jO(e,t,i){const n=Math.max(t-_W,0);return uE(i-e(n),t-n)}const g_=.001,bW=.01,NT=10,wW=.05,SW=1;function MW({duration:e=800,bounce:t=.25,velocity:i=0,mass:n=1}){let r,s;bO(e<=mc(NT));let a=1-t;a=Ac(wW,SW,a),e=Ac(bW,NT,el(e)),a<1?(r=c=>{const u=c*a,h=u*e,d=u-i,p=X3(c,a),f=Math.exp(-h);return g_-d/p*f},s=c=>{const h=c*a*e,d=h*i+i,p=Math.pow(a,2)*Math.pow(c,2)*e,f=Math.exp(-h),v=X3(Math.pow(c,2),a);return(-r(c)+g_>0?-1:1)*((d-p)*f)/v}):(r=c=>{const u=Math.exp(-c*e),h=(c-i)*e+1;return-g_+u*h},s=c=>{const u=Math.exp(-c*e),h=(i-c)*(e*e);return u*h});const o=5/e,l=EW(r,s,o);if(e=mc(e),isNaN(l))return{stiffness:100,damping:10,duration:e};{const c=Math.pow(l,2)*n;return{stiffness:c,damping:a*2*Math.sqrt(n*c),duration:e}}}const CW=12;function EW(e,t,i){let n=i;for(let r=1;r<CW;r++)n=n-e(n)/t(n);return n}function X3(e,t){return e*Math.sqrt(1-t*t)}const AW=["duration","bounce"],TW=["stiffness","damping","mass"];function UT(e,t){return t.some(i=>e[i]!==void 0)}function PW(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!UT(e,TW)&&UT(e,AW)){const i=MW(e);t={...t,...i,velocity:0,mass:1},t.isResolvedFromDuration=!0}return t}function WO({keyframes:e,restDelta:t,restSpeed:i,...n}){const r=e[0],s=e[e.length-1],a={done:!1,value:r},{stiffness:o,damping:l,mass:c,velocity:u,duration:h,isResolvedFromDuration:d}=PW(n),p=u?-el(u):0,f=l/(2*Math.sqrt(o*c)),v=s-r,m=el(Math.sqrt(o/c)),g=Math.abs(v)<5;i||(i=g?.01:2),t||(t=g?.005:.5);let y;if(f<1){const x=X3(m,f);y=_=>{const b=Math.exp(-f*m*_);return s-b*((p+f*m*v)/x*Math.sin(x*_)+v*Math.cos(x*_))}}else if(f===1)y=x=>s-Math.exp(-m*x)*(v+(p+m*v)*x);else{const x=m*Math.sqrt(f*f-1);y=_=>{const b=Math.exp(-f*m*_),w=Math.min(x*_,300);return s-b*((p+f*m*v)*Math.sinh(w)+x*v*Math.cosh(w))/x}}return{calculatedDuration:d&&h||null,next:x=>{const _=y(x);if(d)a.done=x>=h;else{let b=p;x!==0&&(f<1?b=jO(y,x,_):b=0);const w=Math.abs(b)<=i,M=Math.abs(s-_)<=t;a.done=w&&M}return a.value=a.done?s:_,a}}}function FT({keyframes:e,velocity:t=0,power:i=.8,timeConstant:n=325,bounceDamping:r=10,bounceStiffness:s=500,modifyTarget:a,min:o,max:l,restDelta:c=.5,restSpeed:u}){const h=e[0],d={done:!1,value:h},p=S=>o!==void 0&&S<o||l!==void 0&&S>l,f=S=>o===void 0?l:l===void 0||Math.abs(o-S)<Math.abs(l-S)?o:l;let v=i*t;const m=h+v,g=a===void 0?m:a(m);g!==m&&(v=g-h);const y=S=>-v*Math.exp(-S/n),x=S=>g+y(S),_=S=>{const C=y(S),E=x(S);d.done=Math.abs(C)<=c,d.value=d.done?g:E};let b,w;const M=S=>{p(d.value)&&(b=S,w=WO({keyframes:[d.value,f(d.value)],velocity:jO(x,S,d.value),damping:r,stiffness:s,restDelta:c,restSpeed:u}))};return M(0),{calculatedDuration:null,next:S=>{let C=!1;return!w&&b===void 0&&(C=!0,_(S),M(S)),b!==void 0&&S>b?w.next(S-b):(!C&&_(S),d)}}}const DW=e=>{const t=({timestamp:i})=>e(i);return{start:()=>Xt.update(t,!0),stop:()=>va(t),now:()=>rn.isProcessing?rn.timestamp:performance.now()}},zT=2e4;function kT(e){let t=0;const i=50;let n=e.next(t);for(;!n.done&&t<zT;)t+=i,n=e.next(t);return t>=zT?1/0:t}const LW={decay:FT,inertia:FT,tween:Cy,keyframes:Cy,spring:WO};function Ey({autoplay:e=!0,delay:t=0,driver:i=DW,keyframes:n,type:r="keyframes",repeat:s=0,repeatDelay:a=0,repeatType:o="loop",onPlay:l,onStop:c,onComplete:u,onUpdate:h,...d}){let p=1,f=!1,v,m;const g=()=>{m=new Promise(N=>{v=N})};g();let y;const x=LW[r]||Cy;let _;x!==Cy&&typeof n[0]!="number"&&(_=n2([0,100],n,{clamp:!1}),n=[0,100]);const b=x({...d,keyframes:n});let w;o==="mirror"&&(w=x({...d,keyframes:[...n].reverse(),velocity:-(d.velocity||0)}));let M="idle",S=null,C=null,E=null;b.calculatedDuration===null&&s&&(b.calculatedDuration=kT(b));const{calculatedDuration:P}=b;let I=1/0,D=1/0;P!==null&&(I=P+a,D=I*(s+1)-a);let L=0;const B=N=>{if(C===null)return;p>0&&(C=Math.min(C,N)),p<0&&(C=Math.min(N-D/p,C)),S!==null?L=S:L=Math.round(N-C)*p;const F=L-t*(p>=0?1:-1),Q=p>=0?F<0:F>D;L=Math.max(F,0),M==="finished"&&S===null&&(L=D);let G=L,K=b;if(s){const re=L/I;let de=Math.floor(re),he=re%1;!he&&re>=1&&(he=1),he===1&&de--,de=Math.min(de,s+1);const X=!!(de%2);X&&(o==="reverse"?(he=1-he,a&&(he-=a/I)):o==="mirror"&&(K=w));let Ee=Ac(0,1,he);L>D&&(Ee=o==="reverse"&&X?1:0),G=Ee*I}const W=Q?{done:!1,value:n[0]}:K.next(G);_&&(W.value=_(W.value));let{done:se}=W;!Q&&P!==null&&(se=p>=0?L>=D:L<=0);const ie=S===null&&(M==="finished"||M==="running"&&se);return h&&h(W.value),ie&&O(),W},j=()=>{y&&y.stop(),y=void 0},z=()=>{M="idle",j(),v(),g(),C=E=null},O=()=>{M="finished",u&&u(),j(),v()},H=()=>{if(f)return;y||(y=i(B));const N=y.now();l&&l(),S!==null?C=N-S:(!C||M==="finished")&&(C=N),M==="finished"&&g(),E=C,S=null,M="running",y.start()};e&&H();const k={then(N,F){return m.then(N,F)},get time(){return el(L)},set time(N){N=mc(N),L=N,S!==null||!y||p===0?S=N:C=y.now()-N/p},get duration(){const N=b.calculatedDuration===null?kT(b):b.calculatedDuration;return el(N)},get speed(){return p},set speed(N){N===p||!y||(p=N,k.time=el(L))},get state(){return M},play:H,pause:()=>{M="paused",S=L},stop:()=>{f=!0,M!=="idle"&&(M="idle",c&&c(),z())},cancel:()=>{E!==null&&B(E),z()},complete:()=>{M="finished"},sample:N=>(C=0,B(N))};return k}function RW(e){let t;return()=>(t===void 0&&(t=e()),t)}const IW=RW(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),OW=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),Ng=10,BW=2e4,NW=(e,t)=>t.type==="spring"||e==="backgroundColor"||!SO(t.ease);function UW(e,t,{onUpdate:i,onComplete:n,...r}){if(!(IW()&&OW.has(t)&&!r.repeatDelay&&r.repeatType!=="mirror"&&r.damping!==0&&r.type!=="inertia"))return!1;let a=!1,o,l;const c=()=>{l=new Promise(y=>{o=y})};c();let{keyframes:u,duration:h=300,ease:d,times:p}=r;if(NW(t,r)){const y=Ey({...r,repeat:0,delay:0});let x={done:!1,value:u[0]};const _=[];let b=0;for(;!x.done&&b<BW;)x=y.sample(b),_.push(x.value),b+=Ng;p=void 0,u=_,h=b-Ng,d="linear"}const f=Yj(e.owner.current,t,u,{...r,duration:h,ease:d,times:p});r.syncStart&&(f.startTime=rn.isProcessing?rn.timestamp:document.timeline?document.timeline.currentTime:performance.now());const v=()=>f.cancel(),m=()=>{Xt.update(v),o(),c()};return f.onfinish=()=>{e.set(Zj(u,r)),n&&n(),m()},{then(y,x){return l.then(y,x)},attachTimeline(y){return f.timeline=y,f.onfinish=null,Pi},get time(){return el(f.currentTime||0)},set time(y){f.currentTime=mc(y)},get speed(){return f.playbackRate},set speed(y){f.playbackRate=y},get duration(){return el(h)},play:()=>{a||(f.play(),va(v))},pause:()=>f.pause(),stop:()=>{if(a=!0,f.playState==="idle")return;const{currentTime:y}=f;if(y){const x=Ey({...r,autoplay:!1});e.setWithVelocity(x.sample(y-Ng).value,x.sample(y).value,Ng)}m()},complete:()=>f.finish(),cancel:m}}function FW({keyframes:e,delay:t,onUpdate:i,onComplete:n}){const r=()=>(i&&i(e[e.length-1]),n&&n(),{time:0,speed:1,duration:0,play:Pi,pause:Pi,stop:Pi,then:s=>(s(),Promise.resolve()),cancel:Pi,complete:Pi});return t?Ey({keyframes:[0,1],duration:0,delay:t,onComplete:r}):r()}const zW={type:"spring",stiffness:500,damping:25,restSpeed:10},kW=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),VW={type:"keyframes",duration:.8},HW={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},GW=(e,{keyframes:t})=>t.length>2?VW:tu.has(e)?e.startsWith("scale")?kW(t[1]):zW:HW,q3=(e,t)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Tc.test(t)||t==="0")&&!t.startsWith("url(")),jW=new Set(["brightness","contrast","saturate","opacity"]);function WW(e){const[t,i]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=i.match($x)||[];if(!n)return e;const r=i.replace(n,"");let s=jW.has(t)?1:0;return n!==i&&(s*=100),t+"("+s+r+")"}const XW=/([a-z-]*)\(.*?\)/g,Y3={...Tc,getAnimatableNone:e=>{const t=e.match(XW);return t?t.map(WW).join(" "):e}},qW={...aO,color:nr,backgroundColor:nr,outlineColor:nr,fill:nr,stroke:nr,borderColor:nr,borderTopColor:nr,borderRightColor:nr,borderBottomColor:nr,borderLeftColor:nr,filter:Y3,WebkitFilter:Y3},dE=e=>qW[e];function XO(e,t){let i=dE(e);return i!==Y3&&(i=Tc),i.getAnimatableNone?i.getAnimatableNone(t):void 0}const qO=e=>/^0[^.\s]+$/.test(e);function YW(e){if(typeof e=="number")return e===0;if(e!==null)return e==="none"||e==="0"||qO(e)}function ZW(e,t,i,n){const r=q3(t,i);let s;Array.isArray(i)?s=[...i]:s=[null,i];const a=n.from!==void 0?n.from:e.get();let o;const l=[];for(let c=0;c<s.length;c++)s[c]===null&&(s[c]=c===0?a:s[c-1]),YW(s[c])&&l.push(c),typeof s[c]=="string"&&s[c]!=="none"&&s[c]!=="0"&&(o=s[c]);if(r&&l.length&&o)for(let c=0;c<l.length;c++){const u=l[c];s[u]=XO(t,o)}return s}function QW({when:e,delay:t,delayChildren:i,staggerChildren:n,staggerDirection:r,repeat:s,repeatType:a,repeatDelay:o,from:l,elapsed:c,...u}){return!!Object.keys(u).length}function YO(e,t){return e[t]||e.default||e}const pE=(e,t,i,n={})=>r=>{const s=YO(n,e)||{},a=s.delay||n.delay||0;let{elapsed:o=0}=n;o=o-mc(a);const l=ZW(t,e,i,s),c=l[0],u=l[l.length-1],h=q3(e,c),d=q3(e,u);let p={keyframes:l,velocity:t.getVelocity(),ease:"easeOut",...s,delay:-o,onUpdate:f=>{t.set(f),s.onUpdate&&s.onUpdate(f)},onComplete:()=>{r(),s.onComplete&&s.onComplete()}};if(QW(s)||(p={...p,...GW(e,p)}),p.duration&&(p.duration=mc(p.duration)),p.repeatDelay&&(p.repeatDelay=mc(p.repeatDelay)),!h||!d||qj.current||s.type===!1)return FW(p);if(t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){const f=UW(t,e,p);if(f)return f}return Ey(p)};function Ay(e){return!!(Fr(e)&&e.add)}const ZO=e=>/^\-?\d*\.?\d+$/.test(e);function fE(e,t){e.indexOf(t)===-1&&e.push(t)}function mE(e,t){const i=e.indexOf(t);i>-1&&e.splice(i,1)}class gE{constructor(){this.subscriptions=[]}add(t){return fE(this.subscriptions,t),()=>mE(this.subscriptions,t)}notify(t,i,n){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](t,i,n);else for(let s=0;s<r;s++){const a=this.subscriptions[s];a&&a(t,i,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const KW=e=>!isNaN(parseFloat(e)),Lm={current:void 0};class $W{constructor(t,i={}){this.version="10.16.4",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(n,r=!0)=>{this.prev=this.current,this.current=n;const{delta:s,timestamp:a}=rn;this.lastUpdated!==a&&(this.timeDelta=s,this.lastUpdated=a,Xt.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>Xt.postRender(this.velocityCheck),this.velocityCheck=({timestamp:n})=>{n!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=KW(this.current),this.owner=i.owner}onChange(t){return this.on("change",t)}on(t,i){this.events[t]||(this.events[t]=new gE);const n=this.events[t].add(i);return t==="change"?()=>{n(),Xt.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,i){this.passiveEffect=t,this.stopPassiveEffect=i}set(t,i=!0){!i||!this.passiveEffect?this.updateAndNotify(t,i):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,i,n){this.set(i),this.prev=t,this.timeDelta=n}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return Lm.current&&Lm.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?uE(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(t){return this.stop(),new Promise(i=>{this.hasAnimated=!0,this.animation=t(i),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function aa(e,t){return new $W(e,t)}const QO=e=>t=>t.test(e),JW={test:e=>e==="auto",parse:e=>e},KO=[iu,xt,Ja,Bl,oj,aj,JW],_f=e=>KO.find(QO(e)),eX=[...KO,nr,Tc],tX=e=>eX.find(QO(e));function iX(e,t,i){e.hasValue(t)?e.getValue(t).set(i):e.addValue(t,aa(i))}function nX(e,t){const i=t2(e,t);let{transitionEnd:n={},transition:r={},...s}=i?e.makeTargetAnimatable(i,!1):{};s={...s,...n};for(const a in s){const o=bj(s[a]);iX(e,a,o)}}function rX(e,t,i){var n,r;const s=Object.keys(t).filter(o=>!e.hasValue(o)),a=s.length;if(a)for(let o=0;o<a;o++){const l=s[o],c=t[l];let u=null;Array.isArray(c)&&(u=c[0]),u===null&&(u=(r=(n=i[l])!==null&&n!==void 0?n:e.readValue(l))!==null&&r!==void 0?r:t[l]),u!=null&&(typeof u=="string"&&(ZO(u)||qO(u))?u=parseFloat(u):!tX(u)&&Tc.test(c)&&(u=XO(l,c)),e.addValue(l,aa(u,{owner:e})),i[l]===void 0&&(i[l]=u),u!==null&&e.setBaseTarget(l,u))}}function sX(e,t){return t?(t[e]||t.default||t).from:void 0}function aX(e,t,i){const n={};for(const r in e){const s=sX(r,t);if(s!==void 0)n[r]=s;else{const a=i.getValue(r);a&&(n[r]=a.get())}}return n}function oX({protectedKeys:e,needsAnimating:t},i){const n=e.hasOwnProperty(i)&&t[i]!==!0;return t[i]=!1,n}function $O(e,t,{delay:i=0,transitionOverride:n,type:r}={}){let{transition:s=e.getDefaultTransition(),transitionEnd:a,...o}=e.makeTargetAnimatable(t);const l=e.getValue("willChange");n&&(s=n);const c=[],u=r&&e.animationState&&e.animationState.getState()[r];for(const h in o){const d=e.getValue(h),p=o[h];if(!d||p===void 0||u&&oX(u,h))continue;const f={delay:i,elapsed:0,...s};if(window.HandoffAppearAnimations&&!d.hasAnimated){const m=e.getProps()[Xj];m&&(f.elapsed=window.HandoffAppearAnimations(m,h,d,Xt),f.syncStart=!0)}d.start(pE(h,d,p,e.shouldReduceMotion&&tu.has(h)?{type:!1}:f));const v=d.animation;Ay(l)&&(l.add(h),v.then(()=>l.remove(h))),c.push(v)}return a&&Promise.all(c).then(()=>{a&&nX(e,a)}),c}function Z3(e,t,i={}){const n=t2(e,t,i.custom);let{transition:r=e.getDefaultTransition()||{}}=n||{};i.transitionOverride&&(r=i.transitionOverride);const s=n?()=>Promise.all($O(e,n,i)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(l=0)=>{const{delayChildren:c=0,staggerChildren:u,staggerDirection:h}=r;return lX(e,t,c+l,u,h,i)}:()=>Promise.resolve(),{when:o}=r;if(o){const[l,c]=o==="beforeChildren"?[s,a]:[a,s];return l().then(()=>c())}else return Promise.all([s(),a(i.delay)])}function lX(e,t,i=0,n=0,r=1,s){const a=[],o=(e.variantChildren.size-1)*n,l=r===1?(c=0)=>c*n:(c=0)=>o-c*n;return Array.from(e.variantChildren).sort(cX).forEach((c,u)=>{c.notify("AnimationStart",t),a.push(Z3(c,t,{...s,delay:i+l(u)}).then(()=>c.notify("AnimationComplete",t)))}),Promise.all(a)}function cX(e,t){return e.sortNodePosition(t)}function hX(e,t,i={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const r=t.map(s=>Z3(e,s,i));n=Promise.all(r)}else if(typeof t=="string")n=Z3(e,t,i);else{const r=typeof t=="function"?t2(e,t,i.custom):t;n=Promise.all($O(e,r,i))}return n.then(()=>e.notify("AnimationComplete",t))}const uX=[...$C].reverse(),dX=$C.length;function pX(e){return t=>Promise.all(t.map(({animation:i,options:n})=>hX(e,i,n)))}function fX(e){let t=pX(e);const i=gX();let n=!0;const r=(l,c)=>{const u=t2(e,c);if(u){const{transition:h,transitionEnd:d,...p}=u;l={...l,...p,...d}}return l};function s(l){t=l(e)}function a(l,c){const u=e.getProps(),h=e.getVariantContext(!0)||{},d=[],p=new Set;let f={},v=1/0;for(let g=0;g<dX;g++){const y=uX[g],x=i[y],_=u[y]!==void 0?u[y]:h[y],b=y0(_),w=y===c?x.isActive:null;w===!1&&(v=g);let M=_===h[y]&&_!==u[y]&&b;if(M&&n&&e.manuallyAnimateOnMount&&(M=!1),x.protectedKeys={...f},!x.isActive&&w===null||!_&&!x.prevProp||Qx(_)||typeof _=="boolean")continue;const S=mX(x.prevProp,_);let C=S||y===c&&x.isActive&&!M&&b||g>v&&b;const E=Array.isArray(_)?_:[_];let P=E.reduce(r,{});w===!1&&(P={});const{prevResolvedValues:I={}}=x,D={...I,...P},L=B=>{C=!0,p.delete(B),x.needsAnimating[B]=!0};for(const B in D){const j=P[B],z=I[B];f.hasOwnProperty(B)||(j!==z?Sy(j)&&Sy(z)?!_O(j,z)||S?L(B):x.protectedKeys[B]=!0:j!==void 0?L(B):p.add(B):j!==void 0&&p.has(B)?L(B):x.protectedKeys[B]=!0)}x.prevProp=_,x.prevResolvedValues=P,x.isActive&&(f={...f,...P}),n&&e.blockInitialAnimation&&(C=!1),C&&!M&&d.push(...E.map(B=>({animation:B,options:{type:y,...l}})))}if(p.size){const g={};p.forEach(y=>{const x=e.getBaseTarget(y);x!==void 0&&(g[y]=x)}),d.push({animation:g})}let m=!!d.length;return n&&u.initial===!1&&!e.manuallyAnimateOnMount&&(m=!1),n=!1,m?t(d):Promise.resolve()}function o(l,c,u){var h;if(i[l].isActive===c)return Promise.resolve();(h=e.variantChildren)===null||h===void 0||h.forEach(p=>{var f;return(f=p.animationState)===null||f===void 0?void 0:f.setActive(l,c)}),i[l].isActive=c;const d=a(u,l);for(const p in i)i[p].protectedKeys={};return d}return{animateChanges:a,setActive:o,setAnimateFunction:s,getState:()=>i}}function mX(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!_O(t,e):!1}function Vc(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function gX(){return{animate:Vc(!0),whileInView:Vc(),whileHover:Vc(),whileTap:Vc(),whileDrag:Vc(),whileFocus:Vc(),exit:Vc()}}class vX extends Nc{constructor(t){super(t),t.animationState||(t.animationState=fX(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();this.unmount(),Qx(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:i}=this.node.prevProps||{};t!==i&&this.updateAnimationControlsSubscription()}unmount(){}}let yX=0;class xX extends Nc{constructor(){super(...arguments),this.id=yX++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:i,custom:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const s=this.node.animationState.setActive("exit",!t,{custom:n??this.node.getProps().custom});i&&!t&&s.then(()=>i(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const _X={animation:{Feature:vX},exit:{Feature:xX}},VT=(e,t)=>Math.abs(e-t);function bX(e,t){const i=VT(e.x,t.x),n=VT(e.y,t.y);return Math.sqrt(i**2+n**2)}class JO{constructor(t,i,{transformPagePoint:n}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const c=y_(this.lastMoveEventInfo,this.history),u=this.startEvent!==null,h=bX(c.offset,{x:0,y:0})>=3;if(!u&&!h)return;const{point:d}=c,{timestamp:p}=rn;this.history.push({...d,timestamp:p});const{onStart:f,onMove:v}=this.handlers;u||(f&&f(this.lastMoveEvent,c),this.startEvent=this.lastMoveEvent),v&&v(this.lastMoveEvent,c)},this.handlePointerMove=(c,u)=>{this.lastMoveEvent=c,this.lastMoveEventInfo=v_(u,this.transformPagePoint),Xt.update(this.updatePoint,!0)},this.handlePointerUp=(c,u)=>{if(this.end(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const{onEnd:h,onSessionEnd:d}=this.handlers,p=y_(c.type==="pointercancel"?this.lastMoveEventInfo:v_(u,this.transformPagePoint),this.history);this.startEvent&&h&&h(c,p),d&&d(c,p)},!mO(t))return;this.handlers=i,this.transformPagePoint=n;const r=e2(t),s=v_(r,this.transformPagePoint),{point:a}=s,{timestamp:o}=rn;this.history=[{...a,timestamp:o}];const{onSessionStart:l}=i;l&&l(t,y_(s,this.history)),this.removeListeners=fc(Jo(window,"pointermove",this.handlePointerMove),Jo(window,"pointerup",this.handlePointerUp),Jo(window,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),va(this.updatePoint)}}function v_(e,t){return t?{point:t(e.point)}:e}function HT(e,t){return{x:e.x-t.x,y:e.y-t.y}}function y_({point:e},t){return{point:e,delta:HT(e,eB(t)),offset:HT(e,wX(t)),velocity:SX(t,.1)}}function wX(e){return e[0]}function eB(e){return e[e.length-1]}function SX(e,t){if(e.length<2)return{x:0,y:0};let i=e.length-1,n=null;const r=eB(e);for(;i>=0&&(n=e[i],!(r.timestamp-n.timestamp>mc(t)));)i--;if(!n)return{x:0,y:0};const s=el(r.timestamp-n.timestamp);if(s===0)return{x:0,y:0};const a={x:(r.x-n.x)/s,y:(r.y-n.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function os(e){return e.max-e.min}function Q3(e,t=0,i=.01){return Math.abs(e-t)<=i}function GT(e,t,i,n=.5){e.origin=n,e.originPoint=bi(t.min,t.max,e.origin),e.scale=os(i)/os(t),(Q3(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=bi(i.min,i.max,e.origin)-e.originPoint,(Q3(e.translate)||isNaN(e.translate))&&(e.translate=0)}function Rm(e,t,i,n){GT(e.x,t.x,i.x,n?n.originX:void 0),GT(e.y,t.y,i.y,n?n.originY:void 0)}function jT(e,t,i){e.min=i.min+t.min,e.max=e.min+os(t)}function MX(e,t,i){jT(e.x,t.x,i.x),jT(e.y,t.y,i.y)}function WT(e,t,i){e.min=t.min-i.min,e.max=e.min+os(t)}function Im(e,t,i){WT(e.x,t.x,i.x),WT(e.y,t.y,i.y)}function CX(e,{min:t,max:i},n){return t!==void 0&&e<t?e=n?bi(t,e,n.min):Math.max(e,t):i!==void 0&&e>i&&(e=n?bi(i,e,n.max):Math.min(e,i)),e}function XT(e,t,i){return{min:t!==void 0?e.min+t:void 0,max:i!==void 0?e.max+i-(e.max-e.min):void 0}}function EX(e,{top:t,left:i,bottom:n,right:r}){return{x:XT(e.x,i,r),y:XT(e.y,t,n)}}function qT(e,t){let i=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([i,n]=[n,i]),{min:i,max:n}}function AX(e,t){return{x:qT(e.x,t.x),y:qT(e.y,t.y)}}function TX(e,t){let i=.5;const n=os(e),r=os(t);return r>n?i=vp(t.min,t.max-n,e.min):n>r&&(i=vp(e.min,e.max-r,t.min)),Ac(0,1,i)}function PX(e,t){const i={};return t.min!==void 0&&(i.min=t.min-e.min),t.max!==void 0&&(i.max=t.max-e.min),i}const K3=.35;function DX(e=K3){return e===!1?e=0:e===!0&&(e=K3),{x:YT(e,"left","right"),y:YT(e,"top","bottom")}}function YT(e,t,i){return{min:ZT(e,t),max:ZT(e,i)}}function ZT(e,t){return typeof e=="number"?e:e[t]||0}const QT=()=>({translate:0,scale:1,origin:0,originPoint:0}),Td=()=>({x:QT(),y:QT()}),KT=()=>({min:0,max:0}),qi=()=>({x:KT(),y:KT()});function Ua(e){return[e("x"),e("y")]}function tB({top:e,left:t,right:i,bottom:n}){return{x:{min:t,max:i},y:{min:e,max:n}}}function LX({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function RX(e,t){if(!t)return e;const i=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:i.y,left:i.x,bottom:n.y,right:n.x}}function x_(e){return e===void 0||e===1}function $3({scale:e,scaleX:t,scaleY:i}){return!x_(e)||!x_(t)||!x_(i)}function ih(e){return $3(e)||iB(e)||e.z||e.rotate||e.rotateX||e.rotateY}function iB(e){return $T(e.x)||$T(e.y)}function $T(e){return e&&e!=="0%"}function Ty(e,t,i){const n=e-i,r=t*n;return i+r}function JT(e,t,i,n,r){return r!==void 0&&(e=Ty(e,r,n)),Ty(e,i,n)+t}function J3(e,t=0,i=1,n,r){e.min=JT(e.min,t,i,n,r),e.max=JT(e.max,t,i,n,r)}function nB(e,{x:t,y:i}){J3(e.x,t.translate,t.scale,t.originPoint),J3(e.y,i.translate,i.scale,i.originPoint)}function IX(e,t,i,n=!1){const r=i.length;if(!r)return;t.x=t.y=1;let s,a;for(let o=0;o<r;o++){s=i[o],a=s.projectionDelta;const l=s.instance;l&&l.style&&l.style.display==="contents"||(n&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Pd(e,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,nB(e,a)),n&&ih(s.latestValues)&&Pd(e,s.latestValues))}t.x=e5(t.x),t.y=e5(t.y)}function e5(e){return Number.isInteger(e)||e>1.0000000000001||e<.999999999999?e:1}function zl(e,t){e.min=e.min+t,e.max=e.max+t}function t5(e,t,[i,n,r]){const s=t[r]!==void 0?t[r]:.5,a=bi(e.min,e.max,s);J3(e,t[i],t[n],a,t.scale)}const OX=["x","scaleX","originX"],BX=["y","scaleY","originY"];function Pd(e,t){t5(e.x,t,OX),t5(e.y,t,BX)}function rB(e,t){return tB(RX(e.getBoundingClientRect(),t))}function NX(e,t,i){const n=rB(e,i),{scroll:r}=t;return r&&(zl(n.x,r.offset.x),zl(n.y,r.offset.y)),n}const UX=new WeakMap;class FX{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=qi(),this.visualElement=t}start(t,{snapToCursor:i=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const r=l=>{this.stopAnimation(),i&&this.snapToCursor(e2(l,"page").point)},s=(l,c)=>{const{drag:u,dragPropagation:h,onDragStart:d}=this.getProps();if(u&&!h&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=vO(u),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ua(f=>{let v=this.getAxisMotionValue(f).get()||0;if(Ja.test(v)){const{projection:m}=this.visualElement;if(m&&m.layout){const g=m.layout.layoutBox[f];g&&(v=os(g)*(parseFloat(v)/100))}}this.originPoint[f]=v}),d&&Xt.update(()=>d(l,c),!1,!0);const{animationState:p}=this.visualElement;p&&p.setActive("whileDrag",!0)},a=(l,c)=>{const{dragPropagation:u,dragDirectionLock:h,onDirectionLock:d,onDrag:p}=this.getProps();if(!u&&!this.openGlobalLock)return;const{offset:f}=c;if(h&&this.currentDirection===null){this.currentDirection=zX(f),this.currentDirection!==null&&d&&d(this.currentDirection);return}this.updateAxis("x",c.point,f),this.updateAxis("y",c.point,f),this.visualElement.render(),p&&p(l,c)},o=(l,c)=>this.stop(l,c);this.panSession=new JO(t,{onSessionStart:r,onStart:s,onMove:a,onSessionEnd:o},{transformPagePoint:this.visualElement.getTransformPagePoint()})}stop(t,i){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:r}=i;this.startAnimation(r);const{onDragEnd:s}=this.getProps();s&&Xt.update(()=>s(t,i))}cancel(){this.isDragging=!1;const{projection:t,animationState:i}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),i&&i.setActive("whileDrag",!1)}updateAxis(t,i,n){const{drag:r}=this.getProps();if(!n||!Ug(t,r,this.currentDirection))return;const s=this.getAxisMotionValue(t);let a=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(a=CX(a,this.constraints[t],this.elastic[t])),s.set(a)}resolveConstraints(){const{dragConstraints:t,dragElastic:i}=this.getProps(),{layout:n}=this.visualElement.projection||{},r=this.constraints;t&&Ed(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&n?this.constraints=EX(n.layoutBox,t):this.constraints=!1,this.elastic=DX(i),r!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&Ua(s=>{this.getAxisMotionValue(s)&&(this.constraints[s]=PX(n.layoutBox[s],this.constraints[s]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:i}=this.getProps();if(!t||!Ed(t))return!1;const n=t.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const s=NX(n,r.root,this.visualElement.getTransformPagePoint());let a=AX(r.layout.layoutBox,s);if(i){const o=i(LX(a));this.hasMutatedConstraints=!!o,o&&(a=tB(o))}return a}startAnimation(t){const{drag:i,dragMomentum:n,dragElastic:r,dragTransition:s,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=Ua(u=>{if(!Ug(u,i,this.currentDirection))return;let h=l&&l[u]||{};a&&(h={min:0,max:0});const d=r?200:1e6,p=r?40:1e7,f={type:"inertia",velocity:n?t[u]:0,bounceStiffness:d,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...s,...h};return this.startAxisValueAnimation(u,f)});return Promise.all(c).then(o)}startAxisValueAnimation(t,i){const n=this.getAxisMotionValue(t);return n.start(pE(t,n,0,i))}stopAnimation(){Ua(t=>this.getAxisMotionValue(t).stop())}getAxisMotionValue(t){const i="_drag"+t.toUpperCase(),n=this.visualElement.getProps(),r=n[i];return r||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){Ua(i=>{const{drag:n}=this.getProps();if(!Ug(i,n,this.currentDirection))return;const{projection:r}=this.visualElement,s=this.getAxisMotionValue(i);if(r&&r.layout){const{min:a,max:o}=r.layout.layoutBox[i];s.set(t[i]-bi(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:i}=this.getProps(),{projection:n}=this.visualElement;if(!Ed(i)||!n||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};Ua(a=>{const o=this.getAxisMotionValue(a);if(o){const l=o.get();r[a]=TX({min:l,max:l},this.constraints[a])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Ua(a=>{if(!Ug(a,t,null))return;const o=this.getAxisMotionValue(a),{min:l,max:c}=this.constraints[a];o.set(bi(l,c,r[a]))})}addListeners(){if(!this.visualElement.current)return;UX.set(this.visualElement,this);const t=this.visualElement.current,i=Jo(t,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),n=()=>{const{dragConstraints:l}=this.getProps();Ed(l)&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,s=r.addEventListener("measure",n);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),n();const a=Yo(window,"resize",()=>this.scalePositionWithinConstraints()),o=r.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Ua(u=>{const h=this.getAxisMotionValue(u);h&&(this.originPoint[u]+=l[u].translate,h.set(h.get()+l[u].translate))}),this.visualElement.render())});return()=>{a(),i(),s(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:i=!1,dragDirectionLock:n=!1,dragPropagation:r=!1,dragConstraints:s=!1,dragElastic:a=K3,dragMomentum:o=!0}=t;return{...t,drag:i,dragDirectionLock:n,dragPropagation:r,dragConstraints:s,dragElastic:a,dragMomentum:o}}}function Ug(e,t,i){return(t===!0||t===e)&&(i===null||i===e)}function zX(e,t=10){let i=null;return Math.abs(e.y)>t?i="y":Math.abs(e.x)>t&&(i="x"),i}class kX extends Nc{constructor(t){super(t),this.removeGroupControls=Pi,this.removeListeners=Pi,this.controls=new FX(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Pi}unmount(){this.removeGroupControls(),this.removeListeners()}}const i5=e=>(t,i)=>{e&&Xt.update(()=>e(t,i))};class VX extends Nc{constructor(){super(...arguments),this.removePointerDownListener=Pi}onPointerDown(t){this.session=new JO(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint()})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:i,onPan:n,onPanEnd:r}=this.node.getProps();return{onSessionStart:i5(t),onStart:i5(i),onMove:n,onEnd:(s,a)=>{delete this.session,r&&Xt.update(()=>r(s,a))}}}mount(){this.removePointerDownListener=Jo(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function HX(){const e=ze.useContext(QC);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:i,register:n}=e,r=ze.useId();return ze.useEffect(()=>n(r),[]),!t&&i?[!1,()=>i&&i(r)]:[!0]}const Bv={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function n5(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const bf={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(xt.test(e))e=parseFloat(e);else return e;const i=n5(e,t.target.x),n=n5(e,t.target.y);return`${i}% ${n}%`}},GX={correct:(e,{treeScale:t,projectionDelta:i})=>{const n=e,r=Tc.parse(e);if(r.length>5)return n;const s=Tc.createTransformer(e),a=typeof r[0]!="number"?1:0,o=i.x.scale*t.x,l=i.y.scale*t.y;r[0+a]/=o,r[1+a]/=l;const c=bi(o,l,.5);return typeof r[2+a]=="number"&&(r[2+a]/=c),typeof r[3+a]=="number"&&(r[3+a]/=c),s(r)}};class jX extends zp.Component{componentDidMount(){const{visualElement:t,layoutGroup:i,switchLayoutGroup:n,layoutId:r}=this.props,{projection:s}=t;JG(WX),s&&(i.group&&i.group.add(s),n&&n.register&&r&&n.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),Bv.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:i,visualElement:n,drag:r,isPresent:s}=this.props,a=n.projection;return a&&(a.isPresent=s,r||t.layoutDependency!==i||i===void 0?a.willUpdate():this.safeToRemove(),t.isPresent!==s&&(s?a.promote():a.relegate()||Xt.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:i,switchLayoutGroup:n}=this.props,{projection:r}=t;r&&(r.scheduleCheckAfterUnmount(),i&&i.group&&i.group.remove(r),n&&n.deregister&&n.deregister(r))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function sB(e){const[t,i]=HX(),n=ze.useContext(eO);return zp.createElement(jX,{...e,layoutGroup:n,switchLayoutGroup:ze.useContext(tO),isPresent:t,safeToRemove:i})}const WX={borderRadius:{...bf,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:bf,borderTopRightRadius:bf,borderBottomLeftRadius:bf,borderBottomRightRadius:bf,boxShadow:GX},aB=["TopLeft","TopRight","BottomLeft","BottomRight"],XX=aB.length,r5=e=>typeof e=="string"?parseFloat(e):e,s5=e=>typeof e=="number"||xt.test(e);function qX(e,t,i,n,r,s){r?(e.opacity=bi(0,i.opacity!==void 0?i.opacity:1,YX(n)),e.opacityExit=bi(t.opacity!==void 0?t.opacity:1,0,ZX(n))):s&&(e.opacity=bi(t.opacity!==void 0?t.opacity:1,i.opacity!==void 0?i.opacity:1,n));for(let a=0;a<XX;a++){const o=`border${aB[a]}Radius`;let l=a5(t,o),c=a5(i,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||s5(l)===s5(c)?(e[o]=Math.max(bi(r5(l),r5(c),n),0),(Ja.test(c)||Ja.test(l))&&(e[o]+="%")):e[o]=c}(t.rotate||i.rotate)&&(e.rotate=bi(t.rotate||0,i.rotate||0,n))}function a5(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const YX=oB(0,.5,lE),ZX=oB(.5,.95,Pi);function oB(e,t,i){return n=>n<e?0:n>t?1:i(vp(e,t,n))}function o5(e,t){e.min=t.min,e.max=t.max}function ps(e,t){o5(e.x,t.x),o5(e.y,t.y)}function l5(e,t,i,n,r){return e-=t,e=Ty(e,1/i,n),r!==void 0&&(e=Ty(e,1/r,n)),e}function QX(e,t=0,i=1,n=.5,r,s=e,a=e){if(Ja.test(t)&&(t=parseFloat(t),t=bi(a.min,a.max,t/100)-a.min),typeof t!="number")return;let o=bi(s.min,s.max,n);e===s&&(o-=t),e.min=l5(e.min,t,i,o,r),e.max=l5(e.max,t,i,o,r)}function c5(e,t,[i,n,r],s,a){QX(e,t[i],t[n],t[r],t.scale,s,a)}const KX=["x","scaleX","originX"],$X=["y","scaleY","originY"];function h5(e,t,i,n){c5(e.x,t,KX,i?i.x:void 0,n?n.x:void 0),c5(e.y,t,$X,i?i.y:void 0,n?n.y:void 0)}function u5(e){return e.translate===0&&e.scale===1}function lB(e){return u5(e.x)&&u5(e.y)}function JX(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function cB(e,t){return Math.round(e.x.min)===Math.round(t.x.min)&&Math.round(e.x.max)===Math.round(t.x.max)&&Math.round(e.y.min)===Math.round(t.y.min)&&Math.round(e.y.max)===Math.round(t.y.max)}function d5(e){return os(e.x)/os(e.y)}class eq{constructor(){this.members=[]}add(t){fE(this.members,t),t.scheduleRender()}remove(t){if(mE(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const i=this.members[this.members.length-1];i&&this.promote(i)}}relegate(t){const i=this.members.findIndex(r=>t===r);if(i===0)return!1;let n;for(let r=i;r>=0;r--){const s=this.members[r];if(s.isPresent!==!1){n=s;break}}return n?(this.promote(n),!0):!1}promote(t,i){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,i&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:r}=t.options;r===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:i,resumingFrom:n}=t;i.onExitComplete&&i.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function p5(e,t,i){let n="";const r=e.x.translate/t.x,s=e.y.translate/t.y;if((r||s)&&(n=`translate3d(${r}px, ${s}px, 0) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),i){const{rotate:l,rotateX:c,rotateY:u}=i;l&&(n+=`rotate(${l}deg) `),c&&(n+=`rotateX(${c}deg) `),u&&(n+=`rotateY(${u}deg) `)}const a=e.x.scale*t.x,o=e.y.scale*t.y;return(a!==1||o!==1)&&(n+=`scale(${a}, ${o})`),n||"none"}const tq=(e,t)=>e.depth-t.depth;class iq{constructor(){this.children=[],this.isDirty=!1}add(t){fE(this.children,t),this.isDirty=!0}remove(t){mE(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(tq),this.isDirty=!1,this.children.forEach(t)}}function nq(e,t){const i=performance.now(),n=({timestamp:r})=>{const s=r-i;s>=t&&(va(n),e(s-t))};return Xt.read(n,!0),()=>va(n)}function rq(e){window.MotionDebug&&window.MotionDebug.record(e)}function sq(e){return e instanceof SVGElement&&e.tagName!=="svg"}function aq(e,t,i){const n=Fr(e)?e:aa(e);return n.start(pE("",n,t,i)),n.animation}const f5=["","X","Y","Z"],m5=1e3;let oq=0;const nh={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function hB({attachResizeListener:e,defaultParent:t,measureScroll:i,checkIsScrollRoot:n,resetTransform:r}){return class{constructor(a={},o=t==null?void 0:t()){this.id=oq++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{nh.totalNodes=nh.resolvedTargetDeltas=nh.recalculatedProjection=0,this.nodes.forEach(hq),this.nodes.forEach(mq),this.nodes.forEach(gq),this.nodes.forEach(uq),rq(nh)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new iq)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new gE),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=sq(a),this.instance=a;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(c||l)&&(this.isLayoutDirty=!0),e){let h;const d=()=>this.root.updateBlockedByResize=!1;e(a,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=nq(d,250),Bv.hasAnimatedSinceResize&&(Bv.hasAnimatedSinceResize=!1,this.nodes.forEach(v5))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:d,hasRelativeTargetChanged:p,layout:f})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const v=this.options.transition||u.getDefaultTransition()||bq,{onLayoutAnimationStart:m,onLayoutAnimationComplete:g}=u.getProps(),y=!this.targetLayout||!cB(this.targetLayout,f)||p,x=!d&&p;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||x||d&&(y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,x);const _={...YO(v,"layout"),onPlay:m,onComplete:g};(u.shouldReduceMotion||this.options.layoutRoot)&&(_.delay=0,_.type=!1),this.startAnimation(_)}else d||v5(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=f})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,va(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(vq),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(g5);return}this.isUpdating||this.nodes.forEach(pq),this.isUpdating=!1,this.nodes.forEach(fq),this.nodes.forEach(lq),this.nodes.forEach(cq),this.clearAllSnapshots();const o=performance.now();rn.delta=Ac(0,1e3/60,o-rn.timestamp),rn.timestamp=o,rn.isProcessing=!0,c_.update.process(rn),c_.preRender.process(rn),c_.render.process(rn),rn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(dq),this.sharedNodes.forEach(yq)}scheduleUpdateProjection(){Xt.preRender(this.updateProjection,!1,!0)}scheduleCheckAfterUnmount(){Xt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=qi(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o&&(this.scroll={animationId:this.root.animationId,phase:a,isRoot:n(this.instance),offset:i(this.instance)})}resetTransform(){if(!r)return;const a=this.isLayoutDirty||this.shouldResetTransform,o=this.projectionDelta&&!lB(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;a&&(o||ih(this.latestValues)||u)&&(r(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),wq(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:a}=this.options;if(!a)return qi();const o=a.measureViewportBox(),{scroll:l}=this.root;return l&&(zl(o.x,l.offset.x),zl(o.y,l.offset.y)),o}removeElementScroll(a){const o=qi();ps(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l],{scroll:u,options:h}=c;if(c!==this.root&&u&&h.layoutScroll){if(u.isRoot){ps(o,a);const{scroll:d}=this.root;d&&(zl(o.x,-d.offset.x),zl(o.y,-d.offset.y))}zl(o.x,u.offset.x),zl(o.y,u.offset.y)}}return o}applyTransform(a,o=!1){const l=qi();ps(l,a);for(let c=0;c<this.path.length;c++){const u=this.path[c];!o&&u.options.layoutScroll&&u.scroll&&u!==u.root&&Pd(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),ih(u.latestValues)&&Pd(l,u.latestValues)}return ih(this.latestValues)&&Pd(l,this.latestValues),l}removeTransform(a){const o=qi();ps(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!ih(c.latestValues))continue;$3(c.latestValues)&&c.updateSnapshot();const u=qi(),h=c.measurePageBox();ps(u,h),h5(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return ih(this.latestValues)&&h5(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==rn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var o;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(a||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:h,layoutId:d}=this.options;if(!(!this.layout||!(h||d))){if(this.resolvedRelativeTargetAt=rn.timestamp,!this.targetDelta&&!this.relativeTarget){const p=this.getClosestProjectingParent();p&&p.layout&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=qi(),this.relativeTargetOrigin=qi(),Im(this.relativeTargetOrigin,this.layout.layoutBox,p.layout.layoutBox),ps(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=qi(),this.targetWithTransforms=qi()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),MX(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ps(this.target,this.layout.layoutBox),nB(this.target,this.targetDelta)):ps(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const p=this.getClosestProjectingParent();p&&!!p.resumingFrom==!!this.resumingFrom&&!p.options.layoutScroll&&p.target&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=qi(),this.relativeTargetOrigin=qi(),Im(this.relativeTargetOrigin,this.target,p.target),ps(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}nh.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||$3(this.parent.latestValues)||iB(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===rn.timestamp&&(c=!1),c)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;ps(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,p=this.treeScale.y;IX(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox);const{target:f}=o;if(!f){this.projectionTransform&&(this.projectionDelta=Td(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=Td(),this.projectionDeltaWithTransform=Td());const v=this.projectionTransform;Rm(this.projectionDelta,this.layoutCorrected,f,this.latestValues),this.projectionTransform=p5(this.projectionDelta,this.treeScale),(this.projectionTransform!==v||this.treeScale.x!==d||this.treeScale.y!==p)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",f)),nh.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),a){const o=this.getStack();o&&o.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(a,o=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},h=Td();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const d=qi(),p=l?l.source:void 0,f=this.layout?this.layout.source:void 0,v=p!==f,m=this.getStack(),g=!m||m.members.length<=1,y=!!(v&&!g&&this.options.crossfade===!0&&!this.path.some(_q));this.animationProgress=0;let x;this.mixTargetDelta=_=>{const b=_/1e3;y5(h.x,a.x,b),y5(h.y,a.y,b),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Im(d,this.layout.layoutBox,this.relativeParent.layout.layoutBox),xq(this.relativeTarget,this.relativeTargetOrigin,d,b),x&&JX(this.relativeTarget,x)&&(this.isProjectionDirty=!1),x||(x=qi()),ps(x,this.relativeTarget)),v&&(this.animationValues=u,qX(u,c,this.latestValues,b,y,g)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=b},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(va(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Xt.update(()=>{Bv.hasAnimatedSinceResize=!0,this.currentAnimation=aq(0,m5,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(m5),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:u}=a;if(!(!o||!l||!c)){if(this!==a&&this.layout&&c&&uB(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||qi();const h=os(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+h;const d=os(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+d}ps(o,l),Pd(o,u),Rm(this.projectionDeltaWithTransform,this.layoutCorrected,o,u)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new eq),this.sharedNodes.get(a).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.rotate||l.rotateX||l.rotateY||l.rotateZ)&&(o=!0),!o)return;const c={};for(let u=0;u<f5.length;u++){const h="rotate"+f5[u];l[h]&&(c[h]=l[h],a.setStaticValue(h,0))}a.render();for(const u in c)a.setStaticValue(u,c[u]);a.scheduleRender()}getProjectionStyles(a={}){var o,l;const c={};if(!this.instance||this.isSVG)return c;if(this.isVisible)c.visibility="";else return{visibility:"hidden"};const u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=Ov(a.pointerEvents)||"",c.transform=u?u(this.latestValues,""):"none",c;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const v={};return this.options.layoutId&&(v.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,v.pointerEvents=Ov(a.pointerEvents)||""),this.hasProjected&&!ih(this.latestValues)&&(v.transform=u?u({},""):"none",this.hasProjected=!1),v}const d=h.animationValues||h.latestValues;this.applyTransformsToTarget(),c.transform=p5(this.projectionDeltaWithTransform,this.treeScale,d),u&&(c.transform=u(d,c.transform));const{x:p,y:f}=this.projectionDelta;c.transformOrigin=`${p.origin*100}% ${f.origin*100}% 0`,h.animationValues?c.opacity=h===this?(l=(o=d.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:c.opacity=h===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const v in by){if(d[v]===void 0)continue;const{correct:m,applyTo:g}=by[v],y=c.transform==="none"?d[v]:m(d[v],h);if(g){const x=g.length;for(let _=0;_<x;_++)c[g[_]]=y}else c[v]=y}return this.options.layoutId&&(c.pointerEvents=h===this?Ov(a.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(g5),this.root.sharedNodes.clear()}}}function lq(e){e.updateLayout()}function cq(e){var t;const i=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&i&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:r}=e.layout,{animationType:s}=e.options,a=i.source!==e.layout.source;s==="size"?Ua(h=>{const d=a?i.measuredBox[h]:i.layoutBox[h],p=os(d);d.min=n[h].min,d.max=d.min+p}):uB(s,i.layoutBox,n)&&Ua(h=>{const d=a?i.measuredBox[h]:i.layoutBox[h],p=os(n[h]);d.max=d.min+p,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[h].max=e.relativeTarget[h].min+p)});const o=Td();Rm(o,n,i.layoutBox);const l=Td();a?Rm(l,e.applyTransform(r,!0),i.measuredBox):Rm(l,n,i.layoutBox);const c=!lB(o);let u=!1;if(!e.resumeFrom){const h=e.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:d,layout:p}=h;if(d&&p){const f=qi();Im(f,i.layoutBox,d.layoutBox);const v=qi();Im(v,n,p.layoutBox),cB(f,v)||(u=!0),h.options.layoutRoot&&(e.relativeTarget=v,e.relativeTargetOrigin=f,e.relativeParent=h)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:i,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeTargetChanged:u})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function hq(e){nh.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function uq(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function dq(e){e.clearSnapshot()}function g5(e){e.clearMeasurements()}function pq(e){e.isLayoutDirty=!1}function fq(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function v5(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function mq(e){e.resolveTargetDelta()}function gq(e){e.calcProjection()}function vq(e){e.resetRotation()}function yq(e){e.removeLeadSnapshot()}function y5(e,t,i){e.translate=bi(t.translate,0,i),e.scale=bi(t.scale,1,i),e.origin=t.origin,e.originPoint=t.originPoint}function x5(e,t,i,n){e.min=bi(t.min,i.min,n),e.max=bi(t.max,i.max,n)}function xq(e,t,i,n){x5(e.x,t.x,i.x,n),x5(e.y,t.y,i.y,n)}function _q(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const bq={duration:.45,ease:[.4,0,.1,1]},_5=e=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(e),b5=_5("applewebkit/")&&!_5("chrome/")?Math.round:Pi;function w5(e){e.min=b5(e.min),e.max=b5(e.max)}function wq(e){w5(e.x),w5(e.y)}function uB(e,t,i){return e==="position"||e==="preserve-aspect"&&!Q3(d5(t),d5(i),.2)}const Sq=hB({attachResizeListener:(e,t)=>Yo(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),__={current:void 0},dB=hB({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!__.current){const e=new Sq({});e.mount(window),e.setOptions({layoutScroll:!0}),__.current=e}return __.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),Mq={pan:{Feature:VX},drag:{Feature:kX,ProjectionNode:dB,MeasureLayout:sB}},Cq=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function Eq(e){const t=Cq.exec(e);if(!t)return[,];const[,i,n]=t;return[i,n]}function eS(e,t,i=1){const[n,r]=Eq(e);if(!n)return;const s=window.getComputedStyle(t).getPropertyValue(n);if(s){const a=s.trim();return ZO(a)?parseFloat(a):a}else return G3(r)?eS(r,t,i+1):r}function Aq(e,{...t},i){const n=e.current;if(!(n instanceof Element))return{target:t,transitionEnd:i};i&&(i={...i}),e.values.forEach(r=>{const s=r.get();if(!G3(s))return;const a=eS(s,n);a&&r.set(a)});for(const r in t){const s=t[r];if(!G3(s))continue;const a=eS(s,n);a&&(t[r]=a,i||(i={}),i[r]===void 0&&(i[r]=s))}return{target:t,transitionEnd:i}}const Tq=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),pB=e=>Tq.has(e),Pq=e=>Object.keys(e).some(pB),S5=e=>e===iu||e===xt,M5=(e,t)=>parseFloat(e.split(", ")[t]),C5=(e,t)=>(i,{transform:n})=>{if(n==="none"||!n)return 0;const r=n.match(/^matrix3d\((.+)\)$/);if(r)return M5(r[1],t);{const s=n.match(/^matrix\((.+)\)$/);return s?M5(s[1],e):0}},Dq=new Set(["x","y","z"]),Lq=Z0.filter(e=>!Dq.has(e));function Rq(e){const t=[];return Lq.forEach(i=>{const n=e.getValue(i);n!==void 0&&(t.push([i,n.get()]),n.set(i.startsWith("scale")?1:0))}),t.length&&e.render(),t}const yp={width:({x:e},{paddingLeft:t="0",paddingRight:i="0"})=>e.max-e.min-parseFloat(t)-parseFloat(i),height:({y:e},{paddingTop:t="0",paddingBottom:i="0"})=>e.max-e.min-parseFloat(t)-parseFloat(i),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:C5(4,13),y:C5(5,14)};yp.translateX=yp.x;yp.translateY=yp.y;const Iq=(e,t,i)=>{const n=t.measureViewportBox(),r=t.current,s=getComputedStyle(r),{display:a}=s,o={};a==="none"&&t.setStaticValue("display",e.display||"block"),i.forEach(c=>{o[c]=yp[c](n,s)}),t.render();const l=t.measureViewportBox();return i.forEach(c=>{const u=t.getValue(c);u&&u.jump(o[c]),e[c]=yp[c](l,s)}),e},Oq=(e,t,i={},n={})=>{t={...t},n={...n};const r=Object.keys(t).filter(pB);let s=[],a=!1;const o=[];if(r.forEach(l=>{const c=e.getValue(l);if(!e.hasValue(l))return;let u=i[l],h=_f(u);const d=t[l];let p;if(Sy(d)){const f=d.length,v=d[0]===null?1:0;u=d[v],h=_f(u);for(let m=v;m<f&&d[m]!==null;m++)p?i2(_f(d[m])===p):p=_f(d[m])}else p=_f(d);if(h!==p)if(S5(h)&&S5(p)){const f=c.get();typeof f=="string"&&c.set(parseFloat(f)),typeof d=="string"?t[l]=parseFloat(d):Array.isArray(d)&&p===xt&&(t[l]=d.map(parseFloat))}else h!=null&&h.transform&&(p!=null&&p.transform)&&(u===0||d===0)?u===0?c.set(p.transform(u)):t[l]=h.transform(d):(a||(s=Rq(e),a=!0),o.push(l),n[l]=n[l]!==void 0?n[l]:t[l],c.jump(d))}),o.length){const l=o.indexOf("height")>=0?window.pageYOffset:null,c=Iq(t,e,o);return s.length&&s.forEach(([u,h])=>{e.getValue(u).set(h)}),e.render(),Zx&&l!==null&&window.scrollTo({top:l}),{target:c,transitionEnd:n}}else return{target:t,transitionEnd:n}};function Bq(e,t,i,n){return Pq(t)?Oq(e,t,i,n):{target:t,transitionEnd:n}}const Nq=(e,t,i,n)=>{const r=Aq(e,t,n);return t=r.target,n=r.transitionEnd,Bq(e,t,i,n)},tS={current:null},fB={current:!1};function Uq(){if(fB.current=!0,!!Zx)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>tS.current=e.matches;e.addListener(t),t()}else tS.current=!1}function Fq(e,t,i){const{willChange:n}=t;for(const r in t){const s=t[r],a=i[r];if(Fr(s))e.addValue(r,s),Ay(n)&&n.add(r);else if(Fr(a))e.addValue(r,aa(s,{owner:e})),Ay(n)&&n.remove(r);else if(a!==s)if(e.hasValue(r)){const o=e.getValue(r);!o.hasAnimated&&o.set(s)}else{const o=e.getStaticValue(r);e.addValue(r,aa(o!==void 0?o:s,{owner:e}))}}for(const r in i)t[r]===void 0&&e.removeValue(r);return t}const E5=new WeakMap,mB=Object.keys(x0),zq=mB.length,A5=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],kq=JC.length;class Vq{constructor({parent:t,props:i,presenceContext:n,reducedMotionConfig:r,visualState:s},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>Xt.render(this.render,!1,!0);const{latestValues:o,renderState:l}=s;this.latestValues=o,this.baseTarget={...o},this.initialValues=i.initial?{...o}:{},this.renderState=l,this.parent=t,this.props=i,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.isControllingVariants=Kx(i),this.isVariantNode=JI(i),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:c,...u}=this.scrapeMotionValuesFromProps(i,{});for(const h in u){const d=u[h];o[h]!==void 0&&Fr(d)&&(d.set(o[h],!1),Ay(c)&&c.add(h))}}scrapeMotionValuesFromProps(t,i){return{}}mount(t){this.current=t,E5.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((i,n)=>this.bindToMotionValue(n,i)),fB.current||Uq(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:tS.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){E5.delete(this.current),this.projection&&this.projection.unmount(),va(this.notifyUpdate),va(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,i){const n=tu.has(t),r=i.on("change",a=>{this.latestValues[t]=a,this.props.onUpdate&&Xt.update(this.notifyUpdate,!1,!0),n&&this.projection&&(this.projection.isTransformDirty=!0)}),s=i.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{r(),s()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}loadFeatures({children:t,...i},n,r,s){let a,o;for(let l=0;l<zq;l++){const c=mB[l],{isEnabled:u,Feature:h,ProjectionNode:d,MeasureLayout:p}=x0[c];d&&(a=d),u(i)&&(!this.features[c]&&h&&(this.features[c]=new h(this)),p&&(o=p))}if(!this.projection&&a){this.projection=new a(this.latestValues,this.parent&&this.parent.projection);const{layoutId:l,layout:c,drag:u,dragConstraints:h,layoutScroll:d,layoutRoot:p}=i;this.projection.setOptions({layoutId:l,layout:c,alwaysMeasureLayout:!!u||h&&Ed(h),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof c=="string"?c:"both",initialPromotionConfig:s,layoutScroll:d,layoutRoot:p})}return o}updateFeatures(){for(const t in this.features){const i=this.features[t];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):qi()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,i){this.latestValues[t]=i}makeTargetAnimatable(t,i=!0){return this.makeTargetAnimatableFromInstance(t,this.props,i)}update(t,i){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=i;for(let n=0;n<A5.length;n++){const r=A5[n];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const s=t["on"+r];s&&(this.propEventSubscriptions[r]=this.on(r,s))}this.prevMotionValues=Fq(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const n=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(n.initial=this.props.initial),n}const i={};for(let n=0;n<kq;n++){const r=JC[n],s=this.props[r];(y0(s)||s===!1)&&(i[r]=s)}return i}addVariantChild(t){const i=this.getClosestVariantNode();if(i)return i.variantChildren&&i.variantChildren.add(t),()=>i.variantChildren.delete(t)}addValue(t,i){i!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,i)),this.values.set(t,i),this.latestValues[t]=i.get()}removeValue(t){this.values.delete(t);const i=this.valueSubscriptions.get(t);i&&(i(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,i){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&i!==void 0&&(n=aa(i,{owner:this}),this.addValue(t,n)),n}readValue(t){var i;return this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(i=this.getBaseTargetFromProps(this.props,t))!==null&&i!==void 0?i:this.readValueFromInstance(this.current,t,this.options)}setBaseTarget(t,i){this.baseTarget[t]=i}getBaseTarget(t){var i;const{initial:n}=this.props,r=typeof n=="string"||typeof n=="object"?(i=oE(this.props,n))===null||i===void 0?void 0:i[t]:void 0;if(n&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!Fr(s)?s:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,i){return this.events[t]||(this.events[t]=new gE),this.events[t].add(i)}notify(t,...i){this.events[t]&&this.events[t].notify(...i)}}class gB extends Vq{sortInstanceNodePosition(t,i){return t.compareDocumentPosition(i)&2?1:-1}getBaseTargetFromProps(t,i){return t.style?t.style[i]:void 0}removeValueFromRenderState(t,{vars:i,style:n}){delete i[t],delete n[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:i,...n},{transformValues:r},s){let a=aX(n,t||{},this);if(r&&(i&&(i=r(i)),n&&(n=r(n)),a&&(a=r(a))),s){rX(this,n,a);const o=Nq(this,n,a,i);i=o.transitionEnd,n=o.target}return{transition:t,transitionEnd:i,...n}}}function Hq(e){return window.getComputedStyle(e)}class Gq extends gB{readValueFromInstance(t,i){if(tu.has(i)){const n=dE(i);return n&&n.default||0}else{const n=Hq(t),r=(rO(i)?n.getPropertyValue(i):n[i])||0;return typeof r=="string"?r.trim():r}}measureInstanceViewportBox(t,{transformPagePoint:i}){return rB(t,i)}build(t,i,n,r){tE(t,i,n,r.transformTemplate)}scrapeMotionValuesFromProps(t,i){return aE(t,i)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Fr(t)&&(this.childSubscription=t.on("change",i=>{this.current&&(this.current.textContent=`${i}`)}))}renderInstance(t,i,n,r){hO(t,i,n,r)}}class jq extends gB{constructor(){super(...arguments),this.isSVGTag=!1}getBaseTargetFromProps(t,i){return t[i]}readValueFromInstance(t,i){if(tu.has(i)){const n=dE(i);return n&&n.default||0}return i=uO.has(i)?i:sE(i),t.getAttribute(i)}measureInstanceViewportBox(){return qi()}scrapeMotionValuesFromProps(t,i){return pO(t,i)}build(t,i,n,r){nE(t,i,n,this.isSVGTag,r.transformTemplate)}renderInstance(t,i,n,r){dO(t,i,n,r)}mount(t){this.isSVGTag=rE(t.tagName),super.mount(t)}}const Wq=(e,t)=>eE(e)?new jq(t,{enableHardwareAcceleration:!1}):new Gq(t,{enableHardwareAcceleration:!0}),Xq={layout:{ProjectionNode:dB,MeasureLayout:sB}},qq={..._X,...Hj,...Mq,...Xq},cr=KG((e,t)=>Pj(e,t,qq,Wq));function Yq(e){const t=Jx(()=>aa(e)),{isStatic:i}=ze.useContext(ZC);if(i){const[,n]=ze.useState(e);ze.useEffect(()=>t.on("change",n),[])}return t}const Zq=e=>typeof e=="object"&&e.mix,Qq=e=>Zq(e)?e.mix:void 0;function Kq(...e){const t=!Array.isArray(e[0]),i=t?0:-1,n=e[0+i],r=e[1+i],s=e[2+i],a=e[3+i],o=n2(r,s,{mixer:Qq(s[0]),...a});return t?o(n):o}function vB(e,t){const i=Yq(t()),n=()=>i.set(t());return n(),KC(()=>{const r=()=>Xt.update(n,!1,!0),s=e.map(a=>a.on("change",r));return()=>{s.forEach(a=>a()),va(n)}}),i}function $q(e){Lm.current=[],e();const t=vB(Lm.current,e);return Lm.current=void 0,t}function T5(e,t,i,n){if(typeof e=="function")return $q(e);const r=typeof t=="function"?t:Kq(t,i,n);return Array.isArray(e)?P5(e,r):P5([e],([s])=>r(s))}function P5(e,t){const i=Jx(()=>[]);return vB(e,()=>{i.length=0;const n=e.length;for(let r=0;r<n;r++)i[r]=e[r].get();return t(i)})}function Jq(e,t,i){var n;if(typeof e=="string"){let r=document;t&&(i2(!!t.current),r=t.current),i?((n=i[e])!==null&&n!==void 0||(i[e]=r.querySelectorAll(e)),e=i[e]):e=r.querySelectorAll(e)}else e instanceof Element&&(e=[e]);return Array.from(e||[])}const Nv=new WeakMap;let Nl;function eY(e,t){if(t){const{inlineSize:i,blockSize:n}=t[0];return{width:i,height:n}}else return e instanceof SVGElement&&"getBBox"in e?e.getBBox():{width:e.offsetWidth,height:e.offsetHeight}}function tY({target:e,contentRect:t,borderBoxSize:i}){var n;(n=Nv.get(e))===null||n===void 0||n.forEach(r=>{r({target:e,contentSize:t,get size(){return eY(e,i)}})})}function iY(e){e.forEach(tY)}function nY(){typeof ResizeObserver>"u"||(Nl=new ResizeObserver(iY))}function rY(e,t){Nl||nY();const i=Jq(e);return i.forEach(n=>{let r=Nv.get(n);r||(r=new Set,Nv.set(n,r)),r.add(t),Nl==null||Nl.observe(n)}),()=>{i.forEach(n=>{const r=Nv.get(n);r==null||r.delete(t),r!=null&&r.size||Nl==null||Nl.unobserve(n)})}}const Uv=new Set;let Om;function sY(){Om=()=>{const e={width:window.innerWidth,height:window.innerHeight},t={target:window,size:e,contentSize:e};Uv.forEach(i=>i(t))},window.addEventListener("resize",Om)}function aY(e){return Uv.add(e),Om||sY(),()=>{Uv.delete(e),!Uv.size&&Om&&(Om=void 0)}}function oY(e,t){return typeof e=="function"?aY(e):rY(e,t)}const lY=50,D5=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),cY=()=>({time:0,x:D5(),y:D5()}),hY={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function L5(e,t,i,n){const r=i[t],{length:s,position:a}=hY[t],o=r.current,l=i.time;r.current=e["scroll"+a],r.scrollLength=e["scroll"+s]-e["client"+s],r.offset.length=0,r.offset[0]=0,r.offset[1]=r.scrollLength,r.progress=vp(0,r.scrollLength,r.current);const c=n-l;r.velocity=c>lY?0:uE(r.current-o,c)}function uY(e,t,i){L5(e,"x",t,i),L5(e,"y",t,i),t.time=i}function dY(e,t){const i={x:0,y:0};let n=e;for(;n&&n!==t;)if(n instanceof HTMLElement)i.x+=n.offsetLeft,i.y+=n.offsetTop,n=n.offsetParent;else if(n.tagName==="svg"){const r=n.getBoundingClientRect();n=n.parentElement;const s=n.getBoundingClientRect();i.x+=r.left-s.left,i.y+=r.top-s.top}else if(n instanceof SVGGraphicsElement){const{x:r,y:s}=n.getBBox();i.x+=r,i.y+=s;let a=null,o=n.parentNode;for(;!a;)o.tagName==="svg"&&(a=o),o=n.parentNode;n=a}else break;return i}const pY={Enter:[[0,1],[1,1]],Exit:[[0,0],[1,0]],Any:[[1,0],[0,1]],All:[[0,0],[1,1]]},iS={start:0,center:.5,end:1};function R5(e,t,i=0){let n=0;if(iS[e]!==void 0&&(e=iS[e]),typeof e=="string"){const r=parseFloat(e);e.endsWith("px")?n=r:e.endsWith("%")?e=r/100:e.endsWith("vw")?n=r/100*document.documentElement.clientWidth:e.endsWith("vh")?n=r/100*document.documentElement.clientHeight:e=r}return typeof e=="number"&&(n=t*e),i+n}const fY=[0,0];function mY(e,t,i,n){let r=Array.isArray(e)?e:fY,s=0,a=0;return typeof e=="number"?r=[e,e]:typeof e=="string"&&(e=e.trim(),e.includes(" ")?r=e.split(" "):r=[e,iS[e]?e:"0"]),s=R5(r[0],i,n),a=R5(r[1],t),s-a}const gY={x:0,y:0};function vY(e){return"getBBox"in e&&e.tagName!=="svg"?e.getBBox():{width:e.clientWidth,height:e.clientHeight}}function yY(e,t,i){let{offset:n=pY.All}=i;const{target:r=e,axis:s="y"}=i,a=s==="y"?"height":"width",o=r!==e?dY(r,e):gY,l=r===e?{width:e.scrollWidth,height:e.scrollHeight}:vY(r),c={width:e.clientWidth,height:e.clientHeight};t[s].offset.length=0;let u=!t[s].interpolate;const h=n.length;for(let d=0;d<h;d++){const p=mY(n[d],c[a],l[a],o[s]);!u&&p!==t[s].interpolatorOffsets[d]&&(u=!0),t[s].offset[d]=p}u&&(t[s].interpolate=n2(t[s].offset,GO(n)),t[s].interpolatorOffsets=[...t[s].offset]),t[s].progress=t[s].interpolate(t[s].current)}function xY(e,t=e,i){if(i.x.targetOffset=0,i.y.targetOffset=0,t!==e){let n=t;for(;n&&n!==e;)i.x.targetOffset+=n.offsetLeft,i.y.targetOffset+=n.offsetTop,n=n.offsetParent}i.x.targetLength=t===e?t.scrollWidth:t.clientWidth,i.y.targetLength=t===e?t.scrollHeight:t.clientHeight,i.x.containerLength=e.clientWidth,i.y.containerLength=e.clientHeight}function _Y(e,t,i,n={}){return{measure:()=>xY(e,n.target,i),update:r=>{uY(e,i,r),(n.offset||n.target)&&yY(e,i,n)},notify:()=>t(i)}}const wf=new WeakMap,I5=new WeakMap,b_=new WeakMap,O5=e=>e===document.documentElement?window:e;function bY(e,{container:t=document.documentElement,...i}={}){let n=b_.get(t);n||(n=new Set,b_.set(t,n));const r=cY(),s=_Y(t,e,r,i);if(n.add(s),!wf.has(t)){const o=()=>{for(const d of n)d.measure()},l=()=>{for(const d of n)d.update(rn.timestamp)},c=()=>{for(const d of n)d.notify()},u=()=>{Xt.read(o,!1,!0),Xt.update(l,!1,!0),Xt.update(c,!1,!0)};wf.set(t,u);const h=O5(t);window.addEventListener("resize",u,{passive:!0}),t!==document.documentElement&&I5.set(t,oY(t,u)),h.addEventListener("scroll",u,{passive:!0})}const a=wf.get(t);return Xt.read(a,!1,!0),()=>{var o;va(a);const l=b_.get(t);if(!l||(l.delete(s),l.size))return;const c=wf.get(t);wf.delete(t),c&&(O5(t).removeEventListener("scroll",c),(o=I5.get(t))===null||o===void 0||o(),window.removeEventListener("resize",c))}}function B5(e,t){bO(!!(!t||t.current))}const wY=()=>({scrollX:aa(0),scrollY:aa(0),scrollXProgress:aa(0),scrollYProgress:aa(0)});function SY({container:e,target:t,layoutEffect:i=!0,...n}={}){const r=Jx(wY);return(i?KC:ze.useEffect)(()=>(B5("target",t),B5("container",e),bY(({x:a,y:o})=>{r.scrollX.set(a.current),r.scrollXProgress.set(a.progress),r.scrollY.set(o.current),r.scrollYProgress.set(o.progress)},{...n,container:(e==null?void 0:e.current)||void 0,target:(t==null?void 0:t.current)||void 0})),[e,t,JSON.stringify(n.offset)]),r}const MY={visible:{opacity:1,x:0,transition:{delay:.05}},hidden:{opacity:0,x:-100}};function CY(){const e=t=>{t.preventDefault()};return ee.jsxs("div",{className:"snap-start flex flex-col justify-center relative w-full h-[100vh] z-20 bg-opacity-30 backdrop-filter backdrop-blur-lg",children:[ee.jsx("div",{className:" h-full w-full flex absolute justify-center items-center rounded-3xl ",children:ee.jsx("video",{src:qx.bg1p1,autoPlay:!0,loop:!0,muted:!0,controls:!1,onContextMenu:e,className:"egbon absolute w-[95%] h-[95%] object-cover rounded-3xl border z-[1]"})}),ee.jsxs(cr.div,{variants:MY,initial:"hidden",whileInView:"visible",className:"z-30  tablet:w-[34.125rem] max-w-[80%] pl-8 tablet:pl-32",children:[ee.jsxs("p",{className:"flex items-center font-medium text-sm gap-2",children:["Okay let us"," ",ee.jsx("svg",{width:"2",height:"12",viewBox:"0 0 2 12",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:ee.jsx("path",{d:"M1.30528 0.795898C1.30528 0.795898 1.86448 0.795898 1.86448 1.35509V11.4205C1.86448 11.4205 1.86448 11.9797 1.30528 11.9797C1.30528 11.9797 0.746094 11.9797 0.746094 11.4205V1.35509C0.746094 1.35509 0.746093 0.795898 1.30528 0.795898Z",fill:"#3F4550"})})," ",ee.jsxs("span",{className:"flex items-center gap-1 text-transparent font-medium text-base bg-clip-text bg-gradient-to-r from-[#6557FF] to-[#F8522E]",children:["Explore"," ",ee.jsx("svg",{width:"10",height:"10",viewBox:"0 0 10 10",fill:"#F8522E",xmlns:"http://www.w3.org/2000/svg",children:ee.jsx("path",{d:"M4.80696 0.885254L4.03168 1.66053L7.09981 4.73416H0.408203V5.83385H7.09981L4.03168 8.90748L4.80696 9.68276L9.20571 5.28401L4.80696 0.885254Z",fill:"#F8522E"})})]})]}),ee.jsx("h1",{className:"font-bold text-2xl tablet:text-5xl mt-5",children:"A.I That Answers Everything About the Universe"}),ee.jsxs("button",{className:"flex justify-center items-center gap-4 bg-white font-normal text-sm text-black rounded-full px-8 py-3 mt-12",children:["Explore"," ",ee.jsx("svg",{width:"6",height:"9",viewBox:"0 0 6 9",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:ee.jsx("path",{d:"M1.44112 0.237305L0.445312 1.23312L3.67994 4.4748L0.445312 7.71649L1.44112 8.71231L5.67863 4.4748L1.44112 0.237305Z",fill:"currentColor"})})]})]})]})}const EY="/assets/xailogo-b38d7df6.svg",AY="/assets/ArtificiumChatbox-9854aac7.svg",TY="/assets/clippathchatbox-6cedd2ca.svg",PY="/assets/connectlogo-2ab1e9a8.svg",DY="/assets/integratelogo-8045063d.svg",LY="/assets/validatelogo-6d9e9208.svg",RY="/assets/unlikelefttop-5e548434.svg",IY="/assets/unlikerighttop-bd992828.svg",OY="/assets/unlikebottomleft-4c61709a.svg",BY="/assets/unlikebottomright-39d914d2.svg",NY="/assets/greensource-acaf74aa.svg",UY="/assets/exchangetopleft-0d2c931f.svg",N5="/assets/exchangetopright-b1d4abcb.svg",FY="/assets/exchangebottomright-cd4aa4a8.svg",zY="/assets/communitychatlogo-47ef7aac.svg",kY="/assets/twitterlogo-61993ef1.svg",VY="/assets/developerchatlogo-81575e63.svg",HY="/assets/cosmosforumlogo-5ef65811.svg",GY="/assets/footervector-5ef0e25c.svg",jY="/assets/cosmoslogo-565a5eab.svg",jn={xailogo:EY,ArtificiumChatbox:AY,clippathchatbox:TY,connectlogo:PY,integratelogo:DY,validatelogo:LY,unlikelefttop:RY,unlikerighttop:IY,unlikebottomleft:OY,unlikebottomright:BY,greensource:NY,exchangetopleft:UY,exchangetopright:N5,exchangebottomleft:N5,exchangebottomright:FY,communitychatlogo:zY,twitterlogo:kY,developerchatlogo:VY,cosmosforumlogo:HY,footervector:GY,cosmoslogo:jY};function WY(){return ee.jsxs("nav",{className:"z-[99999] absolute flex justify-between items-center w-[90%] mt-[3.5%] h-14 border rounded-xl pr-14 pl-9 left-[50%] translate-x-[-50%] backdrop-blur-[2px] top-[2.5%] tablet:top-0",children:[ee.jsx("img",{src:jn.xailogo,alt:""}),ee.jsxs("ul",{className:"flex gap-8 text-[#6A6B6D]",children:[ee.jsx("li",{children:"Resources"}),ee.jsx("li",{children:"Login"}),ee.jsxs("li",{className:"flex items-center gap-4 text-white",children:["Start Now"," ",ee.jsx("svg",{width:"6",height:"9",viewBox:"0 0 6 9",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:ee.jsx("path",{d:"M1.44112 0.237305L0.445312 1.23312L3.67994 4.4748L0.445312 7.71649L1.44112 8.71231L5.67863 4.4748L1.44112 0.237305Z",fill:"#D2D4D7"})})]})]})]})}function XY(){return ee.jsxs("div",{className:"grid my-[12.5vh] w-full tablet:grid-cols-6 place-items-center px-[5%] gap-[5%] tablet:px-36 tablet:gap-14 ",children:[ee.jsx("svg",{width:"94",height:"26",viewBox:"0 0 94 26",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:ee.jsx("path",{d:"M6.8912 9.03519C4.67041 9.03519 3.5809 10.9959 3.5809 13.614V20.1747H0.449219V6.33004H3.5258V9.92181H3.57912C4.23674 7.71326 5.54575 5.92848 7.56481 5.92848C8.9858 5.92848 9.58476 6.42598 9.58476 6.42598L8.17177 9.27772C8.17177 9.27772 7.72122 9.03519 6.8912 9.03519ZM44.745 10.9364V20.1721H41.6951V12.0611C41.6951 9.73169 40.9664 8.4986 39.1038 8.4986C37.1753 8.4986 36.2422 10.0586 36.2422 13.0507V20.1721H33.219V12.0602C33.219 9.82142 32.4992 8.49771 30.6552 8.49771C28.5508 8.49771 27.7403 10.3456 27.7403 13.0498V20.1721H24.6637V6.33004H27.7403V9.46517H27.7679C28.2477 7.29483 29.555 5.95602 31.7624 5.95602C33.9512 5.95602 35.3776 7.13492 35.9188 9.22442C36.4342 7.2131 37.8054 5.95513 39.9133 5.95513C42.8548 5.95513 44.7459 7.80299 44.7459 10.9355L44.745 10.9364ZM15.7388 5.92848C12.9084 5.92848 11.0555 7.26107 10.2113 9.66506L12.8169 10.6148C13.2923 9.16401 14.2832 8.3378 15.7939 8.3378C17.4948 8.3378 18.4937 9.0885 18.4937 10.239C18.4937 11.417 17.6983 11.6631 15.9023 11.9536C13.9046 12.276 9.15287 12.3818 9.15287 16.3982C9.15287 18.7507 11.1168 20.5212 14.0663 20.5212C16.2836 20.5212 17.7934 19.6133 18.4919 17.9236H18.5195V20.1721H21.5703V11.6577C21.5685 7.9327 19.6978 5.92848 15.7388 5.92848ZM18.5737 13.6575C18.5737 16.5599 17.1394 18.4246 14.8484 18.4246C13.2283 18.4246 12.257 17.5131 12.257 16.2001C12.257 14.9688 13.2559 14.1132 15.1718 13.7614C17.1322 13.4008 18.1196 12.9548 18.5728 11.8869V13.6566L18.5737 13.6575ZM55.5966 5.95513C53.263 5.95513 51.722 7.24064 51.0617 9.17112V6.33004H47.8216V25.5024H51.0342V17.3328H51.0608C51.7762 19.4241 53.2647 20.5745 55.5966 20.5745C59.2935 20.5745 61.94 17.522 61.94 13.2098C61.9382 8.9277 59.2935 5.95513 55.5966 5.95513ZM54.7995 18.0044C52.2383 18.0044 50.8182 16.1432 50.8182 13.2515C50.8182 10.3598 52.4072 8.4986 54.7995 8.4986C57.19 8.4986 58.7807 10.4504 58.7807 13.2515C58.7807 16.0544 57.1918 18.0044 54.7995 18.0044ZM93.7597 20.1099V20.197L81.2223 20.2014V20.1108C83.0308 19.0874 84.2785 18.0453 85.4009 16.957H90.5489L93.7597 20.1099ZM90.6529 3.75103L87.475 0.627441H87.3835C87.3835 0.627441 87.4368 6.44819 82.1012 11.7412C76.8803 16.9223 70.7405 16.9348 70.7405 16.9348V17.0254L73.9779 20.2032C73.9779 20.2032 80.028 20.2627 85.3724 15.0096C90.6982 9.77522 90.6529 3.75103 90.6529 3.75103Z",fill:"#EEEFFC"})}),ee.jsx("svg",{width:"80",height:"24",viewBox:"0 0 80 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:ee.jsx("path",{d:"M24.4687 10.8568H17.282L23.5054 7.33784L22.2719 5.24301L16.0476 8.76193L19.6397 2.66756L17.5015 1.45934L13.9086 7.55194V0.515869H11.4381V7.55194L7.84609 1.45934L5.70706 2.66756L9.29907 8.76016L3.07659 5.24301L1.84134 7.33784L8.0647 10.8559H0.878906V13.275H8.0647L1.84223 16.793L3.0757 18.8869L9.29996 15.3689L5.70706 21.4633L7.8452 22.6715L11.439 16.578V23.6141H13.9095V16.427L17.5682 22.6333L19.573 21.4997L15.9134 15.2925L22.2701 18.8869L23.5054 16.7921L17.2829 13.2741H24.4678L24.4687 10.8568ZM12.6734 15.352C12.2326 15.352 11.7962 15.2676 11.3892 15.1033C10.983 14.9387 10.6129 14.6964 10.2997 14.3899C9.98856 14.086 9.74087 13.7233 9.571 13.3229C9.40248 12.9248 9.31564 12.4969 9.31564 12.0645C9.31564 11.6322 9.40248 11.2043 9.571 10.8061C9.73985 10.4063 9.98779 10.0448 10.2997 9.74005C10.6107 9.43356 10.9813 9.19191 11.3883 9.02667C11.7953 8.86143 12.2326 8.77615 12.6734 8.77615C13.5638 8.77615 14.4169 9.12262 15.047 9.73828C15.3578 10.041 15.6049 10.4028 15.7738 10.8023C15.9428 11.2019 16.0301 11.6312 16.0308 12.065C16.0308 12.9365 15.6771 13.7734 15.0479 14.3899C14.4129 15.0092 13.5605 15.3552 12.6734 15.3538V15.352ZM30.8351 20.5136V3.61636H34.0015V20.5136H30.8351ZM61.2028 9.03111H64.2261V10.4321C64.8695 9.31185 66.3695 8.70419 67.6546 8.70419C69.2506 8.70419 70.5356 9.38203 71.1311 10.6178C72.0588 9.2159 73.2976 8.70419 74.8448 8.70419C77.0114 8.70419 79.082 9.98791 79.082 13.068V20.5127H76.0116V13.6987C76.0116 12.4612 75.3922 11.5275 73.9392 11.5275C72.5823 11.5275 71.7727 12.5554 71.7727 13.7929V20.5145H68.6312V13.6987C68.6312 12.4612 67.9887 11.5275 66.5588 11.5275C65.1778 11.5275 64.3683 12.5323 64.3683 13.7929V20.5145H61.2028V9.03111ZM41.157 20.8467C37.5899 20.8467 35.0074 18.2535 35.0074 14.7719C35.0074 11.3454 37.5819 8.69264 41.157 8.69264C44.7491 8.69264 47.3067 11.3703 47.3067 14.7719C47.3067 18.2286 44.7224 20.8467 41.157 20.8467ZM41.157 11.5026C40.2719 11.5044 39.4241 11.8491 38.7985 12.4621C38.4901 12.7629 38.2447 13.1222 38.0769 13.519C37.909 13.9158 37.822 14.342 37.821 14.7728C37.821 15.6399 38.1729 16.4705 38.7985 17.0835C39.4291 17.6988 40.2754 18.0432 41.1566 18.0432C42.0378 18.0432 42.8841 17.6988 43.5147 17.0835C43.823 16.7828 44.0683 16.4236 44.2362 16.027C44.404 15.6304 44.4911 15.2043 44.4922 14.7737C44.4922 13.9066 44.1403 13.0751 43.5147 12.4621C42.8841 11.847 42.0381 11.5027 41.157 11.5026ZM54.0694 20.8458C50.5023 20.8458 47.9198 18.2535 47.9198 14.7719C47.9198 11.3454 50.4943 8.69264 54.0694 8.69264C57.6615 8.69264 60.2199 11.3703 60.2199 14.7719C60.2199 18.2286 57.6339 20.8458 54.0694 20.8458ZM54.0694 11.4644C53.1782 11.4643 52.3222 11.8124 51.6843 12.4345C51.3723 12.7387 51.1241 13.102 50.9543 13.5032C50.7845 13.9044 50.6964 14.3354 50.6952 14.771C50.6963 15.2068 50.7844 15.638 50.9542 16.0393C51.124 16.4406 51.3722 16.8041 51.6843 17.1084C52.3222 17.7307 53.1781 18.079 54.0694 18.079C54.9607 18.079 55.8167 17.7307 56.4546 17.1084C56.7666 16.8042 57.0147 16.4409 57.1845 16.0397C57.3544 15.6385 57.4425 15.2075 57.4437 14.7719C57.4426 14.3361 57.3546 13.9049 57.1848 13.5036C57.0149 13.1023 56.7667 12.7388 56.4546 12.4345C55.8168 11.8121 54.9608 11.4645 54.0694 11.4644Z",fill:"#EEEFFC"})}),ee.jsx("svg",{width:"102",height:"24",viewBox:"0 0 102 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:ee.jsx("path",{d:"M50.8996 6.29194C46.9672 6.29194 44.1316 8.89194 44.1316 12.7924C44.1316 16.6919 47.3227 19.2919 51.2552 19.2919C53.6312 19.2919 55.7263 18.339 57.0223 16.7319L54.297 15.1355C53.577 15.9337 52.4836 16.3995 51.2552 16.3995C49.5494 16.3995 48.0996 15.4964 47.5618 14.0528H57.5423C57.6205 13.6475 57.6667 13.2288 57.6667 12.7879C57.6667 8.89194 54.8312 6.29194 50.8996 6.29194ZM47.5298 11.5275C47.9743 10.0875 49.193 9.18083 50.8961 9.18083C52.6018 9.18083 53.8205 10.0875 54.2614 11.5275H47.5298ZM89.2525 6.29194C85.3201 6.29194 82.4854 8.89194 82.4854 12.7924C82.4854 16.6919 85.6765 19.2919 89.609 19.2919C91.9841 19.2919 94.0783 18.339 95.3752 16.7319L92.6507 15.1355C91.9307 15.9337 90.8374 16.3995 89.609 16.3995C87.9023 16.3995 86.4525 15.4964 85.9147 14.0528H95.8952C95.9734 13.6475 96.0196 13.2288 96.0196 12.7879C96.0196 8.89194 93.185 6.29194 89.2525 6.29194ZM85.8863 11.5275C86.3316 10.0875 87.5503 9.18083 89.2525 9.18083C90.9583 9.18083 92.177 10.0875 92.6187 11.5275H85.8863ZM71.985 12.7915C71.985 14.9586 73.3814 16.403 75.5467 16.403C77.0143 16.403 78.1147 15.7275 78.6809 14.6262L81.417 16.2262C80.2836 18.1399 78.1609 19.2919 75.5467 19.2919C71.6107 19.2919 68.7796 16.6919 68.7796 12.7915C68.7796 8.89194 71.6143 6.29194 75.5467 6.29194C78.1609 6.29194 80.2801 7.44394 81.417 9.35861L78.6809 10.9577C78.1147 9.85549 77.0143 9.18083 75.5467 9.18083C73.3849 9.18083 71.985 10.6244 71.985 12.7915ZM101.363 2.32038V18.9311H98.1565V2.31861H101.363V2.32038ZM13.825 0.51416L26.9858 23.6253H0.664062L13.825 0.51416ZM46.7281 2.31949L36.8587 19.6528L26.9894 2.31949H30.6898L36.8587 13.1533L43.0276 2.31949H46.7281ZM67.7112 6.65283V10.1524C67.3416 10.0385 66.9575 9.97863 66.5707 9.9746C64.5014 9.9746 63.009 11.4199 63.009 13.5862V18.9311H59.8036V6.65283H63.009V9.97549C63.009 8.14083 65.1147 6.65283 67.7112 6.65283Z",fill:"#EEEFFC"})}),ee.jsx("svg",{width:"101",height:"25",viewBox:"0 0 101 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:ee.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M43.5232 11.9211C43.8058 10.5965 44.7185 9.92217 45.9191 9.92217C47.1081 9.92217 47.9781 10.6267 48.2563 11.9211H43.5232ZM45.9839 7.62834C42.9287 7.62834 41.0278 9.98614 41.0278 12.8707C41.0278 15.8584 43.0584 18.0741 46.0773 18.0741C48.1585 18.0741 49.4213 17.1439 50.2025 15.973L48.2607 14.7746C47.772 15.4195 46.9899 15.7607 46.1528 15.7607C44.7816 15.7607 43.8636 15.1406 43.5508 13.9004H48.6802L48.6784 13.9057L50.5482 13.9164C50.6193 13.5895 50.661 13.2528 50.661 12.8716C50.661 10.3593 49.0587 7.62923 45.9848 7.62923L45.9839 7.62834ZM34.2055 15.7172C32.5179 15.7172 31.5039 14.5081 31.5039 13.0164C31.5039 11.5239 32.5375 10.3148 34.2055 10.3148C35.8726 10.3148 36.9071 11.5239 36.9071 13.0156C36.9071 14.5081 35.8922 15.7172 34.2055 15.7172ZM36.9071 9.33317C36.1837 8.48031 35.1573 7.95794 33.8838 7.95794C31.0356 7.95794 28.9872 10.2233 28.9872 13.0164C28.9872 15.8096 31.0169 18.0741 33.8838 18.0741C35.1573 18.0741 36.1837 17.5517 36.9062 16.6988V17.8253H39.4229V4.41414H36.9062L36.9071 9.33317ZM58.1943 12.6424C58.8972 13.1222 59.3433 13.8444 59.3433 14.7959C59.3433 16.7202 58.0192 18.0545 55.5416 18.0545C53.2106 18.0545 51.9603 16.8854 51.4626 15.7047L53.6025 14.4823C53.6025 14.4823 53.8904 15.758 55.5034 15.758C56.5014 15.758 56.8088 15.3263 56.8088 14.9451C56.8088 14.7675 56.7511 14.4432 56.041 14.1678C54.6138 13.6161 51.8554 13.3682 51.8554 10.8505C51.8554 8.78947 53.5057 7.69053 55.5416 7.69053C57.4451 7.69053 58.6679 8.84988 59.1318 9.7516L57.039 10.9492C57.039 10.9492 56.6364 9.94794 55.5612 9.94794C54.4859 9.94794 54.3899 10.5565 54.3899 10.7333C54.3899 11.2485 54.9266 11.46 56.0793 11.7931C56.7617 11.9904 57.4629 12.1698 58.1961 12.6398L58.1943 12.6424ZM100.426 10.3984H98.2556V14.4814C98.2556 15.7571 99.5228 15.4826 100.426 15.4826V17.7791C100.426 17.7791 99.9503 17.8573 99.1203 17.8573C97.2772 17.8573 95.7789 17.3074 95.7789 14.4814V10.3984H94.1082V7.96416H95.7789V5.21636H98.2556V7.96416H100.426V10.3984ZM65.5009 15.5803C66.5291 15.5803 67.3192 15.0793 67.7191 14.2566L69.8661 15.5155C69.0245 17.024 67.4569 18.0732 65.5009 18.0732C62.5346 18.0732 60.4613 15.7536 60.4613 12.8912C60.4613 10.0297 62.5541 7.70919 65.5009 7.70919C67.4285 7.70919 68.9899 8.7415 69.8403 10.2296L67.6977 11.5177C67.2907 10.7057 66.5069 10.2029 65.5009 10.2029C64.0026 10.2029 62.938 11.4058 62.938 12.8912C62.938 14.3766 63.9929 15.5803 65.5009 15.5803ZM88.171 16.0157C86.5447 16.0157 85.5663 14.7746 85.5663 13.243C85.5663 11.7114 86.5634 10.4712 88.171 10.4712C89.7786 10.4712 90.7757 11.7114 90.7757 13.243C90.7757 14.7746 89.7981 16.0157 88.171 16.0157ZM88.4811 8.05122C91.2271 8.05122 93.2017 10.3761 93.2017 13.243C93.2017 16.1098 91.2458 18.4339 88.4811 18.4339C87.253 18.4339 86.2639 17.8982 85.5663 17.0231V22.0914H83.1402V8.32662H85.5663V9.46287C86.2639 8.58781 87.253 8.05122 88.4811 8.05122ZM78.4764 18.1789V8.34705H80.9025V18.1789H78.4764ZM73.9558 10.0261C74.4241 8.83478 75.3776 8.15338 76.8137 8.14983V10.982C75.1297 10.815 73.9131 11.691 73.9576 13.7591L73.9558 13.7547V18.1789H71.5297V8.34705H73.9558V10.0261ZM78.4764 7.0349V4.41414H80.9825V7.0349H78.4764ZM0.894531 22.341C0.894531 23.6523 1.73166 24.5025 3.02201 24.5025H9.23738C12.9449 24.5025 15.9788 23.2276 18.0406 20.996H0.894531V22.341ZM9.23738 0.515869H3.02201C1.73166 0.515869 0.894531 1.36606 0.894531 2.67733V4.02236H18.0406C15.9788 1.79071 12.9449 0.515869 9.23738 0.515869ZM14.6618 15.9268C14.6618 16.9876 15.3417 17.6761 16.3903 17.6761H20.1138C20.5368 16.6109 20.8203 15.4409 20.9518 14.1785H16.3903C15.3417 14.1785 14.6618 14.8661 14.6618 15.9268ZM9.49865 9.10041C9.49865 10.1612 10.1794 10.8488 11.228 10.8488H20.9518C20.8341 9.65012 20.5524 8.47329 20.1147 7.35116H11.228C10.1794 7.35116 9.49865 8.03967 9.49865 9.10041ZM11.2262 15.9268C11.2262 14.8661 10.5464 14.1785 9.49776 14.1785H0.894531V17.6761H9.49776C10.5464 17.6761 11.2262 16.9876 11.2262 15.9268ZM6.06393 9.10041C6.06393 8.03967 5.3841 7.35116 4.33547 7.35116H0.894531V10.8488H4.33547C5.3841 10.8488 6.06393 10.1612 6.06393 9.10041Z",fill:"#EEEFFC"})}),ee.jsxs("svg",{width:"114",height:"26",viewBox:"0 0 114 26",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[ee.jsx("path",{d:"M45.8956 10.2415C45.7957 10.3019 45.6769 10.3229 45.5623 10.3004C45.4478 10.2778 45.3457 10.2134 45.2761 10.1197C44.9346 9.6299 44.4765 9.2329 43.9431 8.96457C43.4097 8.69624 42.8178 8.56504 42.221 8.58282C39.893 8.58282 38.4645 10.4219 38.4645 13.0468C38.4645 15.6726 39.9188 17.5464 42.2468 17.5464C42.8514 17.5606 43.4498 17.4206 43.9854 17.1396C44.521 16.8586 44.9762 16.4458 45.3081 15.9402C45.3742 15.8449 45.4736 15.778 45.5867 15.7526C45.6998 15.7273 45.8183 15.7454 45.9187 15.8033L47.0245 16.4433C47.0849 16.4737 47.1379 16.5168 47.1801 16.5696C47.2222 16.6224 47.2525 16.6837 47.2688 16.7492C47.2851 16.8148 47.287 16.8831 47.2745 16.9495C47.2619 17.0159 47.2352 17.0788 47.1961 17.1339C46.6553 17.9434 45.9177 18.6022 45.0527 19.0487C44.1877 19.4953 43.2234 19.7148 42.2503 19.6868C38.5285 19.6868 36.0059 16.9917 36.0059 13.0619C36.0059 9.13216 38.5285 6.47171 42.1943 6.47171C43.1512 6.44534 44.1 6.6533 44.9582 7.07749C45.8163 7.50167 46.5577 8.12923 47.1179 8.90549C47.1563 8.95776 47.1837 9.0174 47.1981 9.08068C47.2125 9.14396 47.2138 9.20954 47.2018 9.27333C47.1898 9.33712 47.1648 9.39776 47.1283 9.45146C47.0918 9.50516 47.0447 9.55079 46.9899 9.58549L45.8956 10.2415ZM54.0316 18.9739V18.4406C53.4494 19.189 52.6379 19.6539 51.3312 19.6539C49.3987 19.6539 48.0574 18.5997 48.0574 16.7499C48.0574 14.4468 50.1152 14.0513 51.3836 13.8744C52.7454 13.677 53.9063 13.5837 53.9063 12.6948C53.9063 11.9082 52.9952 11.6957 52.2245 11.6957C51.3395 11.7103 50.4699 11.93 49.6841 12.3375C49.6296 12.367 49.5697 12.3853 49.5079 12.3912C49.4462 12.3971 49.3839 12.3905 49.3248 12.3719C49.2656 12.3532 49.2109 12.3229 49.1637 12.2826C49.1166 12.2423 49.078 12.193 49.0503 12.1375L48.6512 11.3064C48.5982 11.1988 48.5886 11.075 48.6243 10.9605C48.66 10.846 48.7384 10.7496 48.8432 10.6913C49.9436 10.1063 51.1703 9.79907 52.4165 9.79616C54.6334 9.79616 56.1988 10.7055 56.1988 12.9046V18.9739C56.1989 19.035 56.1869 19.0955 56.1636 19.152C56.1403 19.2084 56.106 19.2597 56.0628 19.3029C56.0197 19.3461 55.9684 19.3804 55.9119 19.4037C55.8555 19.427 55.7949 19.4389 55.7339 19.4388H54.517C54.4543 19.4415 54.3916 19.4314 54.3329 19.4092C54.2742 19.3871 54.2206 19.3532 54.1752 19.3098C54.1299 19.2664 54.0938 19.2143 54.0691 19.1565C54.0445 19.0988 54.0317 19.0367 54.0316 18.9739ZM53.9063 14.7775C53.4787 15.1002 52.6903 15.2077 51.8494 15.3579C51.0076 15.509 50.3099 15.733 50.3099 16.645C50.3099 17.4842 50.9179 17.8762 51.797 17.8762C52.8876 17.8762 53.9063 17.269 53.9063 15.8584V14.7775ZM58.1979 17.0344C58.2765 16.943 58.3874 16.8856 58.5074 16.8744C58.6275 16.8631 58.7472 16.8988 58.8414 16.9739C59.6197 17.5603 60.573 17.8672 61.5472 17.845C62.5516 17.845 63.293 17.5233 63.293 16.7393C63.293 16.0246 62.6121 15.8824 60.965 15.5944C59.2192 15.3037 57.549 14.7233 57.549 12.7366C57.549 10.6655 59.3392 9.79171 61.3783 9.79171C62.657 9.77286 63.9053 10.1818 64.925 10.9535C64.9749 10.9921 65.0165 11.0406 65.0469 11.096C65.0774 11.1513 65.0963 11.2123 65.1023 11.2752C65.1083 11.3381 65.1013 11.4015 65.0818 11.4616C65.0623 11.5217 65.0307 11.5772 64.989 11.6246L64.4076 12.3064C64.3305 12.3981 64.2212 12.4567 64.1022 12.4703C63.9831 12.4838 63.8634 12.4513 63.7676 12.3793C63.0501 11.8554 62.1822 11.5781 61.2939 11.589C60.4361 11.589 59.685 11.8388 59.685 12.5162C59.685 13.2682 60.7383 13.4104 61.7943 13.5908C64.0494 13.9819 65.4814 14.6246 65.4814 16.4948C65.4814 18.4584 63.9072 19.6726 61.4076 19.6726C60.0417 19.7142 58.704 19.2786 57.6245 18.4406C57.5764 18.401 57.5366 18.3522 57.5075 18.297C57.4784 18.2419 57.4605 18.1815 57.4549 18.1195C57.4492 18.0574 57.456 17.9948 57.4747 17.9353C57.4935 17.8758 57.5239 17.8207 57.5641 17.773L58.1979 17.0353V17.0344ZM66.8636 18.9757V7.15438C66.8636 7.09325 66.8757 7.03273 66.8991 6.97627C66.9225 6.91981 66.9569 6.86852 67.0001 6.82534C67.0434 6.78216 67.0947 6.74793 67.1512 6.72462C67.2077 6.70131 67.2683 6.68937 67.3294 6.68949H68.6708C68.7319 6.68937 68.7924 6.70131 68.8489 6.72462C68.9054 6.74793 68.9568 6.78216 69 6.82534C69.0433 6.86852 69.0776 6.91981 69.1011 6.97627C69.1245 7.03273 69.1365 7.09325 69.1365 7.15438V11.1917C69.4712 10.747 69.9072 10.3885 70.4083 10.1461C70.9093 9.90371 71.461 9.78434 72.0174 9.79794C74.0014 9.79794 75.165 11.2086 75.165 13.2246V18.9757C75.1647 19.0989 75.1157 19.2169 75.0285 19.3039C74.9413 19.3909 74.8232 19.4397 74.7001 19.4397H73.3588C73.2355 19.4397 73.1173 19.3909 73.03 19.3039C72.9427 19.217 72.8934 19.0989 72.893 18.9757V13.7473C72.893 12.7455 72.5694 11.8362 71.2832 11.8362C70.0645 11.8362 69.1365 12.693 69.1365 14.1224V18.9784C69.1363 19.1018 69.0871 19.22 68.9998 19.3072C68.9125 19.3943 68.7941 19.4433 68.6708 19.4433H67.3294C67.268 19.4437 67.207 19.432 67.1502 19.4086C67.0934 19.3853 67.0417 19.3508 66.9984 19.3073C66.955 19.2637 66.9207 19.212 66.8976 19.1551C66.8745 19.0981 66.8629 19.0372 66.8636 18.9757ZM89.9259 19.1277L88.9605 16.2815H84.077L83.109 19.1277C83.0772 19.2192 83.0179 19.2986 82.939 19.3548C82.8602 19.411 82.7658 19.4413 82.669 19.4415H81.0948C80.9819 19.4408 80.8732 19.3994 80.7884 19.325C80.7036 19.2505 80.6486 19.148 80.6334 19.0362C80.6241 18.962 80.633 18.8866 80.6592 18.8166L85.0548 6.99349C85.0906 6.90711 85.1513 6.83334 85.2292 6.78157C85.307 6.72981 85.3986 6.7024 85.4921 6.70282H87.6423C87.7378 6.70317 87.8309 6.73251 87.9093 6.78696C87.9877 6.8414 88.0477 6.91839 88.0814 7.00771L92.461 18.8282C92.5009 18.9344 92.5001 19.0517 92.4588 19.1573C92.4174 19.263 92.3384 19.3497 92.237 19.4006C92.1703 19.4352 92.0962 19.4532 92.021 19.453H90.3596C90.2625 19.4508 90.1684 19.4182 90.0907 19.3598C90.0129 19.3015 89.9553 19.2204 89.9259 19.1277ZM86.5445 8.76238L84.6645 14.2975H88.3516L86.5445 8.76238ZM95.8325 10.4762V11.2086C96.164 10.752 96.6031 10.3843 97.1107 10.1381C97.6184 9.89183 98.179 9.77469 98.7428 9.79705C101.318 9.79705 102.982 11.9233 102.982 14.7082C102.982 17.4939 101.318 19.6459 98.7428 19.6459C98.1772 19.6673 97.6153 19.5479 97.1073 19.2984C96.5994 19.049 96.1613 18.6772 95.8325 18.2166V22.0708C95.8325 22.1319 95.8205 22.1923 95.7971 22.2487C95.7738 22.3051 95.7395 22.3564 95.6964 22.3995C95.6532 22.4427 95.6019 22.477 95.5455 22.5003C95.4891 22.5237 95.4287 22.5357 95.3676 22.5357H94.0263C93.9652 22.5358 93.9046 22.5239 93.8481 22.5006C93.7916 22.4773 93.7403 22.443 93.697 22.3999C93.6537 22.3567 93.6194 22.3054 93.596 22.2489C93.5726 22.1925 93.5605 22.1319 93.5605 22.0708V10.453C93.5605 10.3919 93.5726 10.3314 93.596 10.2749C93.6194 10.2185 93.6537 10.1672 93.697 10.124C93.7403 10.0808 93.7916 10.0466 93.8481 10.0233C93.9046 9.99998 93.9652 9.98804 94.0263 9.98816H95.3676C95.4627 9.98765 95.5557 10.0165 95.6338 10.0707C95.7119 10.125 95.7714 10.202 95.8041 10.2913C95.8265 10.3505 95.8362 10.4129 95.8325 10.4762ZM98.2654 17.6735C99.8396 17.6735 100.593 16.3313 100.593 14.7082C100.593 13.085 99.8254 11.7775 98.2654 11.7775C96.7063 11.7775 95.8325 13.0815 95.8325 14.7082C95.8325 16.3348 96.6628 17.6735 98.2654 17.6735ZM106.657 10.4762V11.2086C106.988 10.7516 107.427 10.3835 107.935 10.1372C108.443 9.89092 109.004 9.77406 109.568 9.79705C112.145 9.79705 113.809 11.9224 113.809 14.7082C113.809 17.4939 112.145 19.6459 109.568 19.6459C109.002 19.6668 108.44 19.5472 107.933 19.2978C107.425 19.0483 106.987 18.6769 106.657 18.2166V22.0708C106.658 22.1319 106.646 22.1924 106.622 22.2489C106.599 22.3053 106.565 22.3566 106.522 22.3998C106.478 22.443 106.427 22.4772 106.371 22.5006C106.314 22.5239 106.254 22.5358 106.193 22.5357H104.851C104.79 22.5358 104.73 22.5239 104.673 22.5006C104.617 22.4773 104.565 22.443 104.522 22.3999C104.479 22.3567 104.444 22.3054 104.421 22.2489C104.397 22.1925 104.385 22.1319 104.385 22.0708V10.453C104.385 10.3919 104.397 10.3314 104.421 10.2749C104.444 10.2185 104.479 10.1672 104.522 10.124C104.565 10.0808 104.617 10.0466 104.673 10.0233C104.73 9.99998 104.79 9.98804 104.851 9.98816H106.193C106.256 9.98769 106.318 10.0002 106.377 10.0249C106.435 10.0496 106.487 10.086 106.531 10.1319C106.574 10.1777 106.608 10.232 106.63 10.2913C106.652 10.3507 106.661 10.413 106.657 10.4762ZM109.093 17.6735C110.667 17.6735 111.421 16.3313 111.421 14.7082C111.421 13.085 110.652 11.7775 109.093 11.7775C107.534 11.7775 106.657 13.0815 106.657 14.7082C106.657 16.3348 107.498 17.6735 109.093 17.6735Z",fill:"#EEEFFC"}),ee.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.72802 0.625488C3.5538 0.625488 0.980469 3.19438 0.980469 6.36238V19.7775C0.980469 22.9464 3.5538 25.5144 6.72802 25.5144H20.0347C23.208 25.5144 25.7814 22.9455 25.7814 19.7775V6.36238C25.7814 3.19349 23.2089 0.625488 20.0347 0.625488H6.72802ZM17.4107 9.88238C16.4633 9.08257 15.2639 8.64309 14.024 8.64149C13.0018 8.64149 11.9805 8.97927 11.9805 9.91704C11.9805 10.773 12.8907 11.1082 14.0107 11.5197L14.3422 11.6424C16.5582 12.389 18.3831 13.3037 18.3831 15.4717C18.3831 17.8264 16.552 19.4344 13.5565 19.6184L13.2854 20.8806C13.2603 20.995 13.1968 21.0973 13.1054 21.1704C13.0139 21.2435 12.9002 21.283 12.7831 21.2824H10.9005C10.8246 21.2803 10.75 21.2616 10.6821 21.2276C10.6142 21.1937 10.5545 21.1453 10.5072 21.0858C10.46 21.0264 10.4263 20.9573 10.4086 20.8835C10.3908 20.8096 10.3894 20.7328 10.4045 20.6584L10.696 19.3268C9.56553 19.0393 8.52597 18.4709 7.6738 17.6744C7.62509 17.6274 7.58635 17.571 7.55989 17.5087C7.53342 17.4464 7.51979 17.3794 7.51979 17.3117C7.51979 17.244 7.53342 17.177 7.55989 17.1147C7.58635 17.0524 7.62509 16.9961 7.6738 16.949L8.71914 15.9295C8.81423 15.836 8.94223 15.7836 9.07558 15.7836C9.20892 15.7836 9.33693 15.836 9.43202 15.9295C10.39 16.8414 11.6678 17.3407 12.9902 17.3197C14.3538 17.3197 15.2791 16.7419 15.2791 15.8273C15.2791 15.0006 14.5209 14.7233 13.0809 14.197C12.928 14.141 12.7671 14.0833 12.5991 14.0202C10.7485 13.3624 8.99647 12.4202 8.99647 10.2326C8.99647 7.69927 11.1165 6.46371 13.6151 6.34193L13.8782 5.0566C13.9037 4.94318 13.9671 4.84184 14.0579 4.76928C14.1487 4.69672 14.2616 4.65729 14.3778 4.65749H16.2542C16.3296 4.65732 16.4041 4.67392 16.4723 4.70608C16.5405 4.73824 16.6006 4.78516 16.6485 4.84343C16.6963 4.90171 16.7305 4.9699 16.7487 5.04305C16.767 5.11619 16.7687 5.19248 16.7538 5.26638L16.4622 6.70282C17.4174 7.01491 18.3026 7.51006 19.0685 8.1606C19.1207 8.20534 19.1631 8.26043 19.193 8.32238C19.2229 8.38433 19.2396 8.4518 19.2421 8.52053C19.2446 8.58927 19.2329 8.65778 19.2076 8.72174C19.1823 8.7857 19.144 8.84373 19.0951 8.89215L18.12 9.86816C18.0259 9.96048 17.9 10.0134 17.7682 10.016C17.6363 10.0187 17.5085 9.97086 17.4107 9.88238Z",fill:"#EEEFFC"})]}),ee.jsxs("svg",{width:"115",height:"31",viewBox:"0 0 115 31",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[ee.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7.82394 19.7796V22.8383L0.455078 15.5091L1.99337 13.9784L7.82394 19.7796ZM10.8987 22.8383H7.82394L15.1919 30.1676L16.7311 28.6369L10.8987 22.8383ZM28.3878 17.0398L29.9252 15.5091L15.1893 0.850586L13.6545 2.38484L19.4842 8.18338H15.9615L11.8914 4.14386L10.354 5.67456L12.884 8.19138H11.1156V19.569H22.5537V17.81L25.0846 20.3277L26.6238 18.797L22.5537 14.7495V11.2448L28.3878 17.0398ZM8.59086 7.42114L7.04902 8.95273L8.70017 10.5945L10.2385 9.06378L8.59175 7.42203L8.59086 7.42114ZM21.6774 20.4379L20.14 21.9686L21.7894 23.6103L23.3286 22.0796L21.6774 20.4379ZM5.29123 10.7029L3.75205 12.2336L7.82217 16.2811V13.2206L5.29123 10.7029ZM17.4971 22.8445H14.4223L18.4916 26.892L20.0298 25.3613L17.4971 22.8445Z",fill:"#EEEFFC"}),ee.jsx("path",{d:"M112.197 22.8207C111.205 22.8207 110.428 22.5533 109.875 22.0158C109.32 21.4784 109.043 20.7312 109.043 19.786V13.9226H107.263V11.7274H109.053L109.372 8.79566H111.468V11.7274H114.205V13.9261H111.468V19.467C111.462 19.7705 111.576 20.0641 111.784 20.2844C111.891 20.3972 112.021 20.4858 112.165 20.544C112.309 20.6023 112.464 20.6288 112.62 20.6219H114.205V22.8207H112.197ZM101.489 23.0277C100.166 23.0277 99.1021 22.7141 98.2961 22.086C97.4966 21.465 96.9477 20.5769 96.7498 19.5843H99.3812C99.4958 19.9654 99.7518 20.2888 100.096 20.4905C100.519 20.7336 101.002 20.8524 101.489 20.8334C102.892 20.8334 103.598 20.4425 103.598 19.6874C103.598 19.3116 103.377 19.0237 102.936 18.8256C102.423 18.607 101.886 18.4478 101.336 18.3512C100.7 18.2283 100.069 18.0741 99.4478 17.8893C98.8151 17.7038 98.2527 17.3324 97.834 16.8232C97.3959 16.3017 97.1755 15.6159 97.1737 14.7665C97.1675 14.3197 97.2646 13.8774 97.4576 13.4742C97.6506 13.0711 97.9343 12.718 98.2863 12.4425C99.0302 11.8251 100.062 11.5168 101.382 11.5186C102.7 11.5186 103.748 11.8118 104.525 12.3981C105.297 12.9773 105.828 13.8205 106.017 14.7665H103.381C103.1 14.0727 102.438 13.7182 101.389 13.7174C100.263 13.7174 99.7011 14.0665 99.7011 14.7657C99.7033 14.9263 99.7484 15.0835 99.8316 15.2209C99.9149 15.3584 100.033 15.4711 100.175 15.5474C100.536 15.7646 100.937 15.9071 101.354 15.9668C101.876 16.0556 102.392 16.1738 102.9 16.3221C103.427 16.4723 103.944 16.6562 104.447 16.8729C104.937 17.0931 105.351 17.452 105.639 17.9052C105.972 18.4365 106.139 19.0554 106.116 19.682C106.127 20.1485 106.026 20.6107 105.82 21.0297C105.615 21.4496 105.313 21.8145 104.938 22.094C104.154 22.7159 103.005 23.0268 101.489 23.0277ZM93.643 12.6282C92.8326 11.9024 91.6968 11.5399 90.2359 11.5399C89.0717 11.5399 88.095 11.8508 87.3059 12.4754C86.5284 13.0828 85.9788 13.9349 85.7463 14.8936H88.2337C88.3599 14.5311 88.6016 14.2184 88.9215 14.0043C89.3102 13.7452 89.7709 13.6158 90.2376 13.6347C90.9219 13.6347 91.4605 13.8106 91.855 14.1589C92.0549 14.344 92.2113 14.5711 92.3131 14.8237C92.415 15.0763 92.4598 15.3484 92.4442 15.6203V16.1498H89.5951C88.2852 16.1498 87.2561 16.4785 86.5079 17.1368C86.1513 17.4402 85.8664 17.8187 85.6735 18.2453C85.4807 18.6719 85.3847 19.1358 85.3926 19.6039C85.379 20.0667 85.4649 20.527 85.6444 20.9538C85.8239 21.3806 86.0929 21.764 86.4332 22.078C87.1255 22.7292 88.0426 23.0553 89.1846 23.0553C89.892 23.0714 90.5921 22.9095 91.2205 22.5844C91.7247 22.3393 92.1515 21.96 92.454 21.4881H92.5562L92.7632 22.8563H94.8676V15.6247C94.8632 14.3552 94.4553 13.3567 93.643 12.6282ZM92.4469 18.5538C92.4608 18.8831 92.4019 19.2115 92.2744 19.5156C92.1469 19.8196 91.954 20.0918 91.7093 20.3128C91.2214 20.7445 90.554 20.9613 89.7089 20.9613C89.0939 20.9613 88.6229 20.8209 88.2986 20.5473C88.1416 20.4201 88.0158 20.2587 87.9306 20.0755C87.8454 19.8923 87.8032 19.6921 87.8071 19.4901C87.8071 18.5129 88.4496 18.0278 89.7089 18.0278H92.4469V18.5538ZM79.0786 23.0517C77.4825 23.0517 76.2064 22.5418 75.2511 21.5237C74.2966 20.5038 73.8185 19.0939 73.8168 17.2931C73.8168 15.4968 74.2931 14.0878 75.2457 13.0679C76.1975 12.0481 77.4754 11.5381 79.0786 11.5399C80.3814 11.5399 81.4602 11.8846 82.3169 12.5758C83.1565 13.2413 83.7557 14.1628 84.0232 15.2001H81.6095C81.3714 14.7407 81.0069 14.359 80.559 14.0999C80.111 13.8408 79.5983 13.7152 79.0813 13.7378C78.6885 13.7241 78.2979 13.8008 77.9395 13.9619C77.5811 14.123 77.2646 14.3643 77.0142 14.6671C76.4899 15.2889 76.2277 16.164 76.2277 17.2931C76.2277 18.4232 76.4899 19.2991 77.0142 19.9201C77.2635 20.2243 77.5798 20.4668 77.9384 20.6286C78.297 20.7905 78.6881 20.8672 79.0813 20.8529C79.5984 20.8747 80.1109 20.7485 80.5588 20.4892C81.0066 20.2298 81.3712 19.8481 81.6095 19.3889H84.0232C83.7567 20.4273 83.1574 21.35 82.3169 22.0158C81.462 22.7061 80.3823 23.0517 79.0786 23.0517ZM64.8438 27.037L66.5279 22.8465L62.0063 11.7531H64.6368L67.6885 19.6039H67.7907L70.8468 11.7531H73.4773L67.3703 27.037H64.8438ZM59.7331 12.6282C58.9217 11.9024 57.786 11.5399 56.325 11.5399C55.1609 11.5399 54.1816 11.8508 53.396 12.4754C52.6177 13.0823 52.0677 13.9345 51.8355 14.8936H54.3238C54.4482 14.5302 54.6899 14.2184 55.0107 14.0043C55.3994 13.7446 55.8606 13.6152 56.3277 13.6347C57.0111 13.6347 57.5505 13.8098 57.9451 14.1589C58.1453 14.3438 58.3019 14.5708 58.4038 14.8235C58.5057 15.0762 58.5503 15.3483 58.5343 15.6203V16.1498H55.6843C54.3744 16.1498 53.3453 16.4785 52.598 17.1368C52.2408 17.4398 51.9554 17.8182 51.7624 18.2449C51.5694 18.6715 51.4735 19.1357 51.4818 19.6039C51.4676 20.0664 51.5528 20.5266 51.7317 20.9534C51.9106 21.3803 52.1791 21.7638 52.5189 22.078C53.2111 22.7292 54.1274 23.0553 55.2702 23.0553C55.9773 23.0714 56.6771 22.9095 57.3052 22.5844C57.8101 22.3396 58.2375 21.9602 58.5405 21.4881H58.6418L58.848 22.8563H60.9488V15.6247C60.9488 14.3552 60.5436 13.3567 59.7331 12.6282ZM58.5325 18.5538C58.5473 18.8833 58.4889 19.2119 58.3613 19.5161C58.2338 19.8203 58.0403 20.0924 57.7949 20.3128C57.3079 20.7454 56.6414 20.9613 55.7954 20.9613C55.1795 20.9613 54.7059 20.8227 54.3842 20.5473C54.2272 20.4201 54.1013 20.2588 54.0161 20.0756C53.931 19.8923 53.8888 19.6921 53.8928 19.4901C53.899 18.5165 54.5326 18.0296 55.7945 18.0278H58.5316L58.5325 18.5538ZM46.0822 17.294C46.4572 17.1945 46.8198 17.0524 47.1628 16.872C47.563 16.654 47.9374 16.3917 48.279 16.0903C48.6913 15.7129 49.0096 15.2444 49.2086 14.7221C49.4476 14.1091 49.5649 13.4562 49.5551 12.7988C49.5551 11.404 49.1081 10.2846 48.2124 9.44508C47.3157 8.60466 46.1506 8.18534 44.7146 8.188H38.6094V22.8465H41.2398V17.4077H43.2367L47.0286 22.8465H49.9764L46.0822 17.294ZM41.2398 15.089V10.496H44.5004C45.2469 10.496 45.8361 10.6977 46.2688 11.1002C46.7007 11.5026 46.9176 12.0667 46.9211 12.7925C46.9211 13.5184 46.7025 14.0843 46.2644 14.4894C45.7824 14.9062 45.1582 15.121 44.5217 15.089H41.2398Z",fill:"#EEEFFC"})]}),ee.jsx("svg",{width:"128",height:"24",viewBox:"0 0 128 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:ee.jsx("path",{d:"M15.8514 19.5458C15.9553 18.9344 15.9009 18.3066 15.6933 17.7222C15.4858 17.1378 15.1321 16.6163 14.6659 16.2072C13.978 15.5768 13.0788 15.2269 12.1456 15.2264C11.5955 15.2264 11.0659 15.102 10.5789 14.8506C9.94898 14.5149 9.43328 13.9994 9.09748 13.3697C9.28765 12.8899 9.37296 12.3676 9.37296 11.8043C9.37296 13.3279 10.6002 14.5583 12.1252 14.5583H12.1883C12.9112 14.5467 13.6005 14.2514 14.1076 13.7362C14.6147 13.2209 14.8988 12.5271 14.8987 11.8043C14.8987 11.2624 15.0045 10.74 15.1742 10.2399C15.5064 9.37011 16.1049 8.62748 16.8843 8.11792C17.6638 7.60837 18.5843 7.35793 19.5145 7.40233C18.7889 6.18281 17.7698 5.16401 16.5499 4.43865V4.64742C16.5466 5.60336 16.235 6.53275 15.6612 7.2975C15.4912 7.15336 15.3065 7.02741 15.1102 6.92171C15.6185 6.27496 15.8727 5.48251 15.8727 4.66874C15.8727 4.18901 15.7874 3.70928 15.5972 3.24909C15.321 2.57844 14.8558 2.0025 14.2581 1.59131C13.6605 1.18013 12.9562 0.951438 12.2309 0.933053H12.0194C11.0872 0.933053 10.1772 1.05832 9.28765 1.30884C7.44536 1.80227 5.76532 2.77151 4.41621 4.11926C3.0671 5.46701 2.09639 7.14585 1.60153 8.98722C0.967021 9.76012 0.585781 10.6983 0.564453 11.7004C0.628437 5.41944 5.70986 0.328945 12.0194 0.265869H12.3154C18.5823 0.369811 23.6433 5.41944 23.7063 11.6995V11.9509C23.6867 12.9483 23.3199 13.9077 22.6693 14.6641C22.0693 15.3833 21.2519 15.8883 20.3401 16.1032C20.0006 16.186 19.6524 16.228 19.303 16.2285C18.3496 16.2265 17.4219 15.9195 16.6556 15.3526C16.3801 15.7283 16.0424 16.0411 15.6816 16.3333C16.3012 17.1531 16.6089 18.1664 16.5499 19.1922C17.7698 18.4668 18.7889 17.448 19.5145 16.2285C19.79 16.2081 20.0655 16.1654 20.3401 16.1032C19.5566 17.5972 18.3787 18.8489 16.9342 19.7207C15.4897 20.5924 13.8338 21.0518 12.1465 21.0489C11.4889 21.0489 10.8757 20.7362 10.4945 20.2352C10.2207 19.8671 10.0724 19.4208 10.0715 18.9621C10.0715 18.3367 10.3674 17.7521 10.8126 17.3763C11.2356 17.4811 11.7013 17.5433 12.1669 17.5433C11.7858 17.5457 11.421 17.698 11.1515 17.9674C10.8821 18.2368 10.7296 18.6016 10.7273 18.9825C10.7273 19.7759 11.3627 20.4226 12.1669 20.4226H12.1883C12.5694 20.4203 12.9342 20.2679 13.2037 19.9985C13.4732 19.7291 13.6256 19.3644 13.6279 18.9834C13.6279 18.1901 12.9925 17.5433 12.1883 17.5433C11.1356 17.541 10.1034 17.2523 9.20234 16.7082C9.01216 16.5839 8.82199 16.4586 8.65225 16.3333C8.28498 16.0445 7.95114 15.7155 7.65694 15.3526C7.82668 15.2273 7.99641 15.0816 8.16526 14.9146C8.63777 15.5324 9.24672 16.0328 9.94456 16.3766C10.6424 16.7204 11.4103 16.8984 12.1883 16.8966C12.7422 16.8984 13.273 17.1186 13.6655 17.5093C14.0579 17.9 14.2804 18.4297 14.2847 18.9834C14.2847 19.4418 14.1362 19.8807 13.8608 20.2556C14.5601 20.1099 15.2373 19.9011 15.8727 19.5884L15.8514 19.5458ZM20.5729 10.1555C20.4434 9.45243 20.2154 8.77115 19.8957 8.1317C19.3959 8.05166 18.8851 8.07326 18.3939 8.19523C17.9027 8.3172 17.4411 8.53702 17.0369 8.84153C16.5769 9.19151 16.2039 9.64283 15.9468 10.1604C15.6897 10.6779 15.5555 11.2478 15.5546 11.8256C15.5546 12.3889 15.4275 12.9095 15.1742 13.3901C14.8465 14.019 14.3375 14.5352 13.7132 14.8719C14.2847 15.0807 14.793 15.4139 15.2373 15.8314C15.7648 15.4311 16.2043 14.9267 16.5285 14.3496C16.9729 13.5775 17.2066 12.7229 17.2066 11.8256C17.2066 11.3033 17.3968 10.8449 17.7149 10.4691C18.0634 10.0652 18.552 9.80839 19.0823 9.75036C19.6127 9.69233 20.1453 9.83652 20.5729 10.1555ZM20.7213 11.7634C20.7 11.0119 20.0646 10.4069 19.2817 10.3856C18.9026 10.3832 18.5382 10.5313 18.2683 10.7972C17.9984 11.0632 17.8451 11.4254 17.842 11.8043V11.8461C17.8624 12.619 18.4978 13.2231 19.2817 13.2231C19.6607 13.2254 20.0251 13.0774 20.295 12.8114C20.5649 12.5454 20.7182 12.1832 20.7213 11.8043V11.7634ZM17.7149 13.1813C17.5665 13.7446 17.355 14.3087 17.0369 14.8089C17.4387 15.1179 17.9001 15.3404 18.3921 15.4626C18.884 15.5848 19.396 15.6039 19.8957 15.5187C20.1712 15.4769 20.4458 15.3934 20.7213 15.2886C21.3931 15.0145 21.9708 14.5512 22.3841 13.9551C22.7975 13.3589 23.0287 12.6555 23.0496 11.9305V11.7421C23.0496 10.8235 22.9234 9.90582 22.6693 9.00854C21.674 5.29506 18.7307 2.3527 15.0045 1.33016C15.7138 1.93354 16.2171 2.7432 16.4441 3.6462V3.66664C18.3823 4.68407 19.8975 6.35463 20.7213 8.38223C21.1656 9.44652 21.3985 10.6148 21.3985 11.847C21.3985 12.5133 21.0812 13.1191 20.5729 13.4949C20.2079 13.7746 19.7619 13.9283 19.3021 13.9329C19.0002 13.9229 18.7035 13.8511 18.4305 13.7218C18.1575 13.5925 17.9139 13.4085 17.7149 13.1813ZM11.9768 23.3641C5.70986 23.2593 0.648877 18.1892 0.585781 11.9305V11.6791C0.605681 10.682 0.972382 9.72293 1.62286 8.96679C2.22875 8.25437 3.04371 7.75081 3.95207 7.52759C4.29065 7.44319 4.65056 7.40144 4.99004 7.40144C5.94269 7.40144 6.87402 7.71504 7.6365 8.27828C7.91199 7.90249 8.24968 7.58978 8.61049 7.2975C7.99388 6.47519 7.67971 5.46552 7.72092 4.43865C6.50115 5.16379 5.48205 6.18226 4.75632 7.40144C4.48083 7.42276 4.20623 7.46363 3.93074 7.5267C4.71415 6.03274 5.89209 4.78194 7.3366 3.91018C8.78112 3.03842 10.437 2.57903 12.1243 2.58191C12.7819 2.58191 13.3951 2.89462 13.7763 3.39568C14.0518 3.75103 14.2002 4.18812 14.2002 4.66874C14.2001 4.97114 14.1336 5.26983 14.0056 5.5438C13.8775 5.81777 13.691 6.06037 13.4591 6.25452C13.0147 6.14969 12.5695 6.08751 12.1039 6.08751C12.485 6.08518 12.8498 5.9328 13.1193 5.6634C13.3887 5.394 13.5412 5.02929 13.5435 4.64831C13.5435 3.85498 12.9081 3.20734 12.1039 3.20734H12.0825C11.7013 3.20967 11.3363 3.36217 11.0668 3.63176C10.7973 3.90135 10.645 4.26629 10.6429 4.64742C10.6429 5.44076 11.2783 6.08662 12.0825 6.08662C13.1409 6.08662 14.1576 6.37979 15.0685 6.92171C15.2586 7.04697 15.4488 7.17224 15.6185 7.2975C15.9785 7.58978 16.317 7.92381 16.6139 8.27828C16.4441 8.40266 16.2744 8.54924 16.1055 8.71626C15.633 8.0984 15.0241 7.59804 14.3262 7.25423C13.6284 6.91043 12.8605 6.73247 12.0825 6.73426C11.5868 6.72704 11.1085 6.5502 10.7273 6.2332C10.4968 6.03787 10.3112 5.79503 10.1833 5.52133C10.0554 5.24763 9.98811 4.94952 9.98615 4.64742C9.98615 4.16769 10.155 3.72971 10.41 3.37436C9.71155 3.52094 9.01216 3.75015 8.37765 4.04243C8.27377 4.6538 8.32817 5.28158 8.53569 5.86598C8.7432 6.45038 9.09691 6.97195 9.56314 7.38101C10.2508 8.0112 11.1496 8.36111 12.0825 8.36179C12.6335 8.36179 13.1623 8.48617 13.6493 8.73758C14.2795 9.07314 14.7955 9.58869 15.1316 10.2185C14.9344 10.7162 14.8406 11.2488 14.8561 11.7839C14.8561 10.2603 13.6279 9.02986 12.1039 9.02986H12.0825C11.3596 9.04152 10.6703 9.33681 10.1632 9.85204C9.65612 10.3673 9.37198 11.0611 9.37208 11.7839C9.37208 12.3258 9.26632 12.8482 9.09659 13.3483C8.76426 14.218 8.16572 14.9606 7.38633 15.4701C6.60695 15.9796 5.68652 16.2301 4.75632 16.1859C5.48205 17.405 6.50115 18.4235 7.72092 19.1487C7.6723 18.1308 7.97923 17.1276 8.58916 16.3111C8.758 16.4577 8.94907 16.583 9.14013 16.6869C8.63978 17.3312 8.37117 18.1252 8.37765 18.9408C8.37765 19.4205 8.46208 19.9002 8.65314 20.3595C8.92936 21.0302 9.39459 21.6061 9.99223 22.0173C10.5899 22.4285 11.2942 22.6572 12.0194 22.6756H12.2096C13.1409 22.6756 14.0518 22.5503 14.9405 22.2998C16.783 21.8066 18.4633 20.8374 19.8125 19.4897C21.1618 18.1419 22.1326 16.4629 22.6275 14.6214C23.262 13.8485 23.6433 12.9104 23.6637 11.9091C23.6006 18.1901 18.5183 23.2806 12.2096 23.3428H11.9554C12.0194 23.3641 11.9768 23.3641 11.9768 23.3641ZM9.28765 22.3202C8.57834 21.7168 8.07507 20.9072 7.848 20.0042V19.9837C5.90984 18.9663 4.39459 17.2958 3.57083 15.2682C3.12519 14.1676 2.8953 12.9916 2.89366 11.8043C2.89366 11.1371 3.21092 10.5312 3.71924 10.1563C4.08238 9.87312 4.52945 9.71872 4.99004 9.71748C5.62455 9.71748 6.19685 10.0107 6.5772 10.4486C6.72561 9.86407 6.93712 9.32126 7.25526 8.82109C6.85351 8.51198 6.39214 8.28927 5.90016 8.16696C5.40817 8.04465 4.8962 8.02539 4.3964 8.11038C3.53463 8.24747 2.74781 8.68111 2.17181 9.3364C1.59581 9.9917 1.26681 10.8275 1.24162 11.6995V11.9091C1.24162 12.8269 1.3687 13.7446 1.62375 14.6418C2.6395 18.3766 5.56056 21.319 9.28765 22.3202ZM4.3964 15.5187C4.89619 15.5988 5.407 15.5772 5.89824 15.4552C6.38948 15.3333 6.85104 15.1134 7.25526 14.8089C7.71509 14.459 8.08803 14.0078 8.34511 13.4904C8.60219 12.973 8.73649 12.4033 8.73757 11.8256C8.73757 11.2624 8.86465 10.74 9.11792 10.2603C9.44567 9.63137 9.95459 9.11518 10.5789 8.77845H10.5585C9.99028 8.56538 9.47143 8.23893 9.03349 7.81899C8.5061 8.21931 8.0666 8.72368 7.74225 9.30083C7.29712 10.0678 7.06317 10.9389 7.0642 11.8256C7.0642 12.3471 6.87402 12.8064 6.55676 13.1813C6.35968 13.4095 6.11594 13.5927 5.84199 13.7187C5.56804 13.8447 5.27025 13.9104 4.96871 13.9116C4.50824 13.9105 4.0612 13.7565 3.69791 13.4736C3.86676 14.1834 4.10048 14.8719 4.3964 15.5187ZM3.57083 11.8878C3.61348 12.6394 4.22756 13.2648 5.01048 13.2648C5.38948 13.2672 5.75394 13.1191 6.02385 12.8531C6.29376 12.5871 6.44707 12.225 6.45012 11.8461V11.8043C6.43806 11.4321 6.28056 11.0795 6.01142 10.8221C5.74228 10.5647 5.38294 10.4229 5.01048 10.4273C4.20623 10.4273 3.57083 11.0741 3.57083 11.8665V11.8878ZM33.001 5.77391H36.1771L39.1417 13.7446H39.1843L42.1054 5.77391H45.2815V16.9996H43.2704V7.986H43.2491L39.7975 16.9996H38.3792L34.9703 7.986H34.9489V16.9996H33.0223L33.001 5.77391ZM50.8286 5.77391H58.3663V7.5267H52.8628V10.3856H58.0926V12.0548H52.8405V15.2264H58.6427V16.9996H50.8091L50.8286 5.77391ZM67.3437 10.6156C67.6405 10.6156 67.916 10.5943 68.2119 10.5526C68.4874 10.5108 68.7415 10.4273 68.9957 10.3234C69.2285 10.1981 69.4187 10.0302 69.5671 9.82231C69.7155 9.61354 69.8 9.32126 69.8 8.98722C69.8 8.67451 69.7369 8.42398 69.5885 8.23653C69.44 8.04819 69.2703 7.88117 69.0588 7.77723C68.8313 7.6481 68.5784 7.5699 68.3176 7.54803C68.0517 7.50578 67.7827 7.48498 67.5134 7.48584H65.6712V10.6361C65.6925 10.6148 67.3437 10.6156 67.3437 10.6156ZM63.6601 5.77391H67.6192C68.1488 5.77391 68.6776 5.83609 69.1859 5.94092C69.6591 6.04317 70.1108 6.22716 70.5207 6.48462C70.9019 6.73515 71.2405 7.08962 71.452 7.48584C71.6857 7.90338 71.8119 8.40444 71.8119 8.98811C71.8119 9.80188 71.5791 10.4699 71.1134 10.971C70.6478 11.4925 70.0123 11.8265 69.2081 12.014L72.2358 16.9801H69.8008L67.1757 12.2227H65.6934V16.9801H63.6601V5.77391ZM85.0229 8.40355C84.7292 8.00354 84.3244 7.69863 83.8587 7.5267C83.4088 7.34277 82.9265 7.25064 82.4404 7.25574C81.8895 7.25574 81.3394 7.35969 80.831 7.56846C80.3618 7.77723 79.9374 8.07501 79.5816 8.4453C79.2246 8.81443 78.9504 9.2554 78.7773 9.7388C78.5871 10.2603 78.4805 10.8031 78.5018 11.345C78.5018 11.95 78.5871 12.5141 78.7773 13.0152C78.9675 13.5154 79.2216 13.9533 79.5611 14.33C79.8997 14.6836 80.3014 14.9759 80.7679 15.1846C81.2336 15.3934 81.7624 15.4769 82.3551 15.4769C82.9692 15.4769 83.4988 15.3517 83.9858 15.1216C84.4302 14.8924 84.8327 14.5797 85.1295 14.1834L86.7594 15.3099C86.2691 15.9298 85.6374 16.4234 84.9171 16.7491C84.1973 17.0831 83.3291 17.2715 82.3551 17.2715C81.4664 17.2715 80.6409 17.1249 79.8997 16.8326C79.1835 16.5612 78.5285 16.1499 77.9731 15.6226C77.4273 15.0929 77.0013 14.4525 76.7236 13.7446C76.4268 13.0143 76.2793 12.2219 76.2793 11.3459C76.2793 10.4486 76.4268 9.63397 76.7449 8.9046C77.0384 8.20686 77.4788 7.58054 78.0362 7.06829C78.5992 6.55019 79.262 6.15236 79.9841 5.89917C81.1292 5.48433 82.3631 5.37651 83.5628 5.58645C83.9645 5.64864 84.3457 5.75347 84.7056 5.89917C85.0656 6.04575 85.4041 6.21277 85.7436 6.42065C86.0609 6.62943 86.3364 6.87995 86.5692 7.17224C86.5692 7.21399 85.0229 8.40355 85.0229 8.40355ZM100.098 12.8686C100.104 13.4987 99.9812 14.1234 99.7384 14.7049C99.5233 15.2323 99.1901 15.7034 98.7644 16.0819C98.3414 16.4577 97.8544 16.7704 97.3248 16.9579C96.7404 17.1666 96.1244 17.2727 95.5039 17.2715C94.8835 17.2708 94.2678 17.1648 93.683 16.9579C93.145 16.7609 92.6492 16.4636 92.222 16.0819C91.8078 15.6933 91.4765 15.2249 91.248 14.7049C91.0152 14.163 90.9095 13.5571 90.9095 12.8686V5.77391H92.9418V12.7851C92.9418 13.1191 92.9845 13.4319 93.0689 13.7659C93.1536 14.0757 93.2976 14.3663 93.4928 14.6214C93.683 14.8719 93.9585 15.0807 94.2757 15.2468C94.5939 15.4139 95.0169 15.4769 95.4826 15.4769C95.9696 15.4769 96.3721 15.3934 96.6894 15.2468C97.0075 15.1011 97.2617 14.8924 97.4732 14.6214C97.6634 14.3709 97.8118 14.0795 97.8962 13.7659C97.9815 13.4532 98.0233 13.1191 98.0233 12.7851V5.77391H100.057C100.098 5.77391 100.098 12.8686 100.098 12.8686ZM109.224 10.6148C109.52 10.6148 109.796 10.5943 110.092 10.5526C110.388 10.5108 110.642 10.4273 110.875 10.3234C111.108 10.1981 111.299 10.0302 111.448 9.82231C111.595 9.61354 111.68 9.32126 111.68 8.98722C111.68 8.67451 111.616 8.42398 111.468 8.23653C111.333 8.04118 111.152 7.88315 110.939 7.77723C110.712 7.64808 110.459 7.56987 110.198 7.54803C109.932 7.50578 109.663 7.48499 109.394 7.48584H107.552V10.6361C107.573 10.6148 109.224 10.6148 109.224 10.6148ZM105.54 5.77391H109.5C110.028 5.77391 110.558 5.83609 111.066 5.94092C111.539 6.04304 111.99 6.22672 112.4 6.48373C112.781 6.73426 113.099 7.06829 113.332 7.48495C113.564 7.90249 113.691 8.40355 113.691 8.98722C113.691 9.80099 113.459 10.4691 112.993 10.9701C112.527 11.4916 111.892 11.8256 111.088 12.0131L114.115 16.9792H111.68L109.054 12.2219H107.573V16.9792H105.54V5.77391ZM121.335 12.1384L117.058 5.79523H119.535L122.393 10.5108L125.294 5.79523H127.644L123.367 12.1384V16.9996H121.335V12.1384Z",fill:"#EEEFFC"})}),ee.jsx("svg",{width:"100",height:"22",viewBox:"0 0 100 22",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:ee.jsx("path",{d:"M0.214844 2.10876C0.214844 1.8521 0.265413 1.59795 0.363665 1.36082C0.461917 1.12369 0.605925 0.908235 0.787471 0.726746C0.969017 0.545258 1.18454 0.401293 1.42175 0.303072C1.65895 0.204851 1.91318 0.154297 2.16992 0.154297H9.8125C10.0692 0.154297 10.3235 0.204851 10.5607 0.303072C10.7979 0.401293 11.0134 0.545258 11.1949 0.726746C11.3765 0.908235 11.5205 1.12369 11.6188 1.36082C11.717 1.59795 11.7676 1.8521 11.7676 2.10876V3.61903C11.7676 3.87821 11.6646 4.12677 11.4813 4.31004C11.2979 4.4933 11.0493 4.59626 10.79 4.59626H1.19238C1.06401 4.59626 0.936894 4.57098 0.818293 4.52187C0.699693 4.47276 0.59193 4.40078 0.501157 4.31004C0.410385 4.21929 0.33838 4.11156 0.289255 3.993C0.240129 3.87444 0.214844 3.74736 0.214844 3.61903V2.10876ZM0.214844 8.23867C0.214844 8.11034 0.240129 7.98327 0.289255 7.8647C0.33838 7.74614 0.410385 7.63841 0.501157 7.54766C0.59193 7.45692 0.699693 7.38494 0.818293 7.33583C0.936894 7.28672 1.06401 7.26144 1.19238 7.26144H19.5879C20.1064 7.26144 20.6037 7.46736 20.9703 7.83389C21.337 8.20042 21.543 8.69755 21.543 9.21591V14.2797C21.543 14.4081 21.5177 14.5352 21.4685 14.6537C21.4194 14.7723 21.3474 14.88 21.2566 14.9708C21.1659 15.0615 21.0581 15.1335 20.9395 15.1826C20.8209 15.2317 20.6938 15.257 20.5654 15.257H2.16992C1.91318 15.257 1.65895 15.2064 1.42175 15.1082C1.18454 15.01 0.969017 14.866 0.787471 14.6845C0.605925 14.503 0.461917 14.2876 0.363665 14.0505C0.265413 13.8133 0.214844 13.5592 0.214844 13.3025V8.23867ZM9.99023 18.8994C9.99023 18.6402 10.0932 18.3916 10.2765 18.2084C10.4599 18.0251 10.7085 17.9222 10.9678 17.9222H20.5654C20.8247 17.9222 21.0733 18.0251 21.2566 18.2084C21.44 18.3916 21.543 18.6402 21.543 18.8994V19.5213C21.543 19.7779 21.4924 20.0321 21.3941 20.2692C21.2959 20.5063 21.1519 20.7218 20.9703 20.9033C20.7888 21.0848 20.5733 21.2287 20.3361 21.327C20.0989 21.4252 19.8446 21.4757 19.5879 21.4757H11.9453C11.6886 21.4757 11.4343 21.4252 11.1971 21.327C10.9599 21.2287 10.7444 21.0848 10.5629 20.9033C10.3813 20.7218 10.2373 20.5063 10.1391 20.2692C10.0408 20.0321 9.99023 19.7779 9.99023 19.5213V18.8994ZM33.6253 13.2501H35.6791L39.4941 19.4839H44.165L39.9349 12.8103C42.2819 12.0028 43.6513 10.194 43.6513 7.57771C43.6513 3.91131 41.0831 1.93108 36.9507 1.93108H29.541V19.4839H33.6253V13.2501ZM33.6253 9.92573V5.37805H36.7304C38.6623 5.37805 39.6408 6.20958 39.6408 7.65233C39.6408 9.06932 38.6632 9.92484 36.7304 9.92484H33.6253V9.92573ZM51.1917 19.7522C53.76 19.7522 56.1069 18.457 57.0614 15.9881L53.784 14.9372C53.4169 16.0619 52.4634 16.6482 51.2406 16.6482C49.7494 16.6482 48.6972 15.6461 48.4288 13.8853H57.1591V12.8592C57.1591 9.21679 55.0308 6.33129 51.1188 6.33129C47.4015 6.33129 44.6626 9.2159 44.6626 13.0298C44.6626 17.0391 47.3038 19.7522 51.1917 19.7522ZM51.0691 9.36338C52.5123 9.36338 53.2703 10.3406 53.2952 11.4902H48.5497C48.9407 10.0723 49.8711 9.36338 51.0691 9.36338ZM59.3764 16.037C59.3764 18.6773 60.7707 19.6065 63.5585 19.6065C64.488 19.6065 65.2212 19.5328 65.9063 19.4351V16.2324C65.4655 16.2813 65.246 16.3062 64.7813 16.3062C63.8028 16.3062 63.2403 16.1107 63.2403 15.0349V9.82712H65.7588V6.60048H63.2403V3.03091H59.3764V6.60048H57.7377V9.82712H59.3764V16.037ZM79.9038 13.0538C79.9038 9.04533 77.2378 6.33129 73.4476 6.33129C69.6325 6.33129 66.9914 9.04533 66.9914 13.0547C66.9914 17.064 69.6325 19.7531 73.4476 19.7531C77.2378 19.7531 79.9038 17.0631 79.9038 13.0538ZM70.8802 13.0538C70.8802 10.8061 71.8826 9.53395 73.4476 9.53395C75.0125 9.53395 76.0159 10.8052 76.0159 13.0547C76.0159 15.3041 75.0125 16.5745 73.4476 16.5745C71.8826 16.5745 70.8802 15.3032 70.8802 13.0538ZM93.9937 13.0538C93.9937 9.04533 91.3285 6.33129 87.5375 6.33129C83.7224 6.33129 81.0813 9.04533 81.0813 13.0547C81.0813 17.064 83.7224 19.7531 87.5375 19.7531C91.3285 19.7531 93.9937 17.0631 93.9937 13.0538ZM84.9701 13.0538C84.9701 10.8061 85.9725 9.53395 87.5375 9.53395C89.1033 9.53395 90.1057 10.8052 90.1057 13.0547C90.1057 15.3041 89.1033 16.5745 87.5375 16.5745C85.9725 16.5745 84.9701 15.3032 84.9701 13.0538ZM99.746 1.93108H95.8332V19.4839H99.746V1.93108Z",fill:"#EEEFFC"})}),ee.jsx("svg",{width:"104",height:"22",viewBox:"0 0 104 22",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:ee.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M9.73389 3.95937C9.31078 1.45626 7.01922 -0.218403 4.62633 0.224264C2.85922 0.551375 1.52589 1.94338 1.11877 3.65538L1.11611 3.66693C1.10099 3.72915 1.08766 3.79315 1.07522 3.85626L1.07077 3.87849C1.05922 3.94071 1.04855 4.00293 1.03966 4.06515L1.03611 4.08915C1.02591 4.15917 1.01732 4.22941 1.01033 4.29982L1.00855 4.31404C0.995184 4.44844 0.988362 4.58342 0.988108 4.71849L0.986328 4.77804L0.988108 4.83048L0.989885 4.91049C0.996996 5.12826 1.01744 5.34693 1.05478 5.56737C1.29655 6.99582 2.59966 7.94782 3.965 7.69538C4.44405 7.60598 4.88581 7.37644 5.23433 7.03582C5.37299 6.90186 5.54831 6.8121 5.73805 6.77791C5.9278 6.74373 6.12342 6.76667 6.30011 6.84382C6.74024 7.03609 7.22795 7.09183 7.70011 7.00382C9.01033 6.76026 9.90188 5.49449 9.757 4.13004C9.75132 4.07294 9.74302 4.01603 9.73389 3.95937ZM20.2921 0.81893C15.4583 0.81893 12.4557 2.52648 12.4557 5.27493C12.4557 8.47937 15.5312 12.8527 20.2921 12.8527C24.9792 12.8527 28.1294 8.4296 28.1294 5.27493C28.1294 2.48471 25.1997 0.81893 20.2921 0.81893ZM39.5917 4.56649C39.5917 4.54515 39.5899 4.52471 39.589 4.50337C39.5855 4.44018 39.5808 4.37705 39.5748 4.31404L39.573 4.29982C39.5662 4.22943 39.5579 4.15919 39.5481 4.08915L39.5437 4.06515C39.5243 3.93138 39.499 3.79851 39.4681 3.66693L39.4654 3.65626C39.0566 1.94337 37.7232 0.551375 35.9579 0.224264C33.565 -0.219292 31.2734 1.45626 30.8494 3.95937C30.8406 4.01626 30.8317 4.07315 30.8263 4.13004C30.6814 5.49538 31.573 6.76115 32.8841 7.00293C33.3739 7.09449 33.8557 7.0296 34.2841 6.84293C34.4608 6.76565 34.6566 6.74273 34.8464 6.77708C35.0362 6.81143 35.2115 6.9015 35.3499 7.03582C35.6912 7.36737 36.125 7.60471 36.6183 7.69538C37.9837 7.94782 39.2868 6.99582 39.5286 5.56737C39.5659 5.34693 39.5872 5.12826 39.5934 4.91138L39.5961 4.83048V4.77804V4.71849C39.5952 4.66782 39.5943 4.61626 39.5917 4.56649ZM27.2406 15.3798C25.9721 14.8092 24.2654 15.7843 22.8246 16.0198C21.9757 16.1656 21.1348 16.242 20.2921 16.25C19.4432 16.241 18.5964 16.1643 17.7597 16.0207C16.3188 15.7843 14.613 14.8092 13.3437 15.3807C12.7001 15.6723 12.5019 16.3843 12.7632 17.234C12.9536 17.822 13.2861 18.3538 13.7312 18.7825C14.6468 19.6847 15.8201 20.3674 16.8992 20.7994C17.9979 21.242 19.1437 21.4785 20.2921 21.4865C21.4565 21.4733 22.608 21.2401 23.6859 20.7994C24.765 20.3683 25.9374 19.6838 26.8539 18.7825C27.2988 18.3537 27.6313 17.8219 27.8219 17.234C28.0832 16.3843 27.8841 15.6714 27.2406 15.3798ZM98.0183 5.90693C96.1152 5.90693 94.6441 6.59937 93.5766 8.18515V6.80826C93.5761 6.65337 93.5143 6.50496 93.4047 6.39552C93.2951 6.28607 93.1466 6.2245 92.9917 6.22426H89.2005C89.0457 6.22473 88.8974 6.28638 88.7878 6.39578C88.6782 6.50517 88.6164 6.65344 88.6157 6.80826V20.5807C88.6164 20.7355 88.6782 20.8838 88.7878 20.9932C88.8974 21.1026 89.0457 21.1642 89.2005 21.1647H92.9917C93.0685 21.1649 93.1446 21.15 93.2156 21.1208C93.2866 21.0915 93.3511 21.0485 93.4054 20.9942C93.4598 20.94 93.5029 20.8755 93.5323 20.8045C93.5616 20.7336 93.5767 20.6575 93.5766 20.5807V13.0892C93.5766 11.3869 94.1819 9.88737 95.9703 9.88737C97.7872 9.88737 98.3357 11.6474 98.3357 13.0892V20.5798C98.3359 20.7349 98.3976 20.8835 98.5072 20.9931C98.6169 21.1028 98.7655 21.1645 98.9205 21.1647H102.713C102.867 21.1645 103.016 21.1029 103.126 20.9935C103.235 20.884 103.297 20.7356 103.297 20.5807V12.8003C103.297 9.54071 102.374 5.90693 98.0183 5.90693ZM68.6539 17.562L67.8708 17.5603C67.2494 17.5389 66.9757 17.0669 66.9757 16.4287V16.138H66.9774V1.18871C66.9774 1.03359 66.9158 0.884818 66.8061 0.77513C66.6964 0.665442 66.5477 0.603819 66.3926 0.603819H62.7019C62.5468 0.604054 62.3982 0.665752 62.2886 0.775389C62.1789 0.885026 62.1172 1.03366 62.117 1.18871V16.1727C62.117 20.4625 64.8726 21.4572 67.4583 21.4572C67.8139 21.4572 68.1552 21.434 68.7001 21.3887C68.8465 21.3767 68.9829 21.31 69.0824 21.202C69.1819 21.0939 69.237 20.9524 69.237 20.8056V18.1469C69.2371 18.0702 69.2221 17.9943 69.1929 17.9234C69.1636 17.8525 69.1207 17.788 69.0666 17.7337C69.0124 17.6794 68.9481 17.6363 68.8773 17.6068C68.8065 17.5774 68.7306 17.5622 68.6539 17.562ZM78.0957 17.5887C75.9899 17.5887 74.6912 15.858 74.6912 13.666C74.6912 11.5594 75.9321 9.8296 78.0379 9.8296C80.1428 9.8296 81.5561 11.4163 81.5561 13.81C81.5561 16.1745 80.0565 17.5878 78.0957 17.5878V17.5887ZM85.8174 6.22426H82.0254C81.91 6.22464 81.7972 6.25909 81.7012 6.32329C81.6052 6.38748 81.5303 6.47858 81.4859 6.58515C81.4566 6.6559 81.4415 6.7317 81.4414 6.80826V8.21449C80.5179 6.83049 78.8459 5.90693 76.8841 5.90693C72.501 5.90693 69.7028 9.33982 69.7028 13.666C69.7028 18.0785 72.6148 21.482 76.9134 21.482C79.0183 21.482 80.4894 20.5878 81.4406 19.1176V20.5798C81.4408 20.7349 81.5025 20.8835 81.6121 20.9931C81.7218 21.1028 81.8704 21.1645 82.0254 21.1647H85.8174C85.8942 21.1649 85.9703 21.15 86.0413 21.1208C86.1124 21.0915 86.1769 21.0485 86.2312 20.9942C86.2856 20.94 86.3287 20.8755 86.358 20.8045C86.3874 20.7336 86.4025 20.6575 86.4023 20.5807V6.80826C86.4026 6.73143 86.3876 6.65531 86.3583 6.58429C86.3289 6.51327 86.2859 6.44876 86.2315 6.39447C86.1771 6.34019 86.1125 6.2972 86.0415 6.26798C85.9704 6.23877 85.8943 6.22391 85.8174 6.22426ZM51.5952 17.5887C49.4903 17.5887 48.1917 15.858 48.1917 13.666C48.1917 11.5594 49.4326 9.8296 51.5383 9.8296C53.6432 9.8296 55.0566 11.4163 55.0566 13.81C55.0566 16.1745 53.557 17.5878 51.5952 17.5878V17.5887ZM59.3179 6.22426H55.5259C55.4491 6.22403 55.373 6.23897 55.302 6.26822C55.231 6.29748 55.1665 6.34047 55.1121 6.39474C55.0578 6.449 55.0147 6.51347 54.9853 6.58443C54.9559 6.6554 54.9409 6.73146 54.941 6.80826V8.21449C54.0183 6.83049 52.3454 5.90693 50.3845 5.90693C46.0005 5.90693 43.2023 9.33982 43.2023 13.666C43.2023 18.0785 46.1152 21.482 50.413 21.482C52.5188 21.482 53.9899 20.5878 54.941 19.1176V20.5798C54.9409 20.6566 54.9559 20.7326 54.9852 20.8036C55.0145 20.8745 55.0575 20.939 55.1117 20.9933C55.166 21.0477 55.2304 21.0908 55.3013 21.1202C55.3722 21.1496 55.4482 21.1647 55.525 21.1647H59.3179C59.4727 21.1645 59.6211 21.1029 59.7306 20.9934C59.84 20.8839 59.9016 20.7355 59.9019 20.5807V6.80826C59.9016 6.65345 59.84 6.50504 59.7306 6.39557C59.6211 6.2861 59.4727 6.2245 59.3179 6.22426Z",fill:"#EEEFFC"})}),ee.jsx("svg",{width:"81",height:"26",viewBox:"0 0 81 26",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:ee.jsx("path",{d:"M79.7342 16.0504C79.6223 16.0496 79.5115 16.0719 79.4086 16.1157C79.3058 16.1596 79.213 16.2241 79.1361 16.3053C78.3283 17.1387 77.2717 17.6468 76.0409 17.6468C75.3502 17.6479 74.6695 17.4815 74.0574 17.1618C72.4453 16.3204 71.4029 14.4832 71.6926 12.4364C72.009 10.1896 73.9738 8.51769 76.1759 8.58254C77.3508 8.61808 78.3594 9.11913 79.1388 9.92313C79.2155 10.0042 79.3081 10.0687 79.4109 10.1124C79.5136 10.1561 79.6243 10.1782 79.736 10.1772C80.2283 10.1772 80.6504 9.74189 80.6504 9.27105C80.6504 9.05161 80.5811 8.8002 80.4034 8.61808C79.3996 7.5692 78.0489 6.92044 76.6025 6.79243C73.1251 6.48327 69.9952 9.31547 69.8868 12.9099C69.7784 16.5221 72.5617 19.4609 76.0409 19.4609C77.7649 19.4609 79.2774 18.7706 80.4034 17.6122C80.5793 17.4309 80.6504 17.1769 80.6504 16.9601C80.6486 16.4866 80.2256 16.0504 79.7342 16.0504ZM64.2411 13.7876C65.3813 13.1347 66.1384 11.922 66.102 10.4384C66.0531 8.37288 64.3291 6.76489 62.3251 6.76489H56.7807C56.2955 6.76489 55.9018 7.17088 55.9018 7.67105V18.2278C55.9018 18.6889 56.2199 19.1118 56.6625 19.1624C57.2099 19.2246 57.6605 18.8461 57.6605 18.2971V15.9953C57.6605 15.8176 57.7769 15.6648 57.9422 15.6222L61.0579 14.8271L62.3438 14.4895C62.4289 14.4677 62.519 14.477 62.5979 14.5158C62.6767 14.5546 62.7392 14.6202 62.7739 14.7009L64.5148 18.6454C64.657 18.9696 64.9654 19.1606 65.2897 19.1606C65.4971 19.159 65.6967 19.082 65.8514 18.9439C66.1446 18.688 66.2059 18.2438 66.0469 17.884L64.2411 13.7885V13.7876ZM57.6605 13.4145V8.88993C57.6605 8.67671 57.8275 8.50703 58.0319 8.50703H62.2682C63.4982 8.50703 64.3433 9.37765 64.3433 10.5397C64.3433 11.7008 63.651 12.5394 62.2371 12.8513L58.111 13.7894C58.0559 13.8009 57.9988 13.7999 57.9441 13.7862C57.8894 13.7726 57.8385 13.7468 57.7952 13.7108C57.7518 13.6747 57.7172 13.6294 57.6939 13.5781C57.6706 13.5268 57.6591 13.4708 57.6605 13.4145ZM46.7831 7.45517C46.5965 7.05095 46.2011 6.80931 45.7238 6.80931C45.2466 6.80931 44.8503 7.05095 44.6645 7.45339L39.8106 17.8849C39.7475 18.0137 39.7129 18.1736 39.7129 18.3184C39.7129 18.8133 40.0879 19.1855 40.5882 19.1855C40.7563 19.1905 40.922 19.1449 41.0638 19.0546C41.2056 18.9643 41.317 18.8335 41.3836 18.6791L42.2873 16.7495C42.693 16.8974 43.11 17.0121 43.5342 17.0925C44.238 17.2266 44.9471 17.2728 45.6465 17.2648C46.3486 17.2586 47.04 17.1724 47.7216 17.056C48.0619 16.9974 48.397 16.9112 48.7355 16.8402L49.1497 16.722L50.0597 18.6658C50.1255 18.8233 50.2373 18.9572 50.3805 19.0503C50.5236 19.1433 50.6915 19.191 50.8621 19.1873C51.4291 19.1873 51.7348 18.7413 51.7348 18.3211C51.7348 18.1736 51.6984 18.0155 51.6415 17.8938L46.7831 7.45517ZM47.4559 15.4862C46.8462 15.5902 46.2295 15.6684 45.6199 15.6728C45.0093 15.6781 44.4024 15.6408 43.8159 15.5271C43.526 15.4728 43.2404 15.3983 42.961 15.3041L43.6897 13.745H43.687L45.387 10.1159C45.4161 10.0515 45.4631 9.99687 45.5225 9.95853C45.5818 9.9202 45.651 9.89981 45.7216 9.89981C45.7923 9.89981 45.8614 9.9202 45.9208 9.95853C45.9801 9.99687 46.0272 10.0515 46.0562 10.1159L47.6212 13.4563L47.6994 13.6233L47.7562 13.745L48.4645 15.2615L48.3667 15.289C48.0646 15.3548 47.7625 15.4338 47.4559 15.4862ZM29.1386 8.64562C29.327 7.7057 29.1777 6.75334 28.7227 5.96356C28.1966 5.05473 27.3559 4.44085 26.3517 4.23475C26.1155 4.18615 25.8748 4.16233 25.6336 4.16367C23.9274 4.16367 22.4913 5.39587 22.1403 7.15845C21.9476 8.10539 21.5919 9.0117 21.089 9.83695C21.0799 9.85228 21.0669 9.86485 21.0512 9.8733C21.0356 9.88175 21.0179 9.88577 21.0001 9.88492C20.981 9.88423 20.9625 9.87809 20.9467 9.86723C20.931 9.85637 20.9187 9.84124 20.9112 9.82363L17.5654 2.56546C17.1024 1.56246 16.2777 0.817987 15.3028 0.523929C13.6357 0.0184333 11.8175 0.857964 11.071 2.47573L7.60783 9.98176C7.60447 9.9891 7.59909 9.99533 7.59233 9.99973C7.58557 10.0041 7.57769 10.0065 7.56962 10.0066C7.54474 10.0066 7.5403 9.99242 7.53674 9.98176C6.98754 8.58254 5.6883 7.67816 4.22288 7.67816C3.74922 7.67816 3.28623 7.77499 2.84544 7.96422C1.96388 8.34268 1.28494 9.06583 0.92769 10.0004C0.574435 10.9213 0.584599 11.942 0.956126 12.8557C1.61108 14.4708 2.70681 16.0299 4.12513 17.3634C4.15979 17.3954 4.16956 17.4434 4.14912 17.486L3.03118 19.9131C2.18694 21.7459 2.89699 23.9606 4.61301 24.8526C5.1099 25.1137 5.6628 25.2503 6.22417 25.2506C7.59539 25.2506 8.86352 24.4253 9.45271 23.1486L10.4178 21.0556C10.4276 21.0333 10.4452 21.0154 10.4673 21.0053C10.4895 20.9951 10.5145 20.9934 10.5378 21.0005C11.7008 21.335 12.9045 21.5078 14.1147 21.514C15.4104 21.514 16.7292 21.3159 18.0284 20.9277C18.0517 20.9201 18.0769 20.9214 18.0993 20.9314C18.1216 20.9415 18.1394 20.9594 18.1493 20.9818L19.1037 23.0545C19.7169 24.3817 20.9912 25.2435 22.3562 25.2523H22.3767C22.9378 25.2533 23.4906 25.1169 23.9869 24.8552C25.7021 23.9624 26.4112 21.7414 25.5617 19.9024L24.3557 17.2959C24.3466 17.2756 24.3441 17.2529 24.3486 17.231C24.3531 17.2092 24.3643 17.1893 24.3806 17.1742C26.8174 14.8493 28.5067 11.8207 29.1386 8.64562ZM8.84664 20.535L7.97574 22.4237C7.82258 22.7616 7.57598 23.0487 7.26502 23.2511C6.95405 23.4535 6.59168 23.5628 6.22062 23.5662C5.92024 23.5662 5.63054 23.4969 5.35861 23.3583C4.41661 22.8759 4.03271 21.6561 4.50193 20.6354L5.43059 18.6205C5.43907 18.602 5.45257 18.5864 5.46953 18.5752C5.4865 18.5641 5.50626 18.5579 5.52656 18.5574C5.54256 18.5574 5.563 18.5619 5.58166 18.5761C6.57662 19.3042 7.65329 19.9137 8.78977 20.3919C8.82531 20.4062 8.84309 20.4364 8.84842 20.4524C8.85436 20.4654 8.85729 20.4796 8.85698 20.4939C8.85667 20.5082 8.85314 20.5222 8.84664 20.535ZM17.3468 19.3401C17.3411 19.3532 17.3326 19.3648 17.3218 19.3742C17.311 19.3836 17.2983 19.3904 17.2846 19.3943C16.2271 19.683 15.1598 19.8296 14.1111 19.8296C9.25454 19.8296 4.12246 16.4386 2.4251 12.1112C2.0252 11.0896 2.50508 9.92135 3.49684 9.50736C3.72878 9.40964 3.97406 9.35989 4.22288 9.35989C5.01913 9.35989 5.72474 9.85028 6.02244 10.6116C7.13062 13.4394 10.8364 15.8292 14.1111 15.8292C14.6043 15.8292 15.1109 15.7803 15.6165 15.6835C15.6636 15.6746 15.7107 15.6959 15.7294 15.7403L17.3468 19.2468C17.353 19.2616 17.3562 19.2774 17.3562 19.2935C17.3562 19.3095 17.353 19.3253 17.3468 19.3401ZM13.3762 13.8472L14.0276 12.4337C14.0466 12.3902 14.0779 12.3532 14.1177 12.3273C14.1575 12.3014 14.204 12.2877 14.2515 12.288C14.299 12.2883 14.3454 12.3022 14.3853 12.328C14.4251 12.3539 14.4567 12.3905 14.4764 12.4337L15.1127 13.8134C15.1297 13.8497 15.138 13.8895 15.1369 13.9296C15.1358 13.9697 15.1254 14.009 15.1064 14.0444C15.0891 14.0792 15.0635 14.1093 15.0319 14.1321C15.0003 14.1548 14.9637 14.1695 14.9252 14.175C14.4787 14.2428 14.0255 14.2548 13.5761 14.2105C13.5366 14.2061 13.4987 14.1922 13.4657 14.1699C13.4327 14.1476 13.4057 14.1177 13.3869 14.0826C13.3666 14.047 13.3551 14.0071 13.3532 13.9661C13.3514 13.9252 13.3593 13.8845 13.3762 13.8472ZM23.2316 23.3583C22.9653 23.4954 22.67 23.5667 22.3704 23.5662C21.9998 23.5625 21.6379 23.4531 21.3274 23.2507C21.0169 23.0482 20.7708 22.7613 20.618 22.4237L14.7723 9.74634C14.7318 9.65394 14.6653 9.57533 14.5809 9.52014C14.4965 9.46494 14.3978 9.43554 14.2969 9.43554C14.196 9.43554 14.0973 9.46494 14.0128 9.52014C13.9284 9.57533 13.8619 9.65394 13.8214 9.74634L12.0085 13.6784C11.9985 13.701 11.9807 13.7192 11.9583 13.7296C11.9359 13.7401 11.9105 13.7421 11.8868 13.7352C10.6773 13.3061 9.54247 12.5848 8.69112 11.7079C8.67721 11.6925 8.66825 11.6732 8.6654 11.6526C8.66255 11.632 8.66594 11.6111 8.67513 11.5924L12.5924 3.0976C12.7239 2.81332 12.9114 2.58411 13.1336 2.43486C13.6597 2.0795 14.2578 1.97379 14.8212 2.13547C15.0905 2.21468 15.3397 2.35098 15.5516 2.5351C15.7635 2.71921 15.9333 2.94683 16.0493 3.20243L24.0891 20.638C24.5601 21.6561 24.1744 22.8768 23.2316 23.3583ZM23.699 15.5342C23.687 15.5466 23.6721 15.556 23.6558 15.5615C23.6394 15.5671 23.6219 15.5687 23.6048 15.5662C23.5886 15.5632 23.5735 15.5562 23.5607 15.5458C23.548 15.5354 23.5381 15.5219 23.5319 15.5067L21.8177 11.7879C21.8096 11.7702 21.8065 11.7508 21.8087 11.7315C21.8109 11.7122 21.8183 11.694 21.8301 11.6786C22.7988 10.3966 23.4626 8.93701 23.7497 7.45428C23.9318 6.52147 24.7299 5.84451 25.6496 5.84451H25.6514C25.8087 5.84451 25.9678 5.86584 26.1251 5.90581C27.1417 6.16611 27.7602 7.24373 27.5327 8.35778C26.988 11.0238 25.6639 13.5042 23.699 15.5342Z",fill:"#EEEFFC"})}),ee.jsxs("svg",{width:"117",height:"27",viewBox:"0 0 117 27",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[ee.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M13.3484 26.6667C20.72 26.6667 26.6969 20.6969 26.6969 13.3333C26.6969 5.96978 20.7218 0 13.3484 0C5.97689 0 0 5.96978 0 13.3333C0 20.6969 5.97689 26.6667 13.3484 26.6667ZM22.064 15.6489V14.7893C22.064 14.7708 22.0597 14.7524 22.0515 14.7358C22.0432 14.7191 22.0312 14.7047 22.0164 14.6935C22.0015 14.6822 21.9843 14.6746 21.966 14.6712C21.9478 14.6678 21.929 14.6687 21.9111 14.6738L17.8507 15.8471C17.8291 15.8527 17.8097 15.8644 17.7947 15.8809C17.3591 16.3609 16.9902 16.6836 16.8924 16.7689L16.8853 16.7742C16.6329 16.9876 16.32 17.1049 15.9911 17.1049H14.5209V15.6071H15.6889C15.7189 15.6074 15.748 15.5966 15.7707 15.5769L15.9218 15.4391C15.9858 15.3796 16.0622 15.3084 16.1538 15.2169L16.1778 15.1938C16.2258 15.1449 16.2773 15.0942 16.3289 15.0373C16.3884 14.9787 16.448 14.9129 16.5022 14.8489C16.5947 14.7502 16.6827 14.6471 16.7742 14.5387C16.84 14.4676 16.9004 14.3876 16.9591 14.3058C17.0258 14.2264 17.0896 14.1446 17.1502 14.0604C17.1724 14.0276 17.1964 13.9947 17.2213 13.9609L17.2907 13.8604C17.3351 13.7947 17.3796 13.7253 17.4151 13.6596C17.5775 13.406 17.7094 13.1342 17.808 12.8498L17.8196 12.8187C17.9312 12.5084 17.9719 12.177 17.9387 11.8489C17.9353 11.7792 17.9261 11.7099 17.9111 11.6418V11.6302C17.9048 11.5808 17.8941 11.532 17.8791 11.4844C17.8302 11.2622 17.7529 11.04 17.656 10.8222C17.6226 10.7416 17.5865 10.6621 17.5476 10.584C17.4601 10.4186 17.3652 10.2572 17.2631 10.1004C17.2427 10.0676 17.2196 10.0338 17.1964 10L17.144 9.92267C17.0782 9.82044 17.0044 9.72267 16.9324 9.62756L16.8836 9.56356C16.8395 9.50656 16.7941 9.45055 16.7476 9.39556L16.6711 9.30311C16.6 9.21689 16.5298 9.13422 16.4587 9.05422C16.2175 8.78564 15.9635 8.52875 15.6978 8.28444C15.4569 8.05565 15.206 7.83766 14.9458 7.63111L14.8764 7.57333C14.8215 7.53268 14.767 7.49149 14.7129 7.44978C14.7021 7.44199 14.6901 7.43598 14.6773 7.432L14.5209 7.38756V6.09511C14.5212 5.89353 14.442 5.69996 14.3004 5.55644C14.2309 5.48559 14.1479 5.42935 14.0563 5.39104C13.9647 5.35272 13.8664 5.3331 13.7671 5.33333C13.6675 5.33368 13.5689 5.35367 13.4769 5.39215C13.385 5.43064 13.3016 5.48686 13.2314 5.55761C13.1613 5.62836 13.1057 5.71225 13.068 5.80448C13.0303 5.8967 13.0111 5.99547 13.0116 6.09511V6.96622L12.9342 6.944L12.7209 6.88356L12.528 6.83022H12.5262L12.5227 6.82933H12.5182L11.0516 6.432C11.037 6.42795 11.0216 6.42831 11.0072 6.43303C10.9929 6.43774 10.9802 6.4466 10.9709 6.45849C10.9616 6.47037 10.956 6.48476 10.9549 6.49982C10.9537 6.51488 10.957 6.52994 10.9644 6.54311L11.1991 6.976C11.2124 7.00889 11.2293 7.04267 11.2471 7.07644L11.28 7.144C11.3182 7.22133 11.3573 7.30222 11.3938 7.38222C11.4267 7.45333 11.4596 7.52444 11.4978 7.6L11.5467 7.70933C11.8646 8.40578 12.1262 9.12661 12.3289 9.86489L12.3582 9.97067L12.3733 10.0364C12.4178 10.2098 12.4551 10.3831 12.4827 10.5564C12.5049 10.6756 12.5253 10.7893 12.536 10.9049C12.5529 11.0347 12.5689 11.1653 12.5751 11.2951C12.5858 11.4142 12.5911 11.5387 12.5911 11.6578C12.5937 11.9608 12.5606 12.263 12.4924 12.5582L12.4871 12.5769C12.4693 12.6444 12.4507 12.7147 12.4276 12.7813C12.408 12.8524 12.3813 12.9253 12.3538 13L12.3253 13.08L12.32 13.0942C12.2996 13.1484 12.2791 13.2036 12.2533 13.2578C12.1138 13.5859 11.9541 13.905 11.7751 14.2133C11.52 14.664 11.264 15.0596 11.0836 15.3147L11.0516 15.3618C11.0391 15.3796 11.0267 15.3973 11.016 15.4151C11.0032 15.4332 10.9956 15.4545 10.994 15.4766C10.9924 15.4987 10.9969 15.5209 11.007 15.5406C11.017 15.5604 11.0323 15.577 11.0511 15.5887C11.0699 15.6004 11.0916 15.6068 11.1138 15.6071H13.0124V17.1049H11.0924C10.5769 17.1049 10.0996 16.8133 9.86845 16.3458C9.75095 16.1165 9.70306 15.8579 9.73067 15.6018C9.73689 15.5262 9.68089 15.4551 9.60444 15.4551H5.72444C5.69285 15.4551 5.66256 15.4677 5.64022 15.49C5.61788 15.5123 5.60533 15.5426 5.60533 15.5742V15.6542C5.60463 16.2411 5.71955 16.8224 5.94352 17.3648C6.16749 17.9073 6.49612 18.4003 6.91065 18.8158C7.32519 19.2312 7.8175 19.5609 8.35947 19.7861C8.90144 20.0112 9.48245 20.1274 10.0693 20.128H17.0267C18.3307 20.128 19.0711 18.9413 19.8 17.7742C20.0027 17.4489 20.2044 17.1253 20.4169 16.8293C20.7991 16.2978 21.72 15.8756 21.9884 15.7609C22.0104 15.7514 22.0291 15.7358 22.0424 15.7159C22.0556 15.6961 22.0637 15.6728 22.064 15.6489ZM6.64356 13.6907L6.58578 13.7813C6.57419 13.7993 6.5677 13.8201 6.56701 13.8415C6.56632 13.8629 6.57144 13.8841 6.58185 13.9028C6.59225 13.9215 6.60754 13.937 6.62607 13.9477C6.64461 13.9584 6.66571 13.9639 6.68711 13.9636H10.2587C10.278 13.9635 10.297 13.9587 10.3141 13.9495C10.3311 13.9404 10.3457 13.9272 10.3564 13.9111C10.4036 13.84 10.448 13.7662 10.4871 13.6907C10.7956 13.1733 11.0702 12.6124 11.1707 12.1991C11.4053 11.1938 10.904 9.57867 10.3244 8.27911C10.3155 8.25962 10.3015 8.24289 10.2839 8.2307C10.2662 8.21851 10.2456 8.21131 10.2242 8.20985C10.2028 8.20839 10.1815 8.21274 10.1623 8.22243C10.1432 8.23211 10.127 8.24678 10.1156 8.26489L6.64356 13.6907Z",fill:"#EEEFFC"}),ee.jsx("path",{d:"M39.7035 19.7324C38.4964 19.7324 37.3871 19.4622 36.3755 18.9218C35.3915 18.396 34.5651 17.618 33.9808 16.6675C33.396 15.6924 33.1035 14.6 33.1035 13.3911C33.1035 12.1813 33.396 11.0951 33.9808 10.1315C34.5651 9.18108 35.3915 8.40308 36.3755 7.87732C37.3871 7.33687 38.4964 7.06665 39.7035 7.06665C40.9097 7.06665 42.0128 7.33687 43.0128 7.87732C43.9992 8.39332 44.8222 9.17391 45.3897 10.1315C45.9746 11.0951 46.2671 12.1813 46.2671 13.3911C46.2671 14.6 45.9746 15.6933 45.3897 16.6675C44.8156 17.6199 43.9942 18.3989 43.0128 18.9218C42.0128 19.4622 40.9097 19.7324 39.7035 19.7324ZM39.7035 16.984C40.7275 16.984 41.5435 16.6551 42.1533 15.9973C42.7755 15.3395 43.0866 14.4711 43.0866 13.3911C43.0866 12.2978 42.7755 11.4293 42.1533 10.784C41.5435 10.1262 40.7275 9.79732 39.7035 9.79732C38.6671 9.79732 37.8386 10.12 37.2173 10.7662C36.6075 11.4115 36.3026 12.2862 36.3026 13.3911C36.3026 14.4827 36.6075 15.3582 37.2173 16.0151C37.8386 16.6613 38.6671 16.984 39.7035 16.984ZM51.1328 11.1706C51.4377 10.7129 51.8582 10.344 52.3951 10.0613C52.9311 9.77954 53.5595 9.63821 54.2777 9.63821C55.1186 9.63821 55.8813 9.84443 56.564 10.2551C57.2457 10.6658 57.7817 11.2533 58.1728 12.0169C58.5746 12.7804 58.7755 13.6666 58.7755 14.6764C58.7755 15.6871 58.5746 16.5786 58.172 17.3546C57.7826 18.1173 57.2457 18.7111 56.5631 19.1333C55.8813 19.5449 55.1186 19.7502 54.2786 19.7502C53.5711 19.7502 52.9435 19.6089 52.3942 19.3271C51.8582 19.0453 51.4377 18.6809 51.1337 18.2346V22.5333H48.0066V9.77954H51.1328V11.1715V11.1706ZM55.5951 14.6764C55.5951 13.9253 55.3746 13.3378 54.9364 12.9146C54.5097 12.4809 53.9791 12.2631 53.3453 12.2631C52.724 12.2631 52.1933 12.4809 51.7542 12.9146C51.3275 13.3502 51.1142 13.9431 51.1142 14.6942C51.1142 15.4462 51.3275 16.0391 51.7542 16.4738C51.9613 16.6847 52.2092 16.8512 52.4827 16.9632C52.7563 17.0752 53.0497 17.1304 53.3453 17.1253C53.9675 17.1253 54.4973 16.9084 54.9364 16.4738C55.3746 16.0275 55.5951 15.4284 55.5951 14.6764ZM70.0333 14.536C70.0333 14.8178 70.0146 15.1111 69.9782 15.416H62.9026C62.9515 16.0275 63.1524 16.4969 63.5062 16.8258C63.8715 17.1431 64.3168 17.3013 64.8404 17.3013C65.6208 17.3013 66.1631 16.984 66.468 16.3502H69.7951C69.625 16.9965 69.3056 17.5938 68.8626 18.0942C68.4092 18.6219 67.84 19.0377 67.1995 19.3093C66.5284 19.6026 65.7791 19.7502 64.9506 19.7502C63.9506 19.7502 63.0608 19.5449 62.2813 19.1333C61.5145 18.735 60.8794 18.1231 60.4529 17.3715C60.0137 16.6089 59.7951 15.7155 59.7951 14.6942C59.7951 13.672 60.0084 12.7804 60.4351 12.0169C60.8613 11.2654 61.496 10.6535 62.2626 10.2551C63.0431 9.84443 63.9391 9.63821 64.9506 9.63821C65.9373 9.63821 66.8155 9.83821 67.5826 10.2373C68.3337 10.62 68.9565 11.2138 69.3746 11.9458C69.8137 12.6862 70.0333 13.5493 70.0333 14.536ZM66.8333 13.7431C66.8333 13.2267 66.6511 12.8151 66.2848 12.5102C65.9195 12.2044 65.4626 12.0515 64.9142 12.0515C64.3897 12.0515 63.9453 12.1991 63.5791 12.4924C63.2253 12.7858 63.0057 13.2035 62.9213 13.7431H66.8333ZM77.8991 9.67376C79.0937 9.67376 80.044 10.0498 80.7515 10.8009C81.4706 11.5413 81.8297 12.5627 81.8297 13.8667V19.6089H78.7213V14.2711C78.7213 13.6133 78.5453 13.1031 78.1915 12.7386C77.8377 12.3742 77.3631 12.1929 76.7657 12.1929C76.1684 12.1929 75.6929 12.3751 75.3391 12.7386C74.9862 13.1031 74.8093 13.6142 74.8093 14.2711V19.6089H71.6831V9.77954H74.8093V11.0827C75.1257 10.6489 75.5524 10.3075 76.0893 10.0613C76.6253 9.80354 77.2288 9.67376 77.8991 9.67376ZM88.6466 19.7324C87.708 19.7324 86.8671 19.5858 86.1231 19.2924C85.38 18.9991 84.7826 18.5635 84.332 17.9884C83.8928 17.4133 83.6609 16.72 83.6369 15.9093H86.9648C87.0128 16.368 87.1773 16.72 87.4582 16.9671C87.7391 17.2018 88.1044 17.3191 88.5551 17.3191C89.0182 17.3191 89.3844 17.2195 89.652 17.0195C89.9204 16.808 90.0546 16.5209 90.0546 16.1564C90.0546 15.8515 89.9453 15.5982 89.7257 15.3991C89.4974 15.186 89.2304 15.0185 88.9391 14.9058C88.509 14.7341 88.0695 14.5872 87.6226 14.4658C86.7942 14.2186 86.1177 13.9724 85.5933 13.7253C85.0623 13.4733 84.5986 13.0989 84.2404 12.6329C83.8626 12.152 83.6733 11.5235 83.6733 10.7484C83.6733 9.59732 84.1062 8.69954 84.972 8.05332C85.8369 7.39554 86.9649 7.06665 88.3542 7.06665C89.7684 7.06665 90.908 7.39554 91.7729 8.05332C92.6386 8.69954 93.1017 9.60354 93.1631 10.7662H89.78C89.756 10.3662 89.6031 10.0551 89.3231 9.83287C89.0431 9.59732 88.6831 9.47998 88.244 9.47998C87.8662 9.47998 87.5622 9.57954 87.3302 9.77954C87.0991 9.96709 86.9826 10.2435 86.9826 10.6071C86.9826 11.0071 87.1773 11.3182 87.5684 11.5404C87.9577 11.7644 88.5675 12.0053 89.396 12.2631C90.2253 12.5333 90.8955 12.792 91.4075 13.0382C91.932 13.2853 92.3826 13.6427 92.7604 14.1138C93.1382 14.5831 93.3275 15.1875 93.3275 15.9271C93.3275 16.632 93.1382 17.272 92.7604 17.8471C92.3951 18.4231 91.8582 18.8809 91.1515 19.2213C90.4449 19.5618 89.6093 19.7324 88.6466 19.7324ZM104.869 14.536C104.869 14.8178 104.85 15.1111 104.814 15.416H97.7382C97.7871 16.0275 97.988 16.4969 98.3408 16.8258C98.7071 17.1431 99.1515 17.3013 99.676 17.3013C100.456 17.3013 100.999 16.984 101.304 16.3502H104.631C104.46 16.9963 104.141 17.5936 103.698 18.0942C103.245 18.6221 102.675 19.0379 102.034 19.3093C101.364 19.6026 100.615 19.7502 99.7862 19.7502C98.7862 19.7502 97.8964 19.5449 97.116 19.1333C96.3492 18.7348 95.7142 18.1229 95.2875 17.3715C94.8493 16.6089 94.6297 15.7155 94.6297 14.6942C94.6297 13.672 94.8431 12.7804 95.2697 12.0169C95.696 11.2651 96.3311 10.6531 97.0982 10.2551C97.8777 9.84443 98.7737 9.63821 99.7862 9.63821C100.773 9.63821 101.65 9.83821 102.418 10.2373C103.169 10.6203 103.792 11.214 104.21 11.9458C104.649 12.6862 104.869 13.5493 104.869 14.536ZM101.669 13.7431C101.669 13.2267 101.486 12.8151 101.12 12.5102C100.754 12.2044 100.297 12.0515 99.7488 12.0515C99.2253 12.0515 98.78 12.1991 98.4146 12.4924C98.0609 12.7858 97.8413 13.2035 97.756 13.7431H101.669ZM105.896 14.6764C105.896 13.6666 106.091 12.7804 106.481 12.0169C106.883 11.2533 107.426 10.6658 108.109 10.2551C108.792 9.84443 109.553 9.63821 110.394 9.63821C111.113 9.63821 111.741 9.77954 112.278 10.0613C112.825 10.3431 113.247 10.7129 113.539 11.1706V9.77954H116.665V19.6089H113.539V18.2178C113.234 18.6755 112.808 19.0453 112.259 19.3271C111.722 19.6089 111.095 19.7502 110.376 19.7502C109.577 19.7584 108.793 19.5448 108.109 19.1333C107.426 18.7111 106.883 18.1173 106.481 17.3546C106.091 16.5795 105.896 15.6862 105.896 14.6764ZM113.539 14.6942C113.539 13.9431 113.32 13.3493 112.88 12.9146C112.678 12.7032 112.433 12.5361 112.163 12.4239C111.892 12.3118 111.601 12.257 111.308 12.2631C110.687 12.2631 110.156 12.4809 109.718 12.9146C109.291 13.3378 109.078 13.9253 109.078 14.6764C109.078 15.4284 109.291 16.0275 109.718 16.4738C110.156 16.9075 110.687 17.1253 111.308 17.1253C111.93 17.1253 112.454 16.9084 112.88 16.4738C113.32 16.0382 113.539 15.4462 113.539 14.6942Z",fill:"#EEEFFC"})]}),ee.jsxs("svg",{width:"61",height:"22",viewBox:"0 0 61 22",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[ee.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M0 20.744H3.3885V16.7107H6.4953C7.57059 16.7107 8.63522 16.4948 9.62875 16.0746C10.6256 15.6525 11.5288 15.0368 12.2859 14.2631C13.0486 13.4842 13.6518 12.5637 14.0614 11.5535C14.8942 9.50266 14.8942 7.20801 14.0614 5.15712C13.6518 4.14692 13.0486 3.22647 12.2859 2.44752C11.5289 1.67355 10.6257 1.05753 9.62875 0.635201C8.63757 0.21617 7.57236 0.000174779 6.49619 0H0V20.744ZM3.3885 3.45585H6.4953C7.76788 3.45585 8.98891 3.972 9.89002 4.8906C10.7936 5.8171 11.2982 7.0605 11.2959 8.35445C11.2959 9.65328 10.7894 10.8988 9.89002 11.8174C9.44828 12.2705 8.92043 12.6308 8.33748 12.8772C7.75452 13.1236 7.12821 13.2511 6.4953 13.2522H3.38939L3.3885 3.45585Z",fill:"#EEEFFC"}),ee.jsx("path",{d:"M41.0868 16.135C40.6084 16.8388 39.916 17.3699 39.1122 17.6497C38.3124 17.9269 37.4468 17.9349 36.6417 17.6737C35.8332 17.4092 35.1315 16.8915 34.6404 16.1972C34.1438 15.4958 33.8807 14.656 33.8886 13.7967C33.8948 12.935 34.173 12.099 34.6795 11.4096C35.1818 10.7235 35.8921 10.2176 36.7048 9.96688C37.5128 9.71893 38.3797 9.7417 39.1735 10.0317C39.9728 10.325 40.6564 10.8676 41.1233 11.5793L44.0452 9.81941C43.2026 8.45665 41.9388 7.40536 40.4452 6.82463C38.9616 6.25038 37.3295 6.18322 35.8037 6.63363C34.2698 7.08918 32.9267 8.03314 31.9788 9.32191C31.0202 10.6242 30.5024 12.1985 30.501 13.8154C30.4961 15.4322 31.0077 17.0083 31.9611 18.3142C32.904 19.6072 34.2436 20.5568 35.7761 21.0185C37.3 21.4747 38.9321 21.4138 40.4177 20.8453C41.9136 20.2706 43.1816 19.2247 44.0301 17.8656L41.0868 16.135ZM49.1373 0H45.7479V20.744H49.1355V13.8296C49.1341 12.7643 49.5497 11.7408 50.2935 10.9779C50.6573 10.6048 51.092 10.3081 51.5721 10.1052C52.0522 9.90228 52.568 9.79727 53.0892 9.79631C54.1379 9.79631 55.1438 10.221 55.885 10.9779C56.6293 11.7405 57.0453 12.7641 57.0438 13.8296V20.7449H60.4323V13.1571C60.4325 11.8257 60.0487 10.5225 59.3268 9.40364C58.6123 8.2948 57.5871 7.42073 56.3791 6.89038C55.1795 6.36538 53.8502 6.21129 52.5622 6.44796C51.2697 6.68748 50.0774 7.30525 49.1364 8.22297L49.1373 0ZM25.416 0H22.0266V16.1332C22.0266 17.1291 22.3074 18.1037 22.8353 18.9405C23.3594 19.7744 24.1133 20.4392 25.0063 20.855C25.895 21.2672 26.8814 21.4094 27.8465 21.2655C28.8157 21.1195 29.7212 20.6941 30.4521 20.0413L28.8143 17.2073C28.6561 17.4116 28.4544 17.576 28.2242 17.6897C27.9949 17.8031 27.7425 17.8621 27.4866 17.862H27.1098C26.6601 17.862 26.23 17.679 25.9119 17.3556C25.5931 17.0286 25.4151 16.5898 25.416 16.1332V10.3711H28.8036V6.91347H25.416V0ZM18.0756 0C17.5761 0 17.098 0.201665 16.7443 0.562352C16.3915 0.922151 16.1934 1.41077 16.1934 1.92071C16.1934 2.42976 16.3915 2.91837 16.7443 3.27906C17.0971 3.63886 17.5761 3.84141 18.0756 3.84141C18.575 3.84141 19.0531 3.63886 19.4068 3.27817C19.7596 2.91837 19.9578 2.42976 19.9578 1.92071C19.9578 1.41077 19.7596 0.92304 19.4068 0.562352C19.2335 0.384726 19.0265 0.243484 18.7979 0.146916C18.5693 0.0503479 18.3237 0.00039906 18.0756 0ZM19.7694 20.744V6.91525H16.3818V20.7458H19.7694V20.744Z",fill:"#EEEFFC"})]})]})}const qY="modulepreload",YY=function(e){return"/"+e},U5={},J0=function(t,i,n){if(!i||i.length===0)return t();const r=document.getElementsByTagName("link");return Promise.all(i.map(s=>{if(s=YY(s),s in U5)return;U5[s]=!0;const a=s.endsWith(".css"),o=a?'[rel="stylesheet"]':"";if(!!n)for(let u=r.length-1;u>=0;u--){const h=r[u];if(h.href===s&&(!a||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${o}`))return;const c=document.createElement("link");if(c.rel=a?"stylesheet":qY,a||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),a)return new Promise((u,h)=>{c.addEventListener("load",u),c.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>t()).catch(s=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s})};var ZY=Object.create,vE=Object.defineProperty,QY=Object.getOwnPropertyDescriptor,KY=Object.getOwnPropertyNames,$Y=Object.getPrototypeOf,JY=Object.prototype.hasOwnProperty,Hp=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),eZ=(e,t)=>{for(var i in t)vE(e,i,{get:t[i],enumerable:!0})},tZ=(e,t,i,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of KY(t))!JY.call(e,r)&&r!==i&&vE(e,r,{get:()=>t[r],enumerable:!(n=QY(t,r))||n.enumerable});return e},Gp=(e,t,i)=>(i=e!=null?ZY($Y(e)):{},tZ(t||!e||!e.__esModule?vE(i,"default",{value:e,enumerable:!0}):i,e)),iZ=Hp((e,t)=>{(function(i,n){typeof e=="object"?t.exports=n():typeof define=="function"&&define.amd?define(n):i.Alea=n()})(e,function(){return i.importState=function(r){var s=new i;return s.importState(r),s},i;function i(){return function(r){var s=0,a=0,o=0,l=1;r.length==0&&(r=[+new Date]);var c=n();s=c(" "),a=c(" "),o=c(" ");for(var u=0;u<r.length;u++)s-=c(r[u]),s<0&&(s+=1),a-=c(r[u]),a<0&&(a+=1),o-=c(r[u]),o<0&&(o+=1);c=null;var h=function(){var d=2091639*s+l*23283064365386963e-26;return s=a,a=o,o=d-(l=d|0)};return h.next=h,h.uint32=function(){return h()*4294967296},h.fract53=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.version="Alea 0.9",h.args=r,h.exportState=function(){return[s,a,o,l]},h.importState=function(d){s=+d[0]||0,a=+d[1]||0,o=+d[2]||0,l=+d[3]||0},h}(Array.prototype.slice.call(arguments))}function n(){var r=4022871197,s=function(a){a=a.toString();for(var o=0;o<a.length;o++){r+=a.charCodeAt(o);var l=.02519603282416938*r;r=l>>>0,l-=r,l*=r,r=l>>>0,l-=r,r+=l*4294967296}return(r>>>0)*23283064365386963e-26};return s.version="Mash 0.9",s}})}),yB=Hp((e,t)=>{(function(i,n){typeof e=="object"&&typeof t<"u"?n(e):typeof define=="function"&&define.amd?define(["exports"],n):n((i=typeof globalThis<"u"?globalThis:i||self).SVDJS={})})(e,function(i){i.SVD=function(n,r,s,a,o){if(r=r===void 0||r,s=s===void 0||s,o=1e-64/(a=a||Math.pow(2,-52)),!n)throw new TypeError("Matrix a is not defined");var l,c,u,h,d,p,f,v,m,g,y,x,_=n[0].length,b=n.length;if(b<_)throw new TypeError("Invalid matrix: m < n");for(var w=[],M=[],S=[],C=r==="f"?b:_,E=g=f=0;E<b;E++)M[E]=new Array(C).fill(0);for(E=0;E<_;E++)S[E]=new Array(_).fill(0);var P,I=new Array(_).fill(0);for(E=0;E<b;E++)for(l=0;l<_;l++)M[E][l]=n[E][l];for(E=0;E<_;E++){for(w[E]=f,m=0,u=E+1,l=E;l<b;l++)m+=Math.pow(M[l][E],2);if(m<o)f=0;else for(v=(p=M[E][E])*(f=p<0?Math.sqrt(m):-Math.sqrt(m))-m,M[E][E]=p-f,l=u;l<_;l++){for(m=0,c=E;c<b;c++)m+=M[c][E]*M[c][l];for(p=m/v,c=E;c<b;c++)M[c][l]=M[c][l]+p*M[c][E]}for(I[E]=f,m=0,l=u;l<_;l++)m+=Math.pow(M[E][l],2);if(m<o)f=0;else{for(v=(p=M[E][E+1])*(f=p<0?Math.sqrt(m):-Math.sqrt(m))-m,M[E][E+1]=p-f,l=u;l<_;l++)w[l]=M[E][l]/v;for(l=u;l<b;l++){for(m=0,c=u;c<_;c++)m+=M[l][c]*M[E][c];for(c=u;c<_;c++)M[l][c]=M[l][c]+m*w[c]}}g<(y=Math.abs(I[E])+Math.abs(w[E]))&&(g=y)}if(s)for(E=_-1;0<=E;E--){if(f!==0){for(v=M[E][E+1]*f,l=u;l<_;l++)S[l][E]=M[E][l]/v;for(l=u;l<_;l++){for(m=0,c=u;c<_;c++)m+=M[E][c]*S[c][l];for(c=u;c<_;c++)S[c][l]=S[c][l]+m*S[c][E]}}for(l=u;l<_;l++)S[E][l]=0,S[l][E]=0;S[E][E]=1,f=w[E],u=E}if(r){if(r==="f")for(E=_;E<b;E++){for(l=_;l<b;l++)M[E][l]=0;M[E][E]=1}for(E=_-1;0<=E;E--){for(u=E+1,f=I[E],l=u;l<C;l++)M[E][l]=0;if(f!==0){for(v=M[E][E]*f,l=u;l<C;l++){for(m=0,c=u;c<b;c++)m+=M[c][E]*M[c][l];for(p=m/v,c=E;c<b;c++)M[c][l]=M[c][l]+p*M[c][E]}for(l=E;l<b;l++)M[l][E]=M[l][E]/f}else for(l=E;l<b;l++)M[l][E]=0;M[E][E]=M[E][E]+1}}for(a*=g,c=_-1;0<=c;c--)for(var D=0;D<50;D++){for(P=!1,u=c;0<=u;u--){if(Math.abs(w[u])<=a){P=!0;break}if(Math.abs(I[u-1])<=a)break}if(!P){for(d=0,h=u-(m=1),E=u;E<c+1&&(p=m*w[E],w[E]=d*w[E],!(Math.abs(p)<=a));E++)if(f=I[E],I[E]=Math.sqrt(p*p+f*f),d=f/(v=I[E]),m=-p/v,r)for(l=0;l<b;l++)y=M[l][h],x=M[l][E],M[l][h]=y*d+x*m,M[l][E]=-y*m+x*d}if(x=I[c],u===c){if(x<0&&(I[c]=-x,s))for(l=0;l<_;l++)S[l][c]=-S[l][c];break}for(g=I[u],p=(((y=I[c-1])-x)*(y+x)+((f=w[c-1])-(v=w[c]))*(f+v))/(2*v*y),f=Math.sqrt(p*p+1),p=((g-x)*(g+x)+v*(y/(p<0?p-f:p+f)-v))/g,E=u+(m=d=1);E<c+1;E++){if(f=w[E],y=I[E],v=m*f,f*=d,x=Math.sqrt(p*p+v*v),p=g*(d=p/(w[E-1]=x))+f*(m=v/x),f=-g*m+f*d,v=y*m,y*=d,s)for(l=0;l<_;l++)g=S[l][E-1],x=S[l][E],S[l][E-1]=g*d+x*m,S[l][E]=-g*m+x*d;if(x=Math.sqrt(p*p+v*v),p=(d=p/(I[E-1]=x))*f+(m=v/x)*y,g=-m*f+d*y,r)for(l=0;l<b;l++)y=M[l][E-1],x=M[l][E],M[l][E-1]=y*d+x*m,M[l][E]=-y*m+x*d}w[u]=0,w[c]=p,I[c]=g}for(E=0;E<_;E++)I[E]<a&&(I[E]=0);return{u:M,q:I,v:S}},i.VERSION="1.1.1",Object.defineProperty(i,"__esModule",{value:!0})})}),nZ=Hp((e,t)=>{(function(i,n){typeof e=="object"&&typeof t<"u"?t.exports=n():typeof define=="function"&&define.amd?define(n):(i=i||self,i.TinyQueue=n())})(e,function(){var i=function(r,s){if(r===void 0&&(r=[]),s===void 0&&(s=n),this.data=r,this.length=this.data.length,this.compare=s,this.length>0)for(var a=(this.length>>1)-1;a>=0;a--)this._down(a)};i.prototype.push=function(r){this.data.push(r),this.length++,this._up(this.length-1)},i.prototype.pop=function(){if(this.length!==0){var r=this.data[0],s=this.data.pop();return this.length--,this.length>0&&(this.data[0]=s,this._down(0)),r}},i.prototype.peek=function(){return this.data[0]},i.prototype._up=function(r){for(var s=this,a=s.data,o=s.compare,l=a[r];r>0;){var c=r-1>>1,u=a[c];if(o(l,u)>=0)break;a[r]=u,r=c}a[r]=l},i.prototype._down=function(r){for(var s=this,a=s.data,o=s.compare,l=this.length>>1,c=a[r];r<l;){var u=(r<<1)+1,h=a[u],d=u+1;if(d<this.length&&o(a[d],h)<0&&(u=d,h=a[d]),o(h,c)>=0)break;a[r]=h,r=u}a[r]=c};function n(r,s){return r<s?-1:r>s?1:0}return i})}),rZ=Hp((e,t)=>{var i=nZ();i.default&&(i=i.default),t.exports=n,t.exports.default=n;function n(c,u,h){u=u||1;for(var d,p,f,v,m=0;m<c[0].length;m++){var g=c[0][m];(!m||g[0]<d)&&(d=g[0]),(!m||g[1]<p)&&(p=g[1]),(!m||g[0]>f)&&(f=g[0]),(!m||g[1]>v)&&(v=g[1])}var y=f-d,x=v-p,_=Math.min(y,x),b=_/2;if(_===0){var w=[d,p];return w.distance=0,w}for(var M=new i(void 0,r),S=d;S<f;S+=_)for(var C=p;C<v;C+=_)M.push(new s(S+b,C+b,b,c));var E=o(c),P=new s(d+y/2,p+x/2,0,c);P.d>E.d&&(E=P);for(var I=M.length;M.length;){var D=M.pop();D.d>E.d&&(E=D,h&&console.log("found best %d after %d probes",Math.round(1e4*D.d)/1e4,I)),!(D.max-E.d<=u)&&(b=D.h/2,M.push(new s(D.x-b,D.y-b,b,c)),M.push(new s(D.x+b,D.y-b,b,c)),M.push(new s(D.x-b,D.y+b,b,c)),M.push(new s(D.x+b,D.y+b,b,c)),I+=4)}h&&(console.log("num probes: "+I),console.log("best distance: "+E.d));var L=[E.x,E.y];return L.distance=E.d,L}function r(c,u){return u.max-c.max}function s(c,u,h,d){this.x=c,this.y=u,this.h=h,this.d=a(c,u,d),this.max=this.d+this.h*Math.SQRT2}function a(c,u,h){for(var d=!1,p=1/0,f=0;f<h.length;f++)for(var v=h[f],m=0,g=v.length,y=g-1;m<g;y=m++){var x=v[m],_=v[y];x[1]>u!=_[1]>u&&c<(_[0]-x[0])*(u-x[1])/(_[1]-x[1])+x[0]&&(d=!d),p=Math.min(p,l(c,u,x,_))}return p===0?0:(d?1:-1)*Math.sqrt(p)}function o(c){for(var u=0,h=0,d=0,p=c[0],f=0,v=p.length,m=v-1;f<v;m=f++){var g=p[f],y=p[m],x=g[0]*y[1]-y[0]*g[1];h+=(g[0]+y[0])*x,d+=(g[1]+y[1])*x,u+=x*3}return u===0?new s(p[0][0],p[0][1],0,c):new s(h/u,d/u,0,c)}function l(c,u,h,d){var p=h[0],f=h[1],v=d[0]-p,m=d[1]-f;if(v!==0||m!==0){var g=((c-p)*v+(u-f)*m)/(v*v+m*m);g>1?(p=d[0],f=d[1]):g>0&&(p+=v*g,f+=m*g)}return v=c-p,m=u-f,v*v+m*m}}),sZ=Hp(e=>{(function(){var t=function(){this.init()};t.prototype={init:function(){var h=this||i;return h._counter=1e3,h._html5AudioPool=[],h.html5PoolSize=10,h._codecs={},h._howls=[],h._muted=!1,h._volume=1,h._canPlayEvent="canplaythrough",h._navigator=typeof window<"u"&&window.navigator?window.navigator:null,h.masterGain=null,h.noAudio=!1,h.usingWebAudio=!0,h.autoSuspend=!0,h.ctx=null,h.autoUnlock=!0,h._setup(),h},volume:function(h){var d=this||i;if(h=parseFloat(h),d.ctx||u(),typeof h<"u"&&h>=0&&h<=1){if(d._volume=h,d._muted)return d;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(h,i.ctx.currentTime);for(var p=0;p<d._howls.length;p++)if(!d._howls[p]._webAudio)for(var f=d._howls[p]._getSoundIds(),v=0;v<f.length;v++){var m=d._howls[p]._soundById(f[v]);m&&m._node&&(m._node.volume=m._volume*h)}return d}return d._volume},mute:function(h){var d=this||i;d.ctx||u(),d._muted=h,d.usingWebAudio&&d.masterGain.gain.setValueAtTime(h?0:d._volume,i.ctx.currentTime);for(var p=0;p<d._howls.length;p++)if(!d._howls[p]._webAudio)for(var f=d._howls[p]._getSoundIds(),v=0;v<f.length;v++){var m=d._howls[p]._soundById(f[v]);m&&m._node&&(m._node.muted=h?!0:m._muted)}return d},stop:function(){for(var h=this||i,d=0;d<h._howls.length;d++)h._howls[d].stop();return h},unload:function(){for(var h=this||i,d=h._howls.length-1;d>=0;d--)h._howls[d].unload();return h.usingWebAudio&&h.ctx&&typeof h.ctx.close<"u"&&(h.ctx.close(),h.ctx=null,u()),h},codecs:function(h){return(this||i)._codecs[h.replace(/^x-/,"")]},_setup:function(){var h=this||i;if(h.state=h.ctx&&h.ctx.state||"suspended",h._autoSuspend(),!h.usingWebAudio)if(typeof Audio<"u")try{var d=new Audio;typeof d.oncanplaythrough>"u"&&(h._canPlayEvent="canplay")}catch{h.noAudio=!0}else h.noAudio=!0;try{var d=new Audio;d.muted&&(h.noAudio=!0)}catch{}return h.noAudio||h._setupCodecs(),h},_setupCodecs:function(){var h=this||i,d=null;try{d=typeof Audio<"u"?new Audio:null}catch{return h}if(!d||typeof d.canPlayType!="function")return h;var p=d.canPlayType("audio/mpeg;").replace(/^no$/,""),f=h._navigator?h._navigator.userAgent:"",v=f.match(/OPR\/([0-6].)/g),m=v&&parseInt(v[0].split("/")[1],10)<33,g=f.indexOf("Safari")!==-1&&f.indexOf("Chrome")===-1,y=f.match(/Version\/(.*?) /),x=g&&y&&parseInt(y[1],10)<15;return h._codecs={mp3:!!(!m&&(p||d.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!p,opus:!!d.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(d.canPlayType('audio/wav; codecs="1"')||d.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!d.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!d.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(d.canPlayType("audio/x-m4a;")||d.canPlayType("audio/m4a;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(d.canPlayType("audio/x-m4b;")||d.canPlayType("audio/m4b;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(d.canPlayType("audio/x-mp4;")||d.canPlayType("audio/mp4;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!x&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!x&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!d.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(d.canPlayType("audio/x-flac;")||d.canPlayType("audio/flac;")).replace(/^no$/,"")},h},_unlockAudio:function(){var h=this||i;if(!(h._audioUnlocked||!h.ctx)){h._audioUnlocked=!1,h.autoUnlock=!1,!h._mobileUnloaded&&h.ctx.sampleRate!==44100&&(h._mobileUnloaded=!0,h.unload()),h._scratchBuffer=h.ctx.createBuffer(1,1,22050);var d=function(p){for(;h._html5AudioPool.length<h.html5PoolSize;)try{var f=new Audio;f._unlocked=!0,h._releaseHtml5Audio(f)}catch{h.noAudio=!0;break}for(var v=0;v<h._howls.length;v++)if(!h._howls[v]._webAudio)for(var m=h._howls[v]._getSoundIds(),g=0;g<m.length;g++){var y=h._howls[v]._soundById(m[g]);y&&y._node&&!y._node._unlocked&&(y._node._unlocked=!0,y._node.load())}h._autoResume();var x=h.ctx.createBufferSource();x.buffer=h._scratchBuffer,x.connect(h.ctx.destination),typeof x.start>"u"?x.noteOn(0):x.start(0),typeof h.ctx.resume=="function"&&h.ctx.resume(),x.onended=function(){x.disconnect(0),h._audioUnlocked=!0,document.removeEventListener("touchstart",d,!0),document.removeEventListener("touchend",d,!0),document.removeEventListener("click",d,!0),document.removeEventListener("keydown",d,!0);for(var _=0;_<h._howls.length;_++)h._howls[_]._emit("unlock")}};return document.addEventListener("touchstart",d,!0),document.addEventListener("touchend",d,!0),document.addEventListener("click",d,!0),document.addEventListener("keydown",d,!0),h}},_obtainHtml5Audio:function(){var h=this||i;if(h._html5AudioPool.length)return h._html5AudioPool.pop();var d=new Audio().play();return d&&typeof Promise<"u"&&(d instanceof Promise||typeof d.then=="function")&&d.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(h){var d=this||i;return h._unlocked&&d._html5AudioPool.push(h),d},_autoSuspend:function(){var h=this;if(!(!h.autoSuspend||!h.ctx||typeof h.ctx.suspend>"u"||!i.usingWebAudio)){for(var d=0;d<h._howls.length;d++)if(h._howls[d]._webAudio){for(var p=0;p<h._howls[d]._sounds.length;p++)if(!h._howls[d]._sounds[p]._paused)return h}return h._suspendTimer&&clearTimeout(h._suspendTimer),h._suspendTimer=setTimeout(function(){if(h.autoSuspend){h._suspendTimer=null,h.state="suspending";var f=function(){h.state="suspended",h._resumeAfterSuspend&&(delete h._resumeAfterSuspend,h._autoResume())};h.ctx.suspend().then(f,f)}},3e4),h}},_autoResume:function(){var h=this;if(!(!h.ctx||typeof h.ctx.resume>"u"||!i.usingWebAudio))return h.state==="running"&&h.ctx.state!=="interrupted"&&h._suspendTimer?(clearTimeout(h._suspendTimer),h._suspendTimer=null):h.state==="suspended"||h.state==="running"&&h.ctx.state==="interrupted"?(h.ctx.resume().then(function(){h.state="running";for(var d=0;d<h._howls.length;d++)h._howls[d]._emit("resume")}),h._suspendTimer&&(clearTimeout(h._suspendTimer),h._suspendTimer=null)):h.state==="suspending"&&(h._resumeAfterSuspend=!0),h}};var i=new t,n=function(h){var d=this;if(!h.src||h.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}d.init(h)};n.prototype={init:function(h){var d=this;return i.ctx||u(),d._autoplay=h.autoplay||!1,d._format=typeof h.format!="string"?h.format:[h.format],d._html5=h.html5||!1,d._muted=h.mute||!1,d._loop=h.loop||!1,d._pool=h.pool||5,d._preload=typeof h.preload=="boolean"||h.preload==="metadata"?h.preload:!0,d._rate=h.rate||1,d._sprite=h.sprite||{},d._src=typeof h.src!="string"?h.src:[h.src],d._volume=h.volume!==void 0?h.volume:1,d._xhr={method:h.xhr&&h.xhr.method?h.xhr.method:"GET",headers:h.xhr&&h.xhr.headers?h.xhr.headers:null,withCredentials:h.xhr&&h.xhr.withCredentials?h.xhr.withCredentials:!1},d._duration=0,d._state="unloaded",d._sounds=[],d._endTimers={},d._queue=[],d._playLock=!1,d._onend=h.onend?[{fn:h.onend}]:[],d._onfade=h.onfade?[{fn:h.onfade}]:[],d._onload=h.onload?[{fn:h.onload}]:[],d._onloaderror=h.onloaderror?[{fn:h.onloaderror}]:[],d._onplayerror=h.onplayerror?[{fn:h.onplayerror}]:[],d._onpause=h.onpause?[{fn:h.onpause}]:[],d._onplay=h.onplay?[{fn:h.onplay}]:[],d._onstop=h.onstop?[{fn:h.onstop}]:[],d._onmute=h.onmute?[{fn:h.onmute}]:[],d._onvolume=h.onvolume?[{fn:h.onvolume}]:[],d._onrate=h.onrate?[{fn:h.onrate}]:[],d._onseek=h.onseek?[{fn:h.onseek}]:[],d._onunlock=h.onunlock?[{fn:h.onunlock}]:[],d._onresume=[],d._webAudio=i.usingWebAudio&&!d._html5,typeof i.ctx<"u"&&i.ctx&&i.autoUnlock&&i._unlockAudio(),i._howls.push(d),d._autoplay&&d._queue.push({event:"play",action:function(){d.play()}}),d._preload&&d._preload!=="none"&&d.load(),d},load:function(){var h=this,d=null;if(i.noAudio){h._emit("loaderror",null,"No audio support.");return}typeof h._src=="string"&&(h._src=[h._src]);for(var p=0;p<h._src.length;p++){var f,v;if(h._format&&h._format[p])f=h._format[p];else{if(v=h._src[p],typeof v!="string"){h._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}f=/^data:audio\/([^;,]+);/i.exec(v),f||(f=/\.([^.]+)$/.exec(v.split("?",1)[0])),f&&(f=f[1].toLowerCase())}if(f||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),f&&i.codecs(f)){d=h._src[p];break}}if(!d){h._emit("loaderror",null,"No codec support for selected audio sources.");return}return h._src=d,h._state="loading",window.location.protocol==="https:"&&d.slice(0,5)==="http:"&&(h._html5=!0,h._webAudio=!1),new r(h),h._webAudio&&a(h),h},play:function(h,d){var p=this,f=null;if(typeof h=="number")f=h,h=null;else{if(typeof h=="string"&&p._state==="loaded"&&!p._sprite[h])return null;if(typeof h>"u"&&(h="__default",!p._playLock)){for(var v=0,m=0;m<p._sounds.length;m++)p._sounds[m]._paused&&!p._sounds[m]._ended&&(v++,f=p._sounds[m]._id);v===1?h=null:f=null}}var g=f?p._soundById(f):p._inactiveSound();if(!g)return null;if(f&&!h&&(h=g._sprite||"__default"),p._state!=="loaded"){g._sprite=h,g._ended=!1;var y=g._id;return p._queue.push({event:"play",action:function(){p.play(y)}}),y}if(f&&!g._paused)return d||p._loadQueue("play"),g._id;p._webAudio&&i._autoResume();var x=Math.max(0,g._seek>0?g._seek:p._sprite[h][0]/1e3),_=Math.max(0,(p._sprite[h][0]+p._sprite[h][1])/1e3-x),b=_*1e3/Math.abs(g._rate),w=p._sprite[h][0]/1e3,M=(p._sprite[h][0]+p._sprite[h][1])/1e3;g._sprite=h,g._ended=!1;var S=function(){g._paused=!1,g._seek=x,g._start=w,g._stop=M,g._loop=!!(g._loop||p._sprite[h][2])};if(x>=M){p._ended(g);return}var C=g._node;if(p._webAudio){var E=function(){p._playLock=!1,S(),p._refreshBuffer(g);var L=g._muted||p._muted?0:g._volume;C.gain.setValueAtTime(L,i.ctx.currentTime),g._playStart=i.ctx.currentTime,typeof C.bufferSource.start>"u"?g._loop?C.bufferSource.noteGrainOn(0,x,86400):C.bufferSource.noteGrainOn(0,x,_):g._loop?C.bufferSource.start(0,x,86400):C.bufferSource.start(0,x,_),b!==1/0&&(p._endTimers[g._id]=setTimeout(p._ended.bind(p,g),b)),d||setTimeout(function(){p._emit("play",g._id),p._loadQueue()},0)};i.state==="running"&&i.ctx.state!=="interrupted"?E():(p._playLock=!0,p.once("resume",E),p._clearTimer(g._id))}else{var P=function(){C.currentTime=x,C.muted=g._muted||p._muted||i._muted||C.muted,C.volume=g._volume*i.volume(),C.playbackRate=g._rate;try{var L=C.play();if(L&&typeof Promise<"u"&&(L instanceof Promise||typeof L.then=="function")?(p._playLock=!0,S(),L.then(function(){p._playLock=!1,C._unlocked=!0,d?p._loadQueue():p._emit("play",g._id)}).catch(function(){p._playLock=!1,p._emit("playerror",g._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),g._ended=!0,g._paused=!0})):d||(p._playLock=!1,S(),p._emit("play",g._id)),C.playbackRate=g._rate,C.paused){p._emit("playerror",g._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}h!=="__default"||g._loop?p._endTimers[g._id]=setTimeout(p._ended.bind(p,g),b):(p._endTimers[g._id]=function(){p._ended(g),C.removeEventListener("ended",p._endTimers[g._id],!1)},C.addEventListener("ended",p._endTimers[g._id],!1))}catch(B){p._emit("playerror",g._id,B)}};C.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(C.src=p._src,C.load());var I=window&&window.ejecta||!C.readyState&&i._navigator.isCocoonJS;if(C.readyState>=3||I)P();else{p._playLock=!0,p._state="loading";var D=function(){p._state="loaded",P(),C.removeEventListener(i._canPlayEvent,D,!1)};C.addEventListener(i._canPlayEvent,D,!1),p._clearTimer(g._id)}}return g._id},pause:function(h){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"pause",action:function(){d.pause(h)}}),d;for(var p=d._getSoundIds(h),f=0;f<p.length;f++){d._clearTimer(p[f]);var v=d._soundById(p[f]);if(v&&!v._paused&&(v._seek=d.seek(p[f]),v._rateSeek=0,v._paused=!0,d._stopFade(p[f]),v._node))if(d._webAudio){if(!v._node.bufferSource)continue;typeof v._node.bufferSource.stop>"u"?v._node.bufferSource.noteOff(0):v._node.bufferSource.stop(0),d._cleanBuffer(v._node)}else(!isNaN(v._node.duration)||v._node.duration===1/0)&&v._node.pause();arguments[1]||d._emit("pause",v?v._id:null)}return d},stop:function(h,d){var p=this;if(p._state!=="loaded"||p._playLock)return p._queue.push({event:"stop",action:function(){p.stop(h)}}),p;for(var f=p._getSoundIds(h),v=0;v<f.length;v++){p._clearTimer(f[v]);var m=p._soundById(f[v]);m&&(m._seek=m._start||0,m._rateSeek=0,m._paused=!0,m._ended=!0,p._stopFade(f[v]),m._node&&(p._webAudio?m._node.bufferSource&&(typeof m._node.bufferSource.stop>"u"?m._node.bufferSource.noteOff(0):m._node.bufferSource.stop(0),p._cleanBuffer(m._node)):(!isNaN(m._node.duration)||m._node.duration===1/0)&&(m._node.currentTime=m._start||0,m._node.pause(),m._node.duration===1/0&&p._clearSound(m._node))),d||p._emit("stop",m._id))}return p},mute:function(h,d){var p=this;if(p._state!=="loaded"||p._playLock)return p._queue.push({event:"mute",action:function(){p.mute(h,d)}}),p;if(typeof d>"u")if(typeof h=="boolean")p._muted=h;else return p._muted;for(var f=p._getSoundIds(d),v=0;v<f.length;v++){var m=p._soundById(f[v]);m&&(m._muted=h,m._interval&&p._stopFade(m._id),p._webAudio&&m._node?m._node.gain.setValueAtTime(h?0:m._volume,i.ctx.currentTime):m._node&&(m._node.muted=i._muted?!0:h),p._emit("mute",m._id))}return p},volume:function(){var h=this,d=arguments,p,f;if(d.length===0)return h._volume;if(d.length===1||d.length===2&&typeof d[1]>"u"){var v=h._getSoundIds(),m=v.indexOf(d[0]);m>=0?f=parseInt(d[0],10):p=parseFloat(d[0])}else d.length>=2&&(p=parseFloat(d[0]),f=parseInt(d[1],10));var g;if(typeof p<"u"&&p>=0&&p<=1){if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"volume",action:function(){h.volume.apply(h,d)}}),h;typeof f>"u"&&(h._volume=p),f=h._getSoundIds(f);for(var y=0;y<f.length;y++)g=h._soundById(f[y]),g&&(g._volume=p,d[2]||h._stopFade(f[y]),h._webAudio&&g._node&&!g._muted?g._node.gain.setValueAtTime(p,i.ctx.currentTime):g._node&&!g._muted&&(g._node.volume=p*i.volume()),h._emit("volume",g._id))}else return g=f?h._soundById(f):h._sounds[0],g?g._volume:0;return h},fade:function(h,d,p,f){var v=this;if(v._state!=="loaded"||v._playLock)return v._queue.push({event:"fade",action:function(){v.fade(h,d,p,f)}}),v;h=Math.min(Math.max(0,parseFloat(h)),1),d=Math.min(Math.max(0,parseFloat(d)),1),p=parseFloat(p),v.volume(h,f);for(var m=v._getSoundIds(f),g=0;g<m.length;g++){var y=v._soundById(m[g]);if(y){if(f||v._stopFade(m[g]),v._webAudio&&!y._muted){var x=i.ctx.currentTime,_=x+p/1e3;y._volume=h,y._node.gain.setValueAtTime(h,x),y._node.gain.linearRampToValueAtTime(d,_)}v._startFadeInterval(y,h,d,p,m[g],typeof f>"u")}}return v},_startFadeInterval:function(h,d,p,f,v,m){var g=this,y=d,x=p-d,_=Math.abs(x/.01),b=Math.max(4,_>0?f/_:f),w=Date.now();h._fadeTo=p,h._interval=setInterval(function(){var M=(Date.now()-w)/f;w=Date.now(),y+=x*M,y=Math.round(y*100)/100,x<0?y=Math.max(p,y):y=Math.min(p,y),g._webAudio?h._volume=y:g.volume(y,h._id,!0),m&&(g._volume=y),(p<d&&y<=p||p>d&&y>=p)&&(clearInterval(h._interval),h._interval=null,h._fadeTo=null,g.volume(p,h._id),g._emit("fade",h._id))},b)},_stopFade:function(h){var d=this,p=d._soundById(h);return p&&p._interval&&(d._webAudio&&p._node.gain.cancelScheduledValues(i.ctx.currentTime),clearInterval(p._interval),p._interval=null,d.volume(p._fadeTo,h),p._fadeTo=null,d._emit("fade",h)),d},loop:function(){var h=this,d=arguments,p,f,v;if(d.length===0)return h._loop;if(d.length===1)if(typeof d[0]=="boolean")p=d[0],h._loop=p;else return v=h._soundById(parseInt(d[0],10)),v?v._loop:!1;else d.length===2&&(p=d[0],f=parseInt(d[1],10));for(var m=h._getSoundIds(f),g=0;g<m.length;g++)v=h._soundById(m[g]),v&&(v._loop=p,h._webAudio&&v._node&&v._node.bufferSource&&(v._node.bufferSource.loop=p,p&&(v._node.bufferSource.loopStart=v._start||0,v._node.bufferSource.loopEnd=v._stop,h.playing(m[g])&&(h.pause(m[g],!0),h.play(m[g],!0)))));return h},rate:function(){var h=this,d=arguments,p,f;if(d.length===0)f=h._sounds[0]._id;else if(d.length===1){var v=h._getSoundIds(),m=v.indexOf(d[0]);m>=0?f=parseInt(d[0],10):p=parseFloat(d[0])}else d.length===2&&(p=parseFloat(d[0]),f=parseInt(d[1],10));var g;if(typeof p=="number"){if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"rate",action:function(){h.rate.apply(h,d)}}),h;typeof f>"u"&&(h._rate=p),f=h._getSoundIds(f);for(var y=0;y<f.length;y++)if(g=h._soundById(f[y]),g){h.playing(f[y])&&(g._rateSeek=h.seek(f[y]),g._playStart=h._webAudio?i.ctx.currentTime:g._playStart),g._rate=p,h._webAudio&&g._node&&g._node.bufferSource?g._node.bufferSource.playbackRate.setValueAtTime(p,i.ctx.currentTime):g._node&&(g._node.playbackRate=p);var x=h.seek(f[y]),_=(h._sprite[g._sprite][0]+h._sprite[g._sprite][1])/1e3-x,b=_*1e3/Math.abs(g._rate);(h._endTimers[f[y]]||!g._paused)&&(h._clearTimer(f[y]),h._endTimers[f[y]]=setTimeout(h._ended.bind(h,g),b)),h._emit("rate",g._id)}}else return g=h._soundById(f),g?g._rate:h._rate;return h},seek:function(){var h=this,d=arguments,p,f;if(d.length===0)h._sounds.length&&(f=h._sounds[0]._id);else if(d.length===1){var v=h._getSoundIds(),m=v.indexOf(d[0]);m>=0?f=parseInt(d[0],10):h._sounds.length&&(f=h._sounds[0]._id,p=parseFloat(d[0]))}else d.length===2&&(p=parseFloat(d[0]),f=parseInt(d[1],10));if(typeof f>"u")return 0;if(typeof p=="number"&&(h._state!=="loaded"||h._playLock))return h._queue.push({event:"seek",action:function(){h.seek.apply(h,d)}}),h;var g=h._soundById(f);if(g)if(typeof p=="number"&&p>=0){var y=h.playing(f);y&&h.pause(f,!0),g._seek=p,g._ended=!1,h._clearTimer(f),!h._webAudio&&g._node&&!isNaN(g._node.duration)&&(g._node.currentTime=p);var x=function(){y&&h.play(f,!0),h._emit("seek",f)};if(y&&!h._webAudio){var _=function(){h._playLock?setTimeout(_,0):x()};setTimeout(_,0)}else x()}else if(h._webAudio){var b=h.playing(f)?i.ctx.currentTime-g._playStart:0,w=g._rateSeek?g._rateSeek-g._seek:0;return g._seek+(w+b*Math.abs(g._rate))}else return g._node.currentTime;return h},playing:function(h){var d=this;if(typeof h=="number"){var p=d._soundById(h);return p?!p._paused:!1}for(var f=0;f<d._sounds.length;f++)if(!d._sounds[f]._paused)return!0;return!1},duration:function(h){var d=this,p=d._duration,f=d._soundById(h);return f&&(p=d._sprite[f._sprite][1]/1e3),p},state:function(){return this._state},unload:function(){for(var h=this,d=h._sounds,p=0;p<d.length;p++)d[p]._paused||h.stop(d[p]._id),h._webAudio||(h._clearSound(d[p]._node),d[p]._node.removeEventListener("error",d[p]._errorFn,!1),d[p]._node.removeEventListener(i._canPlayEvent,d[p]._loadFn,!1),d[p]._node.removeEventListener("ended",d[p]._endFn,!1),i._releaseHtml5Audio(d[p]._node)),delete d[p]._node,h._clearTimer(d[p]._id);var f=i._howls.indexOf(h);f>=0&&i._howls.splice(f,1);var v=!0;for(p=0;p<i._howls.length;p++)if(i._howls[p]._src===h._src||h._src.indexOf(i._howls[p]._src)>=0){v=!1;break}return s&&v&&delete s[h._src],i.noAudio=!1,h._state="unloaded",h._sounds=[],h=null,null},on:function(h,d,p,f){var v=this,m=v["_on"+h];return typeof d=="function"&&m.push(f?{id:p,fn:d,once:f}:{id:p,fn:d}),v},off:function(h,d,p){var f=this,v=f["_on"+h],m=0;if(typeof d=="number"&&(p=d,d=null),d||p)for(m=0;m<v.length;m++){var g=p===v[m].id;if(d===v[m].fn&&g||!d&&g){v.splice(m,1);break}}else if(h)f["_on"+h]=[];else{var y=Object.keys(f);for(m=0;m<y.length;m++)y[m].indexOf("_on")===0&&Array.isArray(f[y[m]])&&(f[y[m]]=[])}return f},once:function(h,d,p){var f=this;return f.on(h,d,p,1),f},_emit:function(h,d,p){for(var f=this,v=f["_on"+h],m=v.length-1;m>=0;m--)(!v[m].id||v[m].id===d||h==="load")&&(setTimeout((function(g){g.call(this,d,p)}).bind(f,v[m].fn),0),v[m].once&&f.off(h,v[m].fn,v[m].id));return f._loadQueue(h),f},_loadQueue:function(h){var d=this;if(d._queue.length>0){var p=d._queue[0];p.event===h&&(d._queue.shift(),d._loadQueue()),h||p.action()}return d},_ended:function(h){var d=this,p=h._sprite;if(!d._webAudio&&h._node&&!h._node.paused&&!h._node.ended&&h._node.currentTime<h._stop)return setTimeout(d._ended.bind(d,h),100),d;var f=!!(h._loop||d._sprite[p][2]);if(d._emit("end",h._id),!d._webAudio&&f&&d.stop(h._id,!0).play(h._id),d._webAudio&&f){d._emit("play",h._id),h._seek=h._start||0,h._rateSeek=0,h._playStart=i.ctx.currentTime;var v=(h._stop-h._start)*1e3/Math.abs(h._rate);d._endTimers[h._id]=setTimeout(d._ended.bind(d,h),v)}return d._webAudio&&!f&&(h._paused=!0,h._ended=!0,h._seek=h._start||0,h._rateSeek=0,d._clearTimer(h._id),d._cleanBuffer(h._node),i._autoSuspend()),!d._webAudio&&!f&&d.stop(h._id,!0),d},_clearTimer:function(h){var d=this;if(d._endTimers[h]){if(typeof d._endTimers[h]!="function")clearTimeout(d._endTimers[h]);else{var p=d._soundById(h);p&&p._node&&p._node.removeEventListener("ended",d._endTimers[h],!1)}delete d._endTimers[h]}return d},_soundById:function(h){for(var d=this,p=0;p<d._sounds.length;p++)if(h===d._sounds[p]._id)return d._sounds[p];return null},_inactiveSound:function(){var h=this;h._drain();for(var d=0;d<h._sounds.length;d++)if(h._sounds[d]._ended)return h._sounds[d].reset();return new r(h)},_drain:function(){var h=this,d=h._pool,p=0,f=0;if(!(h._sounds.length<d)){for(f=0;f<h._sounds.length;f++)h._sounds[f]._ended&&p++;for(f=h._sounds.length-1;f>=0;f--){if(p<=d)return;h._sounds[f]._ended&&(h._webAudio&&h._sounds[f]._node&&h._sounds[f]._node.disconnect(0),h._sounds.splice(f,1),p--)}}},_getSoundIds:function(h){var d=this;if(typeof h>"u"){for(var p=[],f=0;f<d._sounds.length;f++)p.push(d._sounds[f]._id);return p}else return[h]},_refreshBuffer:function(h){var d=this;return h._node.bufferSource=i.ctx.createBufferSource(),h._node.bufferSource.buffer=s[d._src],h._panner?h._node.bufferSource.connect(h._panner):h._node.bufferSource.connect(h._node),h._node.bufferSource.loop=h._loop,h._loop&&(h._node.bufferSource.loopStart=h._start||0,h._node.bufferSource.loopEnd=h._stop||0),h._node.bufferSource.playbackRate.setValueAtTime(h._rate,i.ctx.currentTime),d},_cleanBuffer:function(h){var d=this,p=i._navigator&&i._navigator.vendor.indexOf("Apple")>=0;if(i._scratchBuffer&&h.bufferSource&&(h.bufferSource.onended=null,h.bufferSource.disconnect(0),p))try{h.bufferSource.buffer=i._scratchBuffer}catch{}return h.bufferSource=null,d},_clearSound:function(h){var d=/MSIE |Trident\//.test(i._navigator&&i._navigator.userAgent);d||(h.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var r=function(h){this._parent=h,this.init()};r.prototype={init:function(){var h=this,d=h._parent;return h._muted=d._muted,h._loop=d._loop,h._volume=d._volume,h._rate=d._rate,h._seek=0,h._paused=!0,h._ended=!0,h._sprite="__default",h._id=++i._counter,d._sounds.push(h),h.create(),h},create:function(){var h=this,d=h._parent,p=i._muted||h._muted||h._parent._muted?0:h._volume;return d._webAudio?(h._node=typeof i.ctx.createGain>"u"?i.ctx.createGainNode():i.ctx.createGain(),h._node.gain.setValueAtTime(p,i.ctx.currentTime),h._node.paused=!0,h._node.connect(i.masterGain)):i.noAudio||(h._node=i._obtainHtml5Audio(),h._errorFn=h._errorListener.bind(h),h._node.addEventListener("error",h._errorFn,!1),h._loadFn=h._loadListener.bind(h),h._node.addEventListener(i._canPlayEvent,h._loadFn,!1),h._endFn=h._endListener.bind(h),h._node.addEventListener("ended",h._endFn,!1),h._node.src=d._src,h._node.preload=d._preload===!0?"auto":d._preload,h._node.volume=p*i.volume(),h._node.load()),h},reset:function(){var h=this,d=h._parent;return h._muted=d._muted,h._loop=d._loop,h._volume=d._volume,h._rate=d._rate,h._seek=0,h._rateSeek=0,h._paused=!0,h._ended=!0,h._sprite="__default",h._id=++i._counter,h},_errorListener:function(){var h=this;h._parent._emit("loaderror",h._id,h._node.error?h._node.error.code:0),h._node.removeEventListener("error",h._errorFn,!1)},_loadListener:function(){var h=this,d=h._parent;d._duration=Math.ceil(h._node.duration*10)/10,Object.keys(d._sprite).length===0&&(d._sprite={__default:[0,d._duration*1e3]}),d._state!=="loaded"&&(d._state="loaded",d._emit("load"),d._loadQueue()),h._node.removeEventListener(i._canPlayEvent,h._loadFn,!1)},_endListener:function(){var h=this,d=h._parent;d._duration===1/0&&(d._duration=Math.ceil(h._node.duration*10)/10,d._sprite.__default[1]===1/0&&(d._sprite.__default[1]=d._duration*1e3),d._ended(h)),h._node.removeEventListener("ended",h._endFn,!1)}};var s={},a=function(h){var d=h._src;if(s[d]){h._duration=s[d].duration,c(h);return}if(/^data:[^;]+;base64,/.test(d)){for(var p=atob(d.split(",")[1]),f=new Uint8Array(p.length),v=0;v<p.length;++v)f[v]=p.charCodeAt(v);l(f.buffer,h)}else{var m=new XMLHttpRequest;m.open(h._xhr.method,d,!0),m.withCredentials=h._xhr.withCredentials,m.responseType="arraybuffer",h._xhr.headers&&Object.keys(h._xhr.headers).forEach(function(g){m.setRequestHeader(g,h._xhr.headers[g])}),m.onload=function(){var g=(m.status+"")[0];if(g!=="0"&&g!=="2"&&g!=="3"){h._emit("loaderror",null,"Failed loading audio file with status: "+m.status+".");return}l(m.response,h)},m.onerror=function(){h._webAudio&&(h._html5=!0,h._webAudio=!1,h._sounds=[],delete s[d],h.load())},o(m)}},o=function(h){try{h.send()}catch{h.onerror()}},l=function(h,d){var p=function(){d._emit("loaderror",null,"Decoding audio data failed.")},f=function(v){v&&d._sounds.length>0?(s[d._src]=v,c(d,v)):p()};typeof Promise<"u"&&i.ctx.decodeAudioData.length===1?i.ctx.decodeAudioData(h).then(f).catch(p):i.ctx.decodeAudioData(h,f,p)},c=function(h,d){d&&!h._duration&&(h._duration=d.duration),Object.keys(h._sprite).length===0&&(h._sprite={__default:[0,h._duration*1e3]}),h._state!=="loaded"&&(h._state="loaded",h._emit("load"),h._loadQueue())},u=function(){if(i.usingWebAudio){try{typeof AudioContext<"u"?i.ctx=new AudioContext:typeof webkitAudioContext<"u"?i.ctx=new webkitAudioContext:i.usingWebAudio=!1}catch{i.usingWebAudio=!1}i.ctx||(i.usingWebAudio=!1);var h=/iP(hone|od|ad)/.test(i._navigator&&i._navigator.platform),d=i._navigator&&i._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),p=d?parseInt(d[1],10):null;if(h&&p&&p<9){var f=/safari/.test(i._navigator&&i._navigator.userAgent.toLowerCase());i._navigator&&!f&&(i.usingWebAudio=!1)}i.usingWebAudio&&(i.masterGain=typeof i.ctx.createGain>"u"?i.ctx.createGainNode():i.ctx.createGain(),i.masterGain.gain.setValueAtTime(i._muted?0:i._volume,i.ctx.currentTime),i.masterGain.connect(i.ctx.destination)),i._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:i,Howl:n}}),typeof e<"u"&&(e.Howler=i,e.Howl=n),typeof global<"u"?(global.HowlerGlobal=t,global.Howler=i,global.Howl=n,global.Sound=r):typeof window<"u"&&(window.HowlerGlobal=t,window.Howler=i,window.Howl=n,window.Sound=r)})(),function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(i){var n=this;if(!n.ctx||!n.ctx.listener)return n;for(var r=n._howls.length-1;r>=0;r--)n._howls[r].stereo(i);return n},HowlerGlobal.prototype.pos=function(i,n,r){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(n=typeof n!="number"?s._pos[1]:n,r=typeof r!="number"?s._pos[2]:r,typeof i=="number")s._pos=[i,n,r],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(i,n,r,s,a,o){var l=this;if(!l.ctx||!l.ctx.listener)return l;var c=l._orientation;if(n=typeof n!="number"?c[1]:n,r=typeof r!="number"?c[2]:r,s=typeof s!="number"?c[3]:s,a=typeof a!="number"?c[4]:a,o=typeof o!="number"?c[5]:o,typeof i=="number")l._orientation=[i,n,r,s,a,o],typeof l.ctx.listener.forwardX<"u"?(l.ctx.listener.forwardX.setTargetAtTime(i,Howler.ctx.currentTime,.1),l.ctx.listener.forwardY.setTargetAtTime(n,Howler.ctx.currentTime,.1),l.ctx.listener.forwardZ.setTargetAtTime(r,Howler.ctx.currentTime,.1),l.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),l.ctx.listener.upY.setTargetAtTime(a,Howler.ctx.currentTime,.1),l.ctx.listener.upZ.setTargetAtTime(o,Howler.ctx.currentTime,.1)):l.ctx.listener.setOrientation(i,n,r,s,a,o);else return c;return l},Howl.prototype.init=function(i){return function(n){var r=this;return r._orientation=n.orientation||[1,0,0],r._stereo=n.stereo||null,r._pos=n.pos||null,r._pannerAttr={coneInnerAngle:typeof n.coneInnerAngle<"u"?n.coneInnerAngle:360,coneOuterAngle:typeof n.coneOuterAngle<"u"?n.coneOuterAngle:360,coneOuterGain:typeof n.coneOuterGain<"u"?n.coneOuterGain:0,distanceModel:typeof n.distanceModel<"u"?n.distanceModel:"inverse",maxDistance:typeof n.maxDistance<"u"?n.maxDistance:1e4,panningModel:typeof n.panningModel<"u"?n.panningModel:"HRTF",refDistance:typeof n.refDistance<"u"?n.refDistance:1,rolloffFactor:typeof n.rolloffFactor<"u"?n.rolloffFactor:1},r._onstereo=n.onstereo?[{fn:n.onstereo}]:[],r._onpos=n.onpos?[{fn:n.onpos}]:[],r._onorientation=n.onorientation?[{fn:n.onorientation}]:[],i.call(this,n)}}(Howl.prototype.init),Howl.prototype.stereo=function(i,n){var r=this;if(!r._webAudio)return r;if(r._state!=="loaded")return r._queue.push({event:"stereo",action:function(){r.stereo(i,n)}}),r;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof n>"u")if(typeof i=="number")r._stereo=i,r._pos=[i,0,0];else return r._stereo;for(var a=r._getSoundIds(n),o=0;o<a.length;o++){var l=r._soundById(a[o]);if(l)if(typeof i=="number")l._stereo=i,l._pos=[i,0,0],l._node&&(l._pannerAttr.panningModel="equalpower",(!l._panner||!l._panner.pan)&&t(l,s),s==="spatial"?typeof l._panner.positionX<"u"?(l._panner.positionX.setValueAtTime(i,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):l._panner.setPosition(i,0,0):l._panner.pan.setValueAtTime(i,Howler.ctx.currentTime)),r._emit("stereo",l._id);else return l._stereo}return r},Howl.prototype.pos=function(i,n,r,s){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"pos",action:function(){a.pos(i,n,r,s)}}),a;if(n=typeof n!="number"?0:n,r=typeof r!="number"?-.5:r,typeof s>"u")if(typeof i=="number")a._pos=[i,n,r];else return a._pos;for(var o=a._getSoundIds(s),l=0;l<o.length;l++){var c=a._soundById(o[l]);if(c)if(typeof i=="number")c._pos=[i,n,r],c._node&&((!c._panner||c._panner.pan)&&t(c,"spatial"),typeof c._panner.positionX<"u"?(c._panner.positionX.setValueAtTime(i,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):c._panner.setPosition(i,n,r)),a._emit("pos",c._id);else return c._pos}return a},Howl.prototype.orientation=function(i,n,r,s){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"orientation",action:function(){a.orientation(i,n,r,s)}}),a;if(n=typeof n!="number"?a._orientation[1]:n,r=typeof r!="number"?a._orientation[2]:r,typeof s>"u")if(typeof i=="number")a._orientation=[i,n,r];else return a._orientation;for(var o=a._getSoundIds(s),l=0;l<o.length;l++){var c=a._soundById(o[l]);if(c)if(typeof i=="number")c._orientation=[i,n,r],c._node&&(c._panner||(c._pos||(c._pos=a._pos||[0,0,-.5]),t(c,"spatial")),typeof c._panner.orientationX<"u"?(c._panner.orientationX.setValueAtTime(i,Howler.ctx.currentTime),c._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),c._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):c._panner.setOrientation(i,n,r)),a._emit("orientation",c._id);else return c._orientation}return a},Howl.prototype.pannerAttr=function(){var i=this,n=arguments,r,s,a;if(!i._webAudio)return i;if(n.length===0)return i._pannerAttr;if(n.length===1)if(typeof n[0]=="object")r=n[0],typeof s>"u"&&(r.pannerAttr||(r.pannerAttr={coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel,maxDistance:r.maxDistance,refDistance:r.refDistance,rolloffFactor:r.rolloffFactor,panningModel:r.panningModel}),i._pannerAttr={coneInnerAngle:typeof r.pannerAttr.coneInnerAngle<"u"?r.pannerAttr.coneInnerAngle:i._coneInnerAngle,coneOuterAngle:typeof r.pannerAttr.coneOuterAngle<"u"?r.pannerAttr.coneOuterAngle:i._coneOuterAngle,coneOuterGain:typeof r.pannerAttr.coneOuterGain<"u"?r.pannerAttr.coneOuterGain:i._coneOuterGain,distanceModel:typeof r.pannerAttr.distanceModel<"u"?r.pannerAttr.distanceModel:i._distanceModel,maxDistance:typeof r.pannerAttr.maxDistance<"u"?r.pannerAttr.maxDistance:i._maxDistance,refDistance:typeof r.pannerAttr.refDistance<"u"?r.pannerAttr.refDistance:i._refDistance,rolloffFactor:typeof r.pannerAttr.rolloffFactor<"u"?r.pannerAttr.rolloffFactor:i._rolloffFactor,panningModel:typeof r.pannerAttr.panningModel<"u"?r.pannerAttr.panningModel:i._panningModel});else return a=i._soundById(parseInt(n[0],10)),a?a._pannerAttr:i._pannerAttr;else n.length===2&&(r=n[0],s=parseInt(n[1],10));for(var o=i._getSoundIds(s),l=0;l<o.length;l++)if(a=i._soundById(o[l]),a){var c=a._pannerAttr;c={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:c.coneInnerAngle,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:c.coneOuterAngle,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:c.coneOuterGain,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:c.distanceModel,maxDistance:typeof r.maxDistance<"u"?r.maxDistance:c.maxDistance,refDistance:typeof r.refDistance<"u"?r.refDistance:c.refDistance,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:c.rolloffFactor,panningModel:typeof r.panningModel<"u"?r.panningModel:c.panningModel};var u=a._panner;u?(u.coneInnerAngle=c.coneInnerAngle,u.coneOuterAngle=c.coneOuterAngle,u.coneOuterGain=c.coneOuterGain,u.distanceModel=c.distanceModel,u.maxDistance=c.maxDistance,u.refDistance=c.refDistance,u.rolloffFactor=c.rolloffFactor,u.panningModel=c.panningModel):(a._pos||(a._pos=i._pos||[0,0,-.5]),t(a,"spatial"))}return i},Sound.prototype.init=function(i){return function(){var n=this,r=n._parent;n._orientation=r._orientation,n._stereo=r._stereo,n._pos=r._pos,n._pannerAttr=r._pannerAttr,i.call(this),n._stereo?r.stereo(n._stereo):n._pos&&r.pos(n._pos[0],n._pos[1],n._pos[2],n._id)}}(Sound.prototype.init),Sound.prototype.reset=function(i){return function(){var n=this,r=n._parent;return n._orientation=r._orientation,n._stereo=r._stereo,n._pos=r._pos,n._pannerAttr=r._pannerAttr,n._stereo?r.stereo(n._stereo):n._pos?r.pos(n._pos[0],n._pos[1],n._pos[2],n._id):n._panner&&(n._panner.disconnect(0),n._panner=void 0,r._refreshBuffer(n)),i.call(this)}}(Sound.prototype.reset);var t=function(i,n){n=n||"spatial",n==="spatial"?(i._panner=Howler.ctx.createPanner(),i._panner.coneInnerAngle=i._pannerAttr.coneInnerAngle,i._panner.coneOuterAngle=i._pannerAttr.coneOuterAngle,i._panner.coneOuterGain=i._pannerAttr.coneOuterGain,i._panner.distanceModel=i._pannerAttr.distanceModel,i._panner.maxDistance=i._pannerAttr.maxDistance,i._panner.refDistance=i._pannerAttr.refDistance,i._panner.rolloffFactor=i._pannerAttr.rolloffFactor,i._panner.panningModel=i._pannerAttr.panningModel,typeof i._panner.positionX<"u"?(i._panner.positionX.setValueAtTime(i._pos[0],Howler.ctx.currentTime),i._panner.positionY.setValueAtTime(i._pos[1],Howler.ctx.currentTime),i._panner.positionZ.setValueAtTime(i._pos[2],Howler.ctx.currentTime)):i._panner.setPosition(i._pos[0],i._pos[1],i._pos[2]),typeof i._panner.orientationX<"u"?(i._panner.orientationX.setValueAtTime(i._orientation[0],Howler.ctx.currentTime),i._panner.orientationY.setValueAtTime(i._orientation[1],Howler.ctx.currentTime),i._panner.orientationZ.setValueAtTime(i._orientation[2],Howler.ctx.currentTime)):i._panner.setOrientation(i._orientation[0],i._orientation[1],i._orientation[2])):(i._panner=Howler.ctx.createStereoPanner(),i._panner.pan.setValueAtTime(i._stereo,Howler.ctx.currentTime)),i._panner.connect(i._node),i._paused||i._parent.pause(i._id,!0).play(i._id,!0)}}()}),aZ=Hp((e,t)=>{t.exports=function(i,n){for(var r=i.split("."),s=n.split("."),a=0;a<3;a++){var o=Number(r[a]),l=Number(s[a]);if(o>l)return 1;if(l>o)return-1;if(!isNaN(o)&&isNaN(l))return 1;if(isNaN(o)&&!isNaN(l))return-1}return 0}}),jp="149",fs={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},oZ=0,F5=1,lZ=2,yE=1,cZ=2,hm=3,ya=0,wn=1,Jr=2,Qi=0,Xd=1,z5=2,k5=3,V5=4,hZ=5,od=100,uZ=101,dZ=102,H5=103,G5=104,pZ=200,fZ=201,mZ=202,gZ=203,xB=204,_B=205,vZ=206,yZ=207,xZ=208,_Z=209,bZ=210,wZ=0,SZ=1,MZ=2,nS=3,CZ=4,EZ=5,AZ=6,TZ=7,bB=0,PZ=1,DZ=2,tl=0,LZ=1,RZ=2,IZ=3,OZ=4,BZ=5,wB=300,Gh=301,jh=302,rS=303,sS=304,eg=306,Zo=1e3,Fi=1001,aS=1002,ai=1003,j5=1004,w_=1005,Lt=1006,NZ=1007,xp=1008,Zn=1009,UZ=1010,FZ=1011,SB=1012,zZ=1013,Ql=1014,es=1015,_p=1016,kZ=1017,VZ=1018,Ah=1020,HZ=1021,Ts=1023,GZ=1024,jZ=1025,Th=1026,Wh=1027,WZ=1028,XZ=1029,MB=1030,qZ=1031,YZ=1033,S_=33776,M_=33777,C_=33778,E_=33779,W5=35840,X5=35841,q5=35842,Y5=35843,ZZ=36196,Z5=37492,Q5=37496,K5=37808,$5=37809,J5=37810,e6=37811,t6=37812,i6=37813,n6=37814,r6=37815,s6=37816,a6=37817,o6=37818,l6=37819,c6=37820,h6=37821,A_=36492,QZ=36283,u6=36284,d6=36285,p6=36286,CB=2200,EB=2201,xE=2202,Py=2300,Dy=2301,T_=2302,Dd=2400,Ld=2401,Ly=2402,_E=2500,KZ=2501,no=3e3,Mt=3001,pl=3200,AB=3201,$Z=0,JZ=1,Fa="srgb",Ry="srgb-linear",P_=7680,eQ=519,oS=35044,f6="300 es",lS=1035,In=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});let i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;let i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;let i=this._listeners[e];if(i!==void 0){let n=i.indexOf(t);n!==-1&&i.splice(n,1)}}dispatchEvent(e){if(this._listeners===void 0)return;let t=this._listeners[e.type];if(t!==void 0){e.target=this;let i=t.slice(0);for(let n=0,r=i.length;n<r;n++)i[n].call(this,e);e.target=null}}},Un=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],m6=1234567,Bm=Math.PI/180,_0=180/Math.PI;function Rs(){let e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Un[e&255]+Un[e>>8&255]+Un[e>>16&255]+Un[e>>24&255]+"-"+Un[t&255]+Un[t>>8&255]+"-"+Un[t>>16&15|64]+Un[t>>24&255]+"-"+Un[i&63|128]+Un[i>>8&255]+"-"+Un[i>>16&255]+Un[i>>24&255]+Un[n&255]+Un[n>>8&255]+Un[n>>16&255]+Un[n>>24&255]).toLowerCase()}function an(e,t,i){return Math.max(t,Math.min(i,e))}function bE(e,t){return(e%t+t)%t}function tQ(e,t,i,n,r){return n+(e-t)*(r-n)/(i-t)}function iQ(e,t,i){return e!==t?(i-e)/(t-e):0}function Nm(e,t,i){return(1-i)*e+i*t}function nQ(e,t,i,n){return Nm(e,t,1-Math.exp(-i*n))}function rQ(e,t=1){return t-Math.abs(bE(e,t*2)-t)}function sQ(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t),e*e*(3-2*e))}function aQ(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t),e*e*e*(e*(e*6-15)+10))}function oQ(e,t){return e+Math.floor(Math.random()*(t-e+1))}function lQ(e,t){return e+Math.random()*(t-e)}function cQ(e){return e*(.5-Math.random())}function hQ(e){e!==void 0&&(m6=e);let t=m6+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function uQ(e){return e*Bm}function dQ(e){return e*_0}function cS(e){return(e&e-1)===0&&e!==0}function TB(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function Iy(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function pQ(e,t,i,n,r){let s=Math.cos,a=Math.sin,o=s(i/2),l=a(i/2),c=s((t+n)/2),u=a((t+n)/2),h=s((t-n)/2),d=a((t-n)/2),p=s((n-t)/2),f=a((n-t)/2);switch(r){case"XYX":e.set(o*u,l*h,l*d,o*c);break;case"YZY":e.set(l*d,o*u,l*h,o*c);break;case"ZXZ":e.set(l*h,l*d,o*u,o*c);break;case"XZX":e.set(o*u,l*f,l*p,o*c);break;case"YXY":e.set(l*p,o*u,l*f,o*c);break;case"ZYZ":e.set(l*f,l*p,o*u,o*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Qo(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function si(e,t){switch(t.constructor){case Float32Array:return e;case Uint16Array:return Math.round(e*65535);case Uint8Array:return Math.round(e*255);case Int16Array:return Math.round(e*32767);case Int8Array:return Math.round(e*127);default:throw new Error("Invalid component type.")}}var Dt=Object.freeze({__proto__:null,DEG2RAD:Bm,RAD2DEG:_0,ceilPowerOfTwo:TB,clamp:an,damp:nQ,degToRad:uQ,denormalize:Qo,euclideanModulo:bE,floorPowerOfTwo:Iy,generateUUID:Rs,inverseLerp:iQ,isPowerOfTwo:cS,lerp:Nm,mapLinear:tQ,normalize:si,pingpong:rQ,radToDeg:dQ,randFloat:lQ,randFloatSpread:cQ,randInt:oQ,seededRandom:hQ,setQuaternionFromProperEuler:pQ,smootherstep:aQ,smoothstep:sQ}),te=class{constructor(e=0,t=0){te.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,i=this.y,n=e.elements;return this.x=n[0]*t+n[3]*i+n[6],this.y=n[1]*t+n[4]*i+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let i=Math.cos(t),n=Math.sin(t),r=this.x-e.x,s=this.y-e.y;return this.x=r*i-s*n+e.x,this.y=r*n+s*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},Sn=class{constructor(){Sn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,i,n,r,s,a,o,l){let c=this.elements;return c[0]=e,c[1]=n,c[2]=a,c[3]=t,c[4]=r,c[5]=o,c[6]=i,c[7]=s,c[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let i=e.elements,n=t.elements,r=this.elements,s=i[0],a=i[3],o=i[6],l=i[1],c=i[4],u=i[7],h=i[2],d=i[5],p=i[8],f=n[0],v=n[3],m=n[6],g=n[1],y=n[4],x=n[7],_=n[2],b=n[5],w=n[8];return r[0]=s*f+a*g+o*_,r[3]=s*v+a*y+o*b,r[6]=s*m+a*x+o*w,r[1]=l*f+c*g+u*_,r[4]=l*v+c*y+u*b,r[7]=l*m+c*x+u*w,r[2]=h*f+d*g+p*_,r[5]=h*v+d*y+p*b,r[8]=h*m+d*x+p*w,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8];return t*s*c-t*a*l-i*r*c+i*a*o+n*r*l-n*s*o}invert(){let e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],u=c*s-a*l,h=a*o-c*r,d=l*r-s*o,p=t*u+i*h+n*d;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);let f=1/p;return e[0]=u*f,e[1]=(n*l-c*i)*f,e[2]=(a*i-n*s)*f,e[3]=h*f,e[4]=(c*t-n*o)*f,e[5]=(n*r-a*t)*f,e[6]=d*f,e[7]=(i*o-l*t)*f,e[8]=(s*t-i*r)*f,this}transpose(){let e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,n,r,s,a){let o=Math.cos(r),l=Math.sin(r);return this.set(i*o,i*l,-i*(o*s+l*a)+s+e,-n*l,n*o,-n*(-l*s+o*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(D_.makeScale(e,t)),this}rotate(e){return this.premultiply(D_.makeRotation(-e)),this}translate(e,t){return this.premultiply(D_.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,i=e.elements;for(let n=0;n<9;n++)if(t[n]!==i[n])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){let i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}},D_=new Sn;function PB(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}var fQ={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Fg(e,t){return new fQ[e](t)}function Oy(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function Ph(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function Fv(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}var L_={[Fa]:{[Ry]:Ph},[Ry]:{[Fa]:Fv}},Qn={legacyMode:!0,get workingColorSpace(){return Ry},set workingColorSpace(e){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,i){if(this.legacyMode||t===i||!t||!i)return e;if(L_[t]&&L_[t][i]!==void 0){let n=L_[t][i];return e.r=n(e.r),e.g=n(e.g),e.b=n(e.b),e}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}},DB={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},$i={r:0,g:0,b:0},Vs={h:0,s:0,l:0},zg={h:0,s:0,l:0};function R_(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*6*(2/3-i):e}function kg(e,t){return t.r=e.r,t.g=e.g,t.b=e.b,t}var ut=class{constructor(t,i,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,i===void 0&&n===void 0?this.set(t):this.setRGB(t,i,n)}set(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,i=Fa){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,Qn.toWorkingColorSpace(this,i),this}setRGB(t,i,n,r=Qn.workingColorSpace){return this.r=t,this.g=i,this.b=n,Qn.toWorkingColorSpace(this,r),this}setHSL(t,i,n,r=Qn.workingColorSpace){if(t=bE(t,1),i=an(i,0,1),n=an(n,0,1),i===0)this.r=this.g=this.b=n;else{let s=n<=.5?n*(1+i):n+i-n*i,a=2*n-s;this.r=R_(a,s,t+1/3),this.g=R_(a,s,t),this.b=R_(a,s,t-1/3)}return Qn.toWorkingColorSpace(this,r),this}setStyle(t,i=Fa){function n(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let s,a=r[1],o=r[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,Qn.toWorkingColorSpace(this,i),n(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,Qn.toWorkingColorSpace(this,i),n(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){let l=parseFloat(s[1])/360,c=parseFloat(s[2])/100,u=parseFloat(s[3])/100;return n(s[4]),this.setHSL(l,c,u,i)}break}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(t)){let s=r[1],a=s.length;if(a===3)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,Qn.toWorkingColorSpace(this,i),this;if(a===6)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,Qn.toWorkingColorSpace(this,i),this}return t&&t.length>0?this.setColorName(t,i):this}setColorName(t,i=Fa){let n=DB[t.toLowerCase()];return n!==void 0?this.setHex(n,i):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Ph(t.r),this.g=Ph(t.g),this.b=Ph(t.b),this}copyLinearToSRGB(t){return this.r=Fv(t.r),this.g=Fv(t.g),this.b=Fv(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Fa){return Qn.fromWorkingColorSpace(kg(this,$i),t),an($i.r*255,0,255)<<16^an($i.g*255,0,255)<<8^an($i.b*255,0,255)<<0}getHexString(t=Fa){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,i=Qn.workingColorSpace){Qn.fromWorkingColorSpace(kg(this,$i),i);let n=$i.r,r=$i.g,s=$i.b,a=Math.max(n,r,s),o=Math.min(n,r,s),l,c,u=(o+a)/2;if(o===a)l=0,c=0;else{let h=a-o;switch(c=u<=.5?h/(a+o):h/(2-a-o),a){case n:l=(r-s)/h+(r<s?6:0);break;case r:l=(s-n)/h+2;break;case s:l=(n-r)/h+4;break}l/=6}return t.h=l,t.s=c,t.l=u,t}getRGB(t,i=Qn.workingColorSpace){return Qn.fromWorkingColorSpace(kg(this,$i),i),t.r=$i.r,t.g=$i.g,t.b=$i.b,t}getStyle(t=Fa){return Qn.fromWorkingColorSpace(kg(this,$i),t),t!==Fa?`color(${t} ${$i.r} ${$i.g} ${$i.b})`:`rgb(${$i.r*255|0},${$i.g*255|0},${$i.b*255|0})`}offsetHSL(t,i,n){return this.getHSL(Vs),Vs.h+=t,Vs.s+=i,Vs.l+=n,this.setHSL(Vs.h,Vs.s,Vs.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,i){return this.r=t.r+i.r,this.g=t.g+i.g,this.b=t.b+i.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,i){return this.r+=(t.r-this.r)*i,this.g+=(t.g-this.g)*i,this.b+=(t.b-this.b)*i,this}lerpColors(t,i,n){return this.r=t.r+(i.r-t.r)*n,this.g=t.g+(i.g-t.g)*n,this.b=t.b+(i.b-t.b)*n,this}lerpHSL(t,i){this.getHSL(Vs),t.getHSL(zg);let n=Nm(Vs.h,zg.h,i),r=Nm(Vs.s,zg.s,i),s=Nm(Vs.l,zg.l,i);return this.setHSL(n,r,s),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,i=0){return this.r=t[i],this.g=t[i+1],this.b=t[i+2],this}toArray(t=[],i=0){return t[i]=this.r,t[i+1]=this.g,t[i+2]=this.b,t}fromBufferAttribute(t,i){return this.r=t.getX(i),this.g=t.getY(i),this.b=t.getZ(i),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};ut.NAMES=DB;var uu,LB=class{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{uu===void 0&&(uu=Oy("canvas")),uu.width=e.width,uu.height=e.height;let i=uu.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=uu}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){let t=Oy("canvas");t.width=e.width,t.height=e.height;let i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);let n=i.getImageData(0,0,e.width,e.height),r=n.data;for(let s=0;s<r.length;s++)r[s]=Ph(r[s]/255)*255;return i.putImageData(n,0,0),t}else if(e.data){let t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(Ph(t[i]/255)*255):t[i]=Ph(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}},RB=class{constructor(e=null){this.isSource=!0,this.uuid=Rs(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];let i={uuid:this.uuid,url:""},n=this.data;if(n!==null){let r;if(Array.isArray(n)){r=[];for(let s=0,a=n.length;s<a;s++)n[s].isDataTexture?r.push(I_(n[s].image)):r.push(I_(n[s]))}else r=I_(n);i.url=r}return t||(e.images[this.uuid]=i),i}};function I_(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?LB.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var mQ=0,ln=class extends In{constructor(e=ln.DEFAULT_IMAGE,t=ln.DEFAULT_MAPPING,i=Fi,n=Fi,r=Lt,s=xp,a=Ts,o=Zn,l=ln.DEFAULT_ANISOTROPY,c=no){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:mQ++}),this.uuid=Rs(),this.name="",this.source=new RB(e),this.mipmaps=[],this.mapping=t,this.wrapS=i,this.wrapT=n,this.magFilter=r,this.minFilter=s,this.anisotropy=l,this.format=a,this.internalFormat=null,this.type=o,this.offset=new te(0,0),this.repeat=new te(1,1),this.center=new te(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Sn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];let i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==wB)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Zo:e.x=e.x-Math.floor(e.x);break;case Fi:e.x=e.x<0?0:1;break;case aS:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Zo:e.y=e.y-Math.floor(e.y);break;case Fi:e.y=e.y<0?0:1;break;case aS:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}};ln.DEFAULT_IMAGE=null;ln.DEFAULT_MAPPING=wB;ln.DEFAULT_ANISOTROPY=1;var Ct=class{constructor(e=0,t=0,i=0,n=1){Ct.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,n){return this.x=e,this.y=t,this.z=i,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,i=this.y,n=this.z,r=this.w,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*n+s[12]*r,this.y=s[1]*t+s[5]*i+s[9]*n+s[13]*r,this.z=s[2]*t+s[6]*i+s[10]*n+s[14]*r,this.w=s[3]*t+s[7]*i+s[11]*n+s[15]*r,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,n,r,s=e.elements,a=s[0],o=s[4],l=s[8],c=s[1],u=s[5],h=s[9],d=s[2],p=s[6],f=s[10];if(Math.abs(o-c)<.01&&Math.abs(l-d)<.01&&Math.abs(h-p)<.01){if(Math.abs(o+c)<.1&&Math.abs(l+d)<.1&&Math.abs(h+p)<.1&&Math.abs(a+u+f-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;let m=(a+1)/2,g=(u+1)/2,y=(f+1)/2,x=(o+c)/4,_=(l+d)/4,b=(h+p)/4;return m>g&&m>y?m<.01?(i=0,n=.707106781,r=.707106781):(i=Math.sqrt(m),n=x/i,r=_/i):g>y?g<.01?(i=.707106781,n=0,r=.707106781):(n=Math.sqrt(g),i=x/n,r=b/n):y<.01?(i=.707106781,n=.707106781,r=0):(r=Math.sqrt(y),i=_/r,n=b/r),this.set(i,n,r,t),this}let v=Math.sqrt((p-h)*(p-h)+(l-d)*(l-d)+(c-o)*(c-o));return Math.abs(v)<.001&&(v=1),this.x=(p-h)/v,this.y=(l-d)/v,this.z=(c-o)/v,this.w=Math.acos((a+u+f-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},Qt=class extends In{constructor(e=1,t=1,i={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new Ct(0,0,e,t),this.scissorTest=!1,this.viewport=new Ct(0,0,e,t);let n={width:e,height:t,depth:1};this.texture=new ln(n,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.internalFormat=i.internalFormat!==void 0?i.internalFormat:null,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:Lt,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!1,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null,this.samples=i.samples!==void 0?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new RB(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},IB=class extends ln{constructor(e=null,t=1,i=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:n},this.magFilter=ai,this.minFilter=ai,this.wrapR=Fi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},gQ=class extends ln{constructor(e=null,t=1,i=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:n},this.magFilter=ai,this.minFilter=ai,this.wrapR=Fi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},vQ=class extends Qt{constructor(e=1,t=1,i=1,n={}){super(e,t,n),this.isWebGLMultipleRenderTargets=!0;let r=this.texture;this.texture=[];for(let s=0;s<i;s++)this.texture[s]=r.clone(),this.texture[s].isRenderTargetTexture=!0}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let n=0,r=this.texture.length;n<r;n++)this.texture[n].image.width=e,this.texture[n].image.height=t,this.texture[n].image.depth=i;this.dispose()}return this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,i=e.texture.length;t<i;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}},At=class{constructor(e=0,t=0,i=0,n=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=n}static slerpFlat(e,t,i,n,r,s,a){let o=i[n+0],l=i[n+1],c=i[n+2],u=i[n+3],h=r[s+0],d=r[s+1],p=r[s+2],f=r[s+3];if(a===0){e[t+0]=o,e[t+1]=l,e[t+2]=c,e[t+3]=u;return}if(a===1){e[t+0]=h,e[t+1]=d,e[t+2]=p,e[t+3]=f;return}if(u!==f||o!==h||l!==d||c!==p){let v=1-a,m=o*h+l*d+c*p+u*f,g=m>=0?1:-1,y=1-m*m;if(y>Number.EPSILON){let _=Math.sqrt(y),b=Math.atan2(_,m*g);v=Math.sin(v*b)/_,a=Math.sin(a*b)/_}let x=a*g;if(o=o*v+h*x,l=l*v+d*x,c=c*v+p*x,u=u*v+f*x,v===1-a){let _=1/Math.sqrt(o*o+l*l+c*c+u*u);o*=_,l*=_,c*=_,u*=_}}e[t]=o,e[t+1]=l,e[t+2]=c,e[t+3]=u}static multiplyQuaternionsFlat(e,t,i,n,r,s){let a=i[n],o=i[n+1],l=i[n+2],c=i[n+3],u=r[s],h=r[s+1],d=r[s+2],p=r[s+3];return e[t]=a*p+c*u+o*d-l*h,e[t+1]=o*p+c*h+l*u-a*d,e[t+2]=l*p+c*d+a*h-o*u,e[t+3]=c*p-a*u-o*h-l*d,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,n){return this._x=e,this._y=t,this._z=i,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){let i=e._x,n=e._y,r=e._z,s=e._order,a=Math.cos,o=Math.sin,l=a(i/2),c=a(n/2),u=a(r/2),h=o(i/2),d=o(n/2),p=o(r/2);switch(s){case"XYZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"YXZ":this._x=h*c*u+l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"ZXY":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u-h*d*p;break;case"ZYX":this._x=h*c*u-l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u+h*d*p;break;case"YZX":this._x=h*c*u+l*d*p,this._y=l*d*u+h*c*p,this._z=l*c*p-h*d*u,this._w=l*c*u-h*d*p;break;case"XZY":this._x=h*c*u-l*d*p,this._y=l*d*u-h*c*p,this._z=l*c*p+h*d*u,this._w=l*c*u+h*d*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let i=t/2,n=Math.sin(i);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,i=t[0],n=t[4],r=t[8],s=t[1],a=t[5],o=t[9],l=t[2],c=t[6],u=t[10],h=i+a+u;if(h>0){let d=.5/Math.sqrt(h+1);this._w=.25/d,this._x=(c-o)*d,this._y=(r-l)*d,this._z=(s-n)*d}else if(i>a&&i>u){let d=2*Math.sqrt(1+i-a-u);this._w=(c-o)/d,this._x=.25*d,this._y=(n+s)/d,this._z=(r+l)/d}else if(a>u){let d=2*Math.sqrt(1+a-i-u);this._w=(r-l)/d,this._x=(n+s)/d,this._y=.25*d,this._z=(o+c)/d}else{let d=2*Math.sqrt(1+u-i-a);this._w=(s-n)/d,this._x=(r+l)/d,this._y=(o+c)/d,this._z=.25*d}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(an(this.dot(e),-1,1)))}rotateTowards(e,t){let i=this.angleTo(e);if(i===0)return this;let n=Math.min(1,t/i);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let i=e._x,n=e._y,r=e._z,s=e._w,a=t._x,o=t._y,l=t._z,c=t._w;return this._x=i*c+s*a+n*l-r*o,this._y=n*c+s*o+r*a-i*l,this._z=r*c+s*l+i*o-n*a,this._w=s*c-i*a-n*o-r*l,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);let i=this._x,n=this._y,r=this._z,s=this._w,a=s*e._w+i*e._x+n*e._y+r*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=s,this._x=i,this._y=n,this._z=r,this;let o=1-a*a;if(o<=Number.EPSILON){let d=1-t;return this._w=d*s+t*this._w,this._x=d*i+t*this._x,this._y=d*n+t*this._y,this._z=d*r+t*this._z,this.normalize(),this._onChangeCallback(),this}let l=Math.sqrt(o),c=Math.atan2(l,a),u=Math.sin((1-t)*c)/l,h=Math.sin(t*c)/l;return this._w=s*u+this._w*h,this._x=i*u+this._x*h,this._y=n*u+this._y*h,this._z=r*u+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){let e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),n=2*Math.PI*Math.random(),r=2*Math.PI*Math.random();return this.set(t*Math.cos(n),i*Math.sin(r),i*Math.cos(r),t*Math.sin(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},T=class{constructor(e=0,t=0,i=0){T.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(g6.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(g6.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6]*n,this.y=r[1]*t+r[4]*i+r[7]*n,this.z=r[2]*t+r[5]*i+r[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,i=this.y,n=this.z,r=e.elements,s=1/(r[3]*t+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*t+r[4]*i+r[8]*n+r[12])*s,this.y=(r[1]*t+r[5]*i+r[9]*n+r[13])*s,this.z=(r[2]*t+r[6]*i+r[10]*n+r[14])*s,this}applyQuaternion(e){let t=this.x,i=this.y,n=this.z,r=e.x,s=e.y,a=e.z,o=e.w,l=o*t+s*n-a*i,c=o*i+a*t-r*n,u=o*n+r*i-s*t,h=-r*t-s*i-a*n;return this.x=l*o+h*-r+c*-a-u*-s,this.y=c*o+h*-s+u*-r-l*-a,this.z=u*o+h*-a+l*-s-c*-r,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,i=this.y,n=this.z,r=e.elements;return this.x=r[0]*t+r[4]*i+r[8]*n,this.y=r[1]*t+r[5]*i+r[9]*n,this.z=r[2]*t+r[6]*i+r[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let i=e.x,n=e.y,r=e.z,s=t.x,a=t.y,o=t.z;return this.x=n*o-r*a,this.y=r*s-i*o,this.z=i*a-n*s,this}projectOnVector(e){let t=e.lengthSq();if(t===0)return this.set(0,0,0);let i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return O_.copy(this).projectOnVector(e),this.sub(O_)}reflect(e){return this.sub(O_.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;let i=this.dot(e)/t;return Math.acos(an(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,i=this.y-e.y,n=this.z-e.z;return t*t+i*i+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){let n=Math.sin(t)*e;return this.x=n*Math.sin(i),this.y=Math.cos(t)*e,this.z=n*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},O_=new T,g6=new At,Vi=class{constructor(e=new T(1/0,1/0,1/0),t=new T(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,i=1/0,n=1/0,r=-1/0,s=-1/0,a=-1/0;for(let o=0,l=e.length;o<l;o+=3){let c=e[o],u=e[o+1],h=e[o+2];c<t&&(t=c),u<i&&(i=u),h<n&&(n=h),c>r&&(r=c),u>s&&(s=u),h>a&&(a=h)}return this.min.set(t,i,n),this.max.set(r,s,a),this}setFromBufferAttribute(e){let t=1/0,i=1/0,n=1/0,r=-1/0,s=-1/0,a=-1/0;for(let o=0,l=e.count;o<l;o++){let c=e.getX(o),u=e.getY(o),h=e.getZ(o);c<t&&(t=c),u<i&&(i=u),h<n&&(n=h),c>r&&(r=c),u>s&&(s=u),h>a&&(a=h)}return this.min.set(t,i,n),this.max.set(r,s,a),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let i=Hc.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);let i=e.geometry;if(i!==void 0)if(t&&i.attributes!=null&&i.attributes.position!==void 0){let r=i.attributes.position;for(let s=0,a=r.count;s<a;s++)Hc.fromBufferAttribute(r,s).applyMatrix4(e.matrixWorld),this.expandByPoint(Hc)}else i.boundingBox===null&&i.computeBoundingBox(),B_.copy(i.boundingBox),B_.applyMatrix4(e.matrixWorld),this.union(B_);let n=e.children;for(let r=0,s=n.length;r<s;r++)this.expandByObject(n[r],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Hc),Hc.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Sf),Vg.subVectors(this.max,Sf),du.subVectors(e.a,Sf),pu.subVectors(e.b,Sf),fu.subVectors(e.c,Sf),vl.subVectors(pu,du),yl.subVectors(fu,pu),Gc.subVectors(du,fu);let t=[0,-vl.z,vl.y,0,-yl.z,yl.y,0,-Gc.z,Gc.y,vl.z,0,-vl.x,yl.z,0,-yl.x,Gc.z,0,-Gc.x,-vl.y,vl.x,0,-yl.y,yl.x,0,-Gc.y,Gc.x,0];return!N_(t,du,pu,fu,Vg)||(t=[1,0,0,0,1,0,0,0,1],!N_(t,du,pu,fu,Vg))?!1:(Hg.crossVectors(vl,yl),t=[Hg.x,Hg.y,Hg.z],N_(t,du,pu,fu,Vg))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Hc.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(Hc).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(mo[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),mo[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),mo[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),mo[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),mo[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),mo[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),mo[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),mo[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(mo),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},mo=[new T,new T,new T,new T,new T,new T,new T,new T],Hc=new T,B_=new Vi,du=new T,pu=new T,fu=new T,vl=new T,yl=new T,Gc=new T,Sf=new T,Vg=new T,Hg=new T,jc=new T;function N_(e,t,i,n,r){for(let s=0,a=e.length-3;s<=a;s+=3){jc.fromArray(e,s);let o=r.x*Math.abs(jc.x)+r.y*Math.abs(jc.y)+r.z*Math.abs(jc.z),l=t.dot(jc),c=i.dot(jc),u=n.dot(jc);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>o)return!1}return!0}var yQ=new Vi,Mf=new T,U_=new T,ls=class{constructor(e=new T,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let i=this.center;t!==void 0?i.copy(t):yQ.setFromPoints(e).getCenter(i);let n=0;for(let r=0,s=e.length;r<s;r++)n=Math.max(n,i.distanceToSquared(e[r]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Mf.subVectors(e,this.center);let t=Mf.lengthSq();if(t>this.radius*this.radius){let i=Math.sqrt(t),n=(i-this.radius)*.5;this.center.addScaledVector(Mf,n/i),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(U_.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Mf.copy(e.center).add(U_)),this.expandByPoint(Mf.copy(e.center).sub(U_))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},go=new T,F_=new T,Gg=new T,xl=new T,z_=new T,jg=new T,k_=new T,Wp=class{constructor(e=new T,t=new T(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,go)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=go.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(go.copy(this.direction).multiplyScalar(t).add(this.origin),go.distanceToSquared(e))}distanceSqToSegment(e,t,i,n){F_.copy(e).add(t).multiplyScalar(.5),Gg.copy(t).sub(e).normalize(),xl.copy(this.origin).sub(F_);let r=e.distanceTo(t)*.5,s=-this.direction.dot(Gg),a=xl.dot(this.direction),o=-xl.dot(Gg),l=xl.lengthSq(),c=Math.abs(1-s*s),u,h,d,p;if(c>0)if(u=s*o-a,h=s*a-o,p=r*c,u>=0)if(h>=-p)if(h<=p){let f=1/c;u*=f,h*=f,d=u*(u+s*h+2*a)+h*(s*u+h+2*o)+l}else h=r,u=Math.max(0,-(s*h+a)),d=-u*u+h*(h+2*o)+l;else h=-r,u=Math.max(0,-(s*h+a)),d=-u*u+h*(h+2*o)+l;else h<=-p?(u=Math.max(0,-(-s*r+a)),h=u>0?-r:Math.min(Math.max(-r,-o),r),d=-u*u+h*(h+2*o)+l):h<=p?(u=0,h=Math.min(Math.max(-r,-o),r),d=h*(h+2*o)+l):(u=Math.max(0,-(s*r+a)),h=u>0?r:Math.min(Math.max(-r,-o),r),d=-u*u+h*(h+2*o)+l);else h=s>0?-r:r,u=Math.max(0,-(s*h+a)),d=-u*u+h*(h+2*o)+l;return i&&i.copy(this.direction).multiplyScalar(u).add(this.origin),n&&n.copy(Gg).multiplyScalar(h).add(F_),d}intersectSphere(e,t){go.subVectors(e.center,this.origin);let i=go.dot(this.direction),n=go.dot(go)-i*i,r=e.radius*e.radius;if(n>r)return null;let s=Math.sqrt(r-n),a=i-s,o=i+s;return a<0&&o<0?null:a<0?this.at(o,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;let i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){let i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,n,r,s,a,o,l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(i=(e.min.x-h.x)*l,n=(e.max.x-h.x)*l):(i=(e.max.x-h.x)*l,n=(e.min.x-h.x)*l),c>=0?(r=(e.min.y-h.y)*c,s=(e.max.y-h.y)*c):(r=(e.max.y-h.y)*c,s=(e.min.y-h.y)*c),i>s||r>n||((r>i||isNaN(i))&&(i=r),(s<n||isNaN(n))&&(n=s),u>=0?(a=(e.min.z-h.z)*u,o=(e.max.z-h.z)*u):(a=(e.max.z-h.z)*u,o=(e.min.z-h.z)*u),i>o||a>n)||((a>i||i!==i)&&(i=a),(o<n||n!==n)&&(n=o),n<0)?null:this.at(i>=0?i:n,t)}intersectsBox(e){return this.intersectBox(e,go)!==null}intersectTriangle(e,t,i,n,r){z_.subVectors(t,e),jg.subVectors(i,e),k_.crossVectors(z_,jg);let s=this.direction.dot(k_),a;if(s>0){if(n)return null;a=1}else if(s<0)a=-1,s=-s;else return null;xl.subVectors(this.origin,e);let o=a*this.direction.dot(jg.crossVectors(xl,jg));if(o<0)return null;let l=a*this.direction.dot(z_.cross(xl));if(l<0||o+l>s)return null;let c=-a*xl.dot(k_);return c<0?null:this.at(c/s,r)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},ke=class{constructor(){ke.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,i,n,r,s,a,o,l,c,u,h,d,p,f,v){let m=this.elements;return m[0]=e,m[4]=t,m[8]=i,m[12]=n,m[1]=r,m[5]=s,m[9]=a,m[13]=o,m[2]=l,m[6]=c,m[10]=u,m[14]=h,m[3]=d,m[7]=p,m[11]=f,m[15]=v,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new ke().fromArray(this.elements)}copy(e){let t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){let t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,i=e.elements,n=1/mu.setFromMatrixColumn(e,0).length(),r=1/mu.setFromMatrixColumn(e,1).length(),s=1/mu.setFromMatrixColumn(e,2).length();return t[0]=i[0]*n,t[1]=i[1]*n,t[2]=i[2]*n,t[3]=0,t[4]=i[4]*r,t[5]=i[5]*r,t[6]=i[6]*r,t[7]=0,t[8]=i[8]*s,t[9]=i[9]*s,t[10]=i[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,i=e.x,n=e.y,r=e.z,s=Math.cos(i),a=Math.sin(i),o=Math.cos(n),l=Math.sin(n),c=Math.cos(r),u=Math.sin(r);if(e.order==="XYZ"){let h=s*c,d=s*u,p=a*c,f=a*u;t[0]=o*c,t[4]=-o*u,t[8]=l,t[1]=d+p*l,t[5]=h-f*l,t[9]=-a*o,t[2]=f-h*l,t[6]=p+d*l,t[10]=s*o}else if(e.order==="YXZ"){let h=o*c,d=o*u,p=l*c,f=l*u;t[0]=h+f*a,t[4]=p*a-d,t[8]=s*l,t[1]=s*u,t[5]=s*c,t[9]=-a,t[2]=d*a-p,t[6]=f+h*a,t[10]=s*o}else if(e.order==="ZXY"){let h=o*c,d=o*u,p=l*c,f=l*u;t[0]=h-f*a,t[4]=-s*u,t[8]=p+d*a,t[1]=d+p*a,t[5]=s*c,t[9]=f-h*a,t[2]=-s*l,t[6]=a,t[10]=s*o}else if(e.order==="ZYX"){let h=s*c,d=s*u,p=a*c,f=a*u;t[0]=o*c,t[4]=p*l-d,t[8]=h*l+f,t[1]=o*u,t[5]=f*l+h,t[9]=d*l-p,t[2]=-l,t[6]=a*o,t[10]=s*o}else if(e.order==="YZX"){let h=s*o,d=s*l,p=a*o,f=a*l;t[0]=o*c,t[4]=f-h*u,t[8]=p*u+d,t[1]=u,t[5]=s*c,t[9]=-a*c,t[2]=-l*c,t[6]=d*u+p,t[10]=h-f*u}else if(e.order==="XZY"){let h=s*o,d=s*l,p=a*o,f=a*l;t[0]=o*c,t[4]=-u,t[8]=l*c,t[1]=h*u+f,t[5]=s*c,t[9]=d*u-p,t[2]=p*u-d,t[6]=a*c,t[10]=f*u+h}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(xQ,e,_Q)}lookAt(e,t,i){let n=this.elements;return Gr.subVectors(e,t),Gr.lengthSq()===0&&(Gr.z=1),Gr.normalize(),_l.crossVectors(i,Gr),_l.lengthSq()===0&&(Math.abs(i.z)===1?Gr.x+=1e-4:Gr.z+=1e-4,Gr.normalize(),_l.crossVectors(i,Gr)),_l.normalize(),Wg.crossVectors(Gr,_l),n[0]=_l.x,n[4]=Wg.x,n[8]=Gr.x,n[1]=_l.y,n[5]=Wg.y,n[9]=Gr.y,n[2]=_l.z,n[6]=Wg.z,n[10]=Gr.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let i=e.elements,n=t.elements,r=this.elements,s=i[0],a=i[4],o=i[8],l=i[12],c=i[1],u=i[5],h=i[9],d=i[13],p=i[2],f=i[6],v=i[10],m=i[14],g=i[3],y=i[7],x=i[11],_=i[15],b=n[0],w=n[4],M=n[8],S=n[12],C=n[1],E=n[5],P=n[9],I=n[13],D=n[2],L=n[6],B=n[10],j=n[14],z=n[3],O=n[7],H=n[11],k=n[15];return r[0]=s*b+a*C+o*D+l*z,r[4]=s*w+a*E+o*L+l*O,r[8]=s*M+a*P+o*B+l*H,r[12]=s*S+a*I+o*j+l*k,r[1]=c*b+u*C+h*D+d*z,r[5]=c*w+u*E+h*L+d*O,r[9]=c*M+u*P+h*B+d*H,r[13]=c*S+u*I+h*j+d*k,r[2]=p*b+f*C+v*D+m*z,r[6]=p*w+f*E+v*L+m*O,r[10]=p*M+f*P+v*B+m*H,r[14]=p*S+f*I+v*j+m*k,r[3]=g*b+y*C+x*D+_*z,r[7]=g*w+y*E+x*L+_*O,r[11]=g*M+y*P+x*B+_*H,r[15]=g*S+y*I+x*j+_*k,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],i=e[4],n=e[8],r=e[12],s=e[1],a=e[5],o=e[9],l=e[13],c=e[2],u=e[6],h=e[10],d=e[14],p=e[3],f=e[7],v=e[11],m=e[15];return p*(+r*o*u-n*l*u-r*a*h+i*l*h+n*a*d-i*o*d)+f*(+t*o*d-t*l*h+r*s*h-n*s*d+n*l*c-r*o*c)+v*(+t*l*u-t*a*d-r*s*u+i*s*d+r*a*c-i*l*c)+m*(-n*a*c-t*o*u+t*a*h+n*s*u-i*s*h+i*o*c)}transpose(){let e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){let n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=i),this}invert(){let e=this.elements,t=e[0],i=e[1],n=e[2],r=e[3],s=e[4],a=e[5],o=e[6],l=e[7],c=e[8],u=e[9],h=e[10],d=e[11],p=e[12],f=e[13],v=e[14],m=e[15],g=u*v*l-f*h*l+f*o*d-a*v*d-u*o*m+a*h*m,y=p*h*l-c*v*l-p*o*d+s*v*d+c*o*m-s*h*m,x=c*f*l-p*u*l+p*a*d-s*f*d-c*a*m+s*u*m,_=p*u*o-c*f*o-p*a*h+s*f*h+c*a*v-s*u*v,b=t*g+i*y+n*x+r*_;if(b===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let w=1/b;return e[0]=g*w,e[1]=(f*h*r-u*v*r-f*n*d+i*v*d+u*n*m-i*h*m)*w,e[2]=(a*v*r-f*o*r+f*n*l-i*v*l-a*n*m+i*o*m)*w,e[3]=(u*o*r-a*h*r-u*n*l+i*h*l+a*n*d-i*o*d)*w,e[4]=y*w,e[5]=(c*v*r-p*h*r+p*n*d-t*v*d-c*n*m+t*h*m)*w,e[6]=(p*o*r-s*v*r-p*n*l+t*v*l+s*n*m-t*o*m)*w,e[7]=(s*h*r-c*o*r+c*n*l-t*h*l-s*n*d+t*o*d)*w,e[8]=x*w,e[9]=(p*u*r-c*f*r-p*i*d+t*f*d+c*i*m-t*u*m)*w,e[10]=(s*f*r-p*a*r+p*i*l-t*f*l-s*i*m+t*a*m)*w,e[11]=(c*a*r-s*u*r-c*i*l+t*u*l+s*i*d-t*a*d)*w,e[12]=_*w,e[13]=(c*f*n-p*u*n+p*i*h-t*f*h-c*i*v+t*u*v)*w,e[14]=(p*a*n-s*f*n-p*i*o+t*f*o+s*i*v-t*a*v)*w,e[15]=(s*u*n-c*a*n+c*i*o-t*u*o-s*i*h+t*a*h)*w,this}scale(e){let t=this.elements,i=e.x,n=e.y,r=e.z;return t[0]*=i,t[4]*=n,t[8]*=r,t[1]*=i,t[5]*=n,t[9]*=r,t[2]*=i,t[6]*=n,t[10]*=r,t[3]*=i,t[7]*=n,t[11]*=r,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,n))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let i=Math.cos(t),n=Math.sin(t),r=1-i,s=e.x,a=e.y,o=e.z,l=r*s,c=r*a;return this.set(l*s+i,l*a-n*o,l*o+n*a,0,l*a+n*o,c*a+i,c*o-n*s,0,l*o-n*a,c*o+n*s,r*o*o+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,n,r,s){return this.set(1,i,r,0,e,1,s,0,t,n,1,0,0,0,0,1),this}compose(e,t,i){let n=this.elements,r=t._x,s=t._y,a=t._z,o=t._w,l=r+r,c=s+s,u=a+a,h=r*l,d=r*c,p=r*u,f=s*c,v=s*u,m=a*u,g=o*l,y=o*c,x=o*u,_=i.x,b=i.y,w=i.z;return n[0]=(1-(f+m))*_,n[1]=(d+x)*_,n[2]=(p-y)*_,n[3]=0,n[4]=(d-x)*b,n[5]=(1-(h+m))*b,n[6]=(v+g)*b,n[7]=0,n[8]=(p+y)*w,n[9]=(v-g)*w,n[10]=(1-(h+f))*w,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,i){let n=this.elements,r=mu.set(n[0],n[1],n[2]).length(),s=mu.set(n[4],n[5],n[6]).length(),a=mu.set(n[8],n[9],n[10]).length();this.determinant()<0&&(r=-r),e.x=n[12],e.y=n[13],e.z=n[14],Hs.copy(this);let o=1/r,l=1/s,c=1/a;return Hs.elements[0]*=o,Hs.elements[1]*=o,Hs.elements[2]*=o,Hs.elements[4]*=l,Hs.elements[5]*=l,Hs.elements[6]*=l,Hs.elements[8]*=c,Hs.elements[9]*=c,Hs.elements[10]*=c,t.setFromRotationMatrix(Hs),i.x=r,i.y=s,i.z=a,this}makePerspective(e,t,i,n,r,s){let a=this.elements,o=2*r/(t-e),l=2*r/(i-n),c=(t+e)/(t-e),u=(i+n)/(i-n),h=-(s+r)/(s-r),d=-2*s*r/(s-r);return a[0]=o,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=l,a[9]=u,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=d,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}makeOrthographic(e,t,i,n,r,s){let a=this.elements,o=1/(t-e),l=1/(i-n),c=1/(s-r),u=(t+e)*o,h=(i+n)*l,d=(s+r)*c;return a[0]=2*o,a[4]=0,a[8]=0,a[12]=-u,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-d,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}equals(e){let t=this.elements,i=e.elements;for(let n=0;n<16;n++)if(t[n]!==i[n])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){let i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}},mu=new T,Hs=new ke,xQ=new T(0,0,0),_Q=new T(1,1,1),_l=new T,Wg=new T,Gr=new T,v6=new ke,y6=new At,bn=class{constructor(e=0,t=0,i=0,n=bn.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,n=this._order){return this._x=e,this._y=t,this._z=i,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){let n=e.elements,r=n[0],s=n[4],a=n[8],o=n[1],l=n[5],c=n[9],u=n[2],h=n[6],d=n[10];switch(t){case"XYZ":this._y=Math.asin(an(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-c,d),this._z=Math.atan2(-s,r)):(this._x=Math.atan2(h,l),this._z=0);break;case"YXZ":this._x=Math.asin(-an(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(a,d),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-u,r),this._z=0);break;case"ZXY":this._x=Math.asin(an(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-u,d),this._z=Math.atan2(-s,l)):(this._y=0,this._z=Math.atan2(o,r));break;case"ZYX":this._y=Math.asin(-an(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(h,d),this._z=Math.atan2(o,r)):(this._x=0,this._z=Math.atan2(-s,l));break;case"YZX":this._z=Math.asin(an(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,r)):(this._x=0,this._y=Math.atan2(a,d));break;case"XZY":this._z=Math.asin(-an(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(h,l),this._y=Math.atan2(a,r)):(this._x=Math.atan2(-c,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return v6.makeRotationFromQuaternion(e),this.setFromRotationMatrix(v6,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return y6.setFromEuler(this),this.setFromQuaternion(y6,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};bn.DEFAULT_ORDER="XYZ";var wE=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}},bQ=0,x6=new T,gu=new At,vo=new ke,Xg=new T,Cf=new T,wQ=new T,SQ=new At,_6=new T(1,0,0),b6=new T(0,1,0),w6=new T(0,0,1),MQ={type:"added"},S6={type:"removed"},$t=class extends In{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:bQ++}),this.uuid=Rs(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=$t.DEFAULT_UP.clone();let e=new T,t=new bn,i=new At,n=new T(1,1,1);function r(){i.setFromEuler(t,!1)}function s(){t.setFromQuaternion(i,void 0,!1)}t._onChange(r),i._onChange(s),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new ke},normalMatrix:{value:new Sn}}),this.matrix=new ke,this.matrixWorld=new ke,this.matrixAutoUpdate=$t.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=$t.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new wE,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return gu.setFromAxisAngle(e,t),this.quaternion.multiply(gu),this}rotateOnWorldAxis(e,t){return gu.setFromAxisAngle(e,t),this.quaternion.premultiply(gu),this}rotateX(e){return this.rotateOnAxis(_6,e)}rotateY(e){return this.rotateOnAxis(b6,e)}rotateZ(e){return this.rotateOnAxis(w6,e)}translateOnAxis(e,t){return x6.copy(e).applyQuaternion(this.quaternion),this.position.add(x6.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(_6,e)}translateY(e){return this.translateOnAxis(b6,e)}translateZ(e){return this.translateOnAxis(w6,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(vo.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?Xg.copy(e):Xg.set(e,t,i);let n=this.parent;this.updateWorldMatrix(!0,!1),Cf.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?vo.lookAt(Cf,Xg,this.up):vo.lookAt(Xg,Cf,this.up),this.quaternion.setFromRotationMatrix(vo),n&&(vo.extractRotation(n.matrixWorld),gu.setFromRotationMatrix(vo),this.quaternion.premultiply(gu.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(MQ)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}let t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(S6)),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){let t=this.children[e];t.parent=null,t.dispatchEvent(S6)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),vo.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),vo.multiply(e.parent.matrixWorld)),e.applyMatrix4(vo),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,n=this.children.length;i<n;i++){let r=this.children[i].getObjectByProperty(e,t);if(r!==void 0)return r}}getObjectsByProperty(e,t){let i=[];this[e]===t&&i.push(this);for(let n=0,r=this.children.length;n<r;n++){let s=this.children[n].getObjectsByProperty(e,t);s.length>0&&(i=i.concat(s))}return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Cf,e,wQ),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Cf,SQ,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let i=0,n=t.length;i<n;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let t=this.children;for(let i=0,n=t.length;i<n;i++)t[i].traverseVisible(e)}traverseAncestors(e){let t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let i=0,n=t.length;i<n;i++){let r=t[i];(r.matrixWorldAutoUpdate===!0||e===!0)&&r.updateMatrixWorld(e)}}updateWorldMatrix(e,t){let i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){let n=this.children;for(let r=0,s=n.length;r<s;r++){let a=n[r];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){let t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});let n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(n.instanceColor=this.instanceColor.toJSON()));function r(a,o){return a[o.uuid]===void 0&&(a[o.uuid]=o.toJSON(e)),o.uuid}if(this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=r(e.geometries,this.geometry);let a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){let o=a.shapes;if(Array.isArray(o))for(let l=0,c=o.length;l<c;l++){let u=o[l];r(e.shapes,u)}else r(e.shapes,o)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(r(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let a=[];for(let o=0,l=this.material.length;o<l;o++)a.push(r(e.materials,this.material[o]));n.material=a}else n.material=r(e.materials,this.material);if(this.children.length>0){n.children=[];for(let a=0;a<this.children.length;a++)n.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let a=0;a<this.animations.length;a++){let o=this.animations[a];n.animations.push(r(e.animations,o))}}if(t){let a=s(e.geometries),o=s(e.materials),l=s(e.textures),c=s(e.images),u=s(e.shapes),h=s(e.skeletons),d=s(e.animations),p=s(e.nodes);a.length>0&&(i.geometries=a),o.length>0&&(i.materials=o),l.length>0&&(i.textures=l),c.length>0&&(i.images=c),u.length>0&&(i.shapes=u),h.length>0&&(i.skeletons=h),d.length>0&&(i.animations=d),p.length>0&&(i.nodes=p)}return i.object=n,i;function s(a){let o=[];for(let l in a){let c=a[l];delete c.metadata,o.push(c)}return o}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){let n=e.children[i];this.add(n.clone())}return this}};$t.DEFAULT_UP=new T(0,1,0);$t.DEFAULT_MATRIX_AUTO_UPDATE=!0;$t.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var Gs=new T,yo=new T,V_=new T,xo=new T,vu=new T,yu=new T,M6=new T,H_=new T,G_=new T,j_=new T,Gn=class{constructor(e=new T,t=new T,i=new T){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,n){n.subVectors(i,t),Gs.subVectors(e,t),n.cross(Gs);let r=n.lengthSq();return r>0?n.multiplyScalar(1/Math.sqrt(r)):n.set(0,0,0)}static getBarycoord(e,t,i,n,r){Gs.subVectors(n,t),yo.subVectors(i,t),V_.subVectors(e,t);let s=Gs.dot(Gs),a=Gs.dot(yo),o=Gs.dot(V_),l=yo.dot(yo),c=yo.dot(V_),u=s*l-a*a;if(u===0)return r.set(-2,-1,-1);let h=1/u,d=(l*o-a*c)*h,p=(s*c-a*o)*h;return r.set(1-d-p,p,d)}static containsPoint(e,t,i,n){return this.getBarycoord(e,t,i,n,xo),xo.x>=0&&xo.y>=0&&xo.x+xo.y<=1}static getUV(e,t,i,n,r,s,a,o){return this.getBarycoord(e,t,i,n,xo),o.set(0,0),o.addScaledVector(r,xo.x),o.addScaledVector(s,xo.y),o.addScaledVector(a,xo.z),o}static isFrontFacing(e,t,i,n){return Gs.subVectors(i,t),yo.subVectors(e,t),Gs.cross(yo).dot(n)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,n){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,t,i,n){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Gs.subVectors(this.c,this.b),yo.subVectors(this.a,this.b),Gs.cross(yo).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Gn.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Gn.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,n,r){return Gn.getUV(e,this.a,this.b,this.c,t,i,n,r)}containsPoint(e){return Gn.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Gn.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let i=this.a,n=this.b,r=this.c,s,a;vu.subVectors(n,i),yu.subVectors(r,i),H_.subVectors(e,i);let o=vu.dot(H_),l=yu.dot(H_);if(o<=0&&l<=0)return t.copy(i);G_.subVectors(e,n);let c=vu.dot(G_),u=yu.dot(G_);if(c>=0&&u<=c)return t.copy(n);let h=o*u-c*l;if(h<=0&&o>=0&&c<=0)return s=o/(o-c),t.copy(i).addScaledVector(vu,s);j_.subVectors(e,r);let d=vu.dot(j_),p=yu.dot(j_);if(p>=0&&d<=p)return t.copy(r);let f=d*l-o*p;if(f<=0&&l>=0&&p<=0)return a=l/(l-p),t.copy(i).addScaledVector(yu,a);let v=c*p-d*u;if(v<=0&&u-c>=0&&d-p>=0)return M6.subVectors(r,n),a=(u-c)/(u-c+(d-p)),t.copy(n).addScaledVector(M6,a);let m=1/(v+f+h);return s=f*m,a=h*m,t.copy(i).addScaledVector(vu,s).addScaledVector(yu,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},CQ=0,tg=class extends In{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:CQ++}),this.uuid=Rs(),this.name="",this.type="Material",this.blending=Xd,this.side=ya,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=xB,this.blendDst=_B,this.blendEquation=od,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=nS,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=eQ,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=P_,this.stencilZFail=P_,this.stencilZPass=P_,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(let t in e){let i=e[t];if(i===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}let n=this[t];if(n===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[t]=i}}toJSON(e){let t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});let i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Xd&&(i.blending=this.blending),this.side!==ya&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(i.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(i.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=this.flatShading),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function n(r){let s=[];for(let a in r){let o=r[a];delete o.metadata,s.push(o)}return s}if(t){let r=n(e.textures),s=n(e.images);r.length>0&&(i.textures=r),s.length>0&&(i.images=s)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,i=null;if(t!==null){let n=t.length;i=new Array(n);for(let r=0;r!==n;++r)i[r]=t[r].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}},ig=class extends tg{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new ut(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=bB,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},ji=new T,qg=new te,gt=class{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=oS,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let n=0,r=this.itemSize;n<r;n++)this.array[e+n]=t.array[i+n];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)qg.fromBufferAttribute(this,t),qg.applyMatrix3(e),this.setXY(t,qg.x,qg.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)ji.fromBufferAttribute(this,t),ji.applyMatrix3(e),this.setXYZ(t,ji.x,ji.y,ji.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)ji.fromBufferAttribute(this,t),ji.applyMatrix4(e),this.setXYZ(t,ji.x,ji.y,ji.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)ji.fromBufferAttribute(this,t),ji.applyNormalMatrix(e),this.setXYZ(t,ji.x,ji.y,ji.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)ji.fromBufferAttribute(this,t),ji.transformDirection(e),this.setXYZ(t,ji.x,ji.y,ji.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Qo(t,this.array)),t}setX(e,t){return this.normalized&&(t=si(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Qo(t,this.array)),t}setY(e,t){return this.normalized&&(t=si(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Qo(t,this.array)),t}setZ(e,t){return this.normalized&&(t=si(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Qo(t,this.array)),t}setW(e,t){return this.normalized&&(t=si(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=si(t,this.array),i=si(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,n){return e*=this.itemSize,this.normalized&&(t=si(t,this.array),i=si(i,this.array),n=si(n,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this}setXYZW(e,t,i,n,r){return e*=this.itemSize,this.normalized&&(t=si(t,this.array),i=si(i,this.array),n=si(n,this.array),r=si(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this.array[e+3]=r,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==oS&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}},OB=class extends gt{constructor(e,t,i){super(new Uint16Array(e),t,i)}},qd=class extends gt{constructor(e,t,i){super(new Uint32Array(e),t,i)}},et=class extends gt{constructor(e,t,i){super(new Float32Array(e),t,i)}},EQ=0,ms=new ke,W_=new $t,xu=new T,jr=new Vi,Ef=new Vi,gn=new T,mt=class extends In{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:EQ++}),this.uuid=Rs(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(PB(e)?qd:OB)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);let i=this.attributes.normal;if(i!==void 0){let r=new Sn().getNormalMatrix(e);i.applyNormalMatrix(r),i.needsUpdate=!0}let n=this.attributes.tangent;return n!==void 0&&(n.transformDirection(e),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return ms.makeRotationFromQuaternion(e),this.applyMatrix4(ms),this}rotateX(e){return ms.makeRotationX(e),this.applyMatrix4(ms),this}rotateY(e){return ms.makeRotationY(e),this.applyMatrix4(ms),this}rotateZ(e){return ms.makeRotationZ(e),this.applyMatrix4(ms),this}translate(e,t,i){return ms.makeTranslation(e,t,i),this.applyMatrix4(ms),this}scale(e,t,i){return ms.makeScale(e,t,i),this.applyMatrix4(ms),this}lookAt(e){return W_.lookAt(e),W_.updateMatrix(),this.applyMatrix4(W_.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(xu).negate(),this.translate(xu.x,xu.y,xu.z),this}setFromPoints(e){let t=[];for(let i=0,n=e.length;i<n;i++){let r=e[i];t.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new et(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Vi);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new T(-1/0,-1/0,-1/0),new T(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,n=t.length;i<n;i++){let r=t[i];jr.setFromBufferAttribute(r),this.morphTargetsRelative?(gn.addVectors(this.boundingBox.min,jr.min),this.boundingBox.expandByPoint(gn),gn.addVectors(this.boundingBox.max,jr.max),this.boundingBox.expandByPoint(gn)):(this.boundingBox.expandByPoint(jr.min),this.boundingBox.expandByPoint(jr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ls);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new T,1/0);return}if(e){let i=this.boundingSphere.center;if(jr.setFromBufferAttribute(e),t)for(let r=0,s=t.length;r<s;r++){let a=t[r];Ef.setFromBufferAttribute(a),this.morphTargetsRelative?(gn.addVectors(jr.min,Ef.min),jr.expandByPoint(gn),gn.addVectors(jr.max,Ef.max),jr.expandByPoint(gn)):(jr.expandByPoint(Ef.min),jr.expandByPoint(Ef.max))}jr.getCenter(i);let n=0;for(let r=0,s=e.count;r<s;r++)gn.fromBufferAttribute(e,r),n=Math.max(n,i.distanceToSquared(gn));if(t)for(let r=0,s=t.length;r<s;r++){let a=t[r],o=this.morphTargetsRelative;for(let l=0,c=a.count;l<c;l++)gn.fromBufferAttribute(a,l),o&&(xu.fromBufferAttribute(e,l),gn.add(xu)),n=Math.max(n,i.distanceToSquared(gn))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let i=e.array,n=t.position.array,r=t.normal.array,s=t.uv.array,a=n.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new gt(new Float32Array(4*a),4));let o=this.getAttribute("tangent").array,l=[],c=[];for(let C=0;C<a;C++)l[C]=new T,c[C]=new T;let u=new T,h=new T,d=new T,p=new te,f=new te,v=new te,m=new T,g=new T;function y(C,E,P){u.fromArray(n,C*3),h.fromArray(n,E*3),d.fromArray(n,P*3),p.fromArray(s,C*2),f.fromArray(s,E*2),v.fromArray(s,P*2),h.sub(u),d.sub(u),f.sub(p),v.sub(p);let I=1/(f.x*v.y-v.x*f.y);!isFinite(I)||(m.copy(h).multiplyScalar(v.y).addScaledVector(d,-f.y).multiplyScalar(I),g.copy(d).multiplyScalar(f.x).addScaledVector(h,-v.x).multiplyScalar(I),l[C].add(m),l[E].add(m),l[P].add(m),c[C].add(g),c[E].add(g),c[P].add(g))}let x=this.groups;x.length===0&&(x=[{start:0,count:i.length}]);for(let C=0,E=x.length;C<E;++C){let P=x[C],I=P.start,D=P.count;for(let L=I,B=I+D;L<B;L+=3)y(i[L+0],i[L+1],i[L+2])}let _=new T,b=new T,w=new T,M=new T;function S(C){w.fromArray(r,C*3),M.copy(w);let E=l[C];_.copy(E),_.sub(w.multiplyScalar(w.dot(E))).normalize(),b.crossVectors(M,E);let P=b.dot(c[C])<0?-1:1;o[C*4]=_.x,o[C*4+1]=_.y,o[C*4+2]=_.z,o[C*4+3]=P}for(let C=0,E=x.length;C<E;++C){let P=x[C],I=P.start,D=P.count;for(let L=I,B=I+D;L<B;L+=3)S(i[L+0]),S(i[L+1]),S(i[L+2])}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new gt(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let h=0,d=i.count;h<d;h++)i.setXYZ(h,0,0,0);let n=new T,r=new T,s=new T,a=new T,o=new T,l=new T,c=new T,u=new T;if(e)for(let h=0,d=e.count;h<d;h+=3){let p=e.getX(h+0),f=e.getX(h+1),v=e.getX(h+2);n.fromBufferAttribute(t,p),r.fromBufferAttribute(t,f),s.fromBufferAttribute(t,v),c.subVectors(s,r),u.subVectors(n,r),c.cross(u),a.fromBufferAttribute(i,p),o.fromBufferAttribute(i,f),l.fromBufferAttribute(i,v),a.add(c),o.add(c),l.add(c),i.setXYZ(p,a.x,a.y,a.z),i.setXYZ(f,o.x,o.y,o.z),i.setXYZ(v,l.x,l.y,l.z)}else for(let h=0,d=t.count;h<d;h+=3)n.fromBufferAttribute(t,h+0),r.fromBufferAttribute(t,h+1),s.fromBufferAttribute(t,h+2),c.subVectors(s,r),u.subVectors(n,r),c.cross(u),i.setXYZ(h+0,c.x,c.y,c.z),i.setXYZ(h+1,c.x,c.y,c.z),i.setXYZ(h+2,c.x,c.y,c.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){let e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)gn.fromBufferAttribute(e,t),gn.normalize(),e.setXYZ(t,gn.x,gn.y,gn.z)}toNonIndexed(){function e(a,o){let l=a.array,c=a.itemSize,u=a.normalized,h=new l.constructor(o.length*c),d=0,p=0;for(let f=0,v=o.length;f<v;f++){a.isInterleavedBufferAttribute?d=o[f]*a.data.stride+a.offset:d=o[f]*c;for(let m=0;m<c;m++)h[p++]=l[d++]}return new gt(h,c,u)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new mt,i=this.index.array,n=this.attributes;for(let a in n){let o=n[a],l=e(o,i);t.setAttribute(a,l)}let r=this.morphAttributes;for(let a in r){let o=[],l=r[a];for(let c=0,u=l.length;c<u;c++){let h=l[c],d=e(h,i);o.push(d)}t.morphAttributes[a]=o}t.morphTargetsRelative=this.morphTargetsRelative;let s=this.groups;for(let a=0,o=s.length;a<o;a++){let l=s[a];t.addGroup(l.start,l.count,l.materialIndex)}return t}toJSON(){let e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){let o=this.parameters;for(let l in o)o[l]!==void 0&&(e[l]=o[l]);return e}e.data={attributes:{}};let t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let i=this.attributes;for(let o in i){let l=i[o];e.data.attributes[o]=l.toJSON(e.data)}let n={},r=!1;for(let o in this.morphAttributes){let l=this.morphAttributes[o],c=[];for(let u=0,h=l.length;u<h;u++){let d=l[u];c.push(d.toJSON(e.data))}c.length>0&&(n[o]=c,r=!0)}r&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);let s=this.groups;s.length>0&&(e.data.groups=JSON.parse(JSON.stringify(s)));let a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let i=e.index;i!==null&&this.setIndex(i.clone(t));let n=e.attributes;for(let l in n){let c=n[l];this.setAttribute(l,c.clone(t))}let r=e.morphAttributes;for(let l in r){let c=[],u=r[l];for(let h=0,d=u.length;h<d;h++)c.push(u[h].clone(t));this.morphAttributes[l]=c}this.morphTargetsRelative=e.morphTargetsRelative;let s=e.groups;for(let l=0,c=s.length;l<c;l++){let u=s[l];this.addGroup(u.start,u.count,u.materialIndex)}let a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());let o=e.boundingSphere;return o!==null&&(this.boundingSphere=o.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}},C6=new ke,_u=new Wp,X_=new ls,Af=new T,Tf=new T,Pf=new T,q_=new T,Yg=new T,Zg=new te,Qg=new te,Kg=new te,Y_=new T,$g=new T,Ar=class extends $t{constructor(e=new mt,t=new ig){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let i=e[t[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,r=i.length;n<r;n++){let s=i[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=n}}}}getVertexPosition(e,t){let i=this.geometry,n=i.attributes.position,r=i.morphAttributes.position,s=i.morphTargetsRelative;t.fromBufferAttribute(n,e);let a=this.morphTargetInfluences;if(r&&a){Yg.set(0,0,0);for(let o=0,l=r.length;o<l;o++){let c=a[o],u=r[o];c!==0&&(q_.fromBufferAttribute(u,e),s?Yg.addScaledVector(q_,c):Yg.addScaledVector(q_.sub(t),c))}t.add(Yg)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){let i=this.geometry,n=this.material,r=this.matrixWorld;if(n===void 0||(i.boundingSphere===null&&i.computeBoundingSphere(),X_.copy(i.boundingSphere),X_.applyMatrix4(r),e.ray.intersectsSphere(X_)===!1)||(C6.copy(r).invert(),_u.copy(e.ray).applyMatrix4(C6),i.boundingBox!==null&&_u.intersectsBox(i.boundingBox)===!1))return;let s,a=i.index,o=i.attributes.position,l=i.attributes.uv,c=i.attributes.uv2,u=i.groups,h=i.drawRange;if(a!==null)if(Array.isArray(n))for(let d=0,p=u.length;d<p;d++){let f=u[d],v=n[f.materialIndex],m=Math.max(f.start,h.start),g=Math.min(a.count,Math.min(f.start+f.count,h.start+h.count));for(let y=m,x=g;y<x;y+=3){let _=a.getX(y),b=a.getX(y+1),w=a.getX(y+2);s=Jg(this,v,e,_u,l,c,_,b,w),s&&(s.faceIndex=Math.floor(y/3),s.face.materialIndex=f.materialIndex,t.push(s))}}else{let d=Math.max(0,h.start),p=Math.min(a.count,h.start+h.count);for(let f=d,v=p;f<v;f+=3){let m=a.getX(f),g=a.getX(f+1),y=a.getX(f+2);s=Jg(this,n,e,_u,l,c,m,g,y),s&&(s.faceIndex=Math.floor(f/3),t.push(s))}}else if(o!==void 0)if(Array.isArray(n))for(let d=0,p=u.length;d<p;d++){let f=u[d],v=n[f.materialIndex],m=Math.max(f.start,h.start),g=Math.min(o.count,Math.min(f.start+f.count,h.start+h.count));for(let y=m,x=g;y<x;y+=3){let _=y,b=y+1,w=y+2;s=Jg(this,v,e,_u,l,c,_,b,w),s&&(s.faceIndex=Math.floor(y/3),s.face.materialIndex=f.materialIndex,t.push(s))}}else{let d=Math.max(0,h.start),p=Math.min(o.count,h.start+h.count);for(let f=d,v=p;f<v;f+=3){let m=f,g=f+1,y=f+2;s=Jg(this,n,e,_u,l,c,m,g,y),s&&(s.faceIndex=Math.floor(f/3),t.push(s))}}}};function AQ(e,t,i,n,r,s,a,o){let l;if(t.side===wn?l=n.intersectTriangle(a,s,r,!0,o):l=n.intersectTriangle(r,s,a,t.side===ya,o),l===null)return null;$g.copy(o),$g.applyMatrix4(e.matrixWorld);let c=i.ray.origin.distanceTo($g);return c<i.near||c>i.far?null:{distance:c,point:$g.clone(),object:e}}function Jg(e,t,i,n,r,s,a,o,l){e.getVertexPosition(a,Af),e.getVertexPosition(o,Tf),e.getVertexPosition(l,Pf);let c=AQ(e,t,i,n,Af,Tf,Pf,Y_);if(c){r&&(Zg.fromBufferAttribute(r,a),Qg.fromBufferAttribute(r,o),Kg.fromBufferAttribute(r,l),c.uv=Gn.getUV(Y_,Af,Tf,Pf,Zg,Qg,Kg,new te)),s&&(Zg.fromBufferAttribute(s,a),Qg.fromBufferAttribute(s,o),Kg.fromBufferAttribute(s,l),c.uv2=Gn.getUV(Y_,Af,Tf,Pf,Zg,Qg,Kg,new te));let u={a,b:o,c:l,normal:new T,materialIndex:0};Gn.getNormal(Af,Tf,Pf,u.normal),c.face=u}return c}var ro=class extends mt{constructor(e=1,t=1,i=1,n=1,r=1,s=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:n,heightSegments:r,depthSegments:s};let a=this;n=Math.floor(n),r=Math.floor(r),s=Math.floor(s);let o=[],l=[],c=[],u=[],h=0,d=0;p("z","y","x",-1,-1,i,t,e,s,r,0),p("z","y","x",1,-1,i,t,-e,s,r,1),p("x","z","y",1,1,e,i,t,n,s,2),p("x","z","y",1,-1,e,i,-t,n,s,3),p("x","y","z",1,-1,e,t,i,n,r,4),p("x","y","z",-1,-1,e,t,-i,n,r,5),this.setIndex(o),this.setAttribute("position",new et(l,3)),this.setAttribute("normal",new et(c,3)),this.setAttribute("uv",new et(u,2));function p(f,v,m,g,y,x,_,b,w,M,S){let C=x/w,E=_/M,P=x/2,I=_/2,D=b/2,L=w+1,B=M+1,j=0,z=0,O=new T;for(let H=0;H<B;H++){let k=H*E-I;for(let N=0;N<L;N++){let F=N*C-P;O[f]=F*g,O[v]=k*y,O[m]=D,l.push(O.x,O.y,O.z),O[f]=0,O[v]=0,O[m]=b>0?1:-1,c.push(O.x,O.y,O.z),u.push(N/w),u.push(1-H/M),j+=1}}for(let H=0;H<M;H++)for(let k=0;k<w;k++){let N=h+k+L*H,F=h+k+L*(H+1),Q=h+(k+1)+L*(H+1),G=h+(k+1)+L*H;o.push(N,F,G),o.push(F,Q,G),z+=6}a.addGroup(d,z,S),d+=z,h+=j}}static fromJSON(e){return new ro(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}};function bp(e){let t={};for(let i in e){t[i]={};for(let n in e[i]){let r=e[i][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?t[i][n]=r.clone():Array.isArray(r)?t[i][n]=r.slice():t[i][n]=r}}return t}function tr(e){let t={};for(let i=0;i<e.length;i++){let n=bp(e[i]);for(let r in n)t[r]=n[r]}return t}function TQ(e){let t=[];for(let i=0;i<e.length;i++)t.push(e[i].clone());return t}function BB(e){return e.getRenderTarget()===null&&e.outputEncoding===Mt?Fa:Ry}var Xp={clone:bp,merge:tr},PQ=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,DQ=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,oi=class extends tg{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=PQ,this.fragmentShader=DQ,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=bp(e.uniforms),this.uniformsGroups=TQ(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(let n in this.uniforms){let r=this.uniforms[n].value;r&&r.isTexture?t.uniforms[n]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[n]={type:"m4",value:r.toArray()}:t.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;let i={};for(let n in this.extensions)this.extensions[n]===!0&&(i[n]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}},qp=class extends $t{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new ke,this.projectionMatrix=new ke,this.projectionMatrixInverse=new ke}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},Vn=class extends qp{constructor(e=50,t=1,i=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=n,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=_0*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(Bm*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return _0*2*Math.atan(Math.tan(Bm*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,n,r,s){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(Bm*.5*this.fov)/this.zoom,i=2*t,n=this.aspect*i,r=-.5*n,s=this.view;if(this.view!==null&&this.view.enabled){let o=s.fullWidth,l=s.fullHeight;r+=s.offsetX*n/o,t-=s.offsetY*i/l,n*=s.width/o,i*=s.height/l}let a=this.filmOffset;a!==0&&(r+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+n,t,t-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}},bu=-90,wu=1,LQ=class extends $t{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i;let n=new Vn(bu,wu,e,t);n.layers=this.layers,n.up.set(0,1,0),n.lookAt(1,0,0),this.add(n);let r=new Vn(bu,wu,e,t);r.layers=this.layers,r.up.set(0,1,0),r.lookAt(-1,0,0),this.add(r);let s=new Vn(bu,wu,e,t);s.layers=this.layers,s.up.set(0,0,-1),s.lookAt(0,1,0),this.add(s);let a=new Vn(bu,wu,e,t);a.layers=this.layers,a.up.set(0,0,1),a.lookAt(0,-1,0),this.add(a);let o=new Vn(bu,wu,e,t);o.layers=this.layers,o.up.set(0,1,0),o.lookAt(0,0,1),this.add(o);let l=new Vn(bu,wu,e,t);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(0,0,-1),this.add(l)}update(e,t){this.parent===null&&this.updateMatrixWorld();let i=this.renderTarget,[n,r,s,a,o,l]=this.children,c=e.getRenderTarget(),u=e.toneMapping,h=e.xr.enabled;e.toneMapping=tl,e.xr.enabled=!1;let d=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,n),e.setRenderTarget(i,1),e.render(t,r),e.setRenderTarget(i,2),e.render(t,s),e.setRenderTarget(i,3),e.render(t,a),e.setRenderTarget(i,4),e.render(t,o),i.texture.generateMipmaps=d,e.setRenderTarget(i,5),e.render(t,l),e.setRenderTarget(c),e.toneMapping=u,e.xr.enabled=h,i.texture.needsPMREMUpdate=!0}},SE=class extends ln{constructor(e,t,i,n,r,s,a,o,l,c){e=e!==void 0?e:[],t=t!==void 0?t:Gh,super(e,t,i,n,r,s,a,o,l,c),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}},RQ=class extends Qt{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let i={width:e,height:e,depth:1},n=[i,i,i,i,i,i];this.texture=new SE(n,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Lt}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},n=new ro(5,5,5),r=new oi({name:"CubemapFromEquirect",uniforms:bp(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:wn,blending:Qi});r.uniforms.tEquirect.value=t;let s=new Ar(n,r),a=t.minFilter;return t.minFilter===xp&&(t.minFilter=Lt),new LQ(1,10,this).update(e,s),t.minFilter=a,s.geometry.dispose(),s.material.dispose(),this}clear(e,t,i,n){let r=e.getRenderTarget();for(let s=0;s<6;s++)e.setRenderTarget(this,s),e.clear(t,i,n);e.setRenderTarget(r)}},Z_=new T,IQ=new T,OQ=new Sn,Qr=class{constructor(e=new T(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,n){return this.normal.set(e,t,i),this.constant=n,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){let n=Z_.subVectors(i,t).cross(IQ.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){let i=e.delta(Z_),n=this.normal.dot(i);if(n===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;let r=-(e.start.dot(this.normal)+this.constant)/n;return r<0||r>1?null:t.copy(i).multiplyScalar(r).add(e.start)}intersectsLine(e){let t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let i=t||OQ.getNormalMatrix(e),n=this.coplanarPoint(Z_).applyMatrix4(e),r=this.normal.applyMatrix3(i).normalize();return this.constant=-n.dot(r),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},Su=new ls,e1=new T,ME=class{constructor(e=new Qr,t=new Qr,i=new Qr,n=new Qr,r=new Qr,s=new Qr){this.planes=[e,t,i,n,r,s]}set(e,t,i,n,r,s){let a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(n),a[4].copy(r),a[5].copy(s),this}copy(e){let t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){let t=this.planes,i=e.elements,n=i[0],r=i[1],s=i[2],a=i[3],o=i[4],l=i[5],c=i[6],u=i[7],h=i[8],d=i[9],p=i[10],f=i[11],v=i[12],m=i[13],g=i[14],y=i[15];return t[0].setComponents(a-n,u-o,f-h,y-v).normalize(),t[1].setComponents(a+n,u+o,f+h,y+v).normalize(),t[2].setComponents(a+r,u+l,f+d,y+m).normalize(),t[3].setComponents(a-r,u-l,f-d,y-m).normalize(),t[4].setComponents(a-s,u-c,f-p,y-g).normalize(),t[5].setComponents(a+s,u+c,f+p,y+g).normalize(),this}intersectsObject(e){let t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),Su.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Su)}intersectsSprite(e){return Su.center.set(0,0,0),Su.radius=.7071067811865476,Su.applyMatrix4(e.matrixWorld),this.intersectsSphere(Su)}intersectsSphere(e){let t=this.planes,i=e.center,n=-e.radius;for(let r=0;r<6;r++)if(t[r].distanceToPoint(i)<n)return!1;return!0}intersectsBox(e){let t=this.planes;for(let i=0;i<6;i++){let n=t[i];if(e1.x=n.normal.x>0?e.max.x:e.min.x,e1.y=n.normal.y>0?e.max.y:e.min.y,e1.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(e1)<0)return!1}return!0}containsPoint(e){let t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};function NB(){let e=null,t=!1,i=null,n=null;function r(s,a){i(s,a),n=e.requestAnimationFrame(r)}return{start:function(){t!==!0&&i!==null&&(n=e.requestAnimationFrame(r),t=!0)},stop:function(){e.cancelAnimationFrame(n),t=!1},setAnimationLoop:function(s){i=s},setContext:function(s){e=s}}}function BQ(e,t){let i=t.isWebGL2,n=new WeakMap;function r(c,u){let h=c.array,d=c.usage,p=e.createBuffer();e.bindBuffer(u,p),e.bufferData(u,h,d),c.onUploadCallback();let f;if(h instanceof Float32Array)f=5126;else if(h instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(i)f=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else f=5123;else if(h instanceof Int16Array)f=5122;else if(h instanceof Uint32Array)f=5125;else if(h instanceof Int32Array)f=5124;else if(h instanceof Int8Array)f=5120;else if(h instanceof Uint8Array)f=5121;else if(h instanceof Uint8ClampedArray)f=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:p,type:f,bytesPerElement:h.BYTES_PER_ELEMENT,version:c.version}}function s(c,u,h){let d=u.array,p=u.updateRange;e.bindBuffer(h,c),p.count===-1?e.bufferSubData(h,0,d):(i?e.bufferSubData(h,p.offset*d.BYTES_PER_ELEMENT,d,p.offset,p.count):e.bufferSubData(h,p.offset*d.BYTES_PER_ELEMENT,d.subarray(p.offset,p.offset+p.count)),p.count=-1),u.onUploadCallback()}function a(c){return c.isInterleavedBufferAttribute&&(c=c.data),n.get(c)}function o(c){c.isInterleavedBufferAttribute&&(c=c.data);let u=n.get(c);u&&(e.deleteBuffer(u.buffer),n.delete(c))}function l(c,u){if(c.isGLBufferAttribute){let d=n.get(c);(!d||d.version<c.version)&&n.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);let h=n.get(c);h===void 0?n.set(c,r(c,u)):h.version<c.version&&(s(h.buffer,c,u),h.version=c.version)}return{get:a,remove:o,update:l}}var r2=class extends mt{constructor(e=1,t=1,i=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:n};let r=e/2,s=t/2,a=Math.floor(i),o=Math.floor(n),l=a+1,c=o+1,u=e/a,h=t/o,d=[],p=[],f=[],v=[];for(let m=0;m<c;m++){let g=m*h-s;for(let y=0;y<l;y++){let x=y*u-r;p.push(x,-g,0),f.push(0,0,1),v.push(y/a),v.push(1-m/o)}}for(let m=0;m<o;m++)for(let g=0;g<a;g++){let y=g+l*m,x=g+l*(m+1),_=g+1+l*(m+1),b=g+1+l*m;d.push(y,x,b),d.push(x,_,b)}this.setIndex(d),this.setAttribute("position",new et(p,3)),this.setAttribute("normal",new et(f,3)),this.setAttribute("uv",new et(v,2))}static fromJSON(e){return new r2(e.width,e.height,e.widthSegments,e.heightSegments)}},NQ=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,UQ=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,FQ=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,zQ=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,kQ=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,VQ=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,HQ="vec3 transformed = vec3( position );",GQ=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,jQ=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,WQ=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,XQ=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,qQ=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,YQ=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,ZQ=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,QQ=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,KQ=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,$Q=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,JQ=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,eK=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,tK=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,iK=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,nK=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,rK=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,sK=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,aK=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,oK=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,lK="gl_FragColor = linearToOutputTexel( gl_FragColor );",cK=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,hK=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,uK=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,dK=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,pK=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,fK=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,mK=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,gK=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,vK=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,yK=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,xK=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,_K=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,bK=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,wK=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,SK=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,MK=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,CK=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,EK=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,AK=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,TK=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,PK=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,DK=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,LK=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,RK=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,IK=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,OK=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,BK=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,NK=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,UK=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,FK=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,zK=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,kK=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,VK=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,HK=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,GK=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,jK=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,WK=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,XK=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,qK=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,YK=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,ZK=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,QK=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,KK=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,$K=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,JK=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,e$=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,t$=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,i$=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,n$=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,r$=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,s$=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,a$=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,o$=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,l$=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,c$=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,h$=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,u$=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,d$=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,p$=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,f$=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,m$=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,g$=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,v$=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,y$=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,x$=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,_$=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,b$=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,w$=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,S$=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,M$=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,C$=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,E$=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,A$=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,T$=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,P$=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,D$=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,L$=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,R$=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,I$=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,O$=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,B$=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,N$=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,U$=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,F$=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,z$=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,k$=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,V$=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,H$=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,G$=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,j$=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,W$=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,X$=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,q$=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Y$=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Z$=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Q$=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,K$=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,$$=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,J$=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,eJ=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,tJ=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,iJ=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,nJ=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,rJ=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,sJ=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,aJ=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,oJ=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,lJ=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,cJ=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,hJ=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,uJ=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,dJ=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,pJ=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Et={alphamap_fragment:NQ,alphamap_pars_fragment:UQ,alphatest_fragment:FQ,alphatest_pars_fragment:zQ,aomap_fragment:kQ,aomap_pars_fragment:VQ,begin_vertex:HQ,beginnormal_vertex:GQ,bsdfs:jQ,iridescence_fragment:WQ,bumpmap_pars_fragment:XQ,clipping_planes_fragment:qQ,clipping_planes_pars_fragment:YQ,clipping_planes_pars_vertex:ZQ,clipping_planes_vertex:QQ,color_fragment:KQ,color_pars_fragment:$Q,color_pars_vertex:JQ,color_vertex:eK,common:tK,cube_uv_reflection_fragment:iK,defaultnormal_vertex:nK,displacementmap_pars_vertex:rK,displacementmap_vertex:sK,emissivemap_fragment:aK,emissivemap_pars_fragment:oK,encodings_fragment:lK,encodings_pars_fragment:cK,envmap_fragment:hK,envmap_common_pars_fragment:uK,envmap_pars_fragment:dK,envmap_pars_vertex:pK,envmap_physical_pars_fragment:CK,envmap_vertex:fK,fog_vertex:mK,fog_pars_vertex:gK,fog_fragment:vK,fog_pars_fragment:yK,gradientmap_pars_fragment:xK,lightmap_fragment:_K,lightmap_pars_fragment:bK,lights_lambert_fragment:wK,lights_lambert_pars_fragment:SK,lights_pars_begin:MK,lights_toon_fragment:EK,lights_toon_pars_fragment:AK,lights_phong_fragment:TK,lights_phong_pars_fragment:PK,lights_physical_fragment:DK,lights_physical_pars_fragment:LK,lights_fragment_begin:RK,lights_fragment_maps:IK,lights_fragment_end:OK,logdepthbuf_fragment:BK,logdepthbuf_pars_fragment:NK,logdepthbuf_pars_vertex:UK,logdepthbuf_vertex:FK,map_fragment:zK,map_pars_fragment:kK,map_particle_fragment:VK,map_particle_pars_fragment:HK,metalnessmap_fragment:GK,metalnessmap_pars_fragment:jK,morphcolor_vertex:WK,morphnormal_vertex:XK,morphtarget_pars_vertex:qK,morphtarget_vertex:YK,normal_fragment_begin:ZK,normal_fragment_maps:QK,normal_pars_fragment:KK,normal_pars_vertex:$K,normal_vertex:JK,normalmap_pars_fragment:e$,clearcoat_normal_fragment_begin:t$,clearcoat_normal_fragment_maps:i$,clearcoat_pars_fragment:n$,iridescence_pars_fragment:r$,output_fragment:s$,packing:a$,premultiplied_alpha_fragment:o$,project_vertex:l$,dithering_fragment:c$,dithering_pars_fragment:h$,roughnessmap_fragment:u$,roughnessmap_pars_fragment:d$,shadowmap_pars_fragment:p$,shadowmap_pars_vertex:f$,shadowmap_vertex:m$,shadowmask_pars_fragment:g$,skinbase_vertex:v$,skinning_pars_vertex:y$,skinning_vertex:x$,skinnormal_vertex:_$,specularmap_fragment:b$,specularmap_pars_fragment:w$,tonemapping_fragment:S$,tonemapping_pars_fragment:M$,transmission_fragment:C$,transmission_pars_fragment:E$,uv_pars_fragment:A$,uv_pars_vertex:T$,uv_vertex:P$,uv2_pars_fragment:D$,uv2_pars_vertex:L$,uv2_vertex:R$,worldpos_vertex:I$,background_vert:O$,background_frag:B$,backgroundCube_vert:N$,backgroundCube_frag:U$,cube_vert:F$,cube_frag:z$,depth_vert:k$,depth_frag:V$,distanceRGBA_vert:H$,distanceRGBA_frag:G$,equirect_vert:j$,equirect_frag:W$,linedashed_vert:X$,linedashed_frag:q$,meshbasic_vert:Y$,meshbasic_frag:Z$,meshlambert_vert:Q$,meshlambert_frag:K$,meshmatcap_vert:$$,meshmatcap_frag:J$,meshnormal_vert:eJ,meshnormal_frag:tJ,meshphong_vert:iJ,meshphong_frag:nJ,meshphysical_vert:rJ,meshphysical_frag:sJ,meshtoon_vert:aJ,meshtoon_frag:oJ,points_vert:lJ,points_frag:cJ,shadow_vert:hJ,shadow_frag:uJ,sprite_vert:dJ,sprite_frag:pJ},We={common:{diffuse:{value:new ut(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Sn},uv2Transform:{value:new Sn},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new te(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ut(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ut(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Sn}},sprite:{diffuse:{value:new ut(16777215)},opacity:{value:1},center:{value:new te(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Sn}}},za={basic:{uniforms:tr([We.common,We.specularmap,We.envmap,We.aomap,We.lightmap,We.fog]),vertexShader:Et.meshbasic_vert,fragmentShader:Et.meshbasic_frag},lambert:{uniforms:tr([We.common,We.specularmap,We.envmap,We.aomap,We.lightmap,We.emissivemap,We.bumpmap,We.normalmap,We.displacementmap,We.fog,We.lights,{emissive:{value:new ut(0)}}]),vertexShader:Et.meshlambert_vert,fragmentShader:Et.meshlambert_frag},phong:{uniforms:tr([We.common,We.specularmap,We.envmap,We.aomap,We.lightmap,We.emissivemap,We.bumpmap,We.normalmap,We.displacementmap,We.fog,We.lights,{emissive:{value:new ut(0)},specular:{value:new ut(1118481)},shininess:{value:30}}]),vertexShader:Et.meshphong_vert,fragmentShader:Et.meshphong_frag},standard:{uniforms:tr([We.common,We.envmap,We.aomap,We.lightmap,We.emissivemap,We.bumpmap,We.normalmap,We.displacementmap,We.roughnessmap,We.metalnessmap,We.fog,We.lights,{emissive:{value:new ut(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Et.meshphysical_vert,fragmentShader:Et.meshphysical_frag},toon:{uniforms:tr([We.common,We.aomap,We.lightmap,We.emissivemap,We.bumpmap,We.normalmap,We.displacementmap,We.gradientmap,We.fog,We.lights,{emissive:{value:new ut(0)}}]),vertexShader:Et.meshtoon_vert,fragmentShader:Et.meshtoon_frag},matcap:{uniforms:tr([We.common,We.bumpmap,We.normalmap,We.displacementmap,We.fog,{matcap:{value:null}}]),vertexShader:Et.meshmatcap_vert,fragmentShader:Et.meshmatcap_frag},points:{uniforms:tr([We.points,We.fog]),vertexShader:Et.points_vert,fragmentShader:Et.points_frag},dashed:{uniforms:tr([We.common,We.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Et.linedashed_vert,fragmentShader:Et.linedashed_frag},depth:{uniforms:tr([We.common,We.displacementmap]),vertexShader:Et.depth_vert,fragmentShader:Et.depth_frag},normal:{uniforms:tr([We.common,We.bumpmap,We.normalmap,We.displacementmap,{opacity:{value:1}}]),vertexShader:Et.meshnormal_vert,fragmentShader:Et.meshnormal_frag},sprite:{uniforms:tr([We.sprite,We.fog]),vertexShader:Et.sprite_vert,fragmentShader:Et.sprite_frag},background:{uniforms:{uvTransform:{value:new Sn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Et.background_vert,fragmentShader:Et.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Et.backgroundCube_vert,fragmentShader:Et.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Et.cube_vert,fragmentShader:Et.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Et.equirect_vert,fragmentShader:Et.equirect_frag},distanceRGBA:{uniforms:tr([We.common,We.displacementmap,{referencePosition:{value:new T},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Et.distanceRGBA_vert,fragmentShader:Et.distanceRGBA_frag},shadow:{uniforms:tr([We.lights,We.fog,{color:{value:new ut(0)},opacity:{value:1}}]),vertexShader:Et.shadow_vert,fragmentShader:Et.shadow_frag}};za.physical={uniforms:tr([za.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new te(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new ut(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new te},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new ut(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new ut(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Et.meshphysical_vert,fragmentShader:Et.meshphysical_frag};var t1={r:0,b:0,g:0};function fJ(e,t,i,n,r,s,a){let o=new ut(0),l=s===!0?0:1,c,u,h=null,d=0,p=null;function f(m,g){let y=!1,x=g.isScene===!0?g.background:null;x&&x.isTexture&&(x=(g.backgroundBlurriness>0?i:t).get(x));let _=e.xr,b=_.getSession&&_.getSession();b&&b.environmentBlendMode==="additive"&&(x=null),x===null?v(o,l):x&&x.isColor&&(v(x,1),y=!0),(e.autoClear||y)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),x&&(x.isCubeTexture||x.mapping===eg)?(u===void 0&&(u=new Ar(new ro(1,1,1),new oi({name:"BackgroundCubeMaterial",uniforms:bp(za.backgroundCube.uniforms),vertexShader:za.backgroundCube.vertexShader,fragmentShader:za.backgroundCube.fragmentShader,side:wn,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(w,M,S){this.matrixWorld.copyPosition(S.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),u.material.uniforms.envMap.value=x,u.material.uniforms.flipEnvMap.value=x.isCubeTexture&&x.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=g.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,u.material.toneMapped=x.encoding!==Mt,(h!==x||d!==x.version||p!==e.toneMapping)&&(u.material.needsUpdate=!0,h=x,d=x.version,p=e.toneMapping),u.layers.enableAll(),m.unshift(u,u.geometry,u.material,0,0,null)):x&&x.isTexture&&(c===void 0&&(c=new Ar(new r2(2,2),new oi({name:"BackgroundMaterial",uniforms:bp(za.background.uniforms),vertexShader:za.background.vertexShader,fragmentShader:za.background.fragmentShader,side:ya,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=x,c.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,c.material.toneMapped=x.encoding!==Mt,x.matrixAutoUpdate===!0&&x.updateMatrix(),c.material.uniforms.uvTransform.value.copy(x.matrix),(h!==x||d!==x.version||p!==e.toneMapping)&&(c.material.needsUpdate=!0,h=x,d=x.version,p=e.toneMapping),c.layers.enableAll(),m.unshift(c,c.geometry,c.material,0,0,null))}function v(m,g){m.getRGB(t1,BB(e)),n.buffers.color.setClear(t1.r,t1.g,t1.b,g,a)}return{getClearColor:function(){return o},setClearColor:function(m,g=1){o.set(m),l=g,v(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(m){l=m,v(o,l)},render:f}}function mJ(e,t,i,n){let r=e.getParameter(34921),s=n.isWebGL2?null:t.get("OES_vertex_array_object"),a=n.isWebGL2||s!==null,o={},l=m(null),c=l,u=!1;function h(L,B,j,z,O){let H=!1;if(a){let k=v(z,j,B);c!==k&&(c=k,p(c.object)),H=g(L,z,j,O),H&&y(L,z,j,O)}else{let k=B.wireframe===!0;(c.geometry!==z.id||c.program!==j.id||c.wireframe!==k)&&(c.geometry=z.id,c.program=j.id,c.wireframe=k,H=!0)}O!==null&&i.update(O,34963),(H||u)&&(u=!1,S(L,B,j,z),O!==null&&e.bindBuffer(34963,i.get(O).buffer))}function d(){return n.isWebGL2?e.createVertexArray():s.createVertexArrayOES()}function p(L){return n.isWebGL2?e.bindVertexArray(L):s.bindVertexArrayOES(L)}function f(L){return n.isWebGL2?e.deleteVertexArray(L):s.deleteVertexArrayOES(L)}function v(L,B,j){let z=j.wireframe===!0,O=o[L.id];O===void 0&&(O={},o[L.id]=O);let H=O[B.id];H===void 0&&(H={},O[B.id]=H);let k=H[z];return k===void 0&&(k=m(d()),H[z]=k),k}function m(L){let B=[],j=[],z=[];for(let O=0;O<r;O++)B[O]=0,j[O]=0,z[O]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:B,enabledAttributes:j,attributeDivisors:z,object:L,attributes:{},index:null}}function g(L,B,j,z){let O=c.attributes,H=B.attributes,k=0,N=j.getAttributes();for(let F in N)if(N[F].location>=0){let Q=O[F],G=H[F];if(G===void 0&&(F==="instanceMatrix"&&L.instanceMatrix&&(G=L.instanceMatrix),F==="instanceColor"&&L.instanceColor&&(G=L.instanceColor)),Q===void 0||Q.attribute!==G||G&&Q.data!==G.data)return!0;k++}return c.attributesNum!==k||c.index!==z}function y(L,B,j,z){let O={},H=B.attributes,k=0,N=j.getAttributes();for(let F in N)if(N[F].location>=0){let Q=H[F];Q===void 0&&(F==="instanceMatrix"&&L.instanceMatrix&&(Q=L.instanceMatrix),F==="instanceColor"&&L.instanceColor&&(Q=L.instanceColor));let G={};G.attribute=Q,Q&&Q.data&&(G.data=Q.data),O[F]=G,k++}c.attributes=O,c.attributesNum=k,c.index=z}function x(){let L=c.newAttributes;for(let B=0,j=L.length;B<j;B++)L[B]=0}function _(L){b(L,0)}function b(L,B){let j=c.newAttributes,z=c.enabledAttributes,O=c.attributeDivisors;j[L]=1,z[L]===0&&(e.enableVertexAttribArray(L),z[L]=1),O[L]!==B&&((n.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](L,B),O[L]=B)}function w(){let L=c.newAttributes,B=c.enabledAttributes;for(let j=0,z=B.length;j<z;j++)B[j]!==L[j]&&(e.disableVertexAttribArray(j),B[j]=0)}function M(L,B,j,z,O,H){n.isWebGL2===!0&&(j===5124||j===5125)?e.vertexAttribIPointer(L,B,j,O,H):e.vertexAttribPointer(L,B,j,z,O,H)}function S(L,B,j,z){if(n.isWebGL2===!1&&(L.isInstancedMesh||z.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)return;x();let O=z.attributes,H=j.getAttributes(),k=B.defaultAttributeValues;for(let N in H){let F=H[N];if(F.location>=0){let Q=O[N];if(Q===void 0&&(N==="instanceMatrix"&&L.instanceMatrix&&(Q=L.instanceMatrix),N==="instanceColor"&&L.instanceColor&&(Q=L.instanceColor)),Q!==void 0){let G=Q.normalized,K=Q.itemSize,W=i.get(Q);if(W===void 0)continue;let se=W.buffer,ie=W.type,re=W.bytesPerElement;if(Q.isInterleavedBufferAttribute){let de=Q.data,he=de.stride,X=Q.offset;if(de.isInstancedInterleavedBuffer){for(let Ee=0;Ee<F.locationSize;Ee++)b(F.location+Ee,de.meshPerAttribute);L.isInstancedMesh!==!0&&z._maxInstanceCount===void 0&&(z._maxInstanceCount=de.meshPerAttribute*de.count)}else for(let Ee=0;Ee<F.locationSize;Ee++)_(F.location+Ee);e.bindBuffer(34962,se);for(let Ee=0;Ee<F.locationSize;Ee++)M(F.location+Ee,K/F.locationSize,ie,G,he*re,(X+K/F.locationSize*Ee)*re)}else{if(Q.isInstancedBufferAttribute){for(let de=0;de<F.locationSize;de++)b(F.location+de,Q.meshPerAttribute);L.isInstancedMesh!==!0&&z._maxInstanceCount===void 0&&(z._maxInstanceCount=Q.meshPerAttribute*Q.count)}else for(let de=0;de<F.locationSize;de++)_(F.location+de);e.bindBuffer(34962,se);for(let de=0;de<F.locationSize;de++)M(F.location+de,K/F.locationSize,ie,G,K*re,K/F.locationSize*de*re)}}else if(k!==void 0){let G=k[N];if(G!==void 0)switch(G.length){case 2:e.vertexAttrib2fv(F.location,G);break;case 3:e.vertexAttrib3fv(F.location,G);break;case 4:e.vertexAttrib4fv(F.location,G);break;default:e.vertexAttrib1fv(F.location,G)}}}}w()}function C(){I();for(let L in o){let B=o[L];for(let j in B){let z=B[j];for(let O in z)f(z[O].object),delete z[O];delete B[j]}delete o[L]}}function E(L){if(o[L.id]===void 0)return;let B=o[L.id];for(let j in B){let z=B[j];for(let O in z)f(z[O].object),delete z[O];delete B[j]}delete o[L.id]}function P(L){for(let B in o){let j=o[B];if(j[L.id]===void 0)continue;let z=j[L.id];for(let O in z)f(z[O].object),delete z[O];delete j[L.id]}}function I(){D(),u=!0,c!==l&&(c=l,p(c.object))}function D(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:h,reset:I,resetDefaultState:D,dispose:C,releaseStatesOfGeometry:E,releaseStatesOfProgram:P,initAttributes:x,enableAttribute:_,disableUnusedAttributes:w}}function gJ(e,t,i,n){let r=n.isWebGL2,s;function a(c){s=c}function o(c,u){e.drawArrays(s,c,u),i.update(u,s,1)}function l(c,u,h){if(h===0)return;let d,p;if(r)d=e,p="drawArraysInstanced";else if(d=t.get("ANGLE_instanced_arrays"),p="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[p](s,c,u,h),i.update(u,s,h)}this.setMode=a,this.render=o,this.renderInstances=l}function vJ(e,t,i){let n;function r(){if(n!==void 0)return n;if(t.has("EXT_texture_filter_anisotropic")===!0){let M=t.get("EXT_texture_filter_anisotropic");n=e.getParameter(M.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n}function s(M){if(M==="highp"){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";M="mediump"}return M==="mediump"&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}let a=typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext,o=i.precision!==void 0?i.precision:"highp",l=s(o);l!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",l,"instead."),o=l);let c=a||t.has("WEBGL_draw_buffers"),u=i.logarithmicDepthBuffer===!0,h=e.getParameter(34930),d=e.getParameter(35660),p=e.getParameter(3379),f=e.getParameter(34076),v=e.getParameter(34921),m=e.getParameter(36347),g=e.getParameter(36348),y=e.getParameter(36349),x=d>0,_=a||t.has("OES_texture_float"),b=x&&_,w=a?e.getParameter(36183):0;return{isWebGL2:a,drawBuffers:c,getMaxAnisotropy:r,getMaxPrecision:s,precision:o,logarithmicDepthBuffer:u,maxTextures:h,maxVertexTextures:d,maxTextureSize:p,maxCubemapSize:f,maxAttributes:v,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:y,vertexTextures:x,floatFragmentTextures:_,floatVertexTextures:b,maxSamples:w}}function yJ(e){let t=this,i=null,n=0,r=!1,s=!1,a=new Qr,o=new Sn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d){let p=h.length!==0||d||n!==0||r;return r=d,n=h.length,p},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,d){i=u(h,d,0)},this.setState=function(h,d,p){let f=h.clippingPlanes,v=h.clipIntersection,m=h.clipShadows,g=e.get(h);if(!r||f===null||f.length===0||s&&!m)s?u(null):c();else{let y=s?0:n,x=y*4,_=g.clippingState||null;l.value=_,_=u(f,d,x,p);for(let b=0;b!==x;++b)_[b]=i[b];g.clippingState=_,this.numIntersection=v?this.numPlanes:0,this.numPlanes+=y}};function c(){l.value!==i&&(l.value=i,l.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function u(h,d,p,f){let v=h!==null?h.length:0,m=null;if(v!==0){if(m=l.value,f!==!0||m===null){let g=p+v*4,y=d.matrixWorldInverse;o.getNormalMatrix(y),(m===null||m.length<g)&&(m=new Float32Array(g));for(let x=0,_=p;x!==v;++x,_+=4)a.copy(h[x]).applyMatrix4(y,o),a.normal.toArray(m,_),m[_+3]=a.constant}l.value=m,l.needsUpdate=!0}return t.numPlanes=v,t.numIntersection=0,m}}function xJ(e){let t=new WeakMap;function i(a,o){return o===rS?a.mapping=Gh:o===sS&&(a.mapping=jh),a}function n(a){if(a&&a.isTexture&&a.isRenderTargetTexture===!1){let o=a.mapping;if(o===rS||o===sS)if(t.has(a)){let l=t.get(a).texture;return i(l,a.mapping)}else{let l=a.image;if(l&&l.height>0){let c=new RQ(l.height/2);return c.fromEquirectangularTexture(e,a),t.set(a,c),a.addEventListener("dispose",r),i(c.texture,a.mapping)}else return null}}return a}function r(a){let o=a.target;o.removeEventListener("dispose",r);let l=t.get(o);l!==void 0&&(t.delete(o),l.dispose())}function s(){t=new WeakMap}return{get:n,dispose:s}}var CE=class extends qp{constructor(e=-1,t=1,i=1,n=-1,r=.1,s=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=n,this.near=r,this.far=s,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,n,r,s){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=s,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2,r=i-e,s=i+e,a=n+t,o=n-t;if(this.view!==null&&this.view.enabled){let l=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=l*this.view.offsetX,s=r+l*this.view.width,a-=c*this.view.offsetY,o=a-c*this.view.height}this.projectionMatrix.makeOrthographic(r,s,a,o,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}},Rd=4,E6=[.125,.215,.35,.446,.526,.582],ch=20,Q_=new CE,A6=new ut,K_=null,rh=(1+Math.sqrt(5))/2,Mu=1/rh,T6=[new T(1,1,1),new T(-1,1,1),new T(1,1,-1),new T(-1,1,-1),new T(0,rh,Mu),new T(0,rh,-Mu),new T(Mu,0,rh),new T(-Mu,0,rh),new T(rh,Mu,0),new T(-rh,Mu,0)],P6=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,n=100){K_=this._renderer.getRenderTarget(),this._setSize(256);let r=this._allocateTargets();return r.depthBuffer=!0,this._sceneToCubeUV(e,i,n,r),t>0&&this._blur(r,0,0,t),this._applyPMREM(r),this._cleanup(r),r}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=R6(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=L6(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(K_),e.scissorTest=!1,i1(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Gh||e.mapping===jh?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),K_=this._renderer.getRenderTarget();let i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Lt,minFilter:Lt,generateMipmaps:!1,type:_p,format:Ts,encoding:no,depthBuffer:!1},n=D6(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=D6(e,t,i);let{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=_J(r)),this._blurMaterial=bJ(r,e,t)}return n}_compileMaterial(e){let t=new Ar(this._lodPlanes[0],e);this._renderer.compile(t,Q_)}_sceneToCubeUV(e,t,i,n){let r=new Vn(90,1,t,i),s=[1,-1,1,1,1,1],a=[1,1,1,-1,-1,-1],o=this._renderer,l=o.autoClear,c=o.toneMapping;o.getClearColor(A6),o.toneMapping=tl,o.autoClear=!1;let u=new ig({name:"PMREM.Background",side:wn,depthWrite:!1,depthTest:!1}),h=new Ar(new ro,u),d=!1,p=e.background;p?p.isColor&&(u.color.copy(p),e.background=null,d=!0):(u.color.copy(A6),d=!0);for(let f=0;f<6;f++){let v=f%3;v===0?(r.up.set(0,s[f],0),r.lookAt(a[f],0,0)):v===1?(r.up.set(0,0,s[f]),r.lookAt(0,a[f],0)):(r.up.set(0,s[f],0),r.lookAt(0,0,a[f]));let m=this._cubeSize;i1(n,v*m,f>2?m:0,m,m),o.setRenderTarget(n),d&&o.render(h,r),o.render(e,r)}h.geometry.dispose(),h.material.dispose(),o.toneMapping=c,o.autoClear=l,e.background=p}_textureToCubeUV(e,t){let i=this._renderer,n=e.mapping===Gh||e.mapping===jh;n?(this._cubemapMaterial===null&&(this._cubemapMaterial=R6()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=L6());let r=n?this._cubemapMaterial:this._equirectMaterial,s=new Ar(this._lodPlanes[0],r),a=r.uniforms;a.envMap.value=e;let o=this._cubeSize;i1(t,0,0,3*o,2*o),i.setRenderTarget(t),i.render(s,Q_)}_applyPMREM(e){let t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let n=1;n<this._lodPlanes.length;n++){let r=Math.sqrt(this._sigmas[n]*this._sigmas[n]-this._sigmas[n-1]*this._sigmas[n-1]),s=T6[(n-1)%T6.length];this._blur(e,n-1,n,r,s)}t.autoClear=i}_blur(e,t,i,n,r){let s=this._pingPongRenderTarget;this._halfBlur(e,s,t,i,n,"latitudinal",r),this._halfBlur(s,e,i,i,n,"longitudinal",r)}_halfBlur(e,t,i,n,r,s,a){let o=this._renderer,l=this._blurMaterial;s!=="latitudinal"&&s!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");let c=3,u=new Ar(this._lodPlanes[n],l),h=l.uniforms,d=this._sizeLods[i]-1,p=isFinite(r)?Math.PI/(2*d):2*Math.PI/(2*ch-1),f=r/p,v=isFinite(r)?1+Math.floor(c*f):ch;v>ch&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${v} samples when the maximum is set to ${ch}`);let m=[],g=0;for(let w=0;w<ch;++w){let M=w/f,S=Math.exp(-M*M/2);m.push(S),w===0?g+=S:w<v&&(g+=2*S)}for(let w=0;w<m.length;w++)m[w]=m[w]/g;h.envMap.value=e.texture,h.samples.value=v,h.weights.value=m,h.latitudinal.value=s==="latitudinal",a&&(h.poleAxis.value=a);let{_lodMax:y}=this;h.dTheta.value=p,h.mipInt.value=y-i;let x=this._sizeLods[n],_=3*x*(n>y-Rd?n-y+Rd:0),b=4*(this._cubeSize-x);i1(t,_,b,3*x,2*x),o.setRenderTarget(t),o.render(u,Q_)}};function _J(e){let t=[],i=[],n=[],r=e,s=e-Rd+1+E6.length;for(let a=0;a<s;a++){let o=Math.pow(2,r);i.push(o);let l=1/o;a>e-Rd?l=E6[a-e+Rd-1]:a===0&&(l=0),n.push(l);let c=1/(o-2),u=-c,h=1+c,d=[u,u,h,u,h,h,u,u,h,h,u,h],p=6,f=6,v=3,m=2,g=1,y=new Float32Array(v*f*p),x=new Float32Array(m*f*p),_=new Float32Array(g*f*p);for(let w=0;w<p;w++){let M=w%3*2/3-1,S=w>2?0:-1,C=[M,S,0,M+2/3,S,0,M+2/3,S+1,0,M,S,0,M+2/3,S+1,0,M,S+1,0];y.set(C,v*f*w),x.set(d,m*f*w);let E=[w,w,w,w,w,w];_.set(E,g*f*w)}let b=new mt;b.setAttribute("position",new gt(y,v)),b.setAttribute("uv",new gt(x,m)),b.setAttribute("faceIndex",new gt(_,g)),t.push(b),r>Rd&&r--}return{lodPlanes:t,sizeLods:i,sigmas:n}}function D6(e,t,i){let n=new Qt(e,t,i);return n.texture.mapping=eg,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function i1(e,t,i,n,r){e.viewport.set(t,i,n,r),e.scissor.set(t,i,n,r)}function bJ(e,t,i){let n=new Float32Array(ch),r=new T(0,1,0);return new oi({name:"SphericalGaussianBlur",defines:{n:ch,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:EE(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Qi,depthTest:!1,depthWrite:!1})}function L6(){return new oi({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:EE(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Qi,depthTest:!1,depthWrite:!1})}function R6(){return new oi({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:EE(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Qi,depthTest:!1,depthWrite:!1})}function EE(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function wJ(e){let t=new WeakMap,i=null;function n(o){if(o&&o.isTexture){let l=o.mapping,c=l===rS||l===sS,u=l===Gh||l===jh;if(c||u)if(o.isRenderTargetTexture&&o.needsPMREMUpdate===!0){o.needsPMREMUpdate=!1;let h=t.get(o);return i===null&&(i=new P6(e)),h=c?i.fromEquirectangular(o,h):i.fromCubemap(o,h),t.set(o,h),h.texture}else{if(t.has(o))return t.get(o).texture;{let h=o.image;if(c&&h&&h.height>0||u&&h&&r(h)){i===null&&(i=new P6(e));let d=c?i.fromEquirectangular(o):i.fromCubemap(o);return t.set(o,d),o.addEventListener("dispose",s),d.texture}else return null}}}return o}function r(o){let l=0,c=6;for(let u=0;u<c;u++)o[u]!==void 0&&l++;return l===c}function s(o){let l=o.target;l.removeEventListener("dispose",s);let c=t.get(l);c!==void 0&&(t.delete(l),c.dispose())}function a(){t=new WeakMap,i!==null&&(i.dispose(),i=null)}return{get:n,dispose:a}}function SJ(e){let t={};function i(n){if(t[n]!==void 0)return t[n];let r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(n){return i(n)!==null},init:function(n){n.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture")},get:function(n){let r=i(n);return r===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function MJ(e,t,i,n){let r={},s=new WeakMap;function a(h){let d=h.target;d.index!==null&&t.remove(d.index);for(let f in d.attributes)t.remove(d.attributes[f]);d.removeEventListener("dispose",a),delete r[d.id];let p=s.get(d);p&&(t.remove(p),s.delete(d)),n.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,i.memory.geometries--}function o(h,d){return r[d.id]===!0||(d.addEventListener("dispose",a),r[d.id]=!0,i.memory.geometries++),d}function l(h){let d=h.attributes;for(let f in d)t.update(d[f],34962);let p=h.morphAttributes;for(let f in p){let v=p[f];for(let m=0,g=v.length;m<g;m++)t.update(v[m],34962)}}function c(h){let d=[],p=h.index,f=h.attributes.position,v=0;if(p!==null){let y=p.array;v=p.version;for(let x=0,_=y.length;x<_;x+=3){let b=y[x+0],w=y[x+1],M=y[x+2];d.push(b,w,w,M,M,b)}}else{let y=f.array;v=f.version;for(let x=0,_=y.length/3-1;x<_;x+=3){let b=x+0,w=x+1,M=x+2;d.push(b,w,w,M,M,b)}}let m=new(PB(d)?qd:OB)(d,1);m.version=v;let g=s.get(h);g&&t.remove(g),s.set(h,m)}function u(h){let d=s.get(h);if(d){let p=h.index;p!==null&&d.version<p.version&&c(h)}else c(h);return s.get(h)}return{get:o,update:l,getWireframeAttribute:u}}function CJ(e,t,i,n){let r=n.isWebGL2,s;function a(d){s=d}let o,l;function c(d){o=d.type,l=d.bytesPerElement}function u(d,p){e.drawElements(s,p,o,d*l),i.update(p,s,1)}function h(d,p,f){if(f===0)return;let v,m;if(r)v=e,m="drawElementsInstanced";else if(v=t.get("ANGLE_instanced_arrays"),m="drawElementsInstancedANGLE",v===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}v[m](s,p,o,d*l,f),i.update(p,s,f)}this.setMode=a,this.setIndex=c,this.render=u,this.renderInstances=h}function EJ(e){let t={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,a,o){switch(i.calls++,a){case 4:i.triangles+=o*(s/3);break;case 1:i.lines+=o*(s/2);break;case 3:i.lines+=o*(s-1);break;case 2:i.lines+=o*s;break;case 0:i.points+=o*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function r(){i.frame++,i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:t,render:i,programs:null,autoReset:!0,reset:r,update:n}}function AJ(e,t){return e[0]-t[0]}function TJ(e,t){return Math.abs(t[1])-Math.abs(e[1])}function PJ(e,t,i){let n={},r=new Float32Array(8),s=new WeakMap,a=new Ct,o=[];for(let c=0;c<8;c++)o[c]=[c,0];function l(c,u,h,d){let p=c.morphTargetInfluences;if(t.isWebGL2===!0){let f=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,v=f!==void 0?f.length:0,m=s.get(u);if(m===void 0||m.count!==v){let x=function(){L.dispose(),s.delete(u),u.removeEventListener("dispose",x)};m!==void 0&&m.texture.dispose();let _=u.morphAttributes.position!==void 0,b=u.morphAttributes.normal!==void 0,w=u.morphAttributes.color!==void 0,M=u.morphAttributes.position||[],S=u.morphAttributes.normal||[],C=u.morphAttributes.color||[],E=0;_===!0&&(E=1),b===!0&&(E=2),w===!0&&(E=3);let P=u.attributes.position.count*E,I=1;P>t.maxTextureSize&&(I=Math.ceil(P/t.maxTextureSize),P=t.maxTextureSize);let D=new Float32Array(P*I*4*v),L=new IB(D,P,I,v);L.type=es,L.needsUpdate=!0;let B=E*4;for(let j=0;j<v;j++){let z=M[j],O=S[j],H=C[j],k=P*I*4*j;for(let N=0;N<z.count;N++){let F=N*B;_===!0&&(a.fromBufferAttribute(z,N),D[k+F+0]=a.x,D[k+F+1]=a.y,D[k+F+2]=a.z,D[k+F+3]=0),b===!0&&(a.fromBufferAttribute(O,N),D[k+F+4]=a.x,D[k+F+5]=a.y,D[k+F+6]=a.z,D[k+F+7]=0),w===!0&&(a.fromBufferAttribute(H,N),D[k+F+8]=a.x,D[k+F+9]=a.y,D[k+F+10]=a.z,D[k+F+11]=H.itemSize===4?a.w:1)}}m={count:v,texture:L,size:new te(P,I)},s.set(u,m),u.addEventListener("dispose",x)}let g=0;for(let x=0;x<p.length;x++)g+=p[x];let y=u.morphTargetsRelative?1:1-g;d.getUniforms().setValue(e,"morphTargetBaseInfluence",y),d.getUniforms().setValue(e,"morphTargetInfluences",p),d.getUniforms().setValue(e,"morphTargetsTexture",m.texture,i),d.getUniforms().setValue(e,"morphTargetsTextureSize",m.size)}else{let f=p===void 0?0:p.length,v=n[u.id];if(v===void 0||v.length!==f){v=[];for(let _=0;_<f;_++)v[_]=[_,0];n[u.id]=v}for(let _=0;_<f;_++){let b=v[_];b[0]=_,b[1]=p[_]}v.sort(TJ);for(let _=0;_<8;_++)_<f&&v[_][1]?(o[_][0]=v[_][0],o[_][1]=v[_][1]):(o[_][0]=Number.MAX_SAFE_INTEGER,o[_][1]=0);o.sort(AJ);let m=u.morphAttributes.position,g=u.morphAttributes.normal,y=0;for(let _=0;_<8;_++){let b=o[_],w=b[0],M=b[1];w!==Number.MAX_SAFE_INTEGER&&M?(m&&u.getAttribute("morphTarget"+_)!==m[w]&&u.setAttribute("morphTarget"+_,m[w]),g&&u.getAttribute("morphNormal"+_)!==g[w]&&u.setAttribute("morphNormal"+_,g[w]),r[_]=M,y+=M):(m&&u.hasAttribute("morphTarget"+_)===!0&&u.deleteAttribute("morphTarget"+_),g&&u.hasAttribute("morphNormal"+_)===!0&&u.deleteAttribute("morphNormal"+_),r[_]=0)}let x=u.morphTargetsRelative?1:1-y;d.getUniforms().setValue(e,"morphTargetBaseInfluence",x),d.getUniforms().setValue(e,"morphTargetInfluences",r)}}return{update:l}}function DJ(e,t,i,n){let r=new WeakMap;function s(l){let c=n.render.frame,u=l.geometry,h=t.get(l,u);return r.get(h)!==c&&(t.update(h),r.set(h,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",o)===!1&&l.addEventListener("dispose",o),i.update(l.instanceMatrix,34962),l.instanceColor!==null&&i.update(l.instanceColor,34962)),h}function a(){r=new WeakMap}function o(l){let c=l.target;c.removeEventListener("dispose",o),i.remove(c.instanceMatrix),c.instanceColor!==null&&i.remove(c.instanceColor)}return{update:s,dispose:a}}var UB=new ln,FB=new IB,zB=new gQ,kB=new SE,I6=[],O6=[],B6=new Float32Array(16),N6=new Float32Array(9),U6=new Float32Array(4);function Yp(e,t,i){let n=e[0];if(n<=0||n>0)return e;let r=t*i,s=I6[r];if(s===void 0&&(s=new Float32Array(r),I6[r]=s),t!==0){n.toArray(s,0);for(let a=1,o=0;a!==t;++a)o+=i,e[a].toArray(s,o)}return s}function hn(e,t){if(e.length!==t.length)return!1;for(let i=0,n=e.length;i<n;i++)if(e[i]!==t[i])return!1;return!0}function un(e,t){for(let i=0,n=t.length;i<n;i++)e[i]=t[i]}function s2(e,t){let i=O6[t];i===void 0&&(i=new Int32Array(t),O6[t]=i);for(let n=0;n!==t;++n)i[n]=e.allocateTextureUnit();return i}function LJ(e,t){let i=this.cache;i[0]!==t&&(e.uniform1f(this.addr,t),i[0]=t)}function RJ(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(hn(i,t))return;e.uniform2fv(this.addr,t),un(i,t)}}function IJ(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else if(t.r!==void 0)(i[0]!==t.r||i[1]!==t.g||i[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),i[0]=t.r,i[1]=t.g,i[2]=t.b);else{if(hn(i,t))return;e.uniform3fv(this.addr,t),un(i,t)}}function OJ(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(hn(i,t))return;e.uniform4fv(this.addr,t),un(i,t)}}function BJ(e,t){let i=this.cache,n=t.elements;if(n===void 0){if(hn(i,t))return;e.uniformMatrix2fv(this.addr,!1,t),un(i,t)}else{if(hn(i,n))return;U6.set(n),e.uniformMatrix2fv(this.addr,!1,U6),un(i,n)}}function NJ(e,t){let i=this.cache,n=t.elements;if(n===void 0){if(hn(i,t))return;e.uniformMatrix3fv(this.addr,!1,t),un(i,t)}else{if(hn(i,n))return;N6.set(n),e.uniformMatrix3fv(this.addr,!1,N6),un(i,n)}}function UJ(e,t){let i=this.cache,n=t.elements;if(n===void 0){if(hn(i,t))return;e.uniformMatrix4fv(this.addr,!1,t),un(i,t)}else{if(hn(i,n))return;B6.set(n),e.uniformMatrix4fv(this.addr,!1,B6),un(i,n)}}function FJ(e,t){let i=this.cache;i[0]!==t&&(e.uniform1i(this.addr,t),i[0]=t)}function zJ(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(hn(i,t))return;e.uniform2iv(this.addr,t),un(i,t)}}function kJ(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else{if(hn(i,t))return;e.uniform3iv(this.addr,t),un(i,t)}}function VJ(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(hn(i,t))return;e.uniform4iv(this.addr,t),un(i,t)}}function HJ(e,t){let i=this.cache;i[0]!==t&&(e.uniform1ui(this.addr,t),i[0]=t)}function GJ(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(hn(i,t))return;e.uniform2uiv(this.addr,t),un(i,t)}}function jJ(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else{if(hn(i,t))return;e.uniform3uiv(this.addr,t),un(i,t)}}function WJ(e,t){let i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(hn(i,t))return;e.uniform4uiv(this.addr,t),un(i,t)}}function XJ(e,t,i){let n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTexture2D(t||UB,r)}function qJ(e,t,i){let n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTexture3D(t||zB,r)}function YJ(e,t,i){let n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTextureCube(t||kB,r)}function ZJ(e,t,i){let n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTexture2DArray(t||FB,r)}function QJ(e){switch(e){case 5126:return LJ;case 35664:return RJ;case 35665:return IJ;case 35666:return OJ;case 35674:return BJ;case 35675:return NJ;case 35676:return UJ;case 5124:case 35670:return FJ;case 35667:case 35671:return zJ;case 35668:case 35672:return kJ;case 35669:case 35673:return VJ;case 5125:return HJ;case 36294:return GJ;case 36295:return jJ;case 36296:return WJ;case 35678:case 36198:case 36298:case 36306:case 35682:return XJ;case 35679:case 36299:case 36307:return qJ;case 35680:case 36300:case 36308:case 36293:return YJ;case 36289:case 36303:case 36311:case 36292:return ZJ}}function KJ(e,t){e.uniform1fv(this.addr,t)}function $J(e,t){let i=Yp(t,this.size,2);e.uniform2fv(this.addr,i)}function JJ(e,t){let i=Yp(t,this.size,3);e.uniform3fv(this.addr,i)}function eee(e,t){let i=Yp(t,this.size,4);e.uniform4fv(this.addr,i)}function tee(e,t){let i=Yp(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,i)}function iee(e,t){let i=Yp(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,i)}function nee(e,t){let i=Yp(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,i)}function ree(e,t){e.uniform1iv(this.addr,t)}function see(e,t){e.uniform2iv(this.addr,t)}function aee(e,t){e.uniform3iv(this.addr,t)}function oee(e,t){e.uniform4iv(this.addr,t)}function lee(e,t){e.uniform1uiv(this.addr,t)}function cee(e,t){e.uniform2uiv(this.addr,t)}function hee(e,t){e.uniform3uiv(this.addr,t)}function uee(e,t){e.uniform4uiv(this.addr,t)}function dee(e,t,i){let n=this.cache,r=t.length,s=s2(i,r);hn(n,s)||(e.uniform1iv(this.addr,s),un(n,s));for(let a=0;a!==r;++a)i.setTexture2D(t[a]||UB,s[a])}function pee(e,t,i){let n=this.cache,r=t.length,s=s2(i,r);hn(n,s)||(e.uniform1iv(this.addr,s),un(n,s));for(let a=0;a!==r;++a)i.setTexture3D(t[a]||zB,s[a])}function fee(e,t,i){let n=this.cache,r=t.length,s=s2(i,r);hn(n,s)||(e.uniform1iv(this.addr,s),un(n,s));for(let a=0;a!==r;++a)i.setTextureCube(t[a]||kB,s[a])}function mee(e,t,i){let n=this.cache,r=t.length,s=s2(i,r);hn(n,s)||(e.uniform1iv(this.addr,s),un(n,s));for(let a=0;a!==r;++a)i.setTexture2DArray(t[a]||FB,s[a])}function gee(e){switch(e){case 5126:return KJ;case 35664:return $J;case 35665:return JJ;case 35666:return eee;case 35674:return tee;case 35675:return iee;case 35676:return nee;case 5124:case 35670:return ree;case 35667:case 35671:return see;case 35668:case 35672:return aee;case 35669:case 35673:return oee;case 5125:return lee;case 36294:return cee;case 36295:return hee;case 36296:return uee;case 35678:case 36198:case 36298:case 36306:case 35682:return dee;case 35679:case 36299:case 36307:return pee;case 35680:case 36300:case 36308:case 36293:return fee;case 36289:case 36303:case 36311:case 36292:return mee}}var vee=class{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=QJ(t.type)}},yee=class{constructor(t,i,n){this.id=t,this.addr=n,this.cache=[],this.size=i.size,this.setValue=gee(i.type)}},xee=class{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){let n=this.seq;for(let r=0,s=n.length;r!==s;++r){let a=n[r];a.setValue(e,t[a.id],i)}}},$_=/(\w+)(\])?(\[|\.)?/g;function F6(e,t){e.seq.push(t),e.map[t.id]=t}function _ee(e,t,i){let n=e.name,r=n.length;for($_.lastIndex=0;;){let s=$_.exec(n),a=$_.lastIndex,o=s[1],l=s[2]==="]",c=s[3];if(l&&(o=o|0),c===void 0||c==="["&&a+2===r){F6(i,c===void 0?new vee(o,e,t):new yee(o,e,t));break}else{let u=i.map[o];u===void 0&&(u=new xee(o),F6(i,u)),i=u}}}var zv=class{constructor(e,t){this.seq=[],this.map={};let i=e.getProgramParameter(t,35718);for(let n=0;n<i;++n){let r=e.getActiveUniform(t,n),s=e.getUniformLocation(t,r.name);_ee(r,s,this)}}setValue(e,t,i,n){let r=this.map[t];r!==void 0&&r.setValue(e,i,n)}setOptional(e,t,i){let n=t[i];n!==void 0&&this.setValue(e,i,n)}static upload(e,t,i,n){for(let r=0,s=t.length;r!==s;++r){let a=t[r],o=i[a.id];o.needsUpdate!==!1&&a.setValue(e,o.value,n)}}static seqWithValue(e,t){let i=[];for(let n=0,r=e.length;n!==r;++n){let s=e[n];s.id in t&&i.push(s)}return i}};function z6(e,t,i){let n=e.createShader(t);return e.shaderSource(n,i),e.compileShader(n),n}var bee=0;function wee(e,t){let i=e.split(`
`),n=[],r=Math.max(t-6,0),s=Math.min(t+6,i.length);for(let a=r;a<s;a++){let o=a+1;n.push(`${o===t?">":" "} ${o}: ${i[a]}`)}return n.join(`
`)}function See(e){switch(e){case no:return["Linear","( value )"];case Mt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function k6(e,t,i){let n=e.getShaderParameter(t,35713),r=e.getShaderInfoLog(t).trim();if(n&&r==="")return"";let s=/ERROR: 0:(\d+)/.exec(r);if(s){let a=parseInt(s[1]);return i.toUpperCase()+`

`+r+`

`+wee(e.getShaderSource(t),a)}else return r}function Mee(e,t){let i=See(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function Cee(e,t){let i;switch(t){case LZ:i="Linear";break;case RZ:i="Reinhard";break;case IZ:i="OptimizedCineon";break;case OZ:i="ACESFilmic";break;case BZ:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),i="Linear"}return"vec3 "+e+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function Eee(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||e.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(um).join(`
`)}function Aee(e){let t=[];for(let i in e){let n=e[i];n!==!1&&t.push("#define "+i+" "+n)}return t.join(`
`)}function Tee(e,t){let i={},n=e.getProgramParameter(t,35721);for(let r=0;r<n;r++){let s=e.getActiveAttrib(t,r),a=s.name,o=1;s.type===35674&&(o=2),s.type===35675&&(o=3),s.type===35676&&(o=4),i[a]={type:s.type,location:e.getAttribLocation(t,a),locationSize:o}}return i}function um(e){return e!==""}function V6(e,t){let i=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function H6(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var Pee=/^[ \t]*#include +<([\w\d./]+)>/gm;function hS(e){return e.replace(Pee,Dee)}function Dee(e,t){let i=Et[t];if(i===void 0)throw new Error("Can not resolve #include <"+t+">");return hS(i)}var Lee=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function G6(e){return e.replace(Lee,Ree)}function Ree(e,t,i,n){let r="";for(let s=parseInt(t);s<parseInt(i);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function j6(e){let t="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?t+=`
#define HIGH_PRECISION`:e.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function Iee(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===yE?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===cZ?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===hm&&(t="SHADOWMAP_TYPE_VSM"),t}function Oee(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Gh:case jh:t="ENVMAP_TYPE_CUBE";break;case eg:t="ENVMAP_TYPE_CUBE_UV";break}return t}function Bee(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case jh:t="ENVMAP_MODE_REFRACTION";break}return t}function Nee(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case bB:t="ENVMAP_BLENDING_MULTIPLY";break;case PZ:t="ENVMAP_BLENDING_MIX";break;case DZ:t="ENVMAP_BLENDING_ADD";break}return t}function Uee(e){let t=e.envMapCubeUVHeight;if(t===null)return null;let i=Math.log2(t)-2,n=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,i),7*16)),texelHeight:n,maxMip:i}}function Fee(e,t,i,n){let r=e.getContext(),s=i.defines,a=i.vertexShader,o=i.fragmentShader,l=Iee(i),c=Oee(i),u=Bee(i),h=Nee(i),d=Uee(i),p=i.isWebGL2?"":Eee(i),f=Aee(s),v=r.createProgram(),m,g,y=i.glslVersion?"#version "+i.glslVersion+`
`:"";i.isRawShaderMaterial?(m=[f].filter(um).join(`
`),m.length>0&&(m+=`
`),g=[p,f].filter(um).join(`
`),g.length>0&&(g+=`
`)):(m=[j6(i),"#define SHADER_NAME "+i.shaderName,f,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.supportsVertexTextures?"#define VERTEX_TEXTURES":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+u:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.morphColors&&i.isWebGL2?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(um).join(`
`),g=[p,j6(i),"#define SHADER_NAME "+i.shaderName,f,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+c:"",i.envMap?"#define "+u:"",i.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==tl?"#define TONE_MAPPING":"",i.toneMapping!==tl?Et.tonemapping_pars_fragment:"",i.toneMapping!==tl?Cee("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",Et.encodings_pars_fragment,Mee("linearToOutputTexel",i.outputEncoding),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(um).join(`
`)),a=hS(a),a=V6(a,i),a=H6(a,i),o=hS(o),o=V6(o,i),o=H6(o,i),a=G6(a),o=G6(o),i.isWebGL2&&i.isRawShaderMaterial!==!0&&(y=`#version 300 es
`,m=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+m,g=["#define varying in",i.glslVersion===f6?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===f6?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+g);let x=y+m+a,_=y+g+o,b=z6(r,35633,x),w=z6(r,35632,_);if(r.attachShader(v,b),r.attachShader(v,w),i.index0AttributeName!==void 0?r.bindAttribLocation(v,0,i.index0AttributeName):i.morphTargets===!0&&r.bindAttribLocation(v,0,"position"),r.linkProgram(v),e.debug.checkShaderErrors){let C=r.getProgramInfoLog(v).trim(),E=r.getShaderInfoLog(b).trim(),P=r.getShaderInfoLog(w).trim(),I=!0,D=!0;if(r.getProgramParameter(v,35714)===!1){I=!1;let L=k6(r,b,"vertex"),B=k6(r,w,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(v,35715)+`

Program Info Log: `+C+`
`+L+`
`+B)}else C!==""?console.warn("THREE.WebGLProgram: Program Info Log:",C):(E===""||P==="")&&(D=!1);D&&(this.diagnostics={runnable:I,programLog:C,vertexShader:{log:E,prefix:m},fragmentShader:{log:P,prefix:g}})}r.deleteShader(b),r.deleteShader(w);let M;this.getUniforms=function(){return M===void 0&&(M=new zv(r,v)),M};let S;return this.getAttributes=function(){return S===void 0&&(S=Tee(r,v)),S},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(v),this.program=void 0},this.name=i.shaderName,this.id=bee++,this.cacheKey=t,this.usedTimes=1,this.program=v,this.vertexShader=b,this.fragmentShader=w,this}var zee=0,kee=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,i=e.fragmentShader,n=this._getShaderStage(t),r=this._getShaderStage(i),s=this._getShaderCacheForMaterial(e);return s.has(n)===!1&&(s.add(n),n.usedTimes++),s.has(r)===!1&&(s.add(r),r.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){let t=this.shaderCache,i=t.get(e);return i===void 0&&(i=new Vee(e),t.set(e,i)),i}},Vee=class{constructor(e){this.id=zee++,this.code=e,this.usedTimes=0}};function Hee(e,t,i,n,r,s,a){let o=new wE,l=new kee,c=[],u=r.isWebGL2,h=r.logarithmicDepthBuffer,d=r.vertexTextures,p=r.precision,f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(S,C,E,P,I){let D=P.fog,L=I.geometry,B=S.isMeshStandardMaterial?P.environment:null,j=(S.isMeshStandardMaterial?i:t).get(S.envMap||B),z=j&&j.mapping===eg?j.image.height:null,O=f[S.type];S.precision!==null&&(p=r.getMaxPrecision(S.precision),p!==S.precision&&console.warn("THREE.WebGLProgram.getParameters:",S.precision,"not supported, using",p,"instead."));let H=L.morphAttributes.position||L.morphAttributes.normal||L.morphAttributes.color,k=H!==void 0?H.length:0,N=0;L.morphAttributes.position!==void 0&&(N=1),L.morphAttributes.normal!==void 0&&(N=2),L.morphAttributes.color!==void 0&&(N=3);let F,Q,G,K;if(O){let de=za[O];F=de.vertexShader,Q=de.fragmentShader}else F=S.vertexShader,Q=S.fragmentShader,l.update(S),G=l.getVertexShaderID(S),K=l.getFragmentShaderID(S);let W=e.getRenderTarget(),se=S.alphaTest>0,ie=S.clearcoat>0,re=S.iridescence>0;return{isWebGL2:u,shaderID:O,shaderName:S.type,vertexShader:F,fragmentShader:Q,defines:S.defines,customVertexShaderID:G,customFragmentShaderID:K,isRawShaderMaterial:S.isRawShaderMaterial===!0,glslVersion:S.glslVersion,precision:p,instancing:I.isInstancedMesh===!0,instancingColor:I.isInstancedMesh===!0&&I.instanceColor!==null,supportsVertexTextures:d,outputEncoding:W===null?e.outputEncoding:W.isXRRenderTarget===!0?W.texture.encoding:no,map:!!S.map,matcap:!!S.matcap,envMap:!!j,envMapMode:j&&j.mapping,envMapCubeUVHeight:z,lightMap:!!S.lightMap,aoMap:!!S.aoMap,emissiveMap:!!S.emissiveMap,bumpMap:!!S.bumpMap,normalMap:!!S.normalMap,objectSpaceNormalMap:S.normalMapType===JZ,tangentSpaceNormalMap:S.normalMapType===$Z,decodeVideoTexture:!!S.map&&S.map.isVideoTexture===!0&&S.map.encoding===Mt,clearcoat:ie,clearcoatMap:ie&&!!S.clearcoatMap,clearcoatRoughnessMap:ie&&!!S.clearcoatRoughnessMap,clearcoatNormalMap:ie&&!!S.clearcoatNormalMap,iridescence:re,iridescenceMap:re&&!!S.iridescenceMap,iridescenceThicknessMap:re&&!!S.iridescenceThicknessMap,displacementMap:!!S.displacementMap,roughnessMap:!!S.roughnessMap,metalnessMap:!!S.metalnessMap,specularMap:!!S.specularMap,specularIntensityMap:!!S.specularIntensityMap,specularColorMap:!!S.specularColorMap,opaque:S.transparent===!1&&S.blending===Xd,alphaMap:!!S.alphaMap,alphaTest:se,gradientMap:!!S.gradientMap,sheen:S.sheen>0,sheenColorMap:!!S.sheenColorMap,sheenRoughnessMap:!!S.sheenRoughnessMap,transmission:S.transmission>0,transmissionMap:!!S.transmissionMap,thicknessMap:!!S.thicknessMap,combine:S.combine,vertexTangents:!!S.normalMap&&!!L.attributes.tangent,vertexColors:S.vertexColors,vertexAlphas:S.vertexColors===!0&&!!L.attributes.color&&L.attributes.color.itemSize===4,vertexUvs:!!S.map||!!S.bumpMap||!!S.normalMap||!!S.specularMap||!!S.alphaMap||!!S.emissiveMap||!!S.roughnessMap||!!S.metalnessMap||!!S.clearcoatMap||!!S.clearcoatRoughnessMap||!!S.clearcoatNormalMap||!!S.iridescenceMap||!!S.iridescenceThicknessMap||!!S.displacementMap||!!S.transmissionMap||!!S.thicknessMap||!!S.specularIntensityMap||!!S.specularColorMap||!!S.sheenColorMap||!!S.sheenRoughnessMap,uvsVertexOnly:!(S.map||S.bumpMap||S.normalMap||S.specularMap||S.alphaMap||S.emissiveMap||S.roughnessMap||S.metalnessMap||S.clearcoatNormalMap||S.iridescenceMap||S.iridescenceThicknessMap||S.transmission>0||S.transmissionMap||S.thicknessMap||S.specularIntensityMap||S.specularColorMap||S.sheen>0||S.sheenColorMap||S.sheenRoughnessMap)&&!!S.displacementMap,fog:!!D,useFog:S.fog===!0,fogExp2:D&&D.isFogExp2,flatShading:!!S.flatShading,sizeAttenuation:S.sizeAttenuation,logarithmicDepthBuffer:h,skinning:I.isSkinnedMesh===!0,morphTargets:L.morphAttributes.position!==void 0,morphNormals:L.morphAttributes.normal!==void 0,morphColors:L.morphAttributes.color!==void 0,morphTargetsCount:k,morphTextureStride:N,numDirLights:C.directional.length,numPointLights:C.point.length,numSpotLights:C.spot.length,numSpotLightMaps:C.spotLightMap.length,numRectAreaLights:C.rectArea.length,numHemiLights:C.hemi.length,numDirLightShadows:C.directionalShadowMap.length,numPointLightShadows:C.pointShadowMap.length,numSpotLightShadows:C.spotShadowMap.length,numSpotLightShadowsWithMaps:C.numSpotLightShadowsWithMaps,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:S.dithering,shadowMapEnabled:e.shadowMap.enabled&&E.length>0,shadowMapType:e.shadowMap.type,toneMapping:S.toneMapped?e.toneMapping:tl,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:S.premultipliedAlpha,doubleSided:S.side===Jr,flipSided:S.side===wn,useDepthPacking:!!S.depthPacking,depthPacking:S.depthPacking||0,index0AttributeName:S.index0AttributeName,extensionDerivatives:S.extensions&&S.extensions.derivatives,extensionFragDepth:S.extensions&&S.extensions.fragDepth,extensionDrawBuffers:S.extensions&&S.extensions.drawBuffers,extensionShaderTextureLOD:S.extensions&&S.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||n.has("EXT_shader_texture_lod"),customProgramCacheKey:S.customProgramCacheKey()}}function m(S){let C=[];if(S.shaderID?C.push(S.shaderID):(C.push(S.customVertexShaderID),C.push(S.customFragmentShaderID)),S.defines!==void 0)for(let E in S.defines)C.push(E),C.push(S.defines[E]);return S.isRawShaderMaterial===!1&&(g(C,S),y(C,S),C.push(e.outputEncoding)),C.push(S.customProgramCacheKey),C.join()}function g(S,C){S.push(C.precision),S.push(C.outputEncoding),S.push(C.envMapMode),S.push(C.envMapCubeUVHeight),S.push(C.combine),S.push(C.vertexUvs),S.push(C.fogExp2),S.push(C.sizeAttenuation),S.push(C.morphTargetsCount),S.push(C.morphAttributeCount),S.push(C.numDirLights),S.push(C.numPointLights),S.push(C.numSpotLights),S.push(C.numSpotLightMaps),S.push(C.numHemiLights),S.push(C.numRectAreaLights),S.push(C.numDirLightShadows),S.push(C.numPointLightShadows),S.push(C.numSpotLightShadows),S.push(C.numSpotLightShadowsWithMaps),S.push(C.shadowMapType),S.push(C.toneMapping),S.push(C.numClippingPlanes),S.push(C.numClipIntersection),S.push(C.depthPacking)}function y(S,C){o.disableAll(),C.isWebGL2&&o.enable(0),C.supportsVertexTextures&&o.enable(1),C.instancing&&o.enable(2),C.instancingColor&&o.enable(3),C.map&&o.enable(4),C.matcap&&o.enable(5),C.envMap&&o.enable(6),C.lightMap&&o.enable(7),C.aoMap&&o.enable(8),C.emissiveMap&&o.enable(9),C.bumpMap&&o.enable(10),C.normalMap&&o.enable(11),C.objectSpaceNormalMap&&o.enable(12),C.tangentSpaceNormalMap&&o.enable(13),C.clearcoat&&o.enable(14),C.clearcoatMap&&o.enable(15),C.clearcoatRoughnessMap&&o.enable(16),C.clearcoatNormalMap&&o.enable(17),C.iridescence&&o.enable(18),C.iridescenceMap&&o.enable(19),C.iridescenceThicknessMap&&o.enable(20),C.displacementMap&&o.enable(21),C.specularMap&&o.enable(22),C.roughnessMap&&o.enable(23),C.metalnessMap&&o.enable(24),C.gradientMap&&o.enable(25),C.alphaMap&&o.enable(26),C.alphaTest&&o.enable(27),C.vertexColors&&o.enable(28),C.vertexAlphas&&o.enable(29),C.vertexUvs&&o.enable(30),C.vertexTangents&&o.enable(31),C.uvsVertexOnly&&o.enable(32),S.push(o.mask),o.disableAll(),C.fog&&o.enable(0),C.useFog&&o.enable(1),C.flatShading&&o.enable(2),C.logarithmicDepthBuffer&&o.enable(3),C.skinning&&o.enable(4),C.morphTargets&&o.enable(5),C.morphNormals&&o.enable(6),C.morphColors&&o.enable(7),C.premultipliedAlpha&&o.enable(8),C.shadowMapEnabled&&o.enable(9),C.physicallyCorrectLights&&o.enable(10),C.doubleSided&&o.enable(11),C.flipSided&&o.enable(12),C.useDepthPacking&&o.enable(13),C.dithering&&o.enable(14),C.specularIntensityMap&&o.enable(15),C.specularColorMap&&o.enable(16),C.transmission&&o.enable(17),C.transmissionMap&&o.enable(18),C.thicknessMap&&o.enable(19),C.sheen&&o.enable(20),C.sheenColorMap&&o.enable(21),C.sheenRoughnessMap&&o.enable(22),C.decodeVideoTexture&&o.enable(23),C.opaque&&o.enable(24),S.push(o.mask)}function x(S){let C=f[S.type],E;if(C){let P=za[C];E=Xp.clone(P.uniforms)}else E=S.uniforms;return E}function _(S,C){let E;for(let P=0,I=c.length;P<I;P++){let D=c[P];if(D.cacheKey===C){E=D,++E.usedTimes;break}}return E===void 0&&(E=new Fee(e,C,S,s),c.push(E)),E}function b(S){if(--S.usedTimes===0){let C=c.indexOf(S);c[C]=c[c.length-1],c.pop(),S.destroy()}}function w(S){l.remove(S)}function M(){l.dispose()}return{getParameters:v,getProgramCacheKey:m,getUniforms:x,acquireProgram:_,releaseProgram:b,releaseShaderCache:w,programs:c,dispose:M}}function Gee(){let e=new WeakMap;function t(s){let a=e.get(s);return a===void 0&&(a={},e.set(s,a)),a}function i(s){e.delete(s)}function n(s,a,o){e.get(s)[a]=o}function r(){e=new WeakMap}return{get:t,remove:i,update:n,dispose:r}}function jee(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function W6(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function X6(){let e=[],t=0,i=[],n=[],r=[];function s(){t=0,i.length=0,n.length=0,r.length=0}function a(h,d,p,f,v,m){let g=e[t];return g===void 0?(g={id:h.id,object:h,geometry:d,material:p,groupOrder:f,renderOrder:h.renderOrder,z:v,group:m},e[t]=g):(g.id=h.id,g.object=h,g.geometry=d,g.material=p,g.groupOrder=f,g.renderOrder=h.renderOrder,g.z=v,g.group=m),t++,g}function o(h,d,p,f,v,m){let g=a(h,d,p,f,v,m);p.transmission>0?n.push(g):p.transparent===!0?r.push(g):i.push(g)}function l(h,d,p,f,v,m){let g=a(h,d,p,f,v,m);p.transmission>0?n.unshift(g):p.transparent===!0?r.unshift(g):i.unshift(g)}function c(h,d){i.length>1&&i.sort(h||jee),n.length>1&&n.sort(d||W6),r.length>1&&r.sort(d||W6)}function u(){for(let h=t,d=e.length;h<d;h++){let p=e[h];if(p.id===null)break;p.id=null,p.object=null,p.geometry=null,p.material=null,p.group=null}}return{opaque:i,transmissive:n,transparent:r,init:s,push:o,unshift:l,finish:u,sort:c}}function Wee(){let e=new WeakMap;function t(n,r){let s=e.get(n),a;return s===void 0?(a=new X6,e.set(n,[a])):r>=s.length?(a=new X6,s.push(a)):a=s[r],a}function i(){e=new WeakMap}return{get:t,dispose:i}}function Xee(){let e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let i;switch(t.type){case"DirectionalLight":i={direction:new T,color:new ut};break;case"SpotLight":i={position:new T,direction:new T,color:new ut,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new T,color:new ut,distance:0,decay:0};break;case"HemisphereLight":i={direction:new T,skyColor:new ut,groundColor:new ut};break;case"RectAreaLight":i={color:new ut,position:new T,halfWidth:new T,halfHeight:new T};break}return e[t.id]=i,i}}}function qee(){let e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let i;switch(t.type){case"DirectionalLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new te};break;case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new te};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new te,shadowCameraNear:1,shadowCameraFar:1e3};break}return e[t.id]=i,i}}}var Yee=0;function Zee(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function Qee(e,t){let i=new Xee,n=qee(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let u=0;u<9;u++)r.probe.push(new T);let s=new T,a=new ke,o=new ke;function l(u,h){let d=0,p=0,f=0;for(let P=0;P<9;P++)r.probe[P].set(0,0,0);let v=0,m=0,g=0,y=0,x=0,_=0,b=0,w=0,M=0,S=0;u.sort(Zee);let C=h!==!0?Math.PI:1;for(let P=0,I=u.length;P<I;P++){let D=u[P],L=D.color,B=D.intensity,j=D.distance,z=D.shadow&&D.shadow.map?D.shadow.map.texture:null;if(D.isAmbientLight)d+=L.r*B*C,p+=L.g*B*C,f+=L.b*B*C;else if(D.isLightProbe)for(let O=0;O<9;O++)r.probe[O].addScaledVector(D.sh.coefficients[O],B);else if(D.isDirectionalLight){let O=i.get(D);if(O.color.copy(D.color).multiplyScalar(D.intensity*C),D.castShadow){let H=D.shadow,k=n.get(D);k.shadowBias=H.bias,k.shadowNormalBias=H.normalBias,k.shadowRadius=H.radius,k.shadowMapSize=H.mapSize,r.directionalShadow[v]=k,r.directionalShadowMap[v]=z,r.directionalShadowMatrix[v]=D.shadow.matrix,_++}r.directional[v]=O,v++}else if(D.isSpotLight){let O=i.get(D);O.position.setFromMatrixPosition(D.matrixWorld),O.color.copy(L).multiplyScalar(B*C),O.distance=j,O.coneCos=Math.cos(D.angle),O.penumbraCos=Math.cos(D.angle*(1-D.penumbra)),O.decay=D.decay,r.spot[g]=O;let H=D.shadow;if(D.map&&(r.spotLightMap[M]=D.map,M++,H.updateMatrices(D),D.castShadow&&S++),r.spotLightMatrix[g]=H.matrix,D.castShadow){let k=n.get(D);k.shadowBias=H.bias,k.shadowNormalBias=H.normalBias,k.shadowRadius=H.radius,k.shadowMapSize=H.mapSize,r.spotShadow[g]=k,r.spotShadowMap[g]=z,w++}g++}else if(D.isRectAreaLight){let O=i.get(D);O.color.copy(L).multiplyScalar(B),O.halfWidth.set(D.width*.5,0,0),O.halfHeight.set(0,D.height*.5,0),r.rectArea[y]=O,y++}else if(D.isPointLight){let O=i.get(D);if(O.color.copy(D.color).multiplyScalar(D.intensity*C),O.distance=D.distance,O.decay=D.decay,D.castShadow){let H=D.shadow,k=n.get(D);k.shadowBias=H.bias,k.shadowNormalBias=H.normalBias,k.shadowRadius=H.radius,k.shadowMapSize=H.mapSize,k.shadowCameraNear=H.camera.near,k.shadowCameraFar=H.camera.far,r.pointShadow[m]=k,r.pointShadowMap[m]=z,r.pointShadowMatrix[m]=D.shadow.matrix,b++}r.point[m]=O,m++}else if(D.isHemisphereLight){let O=i.get(D);O.skyColor.copy(D.color).multiplyScalar(B*C),O.groundColor.copy(D.groundColor).multiplyScalar(B*C),r.hemi[x]=O,x++}}y>0&&(t.isWebGL2||e.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=We.LTC_FLOAT_1,r.rectAreaLTC2=We.LTC_FLOAT_2):e.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=We.LTC_HALF_1,r.rectAreaLTC2=We.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=p,r.ambient[2]=f;let E=r.hash;(E.directionalLength!==v||E.pointLength!==m||E.spotLength!==g||E.rectAreaLength!==y||E.hemiLength!==x||E.numDirectionalShadows!==_||E.numPointShadows!==b||E.numSpotShadows!==w||E.numSpotMaps!==M)&&(r.directional.length=v,r.spot.length=g,r.rectArea.length=y,r.point.length=m,r.hemi.length=x,r.directionalShadow.length=_,r.directionalShadowMap.length=_,r.pointShadow.length=b,r.pointShadowMap.length=b,r.spotShadow.length=w,r.spotShadowMap.length=w,r.directionalShadowMatrix.length=_,r.pointShadowMatrix.length=b,r.spotLightMatrix.length=w+M-S,r.spotLightMap.length=M,r.numSpotLightShadowsWithMaps=S,E.directionalLength=v,E.pointLength=m,E.spotLength=g,E.rectAreaLength=y,E.hemiLength=x,E.numDirectionalShadows=_,E.numPointShadows=b,E.numSpotShadows=w,E.numSpotMaps=M,r.version=Yee++)}function c(u,h){let d=0,p=0,f=0,v=0,m=0,g=h.matrixWorldInverse;for(let y=0,x=u.length;y<x;y++){let _=u[y];if(_.isDirectionalLight){let b=r.directional[d];b.direction.setFromMatrixPosition(_.matrixWorld),s.setFromMatrixPosition(_.target.matrixWorld),b.direction.sub(s),b.direction.transformDirection(g),d++}else if(_.isSpotLight){let b=r.spot[f];b.position.setFromMatrixPosition(_.matrixWorld),b.position.applyMatrix4(g),b.direction.setFromMatrixPosition(_.matrixWorld),s.setFromMatrixPosition(_.target.matrixWorld),b.direction.sub(s),b.direction.transformDirection(g),f++}else if(_.isRectAreaLight){let b=r.rectArea[v];b.position.setFromMatrixPosition(_.matrixWorld),b.position.applyMatrix4(g),o.identity(),a.copy(_.matrixWorld),a.premultiply(g),o.extractRotation(a),b.halfWidth.set(_.width*.5,0,0),b.halfHeight.set(0,_.height*.5,0),b.halfWidth.applyMatrix4(o),b.halfHeight.applyMatrix4(o),v++}else if(_.isPointLight){let b=r.point[p];b.position.setFromMatrixPosition(_.matrixWorld),b.position.applyMatrix4(g),p++}else if(_.isHemisphereLight){let b=r.hemi[m];b.direction.setFromMatrixPosition(_.matrixWorld),b.direction.transformDirection(g),m++}}}return{setup:l,setupView:c,state:r}}function q6(e,t){let i=new Qee(e,t),n=[],r=[];function s(){n.length=0,r.length=0}function a(u){n.push(u)}function o(u){r.push(u)}function l(u){i.setup(n,u)}function c(u){i.setupView(n,u)}return{init:s,state:{lightsArray:n,shadowsArray:r,lights:i},setupLights:l,setupLightsView:c,pushLight:a,pushShadow:o}}function Kee(e,t){let i=new WeakMap;function n(s,a=0){let o=i.get(s),l;return o===void 0?(l=new q6(e,t),i.set(s,[l])):a>=o.length?(l=new q6(e,t),o.push(l)):l=o[a],l}function r(){i=new WeakMap}return{get:n,dispose:r}}var VB=class extends tg{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=pl,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}},$ee=class extends tg{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new T,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}},Jee=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,ete=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function tte(e,t,i){let n=new ME,r=new te,s=new te,a=new Ct,o=new VB({depthPacking:AB}),l=new $ee,c={},u=i.maxTextureSize,h={[ya]:wn,[wn]:ya,[Jr]:Jr},d=new oi({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new te},radius:{value:4}},vertexShader:Jee,fragmentShader:ete}),p=d.clone();p.defines.HORIZONTAL_PASS=1;let f=new mt;f.setAttribute("position",new gt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let v=new Ar(f,d),m=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=yE,this.render=function(_,b,w){if(m.enabled===!1||m.autoUpdate===!1&&m.needsUpdate===!1||_.length===0)return;let M=e.getRenderTarget(),S=e.getActiveCubeFace(),C=e.getActiveMipmapLevel(),E=e.state;E.setBlending(Qi),E.buffers.color.setClear(1,1,1,1),E.buffers.depth.setTest(!0),E.setScissorTest(!1);for(let P=0,I=_.length;P<I;P++){let D=_[P],L=D.shadow;if(L===void 0){console.warn("THREE.WebGLShadowMap:",D,"has no shadow.");continue}if(L.autoUpdate===!1&&L.needsUpdate===!1)continue;r.copy(L.mapSize);let B=L.getFrameExtents();if(r.multiply(B),s.copy(L.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/B.x),r.x=s.x*B.x,L.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/B.y),r.y=s.y*B.y,L.mapSize.y=s.y)),L.map===null){let z=this.type!==hm?{minFilter:ai,magFilter:ai}:{};L.map=new Qt(r.x,r.y,z),L.map.texture.name=D.name+".shadowMap",L.camera.updateProjectionMatrix()}e.setRenderTarget(L.map),e.clear();let j=L.getViewportCount();for(let z=0;z<j;z++){let O=L.getViewport(z);a.set(s.x*O.x,s.y*O.y,s.x*O.z,s.y*O.w),E.viewport(a),L.updateMatrices(D,z),n=L.getFrustum(),x(b,w,L.camera,D,this.type)}L.isPointLightShadow!==!0&&this.type===hm&&g(L,w),L.needsUpdate=!1}m.needsUpdate=!1,e.setRenderTarget(M,S,C)};function g(_,b){let w=t.update(v);d.defines.VSM_SAMPLES!==_.blurSamples&&(d.defines.VSM_SAMPLES=_.blurSamples,p.defines.VSM_SAMPLES=_.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),_.mapPass===null&&(_.mapPass=new Qt(r.x,r.y)),d.uniforms.shadow_pass.value=_.map.texture,d.uniforms.resolution.value=_.mapSize,d.uniforms.radius.value=_.radius,e.setRenderTarget(_.mapPass),e.clear(),e.renderBufferDirect(b,null,w,d,v,null),p.uniforms.shadow_pass.value=_.mapPass.texture,p.uniforms.resolution.value=_.mapSize,p.uniforms.radius.value=_.radius,e.setRenderTarget(_.map),e.clear(),e.renderBufferDirect(b,null,w,p,v,null)}function y(_,b,w,M,S,C){let E=null,P=w.isPointLight===!0?_.customDistanceMaterial:_.customDepthMaterial;if(P!==void 0)E=P;else if(E=w.isPointLight===!0?l:o,e.localClippingEnabled&&b.clipShadows===!0&&Array.isArray(b.clippingPlanes)&&b.clippingPlanes.length!==0||b.displacementMap&&b.displacementScale!==0||b.alphaMap&&b.alphaTest>0||b.map&&b.alphaTest>0){let I=E.uuid,D=b.uuid,L=c[I];L===void 0&&(L={},c[I]=L);let B=L[D];B===void 0&&(B=E.clone(),L[D]=B),E=B}return E.visible=b.visible,E.wireframe=b.wireframe,C===hm?E.side=b.shadowSide!==null?b.shadowSide:b.side:E.side=b.shadowSide!==null?b.shadowSide:h[b.side],E.alphaMap=b.alphaMap,E.alphaTest=b.alphaTest,E.map=b.map,E.clipShadows=b.clipShadows,E.clippingPlanes=b.clippingPlanes,E.clipIntersection=b.clipIntersection,E.displacementMap=b.displacementMap,E.displacementScale=b.displacementScale,E.displacementBias=b.displacementBias,E.wireframeLinewidth=b.wireframeLinewidth,E.linewidth=b.linewidth,w.isPointLight===!0&&E.isMeshDistanceMaterial===!0&&(E.referencePosition.setFromMatrixPosition(w.matrixWorld),E.nearDistance=M,E.farDistance=S),E}function x(_,b,w,M,S){if(_.visible===!1)return;if(_.layers.test(b.layers)&&(_.isMesh||_.isLine||_.isPoints)&&(_.castShadow||_.receiveShadow&&S===hm)&&(!_.frustumCulled||n.intersectsObject(_))){_.modelViewMatrix.multiplyMatrices(w.matrixWorldInverse,_.matrixWorld);let E=t.update(_),P=_.material;if(Array.isArray(P)){let I=E.groups;for(let D=0,L=I.length;D<L;D++){let B=I[D],j=P[B.materialIndex];if(j&&j.visible){let z=y(_,j,M,w.near,w.far,S);e.renderBufferDirect(w,null,E,z,_,B)}}}else if(P.visible){let I=y(_,P,M,w.near,w.far,S);e.renderBufferDirect(w,null,E,I,_,null)}}let C=_.children;for(let E=0,P=C.length;E<P;E++)x(C[E],b,w,M,S)}}function ite(e,t,i){let n=i.isWebGL2;function r(){let U=!1,ae=new Ct,J=null,ge=new Ct(0,0,0,0);return{setMask:function(Te){J!==Te&&!U&&(e.colorMask(Te,Te,Te,Te),J=Te)},setLocked:function(Te){U=Te},setClear:function(Te,Qe,_t,Tt,Ri){Ri===!0&&(Te*=Tt,Qe*=Tt,_t*=Tt),ae.set(Te,Qe,_t,Tt),ge.equals(ae)===!1&&(e.clearColor(Te,Qe,_t,Tt),ge.copy(ae))},reset:function(){U=!1,J=null,ge.set(-1,0,0,0)}}}function s(){let U=!1,ae=null,J=null,ge=null;return{setTest:function(Te){Te?se(2929):ie(2929)},setMask:function(Te){ae!==Te&&!U&&(e.depthMask(Te),ae=Te)},setFunc:function(Te){if(J!==Te){switch(Te){case wZ:e.depthFunc(512);break;case SZ:e.depthFunc(519);break;case MZ:e.depthFunc(513);break;case nS:e.depthFunc(515);break;case CZ:e.depthFunc(514);break;case EZ:e.depthFunc(518);break;case AZ:e.depthFunc(516);break;case TZ:e.depthFunc(517);break;default:e.depthFunc(515)}J=Te}},setLocked:function(Te){U=Te},setClear:function(Te){ge!==Te&&(e.clearDepth(Te),ge=Te)},reset:function(){U=!1,ae=null,J=null,ge=null}}}function a(){let U=!1,ae=null,J=null,ge=null,Te=null,Qe=null,_t=null,Tt=null,Ri=null;return{setTest:function(vt){U||(vt?se(2960):ie(2960))},setMask:function(vt){ae!==vt&&!U&&(e.stencilMask(vt),ae=vt)},setFunc:function(vt,Hi,ei){(J!==vt||ge!==Hi||Te!==ei)&&(e.stencilFunc(vt,Hi,ei),J=vt,ge=Hi,Te=ei)},setOp:function(vt,Hi,ei){(Qe!==vt||_t!==Hi||Tt!==ei)&&(e.stencilOp(vt,Hi,ei),Qe=vt,_t=Hi,Tt=ei)},setLocked:function(vt){U=vt},setClear:function(vt){Ri!==vt&&(e.clearStencil(vt),Ri=vt)},reset:function(){U=!1,ae=null,J=null,ge=null,Te=null,Qe=null,_t=null,Tt=null,Ri=null}}}let o=new r,l=new s,c=new a,u=new WeakMap,h=new WeakMap,d={},p={},f=new WeakMap,v=[],m=null,g=!1,y=null,x=null,_=null,b=null,w=null,M=null,S=null,C=!1,E=null,P=null,I=null,D=null,L=null,B=e.getParameter(35661),j=!1,z=0,O=e.getParameter(7938);O.indexOf("WebGL")!==-1?(z=parseFloat(/^WebGL (\d)/.exec(O)[1]),j=z>=1):O.indexOf("OpenGL ES")!==-1&&(z=parseFloat(/^OpenGL ES (\d)/.exec(O)[1]),j=z>=2);let H=null,k={},N=e.getParameter(3088),F=e.getParameter(2978),Q=new Ct().fromArray(N),G=new Ct().fromArray(F);function K(U,ae,J){let ge=new Uint8Array(4),Te=e.createTexture();e.bindTexture(U,Te),e.texParameteri(U,10241,9728),e.texParameteri(U,10240,9728);for(let Qe=0;Qe<J;Qe++)e.texImage2D(ae+Qe,0,6408,1,1,0,6408,5121,ge);return Te}let W={};W[3553]=K(3553,3553,1),W[34067]=K(34067,34069,6),o.setClear(0,0,0,1),l.setClear(1),c.setClear(0),se(2929),l.setFunc(nS),Ne(!1),He(F5),se(2884),Oe(Qi);function se(U){d[U]!==!0&&(e.enable(U),d[U]=!0)}function ie(U){d[U]!==!1&&(e.disable(U),d[U]=!1)}function re(U,ae){return p[U]!==ae?(e.bindFramebuffer(U,ae),p[U]=ae,n&&(U===36009&&(p[36160]=ae),U===36160&&(p[36009]=ae)),!0):!1}function de(U,ae){let J=v,ge=!1;if(U)if(J=f.get(ae),J===void 0&&(J=[],f.set(ae,J)),U.isWebGLMultipleRenderTargets){let Te=U.texture;if(J.length!==Te.length||J[0]!==36064){for(let Qe=0,_t=Te.length;Qe<_t;Qe++)J[Qe]=36064+Qe;J.length=Te.length,ge=!0}}else J[0]!==36064&&(J[0]=36064,ge=!0);else J[0]!==1029&&(J[0]=1029,ge=!0);ge&&(i.isWebGL2?e.drawBuffers(J):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(J))}function he(U){return m!==U?(e.useProgram(U),m=U,!0):!1}let X={[od]:32774,[uZ]:32778,[dZ]:32779};if(n)X[H5]=32775,X[G5]=32776;else{let U=t.get("EXT_blend_minmax");U!==null&&(X[H5]=U.MIN_EXT,X[G5]=U.MAX_EXT)}let Ee={[pZ]:0,[fZ]:1,[mZ]:768,[xB]:770,[bZ]:776,[xZ]:774,[vZ]:772,[gZ]:769,[_B]:771,[_Z]:775,[yZ]:773};function Oe(U,ae,J,ge,Te,Qe,_t,Tt){if(U===Qi){g===!0&&(ie(3042),g=!1);return}if(g===!1&&(se(3042),g=!0),U!==hZ){if(U!==y||Tt!==C){if((x!==od||w!==od)&&(e.blendEquation(32774),x=od,w=od),Tt)switch(U){case Xd:e.blendFuncSeparate(1,771,1,771);break;case z5:e.blendFunc(1,1);break;case k5:e.blendFuncSeparate(0,769,0,1);break;case V5:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",U);break}else switch(U){case Xd:e.blendFuncSeparate(770,771,1,771);break;case z5:e.blendFunc(770,1);break;case k5:e.blendFuncSeparate(0,769,0,1);break;case V5:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",U);break}_=null,b=null,M=null,S=null,y=U,C=Tt}return}Te=Te||ae,Qe=Qe||J,_t=_t||ge,(ae!==x||Te!==w)&&(e.blendEquationSeparate(X[ae],X[Te]),x=ae,w=Te),(J!==_||ge!==b||Qe!==M||_t!==S)&&(e.blendFuncSeparate(Ee[J],Ee[ge],Ee[Qe],Ee[_t]),_=J,b=ge,M=Qe,S=_t),y=U,C=!1}function Me(U,ae){U.side===Jr?ie(2884):se(2884);let J=U.side===wn;ae&&(J=!J),Ne(J),U.blending===Xd&&U.transparent===!1?Oe(Qi):Oe(U.blending,U.blendEquation,U.blendSrc,U.blendDst,U.blendEquationAlpha,U.blendSrcAlpha,U.blendDstAlpha,U.premultipliedAlpha),l.setFunc(U.depthFunc),l.setTest(U.depthTest),l.setMask(U.depthWrite),o.setMask(U.colorWrite);let ge=U.stencilWrite;c.setTest(ge),ge&&(c.setMask(U.stencilWriteMask),c.setFunc(U.stencilFunc,U.stencilRef,U.stencilFuncMask),c.setOp(U.stencilFail,U.stencilZFail,U.stencilZPass)),Ce(U.polygonOffset,U.polygonOffsetFactor,U.polygonOffsetUnits),U.alphaToCoverage===!0?se(32926):ie(32926)}function Ne(U){E!==U&&(U?e.frontFace(2304):e.frontFace(2305),E=U)}function He(U){U!==oZ?(se(2884),U!==P&&(U===F5?e.cullFace(1029):U===lZ?e.cullFace(1028):e.cullFace(1032))):ie(2884),P=U}function Pe(U){U!==I&&(j&&e.lineWidth(U),I=U)}function Ce(U,ae,J){U?(se(32823),(D!==ae||L!==J)&&(e.polygonOffset(ae,J),D=ae,L=J)):ie(32823)}function je(U){U?se(3089):ie(3089)}function qe(U){U===void 0&&(U=33984+B-1),H!==U&&(e.activeTexture(U),H=U)}function q(U,ae,J){J===void 0&&(H===null?J=33984+B-1:J=H);let ge=k[J];ge===void 0&&(ge={type:void 0,texture:void 0},k[J]=ge),(ge.type!==U||ge.texture!==ae)&&(H!==J&&(e.activeTexture(J),H=J),e.bindTexture(U,ae||W[U]),ge.type=U,ge.texture=ae)}function A(){let U=k[H];U!==void 0&&U.type!==void 0&&(e.bindTexture(U.type,null),U.type=void 0,U.texture=void 0)}function R(){try{e.compressedTexImage2D.apply(e,arguments)}catch(U){console.error("THREE.WebGLState:",U)}}function $(){try{e.compressedTexImage3D.apply(e,arguments)}catch(U){console.error("THREE.WebGLState:",U)}}function le(){try{e.texSubImage2D.apply(e,arguments)}catch(U){console.error("THREE.WebGLState:",U)}}function ue(){try{e.texSubImage3D.apply(e,arguments)}catch(U){console.error("THREE.WebGLState:",U)}}function we(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(U){console.error("THREE.WebGLState:",U)}}function De(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(U){console.error("THREE.WebGLState:",U)}}function ne(){try{e.texStorage2D.apply(e,arguments)}catch(U){console.error("THREE.WebGLState:",U)}}function oe(){try{e.texStorage3D.apply(e,arguments)}catch(U){console.error("THREE.WebGLState:",U)}}function Y(){try{e.texImage2D.apply(e,arguments)}catch(U){console.error("THREE.WebGLState:",U)}}function me(){try{e.texImage3D.apply(e,arguments)}catch(U){console.error("THREE.WebGLState:",U)}}function Le(U){Q.equals(U)===!1&&(e.scissor(U.x,U.y,U.z,U.w),Q.copy(U))}function Ae(U){G.equals(U)===!1&&(e.viewport(U.x,U.y,U.z,U.w),G.copy(U))}function Ue(U,ae){let J=h.get(ae);J===void 0&&(J=new WeakMap,h.set(ae,J));let ge=J.get(U);ge===void 0&&(ge=e.getUniformBlockIndex(ae,U.name),J.set(U,ge))}function $e(U,ae){let J=h.get(ae).get(U);u.get(ae)!==J&&(e.uniformBlockBinding(ae,J,U.__bindingPointIndex),u.set(ae,J))}function at(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),n===!0&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),d={},H=null,k={},p={},f=new WeakMap,v=[],m=null,g=!1,y=null,x=null,_=null,b=null,w=null,M=null,S=null,C=!1,E=null,P=null,I=null,D=null,L=null,Q.set(0,0,e.canvas.width,e.canvas.height),G.set(0,0,e.canvas.width,e.canvas.height),o.reset(),l.reset(),c.reset()}return{buffers:{color:o,depth:l,stencil:c},enable:se,disable:ie,bindFramebuffer:re,drawBuffers:de,useProgram:he,setBlending:Oe,setMaterial:Me,setFlipSided:Ne,setCullFace:He,setLineWidth:Pe,setPolygonOffset:Ce,setScissorTest:je,activeTexture:qe,bindTexture:q,unbindTexture:A,compressedTexImage2D:R,compressedTexImage3D:$,texImage2D:Y,texImage3D:me,updateUBOMapping:Ue,uniformBlockBinding:$e,texStorage2D:ne,texStorage3D:oe,texSubImage2D:le,texSubImage3D:ue,compressedTexSubImage2D:we,compressedTexSubImage3D:De,scissor:Le,viewport:Ae,reset:at}}function nte(e,t,i,n,r,s,a){let o=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,h=r.maxSamples,d=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,p=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),f=new WeakMap,v,m=new WeakMap,g=!1;try{g=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(q,A){return g?new OffscreenCanvas(q,A):Oy("canvas")}function x(q,A,R,$){let le=1;if((q.width>$||q.height>$)&&(le=$/Math.max(q.width,q.height)),le<1||A===!0)if(typeof HTMLImageElement<"u"&&q instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&q instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&q instanceof ImageBitmap){let ue=A?Iy:Math.floor,we=ue(le*q.width),De=ue(le*q.height);v===void 0&&(v=y(we,De));let ne=R?y(we,De):v;return ne.width=we,ne.height=De,ne.getContext("2d").drawImage(q,0,0,we,De),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+q.width+"x"+q.height+") to ("+we+"x"+De+")."),ne}else return"data"in q&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+q.width+"x"+q.height+")."),q;return q}function _(q){return cS(q.width)&&cS(q.height)}function b(q){return o?!1:q.wrapS!==Fi||q.wrapT!==Fi||q.minFilter!==ai&&q.minFilter!==Lt}function w(q,A){return q.generateMipmaps&&A&&q.minFilter!==ai&&q.minFilter!==Lt}function M(q){e.generateMipmap(q)}function S(q,A,R,$,le=!1){if(o===!1)return A;if(q!==null){if(e[q]!==void 0)return e[q];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+q+"'")}let ue=A;return A===6403&&(R===5126&&(ue=33326),R===5131&&(ue=33325),R===5121&&(ue=33321)),A===33319&&(R===5126&&(ue=33328),R===5131&&(ue=33327),R===5121&&(ue=33323)),A===6408&&(R===5126&&(ue=34836),R===5131&&(ue=34842),R===5121&&(ue=$===Mt&&le===!1?35907:32856),R===32819&&(ue=32854),R===32820&&(ue=32855)),(ue===33325||ue===33326||ue===33327||ue===33328||ue===34842||ue===34836)&&t.get("EXT_color_buffer_float"),ue}function C(q,A,R){return w(q,R)===!0||q.isFramebufferTexture&&q.minFilter!==ai&&q.minFilter!==Lt?Math.log2(Math.max(A.width,A.height))+1:q.mipmaps!==void 0&&q.mipmaps.length>0?q.mipmaps.length:q.isCompressedTexture&&Array.isArray(q.image)?A.mipmaps.length:1}function E(q){return q===ai||q===j5||q===w_?9728:9729}function P(q){let A=q.target;A.removeEventListener("dispose",P),D(A),A.isVideoTexture&&f.delete(A)}function I(q){let A=q.target;A.removeEventListener("dispose",I),B(A)}function D(q){let A=n.get(q);if(A.__webglInit===void 0)return;let R=q.source,$=m.get(R);if($){let le=$[A.__cacheKey];le.usedTimes--,le.usedTimes===0&&L(q),Object.keys($).length===0&&m.delete(R)}n.remove(q)}function L(q){let A=n.get(q);e.deleteTexture(A.__webglTexture);let R=q.source,$=m.get(R);delete $[A.__cacheKey],a.memory.textures--}function B(q){let A=q.texture,R=n.get(q),$=n.get(A);if($.__webglTexture!==void 0&&(e.deleteTexture($.__webglTexture),a.memory.textures--),q.depthTexture&&q.depthTexture.dispose(),q.isWebGLCubeRenderTarget)for(let le=0;le<6;le++)e.deleteFramebuffer(R.__webglFramebuffer[le]),R.__webglDepthbuffer&&e.deleteRenderbuffer(R.__webglDepthbuffer[le]);else{if(e.deleteFramebuffer(R.__webglFramebuffer),R.__webglDepthbuffer&&e.deleteRenderbuffer(R.__webglDepthbuffer),R.__webglMultisampledFramebuffer&&e.deleteFramebuffer(R.__webglMultisampledFramebuffer),R.__webglColorRenderbuffer)for(let le=0;le<R.__webglColorRenderbuffer.length;le++)R.__webglColorRenderbuffer[le]&&e.deleteRenderbuffer(R.__webglColorRenderbuffer[le]);R.__webglDepthRenderbuffer&&e.deleteRenderbuffer(R.__webglDepthRenderbuffer)}if(q.isWebGLMultipleRenderTargets)for(let le=0,ue=A.length;le<ue;le++){let we=n.get(A[le]);we.__webglTexture&&(e.deleteTexture(we.__webglTexture),a.memory.textures--),n.remove(A[le])}n.remove(A),n.remove(q)}let j=0;function z(){j=0}function O(){let q=j;return q>=l&&console.warn("THREE.WebGLTextures: Trying to use "+q+" texture units while this GPU supports only "+l),j+=1,q}function H(q){let A=[];return A.push(q.wrapS),A.push(q.wrapT),A.push(q.wrapR||0),A.push(q.magFilter),A.push(q.minFilter),A.push(q.anisotropy),A.push(q.internalFormat),A.push(q.format),A.push(q.type),A.push(q.generateMipmaps),A.push(q.premultiplyAlpha),A.push(q.flipY),A.push(q.unpackAlignment),A.push(q.encoding),A.join()}function k(q,A){let R=n.get(q);if(q.isVideoTexture&&je(q),q.isRenderTargetTexture===!1&&q.version>0&&R.__version!==q.version){let $=q.image;if($===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if($.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ie(R,q,A);return}}i.bindTexture(3553,R.__webglTexture,33984+A)}function N(q,A){let R=n.get(q);if(q.version>0&&R.__version!==q.version){ie(R,q,A);return}i.bindTexture(35866,R.__webglTexture,33984+A)}function F(q,A){let R=n.get(q);if(q.version>0&&R.__version!==q.version){ie(R,q,A);return}i.bindTexture(32879,R.__webglTexture,33984+A)}function Q(q,A){let R=n.get(q);if(q.version>0&&R.__version!==q.version){re(R,q,A);return}i.bindTexture(34067,R.__webglTexture,33984+A)}let G={[Zo]:10497,[Fi]:33071,[aS]:33648},K={[ai]:9728,[j5]:9984,[w_]:9986,[Lt]:9729,[NZ]:9985,[xp]:9987};function W(q,A,R){if(R?(e.texParameteri(q,10242,G[A.wrapS]),e.texParameteri(q,10243,G[A.wrapT]),(q===32879||q===35866)&&e.texParameteri(q,32882,G[A.wrapR]),e.texParameteri(q,10240,K[A.magFilter]),e.texParameteri(q,10241,K[A.minFilter])):(e.texParameteri(q,10242,33071),e.texParameteri(q,10243,33071),(q===32879||q===35866)&&e.texParameteri(q,32882,33071),(A.wrapS!==Fi||A.wrapT!==Fi)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(q,10240,E(A.magFilter)),e.texParameteri(q,10241,E(A.minFilter)),A.minFilter!==ai&&A.minFilter!==Lt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),t.has("EXT_texture_filter_anisotropic")===!0){let $=t.get("EXT_texture_filter_anisotropic");if(A.magFilter===ai||A.minFilter!==w_&&A.minFilter!==xp||A.type===es&&t.has("OES_texture_float_linear")===!1||o===!1&&A.type===_p&&t.has("OES_texture_half_float_linear")===!1)return;(A.anisotropy>1||n.get(A).__currentAnisotropy)&&(e.texParameterf(q,$.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(A.anisotropy,r.getMaxAnisotropy())),n.get(A).__currentAnisotropy=A.anisotropy)}}function se(q,A){let R=!1;q.__webglInit===void 0&&(q.__webglInit=!0,A.addEventListener("dispose",P));let $=A.source,le=m.get($);le===void 0&&(le={},m.set($,le));let ue=H(A);if(ue!==q.__cacheKey){le[ue]===void 0&&(le[ue]={texture:e.createTexture(),usedTimes:0},a.memory.textures++,R=!0),le[ue].usedTimes++;let we=le[q.__cacheKey];we!==void 0&&(le[q.__cacheKey].usedTimes--,we.usedTimes===0&&L(A)),q.__cacheKey=ue,q.__webglTexture=le[ue].texture}return R}function ie(q,A,R){let $=3553;(A.isDataArrayTexture||A.isCompressedArrayTexture)&&($=35866),A.isData3DTexture&&($=32879);let le=se(q,A),ue=A.source;i.bindTexture($,q.__webglTexture,33984+R);let we=n.get(ue);if(ue.version!==we.__version||le===!0){i.activeTexture(33984+R),e.pixelStorei(37440,A.flipY),e.pixelStorei(37441,A.premultiplyAlpha),e.pixelStorei(3317,A.unpackAlignment),e.pixelStorei(37443,0);let De=b(A)&&_(A.image)===!1,ne=x(A.image,De,!1,u);ne=qe(A,ne);let oe=_(ne)||o,Y=s.convert(A.format,A.encoding),me=s.convert(A.type),Le=S(A.internalFormat,Y,me,A.encoding,A.isVideoTexture);W($,A,oe);let Ae,Ue=A.mipmaps,$e=o&&A.isVideoTexture!==!0,at=we.__version===void 0||le===!0,U=C(A,ne,oe);if(A.isDepthTexture)Le=6402,o?A.type===es?Le=36012:A.type===Ql?Le=33190:A.type===Ah?Le=35056:Le=33189:A.type===es&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),A.format===Th&&Le===6402&&A.type!==SB&&A.type!==Ql&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),A.type=Ql,me=s.convert(A.type)),A.format===Wh&&Le===6402&&(Le=34041,A.type!==Ah&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),A.type=Ah,me=s.convert(A.type))),at&&($e?i.texStorage2D(3553,1,Le,ne.width,ne.height):i.texImage2D(3553,0,Le,ne.width,ne.height,0,Y,me,null));else if(A.isDataTexture)if(Ue.length>0&&oe){$e&&at&&i.texStorage2D(3553,U,Le,Ue[0].width,Ue[0].height);for(let ae=0,J=Ue.length;ae<J;ae++)Ae=Ue[ae],$e?i.texSubImage2D(3553,ae,0,0,Ae.width,Ae.height,Y,me,Ae.data):i.texImage2D(3553,ae,Le,Ae.width,Ae.height,0,Y,me,Ae.data);A.generateMipmaps=!1}else $e?(at&&i.texStorage2D(3553,U,Le,ne.width,ne.height),i.texSubImage2D(3553,0,0,0,ne.width,ne.height,Y,me,ne.data)):i.texImage2D(3553,0,Le,ne.width,ne.height,0,Y,me,ne.data);else if(A.isCompressedTexture)if(A.isCompressedArrayTexture){$e&&at&&i.texStorage3D(35866,U,Le,Ue[0].width,Ue[0].height,ne.depth);for(let ae=0,J=Ue.length;ae<J;ae++)Ae=Ue[ae],A.format!==Ts?Y!==null?$e?i.compressedTexSubImage3D(35866,ae,0,0,0,Ae.width,Ae.height,ne.depth,Y,Ae.data,0,0):i.compressedTexImage3D(35866,ae,Le,Ae.width,Ae.height,ne.depth,0,Ae.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):$e?i.texSubImage3D(35866,ae,0,0,0,Ae.width,Ae.height,ne.depth,Y,me,Ae.data):i.texImage3D(35866,ae,Le,Ae.width,Ae.height,ne.depth,0,Y,me,Ae.data)}else{$e&&at&&i.texStorage2D(3553,U,Le,Ue[0].width,Ue[0].height);for(let ae=0,J=Ue.length;ae<J;ae++)Ae=Ue[ae],A.format!==Ts?Y!==null?$e?i.compressedTexSubImage2D(3553,ae,0,0,Ae.width,Ae.height,Y,Ae.data):i.compressedTexImage2D(3553,ae,Le,Ae.width,Ae.height,0,Ae.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):$e?i.texSubImage2D(3553,ae,0,0,Ae.width,Ae.height,Y,me,Ae.data):i.texImage2D(3553,ae,Le,Ae.width,Ae.height,0,Y,me,Ae.data)}else if(A.isDataArrayTexture)$e?(at&&i.texStorage3D(35866,U,Le,ne.width,ne.height,ne.depth),i.texSubImage3D(35866,0,0,0,0,ne.width,ne.height,ne.depth,Y,me,ne.data)):i.texImage3D(35866,0,Le,ne.width,ne.height,ne.depth,0,Y,me,ne.data);else if(A.isData3DTexture)$e?(at&&i.texStorage3D(32879,U,Le,ne.width,ne.height,ne.depth),i.texSubImage3D(32879,0,0,0,0,ne.width,ne.height,ne.depth,Y,me,ne.data)):i.texImage3D(32879,0,Le,ne.width,ne.height,ne.depth,0,Y,me,ne.data);else if(A.isFramebufferTexture){if(at)if($e)i.texStorage2D(3553,U,Le,ne.width,ne.height);else{let ae=ne.width,J=ne.height;for(let ge=0;ge<U;ge++)i.texImage2D(3553,ge,Le,ae,J,0,Y,me,null),ae>>=1,J>>=1}}else if(Ue.length>0&&oe){$e&&at&&i.texStorage2D(3553,U,Le,Ue[0].width,Ue[0].height);for(let ae=0,J=Ue.length;ae<J;ae++)Ae=Ue[ae],$e?i.texSubImage2D(3553,ae,0,0,Y,me,Ae):i.texImage2D(3553,ae,Le,Y,me,Ae);A.generateMipmaps=!1}else $e?(at&&i.texStorage2D(3553,U,Le,ne.width,ne.height),i.texSubImage2D(3553,0,0,0,Y,me,ne)):i.texImage2D(3553,0,Le,Y,me,ne);w(A,oe)&&M($),we.__version=ue.version,A.onUpdate&&A.onUpdate(A)}q.__version=A.version}function re(q,A,R){if(A.image.length!==6)return;let $=se(q,A),le=A.source;i.bindTexture(34067,q.__webglTexture,33984+R);let ue=n.get(le);if(le.version!==ue.__version||$===!0){i.activeTexture(33984+R),e.pixelStorei(37440,A.flipY),e.pixelStorei(37441,A.premultiplyAlpha),e.pixelStorei(3317,A.unpackAlignment),e.pixelStorei(37443,0);let we=A.isCompressedTexture||A.image[0].isCompressedTexture,De=A.image[0]&&A.image[0].isDataTexture,ne=[];for(let ae=0;ae<6;ae++)!we&&!De?ne[ae]=x(A.image[ae],!1,!0,c):ne[ae]=De?A.image[ae].image:A.image[ae],ne[ae]=qe(A,ne[ae]);let oe=ne[0],Y=_(oe)||o,me=s.convert(A.format,A.encoding),Le=s.convert(A.type),Ae=S(A.internalFormat,me,Le,A.encoding),Ue=o&&A.isVideoTexture!==!0,$e=ue.__version===void 0||$===!0,at=C(A,oe,Y);W(34067,A,Y);let U;if(we){Ue&&$e&&i.texStorage2D(34067,at,Ae,oe.width,oe.height);for(let ae=0;ae<6;ae++){U=ne[ae].mipmaps;for(let J=0;J<U.length;J++){let ge=U[J];A.format!==Ts?me!==null?Ue?i.compressedTexSubImage2D(34069+ae,J,0,0,ge.width,ge.height,me,ge.data):i.compressedTexImage2D(34069+ae,J,Ae,ge.width,ge.height,0,ge.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Ue?i.texSubImage2D(34069+ae,J,0,0,ge.width,ge.height,me,Le,ge.data):i.texImage2D(34069+ae,J,Ae,ge.width,ge.height,0,me,Le,ge.data)}}}else{U=A.mipmaps,Ue&&$e&&(U.length>0&&at++,i.texStorage2D(34067,at,Ae,ne[0].width,ne[0].height));for(let ae=0;ae<6;ae++)if(De){Ue?i.texSubImage2D(34069+ae,0,0,0,ne[ae].width,ne[ae].height,me,Le,ne[ae].data):i.texImage2D(34069+ae,0,Ae,ne[ae].width,ne[ae].height,0,me,Le,ne[ae].data);for(let J=0;J<U.length;J++){let ge=U[J].image[ae].image;Ue?i.texSubImage2D(34069+ae,J+1,0,0,ge.width,ge.height,me,Le,ge.data):i.texImage2D(34069+ae,J+1,Ae,ge.width,ge.height,0,me,Le,ge.data)}}else{Ue?i.texSubImage2D(34069+ae,0,0,0,me,Le,ne[ae]):i.texImage2D(34069+ae,0,Ae,me,Le,ne[ae]);for(let J=0;J<U.length;J++){let ge=U[J];Ue?i.texSubImage2D(34069+ae,J+1,0,0,me,Le,ge.image[ae]):i.texImage2D(34069+ae,J+1,Ae,me,Le,ge.image[ae])}}}w(A,Y)&&M(34067),ue.__version=le.version,A.onUpdate&&A.onUpdate(A)}q.__version=A.version}function de(q,A,R,$,le){let ue=s.convert(R.format,R.encoding),we=s.convert(R.type),De=S(R.internalFormat,ue,we,R.encoding);n.get(A).__hasExternalTextures||(le===32879||le===35866?i.texImage3D(le,0,De,A.width,A.height,A.depth,0,ue,we,null):i.texImage2D(le,0,De,A.width,A.height,0,ue,we,null)),i.bindFramebuffer(36160,q),Ce(A)?d.framebufferTexture2DMultisampleEXT(36160,$,le,n.get(R).__webglTexture,0,Pe(A)):(le===3553||le>=34069&&le<=34074)&&e.framebufferTexture2D(36160,$,le,n.get(R).__webglTexture,0),i.bindFramebuffer(36160,null)}function he(q,A,R){if(e.bindRenderbuffer(36161,q),A.depthBuffer&&!A.stencilBuffer){let $=33189;if(R||Ce(A)){let le=A.depthTexture;le&&le.isDepthTexture&&(le.type===es?$=36012:le.type===Ql&&($=33190));let ue=Pe(A);Ce(A)?d.renderbufferStorageMultisampleEXT(36161,ue,$,A.width,A.height):e.renderbufferStorageMultisample(36161,ue,$,A.width,A.height)}else e.renderbufferStorage(36161,$,A.width,A.height);e.framebufferRenderbuffer(36160,36096,36161,q)}else if(A.depthBuffer&&A.stencilBuffer){let $=Pe(A);R&&Ce(A)===!1?e.renderbufferStorageMultisample(36161,$,35056,A.width,A.height):Ce(A)?d.renderbufferStorageMultisampleEXT(36161,$,35056,A.width,A.height):e.renderbufferStorage(36161,34041,A.width,A.height),e.framebufferRenderbuffer(36160,33306,36161,q)}else{let $=A.isWebGLMultipleRenderTargets===!0?A.texture:[A.texture];for(let le=0;le<$.length;le++){let ue=$[le],we=s.convert(ue.format,ue.encoding),De=s.convert(ue.type),ne=S(ue.internalFormat,we,De,ue.encoding),oe=Pe(A);R&&Ce(A)===!1?e.renderbufferStorageMultisample(36161,oe,ne,A.width,A.height):Ce(A)?d.renderbufferStorageMultisampleEXT(36161,oe,ne,A.width,A.height):e.renderbufferStorage(36161,ne,A.width,A.height)}}e.bindRenderbuffer(36161,null)}function X(q,A){if(A&&A.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(36160,q),!(A.depthTexture&&A.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(A.depthTexture).__webglTexture||A.depthTexture.image.width!==A.width||A.depthTexture.image.height!==A.height)&&(A.depthTexture.image.width=A.width,A.depthTexture.image.height=A.height,A.depthTexture.needsUpdate=!0),k(A.depthTexture,0);let R=n.get(A.depthTexture).__webglTexture,$=Pe(A);if(A.depthTexture.format===Th)Ce(A)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,R,0,$):e.framebufferTexture2D(36160,36096,3553,R,0);else if(A.depthTexture.format===Wh)Ce(A)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,R,0,$):e.framebufferTexture2D(36160,33306,3553,R,0);else throw new Error("Unknown depthTexture format")}function Ee(q){let A=n.get(q),R=q.isWebGLCubeRenderTarget===!0;if(q.depthTexture&&!A.__autoAllocateDepthBuffer){if(R)throw new Error("target.depthTexture not supported in Cube render targets");X(A.__webglFramebuffer,q)}else if(R){A.__webglDepthbuffer=[];for(let $=0;$<6;$++)i.bindFramebuffer(36160,A.__webglFramebuffer[$]),A.__webglDepthbuffer[$]=e.createRenderbuffer(),he(A.__webglDepthbuffer[$],q,!1)}else i.bindFramebuffer(36160,A.__webglFramebuffer),A.__webglDepthbuffer=e.createRenderbuffer(),he(A.__webglDepthbuffer,q,!1);i.bindFramebuffer(36160,null)}function Oe(q,A,R){let $=n.get(q);A!==void 0&&de($.__webglFramebuffer,q,q.texture,36064,3553),R!==void 0&&Ee(q)}function Me(q){let A=q.texture,R=n.get(q),$=n.get(A);q.addEventListener("dispose",I),q.isWebGLMultipleRenderTargets!==!0&&($.__webglTexture===void 0&&($.__webglTexture=e.createTexture()),$.__version=A.version,a.memory.textures++);let le=q.isWebGLCubeRenderTarget===!0,ue=q.isWebGLMultipleRenderTargets===!0,we=_(q)||o;if(le){R.__webglFramebuffer=[];for(let De=0;De<6;De++)R.__webglFramebuffer[De]=e.createFramebuffer()}else{if(R.__webglFramebuffer=e.createFramebuffer(),ue)if(r.drawBuffers){let De=q.texture;for(let ne=0,oe=De.length;ne<oe;ne++){let Y=n.get(De[ne]);Y.__webglTexture===void 0&&(Y.__webglTexture=e.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(o&&q.samples>0&&Ce(q)===!1){let De=ue?A:[A];R.__webglMultisampledFramebuffer=e.createFramebuffer(),R.__webglColorRenderbuffer=[],i.bindFramebuffer(36160,R.__webglMultisampledFramebuffer);for(let ne=0;ne<De.length;ne++){let oe=De[ne];R.__webglColorRenderbuffer[ne]=e.createRenderbuffer(),e.bindRenderbuffer(36161,R.__webglColorRenderbuffer[ne]);let Y=s.convert(oe.format,oe.encoding),me=s.convert(oe.type),Le=S(oe.internalFormat,Y,me,oe.encoding,q.isXRRenderTarget===!0),Ae=Pe(q);e.renderbufferStorageMultisample(36161,Ae,Le,q.width,q.height),e.framebufferRenderbuffer(36160,36064+ne,36161,R.__webglColorRenderbuffer[ne])}e.bindRenderbuffer(36161,null),q.depthBuffer&&(R.__webglDepthRenderbuffer=e.createRenderbuffer(),he(R.__webglDepthRenderbuffer,q,!0)),i.bindFramebuffer(36160,null)}}if(le){i.bindTexture(34067,$.__webglTexture),W(34067,A,we);for(let De=0;De<6;De++)de(R.__webglFramebuffer[De],q,A,36064,34069+De);w(A,we)&&M(34067),i.unbindTexture()}else if(ue){let De=q.texture;for(let ne=0,oe=De.length;ne<oe;ne++){let Y=De[ne],me=n.get(Y);i.bindTexture(3553,me.__webglTexture),W(3553,Y,we),de(R.__webglFramebuffer,q,Y,36064+ne,3553),w(Y,we)&&M(3553)}i.unbindTexture()}else{let De=3553;(q.isWebGL3DRenderTarget||q.isWebGLArrayRenderTarget)&&(o?De=q.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),i.bindTexture(De,$.__webglTexture),W(De,A,we),de(R.__webglFramebuffer,q,A,36064,De),w(A,we)&&M(De),i.unbindTexture()}q.depthBuffer&&Ee(q)}function Ne(q){let A=_(q)||o,R=q.isWebGLMultipleRenderTargets===!0?q.texture:[q.texture];for(let $=0,le=R.length;$<le;$++){let ue=R[$];if(w(ue,A)){let we=q.isWebGLCubeRenderTarget?34067:3553,De=n.get(ue).__webglTexture;i.bindTexture(we,De),M(we),i.unbindTexture()}}}function He(q){if(o&&q.samples>0&&Ce(q)===!1){let A=q.isWebGLMultipleRenderTargets?q.texture:[q.texture],R=q.width,$=q.height,le=16384,ue=[],we=q.stencilBuffer?33306:36096,De=n.get(q),ne=q.isWebGLMultipleRenderTargets===!0;if(ne)for(let oe=0;oe<A.length;oe++)i.bindFramebuffer(36160,De.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+oe,36161,null),i.bindFramebuffer(36160,De.__webglFramebuffer),e.framebufferTexture2D(36009,36064+oe,3553,null,0);i.bindFramebuffer(36008,De.__webglMultisampledFramebuffer),i.bindFramebuffer(36009,De.__webglFramebuffer);for(let oe=0;oe<A.length;oe++){ue.push(36064+oe),q.depthBuffer&&ue.push(we);let Y=De.__ignoreDepthValues!==void 0?De.__ignoreDepthValues:!1;if(Y===!1&&(q.depthBuffer&&(le|=256),q.stencilBuffer&&(le|=1024)),ne&&e.framebufferRenderbuffer(36008,36064,36161,De.__webglColorRenderbuffer[oe]),Y===!0&&(e.invalidateFramebuffer(36008,[we]),e.invalidateFramebuffer(36009,[we])),ne){let me=n.get(A[oe]).__webglTexture;e.framebufferTexture2D(36009,36064,3553,me,0)}e.blitFramebuffer(0,0,R,$,0,0,R,$,le,9728),p&&e.invalidateFramebuffer(36008,ue)}if(i.bindFramebuffer(36008,null),i.bindFramebuffer(36009,null),ne)for(let oe=0;oe<A.length;oe++){i.bindFramebuffer(36160,De.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064+oe,36161,De.__webglColorRenderbuffer[oe]);let Y=n.get(A[oe]).__webglTexture;i.bindFramebuffer(36160,De.__webglFramebuffer),e.framebufferTexture2D(36009,36064+oe,3553,Y,0)}i.bindFramebuffer(36009,De.__webglMultisampledFramebuffer)}}function Pe(q){return Math.min(h,q.samples)}function Ce(q){let A=n.get(q);return o&&q.samples>0&&t.has("WEBGL_multisampled_render_to_texture")===!0&&A.__useRenderToTexture!==!1}function je(q){let A=a.render.frame;f.get(q)!==A&&(f.set(q,A),q.update())}function qe(q,A){let R=q.encoding,$=q.format,le=q.type;return q.isCompressedTexture===!0||q.isVideoTexture===!0||q.format===lS||R!==no&&(R===Mt?o===!1?t.has("EXT_sRGB")===!0&&$===Ts?(q.format=lS,q.minFilter=Lt,q.generateMipmaps=!1):A=LB.sRGBToLinear(A):($!==Ts||le!==Zn)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",R)),A}this.allocateTextureUnit=O,this.resetTextureUnits=z,this.setTexture2D=k,this.setTexture2DArray=N,this.setTexture3D=F,this.setTextureCube=Q,this.rebindTextures=Oe,this.setupRenderTarget=Me,this.updateRenderTargetMipmap=Ne,this.updateMultisampleRenderTarget=He,this.setupDepthRenderbuffer=Ee,this.setupFrameBufferTexture=de,this.useMultisampledRTT=Ce}function rte(e,t,i){let n=i.isWebGL2;function r(s,a=null){let o;if(s===Zn)return 5121;if(s===kZ)return 32819;if(s===VZ)return 32820;if(s===UZ)return 5120;if(s===FZ)return 5122;if(s===SB)return 5123;if(s===zZ)return 5124;if(s===Ql)return 5125;if(s===es)return 5126;if(s===_p)return n?5131:(o=t.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(s===HZ)return 6406;if(s===Ts)return 6408;if(s===GZ)return 6409;if(s===jZ)return 6410;if(s===Th)return 6402;if(s===Wh)return 34041;if(s===lS)return o=t.get("EXT_sRGB"),o!==null?o.SRGB_ALPHA_EXT:null;if(s===WZ)return 6403;if(s===XZ)return 36244;if(s===MB)return 33319;if(s===qZ)return 33320;if(s===YZ)return 36249;if(s===S_||s===M_||s===C_||s===E_)if(a===Mt)if(o=t.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(s===S_)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===M_)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===C_)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===E_)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=t.get("WEBGL_compressed_texture_s3tc"),o!==null){if(s===S_)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===M_)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===C_)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===E_)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===W5||s===X5||s===q5||s===Y5)if(o=t.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(s===W5)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===X5)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===q5)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===Y5)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===ZZ)return o=t.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===Z5||s===Q5)if(o=t.get("WEBGL_compressed_texture_etc"),o!==null){if(s===Z5)return a===Mt?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(s===Q5)return a===Mt?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===K5||s===$5||s===J5||s===e6||s===t6||s===i6||s===n6||s===r6||s===s6||s===a6||s===o6||s===l6||s===c6||s===h6)if(o=t.get("WEBGL_compressed_texture_astc"),o!==null){if(s===K5)return a===Mt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===$5)return a===Mt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===J5)return a===Mt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===e6)return a===Mt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===t6)return a===Mt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===i6)return a===Mt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===n6)return a===Mt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===r6)return a===Mt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===s6)return a===Mt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===a6)return a===Mt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===o6)return a===Mt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===l6)return a===Mt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===c6)return a===Mt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===h6)return a===Mt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===A_)if(o=t.get("EXT_texture_compression_bptc"),o!==null){if(s===A_)return a===Mt?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(s===QZ||s===u6||s===d6||s===p6)if(o=t.get("EXT_texture_compression_rgtc"),o!==null){if(s===A_)return o.COMPRESSED_RED_RGTC1_EXT;if(s===u6)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===d6)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===p6)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===Ah?n?34042:(o=t.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null):e[s]!==void 0?e[s]:null}return{convert:r}}var ste=class extends Vn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}},Id=class extends $t{constructor(){super(),this.isGroup=!0,this.type="Group"}},ate={type:"move"},J_=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Id,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Id,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new T,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new T),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Id,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new T,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new T),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let n=null,r=null,s=null,a=this._targetRay,o=this._grip,l=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(l&&e.hand){s=!0;for(let f of e.hand.values()){let v=t.getJointPose(f,i),m=this._getHandJoint(l,f);v!==null&&(m.matrix.fromArray(v.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.jointRadius=v.radius),m.visible=v!==null}let c=l.joints["index-finger-tip"],u=l.joints["thumb-tip"],h=c.position.distanceTo(u.position),d=.02,p=.005;l.inputState.pinching&&h>d+p?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&h<=d-p&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else o!==null&&e.gripSpace&&(r=t.getPose(e.gripSpace,i),r!==null&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1));a!==null&&(n=t.getPose(e.targetRaySpace,i),n===null&&r!==null&&(n=r),n!==null&&(a.matrix.fromArray(n.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),n.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(n.linearVelocity)):a.hasLinearVelocity=!1,n.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(n.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(ate)))}return a!==null&&(a.visible=n!==null),o!==null&&(o.visible=r!==null),l!==null&&(l.visible=s!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){let i=new Id;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}},wp=class extends ln{constructor(e,t,i,n,r,s,a,o,l,c){if(c=c!==void 0?c:Th,c!==Th&&c!==Wh)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&c===Th&&(i=Ql),i===void 0&&c===Wh&&(i=Ah),super(null,n,r,s,a,o,c,i,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:ai,this.minFilter=o!==void 0?o:ai,this.flipY=!1,this.generateMipmaps=!1}},ote=class extends In{constructor(e,t){super();let i=this,n=null,r=1,s=null,a="local-floor",o=1,l=null,c=null,u=null,h=null,d=null,p=null,f=t.getContextAttributes(),v=null,m=null,g=[],y=[],x=new Set,_=new Map,b=new Vn;b.layers.enable(1),b.viewport=new Ct;let w=new Vn;w.layers.enable(2),w.viewport=new Ct;let M=[b,w],S=new ste;S.layers.enable(1),S.layers.enable(2);let C=null,E=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(N){let F=g[N];return F===void 0&&(F=new J_,g[N]=F),F.getTargetRaySpace()},this.getControllerGrip=function(N){let F=g[N];return F===void 0&&(F=new J_,g[N]=F),F.getGripSpace()},this.getHand=function(N){let F=g[N];return F===void 0&&(F=new J_,g[N]=F),F.getHandSpace()};function P(N){let F=y.indexOf(N.inputSource);if(F===-1)return;let Q=g[F];Q!==void 0&&Q.dispatchEvent({type:N.type,data:N.inputSource})}function I(){n.removeEventListener("select",P),n.removeEventListener("selectstart",P),n.removeEventListener("selectend",P),n.removeEventListener("squeeze",P),n.removeEventListener("squeezestart",P),n.removeEventListener("squeezeend",P),n.removeEventListener("end",I),n.removeEventListener("inputsourceschange",D);for(let N=0;N<g.length;N++){let F=y[N];F!==null&&(y[N]=null,g[N].disconnect(F))}C=null,E=null,e.setRenderTarget(v),d=null,h=null,u=null,n=null,m=null,k.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(N){r=N,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(N){a=N,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||s},this.setReferenceSpace=function(N){l=N},this.getBaseLayer=function(){return h!==null?h:d},this.getBinding=function(){return u},this.getFrame=function(){return p},this.getSession=function(){return n},this.setSession=async function(N){if(n=N,n!==null){if(v=e.getRenderTarget(),n.addEventListener("select",P),n.addEventListener("selectstart",P),n.addEventListener("selectend",P),n.addEventListener("squeeze",P),n.addEventListener("squeezestart",P),n.addEventListener("squeezeend",P),n.addEventListener("end",I),n.addEventListener("inputsourceschange",D),f.xrCompatible!==!0&&await t.makeXRCompatible(),n.renderState.layers===void 0||e.capabilities.isWebGL2===!1){let F={antialias:n.renderState.layers===void 0?f.antialias:!0,alpha:f.alpha,depth:f.depth,stencil:f.stencil,framebufferScaleFactor:r};d=new XRWebGLLayer(n,t,F),n.updateRenderState({baseLayer:d}),m=new Qt(d.framebufferWidth,d.framebufferHeight,{format:Ts,type:Zn,encoding:e.outputEncoding,stencilBuffer:f.stencil})}else{let F=null,Q=null,G=null;f.depth&&(G=f.stencil?35056:33190,F=f.stencil?Wh:Th,Q=f.stencil?Ah:Ql);let K={colorFormat:32856,depthFormat:G,scaleFactor:r};u=new XRWebGLBinding(n,t),h=u.createProjectionLayer(K),n.updateRenderState({layers:[h]}),m=new Qt(h.textureWidth,h.textureHeight,{format:Ts,type:Zn,depthTexture:new wp(h.textureWidth,h.textureHeight,Q,void 0,void 0,void 0,void 0,void 0,void 0,F),stencilBuffer:f.stencil,encoding:e.outputEncoding,samples:f.antialias?4:0});let W=e.properties.get(m);W.__ignoreDepthValues=h.ignoreDepthValues}m.isXRRenderTarget=!0,this.setFoveation(o),l=null,s=await n.requestReferenceSpace(a),k.setContext(n),k.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}};function D(N){for(let F=0;F<N.removed.length;F++){let Q=N.removed[F],G=y.indexOf(Q);G>=0&&(y[G]=null,g[G].disconnect(Q))}for(let F=0;F<N.added.length;F++){let Q=N.added[F],G=y.indexOf(Q);if(G===-1){for(let W=0;W<g.length;W++)if(W>=y.length){y.push(Q),G=W;break}else if(y[W]===null){y[W]=Q,G=W;break}if(G===-1)break}let K=g[G];K&&K.connect(Q)}}let L=new T,B=new T;function j(N,F,Q){L.setFromMatrixPosition(F.matrixWorld),B.setFromMatrixPosition(Q.matrixWorld);let G=L.distanceTo(B),K=F.projectionMatrix.elements,W=Q.projectionMatrix.elements,se=K[14]/(K[10]-1),ie=K[14]/(K[10]+1),re=(K[9]+1)/K[5],de=(K[9]-1)/K[5],he=(K[8]-1)/K[0],X=(W[8]+1)/W[0],Ee=se*he,Oe=se*X,Me=G/(-he+X),Ne=Me*-he;F.matrixWorld.decompose(N.position,N.quaternion,N.scale),N.translateX(Ne),N.translateZ(Me),N.matrixWorld.compose(N.position,N.quaternion,N.scale),N.matrixWorldInverse.copy(N.matrixWorld).invert();let He=se+Me,Pe=ie+Me,Ce=Ee-Ne,je=Oe+(G-Ne),qe=re*ie/Pe*He,q=de*ie/Pe*He;N.projectionMatrix.makePerspective(Ce,je,qe,q,He,Pe)}function z(N,F){F===null?N.matrixWorld.copy(N.matrix):N.matrixWorld.multiplyMatrices(F.matrixWorld,N.matrix),N.matrixWorldInverse.copy(N.matrixWorld).invert()}this.updateCamera=function(N){if(n===null)return;S.near=w.near=b.near=N.near,S.far=w.far=b.far=N.far,(C!==S.near||E!==S.far)&&(n.updateRenderState({depthNear:S.near,depthFar:S.far}),C=S.near,E=S.far);let F=N.parent,Q=S.cameras;z(S,F);for(let K=0;K<Q.length;K++)z(Q[K],F);S.matrixWorld.decompose(S.position,S.quaternion,S.scale),N.matrix.copy(S.matrix),N.matrix.decompose(N.position,N.quaternion,N.scale);let G=N.children;for(let K=0,W=G.length;K<W;K++)G[K].updateMatrixWorld(!0);Q.length===2?j(S,b,w):S.projectionMatrix.copy(b.projectionMatrix)},this.getCamera=function(){return S},this.getFoveation=function(){if(!(h===null&&d===null))return o},this.setFoveation=function(N){o=N,h!==null&&(h.fixedFoveation=N),d!==null&&d.fixedFoveation!==void 0&&(d.fixedFoveation=N)},this.getPlanes=function(){return x};let O=null;function H(N,F){if(c=F.getViewerPose(l||s),p=F,c!==null){let Q=c.views;d!==null&&(e.setRenderTargetFramebuffer(m,d.framebuffer),e.setRenderTarget(m));let G=!1;Q.length!==S.cameras.length&&(S.cameras.length=0,G=!0);for(let K=0;K<Q.length;K++){let W=Q[K],se=null;if(d!==null)se=d.getViewport(W);else{let re=u.getViewSubImage(h,W);se=re.viewport,K===0&&(e.setRenderTargetTextures(m,re.colorTexture,h.ignoreDepthValues?void 0:re.depthStencilTexture),e.setRenderTarget(m))}let ie=M[K];ie===void 0&&(ie=new Vn,ie.layers.enable(K),ie.viewport=new Ct,M[K]=ie),ie.matrix.fromArray(W.transform.matrix),ie.projectionMatrix.fromArray(W.projectionMatrix),ie.viewport.set(se.x,se.y,se.width,se.height),K===0&&S.matrix.copy(ie.matrix),G===!0&&S.cameras.push(ie)}}for(let Q=0;Q<g.length;Q++){let G=y[Q],K=g[Q];G!==null&&K!==void 0&&K.update(G,F,l||s)}if(O&&O(N,F),F.detectedPlanes){i.dispatchEvent({type:"planesdetected",data:F.detectedPlanes});let Q=null;for(let G of x)F.detectedPlanes.has(G)||(Q===null&&(Q=[]),Q.push(G));if(Q!==null)for(let G of Q)x.delete(G),_.delete(G),i.dispatchEvent({type:"planeremoved",data:G});for(let G of F.detectedPlanes)if(!x.has(G))x.add(G),_.set(G,F.lastChangedTime),i.dispatchEvent({type:"planeadded",data:G});else{let K=_.get(G);G.lastChangedTime>K&&(_.set(G,G.lastChangedTime),i.dispatchEvent({type:"planechanged",data:G}))}}p=null}let k=new NB;k.setAnimationLoop(H),this.setAnimationLoop=function(N){O=N},this.dispose=function(){}}};function lte(e,t){function i(v,m){m.color.getRGB(v.fogColor.value,BB(e)),m.isFog?(v.fogNear.value=m.near,v.fogFar.value=m.far):m.isFogExp2&&(v.fogDensity.value=m.density)}function n(v,m,g,y,x){m.isMeshBasicMaterial||m.isMeshLambertMaterial?r(v,m):m.isMeshToonMaterial?(r(v,m),u(v,m)):m.isMeshPhongMaterial?(r(v,m),c(v,m)):m.isMeshStandardMaterial?(r(v,m),h(v,m),m.isMeshPhysicalMaterial&&d(v,m,x)):m.isMeshMatcapMaterial?(r(v,m),p(v,m)):m.isMeshDepthMaterial?r(v,m):m.isMeshDistanceMaterial?(r(v,m),f(v,m)):m.isMeshNormalMaterial?r(v,m):m.isLineBasicMaterial?(s(v,m),m.isLineDashedMaterial&&a(v,m)):m.isPointsMaterial?o(v,m,g,y):m.isSpriteMaterial?l(v,m):m.isShadowMaterial?(v.color.value.copy(m.color),v.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}function r(v,m){v.opacity.value=m.opacity,m.color&&v.diffuse.value.copy(m.color),m.emissive&&v.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(v.map.value=m.map),m.alphaMap&&(v.alphaMap.value=m.alphaMap),m.bumpMap&&(v.bumpMap.value=m.bumpMap,v.bumpScale.value=m.bumpScale,m.side===wn&&(v.bumpScale.value*=-1)),m.displacementMap&&(v.displacementMap.value=m.displacementMap,v.displacementScale.value=m.displacementScale,v.displacementBias.value=m.displacementBias),m.emissiveMap&&(v.emissiveMap.value=m.emissiveMap),m.normalMap&&(v.normalMap.value=m.normalMap,v.normalScale.value.copy(m.normalScale),m.side===wn&&v.normalScale.value.negate()),m.specularMap&&(v.specularMap.value=m.specularMap),m.alphaTest>0&&(v.alphaTest.value=m.alphaTest);let g=t.get(m).envMap;if(g&&(v.envMap.value=g,v.flipEnvMap.value=g.isCubeTexture&&g.isRenderTargetTexture===!1?-1:1,v.reflectivity.value=m.reflectivity,v.ior.value=m.ior,v.refractionRatio.value=m.refractionRatio),m.lightMap){v.lightMap.value=m.lightMap;let _=e.physicallyCorrectLights!==!0?Math.PI:1;v.lightMapIntensity.value=m.lightMapIntensity*_}m.aoMap&&(v.aoMap.value=m.aoMap,v.aoMapIntensity.value=m.aoMapIntensity);let y;m.map?y=m.map:m.specularMap?y=m.specularMap:m.displacementMap?y=m.displacementMap:m.normalMap?y=m.normalMap:m.bumpMap?y=m.bumpMap:m.roughnessMap?y=m.roughnessMap:m.metalnessMap?y=m.metalnessMap:m.alphaMap?y=m.alphaMap:m.emissiveMap?y=m.emissiveMap:m.clearcoatMap?y=m.clearcoatMap:m.clearcoatNormalMap?y=m.clearcoatNormalMap:m.clearcoatRoughnessMap?y=m.clearcoatRoughnessMap:m.iridescenceMap?y=m.iridescenceMap:m.iridescenceThicknessMap?y=m.iridescenceThicknessMap:m.specularIntensityMap?y=m.specularIntensityMap:m.specularColorMap?y=m.specularColorMap:m.transmissionMap?y=m.transmissionMap:m.thicknessMap?y=m.thicknessMap:m.sheenColorMap?y=m.sheenColorMap:m.sheenRoughnessMap&&(y=m.sheenRoughnessMap),y!==void 0&&(y.isWebGLRenderTarget&&(y=y.texture),y.matrixAutoUpdate===!0&&y.updateMatrix(),v.uvTransform.value.copy(y.matrix));let x;m.aoMap?x=m.aoMap:m.lightMap&&(x=m.lightMap),x!==void 0&&(x.isWebGLRenderTarget&&(x=x.texture),x.matrixAutoUpdate===!0&&x.updateMatrix(),v.uv2Transform.value.copy(x.matrix))}function s(v,m){v.diffuse.value.copy(m.color),v.opacity.value=m.opacity}function a(v,m){v.dashSize.value=m.dashSize,v.totalSize.value=m.dashSize+m.gapSize,v.scale.value=m.scale}function o(v,m,g,y){v.diffuse.value.copy(m.color),v.opacity.value=m.opacity,v.size.value=m.size*g,v.scale.value=y*.5,m.map&&(v.map.value=m.map),m.alphaMap&&(v.alphaMap.value=m.alphaMap),m.alphaTest>0&&(v.alphaTest.value=m.alphaTest);let x;m.map?x=m.map:m.alphaMap&&(x=m.alphaMap),x!==void 0&&(x.matrixAutoUpdate===!0&&x.updateMatrix(),v.uvTransform.value.copy(x.matrix))}function l(v,m){v.diffuse.value.copy(m.color),v.opacity.value=m.opacity,v.rotation.value=m.rotation,m.map&&(v.map.value=m.map),m.alphaMap&&(v.alphaMap.value=m.alphaMap),m.alphaTest>0&&(v.alphaTest.value=m.alphaTest);let g;m.map?g=m.map:m.alphaMap&&(g=m.alphaMap),g!==void 0&&(g.matrixAutoUpdate===!0&&g.updateMatrix(),v.uvTransform.value.copy(g.matrix))}function c(v,m){v.specular.value.copy(m.specular),v.shininess.value=Math.max(m.shininess,1e-4)}function u(v,m){m.gradientMap&&(v.gradientMap.value=m.gradientMap)}function h(v,m){v.roughness.value=m.roughness,v.metalness.value=m.metalness,m.roughnessMap&&(v.roughnessMap.value=m.roughnessMap),m.metalnessMap&&(v.metalnessMap.value=m.metalnessMap),t.get(m).envMap&&(v.envMapIntensity.value=m.envMapIntensity)}function d(v,m,g){v.ior.value=m.ior,m.sheen>0&&(v.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),v.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(v.sheenColorMap.value=m.sheenColorMap),m.sheenRoughnessMap&&(v.sheenRoughnessMap.value=m.sheenRoughnessMap)),m.clearcoat>0&&(v.clearcoat.value=m.clearcoat,v.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(v.clearcoatMap.value=m.clearcoatMap),m.clearcoatRoughnessMap&&(v.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap),m.clearcoatNormalMap&&(v.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),v.clearcoatNormalMap.value=m.clearcoatNormalMap,m.side===wn&&v.clearcoatNormalScale.value.negate())),m.iridescence>0&&(v.iridescence.value=m.iridescence,v.iridescenceIOR.value=m.iridescenceIOR,v.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],v.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(v.iridescenceMap.value=m.iridescenceMap),m.iridescenceThicknessMap&&(v.iridescenceThicknessMap.value=m.iridescenceThicknessMap)),m.transmission>0&&(v.transmission.value=m.transmission,v.transmissionSamplerMap.value=g.texture,v.transmissionSamplerSize.value.set(g.width,g.height),m.transmissionMap&&(v.transmissionMap.value=m.transmissionMap),v.thickness.value=m.thickness,m.thicknessMap&&(v.thicknessMap.value=m.thicknessMap),v.attenuationDistance.value=m.attenuationDistance,v.attenuationColor.value.copy(m.attenuationColor)),v.specularIntensity.value=m.specularIntensity,v.specularColor.value.copy(m.specularColor),m.specularIntensityMap&&(v.specularIntensityMap.value=m.specularIntensityMap),m.specularColorMap&&(v.specularColorMap.value=m.specularColorMap)}function p(v,m){m.matcap&&(v.matcap.value=m.matcap)}function f(v,m){v.referencePosition.value.copy(m.referencePosition),v.nearDistance.value=m.nearDistance,v.farDistance.value=m.farDistance}return{refreshFogUniforms:i,refreshMaterialUniforms:n}}function cte(e,t,i,n){let r={},s={},a=[],o=i.isWebGL2?e.getParameter(35375):0;function l(y,x){let _=x.program;n.uniformBlockBinding(y,_)}function c(y,x){let _=r[y.id];_===void 0&&(f(y),_=u(y),r[y.id]=_,y.addEventListener("dispose",m));let b=x.program;n.updateUBOMapping(y,b);let w=t.render.frame;s[y.id]!==w&&(d(y),s[y.id]=w)}function u(y){let x=h();y.__bindingPointIndex=x;let _=e.createBuffer(),b=y.__size,w=y.usage;return e.bindBuffer(35345,_),e.bufferData(35345,b,w),e.bindBuffer(35345,null),e.bindBufferBase(35345,x,_),_}function h(){for(let y=0;y<o;y++)if(a.indexOf(y)===-1)return a.push(y),y;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(y){let x=r[y.id],_=y.uniforms,b=y.__cache;e.bindBuffer(35345,x);for(let w=0,M=_.length;w<M;w++){let S=_[w];if(p(S,w,b)===!0){let C=S.__offset,E=Array.isArray(S.value)?S.value:[S.value],P=0;for(let I=0;I<E.length;I++){let D=E[I],L=v(D);typeof D=="number"?(S.__data[0]=D,e.bufferSubData(35345,C+P,S.__data)):D.isMatrix3?(S.__data[0]=D.elements[0],S.__data[1]=D.elements[1],S.__data[2]=D.elements[2],S.__data[3]=D.elements[0],S.__data[4]=D.elements[3],S.__data[5]=D.elements[4],S.__data[6]=D.elements[5],S.__data[7]=D.elements[0],S.__data[8]=D.elements[6],S.__data[9]=D.elements[7],S.__data[10]=D.elements[8],S.__data[11]=D.elements[0]):(D.toArray(S.__data,P),P+=L.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(35345,C,S.__data)}}e.bindBuffer(35345,null)}function p(y,x,_){let b=y.value;if(_[x]===void 0){if(typeof b=="number")_[x]=b;else{let w=Array.isArray(b)?b:[b],M=[];for(let S=0;S<w.length;S++)M.push(w[S].clone());_[x]=M}return!0}else if(typeof b=="number"){if(_[x]!==b)return _[x]=b,!0}else{let w=Array.isArray(_[x])?_[x]:[_[x]],M=Array.isArray(b)?b:[b];for(let S=0;S<w.length;S++){let C=w[S];if(C.equals(M[S])===!1)return C.copy(M[S]),!0}}return!1}function f(y){let x=y.uniforms,_=0,b=16,w=0;for(let M=0,S=x.length;M<S;M++){let C=x[M],E={boundary:0,storage:0},P=Array.isArray(C.value)?C.value:[C.value];for(let I=0,D=P.length;I<D;I++){let L=P[I],B=v(L);E.boundary+=B.boundary,E.storage+=B.storage}if(C.__data=new Float32Array(E.storage/Float32Array.BYTES_PER_ELEMENT),C.__offset=_,M>0){w=_%b;let I=b-w;w!==0&&I-E.boundary<0&&(_+=b-w,C.__offset=_)}_+=E.storage}return w=_%b,w>0&&(_+=b-w),y.__size=_,y.__cache={},this}function v(y){let x={boundary:0,storage:0};return typeof y=="number"?(x.boundary=4,x.storage=4):y.isVector2?(x.boundary=8,x.storage=8):y.isVector3||y.isColor?(x.boundary=16,x.storage=12):y.isVector4?(x.boundary=16,x.storage=16):y.isMatrix3?(x.boundary=48,x.storage=48):y.isMatrix4?(x.boundary=64,x.storage=64):y.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",y),x}function m(y){let x=y.target;x.removeEventListener("dispose",m);let _=a.indexOf(x.__bindingPointIndex);a.splice(_,1),e.deleteBuffer(r[x.id]),delete r[x.id],delete s[x.id]}function g(){for(let y in r)e.deleteBuffer(r[y]);a=[],r={},s={}}return{bind:l,update:c,dispose:g}}function hte(){let e=Oy("canvas");return e.style.display="block",e}function HB(e={}){this.isWebGLRenderer=!0;let t=e.canvas!==void 0?e.canvas:hte(),i=e.context!==void 0?e.context:null,n=e.depth!==void 0?e.depth:!0,r=e.stencil!==void 0?e.stencil:!0,s=e.antialias!==void 0?e.antialias:!1,a=e.premultipliedAlpha!==void 0?e.premultipliedAlpha:!0,o=e.preserveDrawingBuffer!==void 0?e.preserveDrawingBuffer:!1,l=e.powerPreference!==void 0?e.powerPreference:"default",c=e.failIfMajorPerformanceCaveat!==void 0?e.failIfMajorPerformanceCaveat:!1,u;i!==null?u=i.getContextAttributes().alpha:u=e.alpha!==void 0?e.alpha:!1;let h=null,d=null,p=[],f=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=no,this.physicallyCorrectLights=!1,this.toneMapping=tl,this.toneMappingExposure=1;let v=this,m=!1,g=0,y=0,x=null,_=-1,b=null,w=new Ct,M=new Ct,S=null,C=t.width,E=t.height,P=1,I=null,D=null,L=new Ct(0,0,C,E),B=new Ct(0,0,C,E),j=!1,z=new ME,O=!1,H=!1,k=null,N=new ke,F=new te,Q=new T,G={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function K(){return x===null?P:1}let W=i;function se(Z,be){for(let Re=0;Re<Z.length;Re++){let xe=Z[Re],Ie=t.getContext(xe,be);if(Ie!==null)return Ie}return null}try{let Z={alpha:!0,depth:n,stencil:r,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:o,powerPreference:l,failIfMajorPerformanceCaveat:c};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${jp}`),t.addEventListener("webglcontextlost",Le,!1),t.addEventListener("webglcontextrestored",Ae,!1),t.addEventListener("webglcontextcreationerror",Ue,!1),W===null){let be=["webgl2","webgl","experimental-webgl"];if(v.isWebGL1Renderer===!0&&be.shift(),W=se(be,Z),W===null)throw se(be)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}W.getShaderPrecisionFormat===void 0&&(W.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Z){throw console.error("THREE.WebGLRenderer: "+Z.message),Z}let ie,re,de,he,X,Ee,Oe,Me,Ne,He,Pe,Ce,je,qe,q,A,R,$,le,ue,we,De,ne,oe;function Y(){ie=new SJ(W),re=new vJ(W,ie,e),ie.init(re),De=new rte(W,ie,re),de=new ite(W,ie,re),he=new EJ,X=new Gee,Ee=new nte(W,ie,de,X,re,De,he),Oe=new xJ(v),Me=new wJ(v),Ne=new BQ(W,re),ne=new mJ(W,ie,Ne,re),He=new MJ(W,Ne,he,ne),Pe=new DJ(W,He,Ne,he),le=new PJ(W,re,Ee),A=new yJ(X),Ce=new Hee(v,Oe,Me,ie,re,ne,A),je=new lte(v,X),qe=new Wee,q=new Kee(ie,re),$=new fJ(v,Oe,Me,de,Pe,u,a),R=new tte(v,Pe,re),oe=new cte(W,he,re,de),ue=new gJ(W,ie,he,re),we=new CJ(W,ie,he,re),he.programs=Ce.programs,v.capabilities=re,v.extensions=ie,v.properties=X,v.renderLists=qe,v.shadowMap=R,v.state=de,v.info=he}Y();let me=new ote(v,W);this.xr=me,this.getContext=function(){return W},this.getContextAttributes=function(){return W.getContextAttributes()},this.forceContextLoss=function(){let Z=ie.get("WEBGL_lose_context");Z&&Z.loseContext()},this.forceContextRestore=function(){let Z=ie.get("WEBGL_lose_context");Z&&Z.restoreContext()},this.getPixelRatio=function(){return P},this.setPixelRatio=function(Z){Z!==void 0&&(P=Z,this.setSize(C,E,!1))},this.getSize=function(Z){return Z.set(C,E)},this.setSize=function(Z,be,Re){if(me.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}C=Z,E=be,t.width=Math.floor(Z*P),t.height=Math.floor(be*P),Re!==!1&&(t.style.width=Z+"px",t.style.height=be+"px"),this.setViewport(0,0,Z,be)},this.getDrawingBufferSize=function(Z){return Z.set(C*P,E*P).floor()},this.setDrawingBufferSize=function(Z,be,Re){C=Z,E=be,P=Re,t.width=Math.floor(Z*Re),t.height=Math.floor(be*Re),this.setViewport(0,0,Z,be)},this.getCurrentViewport=function(Z){return Z.copy(w)},this.getViewport=function(Z){return Z.copy(L)},this.setViewport=function(Z,be,Re,xe){Z.isVector4?L.set(Z.x,Z.y,Z.z,Z.w):L.set(Z,be,Re,xe),de.viewport(w.copy(L).multiplyScalar(P).floor())},this.getScissor=function(Z){return Z.copy(B)},this.setScissor=function(Z,be,Re,xe){Z.isVector4?B.set(Z.x,Z.y,Z.z,Z.w):B.set(Z,be,Re,xe),de.scissor(M.copy(B).multiplyScalar(P).floor())},this.getScissorTest=function(){return j},this.setScissorTest=function(Z){de.setScissorTest(j=Z)},this.setOpaqueSort=function(Z){I=Z},this.setTransparentSort=function(Z){D=Z},this.getClearColor=function(Z){return Z.copy($.getClearColor())},this.setClearColor=function(){$.setClearColor.apply($,arguments)},this.getClearAlpha=function(){return $.getClearAlpha()},this.setClearAlpha=function(){$.setClearAlpha.apply($,arguments)},this.clear=function(Z=!0,be=!0,Re=!0){let xe=0;Z&&(xe|=16384),be&&(xe|=256),Re&&(xe|=1024),W.clear(xe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Le,!1),t.removeEventListener("webglcontextrestored",Ae,!1),t.removeEventListener("webglcontextcreationerror",Ue,!1),qe.dispose(),q.dispose(),X.dispose(),Oe.dispose(),Me.dispose(),Pe.dispose(),ne.dispose(),oe.dispose(),Ce.dispose(),me.dispose(),me.removeEventListener("sessionstart",ge),me.removeEventListener("sessionend",Te),k&&(k.dispose(),k=null),Qe.stop()};function Le(Z){Z.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),m=!0}function Ae(){console.log("THREE.WebGLRenderer: Context Restored."),m=!1;let Z=he.autoReset,be=R.enabled,Re=R.autoUpdate,xe=R.needsUpdate,Ie=R.type;Y(),he.autoReset=Z,R.enabled=be,R.autoUpdate=Re,R.needsUpdate=xe,R.type=Ie}function Ue(Z){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",Z.statusMessage)}function $e(Z){let be=Z.target;be.removeEventListener("dispose",$e),at(be)}function at(Z){U(Z),X.remove(Z)}function U(Z){let be=X.get(Z).programs;be!==void 0&&(be.forEach(function(Re){Ce.releaseProgram(Re)}),Z.isShaderMaterial&&Ce.releaseShaderCache(Z))}this.renderBufferDirect=function(Z,be,Re,xe,Ie,rt){be===null&&(be=G);let V=Ie.isMesh&&Ie.matrixWorld.determinant()<0,ce=gg(Z,be,Re,xe,Ie);de.setMaterial(xe,V);let ye=Re.index,pe=1;xe.wireframe===!0&&(ye=He.getWireframeAttribute(Re),pe=2);let _e=Re.drawRange,Ve=Re.attributes.position,tt=_e.start*pe,st=(_e.start+_e.count)*pe;rt!==null&&(tt=Math.max(tt,rt.start*pe),st=Math.min(st,(rt.start+rt.count)*pe)),ye!==null?(tt=Math.max(tt,0),st=Math.min(st,ye.count)):Ve!=null&&(tt=Math.max(tt,0),st=Math.min(st,Ve.count));let lt=st-tt;if(lt<0||lt===1/0)return;ne.setup(Ie,xe,ce,Re,ye);let wt,it=ue;if(ye!==null&&(wt=Ne.get(ye),it=we,it.setIndex(wt)),Ie.isMesh)xe.wireframe===!0?(de.setLineWidth(xe.wireframeLinewidth*K()),it.setMode(1)):it.setMode(4);else if(Ie.isLine){let Ze=xe.linewidth;Ze===void 0&&(Ze=1),de.setLineWidth(Ze*K()),Ie.isLineSegments?it.setMode(1):Ie.isLineLoop?it.setMode(2):it.setMode(3)}else Ie.isPoints?it.setMode(0):Ie.isSprite&&it.setMode(4);if(Ie.isInstancedMesh)it.renderInstances(tt,lt,Ie.count);else if(Re.isInstancedBufferGeometry){let Ze=Re._maxInstanceCount!==void 0?Re._maxInstanceCount:1/0,li=Math.min(Re.instanceCount,Ze);it.renderInstances(tt,lt,li)}else it.render(tt,lt)},this.compile=function(Z,be){function Re(xe,Ie,rt){xe.transparent===!0&&xe.side===Jr&&xe.forceSinglePass===!1?(xe.side=wn,xe.needsUpdate=!0,ei(xe,Ie,rt),xe.side=ya,xe.needsUpdate=!0,ei(xe,Ie,rt),xe.side=Jr):ei(xe,Ie,rt)}d=q.get(Z),d.init(),f.push(d),Z.traverseVisible(function(xe){xe.isLight&&xe.layers.test(be.layers)&&(d.pushLight(xe),xe.castShadow&&d.pushShadow(xe))}),d.setupLights(v.physicallyCorrectLights),Z.traverse(function(xe){let Ie=xe.material;if(Ie)if(Array.isArray(Ie))for(let rt=0;rt<Ie.length;rt++){let V=Ie[rt];Re(V,Z,xe)}else Re(Ie,Z,xe)}),f.pop(),d=null};let ae=null;function J(Z){ae&&ae(Z)}function ge(){Qe.stop()}function Te(){Qe.start()}let Qe=new NB;Qe.setAnimationLoop(J),typeof self<"u"&&Qe.setContext(self),this.setAnimationLoop=function(Z){ae=Z,me.setAnimationLoop(Z),Z===null?Qe.stop():Qe.start()},me.addEventListener("sessionstart",ge),me.addEventListener("sessionend",Te),this.render=function(Z,be){if(be!==void 0&&be.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(m===!0)return;Z.matrixWorldAutoUpdate===!0&&Z.updateMatrixWorld(),be.parent===null&&be.matrixWorldAutoUpdate===!0&&be.updateMatrixWorld(),me.enabled===!0&&me.isPresenting===!0&&(me.cameraAutoUpdate===!0&&me.updateCamera(be),be=me.getCamera()),Z.isScene===!0&&Z.onBeforeRender(v,Z,be,x),d=q.get(Z,f.length),d.init(),f.push(d),N.multiplyMatrices(be.projectionMatrix,be.matrixWorldInverse),z.setFromProjectionMatrix(N),H=this.localClippingEnabled,O=A.init(this.clippingPlanes,H),h=qe.get(Z,p.length),h.init(),p.push(h),_t(Z,be,0,v.sortObjects),h.finish(),v.sortObjects===!0&&h.sort(I,D),O===!0&&A.beginShadows();let Re=d.state.shadowsArray;if(R.render(Re,Z,be),O===!0&&A.endShadows(),this.info.autoReset===!0&&this.info.reset(),$.render(h,Z),d.setupLights(v.physicallyCorrectLights),be.isArrayCamera){let xe=be.cameras;for(let Ie=0,rt=xe.length;Ie<rt;Ie++){let V=xe[Ie];Tt(h,Z,V,V.viewport)}}else Tt(h,Z,be);x!==null&&(Ee.updateMultisampleRenderTarget(x),Ee.updateRenderTargetMipmap(x)),Z.isScene===!0&&Z.onAfterRender(v,Z,be),ne.resetDefaultState(),_=-1,b=null,f.pop(),f.length>0?d=f[f.length-1]:d=null,p.pop(),p.length>0?h=p[p.length-1]:h=null};function _t(Z,be,Re,xe){if(Z.visible===!1)return;if(Z.layers.test(be.layers)){if(Z.isGroup)Re=Z.renderOrder;else if(Z.isLOD)Z.autoUpdate===!0&&Z.update(be);else if(Z.isLight)d.pushLight(Z),Z.castShadow&&d.pushShadow(Z);else if(Z.isSprite){if(!Z.frustumCulled||z.intersectsSprite(Z)){xe&&Q.setFromMatrixPosition(Z.matrixWorld).applyMatrix4(N);let rt=Pe.update(Z),V=Z.material;V.visible&&h.push(Z,rt,V,Re,Q.z,null)}}else if((Z.isMesh||Z.isLine||Z.isPoints)&&(Z.isSkinnedMesh&&Z.skeleton.frame!==he.render.frame&&(Z.skeleton.update(),Z.skeleton.frame=he.render.frame),!Z.frustumCulled||z.intersectsObject(Z))){xe&&Q.setFromMatrixPosition(Z.matrixWorld).applyMatrix4(N);let rt=Pe.update(Z),V=Z.material;if(Array.isArray(V)){let ce=rt.groups;for(let ye=0,pe=ce.length;ye<pe;ye++){let _e=ce[ye],Ve=V[_e.materialIndex];Ve&&Ve.visible&&h.push(Z,rt,Ve,Re,Q.z,_e)}}else V.visible&&h.push(Z,rt,V,Re,Q.z,null)}}let Ie=Z.children;for(let rt=0,V=Ie.length;rt<V;rt++)_t(Ie[rt],be,Re,xe)}function Tt(Z,be,Re,xe){let Ie=Z.opaque,rt=Z.transmissive,V=Z.transparent;d.setupLightsView(Re),O===!0&&A.setGlobalState(v.clippingPlanes,Re),rt.length>0&&Ri(Ie,be,Re),xe&&de.viewport(w.copy(xe)),Ie.length>0&&vt(Ie,be,Re),rt.length>0&&vt(rt,be,Re),V.length>0&&vt(V,be,Re),de.buffers.depth.setTest(!0),de.buffers.depth.setMask(!0),de.buffers.color.setMask(!0),de.setPolygonOffset(!1)}function Ri(Z,be,Re){let xe=re.isWebGL2;k===null&&(k=new Qt(1,1,{generateMipmaps:!0,type:ie.has("EXT_color_buffer_half_float")?_p:Zn,minFilter:xp,samples:xe&&s===!0?4:0})),v.getDrawingBufferSize(F),xe?k.setSize(F.x,F.y):k.setSize(Iy(F.x),Iy(F.y));let Ie=v.getRenderTarget();v.setRenderTarget(k),v.clear();let rt=v.toneMapping;v.toneMapping=tl,vt(Z,be,Re),v.toneMapping=rt,Ee.updateMultisampleRenderTarget(k),Ee.updateRenderTargetMipmap(k),v.setRenderTarget(Ie)}function vt(Z,be,Re){let xe=be.isScene===!0?be.overrideMaterial:null;for(let Ie=0,rt=Z.length;Ie<rt;Ie++){let V=Z[Ie],ce=V.object,ye=V.geometry,pe=xe===null?V.material:xe,_e=V.group;ce.layers.test(Re.layers)&&Hi(ce,be,Re,ye,pe,_e)}}function Hi(Z,be,Re,xe,Ie,rt){Z.onBeforeRender(v,be,Re,xe,Ie,rt),Z.modelViewMatrix.multiplyMatrices(Re.matrixWorldInverse,Z.matrixWorld),Z.normalMatrix.getNormalMatrix(Z.modelViewMatrix),Ie.onBeforeRender(v,be,Re,xe,Z,rt),Ie.transparent===!0&&Ie.side===Jr&&Ie.forceSinglePass===!1?(Ie.side=wn,Ie.needsUpdate=!0,v.renderBufferDirect(Re,be,xe,Ie,Z,rt),Ie.side=ya,Ie.needsUpdate=!0,v.renderBufferDirect(Re,be,xe,Ie,Z,rt),Ie.side=Jr):v.renderBufferDirect(Re,be,xe,Ie,Z,rt),Z.onAfterRender(v,be,Re,xe,Ie,rt)}function ei(Z,be,Re){be.isScene!==!0&&(be=G);let xe=X.get(Z),Ie=d.state.lights,rt=d.state.shadowsArray,V=Ie.state.version,ce=Ce.getParameters(Z,Ie.state,rt,be,Re),ye=Ce.getProgramCacheKey(ce),pe=xe.programs;xe.environment=Z.isMeshStandardMaterial?be.environment:null,xe.fog=be.fog,xe.envMap=(Z.isMeshStandardMaterial?Me:Oe).get(Z.envMap||xe.environment),pe===void 0&&(Z.addEventListener("dispose",$e),pe=new Map,xe.programs=pe);let _e=pe.get(ye);if(_e!==void 0){if(xe.currentProgram===_e&&xe.lightsStateVersion===V)return hf(Z,ce),_e}else ce.uniforms=Ce.getUniforms(Z),Z.onBuild(Re,ce,v),Z.onBeforeCompile(ce,v),_e=Ce.acquireProgram(ce,ye),pe.set(ye,_e),xe.uniforms=ce.uniforms;let Ve=xe.uniforms;(!Z.isShaderMaterial&&!Z.isRawShaderMaterial||Z.clipping===!0)&&(Ve.clippingPlanes=A.uniform),hf(Z,ce),xe.needsLights=cu(Z),xe.lightsStateVersion=V,xe.needsLights&&(Ve.ambientLightColor.value=Ie.state.ambient,Ve.lightProbe.value=Ie.state.probe,Ve.directionalLights.value=Ie.state.directional,Ve.directionalLightShadows.value=Ie.state.directionalShadow,Ve.spotLights.value=Ie.state.spot,Ve.spotLightShadows.value=Ie.state.spotShadow,Ve.rectAreaLights.value=Ie.state.rectArea,Ve.ltc_1.value=Ie.state.rectAreaLTC1,Ve.ltc_2.value=Ie.state.rectAreaLTC2,Ve.pointLights.value=Ie.state.point,Ve.pointLightShadows.value=Ie.state.pointShadow,Ve.hemisphereLights.value=Ie.state.hemi,Ve.directionalShadowMap.value=Ie.state.directionalShadowMap,Ve.directionalShadowMatrix.value=Ie.state.directionalShadowMatrix,Ve.spotShadowMap.value=Ie.state.spotShadowMap,Ve.spotLightMatrix.value=Ie.state.spotLightMatrix,Ve.spotLightMap.value=Ie.state.spotLightMap,Ve.pointShadowMap.value=Ie.state.pointShadowMap,Ve.pointShadowMatrix.value=Ie.state.pointShadowMatrix);let tt=_e.getUniforms(),st=zv.seqWithValue(tt.seq,Ve);return xe.currentProgram=_e,xe.uniformsList=st,_e}function hf(Z,be){let Re=X.get(Z);Re.outputEncoding=be.outputEncoding,Re.instancing=be.instancing,Re.skinning=be.skinning,Re.morphTargets=be.morphTargets,Re.morphNormals=be.morphNormals,Re.morphColors=be.morphColors,Re.morphTargetsCount=be.morphTargetsCount,Re.numClippingPlanes=be.numClippingPlanes,Re.numIntersection=be.numClipIntersection,Re.vertexAlphas=be.vertexAlphas,Re.vertexTangents=be.vertexTangents,Re.toneMapping=be.toneMapping}function gg(Z,be,Re,xe,Ie){be.isScene!==!0&&(be=G),Ee.resetTextureUnits();let rt=be.fog,V=xe.isMeshStandardMaterial?be.environment:null,ce=x===null?v.outputEncoding:x.isXRRenderTarget===!0?x.texture.encoding:no,ye=(xe.isMeshStandardMaterial?Me:Oe).get(xe.envMap||V),pe=xe.vertexColors===!0&&!!Re.attributes.color&&Re.attributes.color.itemSize===4,_e=!!xe.normalMap&&!!Re.attributes.tangent,Ve=!!Re.morphAttributes.position,tt=!!Re.morphAttributes.normal,st=!!Re.morphAttributes.color,lt=xe.toneMapped?v.toneMapping:tl,wt=Re.morphAttributes.position||Re.morphAttributes.normal||Re.morphAttributes.color,it=wt!==void 0?wt.length:0,Ze=X.get(xe),li=d.state.lights;if(O===!0&&(H===!0||Z!==b)){let On=Z===b&&xe.id===_;A.setState(xe,Z,On)}let pi=!1;xe.version===Ze.__version?(Ze.needsLights&&Ze.lightsStateVersion!==li.state.version||Ze.outputEncoding!==ce||Ie.isInstancedMesh&&Ze.instancing===!1||!Ie.isInstancedMesh&&Ze.instancing===!0||Ie.isSkinnedMesh&&Ze.skinning===!1||!Ie.isSkinnedMesh&&Ze.skinning===!0||Ze.envMap!==ye||xe.fog===!0&&Ze.fog!==rt||Ze.numClippingPlanes!==void 0&&(Ze.numClippingPlanes!==A.numPlanes||Ze.numIntersection!==A.numIntersection)||Ze.vertexAlphas!==pe||Ze.vertexTangents!==_e||Ze.morphTargets!==Ve||Ze.morphNormals!==tt||Ze.morphColors!==st||Ze.toneMapping!==lt||re.isWebGL2===!0&&Ze.morphTargetsCount!==it)&&(pi=!0):(pi=!0,Ze.__version=xe.version);let Gi=Ze.currentProgram;pi===!0&&(Gi=ei(xe,be,Ie));let ds=!1,ci=!1,Rt=!1,Ii=Gi.getUniforms(),ti=Ze.uniforms;if(de.useProgram(Gi.program)&&(ds=!0,ci=!0,Rt=!0),xe.id!==_&&(_=xe.id,ci=!0),ds||b!==Z){if(Ii.setValue(W,"projectionMatrix",Z.projectionMatrix),re.logarithmicDepthBuffer&&Ii.setValue(W,"logDepthBufFC",2/(Math.log(Z.far+1)/Math.LN2)),b!==Z&&(b=Z,ci=!0,Rt=!0),xe.isShaderMaterial||xe.isMeshPhongMaterial||xe.isMeshToonMaterial||xe.isMeshStandardMaterial||xe.envMap){let On=Ii.map.cameraPosition;On!==void 0&&On.setValue(W,Q.setFromMatrixPosition(Z.matrixWorld))}(xe.isMeshPhongMaterial||xe.isMeshToonMaterial||xe.isMeshLambertMaterial||xe.isMeshBasicMaterial||xe.isMeshStandardMaterial||xe.isShaderMaterial)&&Ii.setValue(W,"isOrthographic",Z.isOrthographicCamera===!0),(xe.isMeshPhongMaterial||xe.isMeshToonMaterial||xe.isMeshLambertMaterial||xe.isMeshBasicMaterial||xe.isMeshStandardMaterial||xe.isShaderMaterial||xe.isShadowMaterial||Ie.isSkinnedMesh)&&Ii.setValue(W,"viewMatrix",Z.matrixWorldInverse)}if(Ie.isSkinnedMesh){Ii.setOptional(W,Ie,"bindMatrix"),Ii.setOptional(W,Ie,"bindMatrixInverse");let On=Ie.skeleton;On&&(re.floatVertexTextures?(On.boneTexture===null&&On.computeBoneTexture(),Ii.setValue(W,"boneTexture",On.boneTexture,Ee),Ii.setValue(W,"boneTextureSize",On.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}let zs=Re.morphAttributes;if((zs.position!==void 0||zs.normal!==void 0||zs.color!==void 0&&re.isWebGL2===!0)&&le.update(Ie,Re,xe,Gi),(ci||Ze.receiveShadow!==Ie.receiveShadow)&&(Ze.receiveShadow=Ie.receiveShadow,Ii.setValue(W,"receiveShadow",Ie.receiveShadow)),xe.isMeshGouraudMaterial&&xe.envMap!==null&&(ti.envMap.value=ye,ti.flipEnvMap.value=ye.isCubeTexture&&ye.isRenderTargetTexture===!1?-1:1),ci&&(Ii.setValue(W,"toneMappingExposure",v.toneMappingExposure),Ze.needsLights&&O2(ti,Rt),rt&&xe.fog===!0&&je.refreshFogUniforms(ti,rt),je.refreshMaterialUniforms(ti,xe,P,E,k),zv.upload(W,Ze.uniformsList,ti,Ee)),xe.isShaderMaterial&&xe.uniformsNeedUpdate===!0&&(zv.upload(W,Ze.uniformsList,ti,Ee),xe.uniformsNeedUpdate=!1),xe.isSpriteMaterial&&Ii.setValue(W,"center",Ie.center),Ii.setValue(W,"modelViewMatrix",Ie.modelViewMatrix),Ii.setValue(W,"normalMatrix",Ie.normalMatrix),Ii.setValue(W,"modelMatrix",Ie.matrixWorld),Ie.previousModelViewMatrix&&Ii.setValue(W,"previousModelViewMatrix",Ie.previousModelViewMatrix),Z.previousProjectionMatrix&&Ii.setValue(W,"previousProjectionMatrix",Z.previousProjectionMatrix),xe.isShaderMaterial||xe.isRawShaderMaterial){let On=xe.uniformsGroups;for(let fo=0,uf=On.length;fo<uf;fo++)if(re.isWebGL2){let mn=On[fo];oe.update(mn,Gi),oe.bind(mn,Gi)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return Gi}function O2(Z,be){Z.ambientLightColor.needsUpdate=be,Z.lightProbe.needsUpdate=be,Z.directionalLights.needsUpdate=be,Z.directionalLightShadows.needsUpdate=be,Z.pointLights.needsUpdate=be,Z.pointLightShadows.needsUpdate=be,Z.spotLights.needsUpdate=be,Z.spotLightShadows.needsUpdate=be,Z.rectAreaLights.needsUpdate=be,Z.hemisphereLights.needsUpdate=be}function cu(Z){return Z.isMeshLambertMaterial||Z.isMeshToonMaterial||Z.isMeshPhongMaterial||Z.isMeshStandardMaterial||Z.isShadowMaterial||Z.isShaderMaterial&&Z.lights===!0}this.getActiveCubeFace=function(){return g},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return x},this.setRenderTargetTextures=function(Z,be,Re){X.get(Z.texture).__webglTexture=be,X.get(Z.depthTexture).__webglTexture=Re;let xe=X.get(Z);xe.__hasExternalTextures=!0,xe.__hasExternalTextures&&(xe.__autoAllocateDepthBuffer=Re===void 0,xe.__autoAllocateDepthBuffer||ie.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),xe.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(Z,be){let Re=X.get(Z);Re.__webglFramebuffer=be,Re.__useDefaultFramebuffer=be===void 0},this.setRenderTarget=function(Z,be=0,Re=0){x=Z,g=be,y=Re;let xe=!0,Ie=null,rt=!1,V=!1;if(Z){let ce=X.get(Z);ce.__useDefaultFramebuffer!==void 0?(de.bindFramebuffer(36160,null),xe=!1):ce.__webglFramebuffer===void 0?Ee.setupRenderTarget(Z):ce.__hasExternalTextures&&Ee.rebindTextures(Z,X.get(Z.texture).__webglTexture,X.get(Z.depthTexture).__webglTexture);let ye=Z.texture;(ye.isData3DTexture||ye.isDataArrayTexture||ye.isCompressedArrayTexture)&&(V=!0);let pe=X.get(Z).__webglFramebuffer;Z.isWebGLCubeRenderTarget?(Ie=pe[be],rt=!0):re.isWebGL2&&Z.samples>0&&Ee.useMultisampledRTT(Z)===!1?Ie=X.get(Z).__webglMultisampledFramebuffer:Ie=pe,w.copy(Z.viewport),M.copy(Z.scissor),S=Z.scissorTest}else w.copy(L).multiplyScalar(P).floor(),M.copy(B).multiplyScalar(P).floor(),S=j;if(de.bindFramebuffer(36160,Ie)&&re.drawBuffers&&xe&&de.drawBuffers(Z,Ie),de.viewport(w),de.scissor(M),de.setScissorTest(S),rt){let ce=X.get(Z.texture);W.framebufferTexture2D(36160,36064,34069+be,ce.__webglTexture,Re)}else if(V){let ce=X.get(Z.texture),ye=be||0;W.framebufferTextureLayer(36160,36064,ce.__webglTexture,Re||0,ye)}_=-1},this.readRenderTargetPixels=function(Z,be,Re,xe,Ie,rt,V){if(!(Z&&Z.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let ce=X.get(Z).__webglFramebuffer;if(Z.isWebGLCubeRenderTarget&&V!==void 0&&(ce=ce[V]),ce){de.bindFramebuffer(36160,ce);try{let ye=Z.texture,pe=ye.format,_e=ye.type;if(pe!==Ts&&De.convert(pe)!==W.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let Ve=_e===_p&&(ie.has("EXT_color_buffer_half_float")||re.isWebGL2&&ie.has("EXT_color_buffer_float"));if(_e!==Zn&&De.convert(_e)!==W.getParameter(35738)&&!(_e===es&&(re.isWebGL2||ie.has("OES_texture_float")||ie.has("WEBGL_color_buffer_float")))&&!Ve){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}be>=0&&be<=Z.width-xe&&Re>=0&&Re<=Z.height-Ie&&W.readPixels(be,Re,xe,Ie,De.convert(pe),De.convert(_e),rt)}finally{let ye=x!==null?X.get(x).__webglFramebuffer:null;de.bindFramebuffer(36160,ye)}}},this.copyFramebufferToTexture=function(Z,be,Re=0){let xe=Math.pow(2,-Re),Ie=Math.floor(be.image.width*xe),rt=Math.floor(be.image.height*xe);Ee.setTexture2D(be,0),W.copyTexSubImage2D(3553,Re,0,0,Z.x,Z.y,Ie,rt),de.unbindTexture()},this.copyTextureToTexture=function(Z,be,Re,xe=0){let Ie=be.image.width,rt=be.image.height,V=De.convert(Re.format),ce=De.convert(Re.type);Ee.setTexture2D(Re,0),W.pixelStorei(37440,Re.flipY),W.pixelStorei(37441,Re.premultiplyAlpha),W.pixelStorei(3317,Re.unpackAlignment),be.isDataTexture?W.texSubImage2D(3553,xe,Z.x,Z.y,Ie,rt,V,ce,be.image.data):be.isCompressedTexture?W.compressedTexSubImage2D(3553,xe,Z.x,Z.y,be.mipmaps[0].width,be.mipmaps[0].height,V,be.mipmaps[0].data):W.texSubImage2D(3553,xe,Z.x,Z.y,V,ce,be.image),xe===0&&Re.generateMipmaps&&W.generateMipmap(3553),de.unbindTexture()},this.copyTextureToTexture3D=function(Z,be,Re,xe,Ie=0){if(v.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let rt=Z.max.x-Z.min.x+1,V=Z.max.y-Z.min.y+1,ce=Z.max.z-Z.min.z+1,ye=De.convert(xe.format),pe=De.convert(xe.type),_e;if(xe.isData3DTexture)Ee.setTexture3D(xe,0),_e=32879;else if(xe.isDataArrayTexture)Ee.setTexture2DArray(xe,0),_e=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}W.pixelStorei(37440,xe.flipY),W.pixelStorei(37441,xe.premultiplyAlpha),W.pixelStorei(3317,xe.unpackAlignment);let Ve=W.getParameter(3314),tt=W.getParameter(32878),st=W.getParameter(3316),lt=W.getParameter(3315),wt=W.getParameter(32877),it=Re.isCompressedTexture?Re.mipmaps[0]:Re.image;W.pixelStorei(3314,it.width),W.pixelStorei(32878,it.height),W.pixelStorei(3316,Z.min.x),W.pixelStorei(3315,Z.min.y),W.pixelStorei(32877,Z.min.z),Re.isDataTexture||Re.isData3DTexture?W.texSubImage3D(_e,Ie,be.x,be.y,be.z,rt,V,ce,ye,pe,it.data):Re.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),W.compressedTexSubImage3D(_e,Ie,be.x,be.y,be.z,rt,V,ce,ye,it.data)):W.texSubImage3D(_e,Ie,be.x,be.y,be.z,rt,V,ce,ye,pe,it),W.pixelStorei(3314,Ve),W.pixelStorei(32878,tt),W.pixelStorei(3316,st),W.pixelStorei(3315,lt),W.pixelStorei(32877,wt),Ie===0&&xe.generateMipmaps&&W.generateMipmap(_e),de.unbindTexture()},this.initTexture=function(Z){Z.isCubeTexture?Ee.setTextureCube(Z,0):Z.isData3DTexture?Ee.setTexture3D(Z,0):Z.isDataArrayTexture||Z.isCompressedArrayTexture?Ee.setTexture2DArray(Z,0):Ee.setTexture2D(Z,0),de.unbindTexture()},this.resetState=function(){g=0,y=0,x=null,de.reset(),ne.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}var ute=class extends HB{};ute.prototype.isWebGL1Renderer=!0;var GB=class{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new ut(e),this.near=t,this.far=i}clone(){return new GB(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}},gc=class extends $t{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}},dte=class{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=oS,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Rs()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let n=0,r=this.stride;n<r;n++)this.array[e+n]=t.array[i+n];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Rs()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Rs()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},Kn=new T,uS=class{constructor(e,t,i,n=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=n}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)Kn.fromBufferAttribute(this,t),Kn.applyMatrix4(e),this.setXYZ(t,Kn.x,Kn.y,Kn.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Kn.fromBufferAttribute(this,t),Kn.applyNormalMatrix(e),this.setXYZ(t,Kn.x,Kn.y,Kn.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Kn.fromBufferAttribute(this,t),Kn.transformDirection(e),this.setXYZ(t,Kn.x,Kn.y,Kn.z);return this}setX(e,t){return this.normalized&&(t=si(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=si(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=si(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=si(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Qo(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Qo(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Qo(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Qo(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=si(t,this.array),i=si(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=si(t,this.array),i=si(i,this.array),n=si(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=n,this}setXYZW(e,t,i,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=si(t,this.array),i=si(i,this.array),n=si(n,this.array),r=si(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=n,this.data.array[e+3]=r,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let i=0;i<this.count;i++){let n=i*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[n+r])}return new gt(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new uS(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let t=[];for(let i=0;i<this.count;i++){let n=i*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)t.push(this.data.array[n+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}},jB=class extends $t{constructor(){super(),this.isBone=!0,this.type="Bone"}},By=class extends ln{constructor(e=null,t=1,i=1,n,r,s,a,o,l=ai,c=ai,u,h){super(null,s,a,o,l,c,n,r,u,h),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},Y6=new ke,pte=new ke,AE=class{constructor(e=[],t=[]){this.uuid=Rs(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,n=this.bones.length;i<n;i++)this.boneInverses.push(new ke)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let i=new ke;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){let e=this.bones,t=this.boneInverses,i=this.boneMatrices,n=this.boneTexture;for(let r=0,s=e.length;r<s;r++){let a=e[r]?e[r].matrixWorld:pte;Y6.multiplyMatrices(a,t[r]),Y6.toArray(i,r*16)}n!==null&&(n.needsUpdate=!0)}clone(){return new AE(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=TB(e),e=Math.max(e,4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let i=new By(t,e,e,Ts,es);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){let n=this.bones[t];if(n.name===e)return n}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,n=e.bones.length;i<n;i++){let r=e.bones[i],s=t[r];s===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),s=new jB),this.bones.push(s),this.boneInverses.push(new ke().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){let e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,i=this.boneInverses;for(let n=0,r=t.length;n<r;n++){let s=t[n];e.bones.push(s.uuid);let a=i[n];e.boneInverses.push(a.toArray())}return e}},fte=class extends gt{constructor(e,t,i,n=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},Uc=class extends tg{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new ut(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},Z6=new T,Q6=new T,K6=new ke,eb=new Wp,n1=new ls,Ny=class extends $t{constructor(e=new mt,t=new Uc){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,i=[0];for(let n=1,r=t.count;n<r;n++)Z6.fromBufferAttribute(t,n-1),Q6.fromBufferAttribute(t,n),i[n]=i[n-1],i[n]+=Z6.distanceTo(Q6);e.setAttribute("lineDistance",new et(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let i=this.geometry,n=this.matrixWorld,r=e.params.Line.threshold,s=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),n1.copy(i.boundingSphere),n1.applyMatrix4(n),n1.radius+=r,e.ray.intersectsSphere(n1)===!1)return;K6.copy(n).invert(),eb.copy(e.ray).applyMatrix4(K6);let a=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,l=new T,c=new T,u=new T,h=new T,d=this.isLineSegments?2:1,p=i.index,f=i.attributes.position;if(p!==null){let v=Math.max(0,s.start),m=Math.min(p.count,s.start+s.count);for(let g=v,y=m-1;g<y;g+=d){let x=p.getX(g),_=p.getX(g+1);if(l.fromBufferAttribute(f,x),c.fromBufferAttribute(f,_),eb.distanceSqToSegment(l,c,h,u)>o)continue;h.applyMatrix4(this.matrixWorld);let b=e.ray.origin.distanceTo(h);b<e.near||b>e.far||t.push({distance:b,point:u.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this})}}else{let v=Math.max(0,s.start),m=Math.min(f.count,s.start+s.count);for(let g=v,y=m-1;g<y;g+=d){if(l.fromBufferAttribute(f,g),c.fromBufferAttribute(f,g+1),eb.distanceSqToSegment(l,c,h,u)>o)continue;h.applyMatrix4(this.matrixWorld);let x=e.ray.origin.distanceTo(h);x<e.near||x>e.far||t.push({distance:x,point:u.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){let i=e[t[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let n=0,r=i.length;n<r;n++){let s=i[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=n}}}}},$6=new T,J6=new T,ng=class extends Ny{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(e.index===null){let t=e.attributes.position,i=[];for(let n=0,r=t.count;n<r;n+=2)$6.fromBufferAttribute(t,n),J6.fromBufferAttribute(t,n+1),i[n]=n===0?0:i[n-1],i[n+1]=i[n]+$6.distanceTo(J6);e.setAttribute("lineDistance",new et(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},mte=class extends ln{constructor(e,t,i,n,r,s,a,o,l){super(e,t,i,n,r,s,a,o,l),this.isVideoTexture=!0,this.minFilter=s!==void 0?s:Lt,this.magFilter=r!==void 0?r:Lt,this.generateMipmaps=!1;let c=this;function u(){c.needsUpdate=!0,e.requestVideoFrameCallback(u)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(u)}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;!("requestVideoFrameCallback"in e)&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}},co=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){let t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){let t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],i,n=this.getPoint(0),r=0;t.push(0);for(let s=1;s<=e;s++)i=this.getPoint(s/e),r+=i.distanceTo(n),t.push(r),n=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let i=this.getLengths(),n=0,r=i.length,s;t?s=t:s=e*i[r-1];let a=0,o=r-1,l;for(;a<=o;)if(n=Math.floor(a+(o-a)/2),l=i[n]-s,l<0)a=n+1;else if(l>0)o=n-1;else{o=n;break}if(n=o,i[n]===s)return n/(r-1);let c=i[n],u=i[n+1]-c,h=(s-c)/u;return(n+h)/(r-1)}getTangent(e,t){let i=e-1e-4,n=e+1e-4;i<0&&(i=0),n>1&&(n=1);let r=this.getPoint(i),s=this.getPoint(n),a=t||(r.isVector2?new te:new T);return a.copy(s).sub(r).normalize(),a}getTangentAt(e,t){let i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){let i=new T,n=[],r=[],s=[],a=new T,o=new ke;for(let d=0;d<=e;d++){let p=d/e;n[d]=this.getTangentAt(p,new T)}r[0]=new T,s[0]=new T;let l=Number.MAX_VALUE,c=Math.abs(n[0].x),u=Math.abs(n[0].y),h=Math.abs(n[0].z);c<=l&&(l=c,i.set(1,0,0)),u<=l&&(l=u,i.set(0,1,0)),h<=l&&i.set(0,0,1),a.crossVectors(n[0],i).normalize(),r[0].crossVectors(n[0],a),s[0].crossVectors(n[0],r[0]);for(let d=1;d<=e;d++){if(r[d]=r[d-1].clone(),s[d]=s[d-1].clone(),a.crossVectors(n[d-1],n[d]),a.length()>Number.EPSILON){a.normalize();let p=Math.acos(an(n[d-1].dot(n[d]),-1,1));r[d].applyMatrix4(o.makeRotationAxis(a,p))}s[d].crossVectors(n[d],r[d])}if(t===!0){let d=Math.acos(an(r[0].dot(r[e]),-1,1));d/=e,n[0].dot(a.crossVectors(r[0],r[e]))>0&&(d=-d);for(let p=1;p<=e;p++)r[p].applyMatrix4(o.makeRotationAxis(n[p],d*p)),s[p].crossVectors(n[p],r[p])}return{tangents:n,normals:r,binormals:s}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},a2=class extends co{constructor(e=0,t=0,i=1,n=1,r=0,s=Math.PI*2,a=!1,o=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=n,this.aStartAngle=r,this.aEndAngle=s,this.aClockwise=a,this.aRotation=o}getPoint(e,t){let i=t||new te,n=Math.PI*2,r=this.aEndAngle-this.aStartAngle,s=Math.abs(r)<Number.EPSILON;for(;r<0;)r+=n;for(;r>n;)r-=n;r<Number.EPSILON&&(s?r=0:r=n),this.aClockwise===!0&&!s&&(r===n?r=-n:r=r-n);let a=this.aStartAngle+e*r,o=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){let c=Math.cos(this.aRotation),u=Math.sin(this.aRotation),h=o-this.aX,d=l-this.aY;o=h*c-d*u+this.aX,l=h*u+d*c+this.aY}return i.set(o,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},gte=class extends a2{constructor(e,t,i,n,r,s){super(e,t,i,i,n,r,s),this.isArcCurve=!0,this.type="ArcCurve"}};function TE(){let e=0,t=0,i=0,n=0;function r(s,a,o,l){e=s,t=o,i=-3*s+3*a-2*o-l,n=2*s-2*a+o+l}return{initCatmullRom:function(s,a,o,l,c){r(a,o,c*(o-s),c*(l-a))},initNonuniformCatmullRom:function(s,a,o,l,c,u,h){let d=(a-s)/c-(o-s)/(c+u)+(o-a)/u,p=(o-a)/u-(l-a)/(u+h)+(l-o)/h;d*=u,p*=u,r(a,o,d,p)},calc:function(s){let a=s*s,o=a*s;return e+t*s+i*a+n*o}}}var r1=new T,tb=new TE,ib=new TE,nb=new TE,vte=class extends co{constructor(e=[],t=!1,i="centripetal",n=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=n}getPoint(e,t=new T){let i=t,n=this.points,r=n.length,s=(r-(this.closed?0:1))*e,a=Math.floor(s),o=s-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/r)+1)*r:o===0&&a===r-1&&(a=r-2,o=1);let l,c;this.closed||a>0?l=n[(a-1)%r]:(r1.subVectors(n[0],n[1]).add(n[0]),l=r1);let u=n[a%r],h=n[(a+1)%r];if(this.closed||a+2<r?c=n[(a+2)%r]:(r1.subVectors(n[r-1],n[r-2]).add(n[r-1]),c=r1),this.curveType==="centripetal"||this.curveType==="chordal"){let d=this.curveType==="chordal"?.5:.25,p=Math.pow(l.distanceToSquared(u),d),f=Math.pow(u.distanceToSquared(h),d),v=Math.pow(h.distanceToSquared(c),d);f<1e-4&&(f=1),p<1e-4&&(p=f),v<1e-4&&(v=f),tb.initNonuniformCatmullRom(l.x,u.x,h.x,c.x,p,f,v),ib.initNonuniformCatmullRom(l.y,u.y,h.y,c.y,p,f,v),nb.initNonuniformCatmullRom(l.z,u.z,h.z,c.z,p,f,v)}else this.curveType==="catmullrom"&&(tb.initCatmullRom(l.x,u.x,h.x,c.x,this.tension),ib.initCatmullRom(l.y,u.y,h.y,c.y,this.tension),nb.initCatmullRom(l.z,u.z,h.z,c.z,this.tension));return i.set(tb.calc(o),ib.calc(o),nb.calc(o)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){let n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let n=e.points[t];this.points.push(new T().fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};function e8(e,t,i,n,r){let s=(n-t)*.5,a=(r-i)*.5,o=e*e,l=e*o;return(2*i-2*n+s+a)*l+(-3*i+3*n-2*s-a)*o+s*e+i}function yte(e,t){let i=1-e;return i*i*t}function xte(e,t){return 2*(1-e)*e*t}function _te(e,t){return e*e*t}function Um(e,t,i,n){return yte(e,t)+xte(e,i)+_te(e,n)}function bte(e,t){let i=1-e;return i*i*i*t}function wte(e,t){let i=1-e;return 3*i*i*e*t}function Ste(e,t){return 3*(1-e)*e*e*t}function Mte(e,t){return e*e*e*t}function Fm(e,t,i,n,r){return bte(e,t)+wte(e,i)+Ste(e,n)+Mte(e,r)}var oa=class extends co{constructor(t=new te,i=new te,n=new te,r=new te){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=t,this.v1=i,this.v2=n,this.v3=r}getPoint(t,i=new te){let n=i,r=this.v0,s=this.v1,a=this.v2,o=this.v3;return n.set(Fm(t,r.x,s.x,a.x,o.x),Fm(t,r.y,s.y,a.y,o.y)),n}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){let t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}},kv=class extends co{constructor(e=new T,t=new T,i=new T,n=new T){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=n}getPoint(e,t=new T){let i=t,n=this.v0,r=this.v1,s=this.v2,a=this.v3;return i.set(Fm(e,n.x,r.x,s.x,a.x),Fm(e,n.y,r.y,s.y,a.y),Fm(e,n.z,r.z,s.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},ma=class extends co{constructor(t=new te,i=new te){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=t,this.v2=i}getPoint(t,i=new te){let n=i;return t===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n}getPointAt(t,i){return this.getPoint(t,i)}getTangent(t,i){let n=i||new te;return n.copy(this.v2).sub(this.v1).normalize(),n}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){let t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}},WB=class extends co{constructor(e=new T,t=new T){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new T){let i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},Pc=class extends co{constructor(e=new te,t=new te,i=new te){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new te){let i=t,n=this.v0,r=this.v1,s=this.v2;return i.set(Um(e,n.x,r.x,s.x),Um(e,n.y,r.y,s.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},Cte=class extends co{constructor(e=new T,t=new T,i=new T){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new T){let i=t,n=this.v0,r=this.v1,s=this.v2;return i.set(Um(e,n.x,r.x,s.x),Um(e,n.y,r.y,s.y),Um(e,n.z,r.z,s.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},PE=class extends co{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new te){let i=t,n=this.points,r=(n.length-1)*e,s=Math.floor(r),a=r-s,o=n[s===0?s:s-1],l=n[s],c=n[s>n.length-2?n.length-1:s+1],u=n[s>n.length-3?n.length-1:s+2];return i.set(e8(a,o.x,l.x,c.x,u.x),e8(a,o.y,l.y,c.y,u.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let n=e.points[t];this.points.push(n.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){let n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let n=e.points[t];this.points.push(new te().fromArray(n))}return this}},Ete=Object.freeze({__proto__:null,ArcCurve:gte,CatmullRomCurve3:vte,CubicBezierCurve:oa,CubicBezierCurve3:kv,EllipseCurve:a2,LineCurve:ma,LineCurve3:WB,QuadraticBezierCurve:Pc,QuadraticBezierCurve3:Cte,SplineCurve:PE}),XB=class extends co{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new ma(t,e))}getPoint(e,t){let i=e*this.getLength(),n=this.getCurveLengths(),r=0;for(;r<n.length;){if(n[r]>=i){let s=n[r]-i,a=this.curves[r],o=a.getLength(),l=o===0?0:1-s/o;return a.getPointAt(l,t)}r++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let i=0,n=this.curves.length;i<n;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t=[],i;for(let n=0,r=this.curves;n<r.length;n++){let s=r[n],a=s.isEllipseCurve?e*2:s.isLineCurve||s.isLineCurve3?1:s.isSplineCurve?e*s.points.length:e,o=s.getPoints(a);for(let l=0;l<o.length;l++){let c=o[l];i&&i.equals(c)||(t.push(c),i=c)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){let n=e.curves[t];this.curves.push(n.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++){let n=this.curves[t];e.curves.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){let n=e.curves[t];this.curves.push(new Ete[n.type]().fromJSON(n))}return this}},Uy=class extends XB{constructor(e){super(),this.type="Path",this.currentPoint=new te,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let i=new ma(this.currentPoint.clone(),new te(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,n){let r=new Pc(this.currentPoint.clone(),new te(e,t),new te(i,n));return this.curves.push(r),this.currentPoint.set(i,n),this}bezierCurveTo(e,t,i,n,r,s){let a=new oa(this.currentPoint.clone(),new te(e,t),new te(i,n),new te(r,s));return this.curves.push(a),this.currentPoint.set(r,s),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),i=new PE(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,n,r,s){let a=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(e+a,t+o,i,n,r,s),this}absarc(e,t,i,n,r,s){return this.absellipse(e,t,i,i,n,r,s),this}ellipse(e,t,i,n,r,s,a,o){let l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,i,n,r,s,a,o),this}absellipse(e,t,i,n,r,s,a,o){let l=new a2(e,t,i,n,r,s,a,o);if(this.curves.length>0){let u=l.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(l);let c=l.getPoint(1);return this.currentPoint.copy(c),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}},qB=class extends mt{constructor(e=[new te(0,-.5),new te(.5,0),new te(0,.5)],t=12,i=0,n=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:n},t=Math.floor(t),n=an(n,0,Math.PI*2);let r=[],s=[],a=[],o=[],l=[],c=1/t,u=new T,h=new te,d=new T,p=new T,f=new T,v=0,m=0;for(let g=0;g<=e.length-1;g++)switch(g){case 0:v=e[g+1].x-e[g].x,m=e[g+1].y-e[g].y,d.x=m*1,d.y=-v,d.z=m*0,f.copy(d),d.normalize(),o.push(d.x,d.y,d.z);break;case e.length-1:o.push(f.x,f.y,f.z);break;default:v=e[g+1].x-e[g].x,m=e[g+1].y-e[g].y,d.x=m*1,d.y=-v,d.z=m*0,p.copy(d),d.x+=f.x,d.y+=f.y,d.z+=f.z,d.normalize(),o.push(d.x,d.y,d.z),f.copy(p)}for(let g=0;g<=t;g++){let y=i+g*c*n,x=Math.sin(y),_=Math.cos(y);for(let b=0;b<=e.length-1;b++){u.x=e[b].x*x,u.y=e[b].y,u.z=e[b].x*_,s.push(u.x,u.y,u.z),h.x=g/t,h.y=b/(e.length-1),a.push(h.x,h.y);let w=o[3*b+0]*x,M=o[3*b+1],S=o[3*b+0]*_;l.push(w,M,S)}}for(let g=0;g<t;g++)for(let y=0;y<e.length-1;y++){let x=y+g*e.length,_=x,b=x+e.length,w=x+e.length+1,M=x+1;r.push(_,b,M),r.push(w,M,b)}this.setIndex(r),this.setAttribute("position",new et(s,3)),this.setAttribute("uv",new et(a,2)),this.setAttribute("normal",new et(l,3))}static fromJSON(e){return new qB(e.points,e.segments,e.phiStart,e.phiLength)}},DE=class extends mt{constructor(e=1,t=1,i=1,n=32,r=1,s=!1,a=0,o=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:a,thetaLength:o};let l=this;n=Math.floor(n),r=Math.floor(r);let c=[],u=[],h=[],d=[],p=0,f=[],v=i/2,m=0;g(),s===!1&&(e>0&&y(!0),t>0&&y(!1)),this.setIndex(c),this.setAttribute("position",new et(u,3)),this.setAttribute("normal",new et(h,3)),this.setAttribute("uv",new et(d,2));function g(){let x=new T,_=new T,b=0,w=(t-e)/i;for(let M=0;M<=r;M++){let S=[],C=M/r,E=C*(t-e)+e;for(let P=0;P<=n;P++){let I=P/n,D=I*o+a,L=Math.sin(D),B=Math.cos(D);_.x=E*L,_.y=-C*i+v,_.z=E*B,u.push(_.x,_.y,_.z),x.set(L,w,B).normalize(),h.push(x.x,x.y,x.z),d.push(I,1-C),S.push(p++)}f.push(S)}for(let M=0;M<n;M++)for(let S=0;S<r;S++){let C=f[S][M],E=f[S+1][M],P=f[S+1][M+1],I=f[S][M+1];c.push(C,E,I),c.push(E,P,I),b+=6}l.addGroup(m,b,0),m+=b}function y(x){let _=p,b=new te,w=new T,M=0,S=x===!0?e:t,C=x===!0?1:-1;for(let P=1;P<=n;P++)u.push(0,v*C,0),h.push(0,C,0),d.push(.5,.5),p++;let E=p;for(let P=0;P<=n;P++){let I=P/n*o+a,D=Math.cos(I),L=Math.sin(I);w.x=S*L,w.y=v*C,w.z=S*D,u.push(w.x,w.y,w.z),h.push(0,C,0),b.x=D*.5+.5,b.y=L*.5*C+.5,d.push(b.x,b.y),p++}for(let P=0;P<n;P++){let I=_+P,D=E+P;x===!0?c.push(D,D+1,I):c.push(D+1,D,I),M+=3}l.addGroup(m,M,x===!0?1:2),m+=M}}static fromJSON(e){return new DE(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},YB=class extends DE{constructor(e=1,t=1,i=32,n=1,r=!1,s=0,a=Math.PI*2){super(0,e,t,i,n,r,s,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:s,thetaLength:a}}static fromJSON(e){return new YB(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}},LE=class extends mt{constructor(e=[],t=[],i=1,n=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:n};let r=[],s=[];a(n),l(i),c(),this.setAttribute("position",new et(r,3)),this.setAttribute("normal",new et(r.slice(),3)),this.setAttribute("uv",new et(s,2)),n===0?this.computeVertexNormals():this.normalizeNormals();function a(g){let y=new T,x=new T,_=new T;for(let b=0;b<t.length;b+=3)d(t[b+0],y),d(t[b+1],x),d(t[b+2],_),o(y,x,_,g)}function o(g,y,x,_){let b=_+1,w=[];for(let M=0;M<=b;M++){w[M]=[];let S=g.clone().lerp(x,M/b),C=y.clone().lerp(x,M/b),E=b-M;for(let P=0;P<=E;P++)P===0&&M===b?w[M][P]=S:w[M][P]=S.clone().lerp(C,P/E)}for(let M=0;M<b;M++)for(let S=0;S<2*(b-M)-1;S++){let C=Math.floor(S/2);S%2===0?(h(w[M][C+1]),h(w[M+1][C]),h(w[M][C])):(h(w[M][C+1]),h(w[M+1][C+1]),h(w[M+1][C]))}}function l(g){let y=new T;for(let x=0;x<r.length;x+=3)y.x=r[x+0],y.y=r[x+1],y.z=r[x+2],y.normalize().multiplyScalar(g),r[x+0]=y.x,r[x+1]=y.y,r[x+2]=y.z}function c(){let g=new T;for(let y=0;y<r.length;y+=3){g.x=r[y+0],g.y=r[y+1],g.z=r[y+2];let x=v(g)/2/Math.PI+.5,_=m(g)/Math.PI+.5;s.push(x,1-_)}p(),u()}function u(){for(let g=0;g<s.length;g+=6){let y=s[g+0],x=s[g+2],_=s[g+4],b=Math.max(y,x,_),w=Math.min(y,x,_);b>.9&&w<.1&&(y<.2&&(s[g+0]+=1),x<.2&&(s[g+2]+=1),_<.2&&(s[g+4]+=1))}}function h(g){r.push(g.x,g.y,g.z)}function d(g,y){let x=g*3;y.x=e[x+0],y.y=e[x+1],y.z=e[x+2]}function p(){let g=new T,y=new T,x=new T,_=new T,b=new te,w=new te,M=new te;for(let S=0,C=0;S<r.length;S+=9,C+=6){g.set(r[S+0],r[S+1],r[S+2]),y.set(r[S+3],r[S+4],r[S+5]),x.set(r[S+6],r[S+7],r[S+8]),b.set(s[C+0],s[C+1]),w.set(s[C+2],s[C+3]),M.set(s[C+4],s[C+5]),_.copy(g).add(y).add(x).divideScalar(3);let E=v(_);f(b,C+0,g,E),f(w,C+2,y,E),f(M,C+4,x,E)}}function f(g,y,x,_){_<0&&g.x===1&&(s[y]=g.x-1),x.x===0&&x.z===0&&(s[y]=_/2/Math.PI+.5)}function v(g){return Math.atan2(g.z,-g.x)}function m(g){return Math.atan2(-g.y,Math.sqrt(g.x*g.x+g.z*g.z))}}static fromJSON(e){return new LE(e.vertices,e.indices,e.radius,e.details)}},ZB=class extends LE{constructor(e=1,t=0){let i=(1+Math.sqrt(5))/2,n=1/i,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n],s=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(r,s,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new ZB(e.radius,e.detail)}},Fy=class extends Uy{constructor(e){super(e),this.uuid=Rs(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let i=0,n=this.holes.length;i<n;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){let n=e.holes[t];this.holes.push(n.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++){let n=this.holes[t];e.holes.push(n.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){let n=e.holes[t];this.holes.push(new Uy().fromJSON(n))}return this}},Ate={triangulate:function(e,t,i=2){let n=t&&t.length,r=n?t[0]*i:e.length,s=QB(e,0,r,i,!0),a=[];if(!s||s.next===s.prev)return a;let o,l,c,u,h,d,p;if(n&&(s=Rte(e,t,s,i)),e.length>80*i){o=c=e[0],l=u=e[1];for(let f=i;f<r;f+=i)h=e[f],d=e[f+1],h<o&&(o=h),d<l&&(l=d),h>c&&(c=h),d>u&&(u=d);p=Math.max(c-o,u-l),p=p!==0?32767/p:0}return b0(s,a,i,o,l,p,0),a}};function QB(e,t,i,n,r){let s,a;if(r===Gte(e,t,i,n)>0)for(s=t;s<i;s+=n)a=t8(s,e[s],e[s+1],a);else for(s=i-n;s>=t;s-=n)a=t8(s,e[s],e[s+1],a);return a&&o2(a,a.next)&&(S0(a),a=a.next),a}function Xh(e,t){if(!e)return e;t||(t=e);let i=e,n;do if(n=!1,!i.steiner&&(o2(i,i.next)||wi(i.prev,i,i.next)===0)){if(S0(i),i=t=i.prev,i===i.next)break;n=!0}else i=i.next;while(n||i!==t);return t}function b0(e,t,i,n,r,s,a){if(!e)return;!a&&s&&Ute(e,n,r,s);let o=e,l,c;for(;e.prev!==e.next;){if(l=e.prev,c=e.next,s?Pte(e,n,r,s):Tte(e)){t.push(l.i/i|0),t.push(e.i/i|0),t.push(c.i/i|0),S0(e),e=c.next,o=c.next;continue}if(e=c,e===o){a?a===1?(e=Dte(Xh(e),t,i),b0(e,t,i,n,r,s,2)):a===2&&Lte(e,t,i,n,r,s):b0(Xh(e),t,i,n,r,s,1);break}}}function Tte(e){let t=e.prev,i=e,n=e.next;if(wi(t,i,n)>=0)return!1;let r=t.x,s=i.x,a=n.x,o=t.y,l=i.y,c=n.y,u=r<s?r<a?r:a:s<a?s:a,h=o<l?o<c?o:c:l<c?l:c,d=r>s?r>a?r:a:s>a?s:a,p=o>l?o>c?o:c:l>c?l:c,f=n.next;for(;f!==t;){if(f.x>=u&&f.x<=d&&f.y>=h&&f.y<=p&&Od(r,o,s,l,a,c,f.x,f.y)&&wi(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Pte(e,t,i,n){let r=e.prev,s=e,a=e.next;if(wi(r,s,a)>=0)return!1;let o=r.x,l=s.x,c=a.x,u=r.y,h=s.y,d=a.y,p=o<l?o<c?o:c:l<c?l:c,f=u<h?u<d?u:d:h<d?h:d,v=o>l?o>c?o:c:l>c?l:c,m=u>h?u>d?u:d:h>d?h:d,g=dS(p,f,t,i,n),y=dS(v,m,t,i,n),x=e.prevZ,_=e.nextZ;for(;x&&x.z>=g&&_&&_.z<=y;){if(x.x>=p&&x.x<=v&&x.y>=f&&x.y<=m&&x!==r&&x!==a&&Od(o,u,l,h,c,d,x.x,x.y)&&wi(x.prev,x,x.next)>=0||(x=x.prevZ,_.x>=p&&_.x<=v&&_.y>=f&&_.y<=m&&_!==r&&_!==a&&Od(o,u,l,h,c,d,_.x,_.y)&&wi(_.prev,_,_.next)>=0))return!1;_=_.nextZ}for(;x&&x.z>=g;){if(x.x>=p&&x.x<=v&&x.y>=f&&x.y<=m&&x!==r&&x!==a&&Od(o,u,l,h,c,d,x.x,x.y)&&wi(x.prev,x,x.next)>=0)return!1;x=x.prevZ}for(;_&&_.z<=y;){if(_.x>=p&&_.x<=v&&_.y>=f&&_.y<=m&&_!==r&&_!==a&&Od(o,u,l,h,c,d,_.x,_.y)&&wi(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function Dte(e,t,i){let n=e;do{let r=n.prev,s=n.next.next;!o2(r,s)&&KB(r,n,n.next,s)&&w0(r,s)&&w0(s,r)&&(t.push(r.i/i|0),t.push(n.i/i|0),t.push(s.i/i|0),S0(n),S0(n.next),n=e=s),n=n.next}while(n!==e);return Xh(n)}function Lte(e,t,i,n,r,s){let a=e;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&kte(a,o)){let l=$B(a,o);a=Xh(a,a.next),l=Xh(l,l.next),b0(a,t,i,n,r,s,0),b0(l,t,i,n,r,s,0);return}o=o.next}a=a.next}while(a!==e)}function Rte(e,t,i,n){let r=[],s,a,o,l,c;for(s=0,a=t.length;s<a;s++)o=t[s]*n,l=s<a-1?t[s+1]*n:e.length,c=QB(e,o,l,n,!1),c===c.next&&(c.steiner=!0),r.push(zte(c));for(r.sort(Ite),s=0;s<r.length;s++)i=Ote(r[s],i);return i}function Ite(e,t){return e.x-t.x}function Ote(e,t){let i=Bte(e,t);if(!i)return t;let n=$B(i,e);return Xh(n,n.next),Xh(i,i.next)}function Bte(e,t){let i=t,n=-1/0,r,s=e.x,a=e.y;do{if(a<=i.y&&a>=i.next.y&&i.next.y!==i.y){let d=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(d<=s&&d>n&&(n=d,r=i.x<i.next.x?i:i.next,d===s))return r}i=i.next}while(i!==t);if(!r)return null;let o=r,l=r.x,c=r.y,u=1/0,h;i=r;do s>=i.x&&i.x>=l&&s!==i.x&&Od(a<c?s:n,a,l,c,a<c?n:s,a,i.x,i.y)&&(h=Math.abs(a-i.y)/(s-i.x),w0(i,e)&&(h<u||h===u&&(i.x>r.x||i.x===r.x&&Nte(r,i)))&&(r=i,u=h)),i=i.next;while(i!==o);return r}function Nte(e,t){return wi(e.prev,e,t.prev)<0&&wi(t.next,e,e.next)<0}function Ute(e,t,i,n){let r=e;do r.z===0&&(r.z=dS(r.x,r.y,t,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,Fte(r)}function Fte(e){let t,i,n,r,s,a,o,l,c=1;do{for(i=e,e=null,s=null,a=0;i;){for(a++,n=i,o=0,t=0;t<c&&(o++,n=n.nextZ,!!n);t++);for(l=c;o>0||l>0&&n;)o!==0&&(l===0||!n||i.z<=n.z)?(r=i,i=i.nextZ,o--):(r=n,n=n.nextZ,l--),s?s.nextZ=r:e=r,r.prevZ=s,s=r;i=n}s.nextZ=null,c*=2}while(a>1);return e}function dS(e,t,i,n,r){return e=(e-i)*r|0,t=(t-n)*r|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function zte(e){let t=e,i=e;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==e);return i}function Od(e,t,i,n,r,s,a,o){return(r-a)*(t-o)>=(e-a)*(s-o)&&(e-a)*(n-o)>=(i-a)*(t-o)&&(i-a)*(s-o)>=(r-a)*(n-o)}function kte(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!Vte(e,t)&&(w0(e,t)&&w0(t,e)&&Hte(e,t)&&(wi(e.prev,e,t.prev)||wi(e,t.prev,t))||o2(e,t)&&wi(e.prev,e,e.next)>0&&wi(t.prev,t,t.next)>0)}function wi(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function o2(e,t){return e.x===t.x&&e.y===t.y}function KB(e,t,i,n){let r=a1(wi(e,t,i)),s=a1(wi(e,t,n)),a=a1(wi(i,n,e)),o=a1(wi(i,n,t));return!!(r!==s&&a!==o||r===0&&s1(e,i,t)||s===0&&s1(e,n,t)||a===0&&s1(i,e,n)||o===0&&s1(i,t,n))}function s1(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function a1(e){return e>0?1:e<0?-1:0}function Vte(e,t){let i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&KB(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}function w0(e,t){return wi(e.prev,e,e.next)<0?wi(e,t,e.next)>=0&&wi(e,e.prev,t)>=0:wi(e,t,e.prev)<0||wi(e,e.next,t)<0}function Hte(e,t){let i=e,n=!1,r=(e.x+t.x)/2,s=(e.y+t.y)/2;do i.y>s!=i.next.y>s&&i.next.y!==i.y&&r<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next;while(i!==e);return n}function $B(e,t){let i=new pS(e.i,e.x,e.y),n=new pS(t.i,t.x,t.y),r=e.next,s=t.prev;return e.next=t,t.prev=e,i.next=r,r.prev=i,n.next=i,i.prev=n,s.next=n,n.prev=s,n}function t8(e,t,i,n){let r=new pS(e,t,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function S0(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function pS(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Gte(e,t,i,n){let r=0;for(let s=t,a=i-n;s<i;s+=n)r+=(e[a]-e[s])*(e[s+1]+e[a+1]),a=s;return r}var JB=class{static area(e){let t=e.length,i=0;for(let n=t-1,r=0;r<t;n=r++)i+=e[n].x*e[r].y-e[r].x*e[n].y;return i*.5}static isClockWise(e){return JB.area(e)<0}static triangulateShape(e,t){let i=[],n=[],r=[];i8(e),n8(i,e);let s=e.length;t.forEach(i8);for(let o=0;o<t.length;o++)n.push(s),s+=t[o].length,n8(i,t[o]);let a=Ate.triangulate(i,n);for(let o=0;o<a.length;o+=3)r.push(a.slice(o,o+3));return r}};function i8(e){let t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function n8(e,t){for(let i=0;i<t.length;i++)e.push(t[i].x),e.push(t[i].y)}var eN=class extends LE{constructor(e=1,t=0){let i=(1+Math.sqrt(5))/2,n=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(n,r,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new eN(e.radius,e.detail)}},RE=class extends mt{constructor(e=1,t=32,i=16,n=0,r=Math.PI*2,s=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:n,phiLength:r,thetaStart:s,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));let o=Math.min(s+a,Math.PI),l=0,c=[],u=new T,h=new T,d=[],p=[],f=[],v=[];for(let m=0;m<=i;m++){let g=[],y=m/i,x=0;m==0&&s==0?x=.5/t:m==i&&o==Math.PI&&(x=-.5/t);for(let _=0;_<=t;_++){let b=_/t;u.x=-e*Math.cos(n+b*r)*Math.sin(s+y*a),u.y=e*Math.cos(s+y*a),u.z=e*Math.sin(n+b*r)*Math.sin(s+y*a),p.push(u.x,u.y,u.z),h.copy(u).normalize(),f.push(h.x,h.y,h.z),v.push(b+x,1-y),g.push(l++)}c.push(g)}for(let m=0;m<i;m++)for(let g=0;g<t;g++){let y=c[m][g+1],x=c[m][g],_=c[m+1][g],b=c[m+1][g+1];(m!==0||s>0)&&d.push(y,x,b),(m!==i-1||o<Math.PI)&&d.push(x,_,b)}this.setIndex(d),this.setAttribute("position",new et(p,3)),this.setAttribute("normal",new et(f,3)),this.setAttribute("uv",new et(v,2))}static fromJSON(e){return new RE(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}},tN=class extends mt{constructor(e=1,t=.4,i=64,n=8,r=2,s=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:n,p:r,q:s},i=Math.floor(i),n=Math.floor(n);let a=[],o=[],l=[],c=[],u=new T,h=new T,d=new T,p=new T,f=new T,v=new T,m=new T;for(let y=0;y<=i;++y){let x=y/i*r*Math.PI*2;g(x,r,s,e,d),g(x+.01,r,s,e,p),v.subVectors(p,d),m.addVectors(p,d),f.crossVectors(v,m),m.crossVectors(f,v),f.normalize(),m.normalize();for(let _=0;_<=n;++_){let b=_/n*Math.PI*2,w=-t*Math.cos(b),M=t*Math.sin(b);u.x=d.x+(w*m.x+M*f.x),u.y=d.y+(w*m.y+M*f.y),u.z=d.z+(w*m.z+M*f.z),o.push(u.x,u.y,u.z),h.subVectors(u,d).normalize(),l.push(h.x,h.y,h.z),c.push(y/i),c.push(_/n)}}for(let y=1;y<=i;y++)for(let x=1;x<=n;x++){let _=(n+1)*(y-1)+(x-1),b=(n+1)*y+(x-1),w=(n+1)*y+x,M=(n+1)*(y-1)+x;a.push(_,b,M),a.push(b,w,M)}this.setIndex(a),this.setAttribute("position",new et(o,3)),this.setAttribute("normal",new et(l,3)),this.setAttribute("uv",new et(c,2));function g(y,x,_,b,w){let M=Math.cos(y),S=Math.sin(y),C=_/x*y,E=Math.cos(C);w.x=b*(2+E)*.5*M,w.y=b*(2+E)*S*.5,w.z=b*Math.sin(C)*.5}}static fromJSON(e){return new tN(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}};function bl(e,t,i){return iN(e)?new e.constructor(e.subarray(t,i!==void 0?i:e.length)):e.slice(t,i)}function o1(e,t,i){return!e||!i&&e.constructor===t?e:typeof t.BYTES_PER_ELEMENT=="number"?new t(e):Array.prototype.slice.call(e)}function iN(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function jte(e){function t(r,s){return e[r]-e[s]}let i=e.length,n=new Array(i);for(let r=0;r!==i;++r)n[r]=r;return n.sort(t),n}function r8(e,t,i){let n=e.length,r=new e.constructor(n);for(let s=0,a=0;a!==n;++s){let o=i[s]*t;for(let l=0;l!==t;++l)r[a++]=e[o+l]}return r}function nN(e,t,i,n){let r=1,s=e[0];for(;s!==void 0&&s[n]===void 0;)s=e[r++];if(s===void 0)return;let a=s[n];if(a!==void 0)if(Array.isArray(a))do a=s[n],a!==void 0&&(t.push(s.time),i.push.apply(i,a)),s=e[r++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[n],a!==void 0&&(t.push(s.time),a.toArray(i,i.length)),s=e[r++];while(s!==void 0);else do a=s[n],a!==void 0&&(t.push(s.time),i.push(a)),s=e[r++];while(s!==void 0)}var l2=class{constructor(e,t,i,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=n!==void 0?n:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,i=this._cachedIndex,n=t[i],r=t[i-1];e:{t:{let s;i:{n:if(!(e<n)){for(let a=i+2;;){if(n===void 0){if(e<r)break n;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(r=n,n=t[++i],e<n)break t}s=t.length;break i}if(!(e>=r)){let a=t[1];e<a&&(i=2,r=a);for(let o=i-2;;){if(r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===o)break;if(n=r,r=t[--i-1],e>=r)break t}s=i,i=0;break i}break e}for(;i<s;){let a=i+s>>>1;e<t[a]?s=a:i=a+1}if(n=t[i],r=t[i-1],r===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,r,n)}return this.interpolate_(i,r,e,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=e*n;for(let s=0;s!==n;++s)t[s]=i[r+s];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},Wte=class extends l2{constructor(e,t,i,n){super(e,t,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Dd,endingEnd:Dd}}intervalChanged_(e,t,i){let n=this.parameterPositions,r=e-2,s=e+1,a=n[r],o=n[s];if(a===void 0)switch(this.getSettings_().endingStart){case Ld:r=e,a=2*t-i;break;case Ly:r=n.length-2,a=t+n[r]-n[r+1];break;default:r=e,a=i}if(o===void 0)switch(this.getSettings_().endingEnd){case Ld:s=e,o=2*i-t;break;case Ly:s=1,o=i+n[1]-n[0];break;default:s=e-1,o=t}let l=(i-t)*.5,c=this.valueSize;this._weightPrev=l/(t-a),this._weightNext=l/(o-i),this._offsetPrev=r*c,this._offsetNext=s*c}interpolate_(e,t,i,n){let r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,d=this._weightNext,p=(i-t)/(n-t),f=p*p,v=f*p,m=-h*v+2*h*f-h*p,g=(1+h)*v+(-1.5-2*h)*f+(-.5+h)*p+1,y=(-1-d)*v+(1.5+d)*f+.5*p,x=d*v-d*f;for(let _=0;_!==a;++_)r[_]=m*s[c+_]+g*s[l+_]+y*s[o+_]+x*s[u+_];return r}},rN=class extends l2{constructor(e,t,i,n){super(e,t,i,n)}interpolate_(e,t,i,n){let r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=e*a,l=o-a,c=(i-t)/(n-t),u=1-c;for(let h=0;h!==a;++h)r[h]=s[l+h]*u+s[o+h]*c;return r}},Xte=class extends l2{constructor(e,t,i,n){super(e,t,i,n)}interpolate_(e){return this.copySampleValue_(e-1)}},ho=class{constructor(e,t,i,n){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=o1(t,this.TimeBufferType),this.values=o1(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(e){let t=e.constructor,i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:o1(e.times,Array),values:o1(e.values,Array)};let n=e.getInterpolation();n!==e.DefaultInterpolation&&(i.interpolation=n)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new Xte(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new rN(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Wte(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Py:t=this.InterpolantFactoryMethodDiscrete;break;case Dy:t=this.InterpolantFactoryMethodLinear;break;case T_:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){let i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Py;case this.InterpolantFactoryMethodLinear:return Dy;case this.InterpolantFactoryMethodSmooth:return T_}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){let t=this.times;for(let i=0,n=t.length;i!==n;++i)t[i]+=e}return this}scale(e){if(e!==1){let t=this.times;for(let i=0,n=t.length;i!==n;++i)t[i]*=e}return this}trim(e,t){let i=this.times,n=i.length,r=0,s=n-1;for(;r!==n&&i[r]<e;)++r;for(;s!==-1&&i[s]>t;)--s;if(++s,r!==0||s!==n){r>=s&&(s=Math.max(s,1),r=s-1);let a=this.getValueSize();this.times=bl(i,r,s),this.values=bl(this.values,r*a,s*a)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let i=this.times,n=this.values,r=i.length;r===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let s=null;for(let a=0;a!==r;a++){let o=i[a];if(typeof o=="number"&&isNaN(o)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,o),e=!1;break}if(s!==null&&s>o){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,o,s),e=!1;break}s=o}if(n!==void 0&&iN(n))for(let a=0,o=n.length;a!==o;++a){let l=n[a];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,l),e=!1;break}}return e}optimize(){let e=bl(this.times),t=bl(this.values),i=this.getValueSize(),n=this.getInterpolation()===T_,r=e.length-1,s=1;for(let a=1;a<r;++a){let o=!1,l=e[a],c=e[a+1];if(l!==c&&(a!==1||l!==e[0]))if(n)o=!0;else{let u=a*i,h=u-i,d=u+i;for(let p=0;p!==i;++p){let f=t[u+p];if(f!==t[h+p]||f!==t[d+p]){o=!0;break}}}if(o){if(a!==s){e[s]=e[a];let u=a*i,h=s*i;for(let d=0;d!==i;++d)t[h+d]=t[u+d]}++s}}if(r>0){e[s]=e[r];for(let a=r*i,o=s*i,l=0;l!==i;++l)t[o+l]=t[a+l];++s}return s!==e.length?(this.times=bl(e,0,s),this.values=bl(t,0,s*i)):(this.times=e,this.values=t),this}clone(){let e=bl(this.times,0),t=bl(this.values,0),i=this.constructor,n=new i(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}};ho.prototype.TimeBufferType=Float32Array;ho.prototype.ValueBufferType=Float32Array;ho.prototype.DefaultInterpolation=Dy;var Zp=class extends ho{};Zp.prototype.ValueTypeName="bool";Zp.prototype.ValueBufferType=Array;Zp.prototype.DefaultInterpolation=Py;Zp.prototype.InterpolantFactoryMethodLinear=void 0;Zp.prototype.InterpolantFactoryMethodSmooth=void 0;var sN=class extends ho{};sN.prototype.ValueTypeName="color";var zy=class extends ho{};zy.prototype.ValueTypeName="number";var qte=class extends l2{constructor(e,t,i,n){super(e,t,i,n)}interpolate_(e,t,i,n){let r=this.resultBuffer,s=this.sampleValues,a=this.valueSize,o=(i-t)/(n-t),l=e*a;for(let c=l+a;l!==c;l+=4)At.slerpFlat(r,0,s,l-a,s,l,o);return r}},rg=class extends ho{InterpolantFactoryMethodLinear(e){return new qte(this.times,this.values,this.getValueSize(),e)}};rg.prototype.ValueTypeName="quaternion";rg.prototype.DefaultInterpolation=Dy;rg.prototype.InterpolantFactoryMethodSmooth=void 0;var Qp=class extends ho{};Qp.prototype.ValueTypeName="string";Qp.prototype.ValueBufferType=Array;Qp.prototype.DefaultInterpolation=Py;Qp.prototype.InterpolantFactoryMethodLinear=void 0;Qp.prototype.InterpolantFactoryMethodSmooth=void 0;var ky=class extends ho{};ky.prototype.ValueTypeName="vector";var fS=class{constructor(e,t=-1,i,n=_E){this.name=e,this.tracks=i,this.duration=t,this.blendMode=n,this.uuid=Rs(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],i=e.tracks,n=1/(e.fps||1);for(let s=0,a=i.length;s!==a;++s)t.push(Zte(i[s]).scale(n));let r=new this(e.name,e.duration,t,e.blendMode);return r.uuid=e.uuid,r}static toJSON(e){let t=[],i=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let r=0,s=i.length;r!==s;++r)t.push(ho.toJSON(i[r]));return n}static CreateFromMorphTargetSequence(e,t,i,n){let r=t.length,s=[];for(let a=0;a<r;a++){let o=[],l=[];o.push((a+r-1)%r,a,(a+1)%r),l.push(0,1,0);let c=jte(o);o=r8(o,1,c),l=r8(l,1,c),!n&&o[0]===0&&(o.push(r),l.push(l[0])),s.push(new zy(".morphTargetInfluences["+t[a].name+"]",o,l).scale(1/i))}return new this(e,-1,s)}static findByName(e,t){let i=e;if(!Array.isArray(e)){let n=e;i=n.geometry&&n.geometry.animations||n.animations}for(let n=0;n<i.length;n++)if(i[n].name===t)return i[n];return null}static CreateClipsFromMorphTargetSequences(e,t,i){let n={},r=/^([\w-]*?)([\d]+)$/;for(let a=0,o=e.length;a<o;a++){let l=e[a],c=l.name.match(r);if(c&&c.length>1){let u=c[1],h=n[u];h||(n[u]=h=[]),h.push(l)}}let s=[];for(let a in n)s.push(this.CreateFromMorphTargetSequence(a,n[a],t,i));return s}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let i=function(c,u,h,d,p){if(h.length!==0){let f=[],v=[];nN(h,f,v,d),f.length!==0&&p.push(new c(u,f,v))}},n=[],r=e.name||"default",s=e.fps||30,a=e.blendMode,o=e.length||-1,l=e.hierarchy||[];for(let c=0;c<l.length;c++){let u=l[c].keys;if(!(!u||u.length===0))if(u[0].morphTargets){let h={},d;for(d=0;d<u.length;d++)if(u[d].morphTargets)for(let p=0;p<u[d].morphTargets.length;p++)h[u[d].morphTargets[p]]=-1;for(let p in h){let f=[],v=[];for(let m=0;m!==u[d].morphTargets.length;++m){let g=u[d];f.push(g.time),v.push(g.morphTarget===p?1:0)}n.push(new zy(".morphTargetInfluence["+p+"]",f,v))}o=h.length*s}else{let h=".bones["+t[c].name+"]";i(ky,h+".position",u,"pos",n),i(rg,h+".quaternion",u,"rot",n),i(ky,h+".scale",u,"scl",n)}}return n.length===0?null:new this(r,o,n,a)}resetDuration(){let e=this.tracks,t=0;for(let i=0,n=e.length;i!==n;++i){let r=this.tracks[i];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}};function Yte(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return zy;case"vector":case"vector2":case"vector3":case"vector4":return ky;case"color":return sN;case"quaternion":return rg;case"bool":case"boolean":return Zp;case"string":return Qp}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function Zte(e){if(e.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");let t=Yte(e.type);if(e.times===void 0){let i=[],n=[];nN(e.keys,i,n,"value"),e.times=i,e.values=n}return t.parse!==void 0?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var s8={enabled:!1,files:{},add:function(e,t){this.enabled!==!1&&(this.files[e]=t)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},aN=class{constructor(e,t,i){let n=this,r=!1,s=0,a=0,o,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(c){a++,r===!1&&n.onStart!==void 0&&n.onStart(c,s,a),r=!0},this.itemEnd=function(c){s++,n.onProgress!==void 0&&n.onProgress(c,s,a),s===a&&(r=!1,n.onLoad!==void 0&&n.onLoad())},this.itemError=function(c){n.onError!==void 0&&n.onError(c)},this.resolveURL=function(c){return o?o(c):c},this.setURLModifier=function(c){return o=c,this},this.addHandler=function(c,u){return l.push(c,u),this},this.removeHandler=function(c){let u=l.indexOf(c);return u!==-1&&l.splice(u,2),this},this.getHandler=function(c){for(let u=0,h=l.length;u<h;u+=2){let d=l[u],p=l[u+1];if(d.global&&(d.lastIndex=0),d.test(c))return p}return null}}},Qte=new aN,IE=class{constructor(e){this.manager=e!==void 0?e:Qte,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){let i=this;return new Promise(function(n,r){i.load(e,n,t,r)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}},_o={},Kte=class extends Error{constructor(e,t){super(e),this.response=t}},mS=class extends IE{constructor(e){super(e)}load(e,t,i,n){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);let r=s8.get(e);if(r!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(r),this.manager.itemEnd(e)},0),r;if(_o[e]!==void 0){_o[e].push({onLoad:t,onProgress:i,onError:n});return}_o[e]=[],_o[e].push({onLoad:t,onProgress:i,onError:n});let s=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,o=this.responseType;fetch(s).then(l=>{if(l.status===200||l.status===0){if(l.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||l.body===void 0||l.body.getReader===void 0)return l;let c=_o[e],u=l.body.getReader(),h=l.headers.get("Content-Length")||l.headers.get("X-File-Size"),d=h?parseInt(h):0,p=d!==0,f=0,v=new ReadableStream({start(m){g();function g(){u.read().then(({done:y,value:x})=>{if(y)m.close();else{f+=x.byteLength;let _=new ProgressEvent("progress",{lengthComputable:p,loaded:f,total:d});for(let b=0,w=c.length;b<w;b++){let M=c[b];M.onProgress&&M.onProgress(_)}m.enqueue(x),g()}})}}});return new Response(v)}else throw new Kte(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(o){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(c=>new DOMParser().parseFromString(c,a));case"json":return l.json();default:if(a===void 0)return l.text();{let c=/charset="?([^;"\s]*)"?/i.exec(a),u=c&&c[1]?c[1].toLowerCase():void 0,h=new TextDecoder(u);return l.arrayBuffer().then(d=>h.decode(d))}}}).then(l=>{s8.add(e,l);let c=_o[e];delete _o[e];for(let u=0,h=c.length;u<h;u++){let d=c[u];d.onLoad&&d.onLoad(l)}}).catch(l=>{let c=_o[e];if(c===void 0)throw this.manager.itemError(e),l;delete _o[e];for(let u=0,h=c.length;u<h;u++){let d=c[u];d.onError&&d.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}},sg=class extends $t{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new ut(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}},$te=class extends sg{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy($t.DEFAULT_UP),this.updateMatrix(),this.groundColor=new ut(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}},rb=new ke,a8=new T,o8=new T,OE=class{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new te(512,512),this.map=null,this.mapPass=null,this.matrix=new ke,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new ME,this._frameExtents=new te(1,1),this._viewportCount=1,this._viewports=[new Ct(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,i=this.matrix;a8.setFromMatrixPosition(e.matrixWorld),t.position.copy(a8),o8.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(o8),t.updateMatrixWorld(),rb.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(rb),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(rb)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},Jte=class extends OE{constructor(){super(new Vn(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,i=_0*2*e.angle*this.focus,n=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;(i!==t.fov||n!==t.aspect||r!==t.far)&&(t.fov=i,t.aspect=n,t.far=r,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},eie=class extends sg{constructor(e,t,i=0,n=Math.PI/3,r=0,s=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy($t.DEFAULT_UP),this.updateMatrix(),this.target=new $t,this.distance=i,this.angle=n,this.penumbra=r,this.decay=s,this.map=null,this.shadow=new Jte}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},l8=new ke,Df=new T,sb=new T,tie=class extends OE{constructor(){super(new Vn(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new te(4,2),this._viewportCount=6,this._viewports=[new Ct(2,1,1,1),new Ct(0,1,1,1),new Ct(3,1,1,1),new Ct(1,1,1,1),new Ct(3,0,1,1),new Ct(1,0,1,1)],this._cubeDirections=[new T(1,0,0),new T(-1,0,0),new T(0,0,1),new T(0,0,-1),new T(0,1,0),new T(0,-1,0)],this._cubeUps=[new T(0,1,0),new T(0,1,0),new T(0,1,0),new T(0,1,0),new T(0,0,1),new T(0,0,-1)]}updateMatrices(e,t=0){let i=this.camera,n=this.matrix,r=e.distance||i.far;r!==i.far&&(i.far=r,i.updateProjectionMatrix()),Df.setFromMatrixPosition(e.matrixWorld),i.position.copy(Df),sb.copy(i.position),sb.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(sb),i.updateMatrixWorld(),n.makeTranslation(-Df.x,-Df.y,-Df.z),l8.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(l8)}},iie=class extends sg{constructor(e,t,i=0,n=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=n,this.shadow=new tie}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},nie=class extends OE{constructor(){super(new CE(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},rie=class extends sg{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy($t.DEFAULT_UP),this.updateMatrix(),this.target=new $t,this.shadow=new nie}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},sie=class extends mt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}},oN=class extends IE{constructor(e){super(e)}load(e,t,i,n){let r=this,s=new mS(r.manager);s.setPath(r.path),s.setRequestHeader(r.requestHeader),s.setWithCredentials(r.withCredentials),s.load(e,function(a){try{t(r.parse(JSON.parse(a)))}catch(o){n?n(o):console.error(o),r.manager.itemError(e)}},i,n)}parse(e){let t={},i={};function n(h,d){if(t[d]!==void 0)return t[d];let p=h.interleavedBuffers[d],f=r(h,p.buffer),v=Fg(p.type,f),m=new dte(v,p.stride);return m.uuid=p.uuid,t[d]=m,m}function r(h,d){if(i[d]!==void 0)return i[d];let p=h.arrayBuffers[d],f=new Uint32Array(p).buffer;return i[d]=f,f}let s=e.isInstancedBufferGeometry?new sie:new mt,a=e.data.index;if(a!==void 0){let h=Fg(a.type,a.array);s.setIndex(new gt(h,1))}let o=e.data.attributes;for(let h in o){let d=o[h],p;if(d.isInterleavedBufferAttribute){let f=n(e.data,d.data);p=new uS(f,d.itemSize,d.offset,d.normalized)}else{let f=Fg(d.type,d.array),v=d.isInstancedBufferAttribute?fte:gt;p=new v(f,d.itemSize,d.normalized)}d.name!==void 0&&(p.name=d.name),d.usage!==void 0&&p.setUsage(d.usage),d.updateRange!==void 0&&(p.updateRange.offset=d.updateRange.offset,p.updateRange.count=d.updateRange.count),s.setAttribute(h,p)}let l=e.data.morphAttributes;if(l)for(let h in l){let d=l[h],p=[];for(let f=0,v=d.length;f<v;f++){let m=d[f],g;if(m.isInterleavedBufferAttribute){let y=n(e.data,m.data);g=new uS(y,m.itemSize,m.offset,m.normalized)}else{let y=Fg(m.type,m.array);g=new gt(y,m.itemSize,m.normalized)}m.name!==void 0&&(g.name=m.name),p.push(g)}s.morphAttributes[h]=p}e.data.morphTargetsRelative&&(s.morphTargetsRelative=!0);let c=e.data.groups||e.data.drawcalls||e.data.offsets;if(c!==void 0)for(let h=0,d=c.length;h!==d;++h){let p=c[h];s.addGroup(p.start,p.count,p.materialIndex)}let u=e.data.boundingSphere;if(u!==void 0){let h=new T;u.center!==void 0&&h.fromArray(u.center),s.boundingSphere=new ls(h,u.radius)}return e.name&&(s.name=e.name),e.userData&&(s.userData=e.userData),s}},aie=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=c8(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=c8();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function c8(){return(typeof performance>"u"?Date:performance).now()}var oie=class{constructor(e,t,i){this.binding=e,this.valueSize=i;let n,r,s;switch(t){case"quaternion":n=this._slerp,r=this._slerpAdditive,s=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":n=this._select,r=this._select,s=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:n=this._lerp,r=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=n,this._mixBufferRegionAdditive=r,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){let i=this.buffer,n=this.valueSize,r=e*n+n,s=this.cumulativeWeight;if(s===0){for(let a=0;a!==n;++a)i[r+a]=i[a];s=t}else{s+=t;let a=t/s;this._mixBufferRegion(i,r,0,a,n)}this.cumulativeWeight=s}accumulateAdditive(e){let t=this.buffer,i=this.valueSize,n=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,n,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){let t=this.valueSize,i=this.buffer,n=e*t+t,r=this.cumulativeWeight,s=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,r<1){let o=t*this._origIndex;this._mixBufferRegion(i,n,o,1-r,t)}s>0&&this._mixBufferRegionAdditive(i,n,this._addIndex*t,1,t);for(let o=t,l=t+t;o!==l;++o)if(i[o]!==i[o+t]){a.setValue(i,n);break}}saveOriginalState(){let e=this.binding,t=this.buffer,i=this.valueSize,n=i*this._origIndex;e.getValue(t,n);for(let r=i,s=n;r!==s;++r)t[r]=t[n+r%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){let e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,n,r){if(n>=.5)for(let s=0;s!==r;++s)e[t+s]=e[i+s]}_slerp(e,t,i,n){At.slerpFlat(e,t,e,t,e,i,n)}_slerpAdditive(e,t,i,n,r){let s=this._workIndex*r;At.multiplyQuaternionsFlat(e,s,e,t,e,i),At.slerpFlat(e,t,e,t,e,s,n)}_lerp(e,t,i,n,r){let s=1-n;for(let a=0;a!==r;++a){let o=t+a;e[o]=e[o]*s+e[i+a]*n}}_lerpAdditive(e,t,i,n,r){for(let s=0;s!==r;++s){let a=t+s;e[a]=e[a]+e[i+s]*n}}},BE="\\[\\]\\.:\\/",lie=new RegExp("["+BE+"]","g"),NE="[^"+BE+"]",cie="[^"+BE.replace("\\.","")+"]",hie=/((?:WC+[\/:])*)/.source.replace("WC",NE),uie=/(WCOD+)?/.source.replace("WCOD",cie),die=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",NE),pie=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",NE),fie=new RegExp("^"+hie+uie+die+pie+"$"),mie=["material","materials","bones","map"],gie=class{constructor(e,t,i){let n=i||ii.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}getValue(e,t){this.bind();let i=this._targetGroup.nCachedObjects_,n=this._bindings[i];n!==void 0&&n.getValue(e,t)}setValue(e,t){let i=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=i.length;n!==r;++n)i[n].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}},ii=class{constructor(e,t,i){this.path=t,this.parsedPath=i||ii.parseTrackName(t),this.node=ii.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new ii.Composite(e,t,i):new ii(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(lie,"")}static parseTrackName(e){let t=fie.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=i.nodeName&&i.nodeName.lastIndexOf(".");if(n!==void 0&&n!==-1){let r=i.nodeName.substring(n+1);mie.indexOf(r)!==-1&&(i.nodeName=i.nodeName.substring(0,n),i.objectName=r)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){let i=e.skeleton.getBoneByName(t);if(i!==void 0)return i}if(e.children){let i=function(r){for(let s=0;s<r.length;s++){let a=r[s];if(a.name===t||a.uuid===t)return a;let o=i(a.children);if(o)return o}return null},n=i(e.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)e[t++]=i[n]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let i=this.resolvedProperty;for(let n=0,r=i.length;n!==r;++n)i[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,i=t.objectName,n=t.propertyName,r=t.propertyIndex;if(e||(e=ii.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(i){let l=t.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let c=0;c<e.length;c++)if(e[c].name===l){l=c;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(l!==void 0){if(e[l]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[l]}}let s=e[n];if(s===void 0){let l=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+n+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(r!==void 0){if(n==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[r]!==void 0&&(r=e.morphTargetDictionary[r])}o=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else s.fromArray!==void 0&&s.toArray!==void 0?(o=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(o=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};ii.Composite=gie;ii.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};ii.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};ii.prototype.GetterByBindingType=[ii.prototype._getValue_direct,ii.prototype._getValue_array,ii.prototype._getValue_arrayElement,ii.prototype._getValue_toArray];ii.prototype.SetterByBindingTypeAndVersioning=[[ii.prototype._setValue_direct,ii.prototype._setValue_direct_setNeedsUpdate,ii.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ii.prototype._setValue_array,ii.prototype._setValue_array_setNeedsUpdate,ii.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ii.prototype._setValue_arrayElement,ii.prototype._setValue_arrayElement_setNeedsUpdate,ii.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ii.prototype._setValue_fromArray,ii.prototype._setValue_fromArray_setNeedsUpdate,ii.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var vie=class{constructor(e,t,i=null,n=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=n;let r=t.tracks,s=r.length,a=new Array(s),o={endingStart:Dd,endingEnd:Dd};for(let l=0;l!==s;++l){let c=r[l].createInterpolant(null);a[l]=c,c.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(s),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=EB,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){let n=this._clip.duration,r=e._clip.duration,s=r/n,a=n/r;e.warp(1,s,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){let e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){let n=this._mixer,r=n.time,s=this.timeScale,a=this._timeScaleInterpolant;a===null&&(a=n._lendControlInterpolant(),this._timeScaleInterpolant=a);let o=a.parameterPositions,l=a.sampleValues;return o[0]=r,o[1]=r+i,l[0]=e/s,l[1]=t/s,this}stopWarping(){let e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,n){if(!this.enabled){this._updateWeight(e);return}let r=this._startTime;if(r!==null){let o=(e-r)*i;o<0||i===0?t=0:(this._startTime=null,t=i*o)}t*=this._updateTimeScale(e);let s=this._updateTime(t),a=this._updateWeight(e);if(a>0){let o=this._interpolants,l=this._propertyBindings;switch(this.blendMode){case KZ:for(let c=0,u=o.length;c!==u;++c)o[c].evaluate(s),l[c].accumulateAdditive(a);break;case _E:default:for(let c=0,u=o.length;c!==u;++c)o[c].evaluate(s),l[c].accumulate(n,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;let i=this._weightInterpolant;if(i!==null){let n=i.evaluate(e)[0];t*=n,e>i.parameterPositions[1]&&(this.stopFading(),n===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;let i=this._timeScaleInterpolant;if(i!==null){let n=i.evaluate(e)[0];t*=n,e>i.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){let t=this._clip.duration,i=this.loop,n=this.time+e,r=this._loopCount,s=i===xE;if(e===0)return r===-1?n:s&&(r&1)===1?t-n:n;if(i===CB){r===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(n>=t)n=t;else if(n<0)n=0;else{this.time=n;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(r===-1&&(e>=0?(r=0,this._setEndings(!0,this.repetitions===0,s)):this._setEndings(this.repetitions===0,!0,s)),n>=t||n<0){let a=Math.floor(n/t);n-=t*a,r+=Math.abs(a);let o=this.repetitions-r;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,n=e>0?t:0,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(o===1){let l=e<0;this._setEndings(l,!l,s)}else this._setEndings(!1,!1,s);this._loopCount=r,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=n;if(s&&(r&1)===1)return t-n}return n}_setEndings(e,t,i){let n=this._interpolantSettings;i?(n.endingStart=Ld,n.endingEnd=Ld):(e?n.endingStart=this.zeroSlopeAtStart?Ld:Dd:n.endingStart=Ly,t?n.endingEnd=this.zeroSlopeAtEnd?Ld:Dd:n.endingEnd=Ly)}_scheduleFading(e,t,i){let n=this._mixer,r=n.time,s=this._weightInterpolant;s===null&&(s=n._lendControlInterpolant(),this._weightInterpolant=s);let a=s.parameterPositions,o=s.sampleValues;return a[0]=r,o[0]=t,a[1]=r+e,o[1]=i,this}},yie=new Float32Array(1),xie=class extends In{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){let i=e._localRoot||this._root,n=e._clip.tracks,r=n.length,s=e._propertyBindings,a=e._interpolants,o=i.uuid,l=this._bindingsByRootAndName,c=l[o];c===void 0&&(c={},l[o]=c);for(let u=0;u!==r;++u){let h=n[u],d=h.name,p=c[d];if(p!==void 0)++p.referenceCount,s[u]=p;else{if(p=s[u],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,o,d));continue}let f=t&&t._propertyBindings[u].binding.parsedPath;p=new oie(ii.create(i,d,f),h.ValueTypeName,h.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,o,d),s[u]=p}a[u].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){let i=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,i)}let t=e._propertyBindings;for(let i=0,n=t.length;i!==n;++i){let r=t[i];r.useCount++===0&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){let t=e._propertyBindings;for(let i=0,n=t.length;i!==n;++i){let r=t[i];--r.useCount===0&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){let t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,i){let n=this._actions,r=this._actionsByClip,s=r[t];if(s===void 0)s={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=s;else{let a=s.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=n.length,n.push(e),s.actionByRoot[i]=e}_removeInactiveAction(e){let t=this._actions,i=t[t.length-1],n=e._cacheIndex;i._cacheIndex=n,t[n]=i,t.pop(),e._cacheIndex=null;let r=e._clip.uuid,s=this._actionsByClip,a=s[r],o=a.knownActions,l=o[o.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,o[c]=l,o.pop(),e._byClipCacheIndex=null;let u=a.actionByRoot,h=(e._localRoot||this._root).uuid;delete u[h],o.length===0&&delete s[r],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){let t=e._propertyBindings;for(let i=0,n=t.length;i!==n;++i){let r=t[i];--r.referenceCount===0&&this._removeInactiveBinding(r)}}_lendAction(e){let t=this._actions,i=e._cacheIndex,n=this._nActiveActions++,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r}_takeBackAction(e){let t=this._actions,i=e._cacheIndex,n=--this._nActiveActions,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r}_addInactiveBinding(e,t,i){let n=this._bindingsByRootAndName,r=this._bindings,s=n[t];s===void 0&&(s={},n[t]=s),s[i]=e,e._cacheIndex=r.length,r.push(e)}_removeInactiveBinding(e){let t=this._bindings,i=e.binding,n=i.rootNode.uuid,r=i.path,s=this._bindingsByRootAndName,a=s[n],o=t[t.length-1],l=e._cacheIndex;o._cacheIndex=l,t[l]=o,t.pop(),delete a[r],Object.keys(a).length===0&&delete s[n]}_lendBinding(e){let t=this._bindings,i=e._cacheIndex,n=this._nActiveBindings++,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r}_takeBackBinding(e){let t=this._bindings,i=e._cacheIndex,n=--this._nActiveBindings,r=t[n];e._cacheIndex=n,t[n]=e,r._cacheIndex=i,t[i]=r}_lendControlInterpolant(){let e=this._controlInterpolants,t=this._nActiveControlInterpolants++,i=e[t];return i===void 0&&(i=new rN(new Float32Array(2),new Float32Array(2),1,yie),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){let t=this._controlInterpolants,i=e.__cacheIndex,n=--this._nActiveControlInterpolants,r=t[n];e.__cacheIndex=n,t[n]=e,r.__cacheIndex=i,t[i]=r}clipAction(e,t,i){let n=t||this._root,r=n.uuid,s=typeof e=="string"?fS.findByName(n,e):e,a=s!==null?s.uuid:e,o=this._actionsByClip[a],l=null;if(i===void 0&&(s!==null?i=s.blendMode:i=_E),o!==void 0){let u=o.actionByRoot[r];if(u!==void 0&&u.blendMode===i)return u;l=o.knownActions[0],s===null&&(s=l._clip)}if(s===null)return null;let c=new vie(this,s,t,i);return this._bindAction(c,l),this._addInactiveAction(c,a,r),c}existingAction(e,t){let i=t||this._root,n=i.uuid,r=typeof e=="string"?fS.findByName(i,e):e,s=r?r.uuid:e,a=this._actionsByClip[s];return a!==void 0&&a.actionByRoot[n]||null}stopAllAction(){let e=this._actions,t=this._nActiveActions;for(let i=t-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;let t=this._actions,i=this._nActiveActions,n=this.time+=e,r=Math.sign(e),s=this._accuIndex^=1;for(let l=0;l!==i;++l)t[l]._update(n,e,r,s);let a=this._bindings,o=this._nActiveBindings;for(let l=0;l!==o;++l)a[l].apply(s);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){let t=this._actions,i=e.uuid,n=this._actionsByClip,r=n[i];if(r!==void 0){let s=r.knownActions;for(let a=0,o=s.length;a!==o;++a){let l=s[a];this._deactivateAction(l);let c=l._cacheIndex,u=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,u._cacheIndex=c,t[c]=u,t.pop(),this._removeInactiveBindingsForAction(l)}delete n[i]}}uncacheRoot(e){let t=e.uuid,i=this._actionsByClip;for(let s in i){let a=i[s].actionByRoot,o=a[t];o!==void 0&&(this._deactivateAction(o),this._removeInactiveAction(o))}let n=this._bindingsByRootAndName,r=n[t];if(r!==void 0)for(let s in r){let a=r[s];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){let i=this.existingAction(e,t);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}},Fe=class{constructor(e){this.value=e}clone(){return new Fe(this.value.clone===void 0?this.value:this.value.clone())}},lN=class{constructor(e,t,i=0,n=1/0){this.ray=new Wp(e,t),this.near=i,this.far=n,this.camera=null,this.layers=new wE,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return gS(e,this,i,t),i.sort(h8),i}intersectObjects(e,t=!0,i=[]){for(let n=0,r=e.length;n<r;n++)gS(e[n],this,i,t);return i.sort(h8),i}};function h8(e,t){return e.distance-t.distance}function gS(e,t,i,n){if(e.layers.test(t.layers)&&e.raycast(t,i),n===!0){let r=e.children;for(let s=0,a=r.length;s<a;s++)gS(r[s],t,i,!0)}}var u8=class{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(an(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}},d8=new te,_ie=class{constructor(e=new te(1/0,1/0),t=new te(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let i=d8.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return d8.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},p8=new T,l1=new T,Is=class{constructor(e=new T,t=new T){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){p8.subVectors(e,this.start),l1.subVectors(this.end,this.start);let i=l1.dot(l1),n=l1.dot(p8)/i;return t&&(n=an(n,0,1)),n}closestPointToPoint(e,t,i){let n=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(n).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}},f8=new T,bie=class extends $t{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";let i=new mt,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let s=0,a=1,o=32;s<o;s++,a++){let l=s/o*Math.PI*2,c=a/o*Math.PI*2;n.push(Math.cos(l),Math.sin(l),1,Math.cos(c),Math.sin(c),1)}i.setAttribute("position",new et(n,3));let r=new Uc({fog:!1,toneMapped:!1});this.cone=new ng(i,r),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);let e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),f8.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(f8),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}},wie=class extends Ar{constructor(e,t,i){let n=new RE(t,4,2),r=new ig({wireframe:!0,fog:!1,toneMapped:!1});super(n,r),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}},m8=new T,c1=new T,g8=new T,Sie=class extends $t{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",t===void 0&&(t=1);let n=new mt;n.setAttribute("position",new et([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));let r=new Uc({fog:!1,toneMapped:!1});this.lightPlane=new Ny(n,r),this.add(this.lightPlane),n=new mt,n.setAttribute("position",new et([0,0,0,0,0,1],3)),this.targetLine=new Ny(n,r),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),m8.setFromMatrixPosition(this.light.matrixWorld),c1.setFromMatrixPosition(this.light.target.matrixWorld),g8.subVectors(c1,m8),this.lightPlane.lookAt(c1),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(c1),this.targetLine.scale.z=g8.length()}},h1=new T,Ci=new qp,Vy=class extends ng{constructor(e){let t=new mt,i=new Uc({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],r=[],s={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(p,f){o(p),o(f)}function o(p){n.push(0,0,0),r.push(0,0,0),s[p]===void 0&&(s[p]=[]),s[p].push(n.length/3-1)}t.setAttribute("position",new et(n,3)),t.setAttribute("color",new et(r,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update();let l=new ut(16755200),c=new ut(16711680),u=new ut(43775),h=new ut(16777215),d=new ut(3355443);this.setColors(l,c,u,h,d)}setColors(e,t,i,n,r){let s=this.geometry.getAttribute("color");s.setXYZ(0,e.r,e.g,e.b),s.setXYZ(1,e.r,e.g,e.b),s.setXYZ(2,e.r,e.g,e.b),s.setXYZ(3,e.r,e.g,e.b),s.setXYZ(4,e.r,e.g,e.b),s.setXYZ(5,e.r,e.g,e.b),s.setXYZ(6,e.r,e.g,e.b),s.setXYZ(7,e.r,e.g,e.b),s.setXYZ(8,e.r,e.g,e.b),s.setXYZ(9,e.r,e.g,e.b),s.setXYZ(10,e.r,e.g,e.b),s.setXYZ(11,e.r,e.g,e.b),s.setXYZ(12,e.r,e.g,e.b),s.setXYZ(13,e.r,e.g,e.b),s.setXYZ(14,e.r,e.g,e.b),s.setXYZ(15,e.r,e.g,e.b),s.setXYZ(16,e.r,e.g,e.b),s.setXYZ(17,e.r,e.g,e.b),s.setXYZ(18,e.r,e.g,e.b),s.setXYZ(19,e.r,e.g,e.b),s.setXYZ(20,e.r,e.g,e.b),s.setXYZ(21,e.r,e.g,e.b),s.setXYZ(22,e.r,e.g,e.b),s.setXYZ(23,e.r,e.g,e.b),s.setXYZ(24,t.r,t.g,t.b),s.setXYZ(25,t.r,t.g,t.b),s.setXYZ(26,t.r,t.g,t.b),s.setXYZ(27,t.r,t.g,t.b),s.setXYZ(28,t.r,t.g,t.b),s.setXYZ(29,t.r,t.g,t.b),s.setXYZ(30,t.r,t.g,t.b),s.setXYZ(31,t.r,t.g,t.b),s.setXYZ(32,i.r,i.g,i.b),s.setXYZ(33,i.r,i.g,i.b),s.setXYZ(34,i.r,i.g,i.b),s.setXYZ(35,i.r,i.g,i.b),s.setXYZ(36,i.r,i.g,i.b),s.setXYZ(37,i.r,i.g,i.b),s.setXYZ(38,n.r,n.g,n.b),s.setXYZ(39,n.r,n.g,n.b),s.setXYZ(40,r.r,r.g,r.b),s.setXYZ(41,r.r,r.g,r.b),s.setXYZ(42,r.r,r.g,r.b),s.setXYZ(43,r.r,r.g,r.b),s.setXYZ(44,r.r,r.g,r.b),s.setXYZ(45,r.r,r.g,r.b),s.setXYZ(46,r.r,r.g,r.b),s.setXYZ(47,r.r,r.g,r.b),s.setXYZ(48,r.r,r.g,r.b),s.setXYZ(49,r.r,r.g,r.b),s.needsUpdate=!0}update(){let e=this.geometry,t=this.pointMap,i=1,n=1;Ci.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Oi("c",t,e,Ci,0,0,-1),Oi("t",t,e,Ci,0,0,1),Oi("n1",t,e,Ci,-i,-n,-1),Oi("n2",t,e,Ci,i,-n,-1),Oi("n3",t,e,Ci,-i,n,-1),Oi("n4",t,e,Ci,i,n,-1),Oi("f1",t,e,Ci,-i,-n,1),Oi("f2",t,e,Ci,i,-n,1),Oi("f3",t,e,Ci,-i,n,1),Oi("f4",t,e,Ci,i,n,1),Oi("u1",t,e,Ci,i*.7,n*1.1,-1),Oi("u2",t,e,Ci,-i*.7,n*1.1,-1),Oi("u3",t,e,Ci,0,n*2,-1),Oi("cf1",t,e,Ci,-i,0,1),Oi("cf2",t,e,Ci,i,0,1),Oi("cf3",t,e,Ci,0,-n,1),Oi("cf4",t,e,Ci,0,n,1),Oi("cn1",t,e,Ci,-i,0,-1),Oi("cn2",t,e,Ci,i,0,-1),Oi("cn3",t,e,Ci,0,-n,-1),Oi("cn4",t,e,Ci,0,n,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function Oi(e,t,i,n,r,s,a){h1.set(r,s,a).unproject(n);let o=t[e];if(o!==void 0){let l=i.getAttribute("position");for(let c=0,u=o.length;c<u;c++)l.setXYZ(o[c],h1.x,h1.y,h1.z)}}var Hy=class extends ng{constructor(e,t=16776960){let i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],r=new mt;r.setIndex(new gt(i,1)),r.setAttribute("position",new et(n,3)),super(r,new Uc({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){let t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}},Mie=class extends ng{constructor(e=1){let t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],n=new mt;n.setAttribute("position",new et(t,3)),n.setAttribute("color",new et(i,3));let r=new Uc({vertexColors:!0,toneMapped:!1});super(n,r),this.type="AxesHelper"}setColors(e,t,i){let n=new ut,r=this.geometry.attributes.color.array;return n.set(e),n.toArray(r,0),n.toArray(r,3),n.set(t),n.toArray(r,6),n.toArray(r,9),n.set(i),n.toArray(r,12),n.toArray(r,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:jp}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=jp);var Lf=".",UE=Symbol("target"),cN=Symbol("unsubscribe");function vS(e){return e instanceof Date||e instanceof Set||e instanceof Map||e instanceof WeakSet||e instanceof WeakMap||ArrayBuffer.isView(e)}function Cie(e){return(typeof e=="object"?e===null:typeof e!="function")||e instanceof RegExp}var ja=Array.isArray;function FE(e){return typeof e=="symbol"}var Eie={after:(e,t)=>ja(e)?e.slice(t.length):t===""?e:e.slice(t.length+1),concat:(e,t)=>ja(e)?(e=[...e],t&&e.push(t),e):t&&t.toString!==void 0?(e!==""&&(e+=Lf),FE(t)?e+t.toString():e+t):e,initial:e=>{if(ja(e))return e.slice(0,-1);if(e==="")return e;let t=e.lastIndexOf(Lf);return t===-1?"":e.slice(0,t)},last:e=>{if(ja(e))return e[e.length-1]||"";if(e==="")return e;let t=e.lastIndexOf(Lf);return t===-1?e:e.slice(t+1)},walk:(e,t)=>{if(ja(e))for(let i of e)t(i);else if(e!==""){let i=0,n=e.indexOf(Lf);if(n===-1)t(e);else for(;i<e.length;)n===-1&&(n=e.length),t(e.slice(i,n)),i=n+1,n=e.indexOf(Lf,i)}},get(e,t){return this.walk(t,i=>{e&&(e=e[i])}),e}},ws=Eie;function Aie(e){return typeof e=="object"&&typeof e.next=="function"}function Tie(e,t,i,n,r){let s=e.next;if(t.name==="entries")e.next=function(){let a=s.call(this);return a.done===!1&&(a.value[0]=r(a.value[0],t,a.value[0],n),a.value[1]=r(a.value[1],t,a.value[0],n)),a};else if(t.name==="values"){let a=i[UE].keys();e.next=function(){let o=s.call(this);return o.done===!1&&(o.value=r(o.value,t,a.next().value,n)),o}}else e.next=function(){let a=s.call(this);return a.done===!1&&(a.value=r(a.value,t,a.value,n)),a};return e}function v8(e,t,i){return e.isUnsubscribed||t.ignoreSymbols&&FE(i)||t.ignoreUnderscores&&i.charAt(0)==="_"||"ignoreKeys"in t&&t.ignoreKeys.includes(i)}var Pie=class{constructor(e){this._equals=e,this._proxyCache=new WeakMap,this._pathCache=new WeakMap,this.isUnsubscribed=!1}_getDescriptorCache(){return this._descriptorCache===void 0&&(this._descriptorCache=new WeakMap),this._descriptorCache}_getProperties(e){let t=this._getDescriptorCache(),i=t.get(e);return i===void 0&&(i={},t.set(e,i)),i}_getOwnPropertyDescriptor(e,t){if(this.isUnsubscribed)return Reflect.getOwnPropertyDescriptor(e,t);let i=this._getProperties(e),n=i[t];return n===void 0&&(n=Reflect.getOwnPropertyDescriptor(e,t),i[t]=n),n}getProxy(e,t,i,n){if(this.isUnsubscribed)return e;let r=e[n],s=r||e;this._pathCache.set(s,t);let a=this._proxyCache.get(s);return a===void 0&&(a=r===void 0?new Proxy(e,i):e,this._proxyCache.set(s,a)),a}getPath(e){return this.isUnsubscribed?void 0:this._pathCache.get(e)}isDetached(e,t){return!Object.is(e,ws.get(t,this.getPath(e)))}defineProperty(e,t,i){return Reflect.defineProperty(e,t,i)?(this.isUnsubscribed||(this._getProperties(e)[t]=i),!0):!1}setProperty(e,t,i,n,r){if(!this._equals(r,i)||!(t in e)){let s=this._getOwnPropertyDescriptor(e,t);return s!==void 0&&"set"in s?Reflect.set(e,t,i,n):Reflect.set(e,t,i)}return!0}deleteProperty(e,t,i){if(Reflect.deleteProperty(e,t)){if(!this.isUnsubscribed){let n=this._getDescriptorCache().get(e);n&&(delete n[t],this._pathCache.delete(i))}return!0}return!1}isSameDescriptor(e,t,i){let n=this._getOwnPropertyDescriptor(t,i);return e!==void 0&&n!==void 0&&Object.is(e.value,n.value)&&(e.writable||!1)===(n.writable||!1)&&(e.enumerable||!1)===(n.enumerable||!1)&&(e.configurable||!1)===(n.configurable||!1)&&e.get===n.get&&e.set===n.set}isGetInvariant(e,t){let i=this._getOwnPropertyDescriptor(e,t);return i!==void 0&&i.configurable!==!0&&i.writable!==!0}unsubscribe(){this._descriptorCache=null,this._pathCache=null,this._proxyCache=null,this.isUnsubscribed=!0}};function yS(e){return toString.call(e)==="[object Object]"}function u1(){return!0}function Cu(e,t){return e.length!==t.length||e.some((i,n)=>t[n]!==i)}var hN=new Set(["hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),Die=new Set(["concat","includes","indexOf","join","keys","lastIndexOf"]),uN={push:u1,pop:u1,shift:u1,unshift:u1,copyWithin:Cu,reverse:Cu,sort:Cu,splice:Cu,flat:Cu,fill:Cu},Lie=new Set([...hN,...Die,...Object.keys(uN)]);function d1(e,t){if(e.size!==t.size)return!0;for(let i of e)if(!t.has(i))return!0;return!1}var dN=["keys","values","entries"],pN=new Set(["has","toString"]),fN={add:d1,clear:d1,delete:d1,forEach:d1},Rie=new Set([...pN,...Object.keys(fN),...dN]);function p1(e,t){if(e.size!==t.size)return!0;let i;for(let[n,r]of e)if(i=t.get(n),i!==r||i===void 0&&!t.has(n))return!0;return!1}var Iie=new Set([...pN,"get"]),mN={set:p1,clear:p1,delete:p1,forEach:p1},Oie=new Set([...Iie,...Object.keys(mN),...dN]),Dc=class{constructor(e,t,i,n){this._path=t,this._isChanged=!1,this._clonedCache=new Set,this._hasOnValidate=n,this._changes=n?[]:null,this.clone=t===void 0?e:this._shallowClone(e)}static isHandledMethod(e){return hN.has(e)}_shallowClone(e){let t=e;if(yS(e))t={...e};else if(ja(e))t=[...e];else if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set([...e].map(i=>this._shallowClone(i)));else if(e instanceof Map){t=new Map;for(let[i,n]of e.entries())t.set(i,this._shallowClone(n))}return this._clonedCache.add(t),t}preferredThisArg(e,t,i,n){return e?(ja(n)?this._onIsChanged=uN[t]:n instanceof Set?this._onIsChanged=fN[t]:n instanceof Map&&(this._onIsChanged=mN[t]),n):i}update(e,t,i){let n=ws.after(e,this._path);if(t!=="length"){let r=this.clone;ws.walk(n,s=>{r&&r[s]&&(this._clonedCache.has(r[s])||(r[s]=this._shallowClone(r[s])),r=r[s])}),this._hasOnValidate&&this._changes.push({path:n,property:t,previous:i}),r&&r[t]&&(r[t]=i)}this._isChanged=!0}undo(e){let t;for(let i=this._changes.length-1;i!==-1;i--)t=this._changes[i],ws.get(e,t.path)[t.property]=t.previous}isChanged(e){return this._onIsChanged===void 0?this._isChanged:this._onIsChanged(this.clone,e)}},y8=class extends Dc{static isHandledMethod(e){return Lie.has(e)}},Bie=class extends Dc{undo(e){e.setTime(this.clone.getTime())}isChanged(e,t){return!t(this.clone.valueOf(),e.valueOf())}},x8=class extends Dc{static isHandledMethod(e){return Rie.has(e)}undo(e){for(let t of this.clone)e.add(t);for(let t of e)this.clone.has(t)||e.delete(t)}},_8=class extends Dc{static isHandledMethod(e){return Oie.has(e)}undo(e){for(let[t,i]of this.clone.entries())e.set(t,i);for(let t of e.keys())this.clone.has(t)||e.delete(t)}},Nie=class extends Dc{constructor(e,t,i,n){super(void 0,t,i,n),this._arg1=i[0],this._weakValue=e.has(this._arg1)}isChanged(e){return this._weakValue!==e.has(this._arg1)}undo(e){this._weakValue&&!e.has(this._arg1)?e.add(this._arg1):e.delete(this._arg1)}},Uie=class extends Dc{constructor(e,t,i,n){super(void 0,t,i,n),this._weakKey=i[0],this._weakHas=e.has(this._weakKey),this._weakValue=e.get(this._weakKey)}isChanged(e){return this._weakValue!==e.get(this._weakKey)}undo(e){let t=e.has(this._weakKey);this._weakHas&&!t?e.set(this._weakKey,this._weakValue):!this._weakHas&&t?e.delete(this._weakKey):this._weakValue!==e.get(this._weakKey)&&e.set(this._weakKey,this._weakValue)}},ld=class{constructor(e){this._stack=[],this._hasOnValidate=e}static isHandledType(e){return yS(e)||ja(e)||vS(e)}static isHandledMethod(e,t){return yS(e)?Dc.isHandledMethod(t):ja(e)?y8.isHandledMethod(t):e instanceof Set?x8.isHandledMethod(t):e instanceof Map?_8.isHandledMethod(t):vS(e)}get isCloning(){return this._stack.length>0}start(e,t,i){let n=Dc;ja(e)?n=y8:e instanceof Date?n=Bie:e instanceof Set?n=x8:e instanceof Map?n=_8:e instanceof WeakSet?n=Nie:e instanceof WeakMap&&(n=Uie),this._stack.push(new n(e,t,i,this._hasOnValidate))}update(e,t,i){this._stack[this._stack.length-1].update(e,t,i)}preferredThisArg(e,t,i){let{name:n}=e,r=ld.isHandledMethod(i,n);return this._stack[this._stack.length-1].preferredThisArg(r,n,t,i)}isChanged(e,t,i){return this._stack[this._stack.length-1].isChanged(e,t,i)}undo(e){this._previousClone!==void 0&&this._previousClone.undo(e)}stop(){return this._previousClone=this._stack.pop(),this._previousClone.clone}},Fie={equals:Object.is,isShallow:!1,pathAsArray:!1,ignoreSymbols:!1,ignoreUnderscores:!1,ignoreDetached:!1,details:!1},zE=(e,t,i={})=>{i={...Fie,...i};let n=Symbol("ProxyTarget"),{equals:r,isShallow:s,ignoreDetached:a,details:o}=i,l=new Pie(r),c=typeof i.onValidate=="function",u=new ld(c),h=(y,x,_,b,w)=>!c||u.isCloning||i.onValidate(ws.concat(l.getPath(y),x),_,b,w)===!0,d=(y,x,_,b)=>{!v8(l,i,x)&&!(a&&l.isDetached(y,e))&&p(l.getPath(y),x,_,b)},p=(y,x,_,b,w)=>{u.isCloning?u.update(y,x,b):t(ws.concat(y,x),_,b,w)},f=y=>y&&(y[n]||y),v=(y,x,_,b)=>Cie(y)||_==="constructor"||s&&!ld.isHandledMethod(x,_)||v8(l,i,_)||l.isGetInvariant(x,_)||a&&l.isDetached(x,e)?y:(b===void 0&&(b=l.getPath(x)),l.getProxy(y,ws.concat(b,_),m,n)),m={get(y,x,_){if(FE(x)){if(x===n||x===UE)return y;if(x===cN&&!l.isUnsubscribed&&l.getPath(y).length===0)return l.unsubscribe(),y}let b=vS(y)?Reflect.get(y,x):Reflect.get(y,x,_);return v(b,y,x)},set(y,x,_,b){_=f(_);let w=y[n]||y,M=w[x];if(r(M,_)&&x in y)return!0;let S=h(y,x,_,M);return S&&l.setProperty(w,x,_,b,M)?(d(y,x,y[x],M),!0):!S},defineProperty(y,x,_){if(!l.isSameDescriptor(_,y,x)){let b=y[x];h(y,x,_.value,b)&&l.defineProperty(y,x,_,b)&&d(y,x,_.value,b)}return!0},deleteProperty(y,x){if(!Reflect.has(y,x))return!0;let _=Reflect.get(y,x),b=h(y,x,void 0,_);return b&&l.deleteProperty(y,x,_)?(d(y,x,void 0,_),!0):!b},apply(y,x,_){let b=x[n]||x;if(l.isUnsubscribed)return Reflect.apply(y,b,_);if((o===!1||o!==!0&&!o.includes(y.name))&&ld.isHandledType(b)){let w=ws.initial(l.getPath(y)),M=ld.isHandledMethod(b,y.name);u.start(b,w,_);let S=Reflect.apply(y,u.preferredThisArg(y,x,b),M?_.map(P=>f(P)):_),C=u.isChanged(b,r),E=u.stop();if(ld.isHandledType(S)&&M&&(x instanceof Map&&y.name==="get"&&(w=ws.concat(w,_[0])),S=l.getProxy(S,w,m)),C){let P={name:y.name,args:_,result:S},I=u.isCloning?ws.initial(w):w,D=u.isCloning?ws.last(w):"";h(ws.get(e,I),D,b,E,P)?p(I,D,b,E,P):u.undo(b)}return(x instanceof Map||x instanceof Set)&&Aie(S)?Tie(S,y,x,w,v):S}return Reflect.apply(y,x,_)}},g=l.getProxy(e,i.pathAsArray?[]:"",m);return t=t.bind(g),c&&(i.onValidate=i.onValidate.bind(g)),g};zE.target=e=>e&&e[UE]||e;zE.unsubscribe=e=>e[cN]||e;var b8=zE,zie=typeof global=="object"&&global&&global.Object===Object&&global,gN=zie,kie=typeof self=="object"&&self&&self.Object===Object&&self,Vie=gN||kie||Function("return this")(),_a=Vie,Hie=_a.Symbol,Us=Hie,vN=Object.prototype,Gie=vN.hasOwnProperty,jie=vN.toString,Rf=Us?Us.toStringTag:void 0;function Wie(e){var t=Gie.call(e,Rf),i=e[Rf];try{e[Rf]=void 0;var n=!0}catch{}var r=jie.call(e);return n&&(t?e[Rf]=i:delete e[Rf]),r}var Xie=Wie,qie=Object.prototype,Yie=qie.toString;function Zie(e){return Yie.call(e)}var Qie=Zie,Kie="[object Null]",$ie="[object Undefined]",w8=Us?Us.toStringTag:void 0;function Jie(e){return e==null?e===void 0?$ie:Kie:w8&&w8 in Object(e)?Xie(e):Qie(e)}var nu=Jie;function ene(e){return e!=null&&typeof e=="object"}var cl=ene,tne="[object Symbol]";function ine(e){return typeof e=="symbol"||cl(e)&&nu(e)==tne}var c2=ine;function nne(e,t){for(var i=-1,n=e==null?0:e.length,r=Array(n);++i<n;)r[i]=t(e[i],i,e);return r}var yN=nne,rne=Array.isArray,so=rne,sne=1/0,S8=Us?Us.prototype:void 0,M8=S8?S8.toString:void 0;function xN(e){if(typeof e=="string")return e;if(so(e))return yN(e,xN)+"";if(c2(e))return M8?M8.call(e):"";var t=e+"";return t=="0"&&1/e==-sne?"-0":t}var ane=xN,one=/\s/;function lne(e){for(var t=e.length;t--&&one.test(e.charAt(t)););return t}var cne=lne,hne=/^\s+/;function une(e){return e&&e.slice(0,cne(e)+1).replace(hne,"")}var dne=une;function pne(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var xa=pne,C8=0/0,fne=/^[-+]0x[0-9a-f]+$/i,mne=/^0b[01]+$/i,gne=/^0o[0-7]+$/i,vne=parseInt;function yne(e){if(typeof e=="number")return e;if(c2(e))return C8;if(xa(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=xa(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=dne(e);var i=mne.test(e);return i||gne.test(e)?vne(e.slice(2),i?2:8):fne.test(e)?C8:+e}var E8=yne;function xne(e){return e}var _ne=xne,bne="[object AsyncFunction]",wne="[object Function]",Sne="[object GeneratorFunction]",Mne="[object Proxy]";function Cne(e){if(!xa(e))return!1;var t=nu(e);return t==wne||t==Sne||t==bne||t==Mne}var _N=Cne,Ene=_a["__core-js_shared__"],ab=Ene,A8=function(){var e=/[^.]+$/.exec(ab&&ab.keys&&ab.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Ane(e){return!!A8&&A8 in e}var Tne=Ane,Pne=Function.prototype,Dne=Pne.toString;function Lne(e){if(e!=null){try{return Dne.call(e)}catch{}try{return e+""}catch{}}return""}var ru=Lne,Rne=/[\\^$.*+?()[\]{}|]/g,Ine=/^\[object .+?Constructor\]$/,One=Function.prototype,Bne=Object.prototype,Nne=One.toString,Une=Bne.hasOwnProperty,Fne=RegExp("^"+Nne.call(Une).replace(Rne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function zne(e){if(!xa(e)||Tne(e))return!1;var t=_N(e)?Fne:Ine;return t.test(ru(e))}var kne=zne;function Vne(e,t){return e==null?void 0:e[t]}var Hne=Vne;function Gne(e,t){var i=Hne(e,t);return kne(i)?i:void 0}var su=Gne,jne=su(_a,"WeakMap"),xS=jne,T8=Object.create,Wne=function(){function e(){}return function(t){if(!xa(t))return{};if(T8)return T8(t);e.prototype=t;var i=new e;return e.prototype=void 0,i}}(),Xne=Wne;function qne(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}var Yne=qne;function Zne(e,t){var i=-1,n=e.length;for(t||(t=Array(n));++i<n;)t[i]=e[i];return t}var Qne=Zne,Kne=800,$ne=16,Jne=Date.now;function ere(e){var t=0,i=0;return function(){var n=Jne(),r=$ne-(n-i);if(i=n,r>0){if(++t>=Kne)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var tre=ere;function ire(e){return function(){return e}}var nre=ire,rre=function(){try{var e=su(Object,"defineProperty");return e({},"",{}),e}catch{}}(),Gy=rre,sre=Gy?function(e,t){return Gy(e,"toString",{configurable:!0,enumerable:!1,value:nre(t),writable:!0})}:_ne,are=sre,ore=tre(are),lre=ore;function cre(e,t){for(var i=-1,n=e==null?0:e.length;++i<n&&t(e[i],i,e)!==!1;);return e}var hre=cre,ure=9007199254740991,dre=/^(?:0|[1-9]\d*)$/;function pre(e,t){var i=typeof e;return t=t??ure,!!t&&(i=="number"||i!="symbol"&&dre.test(e))&&e>-1&&e%1==0&&e<t}var kE=pre;function fre(e,t,i){t=="__proto__"&&Gy?Gy(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}var bN=fre;function mre(e,t){return e===t||e!==e&&t!==t}var VE=mre,gre=Object.prototype,vre=gre.hasOwnProperty;function yre(e,t,i){var n=e[t];(!(vre.call(e,t)&&VE(n,i))||i===void 0&&!(t in e))&&bN(e,t,i)}var HE=yre;function xre(e,t,i,n){var r=!i;i||(i={});for(var s=-1,a=t.length;++s<a;){var o=t[s],l=n?n(i[o],e[o],o,i,e):void 0;l===void 0&&(l=e[o]),r?bN(i,o,l):HE(i,o,l)}return i}var ag=xre,P8=Math.max;function _re(e,t,i){return t=P8(t===void 0?e.length-1:t,0),function(){for(var n=arguments,r=-1,s=P8(n.length-t,0),a=Array(s);++r<s;)a[r]=n[t+r];r=-1;for(var o=Array(t+1);++r<t;)o[r]=n[r];return o[t]=i(a),Yne(e,this,o)}}var bre=_re,wre=9007199254740991;function Sre(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=wre}var GE=Sre;function Mre(e){return e!=null&&GE(e.length)&&!_N(e)}var wN=Mre,Cre=Object.prototype;function Ere(e){var t=e&&e.constructor,i=typeof t=="function"&&t.prototype||Cre;return e===i}var jE=Ere;function Are(e,t){for(var i=-1,n=Array(e);++i<e;)n[i]=t(i);return n}var Tre=Are,Pre="[object Arguments]";function Dre(e){return cl(e)&&nu(e)==Pre}var D8=Dre,SN=Object.prototype,Lre=SN.hasOwnProperty,Rre=SN.propertyIsEnumerable,Ire=D8(function(){return arguments}())?D8:function(e){return cl(e)&&Lre.call(e,"callee")&&!Rre.call(e,"callee")},WE=Ire;function Ore(){return!1}var Bre=Ore,MN=typeof is=="object"&&is&&!is.nodeType&&is,L8=MN&&typeof ns=="object"&&ns&&!ns.nodeType&&ns,Nre=L8&&L8.exports===MN,R8=Nre?_a.Buffer:void 0,Ure=R8?R8.isBuffer:void 0,Fre=Ure||Bre,jy=Fre,zre="[object Arguments]",kre="[object Array]",Vre="[object Boolean]",Hre="[object Date]",Gre="[object Error]",jre="[object Function]",Wre="[object Map]",Xre="[object Number]",qre="[object Object]",Yre="[object RegExp]",Zre="[object Set]",Qre="[object String]",Kre="[object WeakMap]",$re="[object ArrayBuffer]",Jre="[object DataView]",ese="[object Float32Array]",tse="[object Float64Array]",ise="[object Int8Array]",nse="[object Int16Array]",rse="[object Int32Array]",sse="[object Uint8Array]",ase="[object Uint8ClampedArray]",ose="[object Uint16Array]",lse="[object Uint32Array]",mi={};mi[ese]=mi[tse]=mi[ise]=mi[nse]=mi[rse]=mi[sse]=mi[ase]=mi[ose]=mi[lse]=!0;mi[zre]=mi[kre]=mi[$re]=mi[Vre]=mi[Jre]=mi[Hre]=mi[Gre]=mi[jre]=mi[Wre]=mi[Xre]=mi[qre]=mi[Yre]=mi[Zre]=mi[Qre]=mi[Kre]=!1;function cse(e){return cl(e)&&GE(e.length)&&!!mi[nu(e)]}var hse=cse;function use(e){return function(t){return e(t)}}var XE=use,CN=typeof is=="object"&&is&&!is.nodeType&&is,zm=CN&&typeof ns=="object"&&ns&&!ns.nodeType&&ns,dse=zm&&zm.exports===CN,ob=dse&&gN.process,pse=function(){try{var e=zm&&zm.require&&zm.require("util").types;return e||ob&&ob.binding&&ob.binding("util")}catch{}}(),Sp=pse,I8=Sp&&Sp.isTypedArray,fse=I8?XE(I8):hse,EN=fse,mse=Object.prototype,gse=mse.hasOwnProperty;function vse(e,t){var i=so(e),n=!i&&WE(e),r=!i&&!n&&jy(e),s=!i&&!n&&!r&&EN(e),a=i||n||r||s,o=a?Tre(e.length,String):[],l=o.length;for(var c in e)(t||gse.call(e,c))&&!(a&&(c=="length"||r&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||kE(c,l)))&&o.push(c);return o}var AN=vse;function yse(e,t){return function(i){return e(t(i))}}var TN=yse,xse=TN(Object.keys,Object),_se=xse,bse=Object.prototype,wse=bse.hasOwnProperty;function Sse(e){if(!jE(e))return _se(e);var t=[];for(var i in Object(e))wse.call(e,i)&&i!="constructor"&&t.push(i);return t}var Mse=Sse;function Cse(e){return wN(e)?AN(e):Mse(e)}var qE=Cse;function Ese(e){var t=[];if(e!=null)for(var i in Object(e))t.push(i);return t}var Ase=Ese,Tse=Object.prototype,Pse=Tse.hasOwnProperty;function Dse(e){if(!xa(e))return Ase(e);var t=jE(e),i=[];for(var n in e)n=="constructor"&&(t||!Pse.call(e,n))||i.push(n);return i}var Lse=Dse;function Rse(e){return wN(e)?AN(e,!0):Lse(e)}var YE=Rse,Ise=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ose=/^\w*$/;function Bse(e,t){if(so(e))return!1;var i=typeof e;return i=="number"||i=="symbol"||i=="boolean"||e==null||c2(e)?!0:Ose.test(e)||!Ise.test(e)||t!=null&&e in Object(t)}var Nse=Bse,Use=su(Object,"create"),M0=Use;function Fse(){this.__data__=M0?M0(null):{},this.size=0}var zse=Fse;function kse(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Vse=kse,Hse="__lodash_hash_undefined__",Gse=Object.prototype,jse=Gse.hasOwnProperty;function Wse(e){var t=this.__data__;if(M0){var i=t[e];return i===Hse?void 0:i}return jse.call(t,e)?t[e]:void 0}var Xse=Wse,qse=Object.prototype,Yse=qse.hasOwnProperty;function Zse(e){var t=this.__data__;return M0?t[e]!==void 0:Yse.call(t,e)}var Qse=Zse,Kse="__lodash_hash_undefined__";function $se(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=M0&&t===void 0?Kse:t,this}var Jse=$se;function Kp(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}Kp.prototype.clear=zse;Kp.prototype.delete=Vse;Kp.prototype.get=Xse;Kp.prototype.has=Qse;Kp.prototype.set=Jse;var O8=Kp;function eae(){this.__data__=[],this.size=0}var tae=eae;function iae(e,t){for(var i=e.length;i--;)if(VE(e[i][0],t))return i;return-1}var h2=iae,nae=Array.prototype,rae=nae.splice;function sae(e){var t=this.__data__,i=h2(t,e);if(i<0)return!1;var n=t.length-1;return i==n?t.pop():rae.call(t,i,1),--this.size,!0}var aae=sae;function oae(e){var t=this.__data__,i=h2(t,e);return i<0?void 0:t[i][1]}var lae=oae;function cae(e){return h2(this.__data__,e)>-1}var hae=cae;function uae(e,t){var i=this.__data__,n=h2(i,e);return n<0?(++this.size,i.push([e,t])):i[n][1]=t,this}var dae=uae;function $p(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}$p.prototype.clear=tae;$p.prototype.delete=aae;$p.prototype.get=lae;$p.prototype.has=hae;$p.prototype.set=dae;var u2=$p,pae=su(_a,"Map"),C0=pae;function fae(){this.size=0,this.__data__={hash:new O8,map:new(C0||u2),string:new O8}}var mae=fae;function gae(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var vae=gae;function yae(e,t){var i=e.__data__;return vae(t)?i[typeof t=="string"?"string":"hash"]:i.map}var d2=yae;function xae(e){var t=d2(this,e).delete(e);return this.size-=t?1:0,t}var _ae=xae;function bae(e){return d2(this,e).get(e)}var wae=bae;function Sae(e){return d2(this,e).has(e)}var Mae=Sae;function Cae(e,t){var i=d2(this,e),n=i.size;return i.set(e,t),this.size+=i.size==n?0:1,this}var Eae=Cae;function Jp(e){var t=-1,i=e==null?0:e.length;for(this.clear();++t<i;){var n=e[t];this.set(n[0],n[1])}}Jp.prototype.clear=mae;Jp.prototype.delete=_ae;Jp.prototype.get=wae;Jp.prototype.has=Mae;Jp.prototype.set=Eae;var p2=Jp,Aae="Expected a function";function ZE(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Aae);var i=function(){var n=arguments,r=t?t.apply(this,n):n[0],s=i.cache;if(s.has(r))return s.get(r);var a=e.apply(this,n);return i.cache=s.set(r,a)||s,a};return i.cache=new(ZE.Cache||p2),i}ZE.Cache=p2;var Tae=ZE,Pae=500;function Dae(e){var t=Tae(e,function(n){return i.size===Pae&&i.clear(),n}),i=t.cache;return t}var Lae=Dae,Rae=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Iae=/\\(\\)?/g,Oae=Lae(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Rae,function(i,n,r,s){t.push(r?s.replace(Iae,"$1"):n||i)}),t}),Bae=Oae;function Nae(e){return e==null?"":ane(e)}var Uae=Nae;function Fae(e,t){return so(e)?e:Nse(e,t)?[e]:Bae(Uae(e))}var ef=Fae,zae=1/0;function kae(e){if(typeof e=="string"||c2(e))return e;var t=e+"";return t=="0"&&1/e==-zae?"-0":t}var f2=kae;function Vae(e,t){t=ef(t,e);for(var i=0,n=t.length;e!=null&&i<n;)e=e[f2(t[i++])];return i&&i==n?e:void 0}var PN=Vae;function Hae(e,t){for(var i=-1,n=t.length,r=e.length;++i<n;)e[r+i]=t[i];return e}var QE=Hae,B8=Us?Us.isConcatSpreadable:void 0;function Gae(e){return so(e)||WE(e)||!!(B8&&e&&e[B8])}var jae=Gae;function DN(e,t,i,n,r){var s=-1,a=e.length;for(i||(i=jae),r||(r=[]);++s<a;){var o=e[s];t>0&&i(o)?t>1?DN(o,t-1,i,n,r):QE(r,o):n||(r[r.length]=o)}return r}var Wae=DN;function Xae(e){var t=e==null?0:e.length;return t?Wae(e,1):[]}var qae=Xae;function Yae(e){return lre(bre(e,void 0,qae),e+"")}var LN=Yae,Zae=TN(Object.getPrototypeOf,Object),KE=Zae,Qae="[object Object]",Kae=Function.prototype,$ae=Object.prototype,RN=Kae.toString,Jae=$ae.hasOwnProperty,eoe=RN.call(Object);function toe(e){if(!cl(e)||nu(e)!=Qae)return!1;var t=KE(e);if(t===null)return!0;var i=Jae.call(t,"constructor")&&t.constructor;return typeof i=="function"&&i instanceof i&&RN.call(i)==eoe}var ioe=toe;function noe(e,t,i){var n=-1,r=e.length;t<0&&(t=-t>r?0:r+t),i=i>r?r:i,i<0&&(i+=r),r=t>i?0:i-t>>>0,t>>>=0;for(var s=Array(r);++n<r;)s[n]=e[n+t];return s}var roe=noe;function soe(){this.__data__=new u2,this.size=0}var aoe=soe;function ooe(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i}var loe=ooe;function coe(e){return this.__data__.get(e)}var hoe=coe;function uoe(e){return this.__data__.has(e)}var doe=uoe,poe=200;function foe(e,t){var i=this.__data__;if(i instanceof u2){var n=i.__data__;if(!C0||n.length<poe-1)return n.push([e,t]),this.size=++i.size,this;i=this.__data__=new p2(n)}return i.set(e,t),this.size=i.size,this}var moe=foe;function tf(e){var t=this.__data__=new u2(e);this.size=t.size}tf.prototype.clear=aoe;tf.prototype.delete=loe;tf.prototype.get=hoe;tf.prototype.has=doe;tf.prototype.set=moe;var Vv=tf;function goe(e,t){return e&&ag(t,qE(t),e)}var voe=goe;function yoe(e,t){return e&&ag(t,YE(t),e)}var xoe=yoe,IN=typeof is=="object"&&is&&!is.nodeType&&is,N8=IN&&typeof ns=="object"&&ns&&!ns.nodeType&&ns,_oe=N8&&N8.exports===IN,U8=_oe?_a.Buffer:void 0,F8=U8?U8.allocUnsafe:void 0;function boe(e,t){if(t)return e.slice();var i=e.length,n=F8?F8(i):new e.constructor(i);return e.copy(n),n}var woe=boe;function Soe(e,t){for(var i=-1,n=e==null?0:e.length,r=0,s=[];++i<n;){var a=e[i];t(a,i,e)&&(s[r++]=a)}return s}var Moe=Soe;function Coe(){return[]}var ON=Coe,Eoe=Object.prototype,Aoe=Eoe.propertyIsEnumerable,z8=Object.getOwnPropertySymbols,Toe=z8?function(e){return e==null?[]:(e=Object(e),Moe(z8(e),function(t){return Aoe.call(e,t)}))}:ON,$E=Toe;function Poe(e,t){return ag(e,$E(e),t)}var Doe=Poe,Loe=Object.getOwnPropertySymbols,Roe=Loe?function(e){for(var t=[];e;)QE(t,$E(e)),e=KE(e);return t}:ON,BN=Roe;function Ioe(e,t){return ag(e,BN(e),t)}var Ooe=Ioe;function Boe(e,t,i){var n=t(e);return so(e)?n:QE(n,i(e))}var NN=Boe;function Noe(e){return NN(e,qE,$E)}var _S=Noe;function Uoe(e){return NN(e,YE,BN)}var UN=Uoe,Foe=su(_a,"DataView"),bS=Foe,zoe=su(_a,"Promise"),wS=zoe,koe=su(_a,"Set"),SS=koe,k8="[object Map]",Voe="[object Object]",V8="[object Promise]",H8="[object Set]",G8="[object WeakMap]",j8="[object DataView]",Hoe=ru(bS),Goe=ru(C0),joe=ru(wS),Woe=ru(SS),Xoe=ru(xS),sh=nu;(bS&&sh(new bS(new ArrayBuffer(1)))!=j8||C0&&sh(new C0)!=k8||wS&&sh(wS.resolve())!=V8||SS&&sh(new SS)!=H8||xS&&sh(new xS)!=G8)&&(sh=function(e){var t=nu(e),i=t==Voe?e.constructor:void 0,n=i?ru(i):"";if(n)switch(n){case Hoe:return j8;case Goe:return k8;case joe:return V8;case Woe:return H8;case Xoe:return G8}return t});var E0=sh,qoe=Object.prototype,Yoe=qoe.hasOwnProperty;function Zoe(e){var t=e.length,i=new e.constructor(t);return t&&typeof e[0]=="string"&&Yoe.call(e,"index")&&(i.index=e.index,i.input=e.input),i}var Qoe=Zoe,Koe=_a.Uint8Array,Wy=Koe;function $oe(e){var t=new e.constructor(e.byteLength);return new Wy(t).set(new Wy(e)),t}var JE=$oe;function Joe(e,t){var i=t?JE(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.byteLength)}var ele=Joe,tle=/\w*$/;function ile(e){var t=new e.constructor(e.source,tle.exec(e));return t.lastIndex=e.lastIndex,t}var nle=ile,W8=Us?Us.prototype:void 0,X8=W8?W8.valueOf:void 0;function rle(e){return X8?Object(X8.call(e)):{}}var sle=rle;function ale(e,t){var i=t?JE(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}var ole=ale,lle="[object Boolean]",cle="[object Date]",hle="[object Map]",ule="[object Number]",dle="[object RegExp]",ple="[object Set]",fle="[object String]",mle="[object Symbol]",gle="[object ArrayBuffer]",vle="[object DataView]",yle="[object Float32Array]",xle="[object Float64Array]",_le="[object Int8Array]",ble="[object Int16Array]",wle="[object Int32Array]",Sle="[object Uint8Array]",Mle="[object Uint8ClampedArray]",Cle="[object Uint16Array]",Ele="[object Uint32Array]";function Ale(e,t,i){var n=e.constructor;switch(t){case gle:return JE(e);case lle:case cle:return new n(+e);case vle:return ele(e,i);case yle:case xle:case _le:case ble:case wle:case Sle:case Mle:case Cle:case Ele:return ole(e,i);case hle:return new n;case ule:case fle:return new n(e);case dle:return nle(e);case ple:return new n;case mle:return sle(e)}}var Tle=Ale;function Ple(e){return typeof e.constructor=="function"&&!jE(e)?Xne(KE(e)):{}}var Dle=Ple,Lle="[object Map]";function Rle(e){return cl(e)&&E0(e)==Lle}var Ile=Rle,q8=Sp&&Sp.isMap,Ole=q8?XE(q8):Ile,Ble=Ole,Nle="[object Set]";function Ule(e){return cl(e)&&E0(e)==Nle}var Fle=Ule,Y8=Sp&&Sp.isSet,zle=Y8?XE(Y8):Fle,kle=zle,Vle=1,Hle=2,Gle=4,FN="[object Arguments]",jle="[object Array]",Wle="[object Boolean]",Xle="[object Date]",qle="[object Error]",zN="[object Function]",Yle="[object GeneratorFunction]",Zle="[object Map]",Qle="[object Number]",kN="[object Object]",Kle="[object RegExp]",$le="[object Set]",Jle="[object String]",ece="[object Symbol]",tce="[object WeakMap]",ice="[object ArrayBuffer]",nce="[object DataView]",rce="[object Float32Array]",sce="[object Float64Array]",ace="[object Int8Array]",oce="[object Int16Array]",lce="[object Int32Array]",cce="[object Uint8Array]",hce="[object Uint8ClampedArray]",uce="[object Uint16Array]",dce="[object Uint32Array]",hi={};hi[FN]=hi[jle]=hi[ice]=hi[nce]=hi[Wle]=hi[Xle]=hi[rce]=hi[sce]=hi[ace]=hi[oce]=hi[lce]=hi[Zle]=hi[Qle]=hi[kN]=hi[Kle]=hi[$le]=hi[Jle]=hi[ece]=hi[cce]=hi[hce]=hi[uce]=hi[dce]=!0;hi[qle]=hi[zN]=hi[tce]=!1;function Hv(e,t,i,n,r,s){var a,o=t&Vle,l=t&Hle,c=t&Gle;if(i&&(a=r?i(e,n,r,s):i(e)),a!==void 0)return a;if(!xa(e))return e;var u=so(e);if(u){if(a=Qoe(e),!o)return Qne(e,a)}else{var h=E0(e),d=h==zN||h==Yle;if(jy(e))return woe(e,o);if(h==kN||h==FN||d&&!r){if(a=l||d?{}:Dle(e),!o)return l?Ooe(e,xoe(a,e)):Doe(e,voe(a,e))}else{if(!hi[h])return r?e:{};a=Tle(e,h,o)}}s||(s=new Vv);var p=s.get(e);if(p)return p;s.set(e,a),kle(e)?e.forEach(function(m){a.add(Hv(m,t,i,m,e,s))}):Ble(e)&&e.forEach(function(m,g){a.set(g,Hv(m,t,i,g,e,s))});var f=c?l?UN:_S:l?YE:qE,v=u?void 0:f(e);return hre(v||e,function(m,g){v&&(g=m,m=e[g]),HE(a,g,Hv(m,t,i,g,e,s))}),a}var VN=Hv,pce=1,fce=4;function mce(e){return VN(e,pce|fce)}var m2=mce,gce="__lodash_hash_undefined__";function vce(e){return this.__data__.set(e,gce),this}var yce=vce;function xce(e){return this.__data__.has(e)}var _ce=xce;function Xy(e){var t=-1,i=e==null?0:e.length;for(this.__data__=new p2;++t<i;)this.add(e[t])}Xy.prototype.add=Xy.prototype.push=yce;Xy.prototype.has=_ce;var bce=Xy;function wce(e,t){for(var i=-1,n=e==null?0:e.length;++i<n;)if(t(e[i],i,e))return!0;return!1}var Sce=wce;function Mce(e,t){return e.has(t)}var Cce=Mce,Ece=1,Ace=2;function Tce(e,t,i,n,r,s){var a=i&Ece,o=e.length,l=t.length;if(o!=l&&!(a&&l>o))return!1;var c=s.get(e),u=s.get(t);if(c&&u)return c==t&&u==e;var h=-1,d=!0,p=i&Ace?new bce:void 0;for(s.set(e,t),s.set(t,e);++h<o;){var f=e[h],v=t[h];if(n)var m=a?n(v,f,h,t,e,s):n(f,v,h,e,t,s);if(m!==void 0){if(m)continue;d=!1;break}if(p){if(!Sce(t,function(g,y){if(!Cce(p,y)&&(f===g||r(f,g,i,n,s)))return p.push(y)})){d=!1;break}}else if(!(f===v||r(f,v,i,n,s))){d=!1;break}}return s.delete(e),s.delete(t),d}var HN=Tce;function Pce(e){var t=-1,i=Array(e.size);return e.forEach(function(n,r){i[++t]=[r,n]}),i}var Dce=Pce;function Lce(e){var t=-1,i=Array(e.size);return e.forEach(function(n){i[++t]=n}),i}var Rce=Lce,Ice=1,Oce=2,Bce="[object Boolean]",Nce="[object Date]",Uce="[object Error]",Fce="[object Map]",zce="[object Number]",kce="[object RegExp]",Vce="[object Set]",Hce="[object String]",Gce="[object Symbol]",jce="[object ArrayBuffer]",Wce="[object DataView]",Z8=Us?Us.prototype:void 0,lb=Z8?Z8.valueOf:void 0;function Xce(e,t,i,n,r,s,a){switch(i){case Wce:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case jce:return!(e.byteLength!=t.byteLength||!s(new Wy(e),new Wy(t)));case Bce:case Nce:case zce:return VE(+e,+t);case Uce:return e.name==t.name&&e.message==t.message;case kce:case Hce:return e==t+"";case Fce:var o=Dce;case Vce:var l=n&Ice;if(o||(o=Rce),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;n|=Oce,a.set(e,t);var u=HN(o(e),o(t),n,r,s,a);return a.delete(e),u;case Gce:if(lb)return lb.call(e)==lb.call(t)}return!1}var qce=Xce,Yce=1,Zce=Object.prototype,Qce=Zce.hasOwnProperty;function Kce(e,t,i,n,r,s){var a=i&Yce,o=_S(e),l=o.length,c=_S(t),u=c.length;if(l!=u&&!a)return!1;for(var h=l;h--;){var d=o[h];if(!(a?d in t:Qce.call(t,d)))return!1}var p=s.get(e),f=s.get(t);if(p&&f)return p==t&&f==e;var v=!0;s.set(e,t),s.set(t,e);for(var m=a;++h<l;){d=o[h];var g=e[d],y=t[d];if(n)var x=a?n(y,g,d,t,e,s):n(g,y,d,e,t,s);if(!(x===void 0?g===y||r(g,y,i,n,s):x)){v=!1;break}m||(m=d=="constructor")}if(v&&!m){var _=e.constructor,b=t.constructor;_!=b&&"constructor"in e&&"constructor"in t&&!(typeof _=="function"&&_ instanceof _&&typeof b=="function"&&b instanceof b)&&(v=!1)}return s.delete(e),s.delete(t),v}var $ce=Kce,Jce=1,Q8="[object Arguments]",K8="[object Array]",f1="[object Object]",ehe=Object.prototype,$8=ehe.hasOwnProperty;function the(e,t,i,n,r,s){var a=so(e),o=so(t),l=a?K8:E0(e),c=o?K8:E0(t);l=l==Q8?f1:l,c=c==Q8?f1:c;var u=l==f1,h=c==f1,d=l==c;if(d&&jy(e)){if(!jy(t))return!1;a=!0,u=!1}if(d&&!u)return s||(s=new Vv),a||EN(e)?HN(e,t,i,n,r,s):qce(e,t,l,i,n,r,s);if(!(i&Jce)){var p=u&&$8.call(e,"__wrapped__"),f=h&&$8.call(t,"__wrapped__");if(p||f){var v=p?e.value():e,m=f?t.value():t;return s||(s=new Vv),r(v,m,i,n,s)}}return d?(s||(s=new Vv),$ce(e,t,i,n,r,s)):!1}var ihe=the;function GN(e,t,i,n,r){return e===t?!0:e==null||t==null||!cl(e)&&!cl(t)?e!==e&&t!==t:ihe(e,t,i,n,GN,r)}var nhe=GN;function rhe(e,t){return e!=null&&t in Object(e)}var she=rhe;function ahe(e,t,i){t=ef(t,e);for(var n=-1,r=t.length,s=!1;++n<r;){var a=f2(t[n]);if(!(s=e!=null&&i(e,a)))break;e=e[a]}return s||++n!=r?s:(r=e==null?0:e.length,!!r&&GE(r)&&kE(a,r)&&(so(e)||WE(e)))}var ohe=ahe;function lhe(e,t){return e!=null&&ohe(e,t,she)}var che=lhe,hhe=function(){return _a.Date.now()},cb=hhe,uhe="Expected a function",dhe=Math.max,phe=Math.min;function fhe(e,t,i){var n,r,s,a,o,l,c=0,u=!1,h=!1,d=!0;if(typeof e!="function")throw new TypeError(uhe);t=E8(t)||0,xa(i)&&(u=!!i.leading,h="maxWait"in i,s=h?dhe(E8(i.maxWait)||0,t):s,d="trailing"in i?!!i.trailing:d);function p(w){var M=n,S=r;return n=r=void 0,c=w,a=e.apply(S,M),a}function f(w){return c=w,o=setTimeout(g,t),u?p(w):a}function v(w){var M=w-l,S=w-c,C=t-M;return h?phe(C,s-S):C}function m(w){var M=w-l,S=w-c;return l===void 0||M>=t||M<0||h&&S>=s}function g(){var w=cb();if(m(w))return y(w);o=setTimeout(g,v(w))}function y(w){return o=void 0,d&&n?p(w):(n=r=void 0,a)}function x(){o!==void 0&&clearTimeout(o),c=0,n=l=r=o=void 0}function _(){return o===void 0?a:y(cb())}function b(){var w=cb(),M=m(w);if(n=arguments,r=this,l=w,M){if(o===void 0)return f(l);if(h)return clearTimeout(o),o=setTimeout(g,t),p(l)}return o===void 0&&(o=setTimeout(g,t)),a}return b.cancel=x,b.flush=_,b}var eA=fhe;function mhe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var ghe=mhe;function vhe(e,t){return t.length<2?e:PN(e,roe(t,0,-1))}var yhe=vhe;function xhe(e,t){return nhe(e,t)}var tA=xhe;function _he(e,t){return t=ef(t,e),e=yhe(e,t),e==null||delete e[f2(ghe(t))]}var bhe=_he;function whe(e){return ioe(e)?void 0:e}var She=whe,Mhe=1,Che=2,Ehe=4,Ahe=LN(function(e,t){var i={};if(e==null)return i;var n=!1;t=yN(t,function(s){return s=ef(s,e),n||(n=s.length>1),s}),ag(e,UN(e),i),n&&(i=VN(i,Mhe|Che|Ehe,She));for(var r=t.length;r--;)bhe(i,t[r]);return i}),MS=Ahe;function The(e,t,i,n){if(!xa(e))return e;t=ef(t,e);for(var r=-1,s=t.length,a=s-1,o=e;o!=null&&++r<s;){var l=f2(t[r]),c=i;if(l==="__proto__"||l==="constructor"||l==="prototype")return e;if(r!=a){var u=o[l];c=n?n(u,l,o):void 0,c===void 0&&(c=xa(u)?u:kE(t[r+1])?[]:{})}HE(o,l,c),o=o[l]}return e}var Phe=The;function Dhe(e,t,i){for(var n=-1,r=t.length,s={};++n<r;){var a=t[n],o=PN(e,a);i(o,a)&&Phe(s,ef(a,e),o)}return s}var Lhe=Dhe;function Rhe(e,t){return Lhe(e,t,function(i,n){return che(e,n)})}var Ihe=Rhe,Ohe=LN(function(e,t){return e==null?{}:Ihe(e,t)}),il=Ohe,Bhe="Expected a function";function Nhe(e,t,i){var n=!0,r=!0;if(typeof e!="function")throw new TypeError(Bhe);return xa(i)&&(n="leading"in i?!!i.leading:n,r="trailing"in i?!!i.trailing:r),eA(e,t,{leading:n,maxWait:t,trailing:r})}var Uhe=Nhe;function Fhe(e){for(let t of Object.keys(e))e[t]===void 0&&delete e[t];return e}function qh(e,t){return Object.setPrototypeOf(e,t),e}var zhe=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().includes(" electron/"),khe=()=>typeof window>"u"?!1:window.navigator.platform.toUpperCase().includes("MAC"),Vhe=()=>typeof window>"u"?!1:/iPad|iPhone|iPod/.test(window.navigator.userAgent)||g2&&"ontouchend"in document,Hhe=()=>typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("firefox")>-1,Ghe=()=>typeof window>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0,jhe=()=>{if(typeof window>"u")return!1;let e=navigator.userAgent,t=navigator.vendor;return/Safari/i.test(e)&&/Apple Computer/.test(t)},Whe=()=>{if(typeof window>"u")return null;let e=navigator.userAgent.match(/Version\/(\d+\.\d)/);return e&&e[1]},Xhe=()=>{if(typeof window>"u")return;let e=new URLSearchParams(window.location.search).get("desktop-app-version");return e?(window.localStorage.setItem("desktop-app-version",e),e):window.localStorage.getItem("desktop-app-version")??"0.0.6"},qhe=zhe();qhe&&Xhe();var g2=khe(),jN=Vhe(),Yhe=Hhe(),ts=Ghe(),J8=jhe(),e9=Number(Whe());function WN(e){return Array.isArray(e)?e:[e]}function Zhe(e,t){let i=0;for(;i<e.length&&i<t.length;){if(e[i]<t[i])return-1;if(e[i]>t[i])return 1;i+=1}return i!==t.length?-1:i!==e.length?1:0}function m1(e){return g2?e.metaKey:e.ctrlKey}var dt=[],qy={},dm={},Gv={};function XN(e){dt.includes(e)||dt.push(e)}function Yd(e){delete qy[e.pointerId];for(let t=0;t<dt.length;t++)if(dt[t].pointerId===e.pointerId){dt.splice(t,1);break}}function Qhe(){dt.splice(0,dt.length)}function Yy(e){if(e.pointerType!=="touch")return;let t=qy[e.pointerId];t===void 0&&(t={x:0,y:0},qy[e.pointerId]=t),t.x=e.pageX,t.y=e.pageY}function hb(e){let t=e.pointerId===dt[0].pointerId?dt[1]:dt[0];return qy[t.pointerId]}function qN(e){dm[e.key]=!0,Gv[e.key]=Gv[e.key]===void 0?1:Gv[e.key]+1}function YN(e){if(g2&&dm.Meta)for(let t in dm)dm[t]=!1;else dm[e.key]=!1;Gv={}}function Khe(e){e.addEventListener("pointerdown",XN,!0),e.addEventListener("pointerdown",Yy,!0),e.addEventListener("pointermove",Yy,!0),e.addEventListener("pointerup",Yd,!0),e.addEventListener("pointercancel",Yd,!0),e.addEventListener("pointerleave",Yd,!0),window.addEventListener("keydown",qN,!0),window.addEventListener("keyup",YN,!0)}function $he(e){e.removeEventListener("pointerdown",XN,!0),e.removeEventListener("pointerdown",Yy,!0),e.removeEventListener("pointermove",Yy,!0),e.removeEventListener("pointerup",Yd,!0),e.removeEventListener("pointercancel",Yd,!0),e.removeEventListener("pointerleave",Yd,!0),window.removeEventListener("keydown",qN,!0),window.removeEventListener("keyup",YN,!0)}var ZN,Jhe=new Promise(e=>{ZN=e}),g1;function eue(){if(g1)return g1;async function e(){let t="https://unpkg.com/@splinetool/navmesh-wasm@0.9.455/build",i=J0(()=>import("./navmesh-0b92f809.js"),[]),[n,r]=await Promise.all([i,fetch(`${t}/navmesh.wasm`).then(o=>o.arrayBuffer())]),s=n.default,a=await s({wasmBinary:r});ZN(a)}return g1=e(),g1}var QN,tue=new Promise(e=>{QN=e}),v1;function iue(){if(v1)return v1;async function e(){let t=await J0(()=>import("./physics-dee4de67.js"),[]);await t.init(),QN(t)}return v1=e(),v1}var Bt=class{modifyById(e,t){let i=this;if(i[e]===void 0)throw new Error("not expected");{let n={...i,[e]:t};return Object.setPrototypeOf(n,Bt.prototype),n}}add(e,t){var i;return((i=this.runOp({type:1,id:e,data:t}))==null?void 0:i.data)??this}runOp(e){let t=this;if(e.type===1){let i=t[e.id],n;i===void 0?n={type:2,id:e.id}:n={type:1,id:e.id,data:i};let{id:r,data:s}=e,a={...t,[r]:s};return Object.setPrototypeOf(a,Bt.prototype),{data:a,actual:e,reverse:n}}else if(e.type===2){let{id:i}=e,n=t[i];if(n===void 0)return null;{let r={...t};return Object.setPrototypeOf(r,Bt.prototype),delete r[i],{data:r,actual:e,reverse:{type:1,id:i,data:n}}}}return null}};function iA(e){if(e.deepFreeze!==void 0){e.deepFreeze(e);return}let t=Object.getOwnPropertyNames(e);for(let i of t){let n=e[i];n&&typeof n=="object"&&iA(n)}return Object.freeze(e)}function nue(e,t){let i=0;for(;i<e.length&&i<t.length;){if(e[i]<t[i])return-1;if(e[i]>t[i])return 1;i+=1}return i!==t.length?-1:i!==e.length?1:0}var KN=class extends Error{};function ub(e){let t={...e};return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}function Kl(e,t,i){if(e===void 0?t===void 0?(e=0,t=10):e=t-10:t===void 0&&(t=e+10),e>t){let s=e;e=t,t=s}let n=[],r=1/(i+1);for(let s=0;s<i;s++){let a=e+(t-e)*(s+.75+Math.random()*.5)*r;n.push(a)}return n}function nA(e){return e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Float32Array||e instanceof Float64Array}function rue(){return typeof process<"u"}function $N(e,t){for(let i of e)t(i.id,i.data)!==!0&&$N(i.children,t)}function JN(e,t){if(t(e.id,e.data)!==!0)for(let i of e.children)JN(i,t)}var Ir=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,Ir.prototype)}deepFreeze(){let e=0;for(;e<this.length;)iA(this[e]),e++}fillCaches0(e,t){this.objCaches.set(e.id,e),this.parentCaches.set(e.id,t);for(let i of e.children)this.fillCaches0(i,e.id)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,this.parentCaches=new Map;for(let e of this)this.fillCaches0(e,null)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}nonExistOrDescendantOf(e,t){if(!this.has(e))return!0;for(;e;){let i=this.parent(e);if(i===t)return!0;e=i}return!1}rootAcestor(e){for(;e;){let t=this.parent(e);if(t)e=t;else return e}return e}isDescendantOf(e,t){for(;e;){let i=this.parent(e);if(i===t)return!0;e=i}return!1}data(e){var t;return(t=this.get(e))==null?void 0:t.data}has(e){return this.childrenOf(e)!==void 0}get(e){return this.fillCaches(),this.objCaches.get(e)}childrenOf(e){var t;return e===null?this:(t=this.get(e))==null?void 0:t.children}traverseFrom(e,t){if(e===null)this.traverse(t);else{let i=this.get(e);i&&JN(i,t)}}traverse(e){$N(this,e)}totalSize(){return this.fillCaches(),this.objCaches.size}parent(e){return this.fillCaches(),this.parentCaches.get(e)}childrenArray(e){return e===null?this:this.get(e).children}modifyById(e,t){if(this.get(e)===void 0)throw new Error("not expected");{let i=this.parent(e),n=this.childrenArray(i),r=n.findIndex(a=>a.id===e);if(r<0)throw new Error("not expected");let s=n[r];return n=[...n],n[r]={...s,data:t},this.modifyArrayBy(i,n)}}modifyArrayBy(e,t){let i=e,n=t;for(;i!==null;){let s=n,a=i;if(i=this.parent(i),i===void 0)throw new Error;n=this.childrenArray(i);let o=n.findIndex(l=>l.id===a);if(o<0)throw new Error;n=[...n],n[o]={...n[o],children:s}}Object.setPrototypeOf(n,Ir.prototype);let r=n;return r.fillCaches(),r}runOp(e){switch(e.type){case 7:return this.addOp(e);case 8:return this.deleteOp(e);case 9:return this.moveOp(e)}return null}checkDuplicatedIdRec({id:e,children:t}){if(this.get(e)!==void 0)return!0;for(let i of t)if(this.checkDuplicatedIdRec(i))return!0;return!1}addOp(e){let{parent:t,fi:i,id:n,data:r,children:s}=e;if(t!==null&&this.get(t)===void 0||this.checkDuplicatedIdRec(e))return null;{let a=t,o=this.childrenArray(a),l={fi:i,id:n,data:r,children:s};return o=[...o,l],o.sort((c,u)=>c.fi-u.fi),e.localIndex=o.indexOf(l),{data:this.modifyArrayBy(a,o),actual:e,reverse:{type:8,id:n}}}}deleteOp(e){let{id:t}=e;if(this.get(t)===null)return null;{let i=this.parent(t);if(i===void 0)return null;let n=this.childrenArray(i),r=n.findIndex(a=>a.id===t);e.localIndex=r,n=[...n];let s=n.splice(r,1)[0];return{data:this.modifyArrayBy(i,n),actual:e,reverse:{type:7,...s,parent:i}}}}moveOp(e){let{parent:t,fi:i,id:n}=e;if(t!==null&&this.get(t)===void 0)return this.deleteOp({type:8,id:n});if(t!==null){let h=t;for(;h!==null;){if(h===void 0)throw new Error;if(h===n)throw new KN("cyclic tree");h=this.parent(h)}}let r=this.parent(n);if(r===void 0)return null;let s=r,a=this.childrenArray(r),o=a.findIndex(h=>h.id===n);a=[...a];let l=a.splice(o,1)[0],c=this.modifyArrayBy(r,a);r=t,a=c.childrenArray(r);let u=l.fi;return l={...l,fi:i},a=[...a,l],a.sort((h,d)=>h.fi-d.fi),e.localIndex=a.indexOf(l),c=c.modifyArrayBy(r,a),{data:c,actual:e,reverse:{type:9,parent:s,fi:u,id:n}}}previous(e,t){if(t===null){let n=this.childrenArray(e);return n.length===0?null:n[n.length-1].id}let i=null;for(let n of this.childrenArray(e)){if(n.id===t)return i;i=n.id}return null}traverseSortNext(e){let t=this.parent(e);if(t!==void 0){let i=this.childrenArray(t),n=i.findIndex(r=>r.id===e)+1;if(n<i.length)return i[n].id;if(t)return this.traverseSortNext(t)}}sortNext(e){let t=this.childrenArray(e);return t.length>0?t[0].id:this.traverseSortNext(e)}traverseSortPrevious(e){let t=this.childrenArray(e);return t.length>0?this.traverseSortPrevious(t[t.length-1].id):e}sortPrevious(e){let t=this.parent(e);if(t!==void 0){let i=this.childrenArray(t),n=i.findIndex(r=>r.id===e)-1;return n>=0?this.traverseSortPrevious(i[n].id):t}}getAllSorted(e){let t=[];for(let i of e){let n=this.getWithSortKey(i.id);n!==void 0&&t.push({...i,...n})}t.sort((i,n)=>nue(i.sortKey,n.sortKey));for(let i of t)delete i.sortKey;return t}getWithSortKey(e){var t=e;let i=[],n=this.get(t),r=n;if(n!==void 0){for(;t;)i.splice(0,0,n.fi),t=this.parent(t),t!==null&&(n=this.get(t));return{...r,sortKey:i}}}insertBeforeHelper(e,t,i){return this.insertAfterHelper(e,this.previous(e,t),i)}insertAfterHelper(e,t,i){let n=this.childrenArray(e);if(t===null){if(n.length===0)return Kl(0,i,i);{let r=n[0].fi;return Kl(r-i,r,i)}}else{let r=this.get(t);if(r===void 0||this.parent(t)!==e)throw new Error("illegal args");let s=n.find(a=>a.fi>r.fi);if(s===void 0){let a=n[n.length-1].fi;return Kl(a,a+i,i)}else return Kl(r.fi,s.fi,i)}}},Zy;(e=>{function t(i,n){if(n.type!==0)return null;if(Array.isArray(i)){let r=n.props,s={},a=[...i],o=!1;if(r)for(let l of Object.keys(r)){let c=parseInt(l);if(isNaN(c))throw new Error("wrong index");s[l]=a[c],a[c]=r[l],o=!0}return o?{data:a,actual:n,reverse:{type:0,props:s}}:null}else{let r=n.props,s={},a={...i},o=!1;if(r)for(let l of Object.keys(r)){s[l]=a[l];let c=r[l];c===void 0?delete a[l]:a[l]=c,o=!0}return o?{data:a,actual:n,reverse:{type:0,props:s}}:null}}e.runOp=t})(Zy||(Zy={}));var yt=class extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,yt.prototype)}deepFreeze(){let e=0;for(;e<this.length;)iA(this[e]),e++}fillCaches0(e){this.objCaches.set(e.id,e)}fillCaches(){if(this.objCaches===void 0){this.objCaches=new Map,Object.getOwnPropertyDescriptor(this,"objCaches").enumerable=!1;for(let e of this)this.fillCaches0(e)}}randomId(){this.fillCaches();let e=Array.from(this.objCaches.keys());if(e.length!==0)return e[Math.max(0,Math.floor(Math.random()*e.length)-1)]}data(e){var t;return(t=this.get(e))==null?void 0:t.data}get(e){return this.fillCaches(),this.objCaches.get(e)}modifyById(e,t){if(this.get(e)===void 0)throw new Error("not expected");{let i=this,n=i.findIndex(s=>s.id===e);if(n<0)throw new Error("not expected");let r=i[n];return i=[...i],i[n]={...r,data:t},this.modifyArrayBy(i)}}modifyArrayBy(e){Object.setPrototypeOf(e,yt.prototype);let t=e;return rue()||t.fillCaches(),t}runOp(e){switch(e.type){case 4:return this.addOp(e);case 5:return this.deleteOp(e);case 6:return this.moveOp(e)}return null}addOp(e){let{fi:t,id:i,data:n}=e,r=this,s={fi:t,id:i,data:n};return r=[...r,s],r.sort((a,o)=>a.fi-o.fi),e.localIndex=r.indexOf(s),{data:this.modifyArrayBy(r),actual:e,reverse:{type:5,id:i}}}deleteOp(e){let{id:t}=e,i=this,n=i.findIndex(s=>s.id===t);if(n===-1)return null;e.localIndex=n,i=[...i];let r=i.splice(n,1)[0];return{data:this.modifyArrayBy(i),actual:e,reverse:{type:4,...r}}}moveOp(e){let{fi:t,id:i}=e,n=this;n=[...n];let r=n.findIndex(o=>o.id===i);if(r===-1)return null;let s=n[r].fi,a={...n[r],fi:t};return n[r]=a,n.sort((o,l)=>o.fi-l.fi),e.localIndex=n.indexOf(a),{data:this.modifyArrayBy(n),actual:e,reverse:{type:6,fi:s,id:i}}}previous(e){if(e===null)return this.length===0?null:this[this.length-1].id;let t=null;for(let i of this){if(i.id===e)return t;t=i.id}return null}insertBeforeHelper(e,t){return this.insertAfterHelper(this.previous(e),t)}insertAfterHelper(e,t){let i=this;if(e===null){if(i.length===0)return Kl(0,t,t);{let n=i[0].fi;return Kl(n-t,n,t)}}else{let n=this.get(e);if(n===void 0)throw new Error("illegal args");let r=i.find(s=>s.fi>n.fi);if(r===void 0){let s=i[i.length-1].fi;return Kl(s,s+t,t)}else return Kl(n.fi,r.fi,t)}}};function Mp(e){return e&&typeof e=="object"&&e instanceof cn}var cn=class{unusedFunOverridesTable(e){}runOp(e){let t=[],i=this,n=0,r={};for(;n<e.path.length;){if(t.push(i),i=i===void 0?void 0:i[e.path[n]],i!==void 0&&!Mp(i))return null;n+=1}i=i?ub(i):new cn;for(let[o,l]of Object.entries(e.props)){let c=i[o];r[o]=c,l===void 0?delete i[o]:i[o]=l}for(;n>0;){if(Object.keys(i).length===0){let o=t[n-1];o&&(i=ub(o),delete i[e.path[n-1]])}else{let o=t[n-1];if(o){let l=ub(o);l[e.path[n-1]]=i,i=l}else{let l=new cn;l[e.path[n-1]]=i,i=l}}n-=1}let s=Object.setPrototypeOf(i,cn.prototype),a={...e,props:r};return{data:s,actual:e,reverse:a}}},vc;(e=>{function t(r,s){return A0(r,s)??r}e.apply=t;function i(r,s){return sA(r,s)}e.merge=i;function n(r,s){let a=0,o=s.path,l=r;for(;a<o.length&&l!==void 0;){if(l=eo.zoomOnce(l,o[a]),l===void 0)return s;if(!Mp(l))return;a+=1}if(l===void 0)return s;if(Mp(l))if(s.type===0){let c={...s.props};for(let u of Object.keys(l))delete c[u];return{...s,props:c}}else if(s.type===1||s.type===4||s.type===7){let c=rA([s],l);return c?(console.log(c),c):s}else return s}e.filterOp=n})(vc||(vc={}));function rA(e,t){if(t===void 0)return;let i=!1,n=e.map(r=>{let s=r.id,a=A0(r.data,t[s]);if(i=i||a!==void 0,a===void 0&&(a=r.data),r.children){let o=rA(r.children,t);return o!==void 0?i=!0:o=r.children,{...r,id:s,data:a,children:o}}else return{...r,id:s,data:a}});if(i)return n}function sue(e,t){if(t===void 0)return;let i=!1,n=e.map(r=>{let s=r.id,a=A0(r.data,t[s]);return i=i||a!==void 0,a===void 0&&(a=r.data),{...r,id:s,data:a}});if(i)return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n}function A0(e,t){if(!Mp(t))return t;if(e instanceof Ir){let i=rA(e,t);return i!==void 0&&Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i}else{if(e instanceof yt)return sue(e,t);if(Array.isArray(e)){let i=!1,n=e.map((r,s)=>{let a=A0(r,t[s]);return i=i||a!==void 0,a===void 0&&(a=r),a});return i?(Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n):void 0}else{if(e instanceof cn)return sA(e,t);if(e&&typeof e=="object"){let i={},n=!1;for(let[r,s]of Object.entries(e)){let a=A0(s,t[r]);n=n||a!==void 0,a===void 0&&(a=s),i[r]=a}return n?(Object.setPrototypeOf(i,Object.getPrototypeOf(e)),i):void 0}}}}function sA(e,t){if(e===void 0)return t;if(t===void 0)return e;if(!Mp(t))return t;if(!Mp(e))return vc.apply(e,t);let i=new Set;for(let r of Object.keys(e))i.add(r);for(let r of Object.keys(t))i.add(r);let n=new cn;for(let r of i){let s=sA(e===void 0?void 0:e[r],t===void 0?void 0:t[r]);n[r]=s}return n}function aue(e,t){let i={cur:[],result:[],len:0};return e=T0(e,t,i)??e,[e,i.result]}function Qy(e,t){return e===null?null:(e.cur[e.len]=t,e.len+=1,e)}function Ky(e){e&&(e.len-=1)}function oue(e){if(e===null)return null;e.result.push(e.cur.slice(0,e.len))}function eU(e,t,i){let n=!1,r=e.map(s=>{let a=s.id,o=t[a];if(o!==void 0&&typeof o=="string"&&(n=!0,a=o,i!==null))throw new Error("not supported");let l=T0(s.data,t,Qy(i,a));Ky(i),n=n||l!==void 0,l===void 0&&(l=s.data);let c=eU(s.children,t,i);return c!==void 0?n=!0:c=s.children,{...s,id:a,data:l,children:c}});if(n)return r}function lue(e,t,i){let n=!1,r=e.map(s=>{let a=s.id,o=t[a];if(o!==void 0&&typeof o=="string"&&(n=!0,a=o,i!==null))throw new Error("not supported");let l=T0(s.data,t,Qy(i,a));return Ky(i),n=n||l!==void 0,l===void 0&&(l=s.data),{...s,id:a,data:l}});if(n)return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r}function T0(e,t,i){if(e instanceof Ir){let n=eU(e,t,i);return n!==void 0&&Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n}else{if(e instanceof yt)return lue(e,t,i);if(Array.isArray(e)){let n=!1,r=e.map((s,a)=>{let o=T0(s,t,Qy(i,a));return Ky(i),n=n||o!==void 0,o===void 0&&(o=s),o});return n?(Object.setPrototypeOf(r,Object.getPrototypeOf(e)),r):void 0}else if(e&&typeof e=="object"&&!nA(e)){let n={},r=!1;for(let[s,a]of Object.entries(e))if(s!=="name"&&s!=="text"){let o=t[s];if(typeof o=="string"){if(i!==null)throw new Error("not supported");r=!0,s=o}let l=T0(a,t,Qy(i,s));Ky(i),r=r||l!==void 0,l===void 0&&(l=a),n[s]=l}else n[s]=a;return r?(Object.setPrototypeOf(n,Object.getPrototypeOf(e)),n):void 0}else if(typeof e=="string"){let n=t[e];return n!==void 0&&oue(i),n}else return}}var CS;(e=>{function t(i,n){let r=eo.zoom(n,i.path);if(typeof r=="object"){let s={};for(let a of Object.keys(i.props))s[a]=r[a];return{...i,props:s}}else return{...i,props:{}}}e.replaceProps=t})(CS||(CS={}));var hr;(e=>{function t(l,c){return{...l,path:l.path.slice(c)}}e.drop=t;function i(l,c){var u;return((u=n(l,c))==null?void 0:u.data)??l}e.applySimple=i;function n(l,c){var d,p;let u=c.path;for(var h=[];;){let f;if(l instanceof cn&&c.type===0&&(f=l.runOp({...c,path:u.slice(h.length)}),f===null&&(f=void 0)),f===void 0&&h.length===u.length&&(l instanceof Ir||l instanceof yt||l instanceof Bt?f=l.runOp(c):f=Zy.runOp(l,c)),f!==void 0)if(f!==null){let g=f.data;for(let y=h.length-1;y>=0;y--){let x=u[y],_=h[y];if(_ instanceof Ir){if(typeof x=="number")throw new Error("illegal arg");g=_.modifyById(x,g)}else if(_ instanceof yt){if(typeof x=="number")throw new Error("illegal arg");g=_.modifyById(x,g)}else if(_ instanceof Bt){if(typeof x=="number")throw new Error("illegal arg");g=_.modifyById(x,g)}else if(_ instanceof cn){let b={..._,[x]:g};g=Object.setPrototypeOf(b,cn.prototype)}else if(typeof _=="object")if(Array.isArray(_)){if(typeof x=="string"&&(x=parseInt(x),isNaN(x)))throw new Error("Invalid path");let b=g;g=[..._],g[x]=b}else g={..._,[x]:g};else return null}return{data:g,actual:{...f.actual,path:u},reverse:{...f.reverse,path:u}}}else return null;let v=u[h.length],m;if(l instanceof Ir){if(typeof v=="number")throw new Error("");m=(d=l.get(v))==null?void 0:d.data}else if(l instanceof yt){if(typeof v=="number")throw new Error("");m=(p=l.get(v))==null?void 0:p.data}else l!==null&&(m=l[v]);if(m!==void 0)h.push(l),l=m;else return null}}e.apply=n;function r(l,c){for(let u=0;u<l.length&&u<c.length;u++)if(l[u]!==c[u])return!0;return!1}e.pathDisjoint=r;function s(l,c){if(l.length!==c.length)return!1;for(let u=0;u<l.length;u++)if(l[u]!==c[u])return!1;return!0}e.pathEq=s;function a(l,c){return r(l.path,c.path)}e.commutative=a;function o(l,c){return l.type===0&&c.type===0&&s(l.path,c.path)?Object.keys(l.props).every(u=>c.props[u]!==void 0):!1}e.subsumed=o})(hr||(hr={}));var ES;(e=>{function t(){return[]}e.empty=t;function i(c,u){let h=[];for(let d of c){let[p,...f]=d.path;p===u&&h.push({...d,path:f})}return h}e.removePrefix=i;function n(c,u){return c.map(h=>({...h,path:[u,...h.path]}))}e.addPrefix=n;function r(c,u){return[...c,...u]}e.concat=r;function s(c,u){return[...c.filter(h=>!u.some(d=>hr.subsumed(h,d))),...u]}e.compress=s;function a(c,u){return c.every(h=>u.every(d=>hr.commutative(h,d)))}e.commutative=a;function o(c,u){for(let h of u){let d=l(c,h);d!==null&&(c=d.data)}return c}e.applyAll=o;function l(c,u){var h=c;let d=[],p=[];for(let f of u)try{if(f.type===3){let v=eo.zoom(h,[...f.path,f.id]),m=hr.apply(h,{...f,type:2});if(m!==null){h=m.data;let[g,y]=aue(h,{[f.id]:v});h=g;for(let x of y){let _=x[x.length-1];x.splice(x.length-1,1),d.push({type:0,path:x,props:{[_]:v}}),p.push({type:0,path:x,props:{[_]:f.id}})}p.push(m.reverse),d.push(m.actual)}}else{let v=hr.apply(h,f);v!==null&&(d.push(v.actual),h=v.data,p.push(v.reverse))}}catch(v){if(v instanceof KN)return null;throw v}return{data:h,actual:d,reverse:p.reverse()}}e.apply=l})(ES||(ES={}));var tU=Symbol(),cue=Symbol(),v2=Symbol(),og=class{reportOp(e,t,i=[]){let n=this;if(t===null)return;n._current=t.data;let r=i;for(;!(n instanceof nU);){let s=n._path,a=n._current;if(s!==""&&r.splice(0,0,s),n=n._parent,n===null)return;n.update(s,a)}n.push(r,e,t.actual,t.reverse)}deleteChildren(e){if(this._children){let t=this._children[e];if(t){let i=t[v2];i&&i(),delete this._children[e]}}}},hue=class extends og{constructor(e,t,i){super(),this._parent=e,this._path=t,this._current=i}update(e,t){if(Array.isArray(this._current)){if(typeof e=="string"&&(e=parseInt(e),isNaN(e)))throw new Error("Invalid path");this._current=[...this._current],this._current[e]=t}else this._current={...this._current,[e]:t}}runOp(e){this.reportOp(e,Zy.runOp(this._current,e),e.path)}},uue=class extends og{constructor(e,t,i){super(),this._parent=e,this._path=t,this._current=i}update(e,t){this._current={...this._current,[e]:t},Object.setPrototypeOf(this._current,Bt.prototype)}runOp(e){this.reportOp(e,this._current.runOp(e))}},iU={get(e,t){if(t===v2)return()=>{e._parent=null};if(t===tU)return e._current;if(t===cue)return e;let{_current:i,_children:n}=e;if(t==="push"&&Array.isArray(i))throw new Error("not supported to expand array");let r=n===void 0?void 0:n[t];if(r!==void 0)return r;let s=i[t],a=y2(e,t,s);return a!==s?(n===void 0&&(n={},e._children=n),n[t]=a,a):s},has(e,t){return t in e._current},ownKeys(e){return Reflect.ownKeys(e._current)},defineProperty(){throw Error("not supported")},getPrototypeOf(e){return Object.getPrototypeOf(e._current)},setPrototypeOf(){throw Error("not supported")},getOwnPropertyDescriptor(e,t){let i=e._current,n=Reflect.getOwnPropertyDescriptor(i,t);return n&&{writable:!0,configurable:!0,enumerable:n.enumerable,value:i[t]}}},due={...iU,set(e,t,i){let n={type:0,props:{[t]:Cn(i)??i}};return e.deleteChildren(t),e.runOp(n),!0},deleteProperty(e,t){let i={type:0,props:{[t]:void 0}};return e.deleteChildren(t),e.runOp(i),!0}},pue={...iU,set(e,t,i){return i===void 0?this.deleteProperty(e,t):(e.deleteChildren(t),e.runOp({type:1,id:t,data:i})),!0},deleteProperty(e,t){return e.runOp({type:2,id:t}),!0}},aA=class extends og{constructor(e,t,i){super(),this._children={},this._parent=e,this._path=t,this._current=i,this[v2]=()=>{this._parent=null}}unproxy(){return this._current}update(e,t){this._current=this._current.modifyById(e,t)}runOp(e){this.reportOp(e,this._current.runOp(e))}randomId(){return this._current.randomId()}isDescendantOf(e,t){return this._current.isDescendantOf(e,t)}childrenOf(e){return this._current.childrenOf(e)}traverse(e){return this._current.traverse(e)}get(e){return this._current.get(e)}parent(e){return this._current.parent(e)}traverse(e){this._current.traverse((t,i)=>{e(t,this.data(t))})}data(e){var a;let{_current:t,_children:i}=this,n=i===void 0?void 0:i[e];if(n!==void 0)return n;let r=(a=t.get(e))==null?void 0:a.data,s=y2(this,e,r);return s!==r?(i===void 0&&(i={},this._children=i),i[e]=s,s):r}add(e,t,i,n,r){this.runOp({type:7,parent:e,fi:t,id:i,data:n,children:r})}move(e,t,i){this.runOp({type:9,parent:e,fi:t,id:i})}insertAfter(e,t,i){let n=this._current.insertAfterHelper(e,t,i.length);for(let r=0;r<i.length;r++){let s=i[r];this.add(e,n[r],s.id,s.data,s.children)}}insertBefore(e,t,i){let n=this._current.insertBeforeHelper(e,t,i.length);for(let r=0;r<i.length;r++){let s=i[r];this.add(e,n[r],s.id,s.data,s.children)}}moveAfter(e,t,i){let n=this._current.insertAfterHelper(e,t,i.length);for(let r=0;r<i.length;r++){let s=i[r];this.move(e,n[r],s)}}moveBefore(e,t,i){let n=this._current.insertBeforeHelper(e,t,i.length);for(let r=0;r<i.length;r++){let s=i[r];this.move(e,n[r],s)}}delete(e){this.deleteChildren(e),this.runOp({type:8,id:e})}sortNext(e){return this._current.sortNext(e)}sortPrevious(e){return this._current.sortPrevious(e)}getAllSorted(e){return this._current.getAllSorted(e)}},oA=class extends og{constructor(e,t,i){super(),this._children={},this._parent=e,this._path=t,this._current=i,this[v2]=()=>{this._parent=null}}unproxy(){return this._current}get length(){return this._current.length}forEach(e){let t=this.length;for(let i=0;i<t;i++){let n=this._current[i].id,r=this._current[i].fi;e(this.data(this._current[i].id),n,r)}}find(e){let t=this.length;for(let i=0;i<t;i++){let n=this._current[i].id;if(e(this.data(n),n))return this.get(n)}}update(e,t){this._current=this._current.modifyById(e,t)}randomId(){return this._current.randomId()}get(e){return{...this._current.get(e),data:this.data(e)}}data(e){var a;let{_current:t,_children:i}=this,n=i===void 0?void 0:i[e];if(n!==void 0)return n;let r=(a=t.get(e))==null?void 0:a.data,s=y2(this,e,r);return s!==r?(i===void 0&&(i={},this._children=i),i[e]=s,s):r}runOp(e){this.reportOp(e,this._current.runOp(e))}add(e,t,i){this.runOp({type:4,fi:e,id:t,data:i})}move(e,t){this.runOp({type:6,fi:e,id:t})}insertAfter(e,t){let i=this._current.insertAfterHelper(e,t.length);for(let n=0;n<t.length;n++){let r=t[n];this.add(i[n],r.id,r.data)}}insertBefore(e,t){let i=this._current.insertBeforeHelper(e,t.length);for(let n=0;n<t.length;n++){let r=t[n];this.add(i[n],r.id,r.data)}}moveAfter(e,t){let i=this._current.insertAfterHelper(e,t.length);for(let n=0;n<t.length;n++){let r=t[n];this.move(i[n],r)}}moveBefore(e,t){let i=this._current.insertBeforeHelper(e,t.length);for(let n=0;n<t.length;n++){let r=t[n];this.move(i[n],r)}}delete(e){this.deleteChildren(e),this.runOp({type:5,id:e})}};function db(e,t,i){if(e.length>0){let n=e[e.length-1];if(n.type===0&&t.type===0&&eo.equal(n.path,i)){Object.assign(n.props,t.props);return}}e.push({...t,path:i})}var nU=class extends og{constructor(e){super(),this.ts=[],this.actual=[],this.reverse=[],this._current=e}update(e,t){if(e!=="")throw new Error("");this._current=t}push(e,t,i,n){db(this.ts,t,e),db(this.actual,i,e),db(this.reverse,n,e)}result(){return{data:this._current,ts:this.ts,actual:this.actual,reverse:this.reverse.reverse()}}};function y2(e,t,i){return i instanceof Ir?new aA(e,t,i):i instanceof yt?new oA(e,t,i):i instanceof Bt?new Proxy(new uue(e,t,i),pue):i!==null&&typeof i=="object"?nA(i)?i:new Proxy(new hue(e,t,i),due):i}function rU(e){let t=new nU(e);return[y2(t,"",e),t]}function P0(e,t){let[i,n]=rU(e);return t(i),n.result()}function Cn(e){return e instanceof aA||e instanceof oA?e._current:e!==null&&typeof e=="object"?e[tU]:e}var eo;(e=>{function t(s,a){if(a.length===s.length)for(var o=0;o<s.length;){if(s[o]!==a[o])return!1;o+=1}else return!1;return!0}e.equal=t;function i(s,a,o){let l=r(o,s);if(l!==void 0&&typeof l=="object"&&l!==null){let c={...a};return Object.keys(l).forEach(u=>{delete c[u]}),c}else return a}e.removeOverridden=i;function n(s,a){if((s instanceof Ir||s instanceof aA)&&typeof a=="string"||(s instanceof yt||s instanceof oA)&&typeof a=="string")return s.data(a);if(typeof a=="number"&&Array.isArray(s)||typeof a=="string"&&typeof s=="object"&&s!==null)return s[a]}e.zoomOnce=n;function r(s,a,o=0){for(;o<a.length&&s!==void 0;)s=n(s,a[o]),o+=1;return s}e.zoom=r})(eo||(eo={}));function fue(e,t){let i=[];if(t.length===e.length)for(var n=0;n<e.length;){if(t[n]==="*")i.push(e[n]);else if(e[n]!==t[n])return null;n+=1}else return null;return i}function Ps(e,t){let i=[];if(t.length<=e.length)for(var n=0;n<t.length;){if(t[n]==="*")i.push(e[n]);else if(e[n]!==t[n])return null;n+=1}else return null;return i}var sU=class{},t9=class extends sU{constructor(e){super(),this.id=e}},i9=class extends sU{constructor(e){super(),this.data=e}},AS;try{AS=new TextDecoder}catch{}var Je,yc,ve=0,Mr={},Gt,$l,Ss=0,Wa=0,Zr,nl,gr=[],Wt,n9={useRecords:!1,mapsAsObjects:!0},aU=class{},oU=new aU;oU.name="MessagePack 0xC1";var Cp=!1,$y=class{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0)),Object.assign(this,e)}unpack(e,t){if(Je)return pU(()=>(PS(),this?this.unpack(e,t):$y.prototype.unpack.call(n9,e,t)));yc=t>-1?t:e.length,ve=0,Wa=0,$l=null,Zr=null,Je=e;try{Wt=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(i){throw Je=null,e instanceof Uint8Array?i:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof $y){if(Mr=this,this.structures)return Gt=this.structures,y1();(!Gt||Gt.length>0)&&(Gt=[])}else Mr=n9,(!Gt||Gt.length>0)&&(Gt=[]);return y1()}unpackMultiple(e,t){let i,n=0;try{Cp=!0;let r=e.length,s=this?this.unpack(e,r):_2.unpack(e,r);if(t){for(t(s);ve<r;)if(n=ve,t(y1())===!1)return}else{for(i=[s];ve<r;)n=ve,i.push(y1());return i}}catch(r){throw r.lastPosition=n,r.values=i,r}finally{Cp=!1,PS()}}_mergeStructures(e,t){e=e||[];for(let i=0,n=e.length;i<n;i++){let r=e[i];r&&(r.isShared=!0,i>=32&&(r.highByte=i-32>>5))}e.sharedLength=e.length;for(let i in t||[])if(i>=0){let n=e[i],r=t[i];r&&(n&&((e.restoreStructures||(e.restoreStructures=[]))[i]=n),e[i]=r)}return this.structures=e}decode(e,t){return this.unpack(e,t)}};function y1(){try{if(!Mr.trusted&&!Cp){let t=Gt.sharedLength||0;t<Gt.length&&(Gt.length=t)}let e=Ti();if(ve==yc)Gt.restoreStructures&&r9(),Gt=null,Je=null,nl&&(nl=null);else if(ve>yc){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}else if(!Cp)throw new Error("Data read, but end of buffer not reached");return e}catch(e){throw Gt.restoreStructures&&r9(),PS(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer"))&&(e.incomplete=!0),e}}function r9(){for(let e in Gt.restoreStructures)Gt[e]=Gt.restoreStructures[e];Gt.restoreStructures=null}function Ti(){let e=Je[ve++];if(e<160)if(e<128){if(e<64)return e;{let t=Gt[e&63]||Mr.getStructures&&lU()[e&63];return t?(t.read||(t.read=lA(t,e&63)),t.read()):e}}else if(e<144)if(e-=128,Mr.mapsAsObjects){let t={};for(let i=0;i<e;i++)t[hU()]=Ti();return t}else{let t=new Map;for(let i=0;i<e;i++)t.set(Ti(),Ti());return t}else{e-=144;let t=new Array(e);for(let i=0;i<e;i++)t[i]=Ti();return t}else if(e<192){let t=e-160;if(Wa>=ve)return $l.slice(ve-Ss,(ve+=t)-Ss);if(Wa==0&&yc<140){let i=t<16?cA(t):cU(t);if(i!=null)return i}return TS(t)}else{let t;switch(e){case 192:return null;case 193:return Zr?(t=Ti(),t>0?Zr[1].slice(Zr.position1,Zr.position1+=t):Zr[0].slice(Zr.position0,Zr.position0-=t)):oU;case 194:return!1;case 195:return!0;case 196:return pb(Je[ve++]);case 197:return t=Wt.getUint16(ve),ve+=2,pb(t);case 198:return t=Wt.getUint32(ve),ve+=4,pb(t);case 199:return Wc(Je[ve++]);case 200:return t=Wt.getUint16(ve),ve+=2,Wc(t);case 201:return t=Wt.getUint32(ve),ve+=4,Wc(t);case 202:if(t=Wt.getFloat32(ve),Mr.useFloat32>2){let i=hA[(Je[ve]&127)<<1|Je[ve+1]>>7];return ve+=4,(i*t+(t>0?.5:-.5)>>0)/i}return ve+=4,t;case 203:return t=Wt.getFloat64(ve),ve+=8,t;case 204:return Je[ve++];case 205:return t=Wt.getUint16(ve),ve+=2,t;case 206:return t=Wt.getUint32(ve),ve+=4,t;case 207:return Mr.int64AsNumber?(t=Wt.getUint32(ve)*4294967296,t+=Wt.getUint32(ve+4)):t=Wt.getBigUint64(ve),ve+=8,t;case 208:return Wt.getInt8(ve++);case 209:return t=Wt.getInt16(ve),ve+=2,t;case 210:return t=Wt.getInt32(ve),ve+=4,t;case 211:return Mr.int64AsNumber?(t=Wt.getInt32(ve)*4294967296,t+=Wt.getUint32(ve+4)):t=Wt.getBigInt64(ve),ve+=8,t;case 212:if(t=Je[ve++],t==114)return c9(Je[ve++]&63);{let i=gr[t];if(i)return i.read?(ve++,i.read(Ti())):i.noBuffer?(ve++,i()):i(Je.subarray(ve,++ve));throw new Error("Unknown extension "+t)}case 213:return t=Je[ve],t==114?(ve++,c9(Je[ve++]&63,Je[ve++])):Wc(2);case 214:return Wc(4);case 215:return Wc(8);case 216:return Wc(16);case 217:return t=Je[ve++],Wa>=ve?$l.slice(ve-Ss,(ve+=t)-Ss):gue(t);case 218:return t=Wt.getUint16(ve),ve+=2,Wa>=ve?$l.slice(ve-Ss,(ve+=t)-Ss):vue(t);case 219:return t=Wt.getUint32(ve),ve+=4,Wa>=ve?$l.slice(ve-Ss,(ve+=t)-Ss):yue(t);case 220:return t=Wt.getUint16(ve),ve+=2,a9(t);case 221:return t=Wt.getUint32(ve),ve+=4,a9(t);case 222:return t=Wt.getUint16(ve),ve+=2,o9(t);case 223:return t=Wt.getUint32(ve),ve+=4,o9(t);default:if(e>=224)return e-256;if(e===void 0){let i=new Error("Unexpected end of MessagePack data");throw i.incomplete=!0,i}throw new Error("Unknown MessagePack token "+e)}}}var mue=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function lA(e,t){function i(){if(i.count++>2){let r=e.read=new Function("r","return function(){return {"+e.map(s=>mue.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"}}")(Ti);return e.highByte===0&&(e.read=s9(t,e.read)),r()}let n={};for(let r=0,s=e.length;r<s;r++){let a=e[r];n[a]=Ti()}return n}return i.count=0,e.highByte===0?s9(t,i):i}var s9=(e,t)=>function(){let i=Je[ve++];if(i===0)return t();let n=e<32?-(e+(i<<5)):e+(i<<5),r=Gt[n]||lU()[n];if(!r)throw new Error("Record id is not defined for "+n);return r.read||(r.read=lA(r,e)),r.read()};function lU(){let e=pU(()=>(Je=null,Mr.getStructures()));return Gt=Mr._mergeStructures(e,Gt)}var TS=x2,gue=x2,vue=x2,yue=x2;function x2(e){let t;if(e<16&&(t=cA(e)))return t;if(e>64&&AS)return AS.decode(Je.subarray(ve,ve+=e));let i=ve+e,n=[];for(t="";ve<i;){let r=Je[ve++];if(!(r&128))n.push(r);else if((r&224)===192){let s=Je[ve++]&63;n.push((r&31)<<6|s)}else if((r&240)===224){let s=Je[ve++]&63,a=Je[ve++]&63;n.push((r&31)<<12|s<<6|a)}else if((r&248)===240){let s=Je[ve++]&63,a=Je[ve++]&63,o=Je[ve++]&63,l=(r&7)<<18|s<<12|a<<6|o;l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|l&1023),n.push(l)}else n.push(r);n.length>=4096&&(t+=xn.apply(String,n),n.length=0)}return n.length>0&&(t+=xn.apply(String,n)),t}function a9(e){let t=new Array(e);for(let i=0;i<e;i++)t[i]=Ti();return t}function o9(e){if(Mr.mapsAsObjects){let t={};for(let i=0;i<e;i++)t[hU()]=Ti();return t}else{let t=new Map;for(let i=0;i<e;i++)t.set(Ti(),Ti());return t}}var xn=String.fromCharCode;function cU(e){let t=ve,i=new Array(e);for(let n=0;n<e;n++){let r=Je[ve++];if((r&128)>0){ve=t;return}i[n]=r}return xn.apply(String,i)}function cA(e){if(e<4)if(e<2){if(e===0)return"";{let t=Je[ve++];if((t&128)>1){ve-=1;return}return xn(t)}}else{let t=Je[ve++],i=Je[ve++];if((t&128)>0||(i&128)>0){ve-=2;return}if(e<3)return xn(t,i);let n=Je[ve++];if((n&128)>0){ve-=3;return}return xn(t,i,n)}else{let t=Je[ve++],i=Je[ve++],n=Je[ve++],r=Je[ve++];if((t&128)>0||(i&128)>0||(n&128)>0||(r&128)>0){ve-=4;return}if(e<6){if(e===4)return xn(t,i,n,r);{let s=Je[ve++];if((s&128)>0){ve-=5;return}return xn(t,i,n,r,s)}}else if(e<8){let s=Je[ve++],a=Je[ve++];if((s&128)>0||(a&128)>0){ve-=6;return}if(e<7)return xn(t,i,n,r,s,a);let o=Je[ve++];if((o&128)>0){ve-=7;return}return xn(t,i,n,r,s,a,o)}else{let s=Je[ve++],a=Je[ve++],o=Je[ve++],l=Je[ve++];if((s&128)>0||(a&128)>0||(o&128)>0||(l&128)>0){ve-=8;return}if(e<10){if(e===8)return xn(t,i,n,r,s,a,o,l);{let c=Je[ve++];if((c&128)>0){ve-=9;return}return xn(t,i,n,r,s,a,o,l,c)}}else if(e<12){let c=Je[ve++],u=Je[ve++];if((c&128)>0||(u&128)>0){ve-=10;return}if(e<11)return xn(t,i,n,r,s,a,o,l,c,u);let h=Je[ve++];if((h&128)>0){ve-=11;return}return xn(t,i,n,r,s,a,o,l,c,u,h)}else{let c=Je[ve++],u=Je[ve++],h=Je[ve++],d=Je[ve++];if((c&128)>0||(u&128)>0||(h&128)>0||(d&128)>0){ve-=12;return}if(e<14){if(e===12)return xn(t,i,n,r,s,a,o,l,c,u,h,d);{let p=Je[ve++];if((p&128)>0){ve-=13;return}return xn(t,i,n,r,s,a,o,l,c,u,h,d,p)}}else{let p=Je[ve++],f=Je[ve++];if((p&128)>0||(f&128)>0){ve-=14;return}if(e<15)return xn(t,i,n,r,s,a,o,l,c,u,h,d,p,f);let v=Je[ve++];if((v&128)>0){ve-=15;return}return xn(t,i,n,r,s,a,o,l,c,u,h,d,p,f,v)}}}}}function pb(e){return Mr.copyBuffers?Uint8Array.prototype.slice.call(Je,ve,ve+=e):Je.subarray(ve,ve+=e)}function Wc(e){let t=Je[ve++];if(gr[t])return gr[t](Je.subarray(ve,ve+=e));throw new Error("Unknown extension type "+t)}var l9=new Array(4096);function hU(){let e=Je[ve++];if(e>=160&&e<192){if(e=e-160,Wa>=ve)return $l.slice(ve-Ss,(ve+=e)-Ss);if(!(Wa==0&&yc<180))return TS(e)}else return ve--,Ti();let t=(e<<5^(e>1?Wt.getUint16(ve):e>0?Je[ve]:0))&4095,i=l9[t],n=ve,r=ve+e-3,s,a=0;if(i&&i.bytes==e){for(;n<r;){if(s=Wt.getUint32(n),s!=i[a++]){n=1879048192;break}n+=4}for(r+=3;n<r;)if(s=Je[n++],s!=i[a++]){n=1879048192;break}if(n===r)return ve=n,i.string;r-=3,n=ve}for(i=[],l9[t]=i,i.bytes=e;n<r;)s=Wt.getUint32(n),i.push(s),n+=4;for(r+=3;n<r;)s=Je[n++],i.push(s);let o=e<16?cA(e):cU(e);return o!=null?i.string=o:i.string=TS(e)}var c9=(e,t)=>{var i=Ti();let n=e;t!==void 0&&(e=e<32?-((t<<5)+e):(t<<5)+e,i.highByte=t);let r=Gt[e];return r&&r.isShared&&((Gt.restoreStructures||(Gt.restoreStructures=[]))[e]=r),Gt[e]=i,i.read=lA(i,n),i.read()},uU=typeof self=="object"?self:global;gr[0]=()=>{};gr[0].noBuffer=!0;gr[101]=()=>{let e=Ti();return(uU[e[0]]||Error)(e[1])};gr[105]=e=>{let t=Wt.getUint32(ve-4);nl||(nl=new Map);let i=Je[ve],n;i>=144&&i<160||i==220||i==221?n=[]:n={};let r={target:n};nl.set(t,r);let s=Ti();return r.used?Object.assign(n,s):(r.target=s,s)};gr[112]=e=>{let t=Wt.getUint32(ve-4),i=nl.get(t);return i.used=!0,i.target};gr[115]=()=>new Set(Ti());var dU=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(e=>e+"Array");gr[116]=e=>{let t=e[0],i=dU[t];if(!i)throw new Error("Could not find typed array for code "+t);return new uU[i](Uint8Array.prototype.slice.call(e,1).buffer)};gr[120]=()=>{let e=Ti();return new RegExp(e[0],e[1])};gr[98]=e=>{let t=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],i=ve;ve+=t-4,Zr=[Ti(),Ti()],Zr.position0=0,Zr.position1=0;let n=ve;ve=i;try{return Ti()}finally{ve=n}};gr[255]=e=>e.length==4?new Date((e[0]*16777216+(e[1]<<16)+(e[2]<<8)+e[3])*1e3):e.length==8?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+((e[3]&3)*4294967296+e[4]*16777216+(e[5]<<16)+(e[6]<<8)+e[7])*1e3):e.length==12?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+((e[4]&128?-281474976710656:0)+e[6]*1099511627776+e[7]*4294967296+e[8]*16777216+(e[9]<<16)+(e[10]<<8)+e[11])*1e3):new Date("invalid");function pU(e){let t=yc,i=ve,n=Ss,r=Wa,s=$l,a=nl,o=Zr,l=new Uint8Array(Je.slice(0,yc)),c=Gt,u=Gt.slice(0,Gt.length),h=Mr,d=Cp,p=e();return yc=t,ve=i,Ss=n,Wa=r,$l=s,nl=a,Zr=o,Je=l,Cp=d,Gt=c,Gt.splice(0,Gt.length,...u),Mr=h,Wt=new DataView(Je.buffer,Je.byteOffset,Je.byteLength),p}function PS(){Je=null,nl=null,Gt=null}function xue(e){e.unpack?gr[e.type]=e.unpack:gr[e.type]=e}var hA=new Array(147);for(let e=0;e<256;e++)hA[e]=+("1e"+Math.floor(45.15-e*.30103));var _2=new $y({useRecords:!1});_2.unpack;_2.unpackMultiple;_2.unpack;var _ue=new Float32Array(1);new Uint8Array(_ue.buffer,0,4);var jv;try{jv=new TextEncoder}catch{}var Jy,uA,b2=typeof Buffer<"u",fb=b2?Buffer.allocUnsafeSlow:Uint8Array,fU=b2?Buffer:Uint8Array,h9=b2?4294967296:2144337920,Be,Bi,Se=0,Sa,Ma=null,bue=/[\u0080-\uFFFF]/,If=Symbol("record-id"),mU=class extends $y{constructor(e){super(e),this.offset=0;let t,i,n,r,s,a=0,o=fU.prototype.utf8Write?function(w,M,S){return Be.utf8Write(w,M,S)}:jv&&jv.encodeInto?function(w,M){return jv.encodeInto(w,Be.subarray(M)).written}:!1,l=this;e||(e={});let c=e&&e.sequential,u=e.structures||e.saveStructures,h=e.maxSharedStructures;if(h==null&&(h=u?32:0),h>8160)throw new Error("Maximum maxSharedStructure is 8160");let d=e.maxOwnStructures;d==null&&(d=u?32:64),c&&!e.saveStructures&&(this.structures=[]);let p=h>32||d+h>64,f=h+64,v=h+d+64;if(v>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let m=[],g=0,y=0;this.pack=this.encode=function(w,M){if(Be||(Be=new fb(8192),Bi=new DataView(Be.buffer,0,8192),Se=0),Sa=Be.length-10,Sa-Se<2048?(Be=new fb(Be.length),Bi=new DataView(Be.buffer,0,Be.length),Sa=Be.length-10,Se=0):Se=Se+7&2147483640,t=Se,s=l.structuredClone?new Map:null,l.bundleStrings?(Ma=["",""],Be[Se++]=214,Be[Se++]=98,Ma.position=Se-t,Se+=4):Ma=null,i=l.structures,i){i.uninitialized&&(i=l._mergeStructures(l.getStructures()));let S=i.sharedLength||0;if(S>h)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+i.sharedLength);if(!i.transitions){i.transitions=Object.create(null);for(let C=0;C<S;C++){let E=i[C];if(!E)continue;let P,I=i.transitions;for(let D=0,L=E.length;D<L;D++){let B=E[D];P=I[B],P||(P=I[B]=Object.create(null)),I=P}I[If]=C+64}a=S}c||(i.nextId=S+64)}n&&(n=!1),r=i||[];try{if(x(w),Ma){Bi.setUint32(Ma.position+t,Se-Ma.position-t);let S=Ma;Ma=null,x(S[0]),x(S[1])}if(l.offset=Se,s&&s.idsToInsert){Se+=s.idsToInsert.length*6,Se>Sa&&b(Se),l.offset=Se;let S=Sue(Be.subarray(t,Se),s.idsToInsert);return s=null,S}return M&Mue?(Be.start=t,Be.end=Se,Be):Be.subarray(t,Se)}finally{if(i){if(y<10&&y++,g>1e4)i.transitions=null,y=0,g=0,m.length>0&&(m=[]);else if(m.length>0&&!c){for(let S=0,C=m.length;S<C;S++)m[S][If]=0;m=[]}if(n&&l.saveStructures){let S=i.sharedLength||h;i.length>S&&(i=i.slice(0,S));let C=Be.subarray(t,Se);return l.saveStructures(i,a)===!1?(l._mergeStructures(l.getStructures()),l.pack(w)):(a=S,C)}}M&Cue&&(Se=t)}};let x=w=>{Se>Sa&&(Be=b(Se));var M=typeof w,S;if(M==="string"){let C=w.length;if(Ma&&C>=8&&C<4096){let I=bue.test(w);Ma[I?0:1]+=w,Be[Se++]=193,x(I?-C:C);return}let E;C<32?E=1:C<256?E=2:C<65536?E=3:E=5;let P=C*3;if(Se+P>Sa&&(Be=b(Se+P)),C<64||!o){let I,D,L,B=Se+E;for(I=0;I<C;I++)D=w.charCodeAt(I),D<128?Be[B++]=D:D<2048?(Be[B++]=D>>6|192,Be[B++]=D&63|128):(D&64512)===55296&&((L=w.charCodeAt(I+1))&64512)===56320?(D=65536+((D&1023)<<10)+(L&1023),I++,Be[B++]=D>>18|240,Be[B++]=D>>12&63|128,Be[B++]=D>>6&63|128,Be[B++]=D&63|128):(Be[B++]=D>>12|224,Be[B++]=D>>6&63|128,Be[B++]=D&63|128);S=B-Se-E}else S=o(w,Se+E,P);S<32?Be[Se++]=160|S:S<256?(E<2&&Be.copyWithin(Se+2,Se+1,Se+1+S),Be[Se++]=217,Be[Se++]=S):S<65536?(E<3&&Be.copyWithin(Se+3,Se+2,Se+2+S),Be[Se++]=218,Be[Se++]=S>>8,Be[Se++]=S&255):(E<5&&Be.copyWithin(Se+5,Se+3,Se+3+S),Be[Se++]=219,Bi.setUint32(Se,S),Se+=4),Se+=S}else if(M==="number")if(w>>>0===w)w<64?Be[Se++]=w:w<256?(Be[Se++]=204,Be[Se++]=w):w<65536?(Be[Se++]=205,Be[Se++]=w>>8,Be[Se++]=w&255):(Be[Se++]=206,Bi.setUint32(Se,w),Se+=4);else if(w>>0===w)w>=-32?Be[Se++]=256+w:w>=-128?(Be[Se++]=208,Be[Se++]=w+256):w>=-32768?(Be[Se++]=209,Bi.setInt16(Se,w),Se+=2):(Be[Se++]=210,Bi.setInt32(Se,w),Se+=4);else{let C;if((C=this.useFloat32)>0&&w<4294967296&&w>=-2147483648){Be[Se++]=202,Bi.setFloat32(Se,w);let E;if(C<4||(E=w*hA[(Be[Se]&127)<<1|Be[Se+1]>>7])>>0===E){Se+=4;return}else Se--}Be[Se++]=203,Bi.setFloat64(Se,w),Se+=8}else if(M==="object")if(!w)Be[Se++]=192;else{if(s){let E=s.get(w);if(E){if(!E.id){let P=s.idsToInsert||(s.idsToInsert=[]);E.id=P.push(E)}Be[Se++]=214,Be[Se++]=112,Bi.setUint32(Se,E.id),Se+=4;return}else s.set(w,{offset:Se-t})}let C=w.constructor;if(C===Object)_(w,!0);else if(C===Array){S=w.length,S<16?Be[Se++]=144|S:S<65536?(Be[Se++]=220,Be[Se++]=S>>8,Be[Se++]=S&255):(Be[Se++]=221,Bi.setUint32(Se,S),Se+=4);for(let E=0;E<S;E++)x(w[E])}else if(C===Map){S=w.size,S<16?Be[Se++]=128|S:S<65536?(Be[Se++]=222,Be[Se++]=S>>8,Be[Se++]=S&255):(Be[Se++]=223,Bi.setUint32(Se,S),Se+=4);for(let[E,P]of w)x(E),x(P)}else{for(let E=0,P=Jy.length;E<P;E++){let I=uA[E];if(w instanceof I){let D=Jy[E];if(D.write){D.type&&(Be[Se++]=212,Be[Se++]=D.type,Be[Se++]=0),x(D.write.call(this,w));return}let L=Be,B=Bi,j=Se;Be=null;let z;try{z=D.pack.call(this,w,O=>(Be=L,L=null,Se+=O,Se>Sa&&b(Se),{target:Be,targetView:Bi,position:Se-O}),x)}finally{L&&(Be=L,Bi=B,Se=j,Sa=Be.length-10)}z&&(z.length+Se>Sa&&b(z.length+Se),Se=wue(z,Be,Se,D.type));return}}_(w,!w.hasOwnProperty)}}else if(M==="boolean")Be[Se++]=w?195:194;else if(M==="bigint"){if(w<BigInt(1)<<BigInt(63)&&w>=-(BigInt(1)<<BigInt(63)))Be[Se++]=211,Bi.setBigInt64(Se,w);else if(w<BigInt(1)<<BigInt(64)&&w>0)Be[Se++]=207,Bi.setBigUint64(Se,w);else if(this.largeBigIntToFloat)Be[Se++]=203,Bi.setFloat64(Se,Number(w));else throw new RangeError(w+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");Se+=8}else if(M==="undefined")this.encodeUndefinedAsNil?Be[Se++]=192:(Be[Se++]=212,Be[Se++]=0,Be[Se++]=0);else if(M==="function")x(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+M)},_=this.useRecords===!1?this.variableMapSize?w=>{let M=Object.keys(w),S=M.length;S<16?Be[Se++]=128|S:S<65536?(Be[Se++]=222,Be[Se++]=S>>8,Be[Se++]=S&255):(Be[Se++]=223,Bi.setUint32(Se,S),Se+=4);let C;for(let E=0;E<S;E++)x(C=M[E]),x(w[C])}:(w,M)=>{Be[Se++]=222;let S=Se-t;Se+=2;let C=0;for(let E in w)(M||w.hasOwnProperty(E))&&(x(E),x(w[E]),C++);Be[S+++t]=C>>8,Be[S+t]=C&255}:w=>{let M=Object.keys(w),S,C=r.transitions||(r.transitions=Object.create(null)),E=0;for(let I=0,D=M.length;I<D;I++){let L=M[I];S=C[L],S||(S=C[L]=Object.create(null),E++),C=S}let P=C[If];if(P)P>=96&&p?(Be[Se++]=((P-=96)&31)+96,Be[Se++]=P>>5):Be[Se++]=P;else{P=r.nextId,P||(P=64),P<f&&this.shouldShareStructure&&!this.shouldShareStructure(M)?(P=r.nextOwnId,P<v||(P=f),r.nextOwnId=P+1):(P>=v&&(P=f),r.nextId=P+1);let I=M.highByte=P>=96&&p?P-96>>5:-1;C[If]=P,r[P-64]=M,P<f?(M.isShared=!0,r.sharedLength=P-63,n=!0,I>=0?(Be[Se++]=(P&31)+96,Be[Se++]=I):Be[Se++]=P):(I>=0?(Be[Se++]=213,Be[Se++]=114,Be[Se++]=(P&31)+96,Be[Se++]=I):(Be[Se++]=212,Be[Se++]=114,Be[Se++]=P),E&&(g+=y*E),m.length>=d&&(m.shift()[If]=0),m.push(C),x(M))}for(let I=0,D=M.length;I<D;I++)x(w[M[I]])},b=w=>{let M;if(w>16777216){if(w-t>h9)throw new Error("Packed buffer would be larger than maximum buffer size");M=Math.min(h9,Math.round(Math.max((w-t)*(w>67108864?1.25:2),4194304)/4096)*4096)}else M=(Math.max(w-t<<2,Be.length-1)>>12)+1<<12;let S=new fb(M);return Bi=new DataView(S.buffer,0,M),Be.copy?Be.copy(S,0,t,w):S.set(Be.slice(t,w)),Se-=t,t=0,Sa=S.length-10,Be=S}}useBuffer(e){Be=e,Bi=new DataView(Be.buffer,Be.byteOffset,Be.byteLength),Se=0}};uA=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,aU];Jy=[{pack(e,t,i){let n=e.getTime()/1e3;if((this.useTimestamp32||e.getMilliseconds()===0)&&n>=0&&n<4294967296){let{target:r,targetView:s,position:a}=t(6);r[a++]=214,r[a++]=255,s.setUint32(a,n)}else if(n>0&&n<17179869184){let{target:r,targetView:s,position:a}=t(10);r[a++]=215,r[a++]=255,s.setUint32(a,e.getMilliseconds()*4e6+(n/1e3/4294967296>>0)),s.setUint32(a+4,n)}else if(isNaN(n)){if(this.onInvalidDate)return t(0),i(this.onInvalidDate());let{target:r,targetView:s,position:a}=t(3);r[a++]=212,r[a++]=255,r[a++]=255}else{let{target:r,targetView:s,position:a}=t(15);r[a++]=199,r[a++]=12,r[a++]=255,s.setUint32(a,e.getMilliseconds()*1e6),s.setBigInt64(a+4,BigInt(Math.floor(n)))}}},{pack(e,t,i){let n=Array.from(e),{target:r,position:s}=t(this.structuredClone?3:0);this.structuredClone&&(r[s++]=212,r[s++]=115,r[s++]=0),i(n)}},{pack(e,t,i){let{target:n,position:r}=t(this.structuredClone?3:0);this.structuredClone&&(n[r++]=212,n[r++]=101,n[r++]=0),i([e.name,e.message])}},{pack(e,t,i){let{target:n,position:r}=t(this.structuredClone?3:0);this.structuredClone&&(n[r++]=212,n[r++]=120,n[r++]=0),i([e.source,e.flags])}},{pack(e,t){this.structuredClone?u9(e,16,t):d9(b2?Buffer.from(e):new Uint8Array(e),t)}},{pack(e,t){let i=e.constructor;i!==fU&&this.structuredClone?u9(e,dU.indexOf(i.name),t):d9(e,t)}},{pack(e,t){let{target:i,position:n}=t(1);i[n]=193}}];function u9(e,t,i,n){let r=e.byteLength;if(r+1<256){var{target:s,position:a}=i(4+r);s[a++]=199,s[a++]=r+1}else if(r+1<65536){var{target:s,position:a}=i(5+r);s[a++]=200,s[a++]=r+1>>8,s[a++]=r+1&255}else{var{target:s,position:a,targetView:o}=i(7+r);s[a++]=201,o.setUint32(a,r+1),a+=4}s[a++]=116,s[a++]=t,s.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),a)}function d9(e,t){let i=e.byteLength;var n,r;if(i<256){var{target:n,position:r}=t(i+2);n[r++]=196,n[r++]=i}else if(i<65536){var{target:n,position:r}=t(i+3);n[r++]=197,n[r++]=i>>8,n[r++]=i&255}else{var{target:n,position:r,targetView:s}=t(i+5);n[r++]=198,s.setUint32(r,i),r+=4}n.set(e,r)}function wue(e,t,i,n){let r=e.length;switch(r){case 1:t[i++]=212;break;case 2:t[i++]=213;break;case 4:t[i++]=214;break;case 8:t[i++]=215;break;case 16:t[i++]=216;break;default:r<256?(t[i++]=199,t[i++]=r):r<65536?(t[i++]=200,t[i++]=r>>8,t[i++]=r&255):(t[i++]=201,t[i++]=r>>24,t[i++]=r>>16&255,t[i++]=r>>8&255,t[i++]=r&255)}return t[i++]=n,t.set(e,i),i+=r,i}function Sue(e,t){let i,n=t.length*6,r=e.length-n;for(t.sort((s,a)=>s.offset>a.offset?1:-1);i=t.pop();){let s=i.offset,a=i.id;e.copyWithin(s+n,s,r),n-=6;let o=s+n;e[o++]=214,e[o++]=105,e[o++]=a>>24,e[o++]=a>>16&255,e[o++]=a>>8&255,e[o++]=a&255,r=s}return e}function nf(e){if(e.Class){if(!e.pack&&!e.write)throw new Error("Extension has no pack or write function");if(e.pack&&!e.type)throw new Error("Extension has no type (numeric code to identify the extension)");uA.unshift(e.Class),Jy.unshift(e)}xue(e)}var gU=new mU({useRecords:!1});gU.pack;gU.pack;var Mue=512,Cue=1024,p9=new mU({structuredClone:!0});nf({Class:Bt.prototype.constructor,type:1,write(e){return{...e}},read(e){return Object.setPrototypeOf(e,Bt.prototype),e}});nf({Class:yt.prototype.constructor,type:2,write(e){return[...e]},read(e){return Object.setPrototypeOf(e,yt.prototype),e}});nf({Class:Ir.prototype.constructor,type:3,write(e){return[...e]},read(e){return Object.setPrototypeOf(e,Ir.prototype),e}});nf({Class:t9.prototype.constructor,type:4,write(e){return e.id},read(e){return new t9(e)}});nf({Class:i9.prototype.constructor,type:5,write(e){return e.data},read(e){return new i9(e)}});nf({Class:cn.prototype.constructor,type:6,write(e){return{...e}},read(e){return Object.setPrototypeOf(e,cn.prototype),e}});function Eue(e){var t=0;if(e.length===0)return t;for(let i=0;i<e.length;i++){let n=e[i];t=(t<<5)-t+n,t=t&t}return t}function DS(e){if(nA(e))return e;if(Array.isArray(e))return e.map(DS);if(typeof e=="object"&&e!==null){let t={};for(let i of Object.keys(e).sort())t[i]=DS(e[i]);return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}else return e}var LS;(e=>{function t(r){return p9.pack(r)}e.serialize=t;function i(r){return p9.unpack(r)}e.deserialize=i;function n(r){return Eue(t(DS(r))).toString()}e.checksum=n})(LS||(LS={}));var Ca={LookAt:[],Follow:["Create"],DragDrop:["Transition","Animation","Audio","Create"],MouseHover:["Transition","Animation","Create","Destroy","SwitchCamera","SceneTransition"],Scroll:["Transition","Animation","Create"],Start:["Transition","Animation","Audio","Video","Create","Destroy","SwitchCamera","SceneTransition"],Conditional:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],MouseDown:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],MouseUp:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],MousePress:["Transition","Animation","Audio","Video","Link","Create","SwitchCamera","SceneTransition","Reset"],KeyDown:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],KeyUp:["Transition","Animation","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],KeyPress:["Transition","Animation","Audio","Video","Link","Create","SwitchCamera","Reset"],GameControl:["Transition","Animation","Audio","Video","Create"],Collision:["Transition","Animation","Audio","Video","Create","Destroy","Reset"],Trigger:["Transition","Audio","Video","Link","Create","Destroy","SwitchCamera","SceneTransition","Reset"],Resize:["Transition","Animation","Audio","Video","Create","Destroy","SwitchCamera","SceneTransition","Reset"]},f9;(e=>{function t(n){return n.type==="MouseDown"||n.type==="MouseUp"||n.type==="MousePress"||n.type==="KeyDown"||n.type==="KeyUp"||n.type==="KeyPress"}e.is=t;function i(n){return n==="MouseDown"||n==="MouseUp"||n==="MousePress"?{type:n,mode:"Object",disabled:!1,toggle:!1,actions:new yt}:{type:n,disabled:!1,key:void 0,toggle:!1,actions:new yt}}e.defaultData=i})(f9||(f9={}));var ex;(e=>{function t(i){return{type:"Property",value:[i??null,"position","x"]}}e.propertyDefaultData=t,e.valueDefaultData={type:"Literal",value:0}})(ex||(ex={}));var RS;(e=>{function t(r){return{type:"Comparison",operator:"==",lOperand:ex.propertyDefaultData(r),rOperand:{...ex.valueDefaultData}}}e.comparisonDefaultData=t;function i(r){return{type:"Distance",toObject:r??null,fromObject:r??null,distance:200}}e.distanceDefaultData=i;function n(r,s){return{type:"State",object:r??null,state:s??null}}e.stateDefaultData=n})(RS||(RS={}));var m9;(e=>{function t(n){return n.type==="Conditional"}e.is=t;function i(n){return{type:"Conditional",disabled:!1,inActions:new yt,outActions:new yt,condition:RS.distanceDefaultData(n)}}e.defaultData=i})(m9||(m9={}));var g9;(e=>e.defaultData={type:"DragDrop",cursor:"hand",disabled:!1,dampingFactor:1,objects:[],snapTo:"center",snapSurfaceMode:"bbox",snapSurfaceOffset:0,dropOn:"all",autoOrient:!0,dropDestinations:[],plane:"adaptive",planeMode:"locked",referenceFrame:"global",limits:[-1/0,1/0,-1/0,1/0,-1/0,1/0],drop:!1,resetOnSnapFail:!1,snapSpeed:20,resetSpeed:20,dragDropActions:{drag:new yt,drop:new yt}})(g9||(g9={}));var IS;(e=>e.defaultData={type:"Follow",disabled:!1,maxDelta:0,dampingFactor:1,target:"cursor",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledTranslation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5,actions:new yt})(IS||(IS={}));var OS;(e=>e.defaultData={type:"LookAt",disabled:!1,distance:1e3,dampingFactor:1,target:"cursor",tilt:"up",axis:"z",plane:"custom",resetOnPointerLeave:!0,resetAfterDistanceLimit:!0,enabledRotation:[!0,!0,!0],limitDistanceEnabled:!1,limitDistance:1e3,snapDelay:0,resetSpeed:5})(OS||(OS={}));var v9;(e=>{function t(n){return n.type==="MouseHover"}e.is=t;function i(){return{type:"MouseHover",disabled:!1,actions:new yt}}e.defaultData=i})(v9||(v9={}));var y9;(e=>{function t(n){return n.type==="Scroll"}e.is=t;function i(){return{type:"Scroll",disabled:!1,steps:100,trigger:"load",startFrom:"enter",enterAnchor:"top",startOffset:0,endAfter:400,actions:new yt}}e.defaultData=i})(y9||(y9={}));var x9;(e=>{function t(n){return n.type==="Start"}e.is=t;function i(){return{type:"Start",disabled:!1,actions:new yt}}e.defaultData=i})(x9||(x9={}));var _9;(e=>{function t(n){return n.type==="Collision"}e.is=t;function i(){return{type:"Collision",disabled:!1,toggle:!1,target:"character",actions:new yt}}e.defaultData=i})(_9||(_9={}));var b9;(e=>{function t(n){return n.type==="Trigger"}e.is=t;function i(n,r){return{type:"Trigger",disabled:!1,toggle:!1,target:"all",triggeringObjects:[],actions:new yt,triggerZone:"box",position:r.toArray(),rotation:[0,0,0],size:n.toArray(),radius:n.length()/2,helperVisible:!0}}e.defaultData=i})(b9||(b9={}));var BS;(e=>{e.defaultSizes={mobile:[480,480],tablet:[768,768],desktop:[1200,1200],custom:[769,1200]};function t(a){return a.type==="Resize"}e.is=t;function i(a){return typeof a=="string"?a:"custom"}e.sizeToDevice=i;function n(a){return typeof a=="string"?[...e.defaultSizes[a]]:[...a]}e.deviceToSize=n;function r(){let a={size:"mobile",operator:"<",actions:new yt},o={size:"tablet",operator:"<",actions:new yt},l={size:[...e.defaultSizes.custom],operator:"<>",actions:new yt},c=new yt;return c.push({id:Dt.generateUUID(),fi:0,data:a},{id:Dt.generateUUID(),fi:1,data:o},{id:Dt.generateUUID(),fi:2,data:l}),{type:"Resize",disabled:!1,orientation:"horizontal",breakpoints:c}}e.defaultData=r;function s(){return{size:[...e.defaultSizes.custom],operator:"<>",actions:new yt}}e.defaultBreakpointData=s})(BS||(BS={}));var rf="personal camera",km="a218fcc3-276b-49b9-b485-49037fd14f5f",Aue=2960946,Fs=5526619,Bd;(e=>{function t(n,r){return n[0]===r[0]&&n[1]===r[1]}e.isEqual=t;function i(n,r,s){return[n[0]+(r[0]-n[0])*s,n[1]+(r[1]-n[1])*s]}e.lerp=i})(Bd||(Bd={}));var Dh;(e=>{function t(l,c){return l[0]===c[0]&&l[1]===c[1]&&l[2]===c[2]}e.isEqual=t;function i(l,c){return[l[0]+c[0],l[1]+c[1],l[2]+c[2]]}e.add=i;function n(l,c){return[l[0]-c[0],l[1]-c[1],l[2]-c[2]]}e.sub=n;function r(l,c){return[l[0]/c[0],l[1]/c[1],l[2]/c[2]]}e.div=r;function s(l,c){return[l[0]*c[0],l[1]*c[1],l[2]*c[2]]}e.mul=s;function a(l,c){return Math.hypot(l[0]-c[0],l[1]-c[1],l[2]-c[2])}e.dist=a;function o(l,c,u){return[l[0]+(c[0]-l[0])*u,l[1]+(c[1]-l[1])*u,l[2]+(c[2]-l[2])*u]}e.lerp=o})(Dh||(Dh={}));var tx;(e=>{function t(n,r){return n[0]===r[0]&&n[1]===r[1]&&n[2]===r[2]&&n[3]===r[3]}e.isEqual=t;function i(n,r,s){return[n[0]+(r[0]-n[0])*s,n[1]+(r[1]-n[1])*s,n[2]+(r[2]-n[2])*s,n[3]+(r[3]-n[3])*s]}e.lerp=i})(tx||(tx={}));var Ep;(e=>{e.identity=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function t(r,s){for(let a=0;a<16;a++)if(r[a]!==s[a])return!1;return!0}e.isEqual=t;function i(r){return r??e.identity}e.simplify=i;function n(r,s){let a=s.slice(0);for(var o=0,l=s.length;o<l;o+=3){let c=r[3]*s[o]+r[7]*s[o+1]+r[11]*s[o+2]+r[15];a[o]=(r[0]*s[o]+r[4]*s[o+1]+r[8]*s[o+2]+r[12])/c,a[o+1]=(r[1]*s[o]+r[5]*s[o+1]+r[9]*s[o+2]+r[13])/c,a[o+2]=(r[2]*s[o]+r[6]*s[o+1]+r[10]*s[o+2]+r[14])/c}return a}e.applyMatrix4=n})(Ep||(Ep={}));var sr;(e=>{function t(l){return typeof l=="object"&&typeof l.r=="number"&&typeof l.g=="number"&&typeof l.b=="number"}e.isRGB=t,e.white={r:1,g:1,b:1},e.red={r:1,g:0,b:0},e.black={r:0,g:0,b:0};function i(l){return{r:Math.round(l.r*255),g:Math.round(l.g*255),b:Math.round(l.b*255),a:1}}e.toRgb255a1=i;function n(l){return{r:l.r,g:l.g,b:l.b}}e.clone=n;function r(l){return l=Math.floor(l),{r:(l>>16&255)/255,g:(l>>8&255)/255,b:(l&255)/255}}e.fromHex=r;function s(l){return Math.round(l.r*255)*65536+Math.round(l.g*255)*256+Math.round(l.b*255)}e.toHex=s;function a(l,c){return l.r===c.r&&l.g===c.g&&l.b===c.b}e.equals=a;function o(l,c,u){return{r:l.r+(c.r-l.r)*u,g:l.g+(c.g-l.g)*u,b:l.b+(c.b-l.b)*u}}e.lerp=o})(sr||(sr={}));var la;(e=>{e.white={...sr.white,a:1},e.transparent={...sr.white,a:0};function t(a){return{r:a[0],g:a[1],b:a[2],a:a[3]}}e.from0to1=t;function i(a,o){return{...sr.fromHex(a),a:o}}e.fromHexAndA=i;function n(a){return{r:Math.round(a.r*255),g:Math.round(a.g*255),b:Math.round(a.b*255),a:a.a}}e.toRgb255a1=n;function r(a,o){return sr.equals(a,o)&&a.a===o.a}e.equals=r;function s(a,o,l){return{r:a.r+(o.r-a.r)*l,g:a.g+(o.g-a.g)*l,b:a.b+(o.b-a.b)*l,a:a.a+(o.a-a.a)*l}}e.lerp=s})(la||(la={}));var NS;(e=>e.identity={position:[0,0,0],rotation:[0,0,0],scale:[1,1,1]})(NS||(NS={}));var w9;(e=>e.defaultData={mass:1,stiffness:80,damping:10,velocity:0})(w9||(w9={}));var S9;(e=>e.defaultData={control1:[.5,0],control2:[.5,1]})(S9||(S9={}));var kl;(e=>(e.linear=[0,0,1,1],e.ease=[.25,.1,.25,1],e.easeIn=[.42,0,1,1],e.easeOut=[0,0,.58,1],e.easeInOut=[.42,0,.58,1]))(kl||(kl={}));var Yh;(e=>{e.all=["PerspectiveCamera","OrthographicCamera"];function t(i){return e.all.includes(i)}e.is=t})(Yh||(Yh={}));var Ap;(e=>{e.DefaultUp=[0,1,0],e.DefaultTargetOffset=1e3,e.defaultData={far:1e5,type:"OrthographicCamera",perspective:{near:70,fov:45,zoom:1},orthographic:{near:-1e5,zoom:1},up:e.DefaultUp,isUpVectorFlipped:!1,targetOffset:e.DefaultTargetOffset};function t(i){return i.type==="PerspectiveCamera"?i.perspective.zoom:i.orthographic.zoom}e.getZoom=t})(Ap||(Ap={}));var Jl;(e=>{function t(n,r=.1){return{disabled:!1,type:"linear",hideBase:!1,count:3,radial:{radius:Math.max(n[0],n[1])*2,start:0,end:360,alignment:!1,axis:"y",scale:[1,1,1],rotation:[0,0,0],position:[0,0,0]},toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},linear:{scale:[1,1,1],rotation:[0,0,0],position:[n[0]+n[0]*r,0,0]},grid:{count:[2,2,2],size:n.map(s=>s*(1+r)),useCenter:!0},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}}}e.defaultData=t;function i(n,r){let s={...n};if(vU.forEach(a=>{Object.assign(s,{[a]:r[a]??n[a]})}),s.radial={...n.radial},r.radial){let a=n.radial,o=r.radial;yU.forEach(l=>{Object.assign(s.radial,{[l]:o[l]??a[l]})})}if(s.linear={...n.linear},r.linear){let a=n.linear,o=r.linear;xU.forEach(l=>{Object.assign(s.linear,{[l]:o[l]??a[l]})})}if(s.grid={...n.grid},r.grid){let a=n.grid,o=r.grid;_U.forEach(l=>{Object.assign(s.grid,{[l]:o[l]??a[l]})})}if(s.toObject={...n.toObject},r.toObject){let a=n.toObject,o=r.toObject;bU.forEach(l=>{Object.assign(s.toObject,{[l]:o[l]??a[l]})})}if(s.randomnessObject={...n.randomnessObject},r.randomnessObject){let a=n.randomnessObject,o=r.randomnessObject;wU.forEach(l=>{Object.assign(s.randomnessObject,{[l]:o[l]??a[l]})})}return s}e.merge=i})(Jl||(Jl={}));var US;(e=>{e.defaultData={radial:{},linear:{},grid:{},toObject:{},randomnessObject:{}};let t=["radial","linear","grid","toObject","randomnessObject"];function i(n,r){let s=[];n.count!==void 0&&s.push({type:0,path:r,props:{count:n.count}});for(let a of t){let o=n[a];o&&Object.keys(o).length>0&&s.push({type:0,path:[...r,a],props:o})}return s}e.toOps=i})(US||(US={}));var vU=["count"],yU=["radius","start","end","position","scale","rotation"],xU=["position","scale","rotation"],_U=["count","size"],bU=["count","position","scale","rotation"],wU=["strength","scale","rotation","position","movement","seed","freqScale"],FS;(e=>{e.all=["PointLight","SpotLight","DirectionalLight","HemisphereLight"];function t(i){return e.all.includes(i)}e.is=t})(FS||(FS={}));var zS;(e=>{function t(n){return i(n)}e.defaultData=t;function i(n){if(n==="PointLight")return{type:n,color:la.white,intensity:1,distance:2e3,decay:1,shadows:!0,shadowResolution:1024,shadowRadius:1,penumbraSize:.5,depth:1e5};if(n==="SpotLight")return{type:n,color:la.white,intensity:1,distance:2e3,decay:1,shadows:!0,penumbra:0,angle:30/180*Math.PI,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};if(n==="DirectionalLight")return{type:n,color:la.white,intensity:1,shadows:!0,size:2e3,depth:1e5,penumbraSize:.5,shadowResolution:1024,shadowRadius:1};throw new Error("not implemented")}})(zS||(zS={}));var Tp;(e=>e.defaultData={enabled:"visibility",fusedBody:!0,rigidBody:"positioned",density:1,pointMass:0,gravityScale:1,friction:.5,damping:0,restitution:.2,colliderType:"convex",enabledRotation:[!0,!0,!0],enabledTranslation:[!0,!0,!0]})(Tp||(Tp={}));var kS;(e=>{e.defaultData={castShadow:!0,receiveShadow:!0};function t(i,n){return i.castShadow===n.castShadow&&i.receiveShadow===n.receiveShadow}e.equals=t})(kS||(kS={}));var VS;(e=>{e.defaultData={flatShading:!1,wireframe:!1,side:0};function t(i,n){return i.flatShading===n.flatShading&&i.side===n.side&&i.wireframe===n.wireframe}e.equals=t})(VS||(VS={}));var HS;(e=>e.defaultData={...VS.defaultData,...kS.defaultData})(HS||(HS={}));var M9;(e=>{function t(i,n){var s,a;let r=[];if("material"in i){let o=typeof i.material=="string"?n.materials[i.material]??((s=n.lib.materials[i.material])==null?void 0:s.asset):i.material;o&&r.push(o)}else if("materials"in i)for(let o of i.materials){let l=typeof o=="string"?n.materials[o]??((a=n.lib.materials[o])==null?void 0:a.asset):o;l&&r.push(l)}return r}e.getMaterialData=t})(M9||(M9={}));var ix;(e=>(e.defaultVideo={data:"",thumb:"/_assets/_videos/catThumb.png",type:"video",name:"Cat video"},e.maxSize=3e7))(ix||(ix={}));var C9;(e=>{function t(i){return i==="texture"||i==="video"||i==="color"||i==="depth"||i==="normal"||i==="gradient"||i==="noise"||i==="fresnel"||i==="rainbow"||i==="toon"||i==="outline"||i==="transmission"||i==="matcap"||i==="displace"||i==="pattern"||i==="light"}e.is=t})(C9||(C9={}));function Tue(e){return e.type!=="displace"}var E9;(e=>{function t(i){return i==="phong"||i==="toon"||i==="lambert"||i==="physical"}e.is=t})(E9||(E9={}));var SU=["mode","gradientType","noiseType","displacementType","projection","cnormal","crop","axis","side"],Pue=["wrapping","image","video","name"],wr;(e=>{function t(s,a){let{texture:o,...l}=a;if(Object.assign(s,l),o){let c=s.texture;c&&Object.assign(c,o)}}e.patch=t;function i(s,a){return s==="light"&&a?n(a):r(s)}e.defaultData=i;function n(s){let a={mode:0,isMask:!1,visible:!0,bumpMap:void 0,bumpMapIntensity:5,roughnessMap:void 0,alphaOverride:1};switch(s){case"phong":return{...a,category:"phong",specular:{r:.2,g:.2,b:.2},shininess:5,type:"light",visible:!0,mode:0,occlusion:!0,alpha:.6};case"toon":return{...a,category:"toon",specular:{r:.2,g:.2,b:.2},shininess:10,type:"light",alpha:1};case"lambert":return{...a,category:"lambert",emissive:{r:0,g:0,b:0},type:"light",alpha:1,visible:!0,mode:0,occlusion:!0};case"physical":return{...a,category:"physical",roughness:.2,metalness:.2,reflectivity:.2,type:"light",alpha:1,visible:!0,mode:0,occlusion:!0}}}function r(s){let a={alpha:1,mode:0,isMask:!1,visible:!0};switch(s){case"texture":return{...a,type:"texture",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{image:"image_0",wrapping:1e3,repeat:[1,1],offset:[0,0]},crop:!1};case"video":return{...a,type:"video",size:[128,128],blending:0,axis:"x",side:2,projection:0,texture:{video:ix.defaultVideo,wrapping:1001,repeat:[1,1],offset:[0,0]},crop:!1};case"color":return{...a,type:"color",color:sr.fromHex(Fs)};case"depth":return{...a,type:"depth",gradientType:1,smooth:!1,isVector:!0,isWorldSpace:!1,origin:[0,0,0],direction:[1,0,0],colors:[[1,1,1,1],[0,0,0,1]],steps:[0,1],near:50,far:200};case"normal":return{...a,type:"normal",cnormal:[1,1,1]};case"gradient":return{...a,type:"gradient",gradientType:0,smooth:!1,colors:[[0,0,0,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,1,1,1,1,1,1,1,1,1],num:2,angle:0,offset:[0,0],morph:[0,0]};case"noise":return{...a,type:"noise",size:[100,100,100],noiseType:0,scale:1,move:1,colorA:{...sr.fromHex(6710886),a:1},colorB:{...sr.fromHex(6710886),a:1},colorC:{...sr.fromHex(16777215),a:1},colorD:{...sr.fromHex(16777215),a:1},distortion:[1,1],fA:[1.7,9.2],fB:[8.3,2.8],voronoiStyle:0,highCut:1,lowCut:0,smoothness:.3,seed:0,quality:1};case"fresnel":return{...a,type:"fresnel",color:la.fromHexAndA(16777215,1),bias:.1,scale:1,intensity:2,factor:1};case"rainbow":return{...a,type:"rainbow",filmThickness:30,movement:0,wavelengths:[0,0,0],noiseStrength:0,noiseScale:1,offset:[0,0,0]};case"toon":return{...a,type:"toon",positioning:2,colors:[[0,0,0,1],[.5,.5,.5,1],[.5,.5,.5,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],steps:[0,.475,.525,1,1,1,1,1,1,1],num:4,source:[0,1e3,0],isWorldSpace:!0,noiseStrength:0,noiseScale:1,shadowColor:la.fromHexAndA(0,0),offset:[0,0,0]};case"outline":return{...a,type:"outline",outlineColor:la.fromHexAndA(0,1),contourColor:la.fromHexAndA(0,1),outlineWidth:2,contourWidth:5,outlineThreshold:.4,contourThreshold:0,outlineSmoothing:0,contourFrequency:10,contourDirection:[0,1,0],positionalLines:!1,compensation:!0};case"matcap":return{...a,type:"matcap",texture:{image:"matcap_0",wrapping:1001,repeat:[1,1],offset:[0,0]}};case"transmission":return{...a,type:"transmission",thickness:10,ior:1.5,roughness:1};case"displace":return{visible:!0,type:"displace",displacementType:"noise",noiseType:0,scale:10,movement:1,offset:[0,0,0],intensity:8,voronoiStyle:0,smoothness:.3,seed:0,highCut:1,lowCut:0,quality:1};case"pattern":return{...a,type:"pattern",style:0,projection:0,axis:"y",blending:0,offset:[0,0],colorA:{...sr.fromHex(0),a:1},colorB:{...sr.fromHex(16777215),a:1},frequency:[10,10],size:.5,variation:0,smoothness:.5,zigzag:0,rotation:0,vertical:[0,1],horizontal:[0,1],sides:6}}}})(wr||(wr={}));var Xn;(e=>{function t(c){return!c.layers.some(u=>u.data.type==="texture"&&u.data.projection!==0||u.data.type==="depth"&&!u.data.isWorldSpace||u.data.type==="noise"||u.data.type==="displace")}e.isMergable=t;function i(c){let u="";return c.layers.forEach(h=>{Object.entries(h.data).forEach(([d,p])=>{u+=`${d}${p}`,Array.isArray(p)?p.forEach(f=>u+=`${f}`):typeof p=="object"?Object.values(p).forEach(f=>{typeof f=="number"?u+=`${f.toFixed(4)}`:u+=`${f}`}):u+=`${p}`})}),u}e.getHash=i;function n(){return{layers:new yt}}e.defaultEmptyData=n;function r(c="layer1",u="layer2"){return a("phong",c,u)}e.defaultData=r;function s(c,u){return{...c,name:u}}e.withName=s;function a(c,u="layer1",h="layer2"){let d=new yt;return d.push({fi:0,data:wr.defaultData("light",c),id:u}),d.push({fi:1,data:wr.defaultData("color"),id:h}),{layers:d}}e.defaultTwoLayerData=a;function o(c,u="phong",h="layer1",d="layer2"){let p=wr.defaultData("texture");Object.assign(p.texture,{image:c});let f=new yt;return f.push({fi:0,data:p,id:h}),f.push({fi:1,data:wr.defaultData("light",u),id:d}),{layers:f}}e.defaultTwoLayerTextureData=o;function l(c,u="phong",h="layer1",d="layer2"){let p=wr.defaultData("video");Object.assign(p.texture,{video:c});let f=new yt;return f.push({fi:0,data:p,id:h}),f.push({fi:1,data:wr.defaultData("light",u),id:d}),{layers:f}}e.defaultTwoLayerVideoTextureData=l})(Xn||(Xn={}));var nx;(e=>{function t(){return{points:new yt,roundness:0,shapeHoles:[],isClosed:!1}}e.defaultData=t})(nx||(nx={}));var rx;(e=>{function t(){return{points:new yt,lastInsertionPlane:null,subdivisions:12,isClosed:!1}}e.defaultData=t})(rx||(rx={}));var MU={type:"Ellipse",width:50,height:50,spikes:16,angle:360,innerRadius:0},GS;(e=>{function t(i,n){let r={...i};return EU.forEach(s=>{Object.assign(r,{[s]:n[s]??i[s]})}),r}e.merge=t})(GS||(GS={}));var CU={shape:MU,depth:1,offset:0,bevel:50,bevelSides:6,angle:0,twist:0,startScale:1,endScale:1,capType:"flat"},EU=["depth","offset","angle","twist","startScale","endScale"],sx;(e=>{function t(n){return n==="PolygonGeometry"||n==="RectangleGeometry"||n==="StarGeometry"||n==="TriangleGeometry"||n==="EllipseGeometry"}e.is2DParametricMesh=t;function i(n){return n==="PolygonGeometry"||n==="PolygonGeometry"||n==="RectangleGeometry"||n==="StarGeometry"||n==="TriangleGeometry"||n==="EllipseGeometry"||n==="PathGeometry"||n==="VectorGeometry"||n==="ConeGeometry"||n==="CubeGeometry"||n==="CylinderGeometry"||n==="DodecahedronGeometry"||n==="HelixGeometry"||n==="IcosahedronGeometry"||n==="LatheGeometry"||n==="PyramidGeometry"||n==="SphereGeometry"||n==="PlaneGeometry"||n==="BackdropGeometry"||n==="TorusGeometry"||n==="TorusKnotGeometry"||n==="BooleanGeometry"||n==="TextGeometry"}e.isParametricMesh=i})(sx||(sx={}));var jS;(e=>{function t(i,n){let r={...i};return Object.assign(r,n),r.type==="PathGeometry"&&"extrusion"in n&&n.extrusion&&(r.extrusion={...i.extrusion},Object.assign(r.extrusion,GS.merge(r.extrusion,n.extrusion))),r}e.merge=t})(jS||(jS={}));var Zd;(e=>{function t(i){if(i==="RectangleGeometry")return{width:320,height:320,type:i,cornerRadius:[0,0,0,0],cornerType:0,depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(i==="PathGeometry")return{type:i,width:1,height:1,depth:1,path:rx.defaultData(),extrusion:CU};if(i==="VectorGeometry")return{width:1,height:1,type:i,subdivisions:12,shape:nx.defaultData(),depth:0,extrudeBevelSize:0,extrudeBevelSegments:1};if(i==="BooleanGeometry")return{type:i,operation:2,width:0,height:0,depth:0,phongAngle:35};if(i==="TextGeometry")return{type:i,width:100,height:100,depth:0,horizontalAlign:1,verticalAlign:1,fontSize:16,lineHeight:1.2,letterSpacing:0,text:"",textTransform:1,font:"Roboto_regular",extrudeBevelSize:0,extrudeBevelSegments:1};if(i==="SphereGeometry")return{type:"SphereGeometry",width:100,height:100,depth:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI};throw new Error("not implemented")}e.defaultData=t})(Zd||(Zd={}));var A9=["width","height","depth"],WS;(e=>e.defaultData={enabled:!1,useBackgroundColor:!1,color:sr.white,near:.1,far:2e3})(WS||(WS={}));var ax;(e=>{let t={opacity:1,blendFunction:13,enabled:!1};e.defaultData={enabled:!1,pixelation:{...t,blendFunction:16,granularity:15},bloom:{...t,blendFunction:16,intensity:1,blurScale:1,luminanceThreshold:.25,luminanceSmoothing:.025,kernelSize:3},chromaticAberration:{...t,offset:[2,2]},vignette:{...t,darkness:1,offset:0},hueSaturation:{...t,hue:3,saturation:0},brightnessContrast:{...t,brightness:.25,contrast:0},depthOfField:{...t,focalLength:2,focusDistance:2,bokehScale:2},noise:{...t,blendFunction:16}}})(ax||(ax={}));var XS;(e=>e.defaultData={softShadowQuality:"low"})(XS||(XS={}));var qS;(e=>e.defaultData={enabled:!0,color:{r:.8274509803921568,g:.8274509803921568,b:.8274509803921568},intensity:.75})(qS||(qS={}));var YS;(e=>e.defaultData={occlusion:!1,aoFullRes:!1,radius:256,bias:.5,aoColor:{r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}})(YS||(YS={}));var Pp;(e=>e.defaultData={usePhysics:!1,gravity:-10})(Pp||(Pp={}));var ZS;(e=>e.defaultData={playCamera:rf,gameControlObject:null})(ZS||(ZS={}));var QS;(e=>e.defaultData={backgroundColor:la.fromHexAndA(Aue,1),postprocessing:ax.defaultData,fog:WS.defaultData,globalPhysics:Pp.defaultData,ambient:qS.defaultData,ao:YS.defaultData,shadow:XS.defaultData,publish:ZS.defaultData})(QS||(QS={}));var T9;(e=>{function t(n){return n==="Component"||n==="Instance"}e.isComponentRelated=t;function i(n){return n==="Empty"||n==="Instance"}e.isEmptyOrComponent=i})(T9||(T9={}));var Dp;(e=>{e.identity={...NS.identity,hiddenMatrix:Ep.identity};function t(r){return{position:r.position,rotation:r.rotation,scale:r.scale,hiddenMatrix:r.hiddenMatrix}}e.fromObject=t;function i(r,s){return{position:(s==null?void 0:s.position)||r.position,rotation:(s==null?void 0:s.rotation)||r.rotation,scale:(s==null?void 0:s.scale)||r.scale,hiddenMatrix:(s==null?void 0:s.hiddenMatrix)||r.hiddenMatrix}}e.merge=i;function n(r,s){return Fhe({position:Dh.isEqual(r.position,s.position)?void 0:s.position,rotation:Dh.isEqual(r.rotation,s.rotation)?void 0:s.rotation,scale:Dh.isEqual(r.scale,s.scale)?null:s.scale,hiddenMatrix:Ep.isEqual(r.hiddenMatrix,s.hiddenMatrix)?void 0:s.hiddenMatrix})}e.diff=n})(Dp||(Dp={}));var fr;(e=>e.defaultData={states:new yt,events:new yt,visible:!0,raycastLock:!1,physics:Tp.defaultData,pathSnapping:{pathId:null,slide:0,offset:0,orientation:"tangential"},...Dp.identity,cloner:null})(fr||(fr={}));var KS;(e=>e.defaultData={type:"Empty",...fr.defaultData})(KS||(KS={}));var P9;(e=>e.defaultData={type:"Component",...fr.defaultData})(P9||(P9={}));var Qd;(e=>e.defaultData={type:"Mesh",...fr.defaultData,...HS.defaultData})(Qd||(Qd={}));var D0;(e=>e.defaultData={...fr.defaultData,...Dp.identity,position:[0,0,Ap.DefaultTargetOffset],...Ap.defaultData})(D0||(D0={}));var $S;(e=>{function t(i){return{...fr.defaultData,...zS.defaultData(i)}}e.defaultData=t,e.defaultDirectionalLightData={...e.defaultData("DirectionalLight"),position:[200,300,300],name:"Directional Light",intensity:.7}})($S||($S={}));var ox;(e=>{function t(n,r,s=0){for(;s<r.length;){let a=n?n[r[s]]:void 0;if(r.length===s+1)return a;if(a)n=a.descendants,s+=1;else return}}e.resolveWithDes=t;function i(n,r,s=0){let a=t(n,r,s);if(a){let o=Object.keys(a);if(o.length===1&&o[0]==="descendants")return}return a}e.resolve=i})(ox||(ox={}));var ec;(e=>{e.rootOverrideProps=["physics","events"],e.compositeNonOptionalOverrideProps=["geometry"],e.compositeEntireOverrideOverrideProps=["material"];function t(n,r){return{...fr.defaultData,...r,component:n,overrides:new cn,physics:void 0,events:void 0,type:"Instance"}}e.ofComponent=t;function i(n){let r=Dp.fromObject(n.data);return t(n.id,r)}e.fromComponentData=i})(ec||(ec={}));var Lp;(e=>e.defaultData={type:"Page",...fr.defaultData,physics:{...Tp.defaultData,fusedBody:!1},...QS.defaultData,camera:D0.defaultData})(Lp||(Lp={}));var JS;(e=>(e.defaultCamera={position:[0,0,1e3],scale:[1,1,1],rotation:[0,0,0],hiddenMatrix:Ep.identity,name:"Play Camera",visible:!0,raycastLock:!1,physics:Tp.defaultData,states:new yt,events:new yt,cloner:null,pathSnapping:{pathId:null,orientation:"tangential",slide:0,offset:0},...Ap.defaultData},e.KeysByResetCategory={States:["states"],Events:["events"],Material:["material","materials"],Geometry:["geometry"],Position:["position"],Rotation:["rotation"],Scale:["scale"],Transform:["position","scale","rotation","hiddenMatrix"],Name:["name"],Visibility:["visible","raycastLock","flatShading","wireframe","side"],Shadows:["castShadow","receiveShadow"],Cloner:["cloner"],Physics:["physics"]},e.defaultMeshObject={name:"Rectangle",...fr.defaultData,...Qd.defaultData,geometry:Zd.defaultData("RectangleGeometry"),material:Xn.defaultTwoLayerData("phong","layer1","layer2")},e.defaultBooleanObject={name:"Boolean",...fr.defaultData,...Qd.defaultData,geometry:Zd.defaultData("BooleanGeometry"),material:Xn.defaultTwoLayerData("phong","layer1","layer2")},e.defaultTextObject={name:"Text",...fr.defaultData,...Qd.defaultData,geometry:Zd.defaultData("TextGeometry"),material:Xn.defaultTwoLayerData("phong","layer1","layer2")}))(JS||(JS={}));var _h;(e=>{function t(s,a){let o={name:a};return s.type==="Mesh"?(o.geometry={},"material"in s&&(o.material={layers:new cn}),"materials"in s&&(o.materials=s.materials.map(l=>({layers:new cn})))):Yh.is(s.type)&&(o.perspective={},o.orthographic={}),o}e.newEmpty=t;function i(s,a){if(a===void 0)return s;let o={...s};return"material"in o&&"material"in a&&a.material&&(o.material=P0(o.material,l=>{if(typeof l!="string")for(let[c,u]of Object.entries(a.material.layers)){let h=l.layers.data(c);h&&wr.patch(h,u)}}).data),o.materials&&a.materials&&(o.materials=P0(o.materials,l=>{var c,u;for(let h=0;h<o.materials.length;h++){let d=a.materials[h];if(typeof d!="string")for(let[p,f]of Object.entries(d.layers)){let v=(u=(c=l[h])==null?void 0:c.layers)==null?void 0:u.data(p);v&&wr.patch(v,f)}}}).data),o}function n(s,a){let o,l=[],c={orthographic:0,perspective:0,geometry:0};function u(h,d){for(let[p,f]of Object.entries(d.layers)){let{texture:v,...m}=f;if(v!==void 0&&Object.keys(v).length>0){let g={path:[...h,"layers",p,"texture"],props:v,type:0};l.push(g)}if(Object.keys(m).length>0){let g={path:[...h,"layers",p],props:m,type:0};l.push(g)}}}for(let[h,d]of Object.entries(a))if(h!=="name")if(h==="cloner")l.push(...US.toOps(d,["cloner"]));else if(h==="pathSnapping")l.push({path:[h],props:{slide:d.slide,offset:d.offset},type:0});else if(h==="material")u(["material"],d);else if(h==="materials")for(let[p,f]of Object.entries(d))u(["materials",p],f);else if(c[h]===0){if(h==="geometry"&&d.extrusion!==void 0){let p={path:[h,"extrusion"],props:d.extrusion,type:0};l.push(p),d={...d},delete d.extrusion}if(Object.keys(d).length>0){let p={path:[h],props:d,type:0};l.push(p)}}else o===void 0&&(o={path:[],props:{},type:0},l.push(o)),o.props[h]=d;return l}e.toOps=n;function r(s,a){var l,c,u,h,d,p;if(a===void 0)return s;let o={...s};if(Object.assign(o,Dp.merge(o,a)),Object.assign(o,{pathSnapping:Object.assign({},o.pathSnapping,{slide:((l=a.pathSnapping)==null?void 0:l.slide)??((c=o.pathSnapping)==null?void 0:c.slide)??0,offset:((u=a.pathSnapping)==null?void 0:u.offset)??((h=o.pathSnapping)==null?void 0:h.offset)??0})}),Yh.is(s.type)){o.orthographic={...o.orthographic},o.perspective={...o.perspective};let f=a;((d=f.orthographic)==null?void 0:d.zoom)!==void 0&&(o.orthographic.zoom=f.orthographic.zoom),((p=f.perspective)==null?void 0:p.zoom)!==void 0&&(o.perspective.zoom=f.perspective.zoom),f.isUpVectorFlipped!==void 0&&(o.isUpVectorFlipped=f.isUpVectorFlipped),f.targetOffset!==void 0&&(o.targetOffset=f.targetOffset)}else if(s.type==="Mesh")"geometry"in a&&Object.assign(o,{geometry:jS.merge(o.geometry,a.geometry)}),(a.material||a.materials)&&(o=i(o,a)),o.cloner&&"cloner"in a&&Object.assign(o,{cloner:Jl.merge(o.cloner,a.cloner)});else if(s.type==="Empty")o.cloner&&"cloner"in a&&Object.assign(o,{cloner:Jl.merge(o.cloner,a.cloner)});else if(FS.is(s.type)){let f=a;f.intensity!==void 0&&(o.intensity=f.intensity),f.color!==void 0&&(typeof f.color=="string"?o.color=f.color:o.color=sr.clone(f.color))}return o}e.patch=r})(_h||(_h={}));var lx;(e=>e.defaultData={enablePan:!0,enableZoom:!0,enableRotate:!0,enableDamping:!0,rotationLimitsMode:0,rotationVerticalOffset:{min:Math.PI/4,max:Math.PI/4},rotationHorizontalOffset:{min:Math.PI/4,max:Math.PI/4},rotationSoftLimit:2,panLimitsMode:0,panVerticalOffset:{min:250,max:250},panHorizontalOffset:{min:250,max:250},panSoftLimit:2,zoomLimitsEnabled:!1,zoomLimits:{min:.1,max:2},autoRotate:!1,autoRotateSpeed:2,autoRotateClockwise:!0,hoverRotatePanMode:0,hoverRotatePanStrength:20,isTouchZoom:!0,orbitTouches:2,panTouches:3,resetHoverEffectOnPointerLeave:!0})(lx||(lx={}));var Lh;(e=>e.defaultData={orbitControls:lx.defaultData,playPage:km,withBackground:!0,preventScroll:!1,preventTouchScroll:!1,hideCursor:!1,mouseEventTarget:"canvas",joystickSizeAndXYOffset:Array(12).fill(0).map((t,i)=>{let n=0,r=0;return i<5?r=-30:i<10&&(r=30),i===0||i===10||i===5?n=30:(i===4||i===11||i===9)&&(n=-30),[120,[n,r],"show"]}),settings:{image:{format:"jpg",ratio:1},video:{format:"mp4",imageFormat:"jpg",fps:30,mbps:80,ratio:Math.max(1,typeof window<"u"?Math.floor(window.devicePixelRatio):1),stopMode:"manual",duration:5e3},web:{logo:!0,compress:!0,preset:1,preload:!0,hint:!1}},stopRaycast:!0,hdTransmission:!1})(Lh||(Lh={}));var eM;(e=>e.defaultData={id:"basic",label:"Basic",style:"None",prompt:""})(eM||(eM={}));var tM;(e=>e.defaultData={weather:0,shadows:0,lightOrigin:0,temperature:0,sun:0,camera:0,environment:0,particles:0,nature:0,floor:0})(tM||(tM={}));var Kd;(e=>(e.defaultData=()=>({mode:"line-art-both",prompt:"",negativePrompt:"",style:{...eM.defaultData},isRandomSeed:!0,seed:e.generateSeed(),guessMode:!1,advanced:!1,steps:20,guidanceScale:7.5,controlNetScale:1,modifiers:tM.defaultData}),e.generateSeed=()=>Math.round(Math.random()*1e5)))(Kd||(Kd={}));var L0;(e=>{function t(n){return n.find(r=>r.data.type==="Page"&&r.data.globalPhysics.usePhysics)!==void 0}e.physicsEnabled=t;function i(n,r,s){n.scene.objects.traverseFrom(r,(a,o)=>{var l;if(o.type==="Instance"){let c=(l=ux.getComponentData(n,o.component))==null?void 0:l.data;c&&s(a,o,c.events)}else s(a,o,o.events)})}e.traverseModuleInstances=i})(L0||(L0={}));var $d;(e=>{e.TRASH_CAN_ID="830a2708-8ed9-49cf-a68e-085299892222";function t(r={withLight:!0,withSquare:!0}){let s=[],a=JS.defaultMeshObject;r.withLight===!0&&s.push({fi:-1,data:$S.defaultDirectionalLightData,id:"830a2708-8ed9-49cf-a68e-085299899103",children:[]}),r.withSquare===!0&&s.push({fi:1,id:"7ba78968-2a55-48f2-b14c-5191da3e075e",data:a,children:[]});let o=new Ir;return o.push({fi:1,id:km,data:{...Lp.defaultData,name:"Scene 1"},children:s}),o}e.defaultData={objects:t(),publish:Lh.defaultData,styles:Kd.defaultData()},e.emptyDataWithoutPage=function(){return{objects:new Ir,publish:Lh.defaultData,styles:Kd.defaultData()}},e.emptyDataWithPage=function(r){return{objects:t(r),publish:Lh.defaultData,styles:Kd.defaultData()}};function i(r){return{...e.defaultData,objects:qh(r,Ir.prototype)}}e.withObjs=i;function n(r,s){return i([{id:r,data:s,children:[],fi:0}])}e.withObj=n})($d||($d={}));var Vm;(e=>e.defaultData={preset:"fullscreen",allowResponsive:!1,size:[512,512],coords:[0,0],sceneScale:1,color:{r:0,g:0,b:0,a:.5}})(Vm||(Vm={}));var cx;(e=>e.emptyImage={data:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVQYV2NgYAAAAAMAAWgmWQ0AAAAASUVORK5CYII=",name:"empty"})(cx||(cx={}));var iM;(e=>e.all=["images","videos","colors","audios","fonts","materials"])(iM||(iM={}));var D9;(e=>e.all=[...iM.all,"components"])(D9||(D9={}));var L9;(e=>{function t(){return{images:new Bt,videos:new Bt,colors:new Bt,audios:new Bt,fonts:new Bt,materials:new Bt,components:new Bt}}e.defaultData=t})(L9||(L9={}));var R0;(e=>{function t(){return{images:new Bt,videos:new Bt,colors:new Bt,audios:new Bt,fonts:new Bt,materials:new Bt,components:new Bt}}e.defaultData=t})(R0||(R0={}));var Ho;(e=>{function t(){let r={};return r["89b10010-844c-11ec-a8a3-0242ac120002"]={r:.5,g:.5,b:.5,a:1,name:"Default Color"},qh(r,Bt.prototype)}e.defaultColors=t;function i(r){let s={};return r!=null&&r.withAITexture&&(s["a1b10010-844c-a8a3-11ec-0242ac2011ec"]={...cx.emptyImage,name:"AI generated image"}),qh(s,Bt.prototype)}e.defaultImages=i;function n(){return{catelogs:new Bt,materials:new Bt,images:new Bt,videos:new Bt,colors:new Bt,audios:new Bt,fonts:new Bt,lib:R0.defaultData()}}e.emptyData=n})(Ho||(Ho={}));var nM;(e=>e.list=["idle","move","jump","run"])(nM||(nM={}));var hx;(e=>(e.defaultColliderData={type:"capsule",height:200,radius:50,position:[0,0,0],rotation:[0,0,0]},e.defaultDataThirdPerson={moveMode:"walk",forwardDirection:"+z",speedTranslate:1e3,speedRotate:100,runMultiplier:2,rotationMode:"normal",rotBy:"keys",rotByTouch:"drag",delayPos:[.3,.3],delayRot:[.3,.3],keyAssignments:[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","▲"],["rotPosY","◀"],["rotNegX","▼"],["rotNegY","▶"],["jump","Space"],["run","⇧"],["none","Ctrl"]],touchControl:!0,joystickPosLoc:5,joystickRotLoc:11,jumpTouchButtonLoc:9,collider:e.defaultColliderData,colliderHelperVisible:!0,collisionEnabled:!0,jumpPower:100,resetYPosition:3e3,alignToGround:!1,autoOrientMove:!0,orientWith:"camera",orientMode:"radial",delayPosCamera:.3,delayRotCamera:.3,camera:"",cameraXAxis:"Limit",cameraYAxis:"Free",cameraRotXLimits:[0,Math.PI/2],cameraRotYLimits:[-Math.PI/2,Math.PI/2],gameActions:{idle:new yt,move:new yt,jump:new yt,run:new yt},navmesh:{enabled:!1,ch:6,cs:6,walkableClimb:5,walkableHeight:1,walkableRadius:0,zones:"all",objects:[],helperVisible:!0,destinationHelperRadius:0,destinationHelperColor:la.fromHexAndA(3728051,1)}}))(hx||(hx={}));function R9(e){e.layers.forEach(t=>{if(t.type==="depth"&&t.colorA!==void 0){let i=t.colorA,n=t.colorB,r=[[i.r,i.g,i.b,i.a],[n.r,n.g,n.b,n.a]],s=[0,1];for(let o=2;o<10;o++)r.push(r[1]),s.push(1);let a={...il(Cn(t),"type","visible","isVector","isWorldSpace","origin","alpha","mode"),near:Math.max(0,t.near),far:Math.max(0,t.far),colors:r,steps:s,num:2,direction:[1,0,0],smooth:!1,gradientType:1};Object.assign(t,a)}else if(t.type==="depth"&&t.gradientType===1&&(t.near<0||t.far<0)){let i={...Cn(t),near:Math.max(t.near,0),far:Math.max(t.far,0)};Object.assign(t,i)}})}function jl(e,t){Object.values(e.shared.materials).forEach(i=>t(i))}function Wl(e,t){e.scene.objects.traverse((i,n)=>{"materials"in n?n.materials.forEach((r,s)=>{r===void 0&&(n.materials[s]=Xn.defaultData(),r=n.materials[s]),typeof r!="string"&&t(r)}):"material"in n?typeof n.material!="string"&&(n.material===void 0&&(n.material=Xn.defaultData()),t(n.material)):n.type==="Mesh"&&(n.material===void 0&&(n.material=Xn.defaultData()),t(n.material)),"overrides"in n&&Object.values(n.overrides).forEach(r=>{r.material&&typeof r.material!="string"&&t(r.material)})})}function Due(e){Object.assign(e.scene.publish,{orbitControls:{...lx.defaultData,...Cn(e.scene.publish.orbitControls)}})}function Lue(e){Object.assign(e.scene.publish.settings,{video:{...Lh.defaultData.settings.video,...Cn(e.scene.publish.settings.video)}})}function Rue(e){function t(i){if(i.layers){for(let n of Object.values(i.layers))if(n){for(let[r,s]of Object.entries(n))if((SU.includes(r)||typeof s=="boolean")&&delete n[r],r==="texture")for(let[a,o]of Object.entries(s))(Pue.includes(a)||typeof o=="boolean")&&delete s[a]}}}e.scene.objects.traverse((i,n)=>{n.states.forEach(r=>{let s=r;s.material?t(s.material):s.materials&&s.materials.forEach(a=>{t(a)})})})}function Iue(e){e.scene.publish.withBackground=!0}function Oue(e){e.scene.publish.settings.web={compress:!0,preload:!0,preset:1,logo:!0,hint:!1}}function Bue(e){e.scene.objects.traverse((t,i)=>{let n=i.cloner;n&&(n.radial.scale=n.radial.scale.map(r=>r+1),n.linear.scale=n.linear.scale.map(r=>r+1))})}function Nue(e){e.scene.objects.traverse((t,i)=>{let n=i.geometry;n&&(n.type==="DodecahedronGeometry"||n.type==="IcosahedronGeometry")&&(n.detail=Math.round(n.detail))})}function Uue(e){e.scene.objects.traverse((t,i)=>{let n=e.scene.objects.unproxy().parent(t);if(n){let r=Cn(e.scene.objects.data(n));r&&r.type==="Mesh"&&r.geometry.type==="BooleanGeometry"&&i.type==="Mesh"&&(i.visible=Cn(i).booleanExclude!==!0)}})}function Fue(e){e.scene.objects.traverse((t,i)=>{if(i.type==="Mesh"){let n=i;i.geometry.type==="NonParametricGeometry"?n.material!==void 0&&delete n.material:n.materials!==void 0&&delete n.materials}})}function zue(e){function t(n){Object.setPrototypeOf(n,cn.prototype),n.texture&&Object.setPrototypeOf(n.texture,cn.prototype)}function i(n){Object.setPrototypeOf(n,cn.prototype);for(let r in n)t(n[r])}e.scene.objects.traverse((n,r)=>{r.states.forEach(s=>{let a=s;if(a.material){let o=Cn(a.material).layers;i(o),a.material.layers=o}if(a.materials)for(let o=0;o<a.materials.length;o++){let l=a.materials[o],c=Cn(l).layers;i(c),l.layers=c}})})}function I9(e){e.layers===void 0&&Object.assign(e,Xn.defaultTwoLayerData("lambert"))}function mb(e){!e.layers||e.layers.forEach(t=>{if(t.type==="depth"&&t.colors.length===10){let i=[...t.colors];i.push(t.colors[9]);let n=[...t.steps];n.push(t.steps[9]);let r={...Cn(t),colors:i,steps:n};Object.assign(t,r)}})}function kue(e){e.scene.objects.traverse((t,i)=>{i.type==="Mesh"&&(i.geometry.type==="BooleanGeometry"||i.geometry.type==="SubdivGeometry")&&(i.geometry.phongAngle=35)})}function O9(e){e.scene.objects.traverse((t,i)=>{"materials"in i?i.materials.forEach(n=>{typeof n!="string"&&mb(n)}):"material"in i&&typeof i.material!="string"&&mb(i.material)}),Object.values(e.shared.materials).forEach(t=>mb(t))}function Vue(e){e.scene.environment.ambientLight.softShadows=!1,e.scene.environment.ambientLight.softShadowQuality="low",e.scene.objects.traverse((t,i)=>{(i.type==="DirectionalLight"||i.type==="SpotLight")&&(i.shadowResolution=1024,i.shadowRadius=1,i.depth=1e5)}),e.shared.penumbraSize=new Array(5).fill(.5)}function Hue(e){e.shared.audios=qh({},Bt.prototype)}function Gue(e){e.shared.videos=qh({},Bt.prototype)}function jue(e){let t=e.shared.materials;Object.entries(t).forEach(([i,n])=>{if(!n.layers){let r={name:"Untitled Material",layers:[{fi:0,data:{type:"light",category:"phong",alpha:.6,visible:!0,mode:0,specular:{r:.2,g:.2,b:.2},shininess:5},id:"layer1"},{fi:1,data:{type:"color",alpha:1,visible:!0,mode:0,color:{r:.2823529411764706,g:.2823529411764706,b:.30196078431372547}},id:"layer2"}]};Object.assign(t,{[i]:r})}})}function Wue(e){Object.entries(Cn(e.shared.images)).filter(t=>t[1].asset===!1).map(t=>t[0]).forEach(t=>{delete e.shared.images[t]}),Object.entries(Cn(e.shared.audios)).filter(t=>t[1].asset===!1).map(t=>t[0]).forEach(t=>{delete e.shared.audios[t]})}function Xue(e){e.scene.publish.settings.web.preload=!1}function B9(e){e.layers&&e.layers.forEach(t=>{t.type==="depth"&&t.num!==void 0&&(t.colors=t.colors.slice(0,t.num),t.steps=t.steps.slice(0,t.num),delete t.num)})}function N9(e){e.layers&&e.layers.forEach(t=>{Tue(t)&&t.isMask===void 0&&(t.isMask=!1),(t.type==="texture"||t.type==="video")&&t.blending===void 0&&(t.blending=0),(t.type==="noise"||t.type==="displace"&&t.displacementType==="noise")&&(t.voronoiStyle===void 0&&(t.voronoiStyle=0),t.highCut===void 0&&(t.highCut=1),t.lowCut===void 0&&(t.lowCut=0),t.smoothness===void 0&&(t.smoothness=.3),t.seed===void 0&&(t.seed=0),t.quality===void 0&&(t.quality=1))})}function que(e){e.shared.fonts=qh({},Bt.prototype)}function Yue(e){return e.replace(".typeface","").replace(/optimer/gi,"open sans").replace("space_mono","space mono").replace(/alma_mono/gi,"varela round").replace(/droid_sans_mono/gi,"noto sans mono").replace(/droid_sans|gentilis|gnomon_(simple|foreground)|helvetiker/gi,"roboto").replace(/droid_serif/gi,"roboto slab").replace("_sans"," sans").replace("crimson_text","crimson text").replace("medium_medium","medium").replace("fatface_fatface","fatface").replace("100hairline","thin").replace("200thin","extralight").replace("300light","light").replace("500medium","medium").replace("600semi","semibold").replace("800heavy","extrabold").replace("900black","black").replace(/bodoni_(11|16|24|36|48|72|96)([^_])/gi,"bodoni_$1_$2").replace(/bodoni_(11|16|24|36|48|72|96)/gi,"bodoni moda").replace(/(thin|hairline)(_regular)?/gi,"100").replace(/(extra|ultra)light(_regular)?/gi,"200").replace(/light(_regular)?/gi,"300").replace(/_book|_normal|_roman/gi,"_regular").replace(/medium(_regular)?/gi,"500").replace(/(semi|demi)bold(_regular)?/gi,"600").replace(/(extra|ultra)bold(_regular)?/gi,"800").replace(/bold(_regular)?/gi,"700").replace(/(black|heavy|fatface)(_regular)?/gi,"900").replace(/([1-9]00)_italic/gi,"$1italic").replace(/regularitalic/gi,"italic").replace(/regularitalic/gi,"italic").split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function Zue(e){let t=[];e.scene.objects.traverse((i,n)=>{let r=n;if(r.type==="TextFrame"){let s=Xn.defaultTwoLayerData("phong"),a=typeof r.color=="string"?e.shared.colors[r.color]:r.color;s.layers[1].data.color={r:a.r,g:a.g,b:a.b},s.layers[1].data.alpha=r.alpha;let o=Yue(r.font);e.shared.fonts[o]===void 0&&(e.shared.fonts[o]={name:o});let l={name:r.name,...fr.defaultData,...Qd.defaultData,flatShading:!1,wireframe:!1,geometry:{...Zd.defaultData("TextGeometry"),width:r.width,height:r.height,font:o,depth:0,horizontalAlign:r.horizontalAlign,verticalAlign:r.verticalAlign,fontSize:r.fontSize*1.40625,lineHeight:r.lineHeight/1.40625,letterSpacing:r.letterSpacing-1,text:r.text,textTransform:r.textTransform,extrudeBevelSize:0,extrudeBevelSegments:1},material:s,states:Cn(r.states),events:Cn(r.events),visible:r.visible,raycastLock:r.raycastLock,position:r.position,rotation:r.rotation,scale:r.scale,hiddenMatrix:r.hiddenMatrix},c=Cn(e.scene.objects).parent(i);e.scene.objects.insertAfter(c??null,i,[{id:i+"new",data:l,children:[]}]),t.push(i)}}),t.forEach(i=>{e.scene.objects.delete(i)})}function Que(e){let t={0:"MouseDown",1:"MouseUp",2:"MouseHover",5:"KeyDown",6:"KeyUp",7:"Start",9:"LookAt",10:"Follow",11:"Scroll",12:"Audio",13:"GameControl"};e.scene.objects.traverse((i,n)=>{n.events.forEach(r=>{if(t[Number(r.type)])if(Object.assign(r,{type:t[Number(r.type)]}),r.type==="Audio"&&"audioEvent"in r&&(Object.assign(r,{playAudio:r.audioEvent}),delete r.audioEvent),r.type==="GameControl")Object.assign(r,{gameActions:{idle:new yt,move:new yt,jump:new yt}});else{let s=new yt;Object.assign(r,{actions:s}),(r.type==="MouseDown"||r.type==="MouseUp"||r.type==="KeyDown"||r.type==="KeyUp")&&"url"in r&&s.push({fi:0,id:Dt.generateUUID(),data:{type:"Link",url:r.url,delay:0}}),"targets"in r&&(r.targets.forEach((a,o,l)=>{let c={state:void 0,repeat:0,delay:0,delayDirection:void 0,direction:"normal",duration:0,easing:4},u={easing:a.easing,duration:a.duration};a.easing===6?Object.assign(u,il(a,"mass","stiffness","damping","velocity")):a.easing===5&&Object.assign(u,{control1:{...a.control1},control2:{...a.control2}});let h={repeat:a.repeat?-1:0,delay:a.delay,delayDirection:a.delayDirection,direction:a.cycle&&a.rewind?"pingpong-rewind":a.cycle?"pingpong":"normal"},d={state:a.state,...h,...u},p={allowSlerp:!0,type:"Transition",object:a.object,repeat:0,delay:0,delayDirection:void 0,direction:"normal",tweens:new yt({fi:0,id:Dt.generateUUID(),data:c},{fi:1,id:Dt.generateUUID(),data:d})};s.push({fi:l,id:o,data:p})}),delete r.targets)}})})}function Kue(e){e.scene.objects.traverse((t,i)=>{function n(r,s){var l;let a=new yt,o=[];if(i.events.forEach((c,u,h)=>{if(c.type==="Audio"&&c.trigger===s){let d;o.push(u),c.interaction==="play"?d={...il(c,"interaction","audio","delay","volume","loop"),triggerAfter:"after"in c?c.after:void 0,toggle:"after"in c?c.toggle:void 0,type:"Audio"}:(c.interaction==="pause"||c.interaction==="stop")&&(d={...il(c,"interaction","delay","object","playAudio"),type:"Audio"}),d&&a.push({fi:h,id:u,data:d})}}),o.forEach(c=>i.events.delete(c)),a.length){let c=(l=i.events.find(u=>u.type===r))==null?void 0:l.data;c?"actions"in c&&c.actions.insertBefore(null,a):i.events.insertBefore(null,[{id:Dt.generateUUID(),data:{type:r,actions:a}}])}}n("Start","start"),n("MouseDown","mouseDown"),n("MouseUp","mouseUp"),n("KeyDown","keyDown"),n("KeyUp","keyUp")})}function U9(e){var i;let t=(i=e.layers.find(n=>n.type==="light"))==null?void 0:i.data;if((t==null?void 0:t.category)==="basic"){let n=wr.defaultData("light","phong"),r=t;Object.assign(r,n),r.visible=!1}}function F9(e){jl(e,U9),Wl(e,U9)}function $ue(e){e.scene.objects.traverse((t,i)=>{i.type==="Mesh"&&i.geometry.type==="SubdivGeometry"&&(i.geometry.scaleBaked||(i.geometry.scaleBaked=[1,1,1]))})}function Jue(e){e.scene.objects.traverse((t,i)=>{(i.type==="Empty"||i.type==="Mesh")&&i.cloner&&!i.cloner.randomnessObject&&!i.cloner.toObject&&!i.cloner.randomness&&(i.cloner={...i.cloner,toObject:{object:"",spreadType:"random",scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],axis:"x",seed:0,count:99,align:"normal"},randomness:!1,randomnessObject:{strength:100,scale:[0,0,0],rotation:[0,0,0],position:[0,0,0],movement:1,seed:0,freqScale:10,noiseType:"perlin"}})})}function ede(e){e.scene.objects.traverse((t,i)=>{i.type==="Mesh"&&i.geometry.type==="NonParametricGeometry"&&!("material"in i)&&!("materials"in i)&&(i.material=Xn.defaultTwoLayerData("phong"))})}function tde(e){e.scene.publish.orbitControls.autoZoom===void 0&&(e.scene.publish.orbitControls.autoZoom=!1),e.scene.objects.traverse((t,i)=>{(i.type==="OrthographicCamera"||i.type==="PerspectiveCamera")&&(i.orthographic.autoZoom===void 0&&(i.orthographic.autoZoom=!1),i.orthographic.autoZoomFrustumSize===void 0&&(i.orthographic.autoZoomFrustumSize=790))})}function ide(e){e.scene.objects.traverse((t,i)=>{i.pathSnapping===void 0&&(i.pathSnapping={pathId:null,slide:0,offset:0,orientation:"tangential"}),i.pathSnapping.offset===void 0&&(i.pathSnapping.offset=0)})}function nde(e){e.scene.publish.mouseEventTarget===void 0&&(e.scene.publish.mouseEventTarget="canvas"),e.scene.publish.settings.web.hint===void 0&&(e.scene.publish.settings.web.hint=!1)}function rde(e){let{video:t}=e.scene.publish.settings;t.format==="gif"&&t.fps>48&&(t.fps=15)}function sde(e){e.scene.objects.traverse((t,i)=>{i.events.forEach(n=>{n.type==="GameControl"&&(n.resetYPosition=Math.abs(n.resetYPosition-i.position[1]))})})}function ade(e){let t=e.scene.environment.usePhysics;e.scene.objects.traverse((i,n)=>{t&&n.physics===null?n.collision=!1:n.collision="visibility"})}function ode(e){e.scene.objects.traverse((t,i)=>{i.events.forEach(n=>{n.type==="GameControl"&&(n.navmesh=hx.defaultDataThirdPerson.navmesh)})})}function lde(e){e.scene.styles||(e.scene.styles=Kd.defaultData())}function z9(e){e.layers.forEach(t=>{t.type==="light"&&t.category!=="toon"&&t.occlusion===void 0&&(t.occlusion=!0)})}function cde(e){e.scene.environment.ambientLight.occlusion===void 0&&(e.scene.environment.ambientLight.occlusion=!1),e.scene.environment.ambientLight.aoFullRes===void 0&&(e.scene.environment.ambientLight.aoFullRes=!1),e.scene.environment.ambientLight.radius===void 0&&(e.scene.environment.ambientLight.radius=256),e.scene.environment.ambientLight.bias===void 0&&(e.scene.environment.ambientLight.bias=.5),e.scene.environment.ambientLight.aoColor===void 0&&(e.scene.environment.ambientLight.aoColor={r:.19607843137254902,g:.19607843137254902,b:.19607843137254902}),Wl(e,z9),jl(e,z9)}function hde(e){e.scene.objects.traverse((t,i)=>{i.events.forEach(n=>{n.type==="GameControl"&&Object.assign(n.gameActions,{run:new yt})})})}function ude(e){e.scene.objects.traverse((t,i)=>{i.events.forEach(n=>{n.type==="GameControl"&&(n.keyAssignments=[...n.keyAssignments,["run","⇧"],["none","Ctrl"]])})})}function k9(e){e.layers&&e.layers.forEach(t=>{t.type==="light"&&t.bumpMapIntensity===void 0&&(t.bumpMapIntensity=5)})}function dde(e,t){if(t<1&&(Wl(e,R9),jl(e,R9),e.schema=1),t<2&&(Due(e),e.schema=2),t<3&&(Rue(e),e.schema=3),t<4&&(Iue(e),e.schema=4),t<5&&(Oue(e),e.schema=5),t<6&&(Bue(e),e.schema=6),t<7&&(Nue(e),e.schema=7),t<8&&(e.schema=8),t<9&&(O9(e),e.schema=9),t<10&&(kue(e),e.schema=10),t<11&&(Vue(e),e.schema=11),t<12&&(O9(e),e.schema=12),t<13&&(Hue(e),e.schema=13),t<14&&(jue(e),e.schema=14),t<15&&(Wue(e),e.schema=15),t<16&&(Xue(e),e.schema=16),t<17&&(Wl(e,B9),jl(e,B9),e.schema=17),t<18&&(Wl(e,I9),jl(e,I9),e.schema=18),t<19&&(Lue(e),e.schema=19),t<20&&(que(e),Zue(e),e.schema=20),t<21&&(Que(e),Kue(e),e.schema=21),t<22&&(F9(e),e.schema=22),t<23&&($ue(e),e.schema=23),t<24&&(Jue(e),e.schema=24),(t<25||e.shared.videos===void 0)&&(Gue(e),t<25&&(e.schema=25)),t<26&&(Uue(e),e.schema=26),t<27&&(Fue(e),e.schema=27),t<28&&(F9(e),e.schema=28),t<29&&(zue(e),e.schema=29),t<30&&(ede(e),e.schema=30),t<31&&(tde(e),e.schema=31),t<33&&(ide(e),e.schema=33),t<34&&(nde(e),e.schema=34),t<35&&(rde(e),e.schema=35),t<36&&(sde(e),e.schema=36),t<37&&(ade(e),e.schema=37),t<38&&(Wl(e,N9),jl(e,N9),e.schema=38),t<39&&(ode(e),e.schema=39),t<40&&(lde(e),e.schema=40),t<41&&(cde(e),e.schema=41),t<42&&(hde(e),e.schema=42),t<43&&(ude(e),e.schema=43),t<99){Wl(e,k9),jl(e,k9),e.scene.publish.playCamera===null&&(e.scene.publish.playCamera=rf);let i=Cn(e.scene.objects),n=e.scene.objects;e.scene.publish.playPage=km,n.insertBefore(null,null,[{id:km,data:{...Lp.defaultData,backgroundColor:e.scene.backgroundColor,fog:e.scene.fog,postprocessing:e.scene.postprocessing,ao:il(e.scene.environment.ambientLight,"occlusion","aoFullRes","radius","bias","aoColor"),publish:{playCamera:e.scene.publish.playCamera,gameControlObject:e.scene.publish.gameControlObject},shadow:il(e.scene.environment.ambientLight,"softShadowQuality"),globalPhysics:{...Pp.defaultData,...il(e.scene.environment,"usePhysics","gravity")},camera:Cn(e.scene.ownerCamera)??Lp.defaultData.camera,name:"Scene"},children:[]}]);for(let a of i)a.id!==$d.TRASH_CAN_ID&&n.move(km,a.fi,a.id);let r=0,s=0;e.shared.penumbraSize&&e.scene.objects.traverse((a,o)=>{o.type==="DirectionalLight"?(o.penumbraSize=e.shared.penumbraSize[Math.min(r,2)],r+=1):o.type==="SpotLight"&&(o.penumbraSize=e.shared.penumbraSize[3+Math.min(s,1)],s+=1),(o.physics===void 0||o.physics===null)&&o.type!=="Instance"&&(o.physics={},Object.assign(o.physics,Tp.defaultData)),o.physics!==void 0&&o.physics!==null&&(o.physics.enabled=o.collision??"visibility",delete o.collision)}),e.schema=99}}function V9(e){e.layers&&e.layers.forEach(t=>{t.type==="light"&&t.alphaOverride===void 0&&(t.alphaOverride=1)})}function pde(e){e.scene.objects.traverse((t,i)=>{let n=i.geometry;n&&n.type==="PathGeometry"&&(n.extrusion.capType="flat",n.extrusion.bevel=50,n.extrusion.bevelSides=6,n.extrusion.shape.type==="Custom"&&(n.extrusion.shape.shapeQuality="low"))})}var hh=104;function AU(e){let t=e.schema??0;t!==hh&&(console.warn("updating from ",t,"to ",hh),dde(e,t),t<100&&(e.scene.publish.joystickSizeAndXYOffset===void 0&&(e.scene.publish.joystickSizeAndXYOffset=Lh.defaultData.joystickSizeAndXYOffset),e.schema=100),t<101&&(Wl(e,V9),jl(e,V9),e.schema=101),t<102&&(pde(e),e.schema=102),t<104&&(e.shared.catelogs=new Bt,e.shared.lib=R0.defaultData(),e.schema=104))}var ux;(e=>{e.defaultData={schema:hh,scene:$d.defaultData,frames:new Bt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",Vm.defaultData),shared:{...Ho.emptyData(),colors:Ho.defaultColors()}},e.emptyDataForImports=function(r){let s=$d.emptyDataWithPage(r);return{schema:hh,scene:s,frames:new Bt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",Vm.defaultData),shared:{...Ho.emptyData(),colors:Ho.defaultColors(),images:Ho.defaultImages(r)}}},e.emptyData=function(){return{schema:hh,scene:$d.emptyDataWithPage(),frames:new Bt().add("72fc2993-2da3-4b6b-96ac-2879db3a28bd",Vm.defaultData),shared:Ho.emptyData()}},e.collabHelper={...ES,updateSchema(r){return(r.schema??0)<hh?P0(r,AU):(r.schema??0)-hh}};function t(r){let s=e.collabHelper.updateSchema(r);return typeof s=="number"?s===0?r:null:s.data}e.updateSchemaDirectly=t;function i(r){return{...r,shared:{...r.shared,lib:R0.defaultData()}}}e.withoutLib=i;function n(r,s){let a=r.scene.objects.get(s);if(a&&a.data.type==="Component")return a;{let o=r.shared.lib.components[s];if(o)return o.asset}}e.getComponentData=n})(ux||(ux={}));function bh(e,t=!1){let i=e[0].index!==null,n=new Set(Object.keys(e[0].attributes)),r=new Set(Object.keys(e[0].morphAttributes)),s={},a={},o=e[0].morphTargetsRelative,l=new mt,c=0;for(let u=0;u<e.length;++u){let h=e[u],d=0;if(i!==(h.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(let p in h.attributes){if(!n.has(p))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+'. All geometries must have compatible attributes; make sure "'+p+'" attribute exists among all geometries, or in none of them.'),null;s[p]===void 0&&(s[p]=[]),s[p].push(h.attributes[p]),d++}if(d!==n.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". Make sure all geometries have the same number of attributes."),null;if(o!==h.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(let p in h.morphAttributes){if(!r.has(p))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+".  .morphAttributes must be consistent throughout all geometries."),null;a[p]===void 0&&(a[p]=[]),a[p].push(h.morphAttributes[p])}if(t){let p;if(i)p=h.index.count;else if(h.attributes.position!==void 0)p=h.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+u+". The geometry must have either an index or a position attribute"),null;l.addGroup(c,p,u),c+=p}}if(i){let u=0,h=[];for(let d=0;d<e.length;++d){let p=e[d].index;for(let f=0;f<p.count;++f)h.push(p.getX(f)+u);u+=e[d].attributes.position.count}l.setIndex(h)}for(let u in s){let h=H9(s[u]);if(!h)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" attribute."),null;l.setAttribute(u,h)}for(let u in a){let h=a[u][0].length;if(h===0)break;l.morphAttributes=l.morphAttributes||{},l.morphAttributes[u]=[];for(let d=0;d<h;++d){let p=[];for(let v=0;v<a[u].length;++v)p.push(a[u][v][d]);let f=H9(p);if(!f)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+u+" morphAttribute."),null;l.morphAttributes[u].push(f)}}return l}function H9(e){let t,i,n,r=0;for(let o=0;o<e.length;++o){let l=e[o];if(l.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(t===void 0&&(t=l.array.constructor),t!==l.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(i===void 0&&(i=l.itemSize),i!==l.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(n===void 0&&(n=l.normalized),n!==l.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;r+=l.array.length}let s=new t(r),a=0;for(let o=0;o<e.length;++o)s.set(e[o].array,a),a+=e[o].array.length;return new gt(s,i,n)}var fde=Math.pow(2,-24),x1=class{constructor(){}};function Xa(e,t,i){return i.min.x=t[e],i.min.y=t[e+1],i.min.z=t[e+2],i.max.x=t[e+3],i.max.y=t[e+4],i.max.z=t[e+5],i}function G9(e){let t=-1,i=-1/0;for(let n=0;n<3;n++){let r=e[n+3]-e[n];r>i&&(i=r,t=n)}return t}function j9(e,t){t.set(e)}function W9(e,t,i){let n,r;for(let s=0;s<3;s++){let a=s+3;n=e[s],r=t[s],i[s]=n<r?n:r,n=e[a],r=t[a],i[a]=n>r?n:r}}function _1(e,t,i){for(let n=0;n<3;n++){let r=t[e+2*n],s=t[e+2*n+1],a=r-s,o=r+s;a<i[n]&&(i[n]=a),o>i[n+3]&&(i[n+3]=o)}}function Of(e){let t=e[3]-e[0],i=e[4]-e[1],n=e[5]-e[2];return 2*(t*i+i*n+n*t)}function mde(e,t){if(!e.index){let i=e.attributes.position.count,n=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,r;i>65535?r=new Uint32Array(new n(4*i)):r=new Uint16Array(new n(2*i)),e.setIndex(new gt(r,1));for(let s=0;s<i;s++)r[s]=s}}function gde(e){if(!e.groups||!e.groups.length)return[{offset:0,count:e.index.count/3}];let t=[],i=new Set;for(let r of e.groups)i.add(r.start),i.add(r.start+r.count);let n=Array.from(i.values()).sort((r,s)=>r-s);for(let r=0;r<n.length-1;r++){let s=n[r],a=n[r+1];t.push({offset:s/3,count:(a-s)/3})}return t}function gb(e,t,i,n,r=null){let s=1/0,a=1/0,o=1/0,l=-1/0,c=-1/0,u=-1/0,h=1/0,d=1/0,p=1/0,f=-1/0,v=-1/0,m=-1/0,g=r!==null;for(let y=t*6,x=(t+i)*6;y<x;y+=6){let _=e[y+0],b=e[y+1],w=_-b,M=_+b;w<s&&(s=w),M>l&&(l=M),g&&_<h&&(h=_),g&&_>f&&(f=_);let S=e[y+2],C=e[y+3],E=S-C,P=S+C;E<a&&(a=E),P>c&&(c=P),g&&S<d&&(d=S),g&&S>v&&(v=S);let I=e[y+4],D=e[y+5],L=I-D,B=I+D;L<o&&(o=L),B>u&&(u=B),g&&I<p&&(p=I),g&&I>m&&(m=I)}n[0]=s,n[1]=a,n[2]=o,n[3]=l,n[4]=c,n[5]=u,g&&(r[0]=h,r[1]=d,r[2]=p,r[3]=f,r[4]=v,r[5]=m)}function vde(e,t,i,n){let r=1/0,s=1/0,a=1/0,o=-1/0,l=-1/0,c=-1/0;for(let u=t*6,h=(t+i)*6;u<h;u+=6){let d=e[u+0];d<r&&(r=d),d>o&&(o=d);let p=e[u+2];p<s&&(s=p),p>l&&(l=p);let f=e[u+4];f<a&&(a=f),f>c&&(c=f)}n[0]=r,n[1]=s,n[2]=a,n[3]=o,n[4]=l,n[5]=c}function yde(e,t,i,n,r){let s=i,a=i+n-1,o=r.pos,l=r.axis*2;for(;;){for(;s<=a&&t[s*6+l]<o;)s++;for(;s<=a&&t[a*6+l]>=o;)a--;if(s<a){for(let c=0;c<3;c++){let u=e[s*3+c];e[s*3+c]=e[a*3+c],e[a*3+c]=u;let h=t[s*6+c*2+0];t[s*6+c*2+0]=t[a*6+c*2+0],t[a*6+c*2+0]=h;let d=t[s*6+c*2+1];t[s*6+c*2+1]=t[a*6+c*2+1],t[a*6+c*2+1]=d}s++,a--}else return s}}var Io=32,xde=(e,t)=>e.candidate-t.candidate,wl=new Array(Io).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),b1=new Float32Array(6);function _de(e,t,i,n,r,s){let a=-1,o=0;if(s===0)a=G9(t),a!==-1&&(o=(t[a]+t[a+3])/2);else if(s===1)a=G9(e),a!==-1&&(o=bde(i,n,r,a));else if(s===2){let l=Of(e),c=1.25*r,u=n*6,h=(n+r)*6;for(let d=0;d<3;d++){let p=t[d],f=(t[d+3]-p)/Io;if(r<Io/4){let v=[...wl];v.length=r;let m=0;for(let y=u;y<h;y+=6,m++){let x=v[m];x.candidate=i[y+2*d],x.count=0;let{bounds:_,leftCacheBounds:b,rightCacheBounds:w}=x;for(let M=0;M<3;M++)w[M]=1/0,w[M+3]=-1/0,b[M]=1/0,b[M+3]=-1/0,_[M]=1/0,_[M+3]=-1/0;_1(y,i,_)}v.sort(xde);let g=r;for(let y=0;y<g;y++){let x=v[y];for(;y+1<g&&v[y+1].candidate===x.candidate;)v.splice(y+1,1),g--}for(let y=u;y<h;y+=6){let x=i[y+2*d];for(let _=0;_<g;_++){let b=v[_];x>=b.candidate?_1(y,i,b.rightCacheBounds):(_1(y,i,b.leftCacheBounds),b.count++)}}for(let y=0;y<g;y++){let x=v[y],_=x.count,b=r-x.count,w=x.leftCacheBounds,M=x.rightCacheBounds,S=0;_!==0&&(S=Of(w)/l);let C=0;b!==0&&(C=Of(M)/l);let E=1+1.25*(S*_+C*b);E<c&&(a=d,c=E,o=x.candidate)}}else{for(let g=0;g<Io;g++){let y=wl[g];y.count=0,y.candidate=p+f+g*f;let x=y.bounds;for(let _=0;_<3;_++)x[_]=1/0,x[_+3]=-1/0}for(let g=u;g<h;g+=6){let y=~~((i[g+2*d]-p)/f);y>=Io&&(y=Io-1);let x=wl[y];x.count++,_1(g,i,x.bounds)}let v=wl[Io-1];j9(v.bounds,v.rightCacheBounds);for(let g=Io-2;g>=0;g--){let y=wl[g],x=wl[g+1];W9(y.bounds,x.rightCacheBounds,y.rightCacheBounds)}let m=0;for(let g=0;g<Io-1;g++){let y=wl[g],x=y.count,_=y.bounds,b=wl[g+1].rightCacheBounds;x!==0&&(m===0?j9(_,b1):W9(_,b1,b1)),m+=x;let w=0,M=0;m!==0&&(w=Of(b1)/l);let S=r-m;S!==0&&(M=Of(b)/l);let C=1+1.25*(w*m+M*S);C<c&&(a=d,c=C,o=y.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${s} used.`);return{axis:a,pos:o}}function bde(e,t,i,n){let r=0;for(let s=t,a=t+i;s<a;s++)r+=e[s*6+n*2];return r/i}function wde(e,t){let i=e.attributes.position,n=e.index.array,r=n.length/3,s=new Float32Array(r*6),a=i.normalized,o=i.array,l=i.offset||0,c=3;i.isInterleavedBufferAttribute&&(c=i.data.stride);let u=["getX","getY","getZ"];for(let h=0;h<r;h++){let d=h*3,p=h*6,f,v,m;a?(f=n[d+0],v=n[d+1],m=n[d+2]):(f=n[d+0]*c+l,v=n[d+1]*c+l,m=n[d+2]*c+l);for(let g=0;g<3;g++){let y,x,_;a?(y=i[u[g]](f),x=i[u[g]](v),_=i[u[g]](m)):(y=o[f+g],x=o[v+g],_=o[m+g]);let b=y;x<b&&(b=x),_<b&&(b=_);let w=y;x>w&&(w=x),_>w&&(w=_);let M=(w-b)/2,S=g*2;s[p+S+0]=b+M,s[p+S+1]=M+(Math.abs(b)+M)*fde,b<t[g]&&(t[g]=b),w>t[g+3]&&(t[g+3]=w)}}return s}function Sde(e,t){function i(g){d&&d(g/p)}function n(g,y,x,_=null,b=0){if(!f&&b>=l&&(f=!0,c&&(console.warn(`MeshBVH: Max depth of ${l} reached when generating BVH. Consider increasing maxDepth.`),console.warn(e))),x<=u||b>=l)return i(y+x),g.offset=y,g.count=x,g;let w=_de(g.boundingData,_,a,y,x,h);if(w.axis===-1)return i(y+x),g.offset=y,g.count=x,g;let M=yde(o,a,y,x,w);if(M===y||M===y+x)i(y+x),g.offset=y,g.count=x;else{g.splitAxis=w.axis;let S=new x1,C=y,E=M-y;g.left=S,S.boundingData=new Float32Array(6),gb(a,C,E,S.boundingData,s),n(S,C,E,s,b+1);let P=new x1,I=M,D=x-E;g.right=P,P.boundingData=new Float32Array(6),gb(a,I,D,P.boundingData,s),n(P,I,D,s,b+1)}return g}mde(e,t);let r=new Float32Array(6),s=new Float32Array(6),a=wde(e,r),o=e.index.array,l=t.maxDepth,c=t.verbose,u=t.maxLeafTris,h=t.strategy,d=t.onProgress,p=e.index.count/3,f=!1,v=[],m=gde(e);if(m.length===1){let g=m[0],y=new x1;y.boundingData=r,vde(a,g.offset,g.count,s),n(y,g.offset,g.count,s),v.push(y)}else for(let g of m){let y=new x1;y.boundingData=new Float32Array(6),gb(a,g.offset,g.count,y.boundingData,s),n(y,g.offset,g.count,s),v.push(y)}return v}function Mde(e,t){let i=Sde(e,t),n,r,s,a=[],o=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let u=0;u<i.length;u++){let h=i[u],d=l(h),p=new o(32*d);n=new Float32Array(p),r=new Uint32Array(p),s=new Uint16Array(p),c(0,h),a.push(p)}return a;function l(u){return u.count?1:1+l(u.left)+l(u.right)}function c(u,h){let d=u/4,p=u/2,f=!!h.count,v=h.boundingData;for(let m=0;m<6;m++)n[d+m]=v[m];if(f){let m=h.offset,g=h.count;return r[d+6]=m,s[p+14]=g,s[p+15]=65535,u+32}else{let m=h.left,g=h.right,y=h.splitAxis,x;if(x=c(u+32,m),x/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return r[d+6]=x/4,x=c(x,g),r[d+7]=y,x}}}var hl=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(t,i){let n=1/0,r=-1/0;for(let s=0,a=t.length;s<a;s++){let o=t[s][i];n=o<n?o:n,r=o>r?o:r}this.min=n,this.max=r}setFromPoints(t,i){let n=1/0,r=-1/0;for(let s=0,a=i.length;s<a;s++){let o=i[s],l=t.dot(o);n=l<n?l:n,r=l>r?l:r}this.min=n,this.max=r}isSeparated(t){return this.min>t.max||t.min>this.max}};hl.prototype.setFromBox=function(){let e=new T;return function(t,i){let n=i.min,r=i.max,s=1/0,a=-1/0;for(let o=0;o<=1;o++)for(let l=0;l<=1;l++)for(let c=0;c<=1;c++){e.x=n.x*o+r.x*(1-o),e.y=n.y*l+r.y*(1-l),e.z=n.z*c+r.z*(1-c);let u=t.dot(e);s=Math.min(u,s),a=Math.max(u,a)}this.min=s,this.max=a}}();var Cde=function(){let e=new T,t=new T,i=new T;return function(n,r,s){let a=n.start,o=e,l=r.start,c=t;i.subVectors(a,l),e.subVectors(n.end,n.start),t.subVectors(r.end,r.start);let u=i.dot(c),h=c.dot(o),d=c.dot(c),p=i.dot(o),f=o.dot(o)*d-h*h,v,m;f!==0?v=(u*h-p*d)/f:v=0,m=(u+v*h)/d,s.x=v,s.y=m}}(),dA=function(){let e=new te,t=new T,i=new T;return function(n,r,s,a){Cde(n,r,e);let o=e.x,l=e.y;if(o>=0&&o<=1&&l>=0&&l<=1){n.at(o,s),r.at(l,a);return}else if(o>=0&&o<=1){l<0?r.at(0,a):r.at(1,a),n.closestPointToPoint(a,!0,s);return}else if(l>=0&&l<=1){o<0?n.at(0,s):n.at(1,s),r.closestPointToPoint(s,!0,a);return}else{let c;o<0?c=n.start:c=n.end;let u;l<0?u=r.start:u=r.end;let h=t,d=i;if(n.closestPointToPoint(u,!0,t),r.closestPointToPoint(c,!0,i),h.distanceToSquared(u)<=d.distanceToSquared(c)){s.copy(h),a.copy(u);return}else{s.copy(c),a.copy(d);return}}}}(),Ede=function(){let e=new T,t=new T,i=new Qr,n=new Is;return function(r,s){let{radius:a,center:o}=r,{a:l,b:c,c:u}=s;if(n.start=l,n.end=c,n.closestPointToPoint(o,!0,e).distanceTo(o)<=a||(n.start=l,n.end=u,n.closestPointToPoint(o,!0,e).distanceTo(o)<=a)||(n.start=c,n.end=u,n.closestPointToPoint(o,!0,e).distanceTo(o)<=a))return!0;let h=s.getPlane(i);if(Math.abs(h.distanceToPoint(o))<=a){let d=h.projectPoint(o,t);if(s.containsPoint(d))return!0}return!1}}(),Ade=1e-15;function Eu(e){return Math.abs(e)<Ade}var ul=class extends Gn{constructor(...e){super(...e),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map(()=>new T),this.satBounds=new Array(4).fill().map(()=>new hl),this.points=[this.a,this.b,this.c],this.sphere=new ls,this.plane=new Qr,this.needsUpdate=!0}intersectsSphere(e){return Ede(e,this)}update(){let e=this.a,t=this.b,i=this.c,n=this.points,r=this.satAxes,s=this.satBounds,a=r[0],o=s[0];this.getNormal(a),o.setFromPoints(a,n);let l=r[1],c=s[1];l.subVectors(e,t),c.setFromPoints(l,n);let u=r[2],h=s[2];u.subVectors(t,i),h.setFromPoints(u,n);let d=r[3],p=s[3];d.subVectors(i,e),p.setFromPoints(d,n),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(a,e),this.needsUpdate=!1}};ul.prototype.closestPointToSegment=function(){let e=new T,t=new T,i=new Is;return function(n,r=null,s=null){let{start:a,end:o}=n,l=this.points,c,u=1/0;for(let h=0;h<3;h++){let d=(h+1)%3;i.start.copy(l[h]),i.end.copy(l[d]),dA(i,n,e,t),c=e.distanceToSquared(t),c<u&&(u=c,r&&r.copy(e),s&&s.copy(t))}return this.closestPointToPoint(a,e),c=a.distanceToSquared(e),c<u&&(u=c,r&&r.copy(e),s&&s.copy(a)),this.closestPointToPoint(o,e),c=o.distanceToSquared(e),c<u&&(u=c,r&&r.copy(e),s&&s.copy(o)),Math.sqrt(u)}}();ul.prototype.intersectsTriangle=function(){let e=new ul,t=new Array(3),i=new Array(3),n=new hl,r=new hl,s=new T,a=new T,o=new T,l=new T,c=new Is,u=new Is,h=new Is;return function(d,p=null,f=!1){this.needsUpdate&&this.update(),d.isExtendedTriangle?d.needsUpdate&&d.update():(e.copy(d),e.update(),d=e);let v=this.plane,m=d.plane;if(Math.abs(v.normal.dot(m.normal))>1-1e-10){let g=this.satBounds,y=this.satAxes;i[0]=d.a,i[1]=d.b,i[2]=d.c;for(let b=0;b<4;b++){let w=g[b],M=y[b];if(n.setFromPoints(M,i),w.isSeparated(n))return!1}let x=d.satBounds,_=d.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let b=0;b<4;b++){let w=x[b],M=_[b];if(n.setFromPoints(M,t),w.isSeparated(n))return!1}for(let b=0;b<4;b++){let w=y[b];for(let M=0;M<4;M++){let S=_[M];if(s.crossVectors(w,S),n.setFromPoints(s,t),r.setFromPoints(s,i),n.isSeparated(r))return!1}}return p&&(f||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),p.start.set(0,0,0),p.end.set(0,0,0)),!0}else{let g=this.points,y=!1,x=0;for(let D=0;D<3;D++){let L=g[D],B=g[(D+1)%3];c.start.copy(L),c.end.copy(B),c.delta(a);let j=y?u.start:u.end,z=Eu(m.distanceToPoint(L));if(Eu(m.normal.dot(a))&&z){u.copy(c),x=2;break}if((m.intersectLine(c,j)||z)&&!Eu(j.distanceTo(B))){if(x++,y)break;y=!0}}if(x===1&&d.containsPoint(u.end))return p&&(p.start.copy(u.end),p.end.copy(u.end)),!0;if(x!==2)return!1;let _=d.points,b=!1,w=0;for(let D=0;D<3;D++){let L=_[D],B=_[(D+1)%3];c.start.copy(L),c.end.copy(B),c.delta(o);let j=b?h.start:h.end,z=Eu(v.distanceToPoint(L));if(Eu(v.normal.dot(o))&&z){h.copy(c),w=2;break}if((v.intersectLine(c,j)||z)&&!Eu(j.distanceTo(B))){if(w++,b)break;b=!0}}if(w===1&&this.containsPoint(h.end))return p&&(p.start.copy(h.end),p.end.copy(h.end)),!0;if(w!==2)return!1;if(u.delta(a),h.delta(o),a.dot(o)<0){let D=h.start;h.start=h.end,h.end=D}let M=u.start.dot(a),S=u.end.dot(a),C=h.start.dot(a),E=h.end.dot(a),P=S<C,I=M<E;return M!==E&&C!==S&&P===I?!1:(p&&(l.subVectors(u.start,h.start),l.dot(a)>0?p.start.copy(u.start):p.start.copy(h.start),l.subVectors(u.end,h.end),l.dot(a)<0?p.end.copy(u.end):p.end.copy(h.end)),!0)}}}();ul.prototype.distanceToPoint=function(){let e=new T;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}();ul.prototype.distanceToTriangle=function(){let e=new T,t=new T,i=["a","b","c"],n=new Is,r=new Is;return function(s,a=null,o=null){let l=a||o?n:null;if(this.intersectsTriangle(s,l))return(a||o)&&(a&&l.getCenter(a),o&&l.getCenter(o)),0;let c=1/0;for(let u=0;u<3;u++){let h,d=i[u],p=s[d];this.closestPointToPoint(p,e),h=p.distanceToSquared(e),h<c&&(c=h,a&&a.copy(e),o&&o.copy(p));let f=this[d];s.closestPointToPoint(f,e),h=f.distanceToSquared(e),h<c&&(c=h,a&&a.copy(f),o&&o.copy(e))}for(let u=0;u<3;u++){let h=i[u],d=i[(u+1)%3];n.set(this[h],this[d]);for(let p=0;p<3;p++){let f=i[p],v=i[(p+1)%3];r.set(s[f],s[v]),dA(n,r,e,t);let m=e.distanceToSquared(t);m<c&&(c=m,a&&a.copy(e),o&&o.copy(t))}}return Math.sqrt(c)}}();var ao=class{constructor(e,t,i){this.isOrientedBox=!0,this.min=new T,this.max=new T,this.matrix=new ke,this.invMatrix=new ke,this.points=new Array(8).fill().map(()=>new T),this.satAxes=new Array(3).fill().map(()=>new T),this.satBounds=new Array(3).fill().map(()=>new hl),this.alignedSatBounds=new Array(3).fill().map(()=>new hl),this.needsUpdate=!1,e&&this.min.copy(e),t&&this.max.copy(t),i&&this.matrix.copy(i)}set(e,t,i){this.min.copy(e),this.max.copy(t),this.matrix.copy(i),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}};ao.prototype.update=function(){return function(){let e=this.matrix,t=this.min,i=this.max,n=this.points;for(let l=0;l<=1;l++)for(let c=0;c<=1;c++)for(let u=0;u<=1;u++){let h=1*l|2*c|4*u,d=n[h];d.x=l?i.x:t.x,d.y=c?i.y:t.y,d.z=u?i.z:t.z,d.applyMatrix4(e)}let r=this.satBounds,s=this.satAxes,a=n[0];for(let l=0;l<3;l++){let c=s[l],u=r[l],h=1<<l,d=n[h];c.subVectors(a,d),u.setFromPoints(c,n)}let o=this.alignedSatBounds;o[0].setFromPointsField(n,"x"),o[1].setFromPointsField(n,"y"),o[2].setFromPointsField(n,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}();ao.prototype.intersectsBox=function(){let e=new hl;return function(t){this.needsUpdate&&this.update();let i=t.min,n=t.max,r=this.satBounds,s=this.satAxes,a=this.alignedSatBounds;if(e.min=i.x,e.max=n.x,a[0].isSeparated(e)||(e.min=i.y,e.max=n.y,a[1].isSeparated(e))||(e.min=i.z,e.max=n.z,a[2].isSeparated(e)))return!1;for(let o=0;o<3;o++){let l=s[o],c=r[o];if(e.setFromBox(l,t),c.isSeparated(e))return!1}return!0}}();ao.prototype.intersectsTriangle=function(){let e=new ul,t=new Array(3),i=new hl,n=new hl,r=new T;return function(s){this.needsUpdate&&this.update(),s.isExtendedTriangle?s.needsUpdate&&s.update():(e.copy(s),e.update(),s=e);let a=this.satBounds,o=this.satAxes;t[0]=s.a,t[1]=s.b,t[2]=s.c;for(let h=0;h<3;h++){let d=a[h],p=o[h];if(i.setFromPoints(p,t),d.isSeparated(i))return!1}let l=s.satBounds,c=s.satAxes,u=this.points;for(let h=0;h<3;h++){let d=l[h],p=c[h];if(i.setFromPoints(p,u),d.isSeparated(i))return!1}for(let h=0;h<3;h++){let d=o[h];for(let p=0;p<4;p++){let f=c[p];if(r.crossVectors(d,f),i.setFromPoints(r,t),n.setFromPoints(r,u),i.isSeparated(n))return!1}}return!0}}();ao.prototype.closestPointToPoint=function(){return function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t}}();ao.prototype.distanceToPoint=function(){let e=new T;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}();ao.prototype.distanceToBox=function(){let e=["x","y","z"],t=new Array(12).fill().map(()=>new Is),i=new Array(12).fill().map(()=>new Is),n=new T,r=new T;return function(s,a=0,o=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(s))return(o||l)&&(s.getCenter(r),this.closestPointToPoint(r,n),s.closestPointToPoint(n,r),o&&o.copy(n),l&&l.copy(r)),0;let c=a*a,u=s.min,h=s.max,d=this.points,p=1/0;for(let v=0;v<8;v++){let m=d[v];r.copy(m).clamp(u,h);let g=m.distanceToSquared(r);if(g<p&&(p=g,o&&o.copy(m),l&&l.copy(r),g<c))return Math.sqrt(g)}let f=0;for(let v=0;v<3;v++)for(let m=0;m<=1;m++)for(let g=0;g<=1;g++){let y=(v+1)%3,x=(v+2)%3,_=m<<y|g<<x,b=1<<v|m<<y|g<<x,w=d[_],M=d[b];t[f].set(w,M);let S=e[v],C=e[y],E=e[x],P=i[f],I=P.start,D=P.end;I[S]=u[S],I[C]=m?u[C]:h[C],I[E]=g?u[E]:h[C],D[S]=h[S],D[C]=m?u[C]:h[C],D[E]=g?u[E]:h[C],f++}for(let v=0;v<=1;v++)for(let m=0;m<=1;m++)for(let g=0;g<=1;g++){r.x=v?h.x:u.x,r.y=m?h.y:u.y,r.z=g?h.z:u.z,this.closestPointToPoint(r,n);let y=r.distanceToSquared(n);if(y<p&&(p=y,o&&o.copy(n),l&&l.copy(r),y<c))return Math.sqrt(y)}for(let v=0;v<12;v++){let m=t[v];for(let g=0;g<12;g++){let y=i[g];dA(m,y,n,r);let x=n.distanceToSquared(r);if(x<p&&(p=x,o&&o.copy(n),l&&l.copy(r),x<c))return Math.sqrt(x)}}return Math.sqrt(p)}}();var Au=new T,Tu=new T,Pu=new T,w1=new te,S1=new te,M1=new te,X9=new T,q9=new T,Y9=new T,C1=new T;function Tde(e,t,i,n,r,s){let a;return s===wn?a=e.intersectTriangle(n,i,t,!0,r):a=e.intersectTriangle(t,i,n,s!==Jr,r),a===null?null:{distance:e.origin.distanceTo(r),point:r.clone()}}function Pde(e,t,i,n,r,s,a,o,l){Au.fromBufferAttribute(t,s),Tu.fromBufferAttribute(t,a),Pu.fromBufferAttribute(t,o);let c=Tde(e,Au,Tu,Pu,C1,l);if(c){n&&(w1.fromBufferAttribute(n,s),S1.fromBufferAttribute(n,a),M1.fromBufferAttribute(n,o),c.uv=Gn.getInterpolation(C1,Au,Tu,Pu,w1,S1,M1,new te)),r&&(w1.fromBufferAttribute(r,s),S1.fromBufferAttribute(r,a),M1.fromBufferAttribute(r,o),c.uv1=Gn.getInterpolation(C1,Au,Tu,Pu,w1,S1,M1,new te)),i&&(X9.fromBufferAttribute(i,s),q9.fromBufferAttribute(i,a),Y9.fromBufferAttribute(i,o),c.normal=Gn.getInterpolation(C1,Au,Tu,Pu,X9,q9,Y9,new T),c.normal.dot(e.direction)>0&&c.normal.multiplyScalar(-1));let u={a:s,b:a,c:o,normal:new T,materialIndex:0};Gn.getNormal(Au,Tu,Pu,u.normal),c.face=u,c.faceIndex=s}return c}function TU(e,t,i,n,r){let s=n*3,a=e.index.getX(s),o=e.index.getX(s+1),l=e.index.getX(s+2),{position:c,normal:u,uv:h,uv1:d}=e.attributes,p=Pde(i,c,u,h,d,a,o,l,t);return p?(p.faceIndex=n,r&&r.push(p),p):null}function Dde(e,t,i,n,r,s){for(let a=n,o=n+r;a<o;a++)TU(e,t,i,a,s)}function Lde(e,t,i,n,r){let s=1/0,a=null;for(let o=n,l=n+r;o<l;o++){let c=TU(e,t,i,o);c&&c.distance<s&&(a=c,s=c.distance)}return a}function ka(e,t,i,n){let r=e.a,s=e.b,a=e.c,o=t,l=t+1,c=t+2;i&&(o=i.getX(t),l=i.getX(t+1),c=i.getX(t+2)),r.x=n.getX(o),r.y=n.getY(o),r.z=n.getZ(o),s.x=n.getX(l),s.y=n.getY(l),s.z=n.getZ(l),a.x=n.getX(c),a.y=n.getY(c),a.z=n.getZ(c)}function Z9(e,t,i,n,r,s,a){let o=i.index,l=i.attributes.position;for(let c=e,u=t+e;c<u;c++)if(ka(a,c*3,o,l),a.needsUpdate=!0,n(a,c,r,s))return!0;return!1}var PU=class{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){let e=this._primitives;return e.length===0?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}};function Xl(e,t){return t[e+15]===65535}function Jd(e,t){return t[e+6]}function I0(e,t){return t[e+14]}function O0(e){return e+8}function B0(e,t){return t[e+6]}function Rde(e,t){return t[e+7]}var Nd=new Vi,dx=new T,Ide=["x","y","z"];function rM(e,t,i,n,r){let s=e*2,a=sf,o=xc,l=_c;if(Xl(s,o)){let c=Jd(e,l),u=I0(s,o);Dde(t,i,n,c,u,r)}else{let c=O0(e);px(c,a,n,dx)&&rM(c,t,i,n,r);let u=B0(e,l);px(u,a,n,dx)&&rM(u,t,i,n,r)}}function sM(e,t,i,n){let r=e*2,s=sf,a=xc,o=_c;if(Xl(r,a)){let l=Jd(e,o),c=I0(r,a);return Lde(t,i,n,l,c)}else{let l=Rde(e,o),c=Ide[l],u=n.direction[c]>=0,h,d;u?(h=O0(e),d=B0(e,o)):(h=B0(e,o),d=O0(e));let p=px(h,s,n,dx)?sM(h,t,i,n):null;if(p){let v=p.point[c];if(u?v<=s[d+l]:v>=s[d+l+3])return p}let f=px(d,s,n,dx)?sM(d,t,i,n):null;return p&&f?p.distance<=f.distance?p:f:p||f||null}}var Ode=function(){let e,t,i=[],n=new PU(()=>new Vi);return function(...s){e=n.getPrimitive(),t=n.getPrimitive(),i.push(e,t);let a=r(...s);n.releasePrimitive(e),n.releasePrimitive(t),i.pop(),i.pop();let o=i.length;return o>0&&(t=i[o-1],e=i[o-2]),a};function r(s,a,o,l,c=null,u=0,h=0){function d(y){let x=y*2,_=xc,b=_c;for(;!Xl(x,_);)y=O0(y),x=y*2;return Jd(y,b)}function p(y){let x=y*2,_=xc,b=_c;for(;!Xl(x,_);)y=B0(y,b),x=y*2;return Jd(y,b)+I0(x,_)}let f=s*2,v=sf,m=xc,g=_c;if(Xl(f,m)){let y=Jd(s,g),x=I0(f,m);return Xa(s,v,e),l(y,x,!1,h,u+s,e)}else{let y=O0(s),x=B0(s,g),_=y,b=x,w,M,S,C;if(c&&(S=e,C=t,Xa(_,v,S),Xa(b,v,C),w=c(S),M=c(C),M<w)){_=x,b=y;let j=w;w=M,M=j,S=C}S||(S=e,Xa(_,v,S));let E=Xl(_*2,m),P=o(S,E,w,h+1,u+_),I;if(P===2){let j=d(_),z=p(_)-j;I=l(j,z,!0,h+1,u+_,S)}else I=P&&r(_,a,o,l,c,u,h+1);if(I)return!0;C=t,Xa(b,v,C);let D=Xl(b*2,m),L=o(C,D,M,h+1,u+b),B;if(L===2){let j=d(b),z=p(b)-j;B=l(j,z,!0,h+1,u+b,C)}else B=L&&r(b,a,o,l,c,u,h+1);return!!B}}}(),Bde=function(){let e=new ul,t=new ul,i=new ke,n=new ao,r=new ao;return function s(a,o,l,c,u=null){let h=a*2,d=sf,p=xc,f=_c;if(u===null&&(l.boundingBox||l.computeBoundingBox(),n.set(l.boundingBox.min,l.boundingBox.max,c),u=n),Xl(h,p)){let v=o,m=v.index,g=v.attributes.position,y=l.index,x=l.attributes.position,_=Jd(a,f),b=I0(h,p);if(i.copy(c).invert(),l.boundsTree)return Xa(a,d,r),r.matrix.copy(i),r.needsUpdate=!0,l.boundsTree.shapecast({intersectsBounds:w=>r.intersectsBox(w),intersectsTriangle:w=>{w.a.applyMatrix4(c),w.b.applyMatrix4(c),w.c.applyMatrix4(c),w.needsUpdate=!0;for(let M=_*3,S=(b+_)*3;M<S;M+=3)if(ka(t,M,m,g),t.needsUpdate=!0,w.intersectsTriangle(t))return!0;return!1}});for(let w=_*3,M=b+_*3;w<M;w+=3){ka(e,w,m,g),e.a.applyMatrix4(i),e.b.applyMatrix4(i),e.c.applyMatrix4(i),e.needsUpdate=!0;for(let S=0,C=y.count;S<C;S+=3)if(ka(t,S,y,x),t.needsUpdate=!0,e.intersectsTriangle(t))return!0}}else{let v=a+8,m=f[a+6];return Xa(v,d,Nd),!!(u.intersectsBox(Nd)&&s(v,o,l,c,u)||(Xa(m,d,Nd),u.intersectsBox(Nd)&&s(m,o,l,c,u)))}}}();function px(e,t,i,n){return Xa(e,t,Nd),i.intersectBox(Nd,n)}var aM=[],Wv,sf,xc,_c;function pm(e){Wv&&aM.push(Wv),Wv=e,sf=new Float32Array(e),xc=new Uint16Array(e),_c=new Uint32Array(e)}function E1(){Wv=null,sf=null,xc=null,_c=null,aM.length&&pm(aM.pop())}var vb=Symbol("skip tree generation"),yb=new Vi,xb=new Vi,Du=new ke,Xc=new ao,Bf=new ao,Nf=new T,A1=new T,Nde=new T,Ude=new T,Fde=new T,Q9=new Vi,Ea=new PU(()=>new ul),Hm=class{static serialize(e,t={}){if(t.isBufferGeometry)return console.warn("MeshBVH.serialize: The arguments for the function have changed. See documentation for new signature."),Hm.serialize(arguments[0],{cloneBuffers:arguments[2]===void 0?!0:arguments[2]});t={cloneBuffers:!0,...t};let i=e.geometry,n=e._roots,r=i.getIndex(),s;return t.cloneBuffers?s={roots:n.map(a=>a.slice()),index:r.array.slice()}:s={roots:n,index:r.array},s}static deserialize(e,t,i={}){if(typeof i=="boolean")return console.warn("MeshBVH.deserialize: The arguments for the function have changed. See documentation for new signature."),Hm.deserialize(arguments[0],arguments[1],{setIndex:arguments[2]===void 0?!0:arguments[2]});i={setIndex:!0,...i};let{index:n,roots:r}=e,s=new Hm(t,{...i,[vb]:!0});if(s._roots=r,i.setIndex){let a=t.getIndex();if(a===null){let o=new gt(e.index,1,!1);t.setIndex(o)}else a.array!==n&&(a.array.set(n),a.needsUpdate=!0)}return s}constructor(e,t={}){if(e.isBufferGeometry){if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw new Error("MeshBVH: Only BufferGeometries are supported.");if(t=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,[vb]:!1},t),t.useSharedArrayBuffer&&typeof SharedArrayBuffer>"u")throw new Error("MeshBVH: SharedArrayBuffer is not available.");this._roots=null,t[vb]||(this._roots=Mde(e,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new Vi))),this.geometry=e}refit(e=null){e&&Array.isArray(e)&&(e=new Set(e));let t=this.geometry,i=t.index.array,n=t.attributes.position,r,s,a,o,l=0,c=this._roots;for(let h=0,d=c.length;h<d;h++)r=c[h],s=new Uint32Array(r),a=new Uint16Array(r),o=new Float32Array(r),u(0,l),l+=r.byteLength;function u(h,d,p=!1){let f=h*2;if(a[f+15]===65535){let v=s[h+6],m=a[f+14],g=1/0,y=1/0,x=1/0,_=-1/0,b=-1/0,w=-1/0;for(let M=3*v,S=3*(v+m);M<S;M++){let C=i[M],E=n.getX(C),P=n.getY(C),I=n.getZ(C);E<g&&(g=E),E>_&&(_=E),P<y&&(y=P),P>b&&(b=P),I<x&&(x=I),I>w&&(w=I)}return o[h+0]!==g||o[h+1]!==y||o[h+2]!==x||o[h+3]!==_||o[h+4]!==b||o[h+5]!==w?(o[h+0]=g,o[h+1]=y,o[h+2]=x,o[h+3]=_,o[h+4]=b,o[h+5]=w,!0):!1}else{let v=h+8,m=s[h+6],g=v+d,y=m+d,x=p,_=!1,b=!1;e?x||(_=e.has(g),b=e.has(y),x=!_&&!b):(_=!0,b=!0);let w=x||_,M=x||b,S=!1;w&&(S=u(v,d,x));let C=!1;M&&(C=u(m,d,x));let E=S||C;if(E)for(let P=0;P<3;P++){let I=v+P,D=m+P,L=o[I],B=o[I+3],j=o[D],z=o[D+3];o[h+P]=L<j?L:j,o[h+P+3]=B>z?B:z}return E}}}traverse(e,t=0){let i=this._roots[t],n=new Uint32Array(i),r=new Uint16Array(i);s(0);function s(a,o=0){let l=a*2,c=r[l+15]===65535;if(c){let u=n[a+6],h=r[l+14];e(o,c,new Float32Array(i,a*4,6),u,h)}else{let u=a+8,h=n[a+6],d=n[a+7];e(o,c,new Float32Array(i,a*4,6),d)||(s(u,o+1),s(h,o+1))}}}raycast(e,t=ya){let i=this._roots,n=this.geometry,r=[],s=t.isMaterial,a=Array.isArray(t),o=n.groups,l=s?t.side:t;for(let c=0,u=i.length;c<u;c++){let h=a?t[o[c].materialIndex].side:l,d=r.length;if(pm(i[c]),rM(0,n,h,e,r),E1(),a){let p=o[c].materialIndex;for(let f=d,v=r.length;f<v;f++)r[f].face.materialIndex=p}}return r}raycastFirst(e,t=ya){let i=this._roots,n=this.geometry,r=t.isMaterial,s=Array.isArray(t),a=null,o=n.groups,l=r?t.side:t;for(let c=0,u=i.length;c<u;c++){let h=s?t[o[c].materialIndex].side:l;pm(i[c]);let d=sM(0,n,h,e);E1(),d!=null&&(a==null||d.distance<a.distance)&&(a=d,s&&(d.face.materialIndex=o[c].materialIndex))}return a}intersectsGeometry(e,t){let i=this.geometry,n=!1;for(let r of this._roots)if(pm(r),n=Bde(0,i,e,t),E1(),n)break;return n}shapecast(e,t,i){let n=this.geometry;if(e instanceof Function){if(t){let h=t;t=(d,p,f,v)=>{let m=p*3;return h(d,m,m+1,m+2,f,v)}}e={boundsTraverseOrder:i,intersectsBounds:e,intersectsTriangle:t,intersectsRange:null},console.warn("MeshBVH: Shapecast function signature has changed and now takes an object of callbacks as a second argument. See docs for new signature.")}let r=Ea.getPrimitive(),{boundsTraverseOrder:s,intersectsBounds:a,intersectsRange:o,intersectsTriangle:l}=e;if(o&&l){let h=o;o=(d,p,f,v,m)=>h(d,p,f,v,m)?!0:Z9(d,p,n,l,f,v,r)}else o||(l?o=(h,d,p,f)=>Z9(h,d,n,l,p,f,r):o=(h,d,p)=>p);let c=!1,u=0;for(let h of this._roots){if(pm(h),c=Ode(0,n,a,o,s,u),E1(),c)break;u+=h.byteLength}return Ea.releasePrimitive(r),c}bvhcast(e,t,i){let{intersectsRanges:n,intersectsTriangles:r}=i,s=this.geometry.index,a=this.geometry.attributes.position,o=e.geometry.index,l=e.geometry.attributes.position;Du.copy(t).invert();let c=Ea.getPrimitive(),u=Ea.getPrimitive();if(r){let d=function(p,f,v,m,g,y,x,_){for(let b=v,w=v+m;b<w;b++){ka(u,b*3,o,l),u.a.applyMatrix4(t),u.b.applyMatrix4(t),u.c.applyMatrix4(t),u.needsUpdate=!0;for(let M=p,S=p+f;M<S;M++)if(ka(c,M*3,s,a),c.needsUpdate=!0,r(c,u,M,b,g,y,x,_))return!0}return!1};if(n){let p=n;n=function(f,v,m,g,y,x,_,b){return p(f,v,m,g,y,x,_,b)?!0:d(f,v,m,g,y,x,_,b)}}else n=d}e.getBoundingBox(xb),xb.applyMatrix4(t);let h=this.shapecast({intersectsBounds:d=>xb.intersectsBox(d),intersectsRange:(d,p,f,v,m,g)=>(yb.copy(g),yb.applyMatrix4(Du),e.shapecast({intersectsBounds:y=>yb.intersectsBox(y),intersectsRange:(y,x,_,b,w)=>n(d,p,y,x,v,m,b,w)}))});return Ea.releasePrimitive(c),Ea.releasePrimitive(u),h}intersectsBox(e,t){return Xc.set(e.min,e.max,t),Xc.needsUpdate=!0,this.shapecast({intersectsBounds:i=>Xc.intersectsBox(i),intersectsTriangle:i=>Xc.intersectsTriangle(i)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t,i={},n={},r=0,s=1/0){e.boundingBox||e.computeBoundingBox(),Xc.set(e.boundingBox.min,e.boundingBox.max,t),Xc.needsUpdate=!0;let a=this.geometry,o=a.attributes.position,l=a.index,c=e.attributes.position,u=e.index,h=Ea.getPrimitive(),d=Ea.getPrimitive(),p=A1,f=Nde,v=null,m=null;n&&(v=Ude,m=Fde);let g=1/0,y=null,x=null;return Du.copy(t).invert(),Bf.matrix.copy(Du),this.shapecast({boundsTraverseOrder:_=>Xc.distanceToBox(_),intersectsBounds:(_,b,w)=>w<g&&w<s?(b&&(Bf.min.copy(_.min),Bf.max.copy(_.max),Bf.needsUpdate=!0),!0):!1,intersectsRange:(_,b)=>{if(e.boundsTree)return e.boundsTree.shapecast({boundsTraverseOrder:w=>Bf.distanceToBox(w),intersectsBounds:(w,M,S)=>S<g&&S<s,intersectsRange:(w,M)=>{for(let S=w*3,C=(w+M)*3;S<C;S+=3){ka(d,S,u,c),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(let E=_*3,P=(_+b)*3;E<P;E+=3){ka(h,E,l,o),h.needsUpdate=!0;let I=h.distanceToTriangle(d,p,v);if(I<g&&(f.copy(p),m&&m.copy(v),g=I,y=E/3,x=S/3),I<r)return!0}}}});{let w=u?u.count:c.count;for(let M=0,S=w;M<S;M+=3){ka(d,M,u,c),d.a.applyMatrix4(t),d.b.applyMatrix4(t),d.c.applyMatrix4(t),d.needsUpdate=!0;for(let C=_*3,E=(_+b)*3;C<E;C+=3){ka(h,C,l,o),h.needsUpdate=!0;let P=h.distanceToTriangle(d,p,v);if(P<g&&(f.copy(p),m&&m.copy(v),g=P,y=C/3,x=M/3),P<r)return!0}}}}}),Ea.releasePrimitive(h),Ea.releasePrimitive(d),g===1/0?null:(i.point?i.point.copy(f):i.point=f.clone(),i.distance=g,i.faceIndex=y,n&&(n.point?n.point.copy(m):n.point=m.clone(),n.point.applyMatrix4(Du),f.applyMatrix4(Du),n.distance=f.sub(n.point).length(),n.faceIndex=x),i)}closestPointToPoint(e,t={},i=0,n=1/0){let r=i*i,s=n*n,a=1/0,o=null;if(this.shapecast({boundsTraverseOrder:c=>(Nf.copy(e).clamp(c.min,c.max),Nf.distanceToSquared(e)),intersectsBounds:(c,u,h)=>h<a&&h<s,intersectsTriangle:(c,u)=>{c.closestPointToPoint(e,Nf);let h=e.distanceToSquared(Nf);return h<a&&(A1.copy(Nf),a=h,o=u),h<r}}),a===1/0)return null;let l=Math.sqrt(a);return t.point?t.point.copy(A1):t.point=A1.clone(),t.distance=l,t.faceIndex=o,t}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach(t=>{Xa(0,new Float32Array(t),Q9),e.union(Q9)}),e}},Uf=Gp(iZ()),zde=.5*(Math.sqrt(3)-1),Ff=(3-Math.sqrt(3))/6,kde=1/3,Aa=1/6,Gm=e=>Math.floor(e)|0,K9=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),_b=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function bb(e=Math.random){let t=DU(e),i=new Float64Array(t).map(r=>K9[r%12*2]),n=new Float64Array(t).map(r=>K9[r%12*2+1]);return function(r,s){let a=0,o=0,l=0,c=(r+s)*zde,u=Gm(r+c),h=Gm(s+c),d=(u+h)*Ff,p=u-d,f=h-d,v=r-p,m=s-f,g,y;v>m?(g=1,y=0):(g=0,y=1);let x=v-g+Ff,_=m-y+Ff,b=v-1+2*Ff,w=m-1+2*Ff,M=u&255,S=h&255,C=.5-v*v-m*m;if(C>=0){let I=M+t[S],D=i[I],L=n[I];C*=C,a=C*C*(D*v+L*m)}let E=.5-x*x-_*_;if(E>=0){let I=M+g+t[S+y],D=i[I],L=n[I];E*=E,o=E*E*(D*x+L*_)}let P=.5-b*b-w*w;if(P>=0){let I=M+1+t[S+1],D=i[I],L=n[I];P*=P,l=P*P*(D*b+L*w)}return 70*(a+o+l)}}function Vde(e=Math.random){let t=DU(e),i=new Float64Array(t).map(s=>_b[s%12*3]),n=new Float64Array(t).map(s=>_b[s%12*3+1]),r=new Float64Array(t).map(s=>_b[s%12*3+2]);return function(s,a,o){let l,c,u,h,d=(s+a+o)*kde,p=Gm(s+d),f=Gm(a+d),v=Gm(o+d),m=(p+f+v)*Aa,g=p-m,y=f-m,x=v-m,_=s-g,b=a-y,w=o-x,M,S,C,E,P,I;_>=b?b>=w?(M=1,S=0,C=0,E=1,P=1,I=0):_>=w?(M=1,S=0,C=0,E=1,P=0,I=1):(M=0,S=0,C=1,E=1,P=0,I=1):b<w?(M=0,S=0,C=1,E=0,P=1,I=1):_<w?(M=0,S=1,C=0,E=0,P=1,I=1):(M=0,S=1,C=0,E=1,P=1,I=0);let D=_-M+Aa,L=b-S+Aa,B=w-C+Aa,j=_-E+2*Aa,z=b-P+2*Aa,O=w-I+2*Aa,H=_-1+3*Aa,k=b-1+3*Aa,N=w-1+3*Aa,F=p&255,Q=f&255,G=v&255,K=.6-_*_-b*b-w*w;if(K<0)l=0;else{let re=F+t[Q+t[G]];K*=K,l=K*K*(i[re]*_+n[re]*b+r[re]*w)}let W=.6-D*D-L*L-B*B;if(W<0)c=0;else{let re=F+M+t[Q+S+t[G+C]];W*=W,c=W*W*(i[re]*D+n[re]*L+r[re]*B)}let se=.6-j*j-z*z-O*O;if(se<0)u=0;else{let re=F+E+t[Q+P+t[G+I]];se*=se,u=se*se*(i[re]*j+n[re]*z+r[re]*O)}let ie=.6-H*H-k*k-N*N;if(ie<0)h=0;else{let re=F+1+t[Q+1+t[G+1]];ie*=ie,h=ie*ie*(i[re]*H+n[re]*k+r[re]*N)}return 32*(l+c+u+h)}}function DU(e){let t=new Uint8Array(512);for(let i=0;i<512/2;i++)t[i]=i;for(let i=0;i<512/2-1;i++){let n=i+~~(e()*(256-i)),r=t[i];t[i]=t[n],t[n]=r}for(let i=256;i<512;i++)t[i]=t[i-256];return t}var js=new Gn,Hde=class{constructor(e){this.weightAttribute=null;let t=e.geometry;if(!t.isBufferGeometry||t.attributes.position.itemSize!==3)throw new Error("THREE.MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");t.index&&(t=t.toNonIndexed()),this.geometry=t,this.randomFunction=Math.random,this.positionAttribute=this.geometry.getAttribute("position"),this.distribution=null}build(){let e=this.positionAttribute,t=new Float32Array(e.count/3);for(let n=0;n<e.count;n+=3){let r=1;js.a.fromBufferAttribute(e,n),js.b.fromBufferAttribute(e,n+1),js.c.fromBufferAttribute(e,n+2),r*=js.getArea(),t[n/3]=r}this.distribution=new Float32Array(e.count/3);let i=0;for(let n=0;n<t.length;n++)i+=t[n],this.distribution[n]=i;return this}setRandomGenerator(e){return this.randomFunction=e,this}sample(e,t){if(this.distribution){let i=this.distribution[this.distribution.length-1],n=this.binarySearch(this.randomFunction()*i);return this.sampleFace(n,e,t)}}binarySearch(e){if(!this.distribution)return 0;let t=this.distribution,i=0,n=t.length-1,r=-1;for(;i<=n;){let s=Math.ceil((i+n)/2);if(s===0||t[s-1]<=e&&t[s]>e){r=s;break}else e<t[s]?n=s-1:i=s+1}return r}sampleFace(e,t,i){let n=this.randomFunction(),r=this.randomFunction();return n+r>1&&(n=1-n,r=1-r),js.a.fromBufferAttribute(this.positionAttribute,e*3),js.b.fromBufferAttribute(this.positionAttribute,e*3+1),js.c.fromBufferAttribute(this.positionAttribute,e*3+2),t.set(0,0,0).addScaledVector(js.a,n).addScaledVector(js.b,r).addScaledVector(js.c,1-(n+r)),js.getNormal(i),this}},Gde=Gp(yB()),jde=new ke,Wde=new ke,Xde=new ke,N0;(e=>{function t(i){return i&&i.__isSPEObject}e.is=t})(N0||(N0={}));var pA=e=>class extends e{constructor(){super(...arguments),this.previousModelViewMatrix=new ke,this.copyPreviousMatrix=!0,this.hiddenMatrix=new ke,this.matrixWorldRigid=new ke,this.shearScale=new ke,this.shearScaleInv=new ke}get __isSPEObject(){return!0}isDescendantOf(t){t instanceof $t&&(t=t.uuid);let i=this;for(;i.parent;){if(i.parent.uuid===t)return!0;i=i.parent}return!1}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);for(let i of this.children)i.updateMatrixWorld(t)}updateWorldMatrix(t,i){let n=this.parent;if(t&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),i)for(let r of this.children)r.updateWorldMatrix(!1,!0)}traverseChildren(t,i=0){for(let n of this.children)N0.is(n)&&n.traverseObject(t,i+1)}traverseObject(t,i=0){if(t(this,i)!==!0)for(let n of this.children)N0.is(n)&&n.traverseObject(t,i+1)}updateMatrixWorldSVD(){let t=this.matrixWorld.elements,i=[[t[0],t[4],t[8]],[t[1],t[5],t[9]],[t[2],t[6],t[10]]],{u:n,v:r,q:s}=(0,Gde.SVD)(i),a=jde.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1),o=Wde.set(r[0][0],r[0][1],r[0][2],0,r[1][0],r[1][1],r[1][2],0,r[2][0],r[2][1],r[2][2],0,0,0,0,1),l=Xde.copy(o).transpose();this.shearScale.makeScale(s[0],s[1],s[2]).multiply(l).premultiply(o),this.shearScaleInv.copy(this.shearScale).invert(),this.matrixWorldRigid.multiplyMatrices(a,l).copyPosition(this.matrixWorld),s.every(c=>Math.abs(s[0]-c)<.01)?this.hasNonUniformScale=!1:this.hasNonUniformScale=!0}attach(t,i){this.updateWorldMatrix(!0,!1);let n=new ke().copy(this.matrixWorld).invert();return t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),n.multiply(t.parent.matrixWorld)),"hiddenMatrix"in t&&t.hiddenMatrix instanceof ke?t.hiddenMatrix.premultiply(n):t.applyMatrix4(n),t.updateWorldMatrix(!1,!1),this.add(t),i!==void 0&&(this.children.pop(),this.children.splice(i,0,t)),this}copy(t,i=!1){return super.copy(t,i),this.hasNonUniformScale=t.hasNonUniformScale,this}onAfterRender(t,i,n,r,s,a){this.copyPreviousMatrix&&this.previousModelViewMatrix.copy(this.modelViewMatrix)}},qde=class extends pA($t){},Yde=e=>e.type==="Mesh",Wn=class extends qde{constructor(e){super(),this.object=e,this.matrixAutoUpdate=!1,this.hasNonUniformScale=e.hasNonUniformScale}raycast(e,t){}expand(){let e=0,t=this.object.entityChildren(e);for(;t;){let i=this.children[e];(i==null?void 0:i.object)!==t&&(i&&this.remove(i),i=new Wn(t),this.add(i),this.children.splice(e,0,this.children.pop()),i.matrixWorldNeedsUpdate=!0,i.matrixAutoUpdate=!1,i.matrix=t.matrix,i.hiddenMatrix=t.hiddenMatrix),i.expand(),e+=1,t=this.object.entityChildren(e)}for(;this.children.length>e;)this.remove(this.children[e])}get visible(){var e;return this.playModeVisible!==void 0?this.playModeVisible:this.object.visible||this.object.dataPatched.visible&&((e=this.object.dataPatched.cloner)==null?void 0:e.hideBase)===!0}set visible(e){}get castShadow(){return this.object.castShadow}set castShadow(e){}get receiveShadow(){return this.object.receiveShadow}set receiveShadow(e){}get isMesh(){return Yde(this.object)}get isLight(){return this.object.isLight}get layers(){return this.object.layers}set layers(e){}get isCamera(){return!1}get geometry(){if(this.object.geometry)return this.object.geometry}get material(){if(this.object.material)return this.object.material}},uh=new T,dh=new T,ep=new ke,LU=[new T(-1,1,1),new T(-1,-1,1),new T(1,-1,1),new T(1,1,1),new T(-1,1,-1),new T(-1,-1,-1),new T(1,-1,-1),new T(1,1,-1)],Zde=[[0,3],[1,2],[5,6],[4,7],[0,1],[3,2],[7,6],[4,5],[0,4],[1,5],[2,6],[3,7]],Qde=[[0,2],[7,5],[4,1],[3,6],[4,3],[1,6]],$9=(e,t,i)=>{e.updateEntityBoxSize(uh,dh),ep.copy(t).multiply(e.matrixWorld),dh.x===0&&dh.y===0&&dh.z===0?i.push(new T(uh.x,uh.y,uh.z).applyMatrix4(ep)):LU.forEach(n=>{i.push(n.clone().multiply(dh).add(uh).applyMatrix4(ep))})},J9=class extends Vi{constructor(){super(...arguments),this.matrix=new ke,this.vertices=[],this.faces=[],this.edges=[],this.centerEdges=[]}copy(e){return super.copy(e),this.matrix.copy(e.matrix),this.vertices=e.vertices.map(t=>t.clone()),this.faces=e.faces.map(t=>t.clone()),this.edges=e.edges.map(t=>t.clone()),this.centerEdges=e.centerEdges.map(t=>t.clone()),this}setFromObjectSize(e,t=!1){e.updateWorldMatrix(!1,t),this.makeEmpty(),this.matrix.copy(e.matrixWorld);let i=new ke().copy(e.matrixWorld).invert();return this.expandByObjectSize(e,i,t)}expandByObjectSize(e,t,i=!1){let n=[];return i===!0?e.traverseEntity(r=>{if(r.visible||r.cloner&&r.data.visible){if(!("geometry"in r)){n.push(new T);return}$9(r,t,n)}}):$9(e,t,n),this.setFromPoints(n)}getCenter(e){return e=super.getCenter(e),e.applyMatrix4(this.matrix),e}getPositionToCenter(e){return e=super.getCenter(e),e.applyMatrix4(ep.copy(this.matrix).setPosition(0,0,0)),e}computeVertices(){this.getSize(dh).multiplyScalar(.5),this.getCenter(uh),ep.copy(this.matrix).setPosition(uh),this.vertices=LU.map(e=>e.clone().multiply(dh).applyMatrix4(ep))}computeEdges(){this.vertices.length>0&&this.computeVertices(),this.edges=Zde.map(([e,t])=>new Is(this.vertices[e],this.vertices[t])),this.centerEdges=this.edges.map(e=>e.getCenter(new T))}computeFaces(){this.vertices.length>0&&this.computeVertices(),this.faces=Qde.map(([e,t])=>this.vertices[e].clone().add(this.vertices[t]).multiplyScalar(.5))}},tc={Cloner:()=>{},changeEntityProptotype:()=>{},createEntity:()=>{}},Kde=class extends XB{constructor(){super()}getPoints(e=12){let t=[],i,n=this.getCurveLengths(),r=n[n.length-1]/n.length;for(let s=0,a=this.curves;s<a.length;s++){let o=a[s],l=s===0?n[s]:n[s]-n[s-1],c=Math.ceil(e*l/r),u=o.getPoints(c);for(let h=0;h<u.length;h++){let d=u[h];i&&i.equals(d)||(t.push(d),i=d)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}},oM=.001;function lM(e,t,i){return t.clone().sub(e).cross(t.clone().sub(i)).length()<=oM}function wb(e,t){let i=new T(...e.position),n=new T(...e.controlNext.position),r=new T(...t.controlPrevious.position),s=new T(...t.position);return lM(i,n,s)&&lM(i,r,s)}function RU(e){let t=e.points.map(u=>new T(...u.data.position)),i=[e.points[0]],n=new T(...i[0].data.position);for(let u=0;u<e.points.length-1;u++)lM(n,t[u],t[u+1])||(i.push(e.points[u]),n=t[u]);i.push(e.points[e.points.length-1]);let r=e.isClosed,s=i.length-(r?0:1),a=i.length,o=[];for(let u=0;u<a;u++){let h=i[u].data,d=new T(...h.position),p=new T(...h.controlPrevious.position),f=new T(...h.controlNext.position),v={position:d,baseRoundness:h.roundness,controlPrevious:p,controlNext:f};if(h.roundness===0||!e.isClosed&&(u===0||u===a-1)){o[u]={...v,removedLength:0};continue}let m=r&&u==0?a-1:u-1,g=r&&u==a-1?0:u+1,y=i[m].data,x=i[g].data,_=new T(...y.position),b=new T(...x.position),w=_.clone().sub(d).normalize(),M=b.clone().sub(d).normalize();Object.assign(v,{prevDir:w,nextDir:M});let S=wb(y,h),C=wb(h,x);if(!S||!C)o[u]={...v,removedLength:0};else{let E=w.clone().add(M).normalize(),P=E.clone().cross(w).length()/w.dot(E);o[u]={...v,tan:P,removedLength:h.roundness/P}}}for(let u=0;u<s;u++){let h=u,d=r&&u===a-1?0:u+1,p=o[h],f=o[d];if(p.removedLength!==0||f.removedLength!==0){let v=p.position.distanceTo(f.position);p.removedLength=Math.min(p.removedLength,v/2),f.removedLength=Math.min(f.removedLength,v/2)}}let l=[];for(let u=0;u<s;u++){let h=u,d=r&&u===a-1?0:u+1,p=o[h],f=o[d],v=null;if(!wb(i[h].data,i[d].data))p.position.distanceTo(f.position)>oM&&(v=new kv(p.position,p.controlNext,f.controlPrevious,f.position));else{let m=p.position.clone(),g=f.position.clone();(p.removedLength!==0||f.removedLength!==0)&&(p.nextDir&&m.add(p.nextDir.clone().setLength(p.removedLength)),f.prevDir&&g.add(f.prevDir.clone().setLength(f.removedLength))),m.distanceTo(g)>oM&&(v=new kv(m,m.clone().lerp(g,.3),g.clone().lerp(m,.3),g))}l[2*u+1]=v}for(let u=0;u<a;u++){let h=o[u];if(h.removedLength===0){l[2*u]=null;continue}let d=h.position,p=h.prevDir.clone().multiplyScalar(h.removedLength).add(d),f=h.nextDir.clone().multiplyScalar(h.removedLength).add(d),v=h.tan*h.removedLength,m=h.prevDir.clone().add(h.nextDir).normalize(),g=p.clone().lerp(f,.5),y=p.distanceTo(f)/2,x=m.clone().multiplyScalar(Math.sqrt(Math.pow(v,2)-Math.pow(y,2))).add(g),_=m.clone().multiplyScalar(-v).add(x),b=d.distanceTo(_)/d.distanceTo(g),w=h.prevDir.clone().multiplyScalar(b*d.distanceTo(p)).add(d),M=w.clone().lerp(_,2),S=p.clone().lerp(w,4/3),C=f.clone().lerp(M,4/3);l[2*u]=new kv(p,S,C,f)}let c=new Kde;return l.forEach(u=>{u&&c.add(u)}),c}var Vt;(e=>{function t(i){return i&&i.__isEntity}e.is=t})(Vt||(Vt={}));var Go=e=>Vt.is(e),$de={type:"completeState",isfromEntity:!0},fA=e=>class extends pA(e){constructor(){super(...arguments),this.raycastLock=!1,this.scaleLock=!1,this.disposed=!1,this.stateSelection=null,this.instances=[],this.prevState=null,this.currentState=null,this.reversibleToState=null,this.currentTransitionEvent=null,this.previousAction=null,this._singleBBox=new J9,this._recursiveBBox=new J9,this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0,this._needApplyPathSnapping=!0,this.attachedPaths=new Set}get __isEntity(){return!0}entityChildren(t){let i=this.children[t];if(Vt.is(i))return i}entityChildrenCount(){let t=this.children.length;for(;t--;)if(Vt.is(this.children[t]))return t+1;return 0}get isConcreteEntity(){return typeof this.identity=="string"}get isVirtualEntity(){return typeof this.identity!="string"}get isInstanceRoot(){return this.isConcreteEntity&&this.data.type==="Instance"}nearestInstanceSelfOrParent(){let t=this;for(;t.data.type!=="Instance";){let i=t.parent;if(Vt.is(i))t=i;else return}return t}forInstancesRec(t){this.instances.forEach(i=>{i.disposed||t(i),i.forInstancesRec(t)})}super_Entity(t,i){typeof t=="string"&&(this.uuid=t),this.identity=t,this.data=i,this.matrixAutoUpdate=!1,this.dataPatched=this.data}changeSelectedState(t,i,n=!1){if(!(this.data.states.length===0&&!n)){for(let r of this.data.states)_h.toOps(this.data,r.data).forEach(s=>{let a=CS.replaceProps(s,this.data);this.dataPatched=this.data,this.updateByPatchedOp(a,this.data,i)});if(t!==null){let r=this.data.states.data(t);r&&(this.dataPatched=_h.patch(this.data,r),_h.toOps(this.data,r).forEach(s=>{this.updateByPatchedOp(s,this.dataPatched,i)}))}n&&this.updateTransformState(this.dataPatched),this.stateSelection=t,this.updatePathSnapping(this.dataPatched.pathSnapping)}}get singleBBox(){return this.singleBBoxNeedsUpdate&&(this.singleBBoxNeedsUpdate=!1,this._singleBBox.setFromObjectSize(this,!1),this._singleBBox.computeVertices(),this._singleBBox.computeEdges(),this._singleBBox.computeFaces()),this._singleBBox}get recursiveBBox(){return this.recursiveBBoxNeedsUpdate&&(this.recursiveBBoxNeedsUpdate=!1,this._recursiveBBox.setFromObjectSize(this,!0),this._recursiveBBox.computeVertices(),this._recursiveBBox.computeEdges(),this._recursiveBBox.computeFaces()),this._recursiveBBox}updateEntityBoxSize(t,i){t.setScalar(0),i.setScalar(0)}resetBBoxNeedsUpdateSelf(){this.singleBBoxNeedsUpdate=!0,this.recursiveBBoxNeedsUpdate=!0}resetBBoxNeedsUpdate(){this.resetBBoxNeedsUpdateSelf(),this.traverseAncestors(t=>{Go(t)&&t.resetBBoxNeedsUpdateSelf()}),this.traverseEntity(t=>{t.resetBBoxNeedsUpdateSelf()})}find(t){let i;return this.traverseEntity(n=>{n.uuid===t&&(i=n)}),i}traverseSortNextHelper(){let t=this.parent;if(t){let i=t.children,n=i.indexOf(this)+1;if(Vt.is(i[n]))return i[n];if(Vt.is(t))return t.traverseSortNextHelper()}}sortNext(){let t=this.children;return this.children.length>0&&Vt.is(this.children[0])?t[0]:this.traverseSortNextHelper()}goUp(t){let i=this;for(;t>0&&i!==null;)i=i.parent,t-=1;return i}hasAnccestorOrSelf(t){return this===t||this.hasAnccestor(t)}hasAnccestor(t){let i=this.parent;for(;i;){if(t===i)return!0;i=i.parent}return!1}countToAccestor(t){let i=0,n=this;for(;n!==t;){if(n===null)return-1;n=n.parent,i+=1}return i}forEachEntity(t){for(let i of this.children)Go(i)&&t(i)}traverseEntityAncestors(t){this.traverseAncestors(i=>{Vt.is(i)&&t(i)})}traverseConcreteEntity(t,i=0){if(t(this,i)!==!0)for(let n of this.children)Go(n)&&n.isConcreteEntity&&n.traverseEntity(t,i+1)}traverseEntity(t,i=0){if(t(this,i)!==!0)for(let n of this.children)Go(n)&&n.traverseEntity(t,i+1)}traverseVisibleEntity(t){t(this);for(let i of this.children)Go(i)&&i.visible&&i.traverseVisibleEntity(t)}updateMatrix(){super.updateMatrix(),this.cloner&&this.cloner.onObjUpdateMatrix(),this.dispatchEvent({type:"updateMatrix"})}copy(t,i=!1){return super.copy(t,i),this.dataPatched=t.dataPatched,this.raycastLock=t.raycastLock,this.scaleLock=t.scaleLock,this.hiddenMatrix.copy(t.hiddenMatrix),this}hasEntityChild(){return this.children.some(t=>Go(t))}isAncestorOf(t){if(this.uuid===t)return!1;let i=!1;return this.traverseEntity(n=>{n.uuid===t&&(i=!0)}),i}toObjectTransformState(t=[]){this.updateWorldMatrix(!0,!1);let i={position:this.position.toArray(),rotation:[this.rotation.x,this.rotation.y,this.rotation.z],scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};return MS(i,t)}updateTransformState(t){let i=!1;return t.position&&(this.position.fromArray(t.position),i=!0),t.rotation&&(this.rotation.fromArray(t.rotation),i=!0),t.scale&&(i=!0,this.scale.fromArray(t.scale)),t.hiddenMatrix!==void 0&&(i=!0,this.hiddenMatrix.fromArray(t.hiddenMatrix??Ep.identity)),i&&(this.updateMatrix(),this.resetBBoxNeedsUpdate(),this.invalidateClonerTransform(this),this.traverseEntityAncestors(n=>{n.invalidateClonerTransform(this)})),t.position&&t.rotation&&t.scale&&t.hiddenMatrix!==void 0&&this.updateWorldMatrix(!1,!0),i}dispose(){this.disposed=!0,this.cloner&&(this.cloner.removeFromParent(),this.cloner=void 0)}disposeChildrenRecursively(){for(let t of this.children)Vt.is(t)&&t.disposeRecursively()}disposeRecursively(){this.dispose(),this.children.forEach(t=>{Vt.is(t)&&t.disposeRecursively()})}toState(t=[]){let i={name:this.name,visible:this.visible,raycastLock:this.raycastLock,...this.toObjectTransformState(t)};return MS(i,t)}updateByObjUpdateOp(t,i){t!==void 0&&this.updateByOp({type:0,props:t,path:[]},{...this.data,...t},i,!1)}updateByOp(t,i,n,r){let s=this.data;this.data=i;let a=t,o=Ps(t.path,["states","*"]);if(o!==null){if(t.type===0){let[l]=o;if((this==null?void 0:this.stateSelection)===l){let c={...t.props};if(delete c.name,Object.values(t.props).some(u=>u===void 0)){let u=this.data;if(u!==void 0){let h=eo.zoom(u,t.path.slice(2));if(h)for(let d in t.props)t.props[d]===void 0&&d in h&&(c[d]=h[d])}}a={...t,props:c,path:t.path.slice(2)}}}}else if(t.type===0){let l=this.stateSelection?this.data.states.data(this.stateSelection):void 0;if(l!==void 0){if(t.props.name!==void 0&&l.name){let{name:u,...h}=l;l=h}if(t.props.material!==void 0&&"material"in l){let{material:u,...h}=l;l=h}let c=eo.removeOverridden(t.path,t.props,l);a={...t,props:c}}}if(this.updateByPatchedOpBase(a,_h.patch(this.data,this.stateSelection?this.data.states.data(this.stateSelection):void 0),n),Ps(t.path,["overrides"])){let l=[],c=[...t.path];for(l.push(c[1]),c.splice(0,2);c.length>0&&c[0]==="descendants";)l.push(c[1]),c.splice(0,2);if(l[l.length-1]===void 0){if(t.type===0)for(let u of Object.keys(t.props)){l[l.length-1]=u;let h=n.scene.findInstance([this.uuid,...l]);h&&(h.overrideData=t.props[u],h.updateState(vc.apply(h.component.data,h.overrideData),n))}}else{let u=n.scene.findInstance([this.uuid,...l]);if(u){let h=eo.zoom(u.component.data,c);if(t={...t,path:c},t.type===0){let d=t.props;if(h)for(let[p,f]of Object.entries(t.props))f===void 0&&(d===t.props&&(d={...t.props}),d[p]=h[p]);t={...t,props:d}}u.overrideData=ox.resolve(i.overrides,l),u.updateByOp(t,hr.applySimple(u.data,t),n,!1)}}}else if(this.instances.length>0){let l;if(t.path.length===0&&t.type===0){let c;for(let u of ec.rootOverrideProps)u in t.props&&(c===void 0&&(c={}),c[u]=t.props[u]);c&&(l={...t,props:c})}else for(let c of ec.rootOverrideProps)if(Ps(t.path,[c])){l=t;break}l!==void 0&&this.instances.forEach(c=>{if(c.isInstanceRoot){let u=vc.filterOp(c.overrideData,l);u&&c.updateByOp(u,hr.applySimple(c.data,u),n,!0)}}),this.instances.forEach(c=>{if(!c.isInstanceRoot){let u=vc.filterOp(c.overrideData,t);if(u){let h;s===c.data&&t===u?h=i:h=hr.applySimple(c.data,u),c.updateByOp(u,h,n,!0)}}})}}updateByPatchedOpBase(t,i,n){if(this.dataPatched=i,t.path.length===0&&t.type===0)t.props.type!==void 0&&!Yh.is(t.props.type)&&tc.changeEntityProptotype(this,i,n);else if(t.path.length===1&&t.path[0]==="geometry"&&t.type===0&&"type"in t.props){tc.changeEntityProptotype(this,i,n);for(let r of this.children)Vt.is(r)&&r.updateVisible()}this.updateByPatchedOp(t,i,n)}updateByPatchedOp(t,i,n){if(t.path.length===0&&t.type===0&&this.updateState(t.props,n),Ps(t.path,["pathSnapping"])!==null&&this.updatePathSnapping(i.pathSnapping),Ps(t.path,["cloner"])!==null){let r=hr.drop(t,1);r.path.length===0&&r.type===0&&r.props.disabled===!0?this.setFromClonerState(null,n):this.cloner?this.cloner.updateState(i.cloner,n.scene):(this.setFromClonerState(i.cloner,n),this.expandCloner(n.scene)),this.updateVisible()}}updatePathSnapping(t){this._updatedPathSnapping=t,this._needApplyPathSnapping=!0}get updatedPathSnapping(){return this._updatedPathSnapping}applyPathSnapping(t){var f,v,m,g,y;let i=((f=this._updatedPathSnapping)==null?void 0:f.pathId)??this.dataPatched.pathSnapping.pathId,n=((v=this._updatedPathSnapping)==null?void 0:v.slide)??this.dataPatched.pathSnapping.slide??0,r=((m=this._updatedPathSnapping)==null?void 0:m.offset)??this.dataPatched.pathSnapping.offset,s=((g=this._updatedPathSnapping)==null?void 0:g.orientation)??this.dataPatched.pathSnapping.orientation;if(i===null)return;let a=t.find(i);if(!a||this._needApplyPathSnapping===!1)return;this._needApplyPathSnapping=!1;let o=a.data;if(o.geometry.path.points.length<=1)return;let l=RU(o.geometry.path),c=(n+r)%1;n+r===1&&c===0&&(c=1);let u=l.getPointAt(c),h=this.parent?(y=this.parent)==null?void 0:y.matrixWorld:new ke;a.updateMatrixWorld();let d=new ke().multiplyMatrices(h.clone().invert(),a.matrixWorld);u.applyMatrix4(d);let p={position:u.toArray(),rotation:o.rotation};if(s==="tangential"){let x=new ke().extractRotation(a.matrixWorld),_=l.getTangentAt(c).applyMatrix4(x).add(u),b=new ke().lookAt(u,_,new T(0,1,0)),w=new bn().setFromRotationMatrix(b);p={...p,rotation:[w.x,w.y,w.z]}}this.updateTransformState(p),this.traverseEntity(x=>{x._cameraType&&x.dispatchEvent($de)})}updateVisible(){var t;this.visible=this.dataPatched.visible&&(!this.dataPatched.cloner||(this.dataPatched.cloner.disabled??!1)||((t=this.dataPatched.cloner)==null?void 0:t.hideBase)!==!0)}updateState_Entity(t,i){t.name!==void 0&&(this.name=t.name),t.raycastLock!==void 0&&(this.raycastLock=t.raycastLock),t.visible!==void 0&&(this.updateVisible(),this.resetBBoxNeedsUpdate()),i&&"cloner"in t&&t.cloner!==void 0&&(this.setFromClonerState(t.cloner,i),this.updateVisible()),this.updateTransformState(t)}get attachedSurfaceCloners(){return this.children.filter(t=>t instanceof tc.Cloner&&t.parameters.type==="toObject")}setFromClonerState(t,i){this.disposed||(t===null||t.disabled?(this.cloner&&this.cloner.removeFromParent(),this.cloner=void 0):this.cloner===void 0?(this.cloner=new tc.Cloner(this,t),i.scene.addPendingExpandCloner(this)):this.cloner.updateState(t,i.scene))}expandCloner(t){!this.disposed&&this.cloner&&this.cloner.expandClones(t)}invalidateClonerTransform(t){this.cloner&&this.cloner.invalidateTransform(t)}},IU=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:8,cornerSegments:8,hollow:0},e.parameters),n=i.width/2,r=i.radiusTop??n,s=i.radiusBottom??n;return r===s?(r=n,s=n):r>s?(r=n,s=s*n/r):(r=r*n/s,s=n),{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width),radiusTop:r,radiusBottom:s})}}static build(e){let{width:t,depth:i,height:n,radialSegments:r,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l,radiusTop:c,radiusBottom:u,cornerRadius:h,cornerSegments:d,hollow:p}=e.parameters,f;return h||p?f=new OU(c,u,n,r,s,a,o,l*Math.PI/180,h,h,d,p):f=new DE(c,u,n,r,s,a,o,l*Math.PI/180),f.scale(1,1,i/t),Object.assign(f,{userData:{...e,type:"CylinderGeometry"}})}};function Sl(e,t,i){i.x=e.x*t.x,i.y=e.y,i.z=e.x*t.y}function eP(e){return new te(e.y,-e.x)}var OU=class extends mt{constructor(e,t,i,n,r,s,a,o,l,c,u,h,d=!1){super(),this.type="RoundedCylinderBufferGeometry",e=e!==void 0?e:1,t=t!==void 0?t:1,i=i||1,n=Math.floor(n)||8,r=Math.floor(r)||1,s=s!==void 0?s:!1,a=a!==void 0?a:0,o=o!==void 0?o:Math.PI*2,s&&(l=0,c=0);let p=[],f=[],v=[],m=[],g=0,y=i/2,x=new T,_=new T;d&&e==0&&(e=l),d&&t==0&&(t=c);let b=new te(e,y),w=new te(t,-y),M=null,S=null,C=null,E=null,P=b.clone().sub(w),I=0,D=0,L=0;h>0&&(I=Math.min(e,t)*(1-h),D=e-I,L=t-I);let B=b.clone();B.x-=I;let j=Math.PI-P.angle(),z=P.angle(),O=Math.tan(z/2),H=Math.tan(j/2),k=O+H,N=h?k:H,F=h?k:O;if(l=Math.min(l,(e-D)/N,P.length()/k),c=Math.min(c,(t-L)/F,P.length()/k),l>0){let ie=l/O;M=b.clone().sub(new te(ie,l)),h&&(C=M.clone(),C.x-=I-k*l),b.sub(P.clone().setLength(ie))}if(c>0){let ie=c/H;S=w.clone().sub(new te(ie,-c)),w.add(P.clone().setLength(ie)),h&&(E=S.clone(),E.x-=I-k*c,B.sub(P.clone().setLength(ie)))}P=b.clone().sub(w);let Q=P.length()<.5,G=[];for(let ie=0;ie<=n;ie++){let re=[],de=ie/n,he=de*o+a,X=new te(Math.sin(he),Math.cos(he));E&&S?(K(re,de,X,j,c,E,-1,!0),K(re,de,X,z,c,S,-1,!1)):S?(W(re,X,S.x,0,-1),K(re,de,X,z,c,S,-1,!1)):s||W(re,X,t,L,-1);let Ee=eP(P).normalize();if(Sl(Ee,X,x),!Q)for(let Oe=0;Oe<=r;Oe++){let Me=Oe/r,Ne=P.clone().multiplyScalar(Me).add(w);Sl(Ne,X,_),f.push(_.x,_.y,_.z),v.push(x.x,x.y,x.z),m.push(de,.5+_.y/i),re.push(g++)}if(C&&M?(K(re,de,X,j,l,M,1,!1),K(re,de,X,z,l,C,1,!0)):M?(K(re,de,X,j,l,M,1,!1),W(re,X,M.x,0,1)):s||W(re,X,e,D,1),h&&!Q){let Oe=eP(P).multiplyScalar(-1).normalize();Sl(Oe,X,x);for(let Me=0;Me<=r;Me++){let Ne=Me/r,He=P.clone().multiplyScalar(-Ne).add(B);Sl(He,X,_),f.push(_.x,_.y,_.z),v.push(x.x,x.y,x.z),m.push(de,.5+_.y/i),re.push(g++)}}h&&!s&&re.push(re[0]),G.push(re)}for(let ie=0;ie<G.length-1;ie++)for(let re=0;re<G[0].length-1;re++){if(s&&h&&re==r)continue;let de=G[ie][re],he=G[ie+1][re],X=G[ie+1][re+1],Ee=G[ie][re+1],Oe=f[X*3+0],Me=f[X*3+2];p.push(de,he,Ee),(Oe!=0||Me!=0)&&p.push(he,X,Ee)}o<Math.PI*2&&(se(-1,G[0],a),se(1,G[G.length-1],a+o)),this.setIndex(p),this.setAttribute("position",new et(f,3)),this.setAttribute("normal",new et(v,3)),this.setAttribute("uv",new et(m,2));function K(ie,re,de,he,X,Ee,Oe,Me){for(let Ne=0;Ne<u+1;Ne++){let He=Ne/u,Pe=Oe<0?He:1-He;Me&&(Pe-=1),Pe*=he;let Ce=new te(Math.sin(Pe),Math.cos(Pe)*Oe),je=Ce.clone().multiplyScalar(X).add(Ee);Sl(je,de,_),f.push(_.x,_.y,_.z),Sl(Ce,de,x),v.push(x.x,x.y,x.z),m.push(re,.5+_.y/i),ie.push(g++)}}function W(ie,re,de,he,X){let Ee=new T,Oe=new te,Me=[de,he];X<0&&Me.reverse();for(let Ne of Me)Oe.set(Ne,y*X),Sl(Oe,re,Ee),f.push(Ee.x,Ee.y,Ee.z),v.push(0,X,0),m.push(.5,.5),ie.push(g++)}function se(ie,re,de){let he=new te(Math.sin(de),Math.cos(de)),X=new te(-Math.cos(de),Math.sin(de)),Ee=new T,Oe=ie<0?(He,Pe,Ce)=>p.push(He,Pe,Ce):(He,Pe,Ce)=>p.push(He,Ce,Pe),Me=new te((e+t+D+L)/4,0);Sl(Me,he,Ee),f.push(Ee.x,Ee.y,Ee.z),v.push(X.x,0,X.y),m.push(.5,.5);let Ne=g++;for(let He of re){let Pe=f.slice(He*3,He*3+3);f.push(...Pe),v.push(X.x,0,X.y);let Ce=m.slice(He*2,He*2+2);m.push(...Ce),g++}for(let He=Ne+1;He<g-1;He++)Oe(Ne,He,He+1);Oe(Ne,g-1,Ne+1)}}},Jde=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:32,heightSegments:8,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:8,cornerRadiusBottom:8,cornerSegments:8},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t,depth:i,height:n,radialSegments:r,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l,cornerRadiusTop:c,cornerRadiusBottom:u,cornerSegments:h}=e.parameters,d;return c>0||u>0||l<360?d=new OU(0,t/2,n,r,s,a,o,l*Math.PI/180,c,u,h,0,!0):d=new YB(t/2,n,r,s,a),d.scale(1,1,i/t),Object.assign(d,{userData:{...e,type:"ConeGeometry"}})}},epe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:8,cornerSegments:8},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t,height:i,depth:n,widthSegments:r,heightSegments:s,depthSegments:a,cornerRadius:o,cornerSegments:l}=e.parameters,c;return o==0?c=new ro(t,i,n,r,s,a):c=new tpe(t,i,n,r,s,a,o,l),Object.assign(c,{userData:{...e,type:"CubeGeometry"}})}},Sb=Math.PI/2,tpe=class extends mt{constructor(e=1,t=1,i=1,n=1,r=1,s=1,a=0,o=4){super(),this.type="BoxGeometry";let l=this;n=Math.floor(n),r=Math.floor(r),s=Math.floor(s),o=Math.floor(o),a=Math.min(a,e/2,t/2,i/2);let c=[],u=[],h=[],d=[],p=0,f=0;v("z","y","x",-1,-1,i,t,e,s,r,0),v("z","y","x",1,-1,i,t,-e,s,r,1),v("x","z","y",1,1,e,i,t,n,s,2),v("x","z","y",1,-1,e,i,-t,n,s,3),v("x","y","z",1,-1,e,t,i,n,r,4),v("x","y","z",-1,-1,e,t,-i,n,r,5),a>0&&(m("z","y","x",-1,-1,1,i,t,e,s,0),m("z","y","x",1,-1,-1,i,t,e,s,1),m("z","y","x",-1,1,-1,i,t,e,s,1),m("z","y","x",1,1,1,i,t,e,s,0),m("x","y","z",-1,-1,-1,e,t,i,n,0),m("x","y","z",1,-1,1,e,t,i,n,1),m("x","y","z",-1,1,1,e,t,i,n,0),m("x","y","z",1,1,-1,e,t,i,n,1),m("y","x","z",-1,-1,1,t,e,i,r,0),m("y","x","z",1,-1,-1,t,e,i,r,1),m("y","x","z",1,1,1,t,e,i,r,1),m("y","x","z",-1,1,-1,t,e,i,r,0),g(1,1,1),g(-1,1,1),g(1,-1,1),g(-1,-1,1),g(1,1,-1),g(-1,1,-1),g(1,-1,-1),g(-1,-1,-1)),this.setIndex(c),this.setAttribute("position",new et(u,3)),this.setAttribute("normal",new et(h,3)),this.setAttribute("uv",new et(d,2));function v(y,x,_,b,w,M,S,C,E,P,I){let D=(M-2*a)/E,L=(S-2*a)/P,B=M/2-a,j=S/2-a,z=C/2,O=E+1,H=P+1,k=0,N=0,F=new T;for(let Q=0;Q<H;Q++){let G=Q*L-j;for(let K=0;K<O;K++){let W=K*D-B;F[y]=W*b,F[x]=G*w,F[_]=z,u.push(F.x,F.y,F.z),F[y]=0,F[x]=0,F[_]=C>0?1:-1,h.push(F.x,F.y,F.z),d.push(K/E),d.push(1-Q/P),k+=1}}for(let Q=0;Q<P;Q++)for(let G=0;G<E;G++){let K=p+G+O*Q,W=p+G+O*(Q+1),se=p+(G+1)+O*(Q+1),ie=p+(G+1)+O*Q;c.push(K,W,ie),c.push(W,se,ie),N+=6}l.addGroup(f,N,I),f+=N,p+=k}function m(y,x,_,b,w,M,S,C,E,P,I){let D=(S-2*a)/P,L=S/2-a,B=C/2-a,j=E/2,z=P+1,O=0,H=0,k=new T,N=new T;for(let F=0;F<o+1;F++){let Q=F/o*Sb,G=Math.sin(Q)*a,K=(1-Math.cos(Q))*a,W=Math.sin(Q),se=Math.cos(Q);k[x]=(B+G)*w,k[_]=(j-K)*M,N[y]=0,N[x]=W*Math.sign(k[x]),N[_]=se*Math.sign(k[_]);for(let ie=0;ie<z;ie++){let re=ie*D-L;k[y]=re*b,u.push(k.x,k.y,k.z),h.push(N.x,N.y,N.z),d.push(ie/P),d.push(0),O+=1}}for(let F=0;F<o;F++)for(let Q=0;Q<P;Q++){let G=p+Q+z*F,K=p+Q+z*(F+1),W=p+(Q+1)+z*(F+1),se=p+(Q+1)+z*F;c.push(G,K,se),c.push(K,W,se),H+=6}l.addGroup(f,H,I),f+=H,p+=O}function g(y,x,_){let b=new T,w=new T(e/2,t/2,i/2);w.subScalar(a);let M=[],S=y*x*_>0?(E,P,I)=>c.push(E,P,I):(E,P,I)=>c.push(E,I,P);for(let E=0;E<=o;E++){let P=[],I=Sb*(1-E/o),D=Math.cos(I),L=Math.sin(I),B=0;for(let j=0;j<=E;j++){let z=Math.cos(B),O=Math.sin(B);b.x=D*z,b.y=L,b.z=D*O;let H=w.clone().addScaledVector(b,a);u.push(y*H.x,x*H.y,_*H.z),h.push(y*b.x,x*b.y,_*b.z),d.push(0,0),P.push(p++),B+=Sb/E}M.push(P)}let C=M.length-1;for(let E=0;E<C;E++){let P=M[E],I=M[E+1],D=P.length-1;S(P[0],I[1],I[0]);for(let L=1;L<=D;L++)S(P[L-1],P[L],I[L]),S(P[L],I[L+1],I[L])}}}},mA=class extends mt{constructor(e=[],t=[],i="",n=1,r=.2,s=4){super(),this.type="PolyhedronGeometryRound";let a=[],o=[],l=[];c(),u(),this.setAttribute("position",new et(a,3)),this.setAttribute("normal",new et(l,3)),this.setAttribute("uv",new et(o,2));return;function c(){var z;r=Math.min(1-1e-5,r),r==0&&(s=0);let h={IcosahedronGeometry:5,DodecahedronGeometry:3,HexahedronGeometry:3,OctahedronGeometry:4,TetrahedronGeometry:3}[i],d=new T,p=d.clone(),f=new Gn,v=r*n,m=n-v,g=s+1,y=new T,x=(O,H)=>y.subVectors(O,H).normalize(),_=(O,H)=>Array(O).fill(void 0).map(H),b=_(e.length/3,(O,H)=>new T().fromArray(e,H*3).setLength(n)),w=[],M=1e6;for(let O=0;O<b.length;O++){let H=b[O],k=[],N,F,Q,G=1e10,K=-1;for(;(K=t.indexOf(O,K+1))!=-1;){let re=K-K%3;N=t[re+(K+1)%3],F=t[re+(K+2)%3],Q=H.distanceToSquared(b[N]),G=Math.min(G,Q),k.push([N,F,Q])}G+=1e-6;let W=[],se=0,ie=k.length;for(let re=0;re<ie;re++){[N,F,Q]=k[se];let de=((z=w[N])==null?void 0:z.includes(O))==!0;Q<=G&&W.push(N+ +de*M),se=k.findIndex(he=>he[0]==F)}w.push(W)}let S=[];{let O=0,H=0,k,N,F=h==3;for(let Q=0;Q<=s;Q++){k=Q*(Q+1)/2,N=(Q+1)*(Q+2)/2;for(let G=0;G<s-Q;G++)[O,H]=[k+G+Q+2,N+G+Q+3],S.push(k,N,...F?[H,k]:[O,N],H,O),[k,N]=[O,H];S.push(k,N,k+s+2)}}let C=d.clone(),E=d.clone(),P=d.clone(),I=d.clone(),D=d.clone(),L=[],B=_(b.length,()=>_(h,()=>d.clone()));for(let O=0;O<b.length;O++){d.copy(b[O]).normalize(),C.copy(d).multiplyScalar(m);let H=w[O];for(let W=0;W<H.length;W++){let se=H[W],ie=H[(W+1)%h];f.setFromPointsAndIndices(b,O,se%M,ie%M),f.b.sub(f.a).setLength(1e10).add(f.a),f.c.sub(f.a).setLength(1e10).add(f.a),f.closestPointToPoint(C,B[O][W])}let k=[],N=[],F=[],Q=new T;s==0&&[...B[O]].reduce((W,se)=>W.add(se),Q).multiplyScalar(1/h);for(let W=0;W<h;W++){let se=[],ie=(W-1+h)%h,re=B[O][ie],de=B[O][W];d.copy(re).sub(C),p.copy(de).sub(C);let he=C.angleTo(d),X=d.angleTo(p),Ee=Math.cos(he)*v;s==0?E.copy(Q):E.copy(C).setLength(m+Ee),N.push(Ee);let Oe=[E,re,de];for(let Me=0;Me<2;Me++){let Ne=Oe[Me],He=Oe[Me+1];I.subVectors(Ne,C),D.subVectors(He,C),P.crossVectors(I,D).normalize();for(let Pe=0;Pe<g;Pe++){let Ce=[he,X][Me]*Pe/g;d.copy(I).applyAxisAngle(P,Ce).add(C),k.push(d.clone()),Me&&(x(d,C),se.push([Pe==0?Ne:d.clone(),y.clone()]))}Me&&(x(He,C),se.push([He,y.clone()]))}F.push(se)}L.push(F);let G=2*g,K=2;for(let W=0;W<h;W++){let se=G*W,ie=G*((W+1)%h),re=[k[se]];for(let he=1;he<g;he++){I=k[se+he],D=k[ie+he],re.push(I);for(let X=1,Ee=he-K+1;X<=Ee;X++)d.lerpVectors(I,D,X/(Ee+1)),d.sub(C).setLength(N[W]).add(C),re.push(d.clone());re.push(D)}for(let he=0;he<g;he++)re.push(k[he+g+se]);re.push(k[ie+g]);let de=S.map(he=>re[he]);a.push(...de.map(he=>[he.x,he.y,he.z]).flat()),l.push(...de.map(he=>(x(he,C),[y.x,y.y,y.z])).flat())}}let j=[];for(let O=0;O<w.length;O++)for(let H=0;H<h;H++){let k=w[O][H];if(k<M){let N=w[k].findIndex(G=>G%M==O),F=L[O][H],Q=L[k][N];for(let G=0;G<g;G++){let K=F[G],W=Q[g-G],se=F[G+1],ie=Q[g-(G+1)];[K,W,se,se,W,ie].forEach(re=>{a.push(re[0].x,re[0].y,re[0].z),l.push(re[1].x,re[1].y,re[1].z)})}j.push(F[0][0],Q[g][0],F[g][0],Q[0][0])}}for(;j.length;){let O,H,k,N;[O,H]=j.splice(0,2);let F=[O];for(;O!=H;)F.push(H),k=j.indexOf(H),N=k%2,H=j.splice(k-N,2)[1-N];y.subVectors(F[0],F[1]).cross(d.subVectors(F[0],F[2])).normalize();let Q=y.dot(F[0])<0;Q&&y.negate();for(let G=1;G<=F.length-2;G++)[F[G+ +Q],F[G+1-+Q],F[0]].forEach(K=>{a.push(K.x,K.y,K.z),l.push(y.x,y.y,y.z)})}}function u(){let h=new T;for(let w=0;w<a.length;w+=3){h.x=a[w+0],h.y=a[w+1],h.z=a[w+2];let M=_(h)/2/Math.PI+.5,S=b(h)/Math.PI+.5;o.push(M,1-S)}let d=new T,p=new T,f=new T,v=new T,m=new te,g=new te,y=new te,x=(w,M,S,C)=>{C<0&&w.x===1&&(o[M]=w.x-1),S.x===0&&S.z===0&&(o[M]=C/2/Math.PI+.5)};for(let w=0,M=0;w<a.length;w+=9,M+=6){d.set(a[w+0],a[w+1],a[w+2]),p.set(a[w+3],a[w+4],a[w+5]),f.set(a[w+6],a[w+7],a[w+8]),m.set(o[M+0],o[M+1]),g.set(o[M+2],o[M+3]),y.set(o[M+4],o[M+5]),v.copy(d).add(p).add(f).divideScalar(3);let S=_(v);x(m,M+0,d,S),x(g,M+2,p,S),x(y,M+4,f,S)}for(let w=0;w<o.length;w+=6){let M=o[w+0],S=o[w+2],C=o[w+4],E=Math.max(M,S,C),P=Math.min(M,S,C);E>.9&&P<.1&&(M<.2&&(o[w+0]+=1),S<.2&&(o[w+2]+=1),C<.2&&(o[w+4]+=1))}function _(w){return Math.atan2(w.z,-w.x)}function b(w){return Math.atan2(-w.y,Math.sqrt(w.x*w.x+w.z*w.z))}}}static fromJSON(e){return new mA(e.vertices,e.indices,e.radius,e.corner,e.cornerSides)}},ipe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t,height:i,depth:n,detail:r,corner:s,cornerSides:a}=e.parameters,o=r===0&&s!==0?new BU(t*.5,s,a):new ZB(t*.5,r);return o.scale(1,i/t,n/t),Object.assign(o,{userData:{...e,type:"DodecahedronGeometry"}})}},BU=class extends mA{constructor(e=1,t=.2,i=4){let n=(1+Math.sqrt(5))/2,r=1/n,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],o="DodecahedronGeometry";super(s,a,o,e,t,i),this.type=o}static fromJSON(e){return new BU(e.radius,e.corner,e.cornerSides)}},zf=1e-12,gA=class{constructor(e){this.position=new te,this.startPosition=new te,this.uuid=Dt.generateUUID(),this.position=e.clone()}start(){this.reset()}reset(){this.startPosition.copy(this.position)}applyOffset(e){this.position.copy(this.startPosition).add(e)}copy(e){return this.position.copy(e.position),this.startPosition.copy(e.startPosition),this}clone(){return new gA(this.position).copy(this)}toJSON(){return[this.position.x,this.position.y]}},cM=class extends gA{constructor(e){super(e.position),this.parent=e}copy(e){return super.copy(e),this}clone(){return new cM(this.parent).copy(this)}},tp=class extends gA{constructor(e,t){super(t),this.controls=[],this.roundness=0,this.areControlsDirectionsMirrored=!0,this.uuid=e,this.controls.push(new cM(this),new cM(this))}static create(e,t){let i=new tp(e,new te(...t.position));return i.controls[0].position.set(...t.controlPrevious.position),i.controls[1].position.set(...t.controlNext.position),i.roundness=t.roundness,i.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored,i}getOppositeControl(e){let t=this.controls.indexOf(e);return t===0?this.controls[1]:t===1?this.controls[0]:null}applyOffsetToControls(e,t=1){for(let i=0,n=this.controls.length;i<n;i++){let r=this.controls[i];this.position.distanceTo(r.position)<=t?r.position.copy(this.position):r.applyOffset(e)}}controlsMoved(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}copy(e){return super.copy(e),this.controls[0].copy(e.controls[0]),this.controls[1].copy(e.controls[1]),this.roundness=e.roundness,this.uuid=e.uuid,this}clone(){return new tp(this.uuid,this.position).copy(this)}toJSON(){return super.toJSON().concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}computeTangents(){var i,n;let e=(i=this.curveBefore)==null?void 0:i.getTangentAt(1),t=(n=this.curveAfter)==null?void 0:n.getTangentAt(0);return[e,t]}computeNormals(e=new te,t=new te){let[i,n]=this.computeTangents();return i&&n&&(tP(i,e),tP(n,t)),[e,t]}computeTangent(e=new te){let[t,i]=this.computeTangents();return t&&i&&e.copy(t).add(i).normalize(),e}computeNormal(e=new te){let[t,i]=this.computeNormals();return e.copy(t).add(i).normalize(),e}};function tP(e,t=new te){let i=e.length();return t.set(-e.y/i,e.x/i)}var vA=e=>e,af=new te,w2=new te,npe=new te,rpe=new te,spe=new te,ape=new te,NU=new T,UU=new T;function ope(e){let t=new te;t.addVectors(e.v0,af.subVectors(e.v1,e.v0).multiplyScalar(2/3));let i=new te;return i.addVectors(e.v2,w2.subVectors(e.v1,e.v2).multiplyScalar(2/3)),new oa(e.v0,t,i,e.v2)}function fm(e,t,i=Number.EPSILON){return Math.abs(e-t)<i}function lpe(e,t,i=Number.EPSILON){return e.distanceTo(t)<i}function cpe(e,t,i=Number.EPSILON){return e.distanceTo(t)<i}function FU(e,t,i){let n=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),r=Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)),s=Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2));return Math.acos((r*r+n*n-s*s)/(2*r*n))}function hpe(e,t,i){return nP(e,t)&&nP(t,i)&&hM(e.position,t.position,i.position)}function hM(e,t,i){return af.copy(t).sub(e).cross(w2.copy(i).sub(e))===0}function upe(e,t,i,n,r){let s=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),a=(e.y+t.y)/2,o=(e.x+t.x)/2,l=Math.sqrt(Math.pow(i,2)-Math.pow(s/2,2))*(e.y-t.y)/s,c=Math.sqrt(Math.pow(i,2)-Math.pow(s/2,2))*(t.x-e.x)/s;return n.set(o+l,a+c),r.set(o-l,a-c),[n,r]}function dpe(e,t,i){let n=e.distanceTo(i),r=t.distanceTo(i);return n<r?t:e}function ppe(e,t,i,n,r,s){let a=t.x-e.x,o=t.y-e.y,l=i.x-e.x,c=i.y-e.y,u=Math.sqrt((a+l)*(a+l)+(o+c)*(o+c)),h;return FU(t,e,i)>Math.PI&&(u*=-1),fm(c,o)?h=(o+c)*(n/u-.5)*8/3/(a-l):h=(a+l)*(n/u-.5)*8/3/(c-o),r.set(t.x-h*o,t.y+h*a),s.set(i.x+h*c,i.y-h*l),[r,s]}function iP(e,t){return e.position.equals(e.controls[1].position)&&t.position.equals(t.controls[0].position)}function nP(e,t){return hM(e.position,e.controls[1].position,t.position)&&hM(e.position,t.controls[0].position,t.position)}function fpe(e,t,i,n,r=.5){let s=af.subVectors(t,e).multiplyScalar(r).add(e),a=w2.subVectors(i,t).multiplyScalar(r).add(t),o=npe.subVectors(n,i).multiplyScalar(r).add(i),l=s,c=rpe.subVectors(a,s).multiplyScalar(r).add(s),u=spe.subVectors(o,a).multiplyScalar(r).add(a),h=o,d=ape.subVectors(u,c).multiplyScalar(r).add(c);return[e.x,e.y,l.x,l.y,c.x,c.y,d.x,d.y,u.x,u.y,h.x,h.y,n.x,n.y]}function mpe(e,t,i=12,n=!0){let r=UU.set(0,0,0),s,a=0;for(let o=0;o<t.length;o++){let l=vA(t[o]),c=af,u=Rh(l,i);for(let h=0;h<=u;h++)if(l instanceof oa||l instanceof Pc||l instanceof ma){if(l.getPoint(h/u,c),r.set(c.x,c.y,0),s!==void 0&&cpe(s,r))continue;s===void 0&&(s=NU),s.copy(r),e.setXYZ(a,r.x,r.y,r.z),a++}}return n&&a>1&&!(e.getX(a-1)===e.getX(0)&&e.getY(a-1)===e.getY(0)&&e.getZ(a-1)===e.getZ(0))&&(e.setXYZ(a,e.getX(0),e.getY(0),e.getZ(0)),a++),e}function gpe(e,t,i,n=12,r=!0){let s=UU.set(0,0,0),a=0,o=[];for(let l=0;l<t.length;l++){if(i[l]===!1)continue;let c,u=vA(t[l]),h=af,d=Rh(u,n);o.push(d);for(let p=0;p<=d;p++)if(u instanceof oa||u instanceof Pc||u instanceof ma){if(u.getPoint(p/d,h),s.set(h.x,h.y,0),c==null?void 0:c.equals(s))continue;c===void 0?c=NU:(e.setXYZ(a,c.x,c.y,c.z),a++,e.setXYZ(a,s.x,s.y,s.z),a++),c.copy(s)}}return r&&a>1&&!(e.getX(a-1)===e.getX(0)&&e.getY(a-1)===e.getY(0)&&e.getZ(a-1)===e.getZ(0))&&(e.setXYZ(a,e.getX(0),e.getY(0),e.getZ(0)),a++),o}function rP(e,t=12,i=!1){let n=[];for(let r=0,s=e.length;r<s;r++){let a=e[r],o=0;if(i&&a.roundedCurveCorner!==void 0){let l=Rh(a.roundedCurveCorner,t)*.5;r>0&&(n[r-1]+=l),o+=l}a.curveAfter!==void 0&&(o+=Rh(a.curveAfter,t)),n.push(o)}return e.length>0&&i&&e[0].roundedCurveCorner!==void 0&&(n[e.length-1]+=Rh(e[0].roundedCurveCorner,t)*.5),n}function Rh(e,t=12){return e&&e instanceof a2?t*2:e&&(e instanceof ma||e instanceof WB)?1:e&&e instanceof PE?t*e.points.length:t}function vpe(e,t,i=12,n=!0){let r,s=0;for(let a=0;a<t.length;a++){let o=vA(t[a]),l=Rh(o,i),c=af;for(let u=0;u<=l;u++)if(o instanceof oa||o instanceof Pc||o instanceof ma){if(o.getPoint(u/l,c),r!==void 0&&lpe(r,c,zf))continue;r===void 0&&(r=w2),r.copy(c),e.push(c.x,c.y),s++}}return fm(e[0],e[e.length-2],zf)&&fm(e[1],e[e.length-1],zf)&&(e.pop(),e.pop()),n&&s>1&&!(fm(e[s-1],e[1],zf)&&fm(e[s-2],e[0],zf))&&(e.push(e[0],e[1]),s++),e}var Mb=new te,ype=new te,xpe=new te,_pe=new te,bpe=new te,wpe=new te,Di=class extends Fy{constructor(e=100,t=100){super(),this.points=[],this.shapeHoles=[],this.plane=new Qr(new T(0,0,-1)),this.subdivision=0,this.controlSnapDistance=4,this.pointIDs=0,this.isMesh2D=!1,this._roundness=0,this.isClosed=!1,this.useCubicForRoundedCorners=!0,this.uuid=Dt.generateUUID(),this.needsUpdate=!1,this.roundedCurves=[],this._width=e,this._height=t}static createFromState(e,t,i){let n=new Di;return n.isClosed=e.isClosed,n.points=e.points.map(r=>tp.create(r.id,r.data)),typeof e.roundness=="number"&&(n.roundness=e.roundness),n.shapeHoles=e.shapeHoles.map(r=>Di.createFromState(r)),t!==void 0&&i!==void 0&&n.applySize(t,i),n.update(),n}get width(){return this._width}get height(){return this._height}get roundness(){return this._roundness}set roundness(e){if(this._roundness!==e){this._roundness=e;for(let t=0,i=this.points.length;t<i;t++)this.points[t].roundness=e;this.needsUpdate=!0}}getPointsIndexesByIds(e){return e.map(t=>this.getPointIndexById(t)).filter(t=>t>=0)}getPointIndexById(e){let t=this.points.length,i=this.points.findIndex(n=>n.uuid===e);if(i<0){let n=t;for(let r=0,s=this.shapeHoles.length;r<s;r++){let a=this.shapeHoles[r],o=a.points.length,l=a.getPointIndexById(e);if(l<0)n+=o;else return l+n}}return i}getLineIndexById(e){return this.getPointIndexById(e)}getBezierPoint(e){if(e<=this.points.length-1)return this.points[e];if(this.shapeHoles.length>0){let t=this.points.length;for(let i=0,n=this.shapeHoles.length;i<n;i++){let r=this.shapeHoles[i],s=e-t;if(s<=r.points.length-1)return r.points[s];t+=r.points.length}}throw new Error("This shape does not have a point for this index: "+e)}getBezierPointIndex(e){let t=this.points.indexOf(e);if(t>=0)return t;if(t=this.points.length,this.shapeHoles.length>0)for(let i=0,n=this.shapeHoles.length;i<n;i++){let r=this.shapeHoles[i],s=r.points.indexOf(e);if(s>=0)return t+s;t+=r.points.length}return-1}getAllPoints(){let e=[].concat(...this.shapeHoles.map(t=>t.points));return[...this.points,...e]}applySize(e,t){e===0&&(e=.001),t===0&&(t=.001),this._width=e,this._height=t}applyScale(e,t){let i=Mb.set(e,t);for(let n=0,r=this.points.length;n<r;n++){let s=this.points[n];s.position.multiply(i),s.controls[0].position.multiply(i),s.controls[1].position.multiply(i)}for(let n=0,r=this.shapeHoles.length;n<r;n++)this.shapeHoles[n].applyScale(e,t);this._update()}createPoint(e,t=0,i=Dt.generateUUID()){let n;e instanceof te?n=e:n=new te(e,t);let r=new tp(i,n);return r.roundness=this.roundness,r}addPoint(e){this.points.push(e),this.needsUpdate=!0}addPointAt(e,t){this.points.splice(t,0,e),this.needsUpdate=!0}getPointByUuid(e){for(let t=0,i=this.points.length;t<i;t++){let n=this.points[t];if(n.uuid===e)return n}for(let t=0,i=this.shapeHoles.length;t<i;t++){let n=this.shapeHoles[t].getPointByUuid(e);if(n)return n}}getFirstPoint(){return this.points[0]}getLastPoint(){return this.points[this.points.length-1]}removePoint(e){let t=this.points.indexOf(e);t>=0&&this.points.splice(t,1),this.needsUpdate=!0}removePointById(e){let t=this.points.find(i=>i.uuid===e);t&&this.removePoint(t)}update(){for(let e=0,t=this.shapeHoles.length;e<t;e++)this.shapeHoles[e].update();this._update()}extractShapePointsToBuffer(e,t=12,i=!1){this.subdivision=t,this.curveDivisions===void 0&&this.computeCurveDivisions(t);let n=i?this.roundedCurveDivisions:this.curveDivisions;return mpe(e,i?this.roundedCurves:this.curves,t,this.autoClose),n.reduce((r,s)=>r+s,0)+1}computeCurveDivisions(e=12){return this.curveDivisions=rP(this.points,e,!1),this.roundedCurveDivisions=rP(this.points,e,!0),this.curveDivisions}extractFilteredShapePointsToBuffer(e,t,i=12){return gpe(e,this.curves,t,i,this.autoClose).reduce((n,r)=>n+r,0)*2}extractShapePointsToFlatArray(e,t=12){return this.subdivision=t,this.curveDivisions===void 0&&this.computeCurveDivisions(t),vpe(e,this.roundedCurves,t,this.autoClose)}getCurveIndexFromVertexId(e,t=!1){let i=0;this.curveDivisions===void 0&&this.computeCurveDivisions(this.subdivision);let n=t?this.roundedCurveDivisions:this.curveDivisions,r=0;t&&this.points[0].roundedCurveCorner!==void 0&&(r=Rh(this.points[0].roundedCurveCorner,this.subdivision)*.5);let s=e-r;s<0&&(s+=n.reduce((a,o)=>a+o,0));for(let a=0,o=n.length;a<o;a++){let l=n[a];if(s<i+l)return[a,(s-i+1)/l];i+=l}return[0,1]}getCurveT(e,t,i){let n=this.points[e],r=this.points[e>=this.points.length-1?0:e+1],s=this.curveDivisions,a=s[e];if(iP(n,r)){let l=n.position.distanceTo(r.position);return n.position.distanceTo(Mb.set(i.x,i.y))/l}let o=0;for(let l=0;l<e;l++)o+=s[l];return(t-o)/a}dispose(){}_applyCurveForPoint(e,t){iP(t,e)?this.lineTo(e.position.x,e.position.y):this.bezierCurveTo(t.controls[1].position.x,t.controls[1].position.y,e.controls[0].position.x,e.controls[0].position.y,e.position.x,e.position.y);let i=this.curves[this.curves.length-1];e.curveBefore=i,t.curveAfter=i;let n=i.clone();e.roundedCurveBefore=n,t.roundedCurveAfter=n,e.roundedCurveCorner=void 0,this.roundedCurves.push(n)}_update(){if(this.curves=[],this.roundedCurves=[],!this.points.length)return;for(let t=0,i=this.points.length;t<i;t++){let n=this.points[t];if(t===0)this.moveTo(n.position.x,n.position.y);else{let r=this.points[t-1];this._applyCurveForPoint(n,r)}}let e=this.getLastPoint();if(e!=null&&e.curveAfter&&(e.curveAfter=void 0),this.isClosed){let t=this.points[0],i=this.points[this.points.length-1];this._applyCurveForPoint(t,i)}if(this.points.length>2){let t=0;for(let i=0,n=this.points.length;i<n;i++){let r=this.points[i],s=this.points[i-1]??this.points[this.points.length-1],a=this.points[i+1]??this.points[0],o=r.roundness,l=s&&a&&hpe(s,r,a);if(!r.controlsMoved()&&o>0&&!l){let c=r.curveBefore,u=r.curveAfter;if(c===void 0||u===void 0)continue;let h=r.roundedCurveBefore,d=r.roundedCurveAfter,p=c.getLength(),f=u.getLength(),v=Math.min(o,p*.499),m=Math.min(o,f*.499),g=Math.min(v,m),y=1-g/p,x=g/f,_=c.getPointAt(y,Mb),b=u.getPointAt(x,ype);this._subSplitCurve(c,h,y,_,void 0),this._subSplitCurve(u,d,x,void 0,b);let w;if(this.useCubicForRoundedCorners){let M=FU(_,r.position,b)/2,S=Math.tan(M)*_.distanceTo(r.position),[C,E]=upe(_,b,S,xpe,_pe),P=dpe(C,E,r.position),[I,D]=ppe(P,_,b,S,bpe,wpe);w=new oa(_.clone(),I.clone(),D.clone(),b.clone())}else w=new Pc(_.clone(),r.position.clone(),b.clone());r.roundedCurveCorner=w,this.roundedCurves.splice(i+t,0,w),t++}}}}_subSplitCurve(e,t,i,n,r){if(e instanceof ma)n!==void 0&&t.v2.copy(n),r!==void 0&&t.v1.copy(r);else{let s=e,a=t,o=s.getUtoTmapping(i,0),l=fpe(s.v0,s.v1,s.v2,s.v3,o);return n!==void 0&&(a.v0.set(l[0],l[1]),a.v1.set(l[2],l[3]),a.v2.set(l[4],l[5]),a.v3.set(l[6],l[7])),r!==void 0&&(a.v0.set(l[6],l[7]),a.v1.set(l[8],l[9]),a.v2.set(l[10],l[11]),a.v3.set(l[12],l[13])),a}return t}clone(){let e=new Di(this._width,this._height);return e.points=this.points.map(t=>t.clone()),e.isClosed=this.isClosed,e.roundness=this.roundness,e.isMesh2D=this.isMesh2D,e.shapeHoles=this.shapeHoles.map(t=>t.clone()),e}toJSON(){return{points:this.points.reduce((e,t)=>e.concat(t.toJSON()),[]),shapeHoles:this.shapeHoles.map(e=>e.toJSON()),isClosed:this.isClosed,roundness:this.roundness}}fromJSON(e){var i;this.points=[],this.pointIDs=0;let t=e.points.length/7;for(let n=0;n<t;n++){let r=n*7,s=e.points[r+0],a=e.points[r+1],o=e.points[r+2],l=e.points[r+3],c=e.points[r+4],u=e.points[r+5],h=e.points[r+6],d=new tp(Dt.generateUUID(),new te(s,a));d.controls[0].position.set(o,l),d.controls[1].position.set(c,u),d.roundness=h,this.points.push(d)}return this.shapeHoles=(i=e.shapeHoles)!=null&&i.length?e.shapeHoles.map(n=>{let r=new Di;return r.fromJSON(n),r}):[],this.isClosed=e.isClosed,this._roundness=e.roundness,this._update(),this}fromShape(e){let t=(n,r)=>{r instanceof oa&&r.v3.equals(n.position)&&n.controls[0].position.copy(r.v2)},i=n=>{let r=[],s,a;for(s=0,a=n.length;s<a;s++)n[s]instanceof Pc&&(n[s]=ope(n[s]));for(s=0,a=n.length;s<a;s++){let c=n[s],u=s>0?n[s-1]:null,h;c instanceof oa?(h=this.createPoint(c.v0),h.controls[1].position.copy(c.v1)):c instanceof ma&&(h=this.createPoint(c.v1)),h!==void 0&&(u!==null&&t(h,u),r.push(h))}let o=n[n.length-1],l=!1;return o instanceof oa?o.v3.equals(r[0].position)&&(r[0].controls[0].position.copy(o.v2),l=!0):o instanceof ma&&o.v2.equals(r[0].position)&&(l=!0),this.isClosed=l,r};return this.points=i(e.curves),e instanceof Fy&&(this.shapeHoles=e.holes.map(n=>{let r=new Di;return r.fromShape(n),r})),this.update(),this}updatePoint(e,t){let i=this.getPointByUuid(e);i&&(t.position!==void 0&&i.position.fromArray(t.position),t.roundness!==void 0&&(i.roundness=t.roundness),t.areControlsDirectionsMirrored!==void 0&&(i.areControlsDirectionsMirrored=t.areControlsDirectionsMirrored),this.needsUpdate=!0)}updatePreviousControl(e,t){var n;let i=(n=this.getPointByUuid(e))==null?void 0:n.controls[0];i&&(t.position&&i.position.fromArray(t.position),this.needsUpdate=!0)}updateNextControl(e,t){var n;let i=(n=this.getPointByUuid(e))==null?void 0:n.controls[1];i&&(t.position&&i.position.fromArray(t.position),this.needsUpdate=!0)}},uM=Math.PI*2;function Cb({x:e,y:t},i,n,r,s){return{x:e*i+r,y:t*n+s}}function Spe(e,t){let i=t===1.5707963267948966?.551915024494:t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),n=Math.cos(e),r=Math.sin(e),s=Math.cos(e+t),a=Math.sin(e+t);return[{x:n-r*i,y:r+n*i},{x:s+a*i,y:a-s*i},{x:s,y:a}]}function sP(e,t,i,n){let r=e*n-t*i<0?-1:1,s=Math.min(1,Math.max(-1,e*i+t*n));return r*Math.acos(s)}function Mpe(e,t,i,n,r,s,a,o,l,c){let u=Math.pow(r,2),h=Math.pow(s,2),d=Math.pow(a,2),p=Math.pow(o,2),f=u*h-u*p-h*d;f<0&&(f=0),f/=u*p+h*d,f=Math.sqrt(f)*(l===c?-1:1);let v=f*r/s*o,m=f*-s/r*a,g=v+(e+i)/2,y=m+(t+n)/2,x=(a-v)/r,_=(o-m)/s,b=(-a-v)/r,w=(-o-m)/s,M=sP(1,0,x,_),S=sP(x,_,b,w);return!c&&S>0&&(S-=uM),c&&S<0&&(S+=uM),{centerx:g,centery:y,ang1:M,ang2:S}}function Cpe({px:e,py:t,cx:i,cy:n,rx:r,ry:s,largeArcFlag:a,sweepFlag:o}){let l=[];if(r===0||s===0)return[];let c=(e-i)/2,u=(t-n)/2;if(c===0&&u===0)return[];r=Math.abs(r),s=Math.abs(s);let h=Math.pow(c,2)/Math.pow(r,2)+Math.pow(u,2)/Math.pow(s,2);h>1&&(r*=Math.sqrt(h),s*=Math.sqrt(h));let d=Mpe(e,t,i,n,r,s,c,u,a,o),{ang1:p,ang2:f}=d,{centerx:v,centery:m}=d,g=Math.abs(f)/(uM/4);Math.abs(1-g)<1e-7&&(g=1);let y=Math.max(Math.ceil(g),1);f/=y;for(let x=0;x<y;x++)l.push(Spe(p,f)),p+=f;return l.map(x=>{let{x:_,y:b}=Cb(x[0],r,s,v,m),{x:w,y:M}=Cb(x[1],r,s,v,m),{x:S,y:C}=Cb(x[2],r,s,v,m);return{x1:_,y1:b,x2:w,y2:M,x:S,y:C}})}var Zt;(function(e){e[e.ODD=0]="ODD",e[e.NONZERO=1]="NONZERO",e[e.POSITIVE=2]="POSITIVE",e[e.NEGATIVE=3]="NEGATIVE",e[e.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"})(Zt||(Zt={}));var Zi;(function(e){e[e.POLYGONS=0]="POLYGONS",e[e.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",e[e.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"})(Zi||(Zi={}));function pt(e,t){if(!e)throw t||"Assertion Failed!"}var ot=function(){function e(){}return e.vertEq=function(t,i){return t.s===i.s&&t.t===i.t},e.vertLeq=function(t,i){return t.s<i.s||t.s===i.s&&t.t<=i.t},e.transLeq=function(t,i){return t.t<i.t||t.t===i.t&&t.s<=i.s},e.edgeGoesLeft=function(t){return e.vertLeq(t.Dst,t.Org)},e.edgeGoesRight=function(t){return e.vertLeq(t.Org,t.Dst)},e.vertL1dist=function(t,i){return Math.abs(t.s-i.s)+Math.abs(t.t-i.t)},e.edgeEval=function(t,i,n){pt(e.vertLeq(t,i)&&e.vertLeq(i,n));var r=i.s-t.s,s=n.s-i.s;return r+s>0?r<s?i.t-t.t+(t.t-n.t)*(r/(r+s)):i.t-n.t+(n.t-t.t)*(s/(r+s)):0},e.edgeSign=function(t,i,n){pt(e.vertLeq(t,i)&&e.vertLeq(i,n));var r=i.s-t.s,s=n.s-i.s;return r+s>0?(i.t-n.t)*r+(i.t-t.t)*s:0},e.transEval=function(t,i,n){pt(e.transLeq(t,i)&&e.transLeq(i,n));var r=i.t-t.t,s=n.t-i.t;return r+s>0?r<s?i.s-t.s+(t.s-n.s)*(r/(r+s)):i.s-n.s+(n.s-t.s)*(s/(r+s)):0},e.transSign=function(t,i,n){pt(e.transLeq(t,i)&&e.transLeq(i,n));var r=i.t-t.t,s=n.t-i.t;return r+s>0?(i.s-n.s)*r+(i.s-t.s)*s:0},e.vertCCW=function(t,i,n){return t.s*(i.t-n.t)+i.s*(n.t-t.t)+n.s*(t.t-i.t)>=0},e.interpolate=function(t,i,n,r){return t=t<0?0:t,n=n<0?0:n,t<=n?n===0?(i+r)/2:i+(r-i)*(t/(t+n)):r+(i-r)*(n/(t+n))},e.intersect=function(t,i,n,r,s){var a,o,l;e.vertLeq(t,i)||(l=t,t=i,i=l),e.vertLeq(n,r)||(l=n,n=r,r=l),e.vertLeq(t,n)||(l=t,t=n,n=l,l=i,i=r,r=l),e.vertLeq(n,i)?e.vertLeq(i,r)?(a=e.edgeEval(t,n,i),o=e.edgeEval(n,i,r),a+o<0&&(a=-a,o=-o),s.s=e.interpolate(a,n.s,o,i.s)):(a=e.edgeSign(t,n,i),o=-e.edgeSign(t,r,i),a+o<0&&(a=-a,o=-o),s.s=e.interpolate(a,n.s,o,r.s)):s.s=(n.s+i.s)/2,e.transLeq(t,i)||(l=t,t=i,i=l),e.transLeq(n,r)||(l=n,n=r,r=l),e.transLeq(t,n)||(l=t,t=n,n=l,l=i,i=r,r=l),e.transLeq(n,i)?e.transLeq(i,r)?(a=e.transEval(t,n,i),o=e.transEval(n,i,r),a+o<0&&(a=-a,o=-o),s.t=e.interpolate(a,n.t,o,i.t)):(a=e.transSign(t,n,i),o=-e.transSign(t,r,i),a+o<0&&(a=-a,o=-o),s.t=e.interpolate(a,n.t,o,r.t)):s.t=(n.t+i.t)/2},e}(),kf=function(){function e(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1}return e}(),T1=function(){function e(t){this.side=t,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(e.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(t){this.Sym.Lface=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(t){this.Sym.Org=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(t){this.Sym.Lnext=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(t){this.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(t){this.Lnext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(t){this.Sym.Onext=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(t){this.Sym.Onext.Sym=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(t){this.Sym.Lnext.Sym=t},enumerable:!0,configurable:!0}),e}(),cd=function(){function e(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0}return e}(),aP=function(){function e(){var t=new cd,i=new kf,n=new T1(0),r=new T1(1);t.next=t.prev=t,t.anEdge=null,i.next=i.prev=i,n.next=n,n.Sym=r,r.next=r,r.Sym=n,this.vHead=t,this.fHead=i,this.eHead=n,this.eHeadSym=r}return e.prototype.makeEdge_=function(t){var i=new T1(0),n=new T1(1);t.Sym.side<t.side&&(t=t.Sym);var r=t.Sym.next;return n.next=r,r.Sym.next=i,i.next=t,t.Sym.next=n,i.Sym=n,i.Onext=i,i.Lnext=n,i.Org=null,i.Lface=null,i.winding=0,i.activeRegion=null,n.Sym=i,n.Onext=n,n.Lnext=i,n.Org=null,n.Lface=null,n.winding=0,n.activeRegion=null,i},e.prototype.splice_=function(t,i){var n=t.Onext,r=i.Onext;n.Sym.Lnext=i,r.Sym.Lnext=t,t.Onext=r,i.Onext=n},e.prototype.makeVertex_=function(t,i,n){var r=t;pt(r,"Vertex can't be null!");var s=n.prev;r.prev=s,s.next=r,r.next=n,n.prev=r,r.anEdge=i;var a=i;do a.Org=r,a=a.Onext;while(a!==i)},e.prototype.makeFace_=function(t,i,n){var r=t;pt(r,"Face can't be null");var s=n.prev;r.prev=s,s.next=r,r.next=n,n.prev=r,r.anEdge=i,r.trail=null,r.marked=!1,r.inside=n.inside;var a=i;do a.Lface=r,a=a.Lnext;while(a!==i)},e.prototype.killEdge_=function(t){t.Sym.side<t.side&&(t=t.Sym);var i=t.next,n=t.Sym.next;i.Sym.next=n,n.Sym.next=i},e.prototype.killVertex_=function(t,i){var n=t.anEdge,r=n;do r.Org=i,r=r.Onext;while(r!==n);var s=t.prev,a=t.next;a.prev=s,s.next=a},e.prototype.killFace_=function(t,i){var n=t.anEdge,r=n;do r.Lface=i,r=r.Lnext;while(r!==n);var s=t.prev,a=t.next;a.prev=s,s.next=a},e.prototype.makeEdge=function(){var t=new cd,i=new cd,n=new kf,r=this.makeEdge_(this.eHead);return this.makeVertex_(t,r,this.vHead),this.makeVertex_(i,r.Sym,this.vHead),this.makeFace_(n,r,this.fHead),r},e.prototype.splice=function(t,i){var n=!1,r=!1;if(t!==i){if(i.Org!==t.Org&&(r=!0,this.killVertex_(i.Org,t.Org)),i.Lface!==t.Lface&&(n=!0,this.killFace_(i.Lface,t.Lface)),this.splice_(i,t),!r){var s=new cd;this.makeVertex_(s,i,t.Org),t.Org.anEdge=t}if(!n){var a=new kf;this.makeFace_(a,i,t.Lface),t.Lface.anEdge=t}}},e.prototype.delete=function(t){var i=t.Sym,n=!1;if(t.Lface!==t.Rface&&(n=!0,this.killFace_(t.Lface,t.Rface)),t.Onext===t)this.killVertex_(t.Org,null);else if(t.Rface.anEdge=t.Oprev,t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev),!n){var r=new kf;this.makeFace_(r,t,t.Lface)}i.Onext===i?(this.killVertex_(i.Org,null),this.killFace_(i.Lface,null)):(t.Lface.anEdge=i.Oprev,i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),this.killEdge_(t)},e.prototype.addEdgeVertex=function(t){var i=this.makeEdge_(t),n=i.Sym;this.splice_(i,t.Lnext),i.Org=t.Dst;var r=new cd;return this.makeVertex_(r,n,i.Org),i.Lface=n.Lface=t.Lface,i},e.prototype.splitEdge=function(t){var i=this.addEdgeVertex(t),n=i.Sym;return this.splice_(t.Sym,t.Sym.Oprev),this.splice_(t.Sym,n),t.Dst=n.Org,n.Dst.anEdge=n.Sym,n.Rface=t.Rface,n.winding=t.winding,n.Sym.winding=t.Sym.winding,n.idx=t.idx,n.Sym.idx=t.Sym.idx,n},e.prototype.connect=function(t,i){var n=!1,r=this.makeEdge_(t),s=r.Sym;if(i.Lface!==t.Lface&&(n=!0,this.killFace_(i.Lface,t.Lface)),this.splice_(r,t.Lnext),this.splice_(s,i),r.Org=t.Dst,s.Org=i.Org,r.Lface=s.Lface=t.Lface,t.Lface.anEdge=s,!n){var a=new kf;this.makeFace_(a,r,t.Lface)}return r},e.prototype.zapFace=function(t){var i=t.anEdge,n,r,s,a,o;r=i.Lnext;do n=r,r=n.Lnext,n.Lface=null,n.Rface===null&&(n.Onext===n?this.killVertex_(n.Org,null):(n.Org.anEdge=n.Onext,this.splice_(n,n.Oprev)),s=n.Sym,s.Onext===s?this.killVertex_(s.Org,null):(s.Org.anEdge=s.Onext,this.splice_(s,s.Oprev)),this.killEdge_(n));while(n!=i);a=t.prev,o=t.next,o.prev=a,a.next=o},e.prototype.countFaceVerts_=function(t){var i=t.anEdge,n=0;do n++,i=i.Lnext;while(i!==t.anEdge);return n},e.prototype.mergeConvexFaces=function(t){var i,n,r,s,a,o,l;for(i=this.fHead.next;i!==this.fHead;i=i.next)if(i.inside)for(n=i.anEdge,a=n.Org;r=n.Lnext,s=n.Sym,s&&s.Lface&&s.Lface.inside&&(o=this.countFaceVerts_(i),l=this.countFaceVerts_(s.Lface),o+l-2<=t&&ot.vertCCW(n.Lprev.Org,n.Org,s.Lnext.Lnext.Org)&&ot.vertCCW(s.Lprev.Org,s.Org,n.Lnext.Lnext.Org)&&(r=s.Lnext,this.delete(s),n=null,s=null)),!(n&&n.Lnext.Org===a);)n=r;return!0},e.prototype.check=function(){var t=this.fHead,i=this.vHead,n=this.eHead,r,s,a,o,l,c;for(s=t,s=t;(r=s.next)!==t;s=r){pt(r.prev===s),l=r.anEdge;do pt(l.Sym!==l),pt(l.Sym.Sym===l),pt(l.Lnext.Onext.Sym===l),pt(l.Onext.Sym.Lnext===l),pt(l.Lface===r),l=l.Lnext;while(l!==r.anEdge)}for(pt(r.prev===s&&r.anEdge===null),o=i,o=i;(a=o.next)!==i;o=a){pt(a.prev===o),l=a.anEdge;do pt(l.Sym!==l),pt(l.Sym.Sym===l),pt(l.Lnext.Onext.Sym===l),pt(l.Onext.Sym.Lnext===l),pt(l.Org===a),l=l.Onext;while(l!==a.anEdge)}for(pt(a.prev===o&&a.anEdge===null),c=n,c=n;(l=c.next)!==n;c=l)pt(l.Sym.next===c.Sym),pt(l.Sym!==l),pt(l.Sym.Sym===l),pt(l.Org!==null),pt(l.Dst!==null),pt(l.Lnext.Onext.Sym===l),pt(l.Onext.Sym.Lnext===l);pt(l.Sym.next===c.Sym&&l.Sym===this.eHeadSym&&l.Sym.Sym===l&&l.Org===null&&l.Dst===null&&l.Lface===null&&l.Rface===null)},e}(),oP=function(){function e(){this.handle=null}return e}(),lP=function(){function e(){this.key=null,this.node=0}return e}(),Epe=function(){function e(t,i){this.leq=i,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=t,this.nodes=[],this.handles=[];for(var n=0;n<t+1;n++)this.nodes[n]=new oP,this.handles[n]=new lP;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return e.prototype.floatDown_=function(t){var i=this.nodes,n=this.handles,r,s,a;for(r=i[t].handle;;){if(a=t<<1,a<this.size&&this.leq(n[i[a+1].handle].key,n[i[a].handle].key)&&++a,pt(a<=this.max),s=i[a].handle,a>this.size||this.leq(n[r].key,n[s].key)){i[t].handle=r,n[r].node=t;break}i[t].handle=s,n[s].node=t,t=a}},e.prototype.floatUp_=function(t){var i=this.nodes,n=this.handles,r,s,a;for(r=i[t].handle;;){if(a=t>>1,s=i[a].handle,a===0||this.leq(n[s].key,n[r].key)){i[t].handle=r,n[r].node=t;break}i[t].handle=s,n[s].node=t,t=a}},e.prototype.init=function(){for(var t=this.size;t>=1;--t)this.floatDown_(t);this.initialized=!0},e.prototype.min=function(){return this.handles[this.nodes[1].handle].key},e.prototype.insert=function(t){var i,n;if(i=++this.size,i*2>this.max){this.max*=2;var r,s;for(s=this.nodes.length,this.nodes.length=this.max+1,r=s;r<this.nodes.length;r++)this.nodes[r]=new oP;for(s=this.handles.length,this.handles.length=this.max+1,r=s;r<this.handles.length;r++)this.handles[r]=new lP}return this.freeList===0?n=i:(n=this.freeList,this.freeList=this.handles[n].node),this.nodes[i].handle=n,this.handles[n].node=i,this.handles[n].key=t,this.initialized&&this.floatUp_(i),n},e.prototype.extractMin=function(){var t=this.nodes,i=this.handles,n=t[1].handle,r=i[n].key;return this.size>0&&(t[1].handle=t[this.size].handle,i[t[1].handle].node=1,i[n].key=null,i[n].node=this.freeList,this.freeList=n,--this.size,this.size>0&&this.floatDown_(1)),r},e.prototype.delete=function(t){var i=this.nodes,n=this.handles,r;pt(t>=1&&t<=this.max&&n[t].key!==null),r=n[t].node,i[r].handle=i[this.size].handle,n[i[r].handle].node=r,--this.size,r<=this.size&&(r<=1||this.leq(n[i[r>>1].handle].key,n[i[r].handle].key)?this.floatDown_(r):this.floatUp_(r)),n[t].key=null,n[t].node=this.freeList,this.freeList=t},e}(),Eb=function(){function e(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1}return e}(),cP=function(){function e(){this.key=null,this.next=null,this.prev=null}return e}(),Ape=function(){function e(t,i){this.frame=t,this.leq=i,this.head=new cP,this.head.next=this.head,this.head.prev=this.head}return e.prototype.min=function(){return this.head.next},e.prototype.max=function(){return this.head.prev},e.prototype.insert=function(t){return this.insertBefore(this.head,t)},e.prototype.search=function(t){var i=this.head;do i=i.next;while(i.key!==null&&!this.leq(this.frame,t,i.key));return i},e.prototype.insertBefore=function(t,i){do t=t.prev;while(t.key!==null&&!this.leq(this.frame,t.key,i));var n=new cP;return n.key=i,n.next=t.next,t.next.prev=n,n.prev=t,t.next=n,n},e.prototype.delete=function(t){t.next.prev=t.prev,t.prev.next=t.next},e}(),Tpe=function(){function e(){}return e.regionBelow=function(t){return t.nodeUp.prev.key},e.regionAbove=function(t){return t.nodeUp.next.key},e.debugEvent=function(t){},e.addWinding=function(t,i){t.winding+=i.winding,t.Sym.winding+=i.Sym.winding},e.edgeLeq=function(t,i,n){var r=t.event,s=i.eUp,a=n.eUp;if(s.Dst===r)return a.Dst===r?ot.vertLeq(s.Org,a.Org)?ot.edgeSign(a.Dst,s.Org,a.Org)<=0:ot.edgeSign(s.Dst,a.Org,s.Org)>=0:ot.edgeSign(a.Dst,r,a.Org)<=0;if(a.Dst===r)return ot.edgeSign(s.Dst,r,s.Org)>=0;var o=ot.edgeEval(s.Dst,r,s.Org),l=ot.edgeEval(a.Dst,r,a.Org);return o>=l},e.deleteRegion=function(t,i){i.fixUpperEdge&&pt(i.eUp.winding===0),i.eUp.activeRegion=null,t.dict.delete(i.nodeUp)},e.fixUpperEdge=function(t,i,n){pt(i.fixUpperEdge),t.mesh.delete(i.eUp),i.fixUpperEdge=!1,i.eUp=n,n.activeRegion=i},e.topLeftRegion=function(t,i){var n=i.eUp.Org,r;do i=e.regionAbove(i);while(i.eUp.Org===n);if(i.fixUpperEdge){if(r=t.mesh.connect(e.regionBelow(i).eUp.Sym,i.eUp.Lnext),r===null)return null;e.fixUpperEdge(t,i,r),i=e.regionAbove(i)}return i},e.topRightRegion=function(t){var i=t.eUp.Dst;do t=e.regionAbove(t);while(t.eUp.Dst===i);return t},e.addRegionBelow=function(t,i,n){var r=new Eb;return r.eUp=n,r.nodeUp=t.dict.insertBefore(i.nodeUp,r),r.fixUpperEdge=!1,r.sentinel=!1,r.dirty=!1,n.activeRegion=r,r},e.isWindingInside=function(t,i){switch(t.windingRule){case Zt.ODD:return(i&1)!==0;case Zt.NONZERO:return i!==0;case Zt.POSITIVE:return i>0;case Zt.NEGATIVE:return i<0;case Zt.ABS_GEQ_TWO:return i>=2||i<=-2}throw new Error("Invalid winding rulle")},e.computeWinding=function(t,i){i.windingNumber=e.regionAbove(i).windingNumber+i.eUp.winding,i.inside=e.isWindingInside(t,i.windingNumber)},e.finishRegion=function(t,i){var n=i.eUp,r=n.Lface;r.inside=i.inside,r.anEdge=n,e.deleteRegion(t,i)},e.finishLeftRegions=function(t,i,n){for(var r,s=null,a=i,o=i.eUp;a!==n;){if(a.fixUpperEdge=!1,s=e.regionBelow(a),r=s.eUp,r.Org!=o.Org){if(!s.fixUpperEdge){e.finishRegion(t,a);break}r=t.mesh.connect(o.Lprev,r.Sym),e.fixUpperEdge(t,s,r)}o.Onext!==r&&(t.mesh.splice(r.Oprev,r),t.mesh.splice(o,r)),e.finishRegion(t,a),o=s.eUp,a=s}return o},e.addRightEdges=function(t,i,n,r,s,a){var o,l,c,u,h=!0;c=n;do pt(ot.vertLeq(c.Org,c.Dst)),e.addRegionBelow(t,i,c.Sym),c=c.Onext;while(c!==r);for(s===null&&(s=e.regionBelow(i).eUp.Rprev),l=i,u=s;o=e.regionBelow(l),c=o.eUp.Sym,c.Org===u.Org;)c.Onext!==u&&(t.mesh.splice(c.Oprev,c),t.mesh.splice(u.Oprev,c)),o.windingNumber=l.windingNumber-c.winding,o.inside=e.isWindingInside(t,o.windingNumber),l.dirty=!0,!h&&e.checkForRightSplice(t,l)&&(e.addWinding(c,u),e.deleteRegion(t,l),t.mesh.delete(u)),h=!1,l=o,u=c;l.dirty=!0,pt(l.windingNumber-c.winding===o.windingNumber),a&&e.walkDirtyRegions(t,l)},e.spliceMergeVertices=function(t,i,n){t.mesh.splice(i,n)},e.vertexWeights=function(t,i,n){var r=ot.vertL1dist(i,t),s=ot.vertL1dist(n,t),a=.5*s/(r+s),o=.5*r/(r+s);t.coords[0]+=a*i.coords[0]+o*n.coords[0],t.coords[1]+=a*i.coords[1]+o*n.coords[1],t.coords[2]+=a*i.coords[2]+o*n.coords[2]},e.getIntersectData=function(t,i,n,r,s,a){i.coords[0]=i.coords[1]=i.coords[2]=0,i.idx=-1,e.vertexWeights(i,n,r),e.vertexWeights(i,s,a)},e.checkForRightSplice=function(t,i){var n=e.regionBelow(i),r=i.eUp,s=n.eUp;if(ot.vertLeq(r.Org,s.Org)){if(ot.edgeSign(s.Dst,r.Org,s.Org)>0)return!1;ot.vertEq(r.Org,s.Org)?r.Org!==s.Org&&(t.pq.delete(r.Org.pqHandle),e.spliceMergeVertices(t,s.Oprev,r)):(t.mesh.splitEdge(s.Sym),t.mesh.splice(r,s.Oprev),i.dirty=n.dirty=!0)}else{if(ot.edgeSign(r.Dst,s.Org,r.Org)<0)return!1;e.regionAbove(i).dirty=i.dirty=!0,t.mesh.splitEdge(r.Sym),t.mesh.splice(s.Oprev,r)}return!0},e.checkForLeftSplice=function(t,i){var n=e.regionBelow(i),r=i.eUp,s=n.eUp,a;if(pt(!ot.vertEq(r.Dst,s.Dst)),ot.vertLeq(r.Dst,s.Dst)){if(ot.edgeSign(r.Dst,s.Dst,r.Org)<0)return!1;e.regionAbove(i).dirty=i.dirty=!0,a=t.mesh.splitEdge(r),t.mesh.splice(s.Sym,a),a.Lface.inside=i.inside}else{if(ot.edgeSign(s.Dst,r.Dst,s.Org)>0)return!1;i.dirty=n.dirty=!0,a=t.mesh.splitEdge(s),t.mesh.splice(r.Lnext,s.Sym),a.Rface.inside=i.inside}return!0},e.checkForIntersect=function(t,i){var n=e.regionBelow(i),r=i.eUp,s=n.eUp,a=r.Org,o=s.Org,l=r.Dst,c=s.Dst,u,h,d=new cd,p,f;if(pt(!ot.vertEq(c,l)),pt(ot.edgeSign(l,t.event,a)<=0),pt(ot.edgeSign(c,t.event,o)>=0),pt(a!==t.event&&o!==t.event),pt(!i.fixUpperEdge&&!n.fixUpperEdge),a===o||(u=Math.min(a.t,l.t),h=Math.max(o.t,c.t),u>h))return!1;if(ot.vertLeq(a,o)){if(ot.edgeSign(c,a,o)>0)return!1}else if(ot.edgeSign(l,o,a)<0)return!1;return e.debugEvent(t),ot.intersect(l,a,c,o,d),pt(Math.min(a.t,l.t)<=d.t),pt(d.t<=Math.max(o.t,c.t)),pt(Math.min(c.s,l.s)<=d.s),pt(d.s<=Math.max(o.s,a.s)),ot.vertLeq(d,t.event)&&(d.s=t.event.s,d.t=t.event.t),p=ot.vertLeq(a,o)?a:o,ot.vertLeq(p,d)&&(d.s=p.s,d.t=p.t),ot.vertEq(d,a)||ot.vertEq(d,o)?(e.checkForRightSplice(t,i),!1):!ot.vertEq(l,t.event)&&ot.edgeSign(l,t.event,d)>=0||!ot.vertEq(c,t.event)&&ot.edgeSign(c,t.event,d)<=0?c===t.event?(t.mesh.splitEdge(r.Sym),t.mesh.splice(s.Sym,r),i=e.topLeftRegion(t,i),r=e.regionBelow(i).eUp,e.finishLeftRegions(t,e.regionBelow(i),n),e.addRightEdges(t,i,r.Oprev,r,r,!0),!0):l===t.event?(t.mesh.splitEdge(s.Sym),t.mesh.splice(r.Lnext,s.Oprev),n=i,i=e.topRightRegion(i),f=e.regionBelow(i).eUp.Rprev,n.eUp=s.Oprev,s=e.finishLeftRegions(t,n,null),e.addRightEdges(t,i,s.Onext,r.Rprev,f,!0),!0):(ot.edgeSign(l,t.event,d)>=0&&(e.regionAbove(i).dirty=i.dirty=!0,t.mesh.splitEdge(r.Sym),r.Org.s=t.event.s,r.Org.t=t.event.t),ot.edgeSign(c,t.event,d)<=0&&(i.dirty=n.dirty=!0,t.mesh.splitEdge(s.Sym),s.Org.s=t.event.s,s.Org.t=t.event.t),!1):(t.mesh.splitEdge(r.Sym),t.mesh.splitEdge(s.Sym),t.mesh.splice(s.Oprev,r),r.Org.s=d.s,r.Org.t=d.t,r.Org.pqHandle=t.pq.insert(r.Org),e.getIntersectData(t,r.Org,a,l,o,c),e.regionAbove(i).dirty=i.dirty=n.dirty=!0,!1)},e.walkDirtyRegions=function(t,i){for(var n=e.regionBelow(i),r,s;;){for(;n.dirty;)i=n,n=e.regionBelow(n);if(!i.dirty&&(n=i,i=e.regionAbove(i),i===null||!i.dirty))return;if(i.dirty=!1,r=i.eUp,s=n.eUp,r.Dst!==s.Dst&&e.checkForLeftSplice(t,i)&&(n.fixUpperEdge?(e.deleteRegion(t,n),t.mesh.delete(s),n=e.regionBelow(i),s=n.eUp):i.fixUpperEdge&&(e.deleteRegion(t,i),t.mesh.delete(r),i=e.regionAbove(n),r=i.eUp)),r.Org!==s.Org)if(r.Dst!==s.Dst&&!i.fixUpperEdge&&!n.fixUpperEdge&&(r.Dst===t.event||s.Dst===t.event)){if(e.checkForIntersect(t,i))return}else e.checkForRightSplice(t,i);r.Org===s.Org&&r.Dst===s.Dst&&(e.addWinding(s,r),e.deleteRegion(t,i),t.mesh.delete(r),i=e.regionAbove(n))}},e.connectRightVertex=function(t,i,n){var r,s=n.Onext,a=e.regionBelow(i),o=i.eUp,l=a.eUp,c=!1;if(o.Dst!==l.Dst&&e.checkForIntersect(t,i),ot.vertEq(o.Org,t.event)&&(t.mesh.splice(s.Oprev,o),i=e.topLeftRegion(t,i),s=e.regionBelow(i).eUp,e.finishLeftRegions(t,e.regionBelow(i),a),c=!0),ot.vertEq(l.Org,t.event)&&(t.mesh.splice(n,l.Oprev),n=e.finishLeftRegions(t,a,null),c=!0),c){e.addRightEdges(t,i,n.Onext,s,s,!0);return}ot.vertLeq(l.Org,o.Org)?r=l.Oprev:r=o,r=t.mesh.connect(n.Lprev,r),e.addRightEdges(t,i,r,r.Onext,r.Onext,!1),r.Sym.activeRegion.fixUpperEdge=!0,e.walkDirtyRegions(t,i)},e.connectLeftDegenerate=function(t,i,n){var r,s,a,o,l;if(r=i.eUp,ot.vertEq(r.Org,n)){pt(!1),e.spliceMergeVertices(t,r,n.anEdge);return}if(!ot.vertEq(r.Dst,n)){t.mesh.splitEdge(r.Sym),i.fixUpperEdge&&(t.mesh.delete(r.Onext),i.fixUpperEdge=!1),t.mesh.splice(n.anEdge,r),e.sweepEvent(t,n);return}pt(!1),i=e.topRightRegion(i),l=e.regionBelow(i),a=l.eUp.Sym,s=o=a.Onext,l.fixUpperEdge&&(pt(s!==a),e.deleteRegion(t,l),t.mesh.delete(a),a=s.Oprev),t.mesh.splice(n.anEdge,a),ot.edgeGoesLeft(s)||(s=null),e.addRightEdges(t,i,a.Onext,o,s,!0)},e.connectLeftVertex=function(t,i){var n,r,s,a,o,l,c=new Eb;if(c.eUp=i.anEdge.Sym,n=t.dict.search(c).key,r=e.regionBelow(n),!!r){if(a=n.eUp,o=r.eUp,ot.edgeSign(a.Dst,i,a.Org)===0){e.connectLeftDegenerate(t,n,i);return}if(s=ot.vertLeq(o.Dst,a.Dst)?n:r,n.inside||s.fixUpperEdge){if(s===n)l=t.mesh.connect(i.anEdge.Sym,a.Lnext);else{var u=t.mesh.connect(o.Dnext,i.anEdge);l=u.Sym}s.fixUpperEdge?e.fixUpperEdge(t,s,l):e.computeWinding(t,e.addRegionBelow(t,n,l)),e.sweepEvent(t,i)}else e.addRightEdges(t,n,i.anEdge,i.anEdge,null,!0)}},e.sweepEvent=function(t,i){t.event=i,e.debugEvent(t);for(var n=i.anEdge;n.activeRegion===null;)if(n=n.Onext,n===i.anEdge){e.connectLeftVertex(t,i);return}var r=e.topLeftRegion(t,n.activeRegion);pt(r!==null);var s=e.regionBelow(r),a=s.eUp,o=e.finishLeftRegions(t,s,null);o.Onext===a?e.connectRightVertex(t,r,o):e.addRightEdges(t,r,o.Onext,a,a,!0)},e.addSentinel=function(t,i,n,r){var s=new Eb,a=t.mesh.makeEdge();a.Org.s=n,a.Org.t=r,a.Dst.s=i,a.Dst.t=r,t.event=a.Dst,s.eUp=a,s.windingNumber=0,s.inside=!1,s.fixUpperEdge=!1,s.sentinel=!0,s.dirty=!1,s.nodeUp=t.dict.insert(s)},e.initEdgeDict=function(t){t.dict=new Ape(t,e.edgeLeq);var i=t.bmax[0]-t.bmin[0],n=t.bmax[1]-t.bmin[1],r=t.bmin[0]-i,s=t.bmax[0]+i,a=t.bmin[1]-n,o=t.bmax[1]+n;e.addSentinel(t,r,s,a),e.addSentinel(t,r,s,o)},e.doneEdgeDict=function(t){for(var i,n=0;(i=t.dict.min().key)!==null;)i.sentinel||(pt(i.fixUpperEdge),pt(++n===1)),pt(i.windingNumber===0),e.deleteRegion(t,i)},e.removeDegenerateEdges=function(t){var i,n,r,s=t.mesh.eHead;for(i=s.next;i!==s;i=n)n=i.next,r=i.Lnext,ot.vertEq(i.Org,i.Dst)&&i.Lnext.Lnext!==i&&(e.spliceMergeVertices(t,r,i),t.mesh.delete(i),i=r,r=i.Lnext),r.Lnext===i&&(r!==i&&((r===n||r===n.Sym)&&(n=n.next),t.mesh.delete(r)),(i===n||i===n.Sym)&&(n=n.next),t.mesh.delete(i))},e.initPriorityQ=function(t){var i,n,r,s=0;for(r=t.mesh.vHead,n=r.next;n!==r;n=n.next)s++;for(s+=8,i=t.pq=new Epe(s,ot.vertLeq),r=t.mesh.vHead,n=r.next;n!==r;n=n.next)n.pqHandle=i.insert(n);return n!==r?!1:(i.init(),!0)},e.donePriorityQ=function(t){t.pq=null},e.removeDegenerateFaces=function(t,i){var n,r,s;for(n=i.fHead.next;n!==i.fHead;n=r)r=n.next,s=n.anEdge,pt(s.Lnext!==s),s.Lnext.Lnext===s&&(e.addWinding(s.Onext,s),t.mesh.delete(s));return!0},e.computeInterior=function(t,i){i===void 0&&(i=!0);var n,r;if(e.removeDegenerateEdges(t),!e.initPriorityQ(t))return!1;for(e.initEdgeDict(t);(n=t.pq.extractMin())!==null;){for(;r=t.pq.min(),!(r===null||!ot.vertEq(r,n));)r=t.pq.extractMin(),e.spliceMergeVertices(t,n.anEdge,r.anEdge);e.sweepEvent(t,n)}return t.event=t.dict.min().key.eUp.Org,e.debugEvent(t),e.doneEdgeDict(t),e.donePriorityQ(t),e.removeDegenerateFaces(t,t.mesh)?(i&&t.mesh.check(),!0):!1},e}(),Ppe=function(){function e(){this.mesh=new aP,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=Zt.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return e.prototype.dot_=function(t,i){return t[0]*i[0]+t[1]*i[1]+t[2]*i[2]},e.prototype.normalize_=function(t){var i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];if(!i)throw"Zero-size vector!";i=Math.sqrt(i),t[0]/=i,t[1]/=i,t[2]/=i},e.prototype.longAxis_=function(t){var i=0;return Math.abs(t[1])>Math.abs(t[0])&&(i=1),Math.abs(t[2])>Math.abs(t[i])&&(i=2),i},e.prototype.computeNormal_=function(t){var i,n,r,s,a,o,l=[0,0,0],c=[0,0,0],u=[0,0,0],h=[0,0,0],d=[0,0,0],p=[null,null,null],f=[null,null,null],v=this.mesh.vHead;i=v.next;for(var m=0;m<3;++m)s=i.coords[m],c[m]=s,f[m]=i,l[m]=s,p[m]=i;for(i=v.next;i!==v;i=i.next)for(var g=0;g<3;++g)s=i.coords[g],s<c[g]&&(c[g]=s,f[g]=i),s>l[g]&&(l[g]=s,p[g]=i);var y=0;if(l[1]-c[1]>l[0]-c[0]&&(y=1),l[2]-c[2]>l[y]-c[y]&&(y=2),c[y]>=l[y]){t[0]=0,t[1]=0,t[2]=1;return}for(o=0,n=f[y],r=p[y],u[0]=n.coords[0]-r.coords[0],u[1]=n.coords[1]-r.coords[1],u[2]=n.coords[2]-r.coords[2],i=v.next;i!==v;i=i.next)h[0]=i.coords[0]-r.coords[0],h[1]=i.coords[1]-r.coords[1],h[2]=i.coords[2]-r.coords[2],d[0]=u[1]*h[2]-u[2]*h[1],d[1]=u[2]*h[0]-u[0]*h[2],d[2]=u[0]*h[1]-u[1]*h[0],a=d[0]*d[0]+d[1]*d[1]+d[2]*d[2],a>o&&(o=a,t[0]=d[0],t[1]=d[1],t[2]=d[2]);o<=0&&(t[0]=t[1]=t[2]=0,t[this.longAxis_(u)]=1)},e.prototype.checkOrientation_=function(){for(var t=this.mesh.fHead,i,n=this.mesh.vHead,r,s=0,a=t.next;a!==t;a=a.next)if(r=a.anEdge,!(r.winding<=0))do s+=(r.Org.s-r.Dst.s)*(r.Org.t+r.Dst.t),r=r.Lnext;while(r!==a.anEdge);if(s<0){for(i=n.next;i!==n;i=i.next)i.t=-i.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},e.prototype.projectPolygon_=function(){var t=this.mesh.vHead,i=[0,0,0],n,r,s=!1;i[0]=this.normal[0],i[1]=this.normal[1],i[2]=this.normal[2],!i[0]&&!i[1]&&!i[2]&&(this.computeNormal_(i),s=!0),n=this.sUnit,r=this.tUnit;var a=this.longAxis_(i);n[a]=0,n[(a+1)%3]=1,n[(a+2)%3]=0,r[a]=0,r[(a+1)%3]=0,r[(a+2)%3]=i[a]>0?1:-1;for(var o=t.next;o!==t;o=o.next)o.s=this.dot_(o.coords,n),o.t=this.dot_(o.coords,r);s&&this.checkOrientation_();for(var l=!0,c=t.next;c!==t;c=c.next)l?(this.bmin[0]=this.bmax[0]=c.s,this.bmin[1]=this.bmax[1]=c.t,l=!1):(c.s<this.bmin[0]&&(this.bmin[0]=c.s),c.s>this.bmax[0]&&(this.bmax[0]=c.s),c.t<this.bmin[1]&&(this.bmin[1]=c.t),c.t>this.bmax[1]&&(this.bmax[1]=c.t))},e.prototype.addWinding_=function(t,i){t.winding+=i.winding,t.Sym.winding+=i.Sym.winding},e.prototype.tessellateMonoRegion_=function(t,i){var n,r;if(n=i.anEdge,!(n.Lnext!==n&&n.Lnext.Lnext!==n))throw"Mono region invalid";for(;ot.vertLeq(n.Dst,n.Org);n=n.Lprev);for(;ot.vertLeq(n.Org,n.Dst);n=n.Lnext);r=n.Lprev;for(var s=void 0;n.Lnext!==r;)if(ot.vertLeq(n.Dst,r.Org)){for(;r.Lnext!==n&&(ot.edgeGoesLeft(r.Lnext)||ot.edgeSign(r.Org,r.Dst,r.Lnext.Dst)<=0);)s=t.connect(r.Lnext,r),r=s.Sym;r=r.Lprev}else{for(;r.Lnext!==n&&(ot.edgeGoesRight(n.Lprev)||ot.edgeSign(n.Dst,n.Org,n.Lprev.Org)>=0);)s=t.connect(n,n.Lprev),n=s.Sym;n=n.Lnext}if(r.Lnext===n)throw"Mono region invalid";for(;r.Lnext.Lnext!==n;)s=t.connect(r.Lnext,r),r=s.Sym;return!0},e.prototype.tessellateInterior_=function(t){for(var i,n=t.fHead.next;n!==t.fHead;n=i)if(i=n.next,n.inside&&!this.tessellateMonoRegion_(t,n))return!1;return!0},e.prototype.discardExterior_=function(t){for(var i,n=t.fHead.next;n!==t.fHead;n=i)i=n.next,n.inside||t.zapFace(n)},e.prototype.setWindingNumber_=function(t,i,n){for(var r,s=t.eHead.next;s!==t.eHead;s=r)r=s.next,s.Rface.inside!==s.Lface.inside?s.winding=s.Lface.inside?i:-i:n?t.delete(s):s.winding=0},e.prototype.getNeighbourFace_=function(t){return!t.Rface||!t.Rface.inside?-1:t.Rface.n},e.prototype.outputPolymesh_=function(t,i,n,r){var s,a=0,o=0,l;n>3&&t.mergeConvexFaces(n);for(var c=t.vHead.next;c!==t.vHead;c=c.next)c.n=-1;for(var u=t.fHead.next;u!==t.fHead;u=u.next)if(u.n=-1,!!u.inside){s=u.anEdge,l=0;do{var c=s.Org;c.n===-1&&(c.n=o,o++),l++,s=s.Lnext}while(s!==u.anEdge);if(l>n)throw"Face vertex greater that support polygon";u.n=a,++a}this.elementCount=a,i===Zi.CONNECTED_POLYGONS&&(a*=2),this.elements=[],this.elements.length=a*n,this.vertexCount=o,this.vertices=[],this.vertices.length=o*r,this.vertexIndices=[],this.vertexIndices.length=o;for(var c=t.vHead.next;c!==t.vHead;c=c.next)if(c.n!==-1){var h=c.n*r;this.vertices[h+0]=c.coords[0],this.vertices[h+1]=c.coords[1],r>2&&(this.vertices[h+2]=c.coords[2]),this.vertexIndices[c.n]=c.idx}for(var d=0,u=t.fHead.next;u!==t.fHead;u=u.next)if(u.inside){s=u.anEdge,l=0;do{var c=s.Org;this.elements[d++]=c.n,l++,s=s.Lnext}while(s!==u.anEdge);for(var p=l;p<n;++p)this.elements[d++]=-1;if(i===Zi.CONNECTED_POLYGONS){s=u.anEdge;do this.elements[d++]=this.getNeighbourFace_(s),s=s.Lnext;while(s!==u.anEdge);for(var f=l;f<n;++f)this.elements[d++]=-1}}},e.prototype.outputContours_=function(t,i){var n,r,s=0,a=0;this.vertexCount=0,this.elementCount=0;for(var o=t.fHead.next;o!==t.fHead;o=o.next)if(o.inside){r=n=o.anEdge;do this.vertexCount++,n=n.Lnext;while(n!==r);this.elementCount++}this.elements=[],this.elements.length=this.elementCount*2,this.vertices=[],this.vertices.length=this.vertexCount*i,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var l=0,c=0,u=0;s=0;for(var o=t.fHead.next;o!==t.fHead;o=o.next)if(o.inside){a=0,r=n=o.anEdge;do this.vertices[l++]=n.Org.coords[0],this.vertices[l++]=n.Org.coords[1],i>2&&(this.vertices[l++]=n.Org.coords[2]),this.vertexIndices[c++]=this.vertexIdCallback?this.vertexIdCallback(n):n.Org.idx,a++,n=n.Lnext;while(n!==r);this.elements[u++]=s,this.elements[u++]=a,s+=a}},e.prototype.addContour=function(t,i){this.mesh===null&&(this.mesh=new aP),t<2&&(t=2),t>3&&(t=3);for(var n=null,r=0;r<i.length;r+=t)n===null?(n=this.mesh.makeEdge(),this.mesh.splice(n,n.Sym)):(this.mesh.splitEdge(n),n=n.Lnext),n.Org.coords[0]=i[r+0],n.Org.coords[1]=i[r+1],t>2?n.Org.coords[2]=i[r+2]:n.Org.coords[2]=0,n.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(n),n.winding=1,n.Sym.winding=-1},e.prototype.tesselate=function(t,i,n,r,s,a){if(t===void 0&&(t=Zt.ODD),i===void 0&&(i=Zi.POLYGONS),a===void 0&&(a=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,s&&(this.normal[0]=s[0],this.normal[1]=s[1],this.normal[2]=s[2]),this.windingRule=t,r<2&&(r=2),r>3&&(r=3),!this.mesh)return!1;this.projectPolygon_(),Tpe.computeInterior(this,a);var o=this.mesh;return i===Zi.BOUNDARY_CONTOURS?this.setWindingNumber_(o,1,!0):this.tessellateInterior_(o),a&&o.check(),i===Zi.BOUNDARY_CONTOURS?this.outputContours_(o,r):this.outputPolymesh_(o,i,n,r),!0},e}();function ic(e){var t=e.windingRule,i=t===void 0?Zt.ODD:t,n=e.elementType,r=n===void 0?Zi.POLYGONS:n,s=e.polySize,a=s===void 0?3:s,o=e.vertexSize,l=o===void 0?2:o,c=e.normal,u=c===void 0?[0,0,1]:c,h=e.contours,d=h===void 0?[]:h,p=e.strict,f=p===void 0?!0:p,v=e.debug,m=v===void 0?!1:v;if(!d&&f)throw new Error("Contours can't be empty");if(d){var g=new Ppe;e.edgeCreateCallback&&(g.edgeCreateCallback=e.edgeCreateCallback),e.vertexIdCallback&&(g.vertexIdCallback=e.vertexIdCallback);for(var y=0;y<d.length;y++)g.addContour(l||2,d[y]);return g.tesselate(i,r,a,l,u,f),{vertices:g.vertices,vertexIndices:g.vertexIndices,vertexCount:g.vertexCount,elements:g.elements,elementCount:g.elementCount,mesh:m?g.mesh:void 0}}}Zt.ODD;Zt.NONZERO;Zt.POSITIVE;Zt.NEGATIVE;Zt.ABS_GEQ_TWO;Zi.POLYGONS;Zi.CONNECTED_POLYGONS;Zi.BOUNDARY_CONTOURS;var dM=class{constructor(e=256,t=!1){this.capacity=e,this.size=0,this.debug=t,this.debug&&console.log(`allocating with cap ${e}`);let i=e*dM.eSize;this.buffer=new ArrayBuffer(i);let n=Float32Array.BYTES_PER_ELEMENT,r=0;this.positions=new Float32Array(this.buffer,r*n,3*e),r+=3*e,this.normals=new Float32Array(this.buffer,r*n,3*e),r+=3*e,this.uvs=new Float32Array(this.buffer,r*n,2*e)}realloc(e,t=!1){if(e<this.size)throw Error("cannot shrink buffer");if(e<=this.capacity&&!t)return;this.debug&&console.log(`resizing from ${this.capacity} → ${e}`);let i=e*dM.eSize,n=new ArrayBuffer(i),r=Float32Array.BYTES_PER_ELEMENT,s=0,a=new Float32Array(n,s*r,3*e);s+=3*e;let o=new Float32Array(n,s*r,3*e);s+=3*e;let l=new Float32Array(n,s*r,2*e);t?(a.set(this.positions.subarray(0,this.size*3)),o.set(this.normals.subarray(0,this.size*3)),l.set(this.uvs.subarray(0,this.size*2))):(a.set(this.positions),o.set(this.normals),l.set(this.uvs)),this.buffer=n,this.positions=a,this.normals=o,this.uvs=l,this.capacity=e}get(e=1){let t=this.size+e;if(t>this.capacity){let n=this.capacity;for(;t>n;)n*=2;this.realloc(n)}let i=this.size;return this.size=t,i}reserve(e){let t=this.size+e;t>this.capacity&&this.realloc(t)}shrink(){this.debug&&console.log(`shrinking ${this.capacity} → ${this.size}`),this.realloc(this.size,!0)}},zU=dM;zU.eSize=(3+3+2)*Float32Array.BYTES_PER_ELEMENT;var Dpe=Gp(rZ()),yA={vertices:[160,160,-160,160,-160,-160,160,-160],vertexIndices:[1,0,3,2],vertexCount:4,elements:[0,4],elementCount:1,mesh:void 0},kU={vertices:[],vertexIndices:[],vertexCount:0,elements:[],elementCount:0,mesh:void 0},VU={vertices:[-160,160,160,-160,160,160,-160,-160],vertexIndices:[1,3,0,2],vertexCount:4,elements:[0,1,2,1,0,3],elementCount:2,mesh:void 0},Ab=(e,t)=>([i,n])=>(n<i&&(n+=t),(e>=i?e:e+t)<=n),xA=class extends mt{constructor(e,t,i=0,n=12,r=3,s=Zt.ODD,a=!1){super(),this.forPathBevel=a,this.type="ShapeGeometry",this.vertexCache={},this._shape=e,this._depth=t,this._curveSegments=n,this._bevelSegmentsInput=r;let o=this._shape.extractShapePointsToFlatArray([],n),l=this._shape.shapeHoles.map(C=>{let E=C.extractShapePointsToFlatArray([],n),P=[];for(let I=E.length-1;I>=1;I-=2){let D=E[I-1],L=E[I-0];P.push(D,L)}return P}),c=[],u=[];for(let C=0;C<o.length;C+=2)u.push([o[C],o[C+1]]);c.push(u);for(let C=0;C<l.length;C++){let E=l[C],P=[];for(let I=0;I<E.length;I+=2)P.push([E[I],E[I+1]]);c.push(P)}let h=c[0].length?(0,Dpe.default)(c).distance:i;i<=0?(this._bevel=0,this._bevelSegments=0):(this._bevel=Math.min(i,h,t/2),this._bevelSegments=Math.floor(r));let d;try{d=ic({windingRule:s,elementType:Zi.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[o]})}catch{d=yA}let p;try{p=ic({windingRule:Zt.ODD,elementType:Zi.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...l]})}catch{p=kU}if(!d)throw new Error("error generating geometry");let f=d.elementCount;if(p){d.elementCount+=p.elementCount;for(let C=0;C<p.elements.length;C++){let E=p.elements[C],P=C%2===0?d.vertexCount:0;d.elements.push(E+P)}for(let C=0;C<p.vertexIndices.length;C++){let E=p.vertexIndices[C],P=d.vertexCount;d.vertexIndices.push(E+P)}for(let C=0;C<p.vertices.length;C++){let E=p.vertices[C];d.vertices.push(E)}}let v=1/0,m=-1/0,g=1/0,y=-1/0;for(let C=0,E=d.vertexCount;C<E;C++){let P=C*2,I=d.vertices[P+0],D=d.vertices[P+1];I<v&&(v=I),I>m&&(m=I),D<g&&(g=D),D>y&&(y=D)}this._minX=v,this._minY=g,this._width=m-v,this._height=y-g,this._buffer=new zU(this._computeBufferEstimatedSize(d));let x=[],_=[];for(let C=d.elementCount-1;C>=0;C--){let E=C>=f,P=C*2,I=d.elements[P+0],D=d.elements[P+1],L=I+D,B={start:I,count:D,normals:[],continuous:[],concave:[]},j=I,z=L-1,O=I+1,H=this._shape.roundedCurves.length;do{let G=j-I,K=d.vertices[z*2+0],W=d.vertices[z*2+1],se=d.vertices[j*2+0],ie=d.vertices[j*2+1],re=d.vertices[O*2+0],de=d.vertices[O*2+1],he=se-K,X=ie-W,Ee=Math.sqrt(he*he+X*X);he/=Ee,X/=Ee;let Oe=se-re,Me=ie-de,Ne=Math.sqrt(Oe*Oe+Me*Me);Oe/=Ne,Me/=Ne,B.normals[G*2+0]=-Me,B.normals[G*2+1]=Oe,B.concave[G]=he*Me-X*Oe>0;let He=d.vertexIndices[j];if(Array.isArray(He))B.continuous[G]=!1;else{let[Pe,Ce]=this._shape.getCurveIndexFromVertexId(He-1,!0);if(Ce>0&&Ce<1)B.continuous[G]=!0;else{let je=Ce===1?Pe+1:Pe-1;je=(je+H)%H;let qe=Ce===1?0:1,q=this._shape.roundedCurves[Pe].getTangent(Ce),A=this._shape.roundedCurves[je].getTangent(qe);B.continuous[G]=q.dot(A)>.95}}E&&(B.normals[G*2+0]*=-1,B.normals[G*2+1]*=-1),[z,j,O]=[j,O,O+1],O>=L&&(O-=D)}while(O!==I+1);let k=[];k.push({bevelI:0,angle:0,size:0,boundary:{vertices:d.vertices.slice(I*2,L*2),vertexCount:D,vertexIndices:new Array(D).fill(!0).map((G,K)=>[K,K]),elements:[0,D],elementCount:1,mesh:null},reverseMap:[],insetPoints:d.vertices.slice(I*2,L*2)});let N=0;for(let G=1;G<=this._bevelSegments;G++){let K=G/this._bevelSegments*Math.PI/2,W=(1-Math.cos(K))*this._bevel,se=[],ie=[],re=0;for(let he=0;he<D;he++){let X=he*2,Ee=(he-1+D)%D*2,Oe=d.vertices[B.start*2+X+0],Me=d.vertices[B.start*2+X+1],Ne=-B.normals[Ee+0]*W,He=-B.normals[Ee+1]*W,Pe=-B.normals[X+0]*W,Ce=-B.normals[X+1]*W;if(B.concave[he]||!B.concave[he]&&E){let je=Math.atan2(He,Ne),qe=Math.atan2(Ce,Pe);qe>je&&(qe-=Math.PI*2);let q=qe-je;if(B.continuous[he]||E){let A=je+q/2,R=Math.cos(A)*W,$=Math.sin(A)*W;se[2*re+0]=Oe+R*(E?-1:1),se[2*re+1]=Me+$*(E?-1:1),ie[re]=he,re++}else{let A=Math.max(1,Math.floor(n/4*Math.abs(q)/Math.PI));for(let R=0;R<=A;R++){let $=je+q*(R/A),le=Math.cos($)*W,ue=Math.sin($)*W;se[2*re+0]=Oe+le,se[2*re+1]=Me+ue,ie[re]=he,re++}}}else se[2*re+0]=Oe+Ne,se[2*re+1]=Me+He,ie[re]=he,re++,se[2*re+0]=Oe,se[2*re+1]=Me,ie[re]=he,re++,se[2*re+0]=Oe+Pe,se[2*re+1]=Me+Ce,ie[re]=he,re++}let de=ic({windingRule:Zt.POSITIVE,elementType:Zi.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[se],edgeCreateCallback:he=>{let X=he.Org.idx,Ee=ie[X],Oe=ie[(X+1)%ie.length];he.idx=[Ee,Oe],he.Sym.idx=[Oe,Ee]},vertexIdCallback:he=>{let X=he.Lprev.idx;return[X?X[1]:0,he.idx?he.idx[0]:0]}});if(!de)throw console.log("Error"),new Error(`error generating bevel geometry for ${G}'th loop`);if(!de.vertexCount){let he=(G-1)/this._bevelSegments*Math.PI/2;N=(1-Math.sin(he))*this._bevel;break}for(let he=0;he<de.vertexIndices.length;he++){let[X,Ee]=de.vertexIndices[he];if(X===Ee)continue;let Oe=Ee;Ee<X&&(Oe+=D);for(let Me=X;Me<Oe;Me++){let Ne=Me%D,He=(Me+1)%D;if(!B.continuous[Ne]||!B.continuous[He]){de.vertexIndices[he]=[X,Ne],de.vertexIndices.splice(he+1,0,[He,Ee]),de.vertices.splice((he+1)*2,0,de.vertices[he*2],de.vertices[he*2+1]);break}}}k.push({bevelI:G,angle:K,size:W,boundary:de,reverseMap:ie,insetPoints:se})}let F=(G,K,W)=>{let se=0,ie=G.boundary.vertexIndices.length;for(;se<ie&&W(G.boundary.vertexIndices[K]);)K=(K+1)%ie,se++;return se},Q=x.length;for(let G=1;G<k.length;G++){let K=k[G-1],W=k[G],se=K.boundary.vertexIndices.length,ie=W.boundary.vertexIndices.length;if(!se||!ie)break;let re=B.concave.length,de=0,he=Ab(de,D);for(;!K.boundary.vertexIndices.filter(he).length||!W.boundary.vertexIndices.filter(he).length;)de++,he=Ab(de,D);let X=K.boundary.vertexIndices.findIndex(he),Ee=W.boundary.vertexIndices.findIndex(he);do X=(X+1)%se;while(he(K.boundary.vertexIndices[X]));do Ee=(Ee+1)%ie;while(he(W.boundary.vertexIndices[Ee]));de=(de+1)%D;let Oe=de,Me=0,Ne=this._buildBevelVert(B,K,(X-1+se)%se,void 0,Me),He=this._buildBevelVert(B,W,(Ee-1+ie)%ie,void 0,Me),Pe=Ne,Ce=He,je,qe,q=!1;do{Me=(de||re)/re,he=Ab(de,D);let A=F(K,X,he),R=F(W,Ee,he),$=q;if(q=!1,A&&!R){for(let le=0;le<A;le++)je=this._buildBevelVert(B,K,(X+le)%se,le/(A-1),Me),x.push(Pe.topN,je.topP,Ce.topN),a===!1&&x.push(je.bottomP,Pe.bottomN,Ce.bottomN),Pe=je;q=!0}else if(!A&&R)for(let le=0;le<R;le++)qe=this._buildBevelVert(B,W,(Ee+le)%ie,le/(R-1),Me),x.push(Ce.topN,Pe.topP,qe.topP),a===!1&&x.push(Pe.bottomP,Ce.bottomN,qe.bottomP),Ce=qe;else if(A&&R)if(je=this._buildBevelVert(B,K,X,0,Me),qe=this._buildBevelVert(B,W,Ee,0,Me),$?(x.push(Pe.topN,qe.topP,Ce.topN),x.push(Pe.topN,je.topP,qe.topP),a===!1&&(x.push(qe.bottomP,Pe.bottomN,Ce.bottomN),x.push(qe.bottomP,je.bottomP,Pe.bottomN))):(x.push(Ce.topN,Pe.topN,je.topP),x.push(Ce.topN,je.topP,qe.topP),a===!1&&(x.push(je.bottomP,Pe.bottomN,Ce.bottomN),x.push(je.bottomP,Ce.bottomN,qe.bottomP))),Pe=je,Ce=qe,A===R)for(let le=1;le<A;le++)je=this._buildBevelVert(B,K,(X+le)%se,le/(A-1),Me),qe=this._buildBevelVert(B,W,(Ee+le)%ie,le/(R-1),Me),x.push(Pe.topN,je.topP,Ce.topN),x.push(Ce.topN,je.topP,qe.topP),a===!1&&(x.push(je.bottomP,Pe.bottomN,Ce.bottomN),x.push(je.bottomP,Ce.bottomN,qe.bottomP)),Pe=je,Ce=qe;else if(A>R){let le=A/R,ue=0;for(let we=1;we<A;we++)je=this._buildBevelVert(B,K,(X+we)%se,we/(A-1),Me),x.push(Pe.topN,je.topP,Ce.topN),a===!1&&x.push(je.bottomP,Pe.bottomN,Ce.bottomN),Pe=je,we>(ue+1)*le&&(ue++,qe=this._buildBevelVert(B,W,(Ee+ue)%ie,ue/(R-1),Me),x.push(Ce.topN,je.topP,qe.topP),a===!1&&x.push(je.bottomP,Ce.bottomN,qe.bottomP),Ce=qe)}else{let le=R/A,ue=0;for(let we=1;we<R;we++)qe=this._buildBevelVert(B,W,(Ee+we)%ie,we/(R-1),Me),x.push(Ce.topN,je.topP,qe.topP),a===!1&&x.push(je.bottomP,Ce.bottomN,qe.bottomP),Ce=qe,we>(ue+1)*le&&(ue++,je=this._buildBevelVert(B,K,(X+ue)%se,ue/(A-1),Me),x.push(Pe.topN,je.topP,Ce.topN),a===!1&&x.push(je.bottomP,Pe.bottomN,Ce.bottomN),Pe=je)}X=(X+A)%se,Ee=(Ee+R)%ie,de=(de+1)%re}while(de!==Oe)}if(a===!1&&this._depth>this._bevel*2&&this._buildWall(k,B,x),E){let G=[];for(let K=x.length-1;K>=Q+2;K-=3){let W=x[K-2],se=x[K-1],ie=x[K-0];G.push(ie,se,W)}x.splice(Q,x.length-Q,...G)}if(E){let G=[];for(let K=k[k.length-1].boundary.vertices.length-1;K>=1;K-=2){let W=k[k.length-1].boundary.vertices[K-1],se=k[k.length-1].boundary.vertices[K-0];G.push(W,se)}_.push(G)}if(!E){let G=k[k.length-1],K;try{K=ic({windingRule:k.length>1?Zt.POSITIVE:Zt.ODD,elementType:Zi.POLYGONS,vertexSize:2,strict:!0,contours:[G.insetPoints,..._]})}catch{K=VU}if(!K)throw new Error("Error generating geometry for surface");l.length===0&&this._bevel<h&&Object.assign(this,{useNgonForTopBottomFaceDuringBake:!0});for(let W=0;W<K.elementCount*3;W+=3){let se=this._buildSurfaceVert(K,K.elements[W+0],N),ie=this._buildSurfaceVert(K,K.elements[W+1],N),re=this._buildSurfaceVert(K,K.elements[W+2],N);x.push(se.top,ie.top,re.top),a===!1&&x.push(re.bottom,ie.bottom,se.bottom)}}this.vertexCache={}}this._buffer.shrink();let b=new gt(Uint32Array.from(x),1),w=new gt(this._buffer.positions,3),M=new gt(this._buffer.normals,3),S=new gt(this._buffer.uvs,2);w.needsUpdate=!0,M.needsUpdate=!0,S.needsUpdate=!0,b.needsUpdate=!0,this.setAttribute("position",w),this.setAttribute("normal",M),this.setAttribute("uv",S),this.setIndex(b)}_computeBufferEstimatedSize(e){return e.vertexCount*2*(2+this._bevelSegments)}_buildWall(e,t,i){let n=e[0];for(let r=0,s=n.boundary.vertexCount;r<s;r++){let a=this._buildBevelVert(t,n,r),o=this._buildBevelVert(t,n,(r+1)%s);i.push(o.topP,a.topN,a.bottomN),i.push(o.topP,a.bottomN,o.bottomP)}}_buildSurfaceVert(e,t,i){let n=t.toString();if(n in this.vertexCache)return this.vertexCache[n];let r=e.vertices[t*2+0],s=e.vertices[t*2+1],a=(r-this._minX)/this._width,o=(s-this._minY)/this._height;this.forPathBevel&&(o=1);let l=this._buffer.get(this.forPathBevel?1:2),c=l*3,u=l*2,h={top:l+0,bottom:l+1};return this._buffer.positions[c+0]=r,this._buffer.positions[c+1]=s,this._buffer.positions[c+2]=this.forPathBevel?this._bevel:this._depth-i,this._buffer.normals[c+0]=0,this._buffer.normals[c+1]=0,this._buffer.normals[c+2]=1,this._buffer.uvs[u+0]=a,this._buffer.uvs[u+1]=o,this.forPathBevel===!1&&(this._buffer.positions[c+3]=r,this._buffer.positions[c+4]=s,this._buffer.positions[c+5]=i,this._buffer.normals[c+3]=0,this._buffer.normals[c+4]=0,this._buffer.normals[c+5]=-1,this._buffer.uvs[u+2]=a,this._buffer.uvs[u+3]=o),this.vertexCache[n]=h,h}_buildBevelVert(e,t,i,n=1,r){let s=`${t.bevelI}:${i}`;if(s in this.vertexCache&&r!==0&&r!==1&&(!r||r===this.vertexCache[s].pathBevelUCoord))return this.vertexCache[s];let[a,o]=t.boundary.vertexIndices[i],l,c,u,h;a!==o?(c=a,l=o,h=!1,u=e.continuous[c]&&e.continuous[l]):(l=a,c=(l-1+e.count)%e.count,h=e.concave[l]&&t.bevelI>0,u=e.continuous[l]||h);let d=Math.cos(t.angle),p=Math.sin(t.angle),f=i*2,v=l*2,m=c*2,g=t.boundary.vertices[f+0],y=t.boundary.vertices[f+1],x=(1-p)*this._bevel,_=(g-this._minX)/this._width,b=(y-this._minY)/this._height;this.forPathBevel&&(r!==void 0&&(_=r),b=1);let w=e.normals[v+0],M=e.normals[v+1],S=e.normals[m+0],C=e.normals[m+1];if(h){let L=S-w,B=C-M;w=w+L*(1-n),M=M+B*(1-n);let j=Math.sqrt(w*w+M*M);w/=j,M/=j}let E=this.forPathBevel?this._buffer.get(u?1:2):this._buffer.get(u?2:4),P=E*3,I=E*2,D={i,fi:l,topP:E+0,topN:E+0,bottomP:E+1,bottomN:E+1,pathBevelUCoord:r};return this._buffer.positions[P+0]=g,this._buffer.positions[P+1]=y,this._buffer.positions[P+2]=(this.forPathBevel?this._bevel:this._depth)-x,this._buffer.normals[P+0]=w*d,this._buffer.normals[P+1]=M*d,this._buffer.normals[P+2]=p,this._buffer.uvs[I+0]=_,this._buffer.uvs[I+1]=b,this.forPathBevel===!1&&(this._buffer.positions[P+3]=g,this._buffer.positions[P+4]=y,this._buffer.positions[P+5]=x,this._buffer.normals[P+3]=w*d,this._buffer.normals[P+4]=M*d,this._buffer.normals[P+5]=-p,this._buffer.uvs[I+2]=b,this._buffer.uvs[I+3]=_),u||(this.forPathBevel?(E+=1,P+=3,I+=2):(E+=2,P+=6,I+=4),D.topP=E+0,D.bottomP=E+1,this._buffer.positions[P+0]=g,this._buffer.positions[P+1]=y,this._buffer.positions[P+2]=(this.forPathBevel?this._bevel:this._depth)-x,this._buffer.normals[P+0]=S*d,this._buffer.normals[P+1]=C*d,this._buffer.normals[P+2]=p,this._buffer.uvs[I+0]=_,this._buffer.uvs[I+1]=b,this.forPathBevel===!1&&(this._buffer.positions[P+3]=g,this._buffer.positions[P+4]=y,this._buffer.positions[P+5]=x,this._buffer.normals[P+3]=S*d,this._buffer.normals[P+4]=C*d,this._buffer.normals[P+5]=-p,this._buffer.uvs[I+2]=b,this._buffer.uvs[I+3]=_)),this.vertexCache[s]=D,D}clone(){let e=new xA(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=m2(this.userData),e}},HU=class extends mt{constructor(e,t=12,i={}){super(),this.type="ShapeGeometry",this.windingRule=Zt.ODD,this.elementType=Zi.POLYGONS,this.polySize=3,this.vertexSize=2,this.strict=!0,this._shape=e,this._curveSegments=t,this._triangulationOptions=Object.assign({windingRule:Zt.ODD,elementType:Zi.POLYGONS,polySize:3,vertexSize:2,strict:!0},i);let n=this._shape.extractShapePointsToFlatArray([],this._curveSegments),r=this._shape.shapeHoles.map(d=>d.extractShapePointsToFlatArray([],this._curveSegments)),s,a=!0,o=!0,l,c;for(let d=0,p=n.length/2;d<p;d++){let f=d*2,v=n[f+0],m=n[f+1];if(l!==void 0&&v!==l&&(a=!1),c!==void 0&&m!==c&&(o=!1),l=v,c=m,!a&&!o)break}if(!a&&!o)try{s=ic({contours:[n,...r],windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})}catch{s=yA}let u=(s==null?void 0:s.vertexCount)??1,h=(s==null?void 0:s.elementCount)??1;if(this._positionAttribute=new gt(new Float32Array(u*3),3),this._normalAttribute=new gt(new Float32Array(u*3),3),this._uvAttribute=new gt(new Float32Array(u*2),2),this._indexAttribute=new gt(new Uint32Array(h*3),1),s){let d=1/0,p=-1/0,f=1/0,v=-1/0;for(let y=0,x=u;y<x;y++){let _=y*2,b=s.vertices[_+0],w=s.vertices[_+1];b<d&&(d=b),b>p&&(p=b),w<f&&(f=w),w>v&&(v=w)}let m=p-d,g=v-f;for(let y=0,x=u;y<x;y++){let _=y*2,b=s.vertices[_+0],w=s.vertices[_+1],M=(b-d)/m,S=(w-f)/g;this._positionAttribute.setXYZ(y,b,w,0),this._normalAttribute.setXYZ(y,0,0,1),this._uvAttribute.setXY(y,M,S)}for(let y=0,x=h;y<x;y++){let _=y*3,b=s.elements[_+0],w=s.elements[_+1],M=s.elements[_+2];this._indexAttribute.setX(_+0,b),this._indexAttribute.setX(_+1,w),this._indexAttribute.setX(_+2,M)}}this.setAttribute("position",this._positionAttribute),this.setAttribute("normal",this._normalAttribute),this.setAttribute("uv",this._uvAttribute),this.setIndex(this._indexAttribute),this.setDrawRange(0,((s==null?void 0:s.elementCount)??1)*3)}clone(){let e=new HU(this._shape,this._curveSegments);return e.userData=m2(this.userData),e}},GU=class extends xA{constructor(e,t,i=0,n=12,r=3,s=Zt.ODD){super(e,t,i,n,r,s),this.type="ShapeGeometry"}_computeBufferEstimatedSize(e){return e.vertexCount*2*(2+this._bevelSegments)}_buildWall(e,t,i){let n=e[0];for(let r=0,s=n.boundary.vertexCount;r<s;r++){let a=this._buildBevelVert(t,n,r),o=this._buildBevelVert(t,n,(r+1)%s);i.push(o.topP,a.topN,a.bottomN),i.push(o.topP,a.bottomN,o.bottomP)}}clone(){let e=new GU(this._shape,this._depth,this._bevel,this._curveSegments,this._bevelSegmentsInput);return e.userData=m2(this.userData),e}},au=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var c,u;let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,subdivisions:40,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3,windingRule:Zt.ODD},e.parameters),n=Math.abs(i.width),r=Math.abs(i.height??i.width),s=Math.abs(i.depth??0),a=e.shape??(t==null?void 0:t.shape),o=(a==null?void 0:a.roundness)??i.roundness;a!==void 0&&(a instanceof Di?(a.width!==n||a.height!==r)&&a.applySize(n,r):a=new Di(n,r).fromJSON(a),((c=e.parameters)==null?void 0:c.roundness)!==void 0&&((u=e.parameters)==null?void 0:u.roundness)>0&&a.update());let l=a??new Di(n,r);return{parameters:Object.assign(i,{width:n,height:r,depth:s,roundness:o}),shape:l}}static build(e){let{depth:t,extrudeBevelSize:i,extrudeBevelSegments:n,subdivisions:r,roundness:s,windingRule:a}=e.parameters;e.shape.roundness=s;let o;return t<=0?o=new HU(e.shape,r,{windingRule:a}):o=new GU(e.shape,t,i,r,n,a),Object.assign(o,{userData:{...e,type:"VectorGeometry"}})}},jU=Math.PI*2,_A=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:64,angle:360,innerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return{shape:e.shape&&e.shape instanceof Di?e.shape:new Di,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(e){let{width:t,height:i,spikes:n,angle:r,innerRadius:s,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}=e.parameters,c=e.shape,u=t*.5,h=i*.5,d=Lpe(c,u,h,r*Math.PI/180,n,s);c.isClosed=!0,c.update();let p=au.create({shape:c,parameters:{subdivisions:d,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}});return Object.assign(p,{userData:{...e,type:"EllipseGeometry"}})}};function Lpe(e,t,i,n,r,s){if(n>=jU)return r>30||r%4===0?(Ipe(e,t,i,s),Math.round(r/4)):hP(e,n,r,t,i,s);n=Math.max(n,.001);let a={x:0,y:i},o=n+Math.PI*.5,l={x:Math.cos(o)*t,y:Math.sin(o)*i},c=Cpe({px:a.x,py:a.y,cx:l.x,cy:l.y,rx:t,ry:i,largeArcFlag:n>Math.PI,sweepFlag:!0});return r>30||r%c.length===0?Rpe(e,a.x,a.y,c,r,t,i,s):hP(e,n,r,t,i,s)}function Rpe(e,t,i,n,r,s,a,o){let l=Math.round(r/n.length);e.addPoint(ip(t,i));for(let c=0,u=n.length;c<u;c++){let h=n[c],d=e.points[c],p=ip(h.x,h.y);d.controls[1].position.set(h.x1,h.y1),p.controls[0].position.set(h.x2,h.y2),e.addPoint(p)}return o>0?WU(e,s,a,o):e.addPoint(ip(0,0)),l}function hP(e,t,i,n,r,s){let a=-t/i;for(let o=0;o<=i;o++){let l=a*o,c=Math.sin(l)*n,u=Math.cos(l)*r;e.addPoint(ip(c,u))}return t<jU?s>0?WU(e,n,r,s):e.addPoint(ip(0,0)):(e.removePoint(e.points[e.points.length-1]),s>0&&XU(e,n,r,s)),1}function Ipe(e,t,i,n=0,r=0,s=0){let a=.5522847498,o=t*a,l=i*a;e.addPoint(P1(r-t,s,r-t,s-l,r-t,s+l)),e.addPoint(P1(r,s+i,r-o,s+i,r+o,s+i)),e.addPoint(P1(r+t,s,r+t,s+l,r+t,s-l)),e.addPoint(P1(r,s-i,r+o,s-i,r-o,s-i)),n>0&&XU(e,t,i,n)}function ip(e,t){return new tp(Dt.generateUUID(),new te(e,t))}function P1(e,t,i,n,r,s){let a=ip(e,t);return a.controls[0].position.set(i,n),a.controls[1].position.set(r,s),a}function WU(e,t,i,n){qU(e,t,i,n).forEach(r=>e.addPoint(r))}function XU(e,t,i,n){let r=qU(e,t,i,n),s=new Di;r.forEach(a=>s.addPoint(a)),s.isClosed=!0,e.shapeHoles.push(s)}function qU(e,t,i,n){let r=n*t/100,s=r*(Math.abs(i)/Math.abs(t)),a=new te(r/t,s/i),o=e.points.map(l=>{let c=l.clone();return c.uuid=Dt.generateUUID(),c}).reverse();return o.forEach(l=>{l.position.multiply(a);let c=l.controls[0].position.clone().multiply(a),u=l.controls[1].position.clone().multiply(a);l.controls[0].position.copy(u),l.controls[1].position.copy(c)}),o}var Ope=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},e.parameters),n=Math.abs(i.width),r=Math.abs(i.height??n),s=Math.abs(i.depth??n),a=Math.abs(Math.min(n,s))/2;return{parameters:Object.assign(i,{width:n,height:r,depth:s,radius:a,segments:Math.round(i.segments),pathSegments:Math.round(i.pathSegments),cornerSegments:Math.round(i.cornerSegments)})}}static build(e){let{width:t,height:i,depth:n,radius:r,revolutions:s,segments:a,pathRadius:o,pathType:l,pathSegments:c,cornerRadius:u,cornerSegments:h}=e.parameters,d=new YU(!1,t,i,n,r,s,a,o,l,c,u,h);return Object.assign(d,{userData:{...e,type:"HelixGeometry"}})}},Tb=new qd([0,0,0],1),YU=class extends mt{constructor(e=!0,t=1,i=1,n=1,r=1,s=1,a=1,o=1,l=1,c=1,u=1,h=1){if(super(),s===0)return;let d=e&&s===1;d&&(h=0),u>100&&(u=100),u===0&&(h=0);let p=()=>new T,f=new T,v=p(),m=p(),g=p(),y,x,_,b,w,M,S,C,E=p(),P=p(),I=p(),D=p(),L=p(),B=p(),j=p(),z=p(),O=i-2*o+.001,H=O/s,k=Math.ceil(a*s),N=k+1,F=O/k,Q=-O/2,G=c+1,K=2*Math.PI/c,W=Math.PI/2/h,se=.01,ie=Math.min((1-u/100)*o,o-se),re=o-ie,de=0,he=2,X=h*he+he,Ee=G*X/he,Oe=Ee+G*N,Me=G*(N+X),[Ne,He,Pe]=[3,3,2].map(ne=>Array(Me*ne).fill(0)),Ce=[],je=r-o;function qe(ne,oe){let Y=Math.PI/2;M=oe*F,C=2*Math.PI*(M%H)/H+Y,M+=Q,S=Math.sin(C)*je,w=Math.cos(C)*je,e?ne.set(w,S,M):ne.set(w,M,S)}qe(f,-1e-10),qe(v,0),E.copy(f),qe(f,1);let q=f.distanceTo(v),A=d?0:re+ie,R=q*k+2*A,$=ie,le=R-A;for(let ne=0;ne<=k;ne++){qe(m,ne),z.subVectors(m,E).normalize(),E.copy(m),B.copy(m).setComponent(+e+1,0).normalize(),j.crossVectors(z,B).normalize();let oe=ne===0,Y=ne===k,me=oe?3*Math.PI/2:W,Le=oe?$:le,Ae=oe?G:Oe,Ue=oe?0:Me-G,$e=z.clone().multiplyScalar(oe?-re:re).add(m),at=z.clone().multiplyScalar(oe?-1:1).normalize();for(let U=0;U<G;U++){let ae=U*K;if(P.addVectors(f.copy(B).multiplyScalar(o*Math.cos(ae)),v.copy(j).multiplyScalar(o*Math.sin(ae))),I.copy(P).normalize(),oe||Y){d||(de=Ue+U,[0,1,2].forEach(J=>{Ne[de*3+J]=$e.getComponent(J),He[de*3+J]=at.getComponent(J)}),Pe[de*2]=+Y,Pe[de*2+1]=U/c),v.copy(I).multiplyScalar(ie),g.addVectors(m,v);for(let J=0;J<h;J++){let ge=J*W+me;D.addVectors(f.copy(z).multiplyScalar(re*Math.sin(ge)),v.copy(I).multiplyScalar(re*Math.cos(ge))),L.copy(D).normalize(),v.addVectors(g,D),D.normalize(),de=Ae+J*G+U,[0,1,2].forEach(Qe=>{Ne[de*3+Qe]=v.getComponent(Qe),He[de*3+Qe]=L.getComponent(Qe)});let Te=+oe+Math.sin(ge);Pe[de*2]=(Le+re*Te)/R,Pe[de*2+1]=U/c}}v.addVectors(m,P),de=Ee+ne*G+U,[0,1,2].forEach(J=>{Ne[de*3+J]=v.getComponent(J),He[de*3+J]=I.getComponent(J)}),Pe[de*2]=(A+ne*q)/R,Pe[de*2+1]=U/c}}let ue=N+2*h+he,[we,De]=[+d,ue-1];for(let ne=we;ne<=De-1;ne++){let oe=d&&ne===De-1;for(let Y=0;Y<G-1;Y++)y=ne*G+Y,x=y+1,_=(oe?Y:y)+G,b=(oe?Y+1:x)+G,ne===0?Ce.push(x,b,_):ne===ue-2?Ce.push(y,x,_):Ce.push(y,x,_,x,b,_)}this.setIndex(Ce),this.setAttribute("position",new et(Ne,3)),this.setAttribute("normal",new et(He,3)),this.setAttribute("uv",new et(Pe,2))}getClosedTorusIndicesForBooleanOrSubdiv(){let e=this.userData.parameters,t=Math.ceil(e.tubularSegments),i=e.radialSegments+1,n=Array.from(this.getIndex().array),r,s,a,o,l=6*(t-1)*e.radialSegments,c=t,u=c===t;for(let h=0;h<e.radialSegments;h++)r=c*i+h,s=r+1,a=(u?h:r)+i,o=(u?h+1:s)+i,n[l++]=r,n[l++]=s,n[l++]=a,n[l++]=s,n[l++]=o,n[l++]=a;return n.length=l,Tb.array=n,Tb.count=n.length,Tb}},Bpe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,detail:0,corner:0,cornerSides:4},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t,height:i,depth:n,detail:r,corner:s,cornerSides:a}=e.parameters,o=r===0&&s!==0?new ZU(t*.5,s,a):new eN(t*.5,r);return o.scale(1,i/t,n/t),Object.assign(o,{userData:{...e,type:"IcosahedronGeometry"}})}},ZU=class extends mA{constructor(e=1,t=.2,i=4){let n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a="IcosahedronGeometry";super(r,s,a,e,t,i),this.type=a}static fromJSON(e){return new ZU(e.radius,e.corner,e.cornerSides)}},Npe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){var n;(((n=e.parameters)==null?void 0:n.points)??[]).forEach(r=>{Array.isArray(r)&&(r.x=r[0],r.y=r[1])});let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{points:t,segments:i,verticalSegments:n}=e.parameters,r=new Fy;r.moveTo(t[0].x,t[0].y),r.bezierCurveTo(t[1].x,t[1].y,t[2].x,t[2].y,t[3].x,t[3].y);let s=new qB(r.extractPoints(n).shape,i);return s.rotateZ(Math.PI),Object.assign(s,{userData:{...e,type:"LatheGeometry"}})}},Ta=new ke,Pb=new $t,D1=new T,fx=class extends In{constructor(){super(),this.uuid=Dt.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}applyMatrix4(e){let t=new Sn().getNormalMatrix(e);for(let i=0,n=this.vertices.length;i<n;i++)this.vertices[i].applyMatrix4(e);for(let i=0,n=this.faces.length;i<n;i++){let r=this.faces[i];r.normal.applyMatrix3(t).normalize();for(let s=0,a=r.vertexNormals.length;s<a;s++)r.vertexNormals[s].applyMatrix3(t).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}rotateX(e){return Ta.makeRotationX(e),this.applyMatrix4(Ta),this}rotateY(e){return Ta.makeRotationY(e),this.applyMatrix4(Ta),this}rotateZ(e){return Ta.makeRotationZ(e),this.applyMatrix4(Ta),this}translate(e,t,i){return Ta.makeTranslation(e,t,i),this.applyMatrix4(Ta),this}scale(e,t,i){return Ta.makeScale(e,t,i),this.applyMatrix4(Ta),this}lookAt(e){return Pb.lookAt(e),Pb.updateMatrix(),this.applyMatrix4(Pb.matrix),this}fromBufferGeometry(e){let t=this,i=e.index!==null?e.index:void 0,n=e.attributes;if(n.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;let r=n.position,s=n.normal,a=n.color,o=n.uv,l=n.uv2;l!==void 0&&(this.faceVertexUvs[1]=[]);for(let h=0;h<r.count;h++)t.vertices.push(new T().fromBufferAttribute(r,h)),a!==void 0&&t.colors.push(new ut().fromBufferAttribute(a,h));function c(h,d,p,f){let v=a===void 0?[]:[t.colors[h].clone(),t.colors[d].clone(),t.colors[p].clone()],m=s===void 0?[]:[new T().fromBufferAttribute(s,h),new T().fromBufferAttribute(s,d),new T().fromBufferAttribute(s,p)],g=new pM(h,d,p,m,v,f);t.faces.push(g),o!==void 0&&t.faceVertexUvs[0].push([new te().fromBufferAttribute(o,h),new te().fromBufferAttribute(o,d),new te().fromBufferAttribute(o,p)]),l!==void 0&&t.faceVertexUvs[1].push([new te().fromBufferAttribute(l,h),new te().fromBufferAttribute(l,d),new te().fromBufferAttribute(l,p)])}let u=e.groups;if(u.length>0)for(let h=0;h<u.length;h++){let d=u[h],p=d.start,f=d.count;for(let v=p,m=p+f;v<m;v+=3)i!==void 0?c(i.getX(v),i.getX(v+1),i.getX(v+2),d.materialIndex):c(v,v+1,v+2,d.materialIndex)}else if(i!==void 0)for(let h=0;h<i.count;h+=3)c(i.getX(h),i.getX(h+1),i.getX(h+2));else for(let h=0;h<r.count;h+=3)c(h,h+1,h+2);return this.computeFaceNormals(),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(D1).negate(),this.translate(D1.x,D1.y,D1.z),this}normalize(){this.computeBoundingSphere();let e=this.boundingSphere.center,t=this.boundingSphere.radius,i=t===0?1:1/t,n=new ke;return n.set(i,0,0,-i*e.x,0,i,0,-i*e.y,0,0,i,-i*e.z,0,0,0,1),this.applyMatrix4(n),this}computeFaceNormals(){let e=new T,t=new T;for(let i=0,n=this.faces.length;i<n;i++){let r=this.faces[i],s=this.vertices[r.a],a=this.vertices[r.b],o=this.vertices[r.c];e.subVectors(o,a),t.subVectors(s,a),e.cross(t),e.normalize(),r.normal.copy(e)}}computeVertexNormals(e=!0){let t=new Array(this.vertices.length);for(let i=0,n=this.vertices.length;i<n;i++)t[i]=new T;if(e){let i=new T,n=new T;for(let r=0,s=this.faces.length;r<s;r++){let a=this.faces[r],o=this.vertices[a.a],l=this.vertices[a.b],c=this.vertices[a.c];i.subVectors(c,l),n.subVectors(o,l),i.cross(n),t[a.a].add(i),t[a.b].add(i),t[a.c].add(i)}}else{this.computeFaceNormals();for(let i=0,n=this.faces.length;i<n;i++){let r=this.faces[i];t[r.a].add(r.normal),t[r.b].add(r.normal),t[r.c].add(r.normal)}}for(let i=0,n=this.vertices.length;i<n;i++)t[i].normalize();for(let i=0,n=this.faces.length;i<n;i++){let r=this.faces[i],s=r.vertexNormals;s.length===3?(s[0].copy(t[r.a]),s[1].copy(t[r.b]),s[2].copy(t[r.c])):(s[0]=t[r.a].clone(),s[1]=t[r.b].clone(),s[2]=t[r.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeFlatVertexNormals(){this.computeFaceNormals();for(let e=0,t=this.faces.length;e<t;e++){let i=this.faces[e],n=i.vertexNormals;n.length===3?(n[0].copy(i.normal),n[1].copy(i.normal),n[2].copy(i.normal)):(n[0]=i.normal.clone(),n[1]=i.normal.clone(),n[2]=i.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}computeMorphNormals(){for(let t=0,i=this.faces.length;t<i;t++){let n=this.faces[t];n.__originalFaceNormal?n.__originalFaceNormal.copy(n.normal):n.__originalFaceNormal=n.normal.clone(),n.__originalVertexNormals||(n.__originalVertexNormals=[]);for(let r=0,s=n.vertexNormals.length;r<s;r++)n.__originalVertexNormals[r]?n.__originalVertexNormals[r].copy(n.vertexNormals[r]):n.__originalVertexNormals[r]=n.vertexNormals[r].clone()}let e=new fx;e.faces=this.faces;for(let t=0,i=this.morphTargets.length;t<i;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];let r=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(let a=0,o=this.faces.length;a<o;a++){let l=new T,c={a:new T,b:new T,c:new T};r.push(l),s.push(c)}}let n=this.morphNormals[t];e.vertices=this.morphTargets[t].vertices,e.computeFaceNormals(),e.computeVertexNormals();for(let r=0,s=this.faces.length;r<s;r++){let a=this.faces[r],o=n.faceNormals[r],l=n.vertexNormals[r];o.copy(a.normal),l.a.copy(a.vertexNormals[0]),l.b.copy(a.vertexNormals[1]),l.c.copy(a.vertexNormals[2])}}for(let t=0,i=this.faces.length;t<i;t++){let n=this.faces[t];n.normal=n.__originalFaceNormal,n.vertexNormals=n.__originalVertexNormals}}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Vi),this.boundingBox.setFromPoints(this.vertices)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ls),this.boundingSphere.setFromPoints(this.vertices)}merge(e,t,i=0){if(!(e&&e.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);return}let n,r=this.vertices.length,s=this.vertices,a=e.vertices,o=this.faces,l=e.faces,c=this.colors,u=e.colors;t!==void 0&&(n=new Sn().getNormalMatrix(t));for(let h=0,d=a.length;h<d;h++){let p=a[h].clone();t!==void 0&&p.applyMatrix4(t),s.push(p)}for(let h=0,d=u.length;h<d;h++)c.push(u[h].clone());for(let h=0,d=l.length;h<d;h++){let p=l[h],f,v,m=p.vertexNormals,g=p.vertexColors,y=new pM(p.a+r,p.b+r,p.c+r);y.normal.copy(p.normal),n!==void 0&&y.normal.applyMatrix3(n).normalize();for(let x=0,_=m.length;x<_;x++)f=m[x].clone(),n!==void 0&&f.applyMatrix3(n).normalize(),y.vertexNormals.push(f);y.color.copy(p.color);for(let x=0,_=g.length;x<_;x++)v=g[x],y.vertexColors.push(v.clone());y.materialIndex=p.materialIndex+i,o.push(y)}for(let h=0,d=e.faceVertexUvs.length;h<d;h++){let p=e.faceVertexUvs[h];this.faceVertexUvs[h]===void 0&&(this.faceVertexUvs[h]=[]);for(let f=0,v=p.length;f<v;f++){let m=p[f],g=[];for(let y=0,x=m.length;y<x;y++)g.push(m[y].clone());this.faceVertexUvs[h].push(g)}}}mergeMesh(e){if(!(e&&e.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e);return}e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)}mergeVertices(e=4){let t={},i=[],n=[],r=Math.pow(10,e);for(let o=0,l=this.vertices.length;o<l;o++){let c=this.vertices[o],u=Math.round(c.x*r)+"_"+Math.round(c.y*r)+"_"+Math.round(c.z*r);t[u]===void 0?(t[u]=o,i.push(this.vertices[o]),n[o]=i.length-1):n[o]=n[t[u]]}let s=[];for(let o=0,l=this.faces.length;o<l;o++){let c=this.faces[o];c.a=n[c.a],c.b=n[c.b],c.c=n[c.c];let u=[c.a,c.b,c.c];for(let h=0;h<3;h++)if(u[h]===u[(h+1)%3]){s.push(o);break}}for(let o=s.length-1;o>=0;o--){let l=s[o];this.faces.splice(l,1);for(let c=0,u=this.faceVertexUvs.length;c<u;c++)this.faceVertexUvs[c].splice(l,1)}let a=this.vertices.length-i.length;return this.vertices=i,a}setFromPoints(e){this.vertices=[];for(let t=0,i=e.length;t<i;t++){let n=e[t];this.vertices.push(new T(n.x,n.y,n.z||0))}return this}sortFacesByMaterialIndex(){let e=this.faces,t=e.length;for(let o=0;o<t;o++)e[o]._id=o;function i(o,l){return o.materialIndex-l.materialIndex}e.sort(i);let n=this.faceVertexUvs[0],r=this.faceVertexUvs[1],s,a;n&&n.length===t&&(s=[]),r&&r.length===t&&(a=[]);for(let o=0;o<t;o++){let l=e[o]._id;s&&s.push(n[l]),a&&a.push(r[l])}s&&(this.faceVertexUvs[0]=s),a&&(this.faceVertexUvs[1]=a)}toJSON(){let e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),this.parameters!==void 0){let p=this.parameters;for(let f in p)p[f]!==void 0&&(e[f]=p[f]);return e}let t=[];for(let p=0;p<this.vertices.length;p++){let f=this.vertices[p];t.push(f.x,f.y,f.z)}let i=[],n=[],r={},s=[],a={},o=[],l={};for(let p=0;p<this.faces.length;p++){let f=this.faces[p],v=!0,m=!1,g=this.faceVertexUvs[0][p]!==void 0,y=f.normal.length()>0,x=f.vertexNormals.length>0,_=f.color.r!==1||f.color.g!==1||f.color.b!==1,b=f.vertexColors.length>0,w=0;if(w=c(w,0,0),w=c(w,1,v),w=c(w,2,m),w=c(w,3,g),w=c(w,4,y),w=c(w,5,x),w=c(w,6,_),w=c(w,7,b),i.push(w),i.push(f.a,f.b,f.c),i.push(f.materialIndex),g){let M=this.faceVertexUvs[0][p];i.push(d(M[0]),d(M[1]),d(M[2]))}if(y&&i.push(u(f.normal)),x){let M=f.vertexNormals;i.push(u(M[0]),u(M[1]),u(M[2]))}if(_&&i.push(h(f.color)),b){let M=f.vertexColors;i.push(h(M[0]),h(M[1]),h(M[2]))}}function c(p,f,v){return v?p|1<<f:p&~(1<<f)}function u(p){let f=p.x.toString()+p.y.toString()+p.z.toString();return r[f]!==void 0||(r[f]=n.length/3,n.push(p.x,p.y,p.z)),r[f]}function h(p){let f=p.r.toString()+p.g.toString()+p.b.toString();return a[f]!==void 0||(a[f]=s.length,s.push(p.getHex())),a[f]}function d(p){let f=p.x.toString()+p.y.toString();return l[f]!==void 0||(l[f]=o.length/2,o.push(p.x,p.y)),l[f]}return e.data={},e.data.vertices=t,e.data.normals=n,s.length>0&&(e.data.colors=s),o.length>0&&(e.data.uvs=[o]),e.data.faces=i,e}clone(){return new fx().copy(this)}copy(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;let t=e.vertices;for(let h=0,d=t.length;h<d;h++)this.vertices.push(t[h].clone());let i=e.colors;for(let h=0,d=i.length;h<d;h++)this.colors.push(i[h].clone());let n=e.faces;for(let h=0,d=n.length;h<d;h++)this.faces.push(n[h].clone());for(let h=0,d=e.faceVertexUvs.length;h<d;h++){let p=e.faceVertexUvs[h];this.faceVertexUvs[h]===void 0&&(this.faceVertexUvs[h]=[]);for(let f=0,v=p.length;f<v;f++){let m=p[f],g=[];for(let y=0,x=m.length;y<x;y++){let _=m[y];g.push(_.clone())}this.faceVertexUvs[h].push(g)}}let r=e.morphTargets;for(let h=0,d=r.length;h<d;h++){let p={};if(p.name=r[h].name,r[h].vertices!==void 0){p.vertices=[];for(let f=0,v=r[h].vertices.length;f<v;f++)p.vertices.push(r[h].vertices[f].clone())}if(r[h].normals!==void 0){p.normals=[];for(let f=0,v=r[h].normals.length;f<v;f++)p.normals.push(r[h].normals[f].clone())}this.morphTargets.push(p)}let s=e.morphNormals;for(let h=0,d=s.length;h<d;h++){let p={};if(s[h].vertexNormals!==void 0){p.vertexNormals=[];for(let f=0,v=s[h].vertexNormals.length;f<v;f++){let m=s[h].vertexNormals[f],g={};g.a=m.a.clone(),g.b=m.b.clone(),g.c=m.c.clone(),p.vertexNormals.push(g)}}if(s[h].faceNormals!==void 0){p.faceNormals=[];for(let f=0,v=s[h].faceNormals.length;f<v;f++)p.faceNormals.push(s[h].faceNormals[f].clone())}this.morphNormals.push(p)}let a=e.skinWeights;for(let h=0,d=a.length;h<d;h++)this.skinWeights.push(a[h].clone());let o=e.skinIndices;for(let h=0,d=o.length;h<d;h++)this.skinIndices.push(o[h].clone());let l=e.lineDistances;for(let h=0,d=l.length;h<d;h++)this.lineDistances.push(l[h]);let c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());let u=e.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}toBufferGeometry(){let e=new Upe().fromGeometry(this),t=new mt,i=new Float32Array(e.vertices.length*3);if(t.setAttribute("position",L1.call(new gt(i,3),e.vertices)),e.normals.length>0){let n=new Float32Array(e.normals.length*3);t.setAttribute("normal",L1.call(new gt(n,3),e.normals))}if(e.colors.length>0){let n=new Float32Array(e.colors.length*3);t.setAttribute("color",uP.call(new gt(n,3),e.colors))}if(e.uvs.length>0){let n=new Float32Array(e.uvs.length*2);t.setAttribute("uv",dP.call(new gt(n,2),e.uvs))}if(e.uvs2.length>0){let n=new Float32Array(e.uvs2.length*2);t.setAttribute("uv2",dP.call(new gt(n,2),e.uvs2))}t.groups=e.groups;for(let n in e.morphTargets){let r=[],s=e.morphTargets[n];for(let a=0,o=s.length;a<o;a++){let l=s[a],c=new et(l.data.length*3,3);c.name=l.name,r.push(L1.call(c,l.data))}t.morphAttributes[n]=r}if(e.skinIndices.length>0){let n=new et(e.skinIndices.length*4,4);t.setAttribute("skinIndex",pP.call(n,e.skinIndices))}if(e.skinWeights.length>0){let n=new et(e.skinWeights.length*4,4);t.setAttribute("skinWeight",pP.call(n,e.skinWeights))}return e.boundingSphere!==null&&(t.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(t.boundingBox=e.boundingBox.clone()),t}computeTangents(){console.error("THREE.Geometry: .computeTangents() has been removed.")}computeLineDistances(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}applyMatrix(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}dispose(){this.dispatchEvent({type:"dispose"})}static createBufferGeometryFromObject(e){let t=new mt,i=e.geometry;if(e.isPoints||e.isLine){let n=new et(i.vertices.length*3,3),r=new et(i.colors.length*3,3);if(t.setAttribute("position",L1.call(n,i.vertices)),t.setAttribute("color",uP.call(r,i.colors)),i.lineDistances&&i.lineDistances.length===i.vertices.length){let s=new et(i.lineDistances.length,1);t.setAttribute("lineDistance",Fpe.call(s,i.lineDistances))}i.boundingSphere!==null&&(t.boundingSphere=i.boundingSphere.clone()),i.boundingBox!==null&&(t.boundingBox=i.boundingBox.clone())}else e.isMesh&&(t=i.toBufferGeometry());return t}};fx.prototype.isGeometry=!0;var Upe=class{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(e){let t=[],i,n,r,s=e.faces;for(n=0;n<s.length;n++){let a=s[n];a.materialIndex!==r&&(r=a.materialIndex,i!==void 0&&(i.count=n*3-i.start,t.push(i)),i={start:n*3,materialIndex:r})}i!==void 0&&(i.count=n*3-i.start,t.push(i)),this.groups=t}fromGeometry(e){let t=e.faces,i=e.vertices,n=e.faceVertexUvs,r=n[0]&&n[0].length>0,s=n[1]&&n[1].length>0,a=e.morphTargets,o=a.length,l;if(o>0){l=[];for(let m=0;m<o;m++)l[m]={name:a[m].name,data:[]};this.morphTargets.position=l}let c=e.morphNormals,u=c.length,h;if(u>0){h=[];for(let m=0;m<u;m++)h[m]={name:c[m].name,data:[]};this.morphTargets.normal=h}let d=e.skinIndices,p=e.skinWeights,f=d.length===i.length,v=p.length===i.length;i.length>0&&t.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let m=0;m<t.length;m++){let g=t[m];this.vertices.push(i[g.a],i[g.b],i[g.c]);let y=g.vertexNormals;if(y.length===3)this.normals.push(y[0],y[1],y[2]);else{let _=g.normal;this.normals.push(_,_,_)}let x=g.vertexColors;if(x.length===3)this.colors.push(x[0],x[1],x[2]);else{let _=g.color;this.colors.push(_,_,_)}if(r===!0){let _=n[0][m];_!==void 0?this.uvs.push(_[0],_[1],_[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",m),this.uvs.push(new te,new te,new te))}if(s===!0){let _=n[1][m];_!==void 0?this.uvs2.push(_[0],_[1],_[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",m),this.uvs2.push(new te,new te,new te))}for(let _=0;_<o;_++){let b=a[_].vertices;l[_].data.push(b[g.a],b[g.b],b[g.c])}for(let _=0;_<u;_++){let b=c[_].vertexNormals[m];h[_].data.push(b.a,b.b,b.c)}f&&this.skinIndices.push(d[g.a],d[g.b],d[g.c]),v&&this.skinWeights.push(p[g.a],p[g.b],p[g.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this}},pM=class{constructor(e,t,i,n,r,s=0){this.a=e,this.b=t,this.c=i,this.normal=n&&n.isVector3?n:new T,this.vertexNormals=Array.isArray(n)?n:[],this.color=r&&r.isColor?r:new ut,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=s}clone(){return new this.constructor().copy(this)}copy(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(let t=0,i=e.vertexNormals.length;t<i;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(let t=0,i=e.vertexColors.length;t<i;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}};function Fpe(e){return this.array.set(e),this}function uP(e){let t=this.array,i=0;for(let n=0,r=e.length;n<r;n++){let s=e[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),s=new ut),t[i++]=s.r,t[i++]=s.g,t[i++]=s.b}return this}function dP(e){let t=this.array,i=0;for(let n=0,r=e.length;n<r;n++){let s=e[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),s=new te),t[i++]=s.x,t[i++]=s.y}return this}function L1(e){let t=this.array,i=0;for(let n=0,r=e.length;n<r;n++){let s=e[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),s=new T),t[i++]=s.x,t[i++]=s.y,t[i++]=s.z}return this}function pP(e){let t=this.array,i=0;for(let n=0,r=e.length;n<r;n++){let s=e[n];s===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),s=new Ct),t[i++]=s.x,t[i++]=s.y,t[i++]=s.z,t[i++]=s.w}return this}var zpe=["a","b","c"];function kpe(e,t){switch(t){case"c":return e.c;case"b":return e.b;case"a":default:return e.a}}function Db(e,t,i){let n=Math.min(e,t),r=Math.max(e,t),s=n+"_"+r;return i.get(s)}function Lb(e,t,i,n,r,s){let a=Math.min(e,t),o=Math.max(e,t),l=a+"_"+o,c;if(n.has(l))c=n.get(l);else{let u=i[a],h=i[o];c={a:u,b:h,newEdge:null,faces:[]},n.set(l,c)}c.faces.push(r),s[e].edges.push(c),s[t].edges.push(c)}function Vpe(e,t,i,n){let r,s,a;for(r=0,s=e.length;r<s;r++)i[r]={edges:[]};for(r=0,s=t.length;r<s;r++)a=t[r],Lb(a.a,a.b,e,n,a,i),Lb(a.b,a.c,e,n,a,i),Lb(a.c,a.a,e,n,a,i)}function R1(e,t,i,n,r){e.push(new pM(t,i,n,void 0,void 0,r))}function Lu(e,t){return Math.abs(t-e)/2+Math.min(e,t)}function I1(e,t,i,n){e.push([t.clone(),i.clone(),n.clone()])}var Hpe=class{constructor(e=1){this.subdivisions=e}modify(e){e instanceof mt?e=new fx().fromBufferGeometry(e):e=e.clone(),e.mergeVertices();let t=this.subdivisions;for(;t-- >0;)this._smooth(e);return e.computeFaceNormals(),e.computeVertexNormals(),e}_smooth(e){let t=new T,i,n,r,s,a,o=e.vertices,l=e.faces,c=e.faceVertexUvs[0],u=c!==void 0&&c.length>0,h=[],d=new Map;Vpe(o,l,h,d);let p=[],f,v,m,g,y,x,_;for(let se of Array.from(d.keys())){for(v=d.get(se),m=new T,y=3/8,x=1/8,_=v.faces.length,_!=2&&(y=.5,x=0,_!=1),m.addVectors(v.a,v.b).multiplyScalar(y),t.set(0,0,0),s=0;s<_;s++){for(g=v.faces[s],a=0;a<3&&(f=o[kpe(g,zpe[a])],!(f!==v.a&&f!==v.b));a++);f&&t.add(f)}t.multiplyScalar(x),m.add(t),v.newEdge=p.length,p.push(m)}let b,w,M,S,C,E,P,I=[];for(n=0,r=o.length;n<r;n++){for(E=o[n],C=h[n].edges,i=C.length,i==3?b=3/16:i>3&&(b=3/(8*i)),w=1-i*Number(b),M=b,i<=2&&(i==2?(w=3/4,M=1/8):i==1||i==0),P=E.clone().multiplyScalar(w),t.set(0,0,0),s=0;s<i;s++)S=C[s],f=S.a!==E?S.a:S.b,t.add(f);t.multiplyScalar(Number(M)),P.add(t),I.push(P)}let D=I.concat(p),L=I.length,B,j,z,O=[],H=[],k,N,F,Q,G=new te,K=new te,W=new te;for(n=0,r=l.length;n<r;n++)g=l[n],B=Number(Db(g.a,g.b,d).newEdge)+L,j=Number(Db(g.b,g.c,d).newEdge)+L,z=Number(Db(g.c,g.a,d).newEdge)+L,R1(O,B,j,z,g.materialIndex),R1(O,g.a,B,z,g.materialIndex),R1(O,g.b,j,B,g.materialIndex),R1(O,g.c,z,j,g.materialIndex),u&&(k=c[n],N=k[0],F=k[1],Q=k[2],G.set(Lu(N.x,F.x),Lu(N.y,F.y)),K.set(Lu(F.x,Q.x),Lu(F.y,Q.y)),W.set(Lu(N.x,Q.x),Lu(N.y,Q.y)),I1(H,G,K,W),I1(H,N,G,W),I1(H,F,K,G),I1(H,Q,W,K));e.vertices=D,e.faces=O,u&&(e.faceVertexUvs[0]=H)}},Ji=new T,Gpe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=e.geometry??(t==null?void 0:t.geometry)??new mt().copy(new ro(100,100,100)),n;t===void 0?(i.computeBoundingBox(),i.boundingBox.getSize(Ji),n={width:Ji.x,height:Ji.y,depth:Ji.z,subdivisions:0}):n=t.parameters;let r={...n,...e.parameters};return{parameters:{width:Math.abs(r.width),height:Math.abs(r.height),depth:Math.abs(r.depth),subdivisions:Math.abs(r.subdivisions)},geometry:i}}static build(e){let{width:t,height:i,depth:n,subdivisions:r}=e.parameters,s=e.geometry??new mt().copy(new ro(100,100,100)),a=s.userData.parameters;a===void 0?(s.computeBoundingBox(),s.boundingBox.getSize(Ji)):Ji.set(a.width,a.height,a.depth),(t!==Ji.x||i!==Ji.y||n!==Ji.z)&&s.scale(Ji.x===0?1:t/Ji.x,Ji.y===0?1:i/Ji.y,Ji.z===0?1:n/Ji.z);let o=s.originalGeometry;try{r>0?(o===void 0||(a==null?void 0:a.subdivisions)!==r)&&(o===void 0&&(o=s),s=new Hpe(r).modify(o).toBufferGeometry()):(o!==void 0&&(s=o),o=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals())}catch{o!==void 0&&(s=o),o=void 0,s.getAttribute("normal")===void 0&&s.computeVertexNormals()}return o!==void 0&&Object.assign(s,{originalGeometry:o}),delete e.geometry,Object.assign(s,{userData:{...e,type:"NonParametricGeometry"}})}static loadFromUrl(e,t,i){new oN(i).load(e,n=>{let r=this.normalizeInputs({geometry:n});n.boundingBox.getSize(Ji);let s=100/Ji.x;Object.assign(r.parameters,{width:100,height:Ji.y*s,depth:Ji.z*s}),t(this.build(r))})}},QU=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters);return{shape:e.shape&&e.shape instanceof Di?e.shape:new Di,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(e){let{width:t,height:i,spikes:n,cornerRadius:r,depth:s,extrudeBevelSize:a,extrudeBevelSegments:o}=e.parameters,l=e.shape,c=t*.5,u=i*.5,h=0,d=0,p=2*Math.PI/n;for(let v=0;v<n;v++){let m=p*v,g=h+Math.sin(m)*c,y=d+Math.cos(m)*u;l.addPoint(l.createPoint(g,y))}l.isClosed=!0;for(let v=0,m=l.points.length;v<m;v++)l.points[v].roundness=r;l.roundness=r,l.update();let f=au.create({shape:l,parameters:{roundness:r,depth:s,extrudeBevelSize:a,extrudeBevelSegments:o}});return Object.assign(f,{userData:{...e,type:"PolygonGeometry"}})}},jpe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t,height:i,depth:n,radialSegments:r,heightSegments:s,openEnded:a,cornerRadius:o,cornerSegments:l}=e.parameters,c=new Xpe(t*.5,i,r,s,a,o,l);return c.scale(1,1,n/t),Object.assign(c,{userData:{...e,type:"PyramidGeometry"}})}};function Vf(e,t,i){i.x=e.x*t.x,i.y=e.y,i.z=e.x*t.y}function Rb(e,t,i,n,r,s){let a=t.clone().sub(e),o=i.clone().sub(e),l=a.angleTo(o);if(a.normalize(),o.normalize(),n===r){let c=a.add(o).normalize();s.copy(e).addScaledVector(c,n/Math.sin(l/2))}else{let c=a.angleTo(o);s.copy(e),s.addScaledVector(a,r/Math.sin(c)),s.addScaledVector(o,n/Math.sin(c))}}function Wpe(e,t,i){let n=e.clone().sub(t),r=i.clone().sub(t);return n.projectOnVector(r),n.add(t)}var Xpe=class extends mt{constructor(e=.5,t=1,i=4,n=1,r=!1,s=0,a=4){super(),i=Math.floor(Math.max(3,i)),n=Math.floor(n),a=Math.floor(a);let o=[],l=[],c=[],u=[],h=0,d=t/2,p=Math.PI/i,f=e*Math.cos(Math.PI/i),v=2*Math.PI/i,m=(i-2)*Math.PI/i,g=Math.PI-m,y=new T(0,-d,0),x=new T(0,d,0),_=new te(e,-d),b=new te(f,-d),w=new te(0,x.y).sub(b),M=new te(0,x.y).sub(_),S=new te(w.y,-w.x).normalize(),C=new te(M.y,-M.x).normalize(),E=e*Math.cos(Math.PI/i)*Math.tan((Math.PI-w.angle())/2)-1e-8;s=Math.min(s,E);let P;{let z=new T(S.x,S.y,0),O=new T(Math.cos(v)*z.x,z.y,Math.sin(v)*z.x);P=z.angleTo(O)}let I=s/Math.tan((Math.PI-w.angle())/2),D=s/Math.tan((Math.PI-P)/2),L=new T;if(!r){l.push(y.x,y.y,y.z),c.push(0,-1,0),u.push(0,0);let z=h++,O=[],H=_.clone(),k=I/Math.cos(Math.PI/i);H.x-=k;for(let N=0;N<i;N++){let F=N/i*Math.PI*2+p,Q=new te(Math.sin(F),Math.cos(F));Vf(H,Q,L),l.push(L.x,L.y,L.z),c.push(0,-1,0),u.push(0,0),O.push(h++)}for(let N=0;N<O.length;N++)o.push(O[N],z,O[(N+1)%O.length])}{let z=new T,O=new T,H=new T,k=new T,N=new T,F=new T;for(let Q=0;Q<i;Q++){let G=Q/i*Math.PI*2+p,K=(Q+.5)/i*Math.PI*2+p,W=(Q+1)/i*Math.PI*2+p,se=new te(Math.sin(G),Math.cos(G)),ie=new te(Math.sin(K),Math.cos(K)),re=new te(Math.sin(W),Math.cos(W));Vf(_,se,O),Vf(_,re,H),Vf(S,ie,z),Rb(x,O,H,D,D,k),l.push(k.x,k.y,k.z),Rb(O,x,H,D,I,N),l.push(N.x,N.y,N.z),Rb(H,O,x,I,D,F),l.push(F.x,F.y,F.z),c.push(z.x,z.y,z.z),c.push(z.x,z.y,z.z),c.push(z.x,z.y,z.z),u.push(0,0),u.push(0,0),u.push(0,0);let de=h++,he=h++,X=h++;if(o.push(de,he,X),s>0){{let Me=O.clone().add(H).multiplyScalar(.5),Ne=x.clone().sub(Me).normalize(),He=y.clone().sub(Me).normalize().add(Ne).normalize().multiplyScalar(-1),Pe=F.clone().sub(N);B(Me,Pe,He,w.angle())}let Ee,Oe;{let Me=new T;Vf(C,re,Me);let Ne=F.clone().add(k).multiplyScalar(.5);Ne=Wpe(Ne,H,x);let He=F.clone().sub(k);[Ee,Oe]=B(Ne,He,Me,P,k.y)}{let Me=Ee,Ne=Me.clone().setY(0).normalize(),He=new T(0,-1,0),Pe=Ne.clone().cross(He);j(Me,Ne,He,Pe)}{let Me=w.angle(),Ne=Math.PI-Me,He=x.clone();He.y-=s/Math.sin(Me-Math.PI/2);let Pe=new T,Ce=[];for(let qe=0;qe<a;qe++){let q=[],A=Math.PI/2-Ne*qe/a,R=Math.cos(A),$=Math.sin(A),le=K;for(let ue=0;ue<=qe;ue++){let we=Math.cos(le),De=Math.sin(le);z.x=R*De,z.y=$,z.z=R*we,Pe.copy(He).addScaledVector(z,s),l.push(Pe.x,Pe.y,Pe.z),c.push(z.x,z.y,z.z),u.push(0,0),q.push(h++),le+=Math.PI*2/qe/i}Ce.push(q)}Oe.reverse(),Ce.push(Oe);let je=Ce.length-1;for(let qe=0;qe<je;qe++){let q=Ce[qe],A=Ce[qe+1],R=q.length-1;o.push(A[1],q[0],A[0]);for(let $=1;$<=R;$++)o.push(q[$],q[$-1],A[$]),o.push(A[$+1],q[$],A[$])}}}}}this.setIndex(o),this.setAttribute("position",new et(l,3)),this.setAttribute("normal",new et(c,3)),this.setAttribute("uv",new et(u,2));function B(z,O,H,k,N){let F=-k/2,Q=(Math.PI-k)/2,G=O.clone().normalize().cross(H);z.addScaledVector(H,-s/Math.sin(Q));let K=new T,W=new T,se=1,ie=h,re=[];for(let de=0;de<=a;de++){let he=F+de/a*k;W.set(0,0,0),W.addScaledVector(G,Math.sin(he)),W.addScaledVector(H,Math.cos(he));for(let X=0;X<=se;X++){let Ee=X/se-.5;if(K.copy(z),K.addScaledVector(O,Ee),K.addScaledVector(W,s),N!=null){let Oe=Math.max(0,K.y-N);K.addScaledVector(O,-Oe/O.y)}l.push(K.x,K.y,K.z),c.push(W.x,W.y,W.z),u.push(0,0),X===0&&re.push(h),h++}}for(let de=0;de<a;de++)for(let he=0;he<se;he++){let X=ie+he+(se+1)*de,Ee=X+(se+1),Oe=Ee+1,Me=X+1;o.push(X,Ee,Me),o.push(Ee,Oe,Me)}return[z.clone().addScaledVector(O,.5),re]}function j(z,O,H,k){let N=Math.PI/2,F=M.angle()-N,Q=[],G=new T,K=new T;for(let se=0;se<=a;se++){let ie=[],re=se/a;for(let de=0;de<=se;de++){let he=((se?de/se:0)-.5)*g,X=Math.cos(he),Ee=Math.sin(he),Oe=Math.atan(Math.tan(F)*X),Me=(N+Oe)*re,Ne=Math.cos(Me),He=Math.sin(Me);G.set(0,0,0),G.addScaledVector(O,He*X),G.addScaledVector(H,Ne),G.addScaledVector(k,He*Ee),K.copy(z).addScaledVector(G,s),l.push(K.x,K.y,K.z),c.push(G.x,G.y,G.z),u.push(0,0),ie.push(h++)}Q.push(ie)}let W=Q.length-1;for(let se=0;se<W;se++){let ie=Q[se],re=Q[se+1],de=ie.length-1;o.push(ie[0],re[1],re[0]);for(let he=1;he<=de;he++)o.push(ie[he-1],ie[he],re[he]),o.push(ie[he],re[he+1],re[he])}}}},KU=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters),n=Object.assign((t==null?void 0:t.ui)??{enabledIndieCorners:!1},e.ui);return{shape:e.shape&&e.shape instanceof Di?e.shape:new Di,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)}),ui:n}}static build(e){let t=e.shape,{width:i,height:n,cornerRadius:r,cornerType:s,depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}=e.parameters,c={x:i*.5,y:n*.5},u={x:-c.x,y:-c.y},h={x:c.x,y:c.y};function d(_,b,w){return b>i&&w>n?Math.min(_*i/b,_*n/w):b>i?_*i/b:w>n?_*n/w:_}let p=[];p[0]=r[0]===0?0:d(r[0],r[0]+r[3],r[0]+r[1]),p[1]=r[1]===0?0:d(r[1],r[1]+r[2],r[1]+r[0]),p[2]=r[2]===0?0:d(r[2],r[2]+r[1],r[2]+r[3]),p[3]=r[3]===0?0:d(r[3],r[3]+r[0],r[3]+r[2]);let f=u.x,v=h.x,m=h.y,g=u.y;t.addPoint(t.createPoint(f,m)),t.addPoint(t.createPoint(v,m)),t.addPoint(t.createPoint(v,g)),t.addPoint(t.createPoint(f,g)),t.isClosed=!0;let y=!0;for(let _=0,b=t.points.length;_<b;_++)t.points[_].roundness=p[_],_>0&&p[_]!==p[_-1]&&(y=!1);y&&(t.roundness=p[0]),t.useCubicForRoundedCorners=s!==1,t.update();let x=au.create({shape:t,parameters:{depth:a,extrudeBevelSize:o,extrudeBevelSegments:l}});return Object.assign(x,{userData:{...e,type:"RectangleGeometry"}})}},qpe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t=100,height:i=t,depth:n=t,widthSegments:r=64,heightSegments:s=64,phiStart:a,phiLength:o,thetaStart:l,thetaLength:c}=e.parameters,u=new RE(.5*t,r,s,a,o,l,c);return u.scale(1,i/t,n/t),Object.assign(u,{userData:{...e,type:"SphereGeometry"}})}},Ype=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,widthSegments:8,heightSegments:8},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:0})}}static build(e){let{width:t=100,height:i=t,widthSegments:n=8,heightSegments:r=8}=e.parameters,s=new r2(t,i,n,r);return s.scale(1,1,1),Object.assign(s,{userData:{...e,type:"PlaneGeometry"}})}},Zpe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,angle:90,cornerRadius:24,cornerSegments:8},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width)})}}static build(e){let{width:t,height:i,depth:n,angle:r,cornerRadius:s,cornerSegments:a}=e.parameters,o=new Qpe(t,i,n,r,s,a);return Object.assign(o,{userData:{...e,type:"BackdropGeometry"}})}},Qpe=class extends mt{constructor(e=1,t=1,i=1,n=90,r=10,s=24){super(),this.type="BackdropGeometry";let a=[],o=[],l=[],c=.001;r==0&&(s=1),s=Math.max(1,Math.floor(s)),r=Math.min(r,100),n=Math.min(180-c,n),n*=Math.PI/180;let u=[],h=Math.PI/2,d=(se=0,ie=0,re=0)=>new T(se,ie,re),p=d(),f=d(),[v,m,g]=[t/2,e/2,i/2],y=-m,x=+m,[_,b,w]=[d(y,-v,+g),d(y,-v,-g),d(y,+v,-g)],M=(se,ie=!1)=>Math.sin(se-Math.PI/(1+ +ie)),S=(se,ie=!1)=>Math.cos(se-Math.PI/(1+ +ie));w.y=Math.sin(n)*t-v;let C=Math.cos(n)*t-g,E=_.z-c;n<=h?(w.z=Math.min(C,E),w.z==E&&(w.y-=(C-E)/Math.tan(h-n))):b.z=Math.min(b.z-C-g,_.z-c),p.subVectors(_,b),f.subVectors(w,b);let P=Math.min(p.length(),f.length())*r/100,I=P*Math.tan(n/2),D=P/Math.cos(n/2),L=p.clone().normalize().add(f.normalize()).setLength(D).add(b);p.set(0,M(n,!0),S(n,!0)),u.push([w,p.clone()]);let B=(Math.PI-n)/s;for(let se=0;se<=s;se++){let ie=h+n+se*B;p.set(0,Math.sin(ie)*I,Math.cos(ie)*I),p.add(L),f.set(0,M(ie),S(ie)),u.push([p.clone(),f.clone()])}u.push([_,d(0,1,0)]);let j=Math.sin(B/2)*I*2,z=u.length-1,O=u[0][0].distanceTo(u[1][0]),H=u[z-1][0].distanceTo(u[z][0]),k=O+j*s+H;u[0].push(1);for(let se=0;se<=s;se++)u[se+1].push(1-(O+se*j)/k);u[z].push(0);let[N,F,Q]=u[0],G,K,W;for(let se=1;se<u.length;se++)[G,K,W]=u[se],a.push(y,N.y,N.z,y,G.y,G.z,x,N.y,N.z,x,N.y,N.z,y,G.y,G.z,x,G.y,G.z),o.push(0,F.y,F.z,0,K.y,K.z,0,F.y,F.z,0,F.y,F.z,0,K.y,K.z,0,K.y,K.z),l.push(0,Q,0,W,1,Q,1,Q,0,W,1,W),[N,F,Q]=[G,K,W];this.setAttribute("position",new et(a,3)),this.setAttribute("normal",new et(o,3)),this.setAttribute("uv",new et(l,2))}},$U=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return{shape:e.shape&&e.shape instanceof Di?e.shape:new Di,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(e){let{width:t,height:i,innerRadiusPercent:n,spikes:r,cornerRadius:s,angle:a,depth:o,extrudeBevelSize:l,extrudeBevelSegments:c}=e.parameters,u=e.shape,h=t*.5,d=i*.5,p=0,f=0,v=a*Math.PI/360/r,m=Math.PI/2*3*-1,g=h*n/100,y=d*n/100;if(r===3&&n===50){v=2*Math.PI/r;for(let _=0;_<r;_++){let b=v*_,w=p+Math.sin(b)*h,M=f+Math.cos(b)*d;u.addPoint(u.createPoint(w,M))}}else for(let _=0;_<r;_++){let b=p+Math.cos(m)*h,w=f+Math.sin(m)*d;u.addPoint(u.createPoint(b,w)),m+=v,b=p+Math.cos(m)*g,w=f+Math.sin(m)*y,u.addPoint(u.createPoint(b,w)),m+=v}u.isClosed=!0;for(let _=0,b=u.points.length;_<b;_++)u.points[_].roundness=s;u.roundness=s,u.update();let x=au.create({shape:u,parameters:{roundness:s,depth:o,extrudeBevelSize:l,extrudeBevelSegments:c}});return Object.assign(x,{userData:{...e,type:"StarGeometry"}})}},Kpe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??0)})}}static build(e){let{width:t,height:i}=e.parameters,n=new r2(t,i);return Object.assign(n,{userData:{...e,type:"TextFrameGeometry"}})}},$pe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,radialSegments:32,tubularSegments:64,arc:Math.PI*2,cornerRadius:30,cornerSegments:8},e.parameters),n=Math.abs(i.width),r=Math.abs(i.height??i.width),s=Math.round(Math.abs(i.depth??i.width*.25));return{parameters:Object.assign(i,{width:n,height:r,depth:s})}}static build(e){let{width:t,height:i,depth:n,radialSegments:r,tubularSegments:s,arc:a,cornerRadius:o,cornerSegments:l}=e.parameters,c=Jpe(t,i,n,t*.5,a,s,0,0,r,o,l);return c.scale(1,i/t,1),Object.assign(c,{userData:{...e,type:"TorusGeometry"}})}};function Jpe(e,t,i,n,r,s,a,o,l,c,u){return[t,i]=[i,t],a=t/2,r/=2*Math.PI,r==1&&(c=0),new YU(!0,e,t,i,n,r,s,a,o,l,c,u)}var efe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,tubularSegments:64,radialSegments:32,p:2,q:3},e.parameters);return{parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width),depth:Math.abs(i.depth??i.width),tube:i.tube??i.width*.125})}}static build(e){let{width:t,tube:i,tubularSegments:n,radialSegments:r,p:s,q:a}=e.parameters,o=t*.5;o!==i&&(o-=i);let l=new tN(o,i,n,r,s,a);return Object.assign(l,{userData:{...e,type:"TorusKnotGeometry"}})}},tfe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,depth:0,spikes:5,cornerRadius:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},e.parameters);return{shape:e.shape&&e.shape instanceof Di?e.shape:new Di,parameters:Object.assign(i,{width:Math.abs(i.width),height:Math.abs(i.height??i.width*(i.isRect?1:Math.sqrt(3)/2)),depth:Math.abs(i.depth??0)})}}static build(e){let{width:t=100,height:i,cornerRadius:n,depth:r,extrudeBevelSize:s,extrudeBevelSegments:a,isRect:o}=e.parameters,l=e.shape,c=t*.5,u=i*.5;o?(l.addPoint(l.createPoint(-c,u)),l.addPoint(l.createPoint(c,-u)),l.addPoint(l.createPoint(-c,-u))):(l.addPoint(l.createPoint(0,u)),l.addPoint(l.createPoint(c,-u)),l.addPoint(l.createPoint(-c,-u))),l.isClosed=!0;for(let d=0,p=l.points.length;d<p;d++)l.points[d].roundness=n;l.roundness=n,l.update();let h=au.create({shape:l,parameters:{roundness:n,depth:r,extrudeBevelSize:s,extrudeBevelSegments:a}});return Object.assign(h,{userData:{...e,type:"TriangleGeometry"}})}};function ife(e,t){let i=2*Math.PI;return(e%i+i)%i===(t%i+i)%i}var nfe=new ke,rfe=new ke;function sfe(e,t,i){let n=[new T,new T,new T],r=[new T,new T,new T];return e.extractBasis(n[0],n[1],n[2]),t.extractBasis(r[0],r[1],r[2]),n.forEach((s,a)=>{let o=r[a],l=Dt.lerp(s.length(),o.length(),i);s.lerp(o,i).setLength(l)}),new ke().makeBasis(n[0],n[1],n[2])}var afe=class{static create(e){return this.build(this.normalizeInputs(e))}static normalizeInputs(e,t){let i=Object.assign({},(t==null?void 0:t.parameters)??{width:100,height:100,depth:1,subdivisions:12,roundness:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters),n=Math.abs(i.width),r=Math.abs(i.height??i.width),s=Math.abs(i.depth??0),a=(t==null?void 0:t.shapeData)??_A.create({parameters:MU}).userData.shape;return{path:e.path??rx.defaultData(),parameters:Object.assign(i,{width:n,height:r,depth:s,extrusion:{...CU,...i.extrusion}}),shapeData:a}}static build(e){if(e.path.points.length>=2){let t=new ofe(e);return Object.assign(t,{userData:{...e,type:"PathGeometry"}})}else return Object.assign(new mt,{userData:{...e,type:"PathGeometry"}})}},ofe=class extends mt{constructor(e){super(),this.type="PathExtrusionGeometry",this.inputs=e,this.build()}_isGeometryClosed(){return this.inputs.path.isClosed&&this.inputs.parameters.extrusion.depth===1}_isOpenEnded(){let e=this.inputs.parameters.extrusion;return!(this.inputs.path.isClosed&&e.depth===1)||!ife(e.twist,0)||e.startScale!==e.endScale}build(){let e=this._extractPathPoints();if(e.length<2)return;let t=this._computeBasisMatrices(e),{depth:i,offset:n}=this.inputs.parameters.extrusion,r=this.inputs.path.isClosed?e.length:e.length-1,s=Math.floor(n*r),a=this.inputs.path.isClosed?Math.ceil((i+n)*r):Math.ceil(Math.min(1,i+n)*r),o=Math.min(Math.max(2,a-s+1),r+2),l=[],c=[];for(let z=0;z<o;z++){let O=this.inputs.path.isClosed?(z+s)%e.length:Math.min(z+s,e.length-1);l.push(e[O].clone()),c.push(t[O].clone())}let u=(z,O,H)=>{l[z]=l[z].clone().lerp(l[O],H),c[z]=sfe(c[z],c[O],H)},h=0,d=n*r%1;(!this.inputs.path.isClosed||i<=1)&&(d||n===0)&&(h=d,u(0,1,h));let p=0,f=(n+i)*r%1;if((this.inputs.path.isClosed&&i<=1||!this.inputs.path.isClosed&&n+i<1)&&f&&(p=f,u(l.length-1,l.length-2,1-p)),i===0){let z=l.length-1;l[z].copy(l[0]),c[z].copy(c[0])}this._applyPathModifiers(c,h,p);let{bevel:v,bevelSides:m}=this.inputs.parameters.extrusion,g=v>0?this.inputs.parameters.extrusion.capType:"flat",y=5;this.inputs.parameters.extrusion.shape.type==="Custom"&&(y=this.inputs.parameters.extrusion.shape.shapeQuality==="low"?5:12);let{regions:x,infos:_,vertices:b}=this._computeShapePoints(y),w=0,M;g==="round"&&(M=new xA(this.inputs.shapeData,2*v,v,y,m,void 0,!0),w=M.getAttribute("position").count);let S=0,C=0;_.sort((z,O)=>z.start-O.start),_.forEach(z=>{z.verticesStart=S,z.verticesCount=z.continuous.reduce((O,H,k)=>O+(k===0||!H?2:1),0),C+=z.verticesCount,S=C});let E=C*o,P,I=0;if(this._isOpenEnded()&&g==="flat"){try{P=ic({windingRule:Zt.ODD,elementType:Zi.POLYGONS,polySize:3,vertexSize:2,strict:!0,contours:x})}catch{P=VU}I=P.vertexCount}let D=E+2*I+w*2,L=E+2*I,B={positions:new Float32Array(D*3),normals:new Float32Array(D*3),uvs:new Float32Array(D*2)},j=[];if(_.forEach(z=>{this._extrudeRegion(z,b,c,l,B,j,this._isGeometryClosed()&&!this._isOpenEnded())}),P&&(this._closeEnd(P,E,j,B,c[0],l[0],!1),this._closeEnd(P,E+I,j,B,c[c.length-1],l[l.length-1],!0)),M){B.positions.set(M.getAttribute("position").array,L*3),B.normals.set(M.getAttribute("normal").array,L*3),B.uvs.set(M.getAttribute("uv").array,L*2);let z=j.length;j.push(...M.getIndex().array.map(k=>k+L)),L+=w,B.positions.set(M.getAttribute("position").array,L*3),B.normals.set(M.getAttribute("normal").array,L*3),B.uvs.set(M.getAttribute("uv").array,L*2);let O=j.length;j.push(...M.getIndex().array.map(k=>k+L)),this.setAttribute("position",new gt(B.positions,3)),this.setAttribute("normal",new gt(B.normals,3)),this.setAttribute("uv",new gt(B.uvs,2)),this.setIndex(j);let H=nfe;H.copy(c[c.length-1]).setPosition(l[l.length-1]),this.applyMatrix4OnRange(H,L,D),H.copy(c[0]).setPosition(l[0]).multiply(rfe.makeScale(1,1,-1)),this.applyMatrix4OnRange(H,L-w,L),this.reverseIndicesOnRange(z,O)}else this.setAttribute("position",new gt(B.positions,3)),this.setAttribute("normal",new gt(B.normals,3)),this.setAttribute("uv",new gt(B.uvs,2)),this.setIndex(j)}_extractPathPoints(){let e=RU(this.inputs.path).getPoints(this.inputs.path.subdivisions);if(e.length<2)return[];let t=[e[0]];return e.forEach(i=>{t[t.length-1].distanceToSquared(i)>.001&&t.push(i)}),this.inputs.path.isClosed&&t[t.length-1].distanceTo(t[0])<.001&&t.pop(),t}_computeBasisMatrices(e){let t=[],i=e.length,n=this.inputs.path.isClosed,r=new T,s=new T,a=new T,o=new T,l=new T(0,1,0);for(let f=0;f<i;f++){let v=e[f],m;f===0?m=n?e[e.length-2]:v.clone().multiplyScalar(2).sub(e[1]):m=e[f-1];let g;f===i-1?g=n?e[1]:v.clone().multiplyScalar(2).sub(e[f-1]):g=e[f+1];let y=v.clone().sub(m).normalize(),x=g.clone().sub(v).normalize(),_=y.clone().add(x).normalize();a.copy(_),f===0&&(_.equals(l)||_.clone().negate().equals(l))&&l.set(0,0,1);let b=l.clone().cross(_).normalize(),w=_.clone().cross(b).normalize();l.copy(w),o.copy(b),f===0&&(r.copy(w),s.copy(_));let M=new ke().makeBasis(b,w,_);t.push(M)}let c=n?s:a,u=n?r:new T(0,1,0),h=c.clone().cross(o).normalize(),d=Math.acos(u.dot(h));if(isNaN(d))return t;let p=u.clone().cross(h);c.dot(p)>0&&(d*=-1);for(let f=1;f<t.length;f++){let v=new ke().makeRotationZ(d*f/t.length);t[f].multiply(v)}return t}_applyPathModifiers(e,t,i){let n=e.length,{angle:r,twist:s,startScale:a,endScale:o}=this.inputs.parameters.extrusion,l=new ke,c=new ke;return e.forEach((u,h)=>{let d=h===0?0:h===n-1?1:(h-t)/(n-(i===0?0:1)-(t+(1-i)));l.makeRotationZ(Dt.lerp(r,r+s,d));let p=Dt.lerp(a,o,d);c.makeScale(p,p,p),u.multiply(l).multiply(c)}),e}_computeShapePoints(e=12,t=Zt.ODD){let i=this.inputs.shapeData,n=i.extractShapePointsToFlatArray([],e),r=i.shapeHoles.map(c=>{let u=c.extractShapePointsToFlatArray([],e),h=[];for(let d=u.length-1;d>=1;d-=2){let p=u[d-1],f=u[d-0];h.push(p,f)}return h}),s;try{s=ic({windingRule:t,elementType:Zi.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[n]})}catch{s=yA}let a;try{a=ic({windingRule:Zt.ODD,elementType:Zi.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[...r]})}catch{a=kU}if(!s)throw new Error("error generating geometry");let o=s.elementCount;if(a){s.elementCount+=a.elementCount;for(let c=0;c<a.elements.length;c++){let u=a.elements[c],h=c%2===0?s.vertexCount:0;s.elements.push(u+h)}for(let c=0;c<a.vertexIndices.length;c++){let u=a.vertexIndices[c],h=s.vertexCount;s.vertexIndices.push(u+h)}for(let c=0;c<a.vertices.length;c++){let u=a.vertices[c];s.vertices.push(u)}}for(let c=0,u=s.vertexCount;c<u;c++){let h=c*2;s.vertices[h+0],s.vertices[h+1]}let l=[];for(let c=s.elementCount-1;c>=0;c--){let u=c>=o,h=c*2,d=s.elements[h+0],p=s.elements[h+1],f=d+p,v={start:d,count:p,normals:[],isHole:u,continuous:[],verticesStart:0,verticesCount:0};l.push(v);let m=d,g=f-1,y=d+1,x=i.roundedCurves.length;do{let _=m-d;s.vertices[g*2+0],s.vertices[g*2+1];let b=s.vertices[m*2+0],w=s.vertices[m*2+1],M=s.vertices[y*2+0],S=s.vertices[y*2+1],C=b-M,E=w-S,P=Math.sqrt(C*C+E*E);C/=P,E/=P,v.normals[_*2+0]=-E,v.normals[_*2+1]=C;let I=s.vertexIndices[m];if(Array.isArray(I))v.continuous[_]=!1;else{let[D,L]=i.getCurveIndexFromVertexId(I-1,!0);if(L>0&&L<1)v.continuous[_]=!0;else{let B=L===1?D+1:D-1;B=(B+x)%x;let j=L===1?0:1,z=i.roundedCurves[D].getTangent(L),O=i.roundedCurves[B].getTangent(j);v.continuous[_]=z.dot(O)>.95}}u&&(v.normals[_*2+0]*=-1,v.normals[_*2+1]*=-1),[g,m,y]=[m,y,y+1],y>=f&&(y-=p)}while(y!==d+1)}return{regions:[n,...r],infos:l,vertices:s.vertices}}_insertVertex(e,t,i,n,r){let s=t*2,a=t*3;e.positions[a+0]=i.x,e.positions[a+1]=i.y,e.positions[a+2]=i.z,e.normals[a+0]=n.x,e.normals[a+1]=n.y,e.normals[a+2]=n.z,e.uvs[s+0]=r.x,e.uvs[s+1]=r.y}_extrudeRegion(e,t,i,n,r,s,a){let o=new T,l=new T,c=new T,u=new T,h=new te;i.forEach((p,f)=>{let v=n[f],m=e.verticesStart*i.length+e.verticesCount*f;for(let g=0;g<e.count;g++){let y=(e.start+g)*2;if(o.set(t[y+0],t[y+1],0),c.copy(o).applyMatrix4(p).add(v),e.continuous[g])u.set(e.normals[g*2+0],e.normals[g*2+1],0);else{let x=g===0?(e.start+e.count-1)*2:y-2;l.set(t[x+0],t[x+1],0),u.copy(o).sub(l),u.set(-u.y,u.x,0),e.isHole||u.negate()}if(u.applyMatrix4(p).normalize(),h.set(g===0?1:g/e.count,f/(i.length-1)),this._insertVertex(r,m,c,u,h),m++,!e.continuous[g]||g===0){if(g===0)u.set(e.normals[g*2+0],e.normals[g*2+1],0),h.set(0,f/(i.length-1));else{let x=g===e.count-1?e.start*2:y+2;l.set(t[x+0],t[x+1],0),u.copy(l).sub(o),u.set(-u.y,u.x,0),e.isHole||u.negate()}u.applyMatrix4(p).normalize(),this._insertVertex(r,m,c,u,h),m++}}});let d=i.length-1;for(let p=0;p<d;p++){let f=e.verticesStart*i.length+e.verticesCount*p,v=e.verticesStart*i.length+e.verticesCount*(p+1),m=0;for(let g=0;g<e.count;g++){(!e.continuous[g]||g===0)&&m++;let y=g===e.count-1?0:m+1,x=f+m,_=f+y,b=v+y,w=v+m;e.isHole?s.push(x,b,_,x,w,b):s.push(x,_,b,x,b,w),m++}}}_closeEnd(e,t,i,n,r,s,a){let o=e.vertexCount,l=new T(0,0,a?-1:1).applyMatrix4(r),c=new T,u=new te;for(let d=0;d<o;d++){let p=2*d;c.set(e.vertices[p+0],e.vertices[p+1],0).applyMatrix4(r).add(s),this._insertVertex(n,t+d,c,l,u)}let h=e.elements;for(let d=0;d<e.elementCount;d++){let p=3*d,f=h[p+0]+t,v=h[p+(a?1:2)]+t,m=h[p+(a?2:1)]+t;i.push(f,v,m)}}applyMatrix4OnRange(e,t,i){let n=e.elements,r=new Sn().getNormalMatrix(e).elements,s,a,o,l,c=this.attributes.position,u=this.attributes.normal;if(!c||!u)return;let h=c.array,d=u.array,p=c.itemSize;for(let f=t*p,v=i*p;f<v;f+=p){if(f===t)debugger;s=h[f+0],a=h[f+1],o=h[f+2],l=1/(n[3]*s+n[7]*a+n[11]*o+n[15]),h[f+0]=(n[0]*s+n[4]*a+n[8]*o+n[12])*l,h[f+1]=(n[1]*s+n[5]*a+n[9]*o+n[13])*l,h[f+2]=(n[2]*s+n[6]*a+n[10]*o+n[14])*l,s=d[f+0],a=d[f+1],o=d[f+2],d[f+0]=r[0]*s+r[3]*a+r[6]*o,d[f+1]=r[1]*s+r[4]*a+r[7]*o,d[f+2]=r[2]*s+r[5]*a+r[8]*o}c.needsUpdate=!0,u.needsUpdate=!0}reverseIndicesOnRange(e,t){let i=this.index;if(i){for(let n=e;n<t;n+=3){let r=i.getX(n),s=i.getX(n+1),a=i.getX(n+2);i.setXYZ(n,a,s,r)}i.needsUpdate=!0}}};function JU(){let e=new mt;return e.setAttribute("position",new gt(new Float32Array([]),3)),e.setIndex(new gt(new Uint16Array([]),1)),e}var lfe=JU().attributes,cfe=12,hfe=1,eF=class extends mt{constructor(e,t){super(),this.charWidths=[],this.charCoords=[],this.wrappedText=[],this.isLowResolution=!1,this.vectorShapes=[],Object.assign(this.attributes,lfe),this.userData={parameters:e,type:"TextGeometry"};let i=t.getFont(e.font);i!=null&&i.isLoaded?(this.font=i,this.update(e)):this.updateFont(e.font,t).then(()=>{this.update(e),t==null||t.requestRender()})}async updateFont(e,t){let i=t.getFont(e);i&&(this.font=i,await i.loadingPromise)}update(e){let t=this.font;if(this.userData={parameters:e,type:"TextGeometry"},!(t!=null&&t.isLoaded)){console.warn("Cannot update text because its font is not loaded");return}let{width:i,height:n,depth:r,extrudeBevelSize:s,extrudeBevelSegments:a,text:o,textTransform:l}=e,c=l===2?o.toUpperCase():l===3?o.toLowerCase():o,u=ufe(e,t,c),{shapes:h,charWidths:d,charCoords:p}=t.generateShapes(u,e),f=i*.5,v=n*.5,m=h.map(x=>new Di().fromShape(x));this.vectorShapes=m;let g=m.map(x=>au.create({shape:x,parameters:{depth:r,extrudeBevelSegments:a,extrudeBevelSize:s,windingRule:r<=0?Zt.NONZERO:Zt.ODD,subdivisions:this.isLowResolution&&r>0?hfe:cfe}})),y=g.length?bh(g):JU();y.translate(-f,v,0),this.dispose(),this.wrappedText=u,this.charCoords=p,this.charWidths=d,this.deleteAttribute("extrudeNormal"),Object.entries(y.attributes).forEach(([x,_])=>{this.setAttribute(x,_)}),this.setIndex(y.index),this.computeBoundingSphere()}clone(){let e=qh(new mt,eF.prototype);return e.copy(this),console.log("CloneGeometry",this,e),e}copy(e){return Object.entries(e.attributes).forEach(([t,i])=>{this.setAttribute(t,i)}),this.setIndex(e.index),this.userData={parameters:{...e.userData.parameters},type:"TextGeometry"},this}async setText(e){this.font&&await this.font.loadingPromise,await this.update({...this.userData.parameters,text:e})}get text(){return this.userData.parameters.text??""}};function ufe(e,t,i){i=i??e.text;let n=[""],r="";for(let s of i)r+=s,s===" "||s===`
`?(n[n.length-1]+=r,r="",s===`
`&&n.push("")):t.getTextWidth(n[n.length-1]+r,e)>e.width&&(n[n.length-1].length&&n.push(""),t.getTextWidth(n[n.length-1]+r,e)>e.width&&(r.length===1?(n[n.length-1]+=r,r=""):(n[n.length-1]+=r.slice(0,-1),r=r[r.length-1],n.push(""))));return n[n.length-1]+=r,n}var tF,bA=new Promise(e=>{tF=e}),fP=!1,O1;function dfe(){if(fP)return;if(O1)return O1;async function e(){let t="https://unpkg.com/@splinetool/modelling-wasm@0.9.455/build",i=J0(()=>import("./process-10f79362.js"),[]),[n,r]=await Promise.all([i,fetch(`${t}/process.wasm`).then(o=>o.arrayBuffer())]),s=n.default,a=await s({wasmBinary:r});tF(a),fP=!0}return O1=e(),O1}function mx(e,t,i){let n={parameters:e,type:e.type};if(e.type==="PathGeometry")n.path=e.path;else if(e.type==="VectorGeometry"){let s=Di.createFromState(e.shape,e.width,e.height);n.shape=s}else if(e.type==="NonParametricGeometry")e.data.groups&&e.data.groups.forEach(s=>s.materialIndex=Math.max(s.materialIndex??0,0)),n.geometry=new oN().parse(e);else{if(e.type==="SubdivGeometry")return new ar(e,i);if(e.type==="TextGeometry")return new eF(e,t)}let r;try{r=xP(n)}catch(s){console.error(s)}if(!r){let s=Di.createFromState(nx.defaultData(),100,100);n.shape=s,r=xP(n)}return r}var pfe=new ke;function fM(e,t,i,n){let r=e.position.array,s=e.normal.array,a=pfe.makeScale(t,i,n).invert().elements,o,l,c;for(var u=0,h=r.length;u<h;u+=3)r[u]*=t,r[u+1]*=i,r[u+2]*=n,o=s[u],l=s[u+1],c=s[u+2],s[u]=a[0]*o+a[4]*l+a[8]*c,s[u+1]=a[1]*o+a[5]*l+a[9]*c,s[u+2]=a[2]*o+a[6]*l+a[10]*c;e.position.needsUpdate=!0,e.normal.needsUpdate=!0}var B1=new Vi,Ru=new T,ct;bA.then(e=>{ct=e});var mP=new Float32Array([10,10,0,-10,10,0,-10,-10,0,10,-10,0]),gP=new Uint32Array([0,1,2,3]),vP=new Uint8Array([4]),ar=class extends mt{constructor(e,t){super(),this.data=e,this.flatShading=t,this.subdivPointer=0,this.rebuild(),this.freeSubdivPointer()}mutateDirectlyScaleBaked(e,t){this.freeSubdivPointer();let i=this.data.scaleBaked,n=Dh.div(t,i);this.subdividedGeometry&&fM(this.subdividedGeometry.attributes,...n),this.originalGeometry&&fM(this.originalGeometry.attributes,...n),this.data=e;let r=this.userData.parameters;this.userData.parameters={width:r.width*n[0],height:r.height*n[1],depth:r.depth*n[2]},this.originalGeometry.boundingSphere.center.multiply(Ru.fromArray(n));let s=Ru.set(r.width,r.height,r.depth).length();this.originalGeometry.boundingSphere.radius=s/2}ensureSubdivPointer(){return this.subdivPointer===0&&this.rebuild(),this.subdivPointer}rebuild(){let e,t,i;try{({originalGeometry:e,subdividedGeometry:t,subdivPointer:i}=ar.build(this.data,void 0,!this.flatShading,void 0))}catch{e=new ro(100,100,100),i=0}this.subdivPointer=i,this.originalGeometry=e,this.subdividedGeometry=t??void 0;let n=this.subdividedGeometry??this.originalGeometry;Object.assign(this,n),this.calcBoundingBox()}freeSubdivPointer(){this.subdivPointer&&(ar.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0)}dispose(){super.dispose(),this.freeSubdivPointer()}calcBoundingBox(){let e=this.originalGeometry;e.boundingSphere===null&&(e.boundingSphere=new ls,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,i=e.boundingSphere.center;B1.setFromBufferAttribute(t),B1.getCenter(i),e.boundingSphere.radius=i.distanceTo(B1.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),B1.getSize(Ru);let n={width:Ru.x,height:Ru.y,depth:Ru.z};return this.userData.parameters=n,n}static build(e,t,i,n){let r,s,a,o=(e==null?void 0:e.phongAngle)??35;i===!1&&(o=-1),t&&(ct.free_bvh(t),ct.free_subdivision_surface(t));try{r=ar.allocate(e,n)}catch(l){console.error(l,e),r=ar.allocate({positionWASM:mP,indexWASM:gP,verticesPerFaceWASM:vP},n)}if(ct.set_destination_refinement_level(r,0),s=ar.buildLevel(r,!0,o),e.subdivisions>0)try{ct.set_destination_refinement_level(r,e.subdivisions),a=ar.buildLevel(r,!1,o)}catch{try{ct.set_destination_refinement_level(r,e.subdivisions-1),a=ar.buildLevel(r,!1,o)}catch{a=null}}else a=null;return{subdivPointer:r,originalGeometry:s,subdividedGeometry:a}}static primitiveToQuads(e,t,i){e.widthSegments>16&&(e.widthSegments=16),e.heightSegments>16&&(e.heightSegments=16),e.depthSegments>16&&(e.depthSegments=16),e.radialSegments>16&&(e.radialSegments=16),e.type==="DodecahedronGeometry"&&(e.detail=0);let n=e.shape!==void 0||e.path!==void 0?t.geometry:mx(e,i,!1),r;e.type==="TorusGeometry"&&e.arc===Math.PI*2?r=n.getClosedTorusIndicesForBooleanOrSubdiv():r=n.getIndex();let s,a,o,l;({positions:s,triIndices:l}=S2(n.getAttribute("position"),r));let c;if(e.type==="CylinderGeometry"&&e.cornerRadius===0&&e.hollow===0&&e.openEnded===!1){let u=e.radialSegments*e.heightSegments*3*2,h=u+e.radialSegments*3;c=[u,h]}return{indices:a,verticesPerFace:o}=iF(s,l,n,c),{positions:s,indices:a,verticesPerFace:o}}static allocate(e,t){var x;let i,n,r,s=[],a=[];e.positionWASM&&e.positionWASM.length>0?(i=e.positionWASM,n=e.indexWASM,r=e.verticesPerFaceWASM):(i=mP,n=gP,r=vP);let o=i.length,l=n.length,c=r.length,u=i.length+s.length+a.length,h=n.length+r.length,d=u*Float32Array.BYTES_PER_ELEMENT+h*Uint32Array.BYTES_PER_ELEMENT,p=u*Float32Array.BYTES_PER_ELEMENT,f=ct._malloc(d),v=new Float32Array(ct.HEAPF32.buffer,f,u),m=new Uint32Array(ct.HEAPU32.buffer,f+p,h);v.set(i,0),v.set(s,i.length),v.set(a,i.length+s.length),m.set(n,0),m.set(r,n.length);let g;(x=e==null?void 0:e.scaleBaked)!=null&&x.some(_=>_!==1)&&(g=new ke().makeScale(...e.scaleBaked)),t&&(g?g.premultiply(t):g=t);let y=g?ct.alloc_subdivision_surface2(f,o,f+p,l,f+p+n.length*Uint32Array.BYTES_PER_ELEMENT,c,g.elements):ct.alloc_subdivision_surface(f,o,f+p,l,f+p+n.length*Uint32Array.BYTES_PER_ELEMENT,c);return ct._free(f),y}static buildLevel(e,t,i,n,r){let s=r?ct.get_mesh_data2(e,t?ct.Level.CONTROL:ct.Level.REFINED,i,r.elements):ct.get_mesh_data(e,t?ct.Level.CONTROL:ct.Level.REFINED,i),a=8,o=ct.HEAPU32.subarray(s>>2,(s>>2)+a),l=o.subarray(4,4+4),c=0,u=ct.HEAPU32[o[c]>>2],h=ct.HEAPF32.subarray(u>>2,(u>>2)+l[c]);c++;let d=ct.HEAPU32[o[c]>>2],p=ct.HEAPF32.subarray(d>>2,(d>>2)+l[c]);c++;let f=ct.HEAPU32[o[c]>>2],v=ct.HEAPU32.subarray(f>>2,(f>>2)+l[c]);c++;let m=ct.HEAPU32[o[c]>>2],g=ct.HEAPU32.subarray(m>>2,(m>>2)+l[c]);if(c++,n===void 0){let y=new mt;if(y.setIndex(new qd(g,1)),y.setAttribute("position",new et(h,3)),y.setAttribute("normal",new et(p,3)),t){y.setAttribute("faceMap",new qd(v,1));let x=new Float32Array(p.length/3*4).fill(0);y.setAttribute("color",new gt(x,4))}return ct.free_mesh_data(s),y.userData.type="SubdivGeometry",y}n.getAttribute("position").copyArray(h),n.getAttribute("normal").copyArray(p),n.attributes.position.needsUpdate=!0,n.attributes.normal.needsUpdate=!0,ct.free_mesh_data(s)}static freeSubdivPointer(e){ct.free_bvh(e),ct.free_subdivision_surface(e)}static buildControlCageWireframe(e,t,i){let n=ct.get_wireframe_data_for_base_level(e),r=4,s=ct.HEAPU32.subarray(n>>2,(n>>2)+r),a=s.subarray(2,2+2),o=0,l=ct.HEAPU32[s[o]>>2],c=ct.HEAPF32.subarray(l>>2,(l>>2)+a[o]);o++;let u=ct.HEAPU32[s[o]>>2],h=ct.HEAPU32.subarray(u>>2,(u>>2)+a[o]);if(t===void 0){let d=new mt;d.setAttribute("position",new et(c,3));let p=new Float32Array(c.length);for(let f=0,v=c.length;f<v;)p[f++]=i.r,p[f++]=i.g,p[f++]=i.b;return d.setAttribute("color",new gt(p,3)),d.setIndex(new qd(h,1)),ct.free_wireframe_data_for_base_level(n),d}t.getAttribute("position").copyArray(c),t.attributes.position.needsUpdate=!0,ct.free_wireframe_data_for_base_level(n)}static updateCollabMesh(e,t,i){let n=t===0;n||ct.set_destination_refinement_level(e,t);let r=i?ct.get_topological_data2(e,n?ct.Level.CONTROL:ct.Level.REFINED,i.elements):ct.get_topological_data(e,n?ct.Level.CONTROL:ct.Level.REFINED),s=6,a=ct.HEAPU32.subarray(r>>2,(r>>2)+s),o=a.subarray(3,3+3),l=0,c=ct.HEAPU32[a[l]>>2],u=new Float32Array(ct.HEAPF32.subarray(c>>2,(c>>2)+o[l]));l++;let h=ct.HEAPU32[a[l]>>2],d=new Uint32Array(ct.HEAPU32.subarray(h>>2,(h>>2)+o[l]));l++;let p=ct.HEAPU32[a[l]>>2],f=new Uint8Array(ct.HEAPU32.subarray(p>>2,(p>>2)+o[l]));return ct.free_topological_data(r),{positions:u,indices:d,verticesPerFace:f}}},yP=["getX","getY","getZ"];function S2(e,t){let i={},n=t?t.count:e.count,r=0,s=[],a=[],o=1e4;for(let c=0;c<n;c++){let u=t?t.getX(c):c,h="";for(let d=0;d<3;d++)h+=`${~~(e[yP[d]](u)*o)},`;if(h in i)s.push(i[h]);else{for(let d=0;d<3;d++)a.push(e[yP[d]](u));i[h]=r,s.push(r),r++}}let l=[];for(let c=0;c<s.length;c+=3)s[c]===s[c+1]||s[c]===s[c+2]||s[c+1]===s[c+2]||l.push(s[c],s[c+1],s[c+2]);return{positions:a,triIndices:l}}var N1=new T,Ib=new T,Ob=new T,Bb=new T;function iF(e,t,i,n){let r=[],s=[];if(i.userData.shape!==void 0&&i.userData.parameters.depth===0&&i.userData.shape.shapeHoles.length===0){let l=i.userData.shape.extractShapePointsToFlatArray([]),c=i.userData.parameters.spikes;if(i.userData.type==="EllipseGeometry"&&c<=24&&c%4===0&&i.userData.parameters.angle>=360){let d=l.length/2/c;l=l.filter((p,f)=>Math.floor(f/2)%d===0)}let u=0;for(let d=0;d<l.length;d+=2)u+=(l[d]-l[(d===0?l.length:d)-2])*(l[d+1]+l[(d===0?l.length:d)-1]);e.length=0;let h=0;if(u<0)for(let d=0;d<l.length;d+=2)e.push(l[d],l[d+1],0),r.push(h++);else for(let d=l.length-2;d>=0;d-=2)e.push(l[d],l[d+1],0),r.push(h++);return s.push(h),{indices:r,verticesPerFace:s}}let a=new Float32Array([i.userData.parameters.depth])[0],o=0;for(;o<t.length;){if(i.useNgonForTopBottomFaceDuringBake){let l=0;if((e[t[o]*3+2]===a||e[t[o]*3+2]===0)&&l++,(e[t[o+1]*3+2]===a||e[t[o+1]*3+2]===0)&&l++,(e[t[o+2]*3+2]===a||e[t[o+2]*3+2]===0)&&l++,l===3)break}if(t[o+1]===t[o+3]&&t[o+2]===t[o+5]||t[o+0]===t[o+3]&&t[o+2]===t[o+4]){N1.set(e[t[o]*3],e[t[o]*3+1],e[t[o]*3+2]),Ib.set(e[t[o+1]*3],e[t[o+1]*3+1],e[t[o+1]*3+2]),Ob.set(e[t[o+4]*3],e[t[o+4]*3+1],e[t[o+4]*3+2]),Bb.set(e[t[o+5]*3],e[t[o+5]*3+1],e[t[o+5]*3+2]),Ib.sub(N1).normalize(),Ob.sub(N1).normalize(),Bb.sub(N1).normalize();let l=Ib.cross(Ob).dot(Bb);Math.abs(l)>.005||n&&n.some((c,u)=>u%2===1?!1:o>=n[u]&&o<n[u+1])?(r.push(t[o],t[o+1],t[o+2]),s.push(3),o+=3):(r.push(t[o],t[o+1],t[o+4],t[o+5]),s.push(4),o+=6)}else r.push(t[o],t[o+1],t[o+2]),s.push(3),o+=3}if(i.useNgonForTopBottomFaceDuringBake){let l=[],c=[],u=0;for(let h=0,d=0;h<e.length;h+=3,d++)e[h+2]===0&&(l.push(d),u++),e[h+2]===a&&c.push(d);if(i.userData.parameters.extrudeBevelSize===0){let h=c[0];c[0]=c[1],c[1]=h}l.reverse(),r.push(...l,...c),s.push(u,u)}return{indices:r,verticesPerFace:s}}var Fo={};eZ(Fo,{calcBoolean:()=>yfe,calcBooleanTopological:()=>vfe,freeMeshSet:()=>wfe,getMeshSet:()=>xfe,hasOpenEdges:()=>_fe,transformMeshSet:()=>bfe});var nF,ffe=new Promise(e=>{nF=e}),U1;function mfe(){if(U1)return U1;async function e(){let t="https://unpkg.com/@splinetool/boolean-wasm@0.9.455/build",i=J0(()=>import("./boolean-613a7c9c.js"),[]),[n,r]=await Promise.all([i,fetch(`${t}/boolean.wasm`).then(o=>o.arrayBuffer())]),s=n.default,a=await s({wasmBinary:r});nF(a)}return U1=e(),U1}var Ot,np;ffe.then(e=>Ot=e);function gfe(e,t,i){let n,r;e.userData.parameters.type==="TorusGeometry"&&e.userData.parameters.arc===Math.PI*2?r=e.getClosedTorusIndicesForBooleanOrSubdiv():r=e.getIndex();let{positions:s,triIndices:a}=S2(e.getAttribute("position"),r),o;if(t&&i){let{indices:l,verticesPerFace:c}=iF(s,a,e);o=c.length,n=[];for(let u=0,h=0;u<o;u++){n.push(c[u]);for(let d=0;d<c[u];d++)n.push(l[h++])}}else{let l=a.length;n=Array(l+l/3),o=0;for(let c=0,u=0;u<n.length;)n[u++]=3,o++,n[u++]=a[c++],n[u++]=a[c++],n[u++]=a[c++]}return{positions:s,faceIndices:n,nFaces:o}}function rF(e){let t=e.length,i=t*Uint32Array.BYTES_PER_ELEMENT,n=t*Float32Array.BYTES_PER_ELEMENT,r=Number.isInteger(e[0])?i:n,s=Ot._malloc(r);return(Number.isInteger(e[0])?new Uint32Array(Ot.HEAPU32.buffer,s,t):new Float32Array(Ot.HEAPF32.buffer,s,t)).set(e,0),s}function sF(e){switch(e){case 0:return Ot.OP.UNION;case 1:return Ot.OP.INTERSECTION;case 2:return Ot.OP.A_MINUS_B;case 3:return Ot.OP.B_MINUS_A;case 4:return Ot.OP.SYMMETRIC_DIFFERENCE;case 5:return Ot.OP.ALL;default:throw new Error("Unknown boolean operation "+e)}}function vfe(e,t){np===void 0&&(np=Ot.init_csg());let i=rF(e),n=Ot.csg_calc_topological(np,i,e.length,sF(t));Ot._free(i);let r=6,s=Ot.HEAPU32.subarray(n>>2,(n>>2)+r),a=s.subarray(3,3+3),o=0,l=Ot.HEAPU32[s[o]>>2],c=new Float32Array(Ot.HEAPF32.subarray(l>>2,(l>>2)+a[o]));o++;let u=Ot.HEAPU32[s[o]>>2],h=new Uint32Array(Ot.HEAPU32.subarray(u>>2,(u>>2)+a[o]));o++;let d=Ot.HEAPU32[s[o]>>2],p=new Uint8Array(Ot.HEAPU32.subarray(d>>2,(d>>2)+a[o]));return Ot.free_mesh_data(n),{positions:c,indices:h,verticesPerFace:p}}function yfe(e,t,i,n){np===void 0&&(np=Ot.init_csg());let r=rF(e),s=Ot.csg_calc(np,r,e.length,n,sF(t));Ot._free(r);let a=5,o=Ot.HEAPU32.subarray(s>>2,(s>>2)+a),l=o.subarray(2,2+3),c=0,u=Ot.HEAPU32[o[c]>>2],h=Ot.HEAPF32.subarray(u>>2,(u>>2)+l[c]);c++;let d=Ot.HEAPU32[o[c]>>2],p=Ot.HEAPF32.subarray(d>>2,(d>>2)+l[c]);c++;let f=l[c];i.setAttribute("position",new et(h,3)),i.setAttribute("normal",new et(p,3));let v=Ot.HEAPF32.subarray((s>>2)+5,(s>>2)+5+6);return i.boundingSphere===null&&(i.boundingSphere=new ls),i.boundingSphere.center.set(v[0],v[1],v[2]),i.boundingSphere.radius=(v[3]**2+v[4]**2+v[5]**2)**.5,i.userData.parameters={width:v[3]*2,height:v[4]*2,depth:v[5]*2},Ot.free_mesh_data(s),f}function xfe(e,t,i){if(Ot===void 0)return-1;let n,r,s;if(t&&e.userData.positions!==void 0){let v=e.userData;s=v.verticesPerFace.length,n=v.positions,r=Array(v.verticesPerFace.reduce((m,g)=>m+g,0)+s);for(let m=0,g=0,y=0;m<v.verticesPerFace.length;m++){r[y++]=v.verticesPerFace[m];for(let x=0;x<v.verticesPerFace[m];x++)r[y++]=v.indices[g++]}}else({positions:n,faceIndices:r,nFaces:s}=gfe(e,t,i));let a=n.length,o=r.length,l=n.length,c=r.length,u=l*Float32Array.BYTES_PER_ELEMENT+c*Uint32Array.BYTES_PER_ELEMENT,h=l*Float32Array.BYTES_PER_ELEMENT,d=Ot._malloc(u),p=new Float32Array(Ot.HEAPF32.buffer,d,l),f=new Uint32Array(Ot.HEAPU32.buffer,d+h,c);return p.set(n,0),f.set(r,0),Ot.get_csg_mesh(d,a,d+h,o,s)}function _fe(e){return Ot.has_open_edges(e)}function bfe(e,t){Ot.transform_csg_mesh(e,t.elements)}function wfe(e){Ot.free_csg_mesh(e)}var Sfe={ConeGeometry:Jde,CubeGeometry:epe,CylinderGeometry:IU,DodecahedronGeometry:ipe,EllipseGeometry:_A,HelixGeometry:Ope,IcosahedronGeometry:Bpe,LatheGeometry:Npe,NonParametricGeometry:Gpe,PolygonGeometry:QU,PyramidGeometry:jpe,RectangleGeometry:KU,SphereGeometry:qpe,PlaneGeometry:Ype,BackdropGeometry:Zpe,StarGeometry:$U,TextFrameGeometry:Kpe,TorusGeometry:$pe,TorusKnotGeometry:efe,TriangleGeometry:tfe,PathGeometry:afe,VectorGeometry:au},xP=e=>Sfe[e.type].create(e);function Hf(e){return e!==null&&"booleanOp"in e}var aF=class extends fA(Ar){constructor(){super(...arguments),this.booleanMeshSetAddress=-1,this.booleanWasTransformed=!1,this.booleanMatrixInvOld=new ke}updateVisible(){super.updateVisible(),this.visible=!Hf(this.parent)&&this.visible,Hf(this.parent)&&this.parent.invalidateDownstreamBooleanData()}freeBooleanPointer(){this.booleanMeshSetAddress!==-1&&(Fo.freeMeshSet(this.booleanMeshSetAddress),this.booleanMeshSetAddress=-1)}invalidateDownstreamBooleanData(e=!1){return e?this.booleanWasTransformed=!0:this.freeBooleanPointer(),Hf(this.parent)?this.parent.invalidateDownstreamBooleanData():this}invalidateUpstreamBooleanData(){this.freeBooleanPointer();for(let e of this.children)e instanceof aF&&(e.freeBooleanPointer(),Hf(e)&&e.invalidateUpstreamBooleanData())}updateTransformState(e){let t=super.updateTransformState(e);return t&&Hf(this.parent)&&this.invalidateDownstreamBooleanData(!0),t}},F1=new Vi;function wA(e,t=0,i=e.count,n,r){let s=1/0,a=1/0,o=1/0,l=-1/0,c=-1/0,u=-1/0;for(let h=t;h<i;h++){let d=e.getX(h),p=e.getY(h),f=e.getZ(h);d<s&&(s=d),p<a&&(a=p),f<o&&(o=f),d>l&&(l=d),p>c&&(c=p),f>u&&(u=f)}F1.min.set(s,a,o),F1.max.set(l,c,u),F1.getCenter(n),F1.getSize(r).multiplyScalar(.5)}var Mfe=new mt,Cfe=new ig,zr=class extends aF{constructor(e,t){super(Mfe,Cfe),this.super_Entity(e,t)}updateState(e,t){this.updateState_Entity(e,t)}updateEntityBoxSize(e,t){let i=this.geometry.getAttribute("position");i!==void 0?wA(i,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:i.count,e,t):super.updateEntityBoxSize(e,t)}},_P=class{constructor(e){e=e??{},this.name=e.name,this.type=e.type,this.node=e.node,this.size=e.size,this.needsUpdate=e.needsUpdate}get value(){return this.node.value}set value(e){this.node.value=e}},Fc=class{constructor(e){this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},this.uuid=Dt.generateUUID(),this.type=e,this.name=""}analyze(e,t){t=t??{},e.analyzing=!0,this.build(e.addFlow(t.slot,t.cache,t.context),"v4"),e.clearVertexNodeCode(),e.clearFragmentNodeCode(),e.removeFlow(),e.analyzing=!1}analyzeAndFlow(e,t,i){return i=i??{},this.analyze(e,i),this.flow(e,t,i)}flow(e,t,i){i=i??{},e.addFlow(i.slot,i.cache,i.context);let n={result:this.build(e,t),code:e.clearNodeCode(),extra:e.context.extra};return e.removeFlow(),n}build(e,t,i){t=t??this.getType(e,t);let n=e.getNodeData(i??this);return e.analyzing&&this.appendDepsNode(e,n,t),e.nodes.indexOf(this)===-1&&e.nodes.push(this),this.updateFrame!==void 0&&e.updaters.indexOf(this)===-1&&e.updaters.push(this),this.generate(e,t,i)}updateFrame(e){}generateReadonly(e,t,i,n,r,s){return""}generate(e,t,i,n,r){return""}parse(e,t,i,n){}appendDepsNode(e,t,i){t.deps=(t.deps||0)+1;let n=e.getTypeLength(i);(n>(t.outputMax||0)||this.getType(e,i))&&(t.outputMax=n,t.output=i)}setName(e){this.name=e}getName(){return this.name}getType(e,t){return t==="sampler2D"||t==="samplerCube"?t:this.type}getHash(){let e="{",t,i;for(t in this)i=this[t],i instanceof Fc&&(e+='"'+t+'":'+i.getHash()+",");if(this.hashProperties)for(let n=0;n<this.hashProperties.length;n++)t=this.hashProperties[n],i=this[t],e+='"'+t+'":"'+String(i)+'",';return e+='"id":"'+this.uuid+'"}',e}},Efe=class{constructor(){this.nodes={},this.keywords={}}add(e){this.nodes[e.name]=e}addKeyword(e,t,i){i=i!==void 0?i:!0,this.keywords[e]={callback:t,cache:i}}remove(e){delete this.nodes[e.name]}removeKeyword(e){delete this.keywords[e]}get(e){return this.nodes[e]}getKeyword(e,t){return this.keywords[e].callback(t)}getKeywordData(e){return this.keywords[e]}contains(e){return this.nodes[e]!==void 0}containsKeyword(e){return this.keywords[e]!==void 0}},Cr=new Efe,Jt=class extends Fc{constructor(e,t){super(e),this.scope="",t=t??{},this.shared=t.shared!==void 0?t.shared:!0,this.unique=t.unique!==void 0?t.unique:!1}build(e,t,i,n){if(t=t??this.getType(e),this.getShared(e,t)){let r=this.getUnique(e,t);r&&this.uuid===void 0&&(this.uuid=Dt.generateUUID()),i=e.getUUID(i??this.getUUID(),!r);let s=e.getNodeData(i),a=s.output||this.getType(e);if(e.analyzing)return(s.deps||0)>0||this.getLabel()?(this.appendDepsNode(e,s,t),this.generate(e,t,i)):super.build(e,t,i);if(r)return s.name=s.name||super.build(e,t,i),s.name;if(!this.getLabel()&&(!this.getShared(e,a)||e.context.ignoreCache||s.deps===1))return super.build(e,t,i);i=this.getUUID(!1);let o=this.getTemp(e,i);if(o)return e.format(o,a,t);{o=super.generate(e,t,i,s.output,n);let l=this.generate(e,a,i);return e.addNodeCode(o+" = "+l+";"),e.format(o,a,t)}}return super.build(e,t,i)}getShared(e,t){return t!=="sampler2D"&&t!=="samplerCube"&&this.shared}getUnique(e,t){return this.unique}setLabel(e){return this.label=e,this}getLabel(){return this.label}getUUID(e){let t=this.uuid;return typeof this.scope=="string"&&(t=this.scope+"-"+t),t}getTemp(e,t){t=t||this.uuid;let i=e.getVars()[t];return i?i.name:void 0}generate(e,t,i,n,r){return this.getShared(e,t)||console.error("TempNode is not shared"),i=i??this.uuid,e.getTempVar(i,n??this.getType(e),r,this.getLabel()).name}},Vr=class extends Jt{constructor(e,t){t=t??{},t.shared=t.shared!==void 0?t.shared:!1,super(e,t),this.readonly=!1}setReadonly(e){return this.readonly=e,this.hashProperties=this.readonly?["value"]:void 0,this}getReadonly(){return this.readonly}generate(e,t,i,n,r,s){i=e.getUUID(i??this.getUUID()),n=n??this.getType(e);let a=e.getNodeData(i);return this.getReadonly()&&this.generateReadonly!==void 0?this.generateReadonly(e,t,i,n,r,s):e.isShader("vertex")?(a.vertex||(a.vertex=e.createVertexUniform(n,this,r,s,this.getLabel())),e.format(a.vertex.name,n,t)):(a.fragment||(a.fragment=e.createFragmentUniform(n,this,r,s,this.getLabel())),e.format(a.fragment.name,n,t))}},Dn=class extends Vr{constructor(e=0,t){super("v2"),this.nodeType="Vector2",this.value=e instanceof te?e:new te(e,t)}get x(){return this.value.x}set x(e){this.value.x=e}get y(){return this.value.y}set y(e){this.value.y=e}generateReadonly(e,t,i,n,r,s){return e.format("vec2("+this.value.x+", "+this.value.y+")",n,t)}},bs=class extends Vr{constructor(t=0,i,n){super("v3"),this.nodeType="Vector3",this.value=t instanceof T?t:new T(t,i,n)}get x(){return this.value.x}set x(t){this.value.x=t}get y(){return this.value.y}set y(t){this.value.y=t}get z(){return this.value.z}set z(t){this.value.z=t}generateReadonly(t,i,n,r,s,a){return t.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",r,i)}},Or=class extends ut{constructor(e,t,i,n){super(e,t,i),this.isColorA=!0,this.a=n}setRGBA(e,t,i,n){super.setRGB(e,t,i),this.a=n}copy(e){return super.copy(e),this.a="a"in e?e.a:1,this}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}setStyle(e,t="srgb"){let i;if(e==="transparent")return this.setRGBA(0,0,0,0),this;if(i=/^((?:rgb|hsl)a?)\(([^)]*)\)/.exec(e)){let n,r=i[1],s=i[2];switch(r){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a=r==="rgba"?parseFloat(n[4]):1,super.setStyle(e,t);break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)%\s*,\s*(\d*\.?\d+)%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.a=r==="hsla"?parseFloat(n[4]):1,super.setStyle(e,t);break}}return super.setStyle(e,t)}get x(){return this.r}get y(){return this.g}get z(){return this.b}get w(){return this.a}set x(e){this.r=e}set y(e){this.g=e}set z(e){this.b=e}set w(e){this.a=e}},zo=class extends Vr{constructor(e){super("v4"),this.nodeType="Vector4",this.value=e instanceof Or?e:new Or(e.r,e.g,e.b,e.a)}generateReadonly(e,t,i,n,r,s){return e.format("vec4("+this.value.r+", "+this.value.g+", "+this.value.b+", "+this.value.a+")",n,t)}},Afe=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,bP=/[a-z_0-9]+/gi,Xe=class extends Jt{constructor(e,t,i,n,r){super(r),this.src="",this.nodeType="Function",this.useKeywords=!0,this.includes=[],this.extensions={},this.keywords={},this.isMethod=r===void 0,this.isInterface=!1,this.parse(e,t,i,n)}getShared(e,t){return!this.isMethod}getType(e){return e.getTypeByFormat(this.type)}getInputByName(e){if(this.inputs){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}}getIncludeByName(e){if(this.includes){let t=this.includes.length;for(;t--;)if(this.includes[t].name===e)return this.includes[t]}}generate(e,t,i,n,r){let s,a=0,o=this.src;if(this.includes)for(let c=0;c<this.includes.length;c++)e.include(this.includes[c],this);for(let c in this.extensions)e.extensions[c]=!0;let l=[];for(;s=bP.exec(this.src);)l.push(s);for(let c=0;c<l.length;c++){let u=l[c],h=u[0],d=this.isMethod?!this.getInputByName(h):!0,p=h;if(this.keywords[h]||this.useKeywords&&d&&Cr.containsKeyword(h)){let f=this.keywords[h];if(!f){let v=Cr.getKeywordData(h);v.cache&&(f=e.keywords[h]),f=f||Cr.getKeyword(h,e),v.cache&&(e.keywords[h]=f)}p=f.build(e)}h!==p&&o[u.index+a-1]!=="."&&(o=o.substring(0,u.index+a)+p+o.substring(u.index+h.length+a),a+=p.length-h.length),this.getIncludeByName(p)===void 0&&Cr.contains(p)&&e.include(Cr.get(p))}return t==="source"?o:this.isMethod?(this.isInterface||e.include(this,void 0,o),this.name):e.format("( "+o+" )",this.getType(e),t)}parse(e,t,i,n){if(this.src=e||"",this.includes=t??[],this.extensions=i??{},this.keywords=n??{},this.isMethod){let r=Afe.exec(this.src);if(this.inputs=[],r&&r.length==4){this.type=r[1],this.name=r[2];let s=r[3].match(bP);if(s){let a=0;for(;a<s.length;){let o=s[a++],l;o==="in"||o==="out"||o==="inout"?l=s[a++]:(l=o,o="");let c=s[a++];this.inputs.push({name:c,type:l,qualifier:o})}}this.isInterface=this.src.indexOf("{")===-1}else this.type="",this.name=""}}},Tfe=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,oF=class extends Jt{constructor(e="",t){super(),this.src="",this.useDefine=!1,this.nodeType="Const",this.parse(e||oF.PI,void 0,void 0,void 0,t)}getType(e){return e.getTypeByFormat(this.type)}parse(e,t,i,n,r){this.src=e||"";let s,a,o="",l=Tfe.exec(e);this.useDefine=r??this.src.charAt(0)==="#",l&&l.length>1?(a=l[1],s=l[2],o=l[3]):(s=this.src,a="f"),this.name=s,this.type=a,this.value=o}build(e,t){if(t==="source"){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return e.include(this),e.format(this.name,this.getType(e),t)}generate(e,t,i,n,r){return e.format(this.name,this.getType(e),t)}},Yt=oF;Yt.PI="PI",Yt.PI2="PI2",Yt.RECIPROCAL_PI="RECIPROCAL_PI",Yt.RECIPROCAL_PI2="RECIPROCAL_PI2",Yt.LOG2="LOG2",Yt.EPSILON="EPSILON";var Pfe=new RegExp(`^structs*([a-z_0-9]+)s*{s*((.|
)*?)}`,"gim"),Dfe=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),lF=class extends Jt{constructor(e=""){super(),this.inputs=[],this.src="",this.nodeType="Struct",this.parse(e)}getType(e){return e.getTypeByFormat(this.name)}getInputByName(e){let t=this.inputs.length;for(;t--;)if(this.inputs[t].name===e)return this.inputs[t]}generate(e,t,i,n,r){return t==="source"?this.src+";":e.format("( "+this.src+" )",this.getType(e),t)}parse(e=""){this.src=e,this.inputs=[];let t=Pfe.exec(e);if(t){let i=t[2],n;for(;n=Dfe.exec(i);)this.inputs.push({type:n[1],name:n[2]});this.name=t[1]}else this.name="";this.type=this.name}},SA=class extends Jt{constructor(e){super("v2",{shared:!1}),this.nodeType="UV",this.index=e??0}generate(e,t){e.requires.uv[this.index]=!0;let i=this.index>0?this.index+1:"",n=e.isShader("vertex")?"uv"+i:"vUv"+i;return e.format(n,this.getType(e),t)}};Cr.addKeyword("uv",function(){return new SA});Cr.addKeyword("uv2",function(){return new SA(1)});var hd=class extends Jt{constructor(e,t){super("v4"),this.nodeType="ColorSpace",this.input=e,this.method=t??hd.LINEAR_TO_LINEAR,this.hashProperties=["method"]}static getEncodingComponents(e){switch(e){case no:return["Linear"];case Mt:return["sRGB"];default:return[]}}generate(e,t){var a;let i=this.input.build(e,"v4"),n=this.getType(e),r=hd.Nodes[this.method],s=e.include(r);if(s===hd.LINEAR_TO_LINEAR)return e.format(i,n,t);if(((a=r.inputs)==null?void 0:a.length)===2){let o=this.factor.build(e,"f");return e.format(s+"( "+i+", "+o+" )",n,t)}else return e.format(s+"( "+i+" )",n,t)}fromEncoding(e){let t=hd.getEncodingComponents(e);this.method="LinearTo"+t[0],this.factor=t[1]}fromDecoding(e){let t=hd.getEncodingComponents(e);this.method=t[0]+"ToLinear",this.factor=t[1]}},Za=hd;Za.Nodes={LinearToLinear:new Xe(["vec4 LinearToLinear( in vec4 value ) {","	return value;","}"].join(`
`)),sRGBToLinear:new Xe(["vec4 sRGBToLinear( in vec4 value ) {","	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join(`
`)),LinearTosRGB:new Xe(["vec4 LinearTosRGB( in vec4 value ) {","	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join(`
`))},Za.LINEAR_TO_LINEAR="LinearToLinear",Za.SRGB_TO_LINEAR="sRGBToLinear",Za.LINEAR_TO_SRGB="LinearTosRGB";var ui=class extends Xe{constructor(e="",t,i,n,r){super(e,r,n,i,t),this.nodeType="Expression"}},Wo=class extends Vr{constructor(e=new ln,t,i,n){super("v4",{shared:!0}),this.nodeType="Texture",this.value=e,this.uv=t??new SA,this.bias=i,this.project=n!==void 0?n:!1}getTexture(e,t){return super.generate(e,t,this.value.uuid,"t")}generate(e,t){if(t==="sampler2D")return this.getTexture(e,t);let i=this.getTexture(e,t),n=this.uv.build(e,this.project?"v4":"v2"),r=this.bias?this.bias.build(e,"f"):void 0;r===void 0&&e.context.bias&&(r=e.context.bias.setTexture(this).build(e,"f"));let s,a;this.project?s="texture2DProj":s=r?"tex2DBias":"tex2D",r?a=s+"( "+i+", "+n+", "+r+" )":a=s+"( "+i+", "+n+" )";let o={include:e.isShader("vertex"),ignoreCache:!0},l=this.getType(e);return e.addContext(o),this.colorSpace=this.colorSpace??new Za(new ui("",l)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(a),a=this.colorSpace.build(e,l),e.removeContext(),e.format(a,l,t)}},Ke=class extends Vr{constructor(e){super("f"),this.nodeType="Float",this.value=e??0}generateReadonly(e,t,i,n,r,s){return e.format(this.value+(this.value%1?"":".0"),n,t)}},wP=class extends Jt{constructor(e,t){super(),this.inputs=[],this.nodeType="FunctionCall",this.value=e,this.inputs=t??[]}getFunction(){return this.value}getType(e){return this.value.getType(e)}generate(e,t,i,n,r){n=this.getType(e);let s=this.value,a=s.build(e,t)+"( ",o=[];if(s.inputs){for(let l=0;l<s.inputs.length;l++){let c=s.inputs[l],u=this.inputs[l]||this.inputs[c.name];o.push(u.build(e,e.getTypeByFormat(c.type)))}a+=o.join(", ")+" )"}return e.format(a,n,t)}},cF=class extends Jt{constructor(e,t,i=cF.ADD){super(),this.nodeType="Operator",this.type=e.type,this.a=e,this.b=t,this.op=i}getType(e){let t=this.a.getType(e),i=this.b.getType(e);return e.isTypeMatrix(t)?"v4":e.getTypeLength(i)>e.getTypeLength(t)?i:t}generate(e,t){let i=this.getType(e);this.type=i;let n=this.a.build(e,i),r=this.b.build(e,i);return e.format("( "+n+" "+this.op+" "+r+" )",i,t)}},_r=cF;_r.ADD="+",_r.SUB="-",_r.MUL="*",_r.DIV="/";var qt=class extends Jt{constructor(e,t=qt.ABS,i,n){super(),this.nodeType="Math",this.a=e,typeof t!="string"?this.b=t:n=t,typeof i!="string"?this.c=i:n=i,this.method=n,this.hashProperties=["method"]}getNumInputs(e){switch(this.method){case qt.MIX:case qt.CLAMP:case qt.REFRACT:case qt.SMOOTHSTEP:case qt.FACEFORWARD:return 3;case qt.MIN:case qt.MAX:case qt.MOD:case qt.STEP:case qt.REFLECT:case qt.DISTANCE:case qt.DOT:case qt.CROSS:case qt.POW:return 2;default:return 1}}getInputType(e){let t=e.getTypeLength(this.a.getType(e)),i=this.b?e.getTypeLength(this.b.getType(e)):0,n=this.c?e.getTypeLength(this.c.getType(e)):0;return t>i&&t>n?this.a.getType(e):i>n?this.b.getType(e):this.c.getType(e)}getType(e){switch(this.method){case qt.LENGTH:case qt.DISTANCE:case qt.DOT:return"f";case qt.CROSS:return"v3"}return this.getInputType(e)}generate(e,t){let i,n,r,s=this.a?e.getTypeLength(this.a.getType(e)):0,a=this.b?e.getTypeLength(this.b.getType(e)):0,o=this.c?e.getTypeLength(this.c.getType(e)):0,l=this.getInputType(e),c=this.getType(e);switch(this.type=c,this.method){case qt.NEGATE:return e.format("( -"+this.a.build(e,l)+" )",l,t);case qt.INVERT:return e.format("( 1.0 - "+this.a.build(e,l)+" )",l,t);case qt.CROSS:i=this.a.build(e,"v3"),n=this.b.build(e,"v3");break;case qt.STEP:i=this.a.build(e,s===1?"f":l),n=this.b.build(e,l);break;case qt.MIN:case qt.MAX:case qt.MOD:i=this.a.build(e,l),n=this.b.build(e,a===1?"f":l);break;case qt.REFRACT:i=this.a.build(e,l),n=this.b.build(e,l),r=this.c.build(e,"f");break;case qt.MIX:i=this.a.build(e,l),n=this.b.build(e,l),r=this.c.build(e,o===1?"f":l);break;default:i=this.a.build(e,l),this.b&&(n=this.b.build(e,l)),this.c&&(r=this.c.build(e,l));break}let u=[];u.push(i),n&&u.push(n),r&&u.push(r);let h=this.getNumInputs(e);if(u.length!==h)throw Error(`Arguments not match used in "${this.method}". Require ${h}, currently ${u.length}.`);return e.format(this.method+"( "+u.join(", ")+" )",c,t)}},bt=qt;bt.RAD="radians",bt.DEG="degrees",bt.EXP="exp",bt.EXP2="exp2",bt.LOG="log",bt.LOG2="log2",bt.SQRT="sqrt",bt.INV_SQRT="inversesqrt",bt.FLOOR="floor",bt.CEIL="ceil",bt.NORMALIZE="normalize",bt.FRACT="fract",bt.SATURATE="saturate",bt.SIN="sin",bt.COS="cos",bt.TAN="tan",bt.ASIN="asin",bt.ACOS="acos",bt.ARCTAN="atan",bt.ABS="abs",bt.SIGN="sign",bt.LENGTH="length",bt.NEGATE="negate",bt.INVERT="invert",bt.MIN="min",bt.MAX="max",bt.MOD="mod",bt.STEP="step",bt.REFLECT="reflect",bt.DISTANCE="distance",bt.DOT="dot",bt.CROSS="cross",bt.POW="pow",bt.MIX="mix",bt.CLAMP="clamp",bt.REFRACT="refract",bt.SMOOTHSTEP="smoothstep",bt.FACEFORWARD="faceforward";var mm=class extends Jt{constructor(e,t,i){super("v4"),this.nodeType="TextureCubeUV",this.value=e,this.uv=t,this.bias=i}bilinearCubeUV(e,t,i,n){let r=new wP(mm.Nodes.bilinearCubeUV,[t,i,n]);this.colorSpaceTL=this.colorSpaceTL??new Za(new ui("","v4")),this.colorSpaceTL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(r.build(e)+".tl"),this.colorSpaceTR=this.colorSpaceTR??new Za(new ui("","v4")),this.colorSpaceTR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(r.build(e)+".tr"),this.colorSpaceBL=this.colorSpaceBL??new Za(new ui("","v4")),this.colorSpaceBL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(r.build(e)+".bl"),this.colorSpaceBR=this.colorSpaceBR??new Za(new ui("","v4")),this.colorSpaceBR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(r.build(e)+".br");let s={include:e.isShader("vertex"),ignoreCache:!0};e.addContext(s),this.colorSpaceTLExp=new ui(this.colorSpaceTL.build(e,"v4"),"v4"),this.colorSpaceTRExp=new ui(this.colorSpaceTR.build(e,"v4"),"v4"),this.colorSpaceBLExp=new ui(this.colorSpaceBL.build(e,"v4"),"v4"),this.colorSpaceBRExp=new ui(this.colorSpaceBR.build(e,"v4"),"v4"),e.removeContext();let a=new ui("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return a.keywords.cubeUV_TL=this.colorSpaceTLExp,a.keywords.cubeUV_TR=this.colorSpaceTRExp,a.keywords.cubeUV_BL=this.colorSpaceBLExp,a.keywords.cubeUV_BR=this.colorSpaceBRExp,a.keywords.cubeUV=r,a}generate(e,t){if(e.isShader("fragment")){let i=this.uv,n=this.bias||e.context.roughness,r=new wP(mm.Nodes.roughnessToMip,[n]),s=new bt(r,mm.Nodes.m0,mm.Nodes.cubeUV_maxMipLevel,bt.CLAMP),a=new bt(s,bt.FLOOR),o=new bt(s,bt.FRACT),l=this.bilinearCubeUV(e,this.value,i,a),c=this.bilinearCubeUV(e,this.value,i,new _r(a,new Ke(1).setReadonly(!0),_r.ADD)),u=new bt(l,c,o,bt.MIX);return e.format(u.build(e),"v4",t)}else return console.warn("TextureCubeUVNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)}},mM=mm;mM.Nodes=function(){let e=new lF(`struct TextureCubeUVData {
			vec4 tl;
			vec4 tr;
			vec4 br;
			vec4 bl;
			vec2 f;
		}`),t=new Yt("float cubeUV_maxMipLevel 8.0",!0),i=new Yt("float cubeUV_minMipLevel 4.0",!0),n=new Yt("float cubeUV_maxTileSize 256.0",!0),r=new Yt("float cubeUV_minTileSize 16.0",!0),s=new Xe(`float getFace(vec3 direction) {
				vec3 absDirection = abs(direction);
				float face = -1.0;
				if (absDirection.x > absDirection.z) {
					if (absDirection.x > absDirection.y)
						face = direction.x > 0.0 ? 0.0 : 3.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				} else {
					if (absDirection.z > absDirection.y)
						face = direction.z > 0.0 ? 2.0 : 5.0;
					else
						face = direction.y > 0.0 ? 1.0 : 4.0;
				}
				return face;
		}`);s.useKeywords=!1;let a=new Xe(`vec2 getUV(vec3 direction, float face) {
				vec2 uv;
				if (face == 0.0) {
					uv = vec2(direction.z, direction.y) / abs(direction.x); // pos x
				} else if (face == 1.0) {
					uv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y
				} else if (face == 2.0) {
					uv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z
				} else if (face == 3.0) {
					uv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x
				} else if (face == 4.0) {
					uv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y
				} else {
					uv = vec2(direction.x, direction.y) / abs(direction.z); // neg z
				}
				return 0.5 * (uv + 1.0);
		}`);a.useKeywords=!1;let o=new Xe(`TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
			float face = getFace(direction);
			float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
			mipInt = max(mipInt, cubeUV_minMipLevel);
			float faceSize = exp2(mipInt);
			float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
			vec2 uv = getUV(direction, face) * (faceSize - 1.0);
			vec2 f = fract(uv);
			uv += 0.5 - f;
			if (face > 2.0) {
				uv.y += faceSize;
				face -= 3.0;
			}
			uv.x += face * faceSize;
			if(mipInt < cubeUV_maxMipLevel){
				uv.y += 2.0 * cubeUV_maxTileSize;
			}
			uv.y += filterInt * 2.0 * cubeUV_minTileSize;
			uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
			uv *= texelSize;
			vec4 tl = texture2D(envMap, uv);
			uv.x += texelSize;
			vec4 tr = texture2D(envMap, uv);
			uv.y += texelSize;
			vec4 br = texture2D(envMap, uv);
			uv.x -= texelSize;
			vec4 bl = texture2D(envMap, uv);
			return TextureCubeUVData( tl, tr, br, bl, f );
		}`,[e,s,a,t,i,n,r]);o.useKeywords=!1;let l=new Yt("float r0 1.0",!0),c=new Yt("float v0 0.339",!0),u=new Yt("float m0 -2.0",!0),h=new Yt("float r1 0.8",!0),d=new Yt("float v1 0.276",!0),p=new Yt("float m1 -1.0",!0),f=new Yt("float r4 0.4",!0),v=new Yt("float v4 0.046",!0),m=new Yt("float m4 2.0",!0),g=new Yt("float r5 0.305",!0),y=new Yt("float v5 0.016",!0),x=new Yt("float m5 3.0",!0),_=new Yt("float r6 0.21",!0),b=new Yt("float v6 0.0038",!0),w=new Yt("float m6 4.0",!0),M=[l,c,u,h,d,p,f,v,m,g,y,x,_,b,w],S=new Xe(`float roughnessToMip(float roughness) {
			float mip = 0.0;
			if (roughness >= r1) {
				mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
			} else if (roughness >= r4) {
				mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
			} else if (roughness >= r5) {
				mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
			} else if (roughness >= r6) {
				mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
			} else {
				mip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25
			}
			return mip;
		}`,M);return{bilinearCubeUV:o,roughnessToMip:S,m0:u,cubeUV_maxMipLevel:t}}();var ud=class extends Jt{constructor(e){super("v3"),this.nodeType="Normal",this.scope=e??ud.VIEW}getShared(){return this.scope===ud.WORLD}build(e,t,i,n){let r=e.context[this.scope+"Normal"];return r?r.build(e,t,i,n):super.build(e,t,i)}generate(e,t,i,n,r){let s;switch(this.scope){case ud.VIEW:e.isShader("vertex")?s="transformedNormal":s="geometryNormal";break;case ud.LOCAL:e.isShader("vertex")?s="objectNormal":(e.requires.normal=!0,s="vObjectNormal");break;case ud.WORLD:e.isShader("vertex")?s="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(e.requires.worldNormal=!0,s="vWNormal");break}return e.format(s,this.getType(e),t)}},Tr=ud;Tr.LOCAL="local",Tr.WORLD="world",Tr.VIEW="view",Tr.NORMAL="normal";Cr.addKeyword("viewNormal",function(){return new Tr(Tr.VIEW)});Cr.addKeyword("localNormal",function(){return new Tr(Tr.NORMAL)});Cr.addKeyword("worldNormal",function(){return new Tr(Tr.WORLD)});var Oo=class extends Jt{constructor(e){super("v3"),this.nodeType="Position",this.scope=e??Oo.LOCAL}getType(){switch(this.scope){case Oo.PROJECTION:return"v4"}return this.type}getShader(){switch(this.scope){case Oo.LOCAL:case Oo.WORLD:return!1}return!0}generate(e,t,i,n,r){let s;switch(this.scope){case Oo.LOCAL:e.isShader("vertex")?s="transformed":(e.requires.position=!0,s="vPosition");break;case Oo.WORLD:if(e.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";e.requires.worldPosition=!0,s="vWPosition";break;case Oo.VIEW:s=e.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case Oo.PROJECTION:s=e.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )";break}return e.format(s,this.getType(),t)}},ca=Oo;ca.LOCAL="local",ca.WORLD="world",ca.VIEW="view",ca.PROJECTION="projection";Cr.addKeyword("position",function(){return new ca});Cr.addKeyword("worldPosition",function(){return new ca(ca.WORLD)});Cr.addKeyword("viewPosition",function(){return new ca(ca.VIEW)});var Ba=class extends Jt{constructor(e){super("v3"),this.nodeType="Reflect",this.scope=e??Ba.CUBE}getUnique(e){return!e.context.viewNormal}getType(){switch(this.scope){case Ba.SPHERE:return"v2"}return this.type}generate(e,t){let i=this.getUnique(e);if(e.isShader("fragment")){let n;switch(this.scope){case Ba.VECTOR:{let r=new Tr(Tr.VIEW),s=e.context.roughness,a=r.build(e,"v3"),o=new ca(ca.VIEW).build(e,"v3"),l=s?s.build(e,"f"):void 0,c=`reflect( -normalize( ${o} ), ${a} )`;l&&(c=`normalize( mix( ${c}, ${a}, ${l} * ${l} ) )`);let u=`inverseTransformDirection( ${c}, viewMatrix )`;i?(e.addNodeCode(`vec3 reflectVec = ${u};`),n="reflectVec"):n=u;break}case Ba.CUBE:{let r=new Ba(Ba.VECTOR).build(e,"v3"),s="vec3( -"+r+".x, "+r+".yz )";i?(e.addNodeCode(`vec3 reflectCubeVec = ${s};`),n="reflectCubeVec"):n=s;break}case Ba.SPHERE:{let r="normalize( ( viewMatrix * vec4( "+new Ba(Ba.VECTOR).build(e,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";i?(e.addNodeCode(`vec2 reflectSphereVec = ${r};`),n="reflectSphereVec"):n=r;break}}return e.format(n,this.getType(),t)}else return console.warn("ReflectNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.type,t)}},rp=Ba;rp.CUBE="cube",rp.SPHERE="sphere",rp.VECTOR="vector";var Lfe=class extends Jt{constructor(e=new Wo,t,i){super("v4"),this.nodeType="TextureCube",this.value=e,this.radianceNode=new mM(this.value,t??new rp(rp.VECTOR),i),this.irradianceNode=new mM(this.value,new Tr(Tr.WORLD),new Ke(1).setReadonly(!0))}generate(e,t){return e.isShader("fragment")?(e.require("irradiance"),e.context.bias&&e.context.bias.setTexture(this.value),(e.slot==="irradiance"?this.irradianceNode:this.radianceNode).build(e,t)):(console.warn("TextureCubeNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t))}},Rfe=class extends Vr{constructor(e=new SE,t,i){super("v4",{shared:!0}),this.nodeType="CubeTexture",this.value=e,this.uv=t??new rp,this.bias=i}getTexture(e,t){return super.generate(e,t,this.value.uuid,"tc")}generate(e,t){var l;if(t==="samplerCube")return this.getTexture(e,t);let i=this.getTexture(e,t),n=(l=this.uv)==null?void 0:l.build(e,"v3"),r=this.bias?this.bias.build(e,"f"):void 0;r===void 0&&e.context.bias&&(r=e.context.bias.setTexture(this).build(e,"f"));let s;r?s="texCubeBias( "+i+", "+n+", "+r+" )":s="texCube( "+i+", "+n+" )";let a={include:e.isShader("vertex"),ignoreCache:!0},o=this.getType(e);return e.addContext(a),this.colorSpace=this.colorSpace??new Za(new ui("",o)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(s),s=this.colorSpace.build(e,o),e.removeContext(),e.format(s,o,t)}},Ife=`
uniform int frameIndex;
uniform vec2 resolution;
uniform mat4 previousModelViewMatrix;
uniform mat4 previousProjectionMatrix;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;
`,Ofe=`
layout(location = 1) out vec4 gVelocity;

uniform int frameIndex;
uniform vec2 resolution;

varying vec4 vCurrentPosition;
varying vec4 vPreviousPosition;

const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

vec2 vogelDiskSample(int sampleIndex, int sampleCount, float angle) {
  const float goldenAngle = 2.399963f; // radians
  float r = sqrt(float(sampleIndex) + 0.5f) / sqrt(float(sampleCount));
  float theta = float(sampleIndex) * goldenAngle + angle;
  float sine = sin(theta);
  float cosine = cos(theta);
  return vec2(cosine, sine) * r;
}

// Derived from the interleaved gradient function from Jimenez 2014 http:goo.gl/eomGso
float getNoiseInterleavedGradient(vec2 screenPos) {
    vec3 magic = vec3(0.06711056f, 0.00583715f, 52.9829189f);
    return fract(magic.z * fract(dot(screenPos, magic.xy)));
}

`,Bfe=`
// TODO: This could be generated CPU side and passed to the shader every frame
const vec2 haltonSequence[16] = vec2[16](
vec2( 0.000000,-0.333334),
vec2(-0.500000, 0.333334),
vec2( 0.500000,-0.777778),
vec2(-0.750000,-0.111112),
vec2( 0.250000, 0.555556),
vec2(-0.250000,-0.555556),
vec2( 0.750000, 0.111112),
vec2(-0.875000, 0.777778),
vec2(0.125000, -0.925926),
vec2(-0.375000, -0.259260),
vec2(0.625000, 0.407408),
vec2(-0.625000, -0.703704),
vec2(0.375000, -0.037038),
vec2(-0.125000, 0.629630),
vec2(0.875000, -0.481482),
vec2(-0.937500, 0.185186));

// TODO: Pass correct view size
vec2 offset = haltonSequence[frameIndex];
offset.x /= resolution.x;
offset.y /= resolution.y;

vec4 currentPosition = gl_Position;
vec4 currentPositionJittered = currentPosition + (vec4(offset.x, offset.y, 0.0, 0.0) * currentPosition.w);

// We want to calculate the velocity with unjittered positions
// so that things that are not moving get a velocity = 0
vCurrentPosition = currentPosition;
vPreviousPosition = previousProjectionMatrix * previousModelViewMatrix * vec4(transformed, 1.0);
#ifdef OUTLINE_COMPENSATION
vPreviousPosition.xy += OUTLINE_COMPENSATION;
#endif
gl_Position = currentPositionJittered;

`,Nfe=`
vec2 oldPos = vPreviousPosition.xy;
    oldPos /= vPreviousPosition.w;
    oldPos.xy = (oldPos.xy+1.)/2.0;

vec2 newPos = vCurrentPosition.xy;
    newPos /= vCurrentPosition.w;
    newPos.xy = (newPos.xy+1.)/2.0;

vec2 velocity = (newPos - oldPos);

// Discard fully transparent pixels 
if (gl_FragColor.a <= 0.0) discard;

gVelocity = vec4(velocity, 0.0, 1.0);
`,SP=["x","y","z","w"],Ufe=["float","vec2","vec3","vec4"],Ffe={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},zfe={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},kfe=class{constructor(){this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.needsJitter=!0,this.getIncludesCode=function(){function e(t,i){return t.deps.length-i.deps.length}return function(t,i){let n=this.getIncludes(t,i);if(!n)return"";let r="";n=n.sort(e);for(let s=0;s<n.length;s++)n[s].src&&(r+=n[s].src+`
`);return r}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.fragmentParsVariables={},this.vertexParsVariables={},this.requires={uv:[],color:[],transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,modelMatrix:!1,viewMatrix:!1,projectionMatrix:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","	#define texCube(a, b) textureCube(a, b)","	#define texCubeBias(a, b, c) textureCube(a, b, c)","	#define tex2D(a, b) texture2D(a, b)","	#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif",`
			// NOTE: Include Spline's blending modes. This could be part of BlendNode
			#define SPE_BLENDING_NORMAL 0
			#define SPE_BLENDING_MULTIPLY 1
			#define SPE_BLENDING_SCREEN 2
			#define SPE_BLENDING_OVERLAY 3

			vec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, b, alpha );
			}

			vec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {
				return mix( a, a * b, alpha );
			}

			vec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );
				return mix( a, tmp, alpha );
			}

			vec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {
				vec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );
				return clamp( mix( a, tmp, alpha ), 0.0, 1.0 );
			}

			vec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {
				if ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );
				else if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );
				return vec3( 1.0 );
			}
			`,"#include <packing>","#include <common>"].join(`
`),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join(`
`),fragment:["float accumAlpha = 0.0;",`void accumulateAlpha(float alpha) {
					accumAlpha += (1.0 - accumAlpha) * alpha;
				}`,""].join(`
`)},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}build(e,t){this.addVertexParsCode(Ife),this.addFragmentParsCode(Ofe),this.buildShader("vertex",e),this.buildShader("fragment",t);for(let i=0;i<this.requires.uv.length;i++)if(this.requires.uv[i]){let n=i>0?i+1:"";this.addVaryCode("varying vec2 vUv"+n+";"),i>0&&this.addVertexParsCode("attribute vec2 uv"+n+";"),this.addVertexFinalCode("vUv"+n+" = uv"+n+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition,this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.modelMatrix&&this.addFragmentParsCode("uniform mat4 modelMatrix;"),this.requires.viewMatrix&&this.addFragmentParsCode("uniform mat4 viewMatrix;"),this.requires.projectionMatrix&&this.addFragmentParsCode("uniform mat4 projectionMatrix;"),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this.needsJitter&&(this.addVertexFinalCode(Bfe),this.addFragmentFinalCode(Nfe)),this}buildShader(e,t){this.resultCode[e]=t.build(this.setShader(e),"v4")}setMaterial(e,t){return this.defines={},this}addFlow(e,t,i){return this.addSlot(e).addCache(t).addContext(i)}removeFlow(){return this.removeSlot().removeCache().removeContext()}addCache(e){return this.cache=e??"",this.caches.push(this.cache),this}removeCache(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}addContext(e){return this.context=Object.assign({},this.context,e),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}removeContext(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}addSlot(e){return this.slot=e||"",this.slots.push(this.slot),this}removeSlot(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}addFragmentVariable(e,t){this.fragmentVariables[e]===void 0&&(this.addFragmentCode(`${t} ${e};`),this.fragmentVariables[e]="")}addFragmentParsVariable(e,t){this.fragmentParsVariables[e]===void 0&&(this.addFragmentParsCode(`${t} ${e};`),this.fragmentParsVariables[e]="")}addVertexParsVariable(e,t){this.vertexParsVariables[e]===void 0&&(this.addVertexParsCode(`${t} ${e};`),this.vertexParsVariables[e]="")}addVertexCode(e){this.addCode(e,"vertex")}addFragmentCode(e){this.addCode(e,"fragment")}addCode(e,t){this.code[t??this.shader]+=e+`
`}addVertexNodeCode(e){this.addNodeCode(e,"vertex")}addFragmentNodeCode(e){this.addNodeCode(e,"fragment")}addNodeCode(e,t){this.nodeCode[t??this.shader]+=e+`
`}clearNodeCode(e){e=e??this.shader;let t=this.nodeCode[e];return this.nodeCode[e]="",t}clearVertexNodeCode(){return this.clearNodeCode("vertex")}clearFragmentNodeCode(){return this.clearNodeCode("fragment")}addVertexFinalCode(e){this.addFinalCode(e,"vertex")}addFragmentFinalCode(e){this.addFinalCode(e,"fragment")}addFinalCode(e,t){this.finalCode[t??this.shader]+=e+`
`}addVertexParsCode(e){this.addParsCode(e,"vertex")}addFragmentParsCode(e){this.addParsCode(e,"fragment")}addParsCode(e,t){this.parsCode[t??this.shader]+=e+`
`}addVaryCode(e){this.addVertexParsCode(e),this.addFragmentParsCode(e)}isCache(e){return this.caches.indexOf(e)!==-1}isSlot(e){return this.slots.indexOf(e)!==-1}define(e,t){this.defines[e]=t===void 0?1:t}require(e){this.requires[e]=!0}isDefined(e){return this.defines[e]!==void 0}getVar(e,t,i,n="varying",r="V",s=""){let a=this.getVars(n),o=a[e];if(!o){let l=a.length;o={name:i||"node"+r+l+(s?"_"+s:""),type:t},a.push(o),a[e]=o}return o}getTempVar(e,t,i,n){return this.getVar(e,t,i,this.shader,"T",n)}getAttribute(e,t){if(!this.attributes[e]){let i=this.getVar(e,t);this.addVertexParsCode("attribute "+t+" "+e+";"),this.addVertexFinalCode(i.name+" = "+e+";"),this.attributes[e]={varying:i,name:e,type:t}}return this.attributes[e]}getCode(e){return[this.prefixCode,this.parsCode[e],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[e],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[e],"uniform"),this.getIncludesCode("consts",e),this.getIncludesCode("structs",e),this.getIncludesCode("functions",e),"void main() {",this.getVarListCode(this.getVars(e)),this.code[e],this.resultCode[e],this.finalCode[e],"}"].join(`
`)}getVarListCode(e,t){t=t??"";let i="";for(let n=0,r=e.length;n<r;++n){let s=e[n],a=s.type,o=s.name,l=s.size,c=this.getFormatByType(a);if(c===void 0)throw new Error("Node pars "+c+" not found.");c.includes("[]")?i+=t+" "+c.substring(0,c.length-2)+" "+o+`[${l}];
`:i+=t+" "+c+" "+o+`;
`}return i}getVars(e){return this.inputs.vars[e??this.shader]}getNodeData(e){let t=e instanceof Fc?e.uuid:e;return this.nodeData[t]=this.nodeData[t]||{}}createUniform(e,t,i,n,r,s){if(t.includes("[]")){let a=this.inputs.arrayUniforms,o=a.list.length,l=new _P({type:t,size:i.size,name:n||"nodeUA"+o+(s?"_"+s:""),node:i,needsUpdate:r});return a.list.push(l),a[e].push(l),a[e][l.name]=l,this.uniforms[l.name]=l,l}else{let a=this.inputs.uniforms,o=a.list.length,l=new _P({type:t,name:n||"nodeU"+o+(s?"_"+s:""),node:i,needsUpdate:r});return a.list.push(l),a[e].push(l),a[e][l.name]=l,this.uniforms[l.name]=l,l}}createVertexUniform(e,t,i,n,r){return this.createUniform("vertex",e,t,i,n,r)}createFragmentUniform(e,t,i,n,r){return this.createUniform("fragment",e,t,i,n,r)}include(e,t,i){var s;let n;if(e=typeof e=="string"?Cr.get(e):e,this.context.include===!1)return e.name;e instanceof Xe?n=this.includes.functions:e instanceof Yt?n=this.includes.consts:e instanceof lF&&(n=this.includes.structs);let r=n[this.shader]=n[this.shader]||[];if(e){let a=r[e.name];if(a||(a=r[e.name]={node:e,deps:[]},r.push(a),a.src=e.build(this,"source")),e instanceof Xe&&t&&r[t.name]&&r[t.name].deps.indexOf(e)===-1&&(r[t.name].deps.push(e),(s=e.includes)==null?void 0:s.length)){let o=0;do this.include(e.includes[o++],t);while(o<e.includes.length)}return i&&(a.src=i),e.name}else throw new Error("Include not found.")}colorToVectorProperties(e){return e.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}colorToVector(e){return e.replace(/c/g,"v3")}getIncludes(e,t){return this.includes[e][t||this.shader]}getConstructorFromLength(e){return Ufe[e-1]}isTypeMatrix(e){return/^m/.test(e)}getTypeLength(e){return e==="f"?1:parseInt(this.colorToVector(e).substr(1))}getTypeFromLength(e){return e===1?"f":"v"+e}findNode(...e){for(let t=0;t<arguments.length;t++){let i=e[t];if(i!=null&&i.isNode)return i}}resolve(...e){for(let t=0;t<arguments.length;t++){let i=e[t];if(i!==void 0){if(i.isNode)return i;if(i.isTexture)switch(i.mapping){case Gh:case jh:return new Rfe(i);case eg:return new Lfe(new Wo(i));default:return new Wo(i)}else{if(i.isVector2)return new Dn(i);if(i.isVector3)return new bs(i);if(i.isVector4)return new zo(i)}}}}format(e,t,i){switch(this.colorToVector(i+" <- "+t)){case"f <- v2":return e+".x";case"f <- v3":return e+".x";case"f <- v4":return e+".x";case"f <- i":case"f <- b":return"float( "+e+" )";case"v2 <- f":return"vec2( "+e+" )";case"v2 <- v3":return e+".xy";case"v2 <- v4":return e+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+e+" ) )";case"v3 <- f":return"vec3( "+e+" )";case"v3 <- v2":return"vec3( "+e+", 0.0 )";case"v3 <- v4":return e+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+e+" ) )";case"v4 <- f":return"vec4( "+e+" )";case"v4 <- v2":return"vec4( "+e+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+e+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+e+" ) )";case"i <- f":case"i <- b":return"int( "+e+" )";case"i <- v2":return"int( "+e+".x )";case"i <- v3":return"int( "+e+".x )";case"i <- v4":return"int( "+e+".x )";case"b <- f":return"( "+e+" != 0.0 )";case"b <- v2":return"( "+e+" != vec2( 0.0 ) )";case"b <- v3":return"( "+e+" != vec3( 0.0 ) )";case"b <- v4":return"( "+e+" != vec4( 0.0 ) )";case"b <- i":return"( "+e+" != 0 )"}return e}getTypeByFormat(e){return Ffe[e]||e}getFormatByType(e){return zfe[e]||e}getUUID(e,t){return t=t!==void 0?t:!0,t&&this.cache&&(e=this.cache+"-"+e),e}getElementByIndex(e){return SP[e]}getIndexByElement(e){return SP.indexOf(e)}isShader(e){return this.shader===e}setShader(e){return this.shader=e,this}mergeDefines(e){for(let t in e)this.defines[t]=e[t];return this.defines}mergeUniform(e){for(let t in e)this.uniforms[t]=e[t];return this.uniforms}getTextureEncodingFromMap(e){let t;return e?e.isTexture&&(t=e.encoding):t=no,t===no&&this.context.gamma&&(t=Mt),t}},Li=class extends Vr{constructor(e=0,t,i,n){super("c"),this.nodeType="Color",this.value=e instanceof Or?e:new Or(e||0,t,i,n)}setRGBA(e){this.value.setRGBA(e.r,e.g,e.b,e.a)}generate(e,t,i,n,r,s){i=e.getUUID(i??this.getUUID()),n=n??this.getType(e);let a=e.getNodeData(i),o=this.getReadonly()&&this.generateReadonly!==void 0;if(this.alpha){let l=this.alpha.build(e,"f");e.addFragmentNodeCode(`accumAlpha += ( 1.0 - accumAlpha ) * ${l};`)}return o?this.generateReadonly(e,t,i,n,r,s):e.isShader("vertex")?(a.vertex||(a.vertex=e.createVertexUniform(n,this,r,s,this.getLabel())),e.format(a.vertex.name,n,t)):(a.fragment||(a.fragment=e.createFragmentUniform(n,this,r,s,this.getLabel())),e.format(a.fragment.name,n,t))}generateReadonly(e,t,i,n,r,s){return e.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",n,t)}},ni=class extends Vr{constructor(e){super("i"),this.nodeType="Int",this.value=Math.floor(e??0)}generateReadonly(e,t,i,n,r,s){return e.format(this.value.toString(),n,t)}},lr=class extends Vr{constructor(e){super("b"),this.nodeType="Bool",this.value=e??!1}generateReadonly(e,t,i,n){return e.format(this.value?"true":"false",n,t)}},ah=class extends Vr{constructor(e=1,t){super("f[]"),this.nodeType="FloatArray",this.size=e,this.value=Array.isArray(t)?t:typeof t=="number"?new Array(e).fill(t):new Array(e).fill(0)}},MA=class extends Vr{},Vfe=class extends MA{constructor(e){super("v3"),this.image=e,this._value=new T}get value(){return this._value.x=this.image.isVideo?this.image.img.videoWidth??0:this.image.img.width,this._value.y=this.image.isVideo?this.image.img.videoHeight??0:this.image.img.height,this._value}},gM=class extends MA{constructor(e,t){super("t"),this.image=e,this.wrap=t}get value(){return this.image.getTexture(this.wrap)}},hF=class extends Vr{constructor(e){super("m3"),this.nodeType="Matrix3",this.value=e??new Sn}generateReadonly(e,t,i,n,r,s){return e.format("mat3("+this.value.elements.join(", ")+")",n,t)}get elements(){return this.value.elements}set elements(e){this.value.fromArray(e)}},oo=class extends Vr{constructor(t){super("m4"),this.nodeType="Matrix4",this.value=t??new ke}generateReadonly(t,i,n,r,s,a){return t.format("mat4("+this.value.elements.join(", ")+")",r,i)}get elements(){return this.value.elements}set elements(t){this.value.fromArray(t)}};function MP(e,t,i){e.setUvTransform(i[0],i[1],t[0],t[1],0,0,0)}var Hfe=class extends hF{constructor(e,t){super(new Sn),this.repeat=e,this.offset=t,MP(this.value,e,t)}updateMatrix(){MP(this.value,this.repeat,this.offset)}},oh=class extends Vr{constructor(e=1,t){super("v4[]"),this.nodeType="Vector4Array",this.size=e,this.value=Array.isArray(t)?t:t instanceof Ct?new Array(e).fill(t):new Array(e).fill(new Ct(0))}},CP=class extends Jt{constructor(e,t,i,n){super("v3"),this.nodeType="Blend",this.a=e,this.b=t,this.alpha=i,this.mode=n}generate(e,t){if(e.isShader("fragment")){let i=[];return i.push(this.a.build(e,"c")),i.push(this.b.build(e,"c")),i.push(this.alpha.build(e,"f")),i.push(this.mode.build(e,"i")),e.format("spe_blend("+i.join(",")+")",this.getType(e),t)}else return console.warn("BlendNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},uF=class extends Jt{constructor(e,t){super("v3"),this.nodeType="CustomColor",this.color=e,this.alpha=t,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let i=e.include(uF.Nodes.customColor);e.addFragmentVariable(this.calpha,"float");let n=[];return n.push(this.color.build(e,"v3")),n.push(this.mask?`luminance(${this.mask.build(e,"v3")})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("CustomColorNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},vM=uF;vM.Nodes=function(){return{customColor:new Xe(`vec3 customColor(vec3 color, float mask, float alpha, out float calpha) {
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color;
			}`)}}();var dF=class extends Jt{constructor(e,t){super("v3"),this.nodeType="CustomNormal",this.cnormal=e,this.alpha=t,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){let i=e.include(dF.Nodes.customNormal);e.addFragmentVariable(this.calpha,"float");let n=[];return n.push(this.cnormal.build(e,"v3")),n.push("normal"),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("CustomNormalNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},pF=dF;pF.Nodes=function(){return{customNormal:new Xe(`vec3 customNormal(vec3 cnormal, vec3 norm, float mask, float alpha, out float calpha) {
				vec3 normal = packNormalToRGB( norm ).rgb;
				normal *= step( vec3(0.5), cnormal );

				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * lalpha;

				return normal;
			}`)}}();var gm=class extends Jt{constructor(e,t,i,n,r,s,a,o,l,c,u,h){super("v3"),this.nodeType="CustomTexture",this.texture=e,this.textureSize=t,this.crop=i,this.projection=n,this.axis=r,this.side=s,this.size=a,this.blending=o,this.mat=l,this.isMask=h,this.alpha=c,this.mode=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){e.require("position"),e.require("normal"),e.require("uv"),e.requires.uv=[!0],e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0;let i=`g${this.uuid.toString().replace(/-/g,"")}`,n;switch(this.projection.value){case 3:n=e.include(gm.Nodes.cylindrical);break;case 2:n=e.include(gm.Nodes.spherical);break;case 1:let s=["vec3(1.0, 0.0, 0.0)","vec3(0.0, 1.0, 0.0)","vec3(0.0, 0.0, 1.0)"][this.axis.value],a=["zy","xz","xy"][this.axis.value],o=new Xe(`
		vec3 ${i}_planarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 projected = (1. + (position.${a})) / 2.;
				vec2 uvs = ( mat * vec3( (projected * 2. - 1.) / (size * .5), 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				${this.side.value===2?"":`lalpha *= step(0.0, ${this.side.value===1?"-1.0 * ":""}dot(vObjectNormal, mat * ${s}));`}

				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`);n=e.include(o);break;case 4:n=e.include(gm.Nodes.triplanar);break;default:n=e.include(gm.Nodes.uv);break}e.addFragmentVariable(this.calpha,"float");let r=[];if(r.push("normal"),r.push(this.texture.generate(e,"t")),r.push(this.textureSize.build(e,"v2")),r.push(this.crop.build(e,"f")),r.push(this.mat.build(e,"mat3")),r.push(this.size.build(e,"v2")),r.push(this.blending.build(e,"f")),r.push(this.isMask.build(e,"b")),r.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.mode.build(e,"i")),r.push(this.calpha),this.projection.value===4){let s=`${i}_writeUvs`,a=s+"0",o=s+"1",l=s+"2",c=`${i}_triplanarWeights`;e.addFragmentVariable(a,"vec2"),e.addFragmentVariable(o,"vec2"),e.addFragmentVariable(l,"vec2"),e.addFragmentVariable(c,"vec3"),r.push(a),r.push(o),r.push(l),r.push(c)}else{let s=`${i}_writeUvs`;e.addFragmentVariable(s,"vec2"),r.push(s)}return e.format(n+"("+r.join(",")+")",this.getType(e),t)}},CA=gm;CA.Nodes=function(){let e=new Xe(`
vec3 cylindricalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(position);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float scaledHeight = position.y / (size.y * 0.5);
                float v =  (scaledHeight / 2.) + .5;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;

				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),t=new Xe(`
vec3 sphericalTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
                vec3 posN = normalize(vPosition);
                float u = 0.5 + atan(posN.z, posN.x) / (2.*3.1415);
                float v = 0.5 + asin(posN.y) / 3.1415;

                vec2 calculatedUv = vec2(u,v);
				vec2 uvs = ( mat * vec3( calculatedUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

                vec2 df = fwidth(uvs);
               	if(df.x > 0.5) df.x = 0.;
				#ifdef GL_EXT_shader_texture_lod
                vec4 tmp = texture2DLodEXT(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#else
                vec4 tmp = textureLod(tex, uvs, log2(max(df.x, df.y)*min(textureSize.x, textureSize.y)));
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}
`),i=new Xe(`vec3 uvTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUv) {
				vec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;
				writeUv = uvs;

				vec4 tmp = texture2D( tex, uvs );

				vec3 col = tmp.rgb;

				float lalpha = alpha * tmp.a;
				if ( crop > 0.5 ) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						lalpha = 0.0;
					}
				}
				
				lalpha *= mask;

				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;
			}`),n=new Xe(`vec3 triplanarTexture(vec3 normal, sampler2D tex, vec2 textureSize, float crop, mat3 mat, vec2 size, float blending, bool isMask, float mask, float alpha, int mode, out float calpha, out vec2 writeUvs0, out vec2 writeUvs1, out vec2 writeUvs2, out vec3 writeWeights) {
				vec3 p = position;
				vec2 uv0 = (1.0 + p.xy) / 2.0;     
				vec2 uv1 = (1.0 + p.zy) / 2.0;		
				vec2 uv2 = (1.0 + p.xz) / 2.0;		
	
				uv0 = (mat * vec3((uv0 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv1 = (mat * vec3((uv1 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;
				uv2 = (mat * vec3((uv2 * 2.0 - 1.0) / (size * 0.5), 1.0) / 2.0 + 0.5).xy;

				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));

				// Write out all sets of UVs that we generated
				writeUvs0 = uv0;
				writeUvs1 = uv1;
				writeUvs2 = uv2;
				writeWeights = weights;

				// Derivatives for LOD
				vec2 df0 = fwidth(uv0);
				vec2 df1 = fwidth(uv1);
				vec2 df2 = fwidth(uv2);
				if (df0.x > 0.5) df0.x = 0.0;
				if (df1.x > 0.5) df1.x = 0.0;
				if (df2.x > 0.5) df2.x = 0.0;

				#ifdef GL_EXT_shader_texture_lod
                	vec4 tmp = 
						texture2DLodEXT(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						texture2DLodEXT(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						texture2DLodEXT(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#else
                	vec4 tmp = 
						textureLod(tex, uv0, log2(max(df0.x, df0.y)*min(textureSize.x, textureSize.y))) * weights.z + 
						textureLod(tex, uv1, log2(max(df1.x, df1.y)*min(textureSize.x, textureSize.y))) * weights.x + 
						textureLod(tex, uv2, log2(max(df2.x, df2.y)*min(textureSize.x, textureSize.y))) * weights.y;
				#endif

				vec3 col = tmp.rgb;
				float lalpha = alpha * tmp.a;

				// Apply cropping across all 3 planes
				if ( crop > 0.5 ) {
					if ( uv0.x < 0.0 || uv0.x > 1.0 || uv0.y < 0.0 || uv0.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv1.x < 0.0 || uv1.x > 1.0 || uv1.y < 0.0 || uv1.y > 1.0 )  {
						lalpha = 0.0;
					}
					if ( uv2.x < 0.0 || uv2.x > 1.0 || uv2.y < 0.0 || uv2.y > 1.0 )  {
						lalpha = 0.0;
					}
				}

				lalpha *= mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return col;//n * 0.5 + 0.5;
			}			
			`);return{cylindrical:e,spherical:t,uv:i,triplanar:n}}();var vm=class extends Jt{constructor(e,t,i,n,r,s,a,o,l,c,u,h){super("v3"),this.nodeType="Depth",this.gradientType=e,this.smooth=t,this.near=i,this.far=n,this.isVector=r,this.isWorldSpace=s,this.origin=a,this.direction=o,this.colors=l,this.steps=c,this.isMask=h,this.alpha=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let i=`g${this.uuid.toString().replace(/-/g,"")}`,n=new Xe(`vec3 ${i}_sdepth(float near, float far, vec3 origin, vec3 direction, vec4 colors[${i}_MAX_COLORS], float steps[${i}_MAX_COLORS], bool isMask, float mask, float alpha, out float calpha) {
               vec4 color = colors[0];
               #ifdef ${i}_IS_VECTOR
                   #ifdef ${i}_LINEAR
                       #ifdef ${i}_WORLDSPACE
                       float depth = vectorLinearWorldSpaceDepth(direction, origin, near, far);
                       #else
                       float depth = vectorLinearObjectSpaceDepth(direction, origin, near, far);
                       #endif
                   #else
                       #ifdef ${i}_WORLDSPACE
                           float depth = vectorSphericalWorldSpaceDepth(origin, near, far);
                       #else
                           float depth = vectorSphericalObjectSpaceDepth(origin, near, far);
                       #endif
                   #endif
               #else
                   float dist = length(vWPosition - cameraPosition);
			       float depth = ( dist - near ) / ( far - near );
               #endif


              float p;
              #ifdef ${i}_SMOOTH
				for ( int i = 1; i < ${i}_MAX_COLORS; i++ ) {
						p = clamp( ( depth - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}
              #else
                for ( int i = 1; i < ${i}_MAX_COLORS; i++ ) {
                   p = clamp(( depth - steps[i - 1] ) / ( steps[i] - steps[i - 1] ), 0.0, 1.0);
                   color = mix(color, colors[i], p);
                 }
              #endif

               float lalpha = alpha * color.a * mask;
               calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
			   accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
			   
               return color.rgb;
			}`,[vm.Nodes.vectorLinearWorldSpaceDepth,vm.Nodes.vectorLinearObjectSpaceDepth,vm.Nodes.vectorSphericalObjectSpaceDepth,vm.Nodes.vectorSphericalWorldSpaceDepth]);if(e.isShader("fragment")){e.define(`${i}_MAX_COLORS`,this.colors.value.length),this.smooth.value&&e.define(`${i}_SMOOTH`),this.isVector.value>.5&&e.define(`${i}_IS_VECTOR`),this.gradientType.value===0&&e.define(`${i}_LINEAR`),this.isWorldSpace.value>.5&&e.define(`${i}_WORLDSPACE`),e.require("worldPosition"),e.addFragmentVariable(this.calpha,"float");let r=e.include(n),s=[];return s.push(this.near.build(e,"f")),s.push(this.far.build(e,"f")),s.push(this.origin.build(e,"v3")),s.push(this.direction.build(e,"v3")),s.push(this.colors.build(e,"v4[]")),s.push(this.steps.build(e,"f[]")),s.push(this.isMask.build(e,"b")),s.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),s.push(this.alpha.build(e,"f")),s.push(this.calpha),e.format(r+"("+s.join(",")+")",this.getType(e),t)}else return console.warn("DepthNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},fF=vm;fF.Nodes=function(){let e=new Xe(`float vectorLinearWorldSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(vWPosition.x - origin.x) + n.y*(vWPosition.y - origin.y) + n.z*(vWPosition.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),t=new Xe(`float vectorLinearObjectSpaceDepth(vec3 direction, vec3 origin, float near, float far) {
               vec3 n = normalize(direction);
               float dist = (n.x*(position.x - origin.x) + n.y*(position.y - origin.y) + n.z*(position.z - origin.z));
               return ( dist - near ) / ( far - near );
            }`),i=new Xe(`float vectorSphericalWorldSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(vWPosition - origin);
               return ( dist - near ) / ( far - near );
            }`),n=new Xe(`float vectorSphericalObjectSpaceDepth(vec3 origin, float near, float far) {
               float dist = length(position - origin);
               return ( dist - near ) / ( far - near );
            }`);return{vectorLinearWorldSpaceDepth:e,vectorLinearObjectSpaceDepth:t,vectorSphericalWorldSpaceDepth:i,vectorSphericalObjectSpaceDepth:n}}();var Gfe=class extends Jt{constructor(e,t,i,n,r,s,a,o){super("v3"),this.nodeType="Fresnel",this.color=e,this.bias=t,this.scale=i,this.intensity=n,this.factor=r,this.isMask=o,this.alpha=s,this.mode=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let i=new Xe(`vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, bool isMask, float mask, float alpha, int mode, out float calpha) {
					float fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWNormal ) ) ), intensity );

					float lalpha = clamp(fresnel, 0.0, 1.0) * alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return color;
				}`),n=e.include(i),r=[];return r.push(this.color.build(e,"c")),r.push(this.bias.build(e,"f")),r.push(this.scale.build(e,"f")),r.push(this.intensity.build(e,"f")),r.push(this.factor.build(e,"f")),r.push(this.isMask.build(e,"b")),r.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.mode.build(e,"i")),r.push(this.calpha),e.format(n+"("+r.join(",")+")",this.getType(e),t)}else return console.warn("FresnelNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},mF=class extends Jt{constructor(e,t,i,n,r,s,a,o,l){super("v3"),this.nodeType="Gradient",this.gradientType=e,this.smooth=t,this.colors=i,this.steps=n,this.offset=r,this.morph=s,this.angle=a,this.isMask=l,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.define("GRAD_MAX",10),e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let i=e.include(mF.Nodes.gradient),n=[];return n.push(this.gradientType.build(e,"i")),n.push(this.smooth.build(e,"b")),n.push(this.colors.build(e,"v4[]")),n.push(this.steps.build(e,"f[]")),n.push(this.offset.build(e,"v2")),n.push(this.morph.build(e,"v2")),n.push(this.angle.build(e,"f")),n.push(this.isMask.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("GradientNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},gF=mF;gF.Nodes=function(){return{gradient:new Xe(`vec3 gradient(int gradientType, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, bool isMask, float mask, float alpha, out float calpha) {
				vec4 color = colors[0];
				vec2 m = morph / vUv.xy;
				vec2 rot = vec2( 0.5 + m.x, m.y );
				vec2 dt = vec2(
					cos( angle ) * rot.x - sin( angle ) * rot.y,
					sin( angle ) * rot.x + cos( angle ) * rot.y
				);
				vec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;
				float t = dot( pt, dt ) / dot( dt, dt );
				if ( gradientType == 1 ) {
					t = distance (
						( vUv + morph ) * 3.0,
						( vUv + offset ) + 1.0
					) + angle;
				} else if ( gradientType == 2 ) {
					float polar = atan(
						vUv.x + morph.x - 0.5 + offset.x,
						vUv.y + morph.y - 0.5 + offset.y
					) * -1.0;
					t = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );
				}

				float p;
				if (smoothed) {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
					}

				} else {
					for ( int i = 1; i < GRAD_MAX; i++ ) {
						p = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );
						color = mix(color, colors[i], p);
					}
				}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
				
				return color.xyz;
			}`)}}();var vF=class extends Jt{constructor(e,t,i,n){super("v3"),this.nodeType="Matcap",this.texture=e,this.isMask=n,this.alpha=t,this.mode=i,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");let i=e.include(vF.Nodes.matcap);e.require("normal"),e.requires.normal=!0;let n=[];return n.push(this.texture.generate(e,"t")),n.push("normal"),n.push(this.isMask.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.mode.build(e,"i")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("MatcapNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},yF=vF;yF.Nodes=function(){return{matcap:new Xe(`vec3 matcap(sampler2D matcapTex, vec3 normal, bool isMask, float mask, float alpha, int mode, out float calpha) {
					vec3 viewDir = normalize( vViewPosition );
					vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
					vec3 y = cross( viewDir, x );
					vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks
					vec4 matcapColor = texture2D( matcapTex, uv );

					float lalpha = alpha * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));
					
					return matcapColor.rgb;
            	}`)}}();var EA=(e=>(e.SIMPLEX="simplex3d",e.SIMPLEX_FRACTAL="simplex3dFractal",e.ASHIMA="simplexAshima",e.FBM="fbm",e.PERLIN="perlin",e.VORONOI="voronoi",e))(EA||{}),Sr=function(){let e=new Xe(`vec3 random3(vec3 c) {
			float j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));
			vec3 r;
			r.z = fract(512.0*j);
			j *= .125;
			r.x = fract(512.0*j);
			j *= .125;
			r.y = fract(512.0*j);
			return r-0.5;
		}`),t=new Xe(`float simplex3d(vec3 p) {
			 vec3 s = floor(p + dot(p, vec3(F3)));
			 vec3 x = p - s + dot(s, vec3(G3));
			 
			 vec3 e = step(vec3(0.0), x - x.yzx);
			 vec3 i1 = e*(1.0 - e.zxy);
			 vec3 i2 = 1.0 - e.zxy*(1.0 - e);
				
			 vec3 x1 = x - i1 + G3;
			 vec3 x2 = x - i2 + 2.0*G3;
			 vec3 x3 = x - 1.0 + 3.0*G3;
			 
			 vec4 w, d;
			 
			 w.x = dot(x, x);
			 w.y = dot(x1, x1);
			 w.z = dot(x2, x2);
			 w.w = dot(x3, x3);
			 
			 w = max(0.6 - w, 0.0);
			 
			 d.x = dot(random3(s), x);
			 d.y = dot(random3(s + i1), x1);
			 d.z = dot(random3(s + i2), x2);
			 d.w = dot(random3(s + 1.0), x3);
			 
			 w *= w;
			 w *= w;
			 d *= w;
			 
			 return dot(d, vec4(52.0));
		}`,[e]);t.keywords.F3=new Yt("float F3 0.3333333"),t.keywords.G3=new Yt("float G3 0.1666667");let i=new Xe(`float simplex3dFractal(vec3 m) {
			mat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);
			mat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);
			mat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);
			return 0.5333333 * simplex3d(m * rot1)
				 + 0.2666667 * simplex3d(2.0 * m * rot2)
				 + 0.1333333 * simplex3d(4.0 * m * rot3)
				 + 0.0666667 * simplex3d(8.0 * m);
		}`,[t]),n=new Xe("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),r=new Xe("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),s=new Xe(`float simplexAshima(vec3 v) {
		  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;
		  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);
		  vec3 i  = floor(v + dot(v, C.yyy) );
		  vec3 x0 =   v - i + dot(i, C.xxx) ;
		  vec3 g = step(x0.yzx, x0.xyz);
		  vec3 l = 1.0 - g;
		  vec3 i1 = min( g.xyz, l.zxy );
		  vec3 i2 = max( g.xyz, l.zxy );
		  vec3 x1 = x0 - i1 + 1.0 * C.xxx;
		  vec3 x2 = x0 - i2 + 2.0 * C.xxx;
		  vec3 x3 = x0 - 1. + 3.0 * C.xxx;
		  i = mod(i, 289.0 ); 
		  vec4 p = permute( permute( permute( 
					 i.z + vec4(0.0, i1.z, i2.z, 1.0 ))
				   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) 
				   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));
		  float n_ = 1.0/7.0; // N=7
		  vec3  ns = n_ * D.wyz - D.xzx;
		  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)
		  vec4 x_ = floor(j * ns.z);
		  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)
		  vec4 x = x_ *ns.x + ns.yyyy;
		  vec4 y = y_ *ns.x + ns.yyyy;
		  vec4 h = 1.0 - abs(x) - abs(y);
		  vec4 b0 = vec4( x.xy, y.xy );
		  vec4 b1 = vec4( x.zw, y.zw );
		  vec4 s0 = floor(b0)*2.0 + 1.0;
		  vec4 s1 = floor(b1)*2.0 + 1.0;
		  vec4 sh = -step(h, vec4(0.0));
		  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;
		  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;
		  vec3 p0 = vec3(a0.xy,h.x);
		  vec3 p1 = vec3(a0.zw,h.y);
		  vec3 p2 = vec3(a1.xy,h.z);
		  vec3 p3 = vec3(a1.zw,h.w);
		  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));
		  p0 *= norm.x;
		  p1 *= norm.y;
		  p2 *= norm.z;
		  p3 *= norm.w;
		  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);
		  m = m * m;
		  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), 
										dot(p2,x2), dot(p3,x3) ) );
		}`,[n,r]),a=new Xe("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),o=new Xe("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[a]),l=new Xe(`float noise(vec3 p){
			vec3 a = floor(p);
			vec3 d = p - a;
			d = d * d * (3.0 - 2.0 * d);
			vec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);
			vec4 k1 = perm(b.xyxy);
			vec4 k2 = perm(k1.xyxy + b.zzww);
			vec4 c = k2 + a.zzzz;
			vec4 k3 = perm(c);
			vec4 k4 = perm(c + 1.0);
			vec4 o1 = fract(k3 * (1.0 / 41.0));
			vec4 o2 = fract(k4 * (1.0 / 41.0));
			vec4 o3 = o2 * d.z + o1 * (1.0 - d.z);
			vec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);
			return o4.y * d.y + o4.x * (1.0 - d.y);
		}`,[o]),c=new Xe(`float fbm(vec3 x) {
			float v = 0.0;
			float a = 0.5;
			vec3 shift = vec3(100);
			for (int i = 0; i < NUM_OCTAVES; ++i) {
				v += a * noise(x);
				x = x * 2.0 + shift;
				a *= 0.5;
			}
			return v;
		}`,[l]);c.keywords.NUM_OCTAVES=new Yt("int NUM_OCTAVES 5");let u=new Xe("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}"),h=new Xe(`float perlin(vec3 P){
		  vec3 Pi0 = floor(P);
		  vec3 Pi1 = Pi0 + vec3(1.0);
		  Pi0 = mod(Pi0, 289.0);
		  Pi1 = mod(Pi1, 289.0);
		  vec3 Pf0 = fract(P);
		  vec3 Pf1 = Pf0 - vec3(1.0);
		  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
		  vec4 iy = vec4(Pi0.yy, Pi1.yy);
		  vec4 iz0 = Pi0.zzzz;
		  vec4 iz1 = Pi1.zzzz;
		  vec4 ixy = permute(permute(ix) + iy);
		  vec4 ixy0 = permute(ixy + iz0);
		  vec4 ixy1 = permute(ixy + iz1);
		  vec4 gx0 = ixy0 / 7.0;
		  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;
		  gx0 = fract(gx0);
		  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
		  vec4 sz0 = step(gz0, vec4(0.0));
		  gx0 -= sz0 * (step(0.0, gx0) - 0.5);
		  gy0 -= sz0 * (step(0.0, gy0) - 0.5);
		  vec4 gx1 = ixy1 / 7.0;
		  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;
		  gx1 = fract(gx1);
		  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
		  vec4 sz1 = step(gz1, vec4(0.0));
		  gx1 -= sz1 * (step(0.0, gx1) - 0.5);
		  gy1 -= sz1 * (step(0.0, gy1) - 0.5);
		  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);
		  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);
		  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);
		  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);
		  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);
		  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);
		  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);
		  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);
		  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
		  g000 *= norm0.x;
		  g010 *= norm0.y;
		  g100 *= norm0.z;
		  g110 *= norm0.w;
		  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
		  g001 *= norm1.x;
		  g011 *= norm1.y;
		  g101 *= norm1.z;
		  g111 *= norm1.w;
		  float n000 = dot(g000, Pf0);
		  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
		  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
		  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
		  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
		  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
		  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
		  float n111 = dot(g111, Pf1);
		  vec3 fade_xyz = fade(Pf0);
		  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
		  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
		  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); 
		  return 2.2 * n_xyz;
		}`,[n,r,u]),d=new Xe(`float hashwithoutsine13(vec3 p3)
		{
			p3  = fract(p3 * .1031);
			p3 += dot(p3, p3.yzx + 33.33);
			return fract((p3.x + p3.y) * p3.z);
		}`),p=new Xe(`vec3 hashwithoutsine33(vec3 p3)
		{
			p3 = fract(p3 * vec3(.1031, .1030, .0973));
			p3 += dot(p3, p3.yxz+33.33);
			return fract((p3.xxy + p3.yxx)*p3.zyx);
		}`),f=new Xe(`float metric(in vec3 p)
		{
			// L2 
			return length(p);

			// Chebyshev 
			// vec3 a = abs(p);
			// return max(a.x, max(a.y, a.z));
		}`),v=new Xe(`float smin( float a, float b, float k )
		{
			float h = smoothstep(0.0, 1.0, 0.5 + 0.5 * (b - a) / k);
			float correction = k * h * (1.0 - h);
			return mix(b, a, h) - correction;
		}`),m=new Xe(`float smax( float a, float b, float k )
		{
			float h = smoothstep(1.0, 0.0, 0.5 + 0.5 * (a - b) / k);
			float correction = k * h * (1.0 - h);
			return mix(a, b, h) + correction;
		}`),g=new Xe(`float remap(float value, float input_min, float input_max, float output_min, float output_max) {
			// Compute width of each interval
			float input_width = input_max - input_min;
			float output_width = output_max - output_min;
		
			// Convert input range into a 0-1 range 
			float scaled = (value - input_min) / input_width;
		
			// Convert the 0-1 range into a value in output range
			return output_min + (scaled * output_width);
		}`),y=new Xe(`float voronoi(in vec3 x, in int style, in float smoothness, in float seed, in int quality) 
		{
			// Integer and fractional parts of this point's coordinates
			ivec3 p = ivec3(floor(x));
			vec3 f = fract(x);

			// Different variables that we will use to construct noise:
			//
			// f1: distance to the closest feature point
			// f2: distance to the second closest feature point
			// e: distance to the closest edge (cell boundary)
			//
			// We also compute "smooth" versions of all of the above quantites, essentially
			// replacing "hard" minimums with "smooth" minimums (described by IQ)
			float f1_smooth = 8.0;
			float f1 = 8.0;
			float f2_smooth = 8.0;
			float f2 = 8.0;
			float e_smooth = 8.0;
			float e = 8.0;

			// Variables stored from closest cell
			ivec3 mb;
			vec3 mr; 

			int steps = quality;
			
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				ivec3 b = ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d = length(r);
				
				f1_smooth = smin(d, f1_smooth, smoothness);

				// Store un-smoothed distances too 
				if (d < f1) 
				{
					f2 = f1;
					f1 = d;

					mb = ivec3(x, y, z);
					mr = r;
				} 
				else if (d < f2) 
				{
					f2 = d;
				}
			}	
			
			float id = hashwithoutsine13(vec3(p + mb) + seed);

			// Second pass for edge distance  
			for (int x = -steps; x <= steps; x++) 
			for (int y = -steps; y <= steps; y++)
			for (int z = -steps; z <= steps; z++)
			{
				// Start search at the cell that contains the closest point to "x" (found in 1st pass)
				ivec3 b = mb + ivec3(x, y, z);
				vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
				float d1 = dot(0.5 * (mr + r), (r - mr)); 				// IQ normalizes "r - mr" but that breaks things for the smooth version?
				float d2 = dot(0.5 * (mr + r), normalize(r - mr));

				e_smooth = smin(d1, e_smooth, smoothness);

				e = min(e, d2);

				// Also compute a smooth version of F2 in this pass
				{
					ivec3 b = ivec3(x, y, z);
					if (b != mb) 
					{
						vec3 r = vec3(b) + hashwithoutsine33(vec3(p + b) + seed) - f;
						float d = length(r);

						f2_smooth = smin(d, f2_smooth, smoothness);
					}
				}
			}

			// Different visualization modes 
			if (style == 0) 
			{
				return f1_smooth;
			}
			if (style == 1) 
			{
				return f2_smooth;
			}
			if (style == 2) 
			{
				return f2_smooth - f1_smooth;
				
				// "Pebbles" also cool
				//return step(0.2, f2_smooth - f1_smooth);
			}
			if (style == 3) 
			{
				// This one is really good for rock / stone effects
				float a = f1; 
				float b = f2;
				float k = 3.0;
				float h = max(k - abs(a - b), 0.0) / k;
				float final = min(a, b) - h * h * k * (1.0 / 4.0);
				return final;
			}
			if (style == 4) 
			{
				// Some random adjustments to make this style stand out more 
				return exp(5.0 * e_smooth);
			}
			if (style == 5) 
			{
				return pow(f1_smooth, 3.0);
			}
			if (style == 6) 
			{				
				const float eps = 0.0125;

				// Thicker lines as the user increases the smoothness slider
				float thickness = smoothness * 0.25 + eps;

				// Blurrier lines as the user increases the smoothness slider
				float blur = pow(smoothness, 3.0) * 0.25 + eps;

				return smoothstep(
					thickness - thickness * blur, 
					thickness + thickness * blur, 
					e
				);
			}
			if (style == 7) 
			{
				return hashwithoutsine13(vec3(p + mb) + seed);
			}
		}
	`,[d,p,f,v,m,g]);return{simplex:t,simplexFractal:i,simplexAshima:s,fbm:c,perlin:h,voronoi:y}}(),xF=class extends Jt{constructor(e,t,i,n,r,s,a,o,l,c,u,h,d,p,f,v,m,g,y){super("v3"),this.nodeType="Noise",this.scale=e,this.size=t,this.move=i,this.fA=n,this.fB=r,this.distortion=s,this.colorA=a,this.colorB=o,this.colorC=l,this.colorD=c,this.noiseType=h,this.voronoiStyle=p,this.highCut=f,this.lowCut=v,this.smoothness=m,this.seed=g,this.quality=y,this.isMask=d,this.alpha=u,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t,i,n,r){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let s=Object.values(EA)[this.noiseType.value],a=s=="voronoi"?`
		float v = ${s}(st + move, voronoiStyle, smoothness, seed, quality);

		// Apply clipping to colors
		v = remap(v, lowCut, highCut, 0.0, 1.0);
		v = smax(v, 0.0, smoothness * 0.25);
		v = smin(v, 1.0, smoothness * 0.25);

		// Note that the voronoi mode only uses colors "A" and "C" from the UI 
		vec4 color = mix(colorA, colorC, v); 
		`:`
		vec3 q = vec3(${s}(st),
					   ${s}(st + vec3(1.0)),
					   ${s}(st + vec3(1.0)));
		vec3 r = vec3(${s}(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),
					  ${s}(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), 
					  ${s}(st * q));
		float f = ${s}(st + r);
		vec4 color;
		color = mix(colorA, colorB, clamp((f * f) * 4.0, 0.0, 1.0));
		color = mix(color, colorC, clamp(length(q), 0.0, 1.0));
		color = mix(color, colorD, clamp(length(r.x), 0.0, 1.0));
		`,o=new Xe(`vec3 ${s}customNoise(float scale, vec3 size, float move, vec2 fA, vec2 fB, vec2 distortion, vec4 colorA, vec4 colorB, vec4 colorC, vec4 colorD, int voronoiStyle, float highCut, float lowCut, float smoothness, float seed, int quality, bool isMask, float mask, float alpha, out float calpha) 
			{
                // Prevent scale of zero 
				scale = max(abs(scale), 0.001);

				vec3 st = position / size;
				st /= scale;

				${a}

				float lalpha = alpha * color.a * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return clamp(color, 0.0, 1.0).rgb;
			}`,[Sr.simplex,Sr.simplexFractal,Sr.simplexAshima,Sr.fbm,Sr.perlin,Sr.voronoi]),l=e.include(o),c=[];return c.push(this.scale.build(e,"f")),c.push(this.size.build(e,"v3")),c.push(this.move.build(e,"f")),c.push(this.fA.build(e,"v2")),c.push(this.fB.build(e,"v2")),c.push(this.distortion.build(e,"v2")),c.push(this.colorA.build(e,"v4")),c.push(this.colorB.build(e,"v4")),c.push(this.colorC.build(e,"v4")),c.push(this.colorD.build(e,"v4")),c.push(this.voronoiStyle.build(e,"i")),c.push(this.highCut.build(e,"f")),c.push(this.lowCut.build(e,"f")),c.push(this.smoothness.build(e,"f")),c.push(this.seed.build(e,"f")),c.push(this.quality.build(e,"i")),c.push(this.isMask.build(e,"b")),c.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),c.push(this.alpha.build(e,"f")),c.push(this.calpha),e.format(l+"("+c.join(",")+")",this.getType(e),t)}};xF.numOctaves=5;var _F=class extends Jt{constructor(e,t,i,n,r,s,a,o,l,c,u,h,d,p,f,v){super("v3"),this.nodeType="Outline",this.firstTime=!0,this.outlineColor=e,this.contourColor=t,this.outlineWidth=i,this.contourWidth=n,this.contourThreshold=r,this.outlineThreshold=s,this.contourFrequency=a,this.outlineSmoothing=o,this.contourDirection=l,this.positionalLines=c,this.compensation=u,this.resolution=h,this.normalMap=d,this.depthMap=p,this.pixelRatio=f,this.alpha=v,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){let i=`g${this.uuid.toString().replace(/-/g,"")}`;if(e.require("vWorldViewDir"),e.require("worldNormal"),e.extensions.derivatives=!0,this.compensation.value&&e.define("OUTLINE_COMPENSATION",`${i}_offset`),this.firstTime){let n=this.outlineWidth.build(e,"f"),r=this.resolution.build(e,"v2"),s=this.compensation.build(e,"b"),a=this.pixelRatio.build(e,"f");e.addVertexParsVariable("randomColor","attribute vec3"),e.addVertexParsVariable("extrudeNormal","attribute vec3"),e.addVertexParsVariable(n,"uniform float"),e.addVertexParsVariable(r,"uniform vec2"),e.addVertexParsVariable(s,"uniform bool"),e.addVertexParsVariable(a,"uniform float"),e.addVertexParsVariable("vID","flat out float"),e.addFragmentParsVariable("vID","flat in float"),e.addVertexFinalCode(`
                vID = randomColor.r;
                vec2 ${i}_offset = vec2(0.0);
                if (${s}) {
                    vec4 ${i}_clipPosition = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));
                    // NOTE: For certain shapes, like spheres, we get incorrect extrusion when the
                    // normals face the camera directly. So we hackily fix this by offsetting the normal
                    // by a tiny amount.
                    vec3 ${i}_clipNormal = mat3(projectionMatrix) * (mat3(modelViewMatrix) * extrudeNormal) + 0.0000001;
                    ${i}_offset = normalize(${i}_clipNormal.xy) / ${r} * (${n} / 2.0) * ${i}_clipPosition.w * 2.0 * ${a};
                    ${i}_clipPosition.xy += ${i}_offset;
                    // TODO(MAX): To handle multiple outline layers, we only want to extrude
                    // if this offset is the biggest of all the potential offsets
                    gl_Position = ${i}_clipPosition;
                }
            `)}if(e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let n=e.include(_F.Nodes.outline),r=[];return r.push(this.outlineColor.build(e,"c")),r.push(this.contourColor.build(e,"c")),r.push(this.outlineWidth.build(e,"f")),r.push(this.contourWidth.build(e,"f")),r.push(this.contourThreshold.build(e,"f")),r.push(this.outlineThreshold.build(e,"f")),r.push(this.contourFrequency.build(e,"f")),r.push(this.outlineSmoothing.build(e,"f")),r.push(this.contourDirection.build(e,"v3")),r.push(this.positionalLines.build(e,"b")),r.push(this.resolution.build(e,"v2")),r.push(this.normalMap.getTexture(e,"t")),r.push(this.depthMap.getTexture(e,"t")),r.push(this.pixelRatio.build(e,"f")),r.push(this.compensation.build(e,"b")),r.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),r.push(this.alpha.build(e,"f")),r.push(this.calpha),this.firstTime=!this.firstTime,e.format(n+"("+r.join(",")+")",this.getType(e),t)}else return console.warn("OutlineNode is not compatible with "+e.shader+" shader."),""}},bF=_F;bF.Nodes=function(){let e=new Xe(`
float sobelSample(sampler2D t, sampler2D d, vec2 uv, vec2 resolution, float outlineWidth, float pixelRatio)
{
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    vec2 texelSize = (vec2(1.0) / resolution);
    vec2 offsetSize = texelSize * outlineWidth * pixelRatio;

    vec2 uvSamples[9];
    vec4 normalSamples[9];

	uvSamples[0] = uv + vec2( -offsetSize.x, -offsetSize.y) + (vogelDiskSample(0, 9, temporalAngle) * texelSize);
	uvSamples[1] = uv + vec2(0.0, -offsetSize.y) + (vogelDiskSample(1, 9, temporalAngle) * texelSize);
	uvSamples[2] = uv + vec2(  offsetSize.x, -offsetSize.y) + (vogelDiskSample(2, 9, temporalAngle) * texelSize);
	uvSamples[3] = uv + vec2( -offsetSize.x, 0.0) + (vogelDiskSample(3, 9, temporalAngle) * texelSize);
	uvSamples[4] = uv;
	uvSamples[5] = uv + vec2(  offsetSize.x, 0.0) + (vogelDiskSample(5, 9, temporalAngle) * texelSize);
	uvSamples[6] = uv + vec2( -offsetSize.x, offsetSize.y) + (vogelDiskSample(6, 9, temporalAngle) * texelSize);
	uvSamples[7] = uv + vec2(0.0, offsetSize.y) + (vogelDiskSample(7, 9, temporalAngle) * texelSize);
	uvSamples[8] = uv + vec2(  offsetSize.x, offsetSize.y) + (vogelDiskSample(8, 9, temporalAngle) * texelSize);


    normalSamples[0] = texture2D(t, uvSamples[0]);
    normalSamples[1] = texture2D(t, uvSamples[1]);
    normalSamples[2] = texture2D(t, uvSamples[2]);
    normalSamples[3] = texture2D(t, uvSamples[3]);
    normalSamples[4] = texture2D(t, uvSamples[4]);
    normalSamples[5] = texture2D(t, uvSamples[5]);
    normalSamples[6] = texture2D(t, uvSamples[6]);
    normalSamples[7] = texture2D(t, uvSamples[7]);
    normalSamples[8] = texture2D(t, uvSamples[8]);

    float depthBias = 0.0001;
    // TODO(MAX): Can we somehow reduce the number of conditionals here with MATH?!
    if (normalSamples[0].a != vID && normalSamples[0].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[0]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[1].a != vID && normalSamples[1].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[1]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[2].a != vID && normalSamples[2].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[2]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[3].a != vID && normalSamples[3].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[3]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }


    if (normalSamples[4].a != vID && normalSamples[4].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[4]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[5].a != vID && normalSamples[5].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[5]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[6].a != vID && normalSamples[6].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[6]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[7].a != vID && normalSamples[7].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[7]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    if (normalSamples[8].a != vID && normalSamples[8].a != 0.0) {
        float depthAtSample = texture2D(d, uvSamples[8]).r + depthBias;
        if (gl_FragCoord.z > depthAtSample) {
           return 0.0;
        }
    }

    vec3 sobel_edge_h = normalSamples[2].rgb + (2.0*normalSamples[5].rgb) + normalSamples[8].rgb - (normalSamples[0].rgb + (2.0*normalSamples[3].rgb) + normalSamples[6].rgb);
  	vec3 sobel_edge_v = normalSamples[0].rgb + (2.0*normalSamples[1].rgb) + normalSamples[2].rgb - (normalSamples[6].rgb + (2.0*normalSamples[7].rgb) + normalSamples[8].rgb);

    float edgeNormal = sqrt(dot(sobel_edge_h, sobel_edge_h) + dot(sobel_edge_v, sobel_edge_v));
    return edgeNormal;
}
`);return{outline:new Xe(`vec3 outline(vec3 outlineColor, vec3 contourColor, float outlineWidth, float contourWidth, float outlineThreshold, float contourThreshold, float outlineSmoothing, float contourFrequency, vec3 contourDirection, bool positionalLines, vec2 resolution, sampler2D normalMap, sampler2D depthMap, float pixelRatio, bool compensation, float mask, float alpha, out float calpha) {
                vec3 result = outlineColor;
                float resultAlpha = 0.0;

                vec3 N = normalize(vWNormal);
                vec2 nuv = (gl_FragCoord.xy / resolution);
                float sobelSample = compensation ? sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth / 2., pixelRatio) : sobelSample(normalMap, depthMap, nuv, resolution, outlineWidth, pixelRatio);
                resultAlpha = smoothstep(outlineThreshold - outlineSmoothing, outlineThreshold + outlineSmoothing, sobelSample);

                //resultAlpha = 1.0;
                //result = vec3(sobelSample);

                float t = 1.0 - contourThreshold;
                if(positionalLines) {
                    vec3 NDir = position * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float f  = fract(NT * contourFrequency * 0.01);
                    float df = fwidth(NT * contourFrequency);

                    float g = smoothstep(df * (contourWidth * 0.01), df * (contourWidth * 0.01 * 2.0), f);
                    if (g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0;
                    }
                 }
                 else {
                    vec3 NDir = N * contourDirection;
                    float NT = NDir.x + NDir.y + NDir.z;
                    float df = fwidth(NT * contourThreshold);
                    float f = sin(NT * 1.0 * contourFrequency);
                    float g = smoothstep(0.0, df * contourWidth, 1.0 - f);

                    if (df > (t * 0.5) && g < 1.0 && resultAlpha == 0.0) {
                        result = contourColor;
                        resultAlpha = 1.0 - g;
                    }
                 }

                 float lalpha = alpha * resultAlpha * mask;
                 calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
                 accumAlpha += ( 1.0 - accumAlpha ) * lalpha;
				 
                 return result;
             }`,[e])}}();var Bo=class extends Jt{constructor(e,t,i,n,r,s,a,o,l,c,u,h,d,p,f,v,m,g){super("v3"),this.nodeType="Pattern",this.style=e,this.projection=t,this.axis=i,this.blending=n,this.offset=r,this.colorA=s,this.colorB=a,this.frequency=o,this.size=l,this.variation=c,this.smoothness=u,this.zigzag=h,this.rotation=d,this.vertical=p,this.horizontal=f,this.sides=v,this.isMask=g,this.alpha=m,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.isShader("fragment")){e.require("position"),e.require("uv"),e.requires.uv=[!0],e.require("normal"),e.requires.normal=!0,e.addFragmentVariable(this.calpha,"float");let i;switch(this.style.value){case 0:i="circle";break;case 1:i="ring";break;case 2:i="polygon";break;case 3:i="xcross";break;case 4:i="diamond";break;case 5:i="checkerboard";break;case 6:i="line";break;case 7:i="wave";break;default:i="circle";break}let n=`g${this.uuid.toString().replace(/-/g,"")}`,r=new Xe(`float hashwithoutsine12(vec2 p)
				{
					vec3 p3 = fract(vec3(p.xyx) * .1031);
					p3 += dot(p3, p3.yzx + 33.33);
					return fract((p3.x + p3.y) * p3.z);
				}`),s=new Xe(`vec2 rotate_uv(in vec2 uv, float a, bool repeat) 
				{
					const float mid = 0.5;
					float radians = a * (PI / 180.0);
					vec2 rotated = vec2(
						cos(radians) * (uv.x - mid) + sin(radians) * (uv.y - mid) + mid,
						cos(radians) * (uv.y - mid) - sin(radians) * (uv.x - mid) + mid
					);
					return repeat ? fract(rotated): rotated;
				}`),a="";if(this.projection.value===4){let u=this.style.value===2?`${i}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(uv0, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,h=this.style.value===2?`${i}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(uv1, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,d=this.style.value===2?`${i}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(uv2, frequency, size, variation, smoothness_remapped, zigzag, rotation)`;a=`
				vec3 p = position;
				float factor = 0.0125;
				vec2 uv0 = fract(p.xy * factor);
				vec2 uv1 = fract(p.zy * factor);
				vec2 uv2 = fract(p.xz * factor);
				
				uv0 = rotate_uv(uv0 + offset, rotation, true);
				uv1 = rotate_uv(uv1 + offset, rotation, true);
				uv2 = rotate_uv(uv2 + offset, rotation, true);
	
				float d0 = ${u};
				float d1 = ${h};
				float d2 = ${d};
				
				// Range from 3 to 128 seems to be good
				float exponent = (1.0 - blending) * 125.0 + 3.0;

				vec3 n = vObjectNormal;
				vec3 weights = abs(normalize(n));
				weights = pow(weights, vec3(exponent));
				weights /= dot(weights, vec3(1.0));
				d0 *= weights.z;
				d1 *= weights.x;
				d2 *= weights.y;
				float draw = d0 + d1 + d2;
	
				vec2 custom_uv = uv0 * weights.z + uv1 * weights.x + uv2 * weights.y;
				`}else{let u=this.style.value===2?`${i}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation, sides)`:`${i}(custom_uv, frequency, size, variation, smoothness_remapped, zigzag, rotation)`,h="";this.axis.value===0?h=`float radius = length(p);
					float theta = atan(p.y, p.z);
					float phi = acos(p.x / radius);`:this.axis.value===1?h=`float radius = length(p);
					float theta = atan(p.x, p.z);
					float phi = acos(p.y / radius);`:(this.axis.value,h=`float radius = length(p);
					float theta = atan(p.y, p.x);
					float phi = acos(p.z / radius);`);let d="";switch(this.projection.value){case 0:d="custom_uv = vUv.st;";break;case 1:break;case 2:d=`
							vec3 p = position;
							${h}
							custom_uv = vec2(theta, phi);
							custom_uv /= PI;
							`;break}a=`
				vec2 custom_uv;
				${d}
	
				custom_uv += offset;
				custom_uv = fract(custom_uv);
				custom_uv = rotate_uv(custom_uv, rotation, true);
	
				float draw = ${u};
				`}let o=new Xe(`vec3 ${n}_pattern(vec3 normal, float blending, int style, vec2 offset, vec4 colorA, vec4 colorB, vec2 frequency, float size, float variation, float smoothness, float zigzag, float rotation, vec2 vertical, vec2 horizontal, int sides, bool isMask, float mask, float alpha, out float calpha) {
					const float TWO_PI = PI * 2.0;
					float smoothness_remapped = pow(smoothness, 5.0);	

					${a}

					// Construct final output color
					vec4 color = mix(colorA, colorB, draw);
					color.a = clamp(color.a, 0.0, 1.0);

					// Apply cuts
					color.a *= 
						step(vertical.x, custom_uv.y) * 
						step(custom_uv.y, vertical.y);
					color.a *= 
						step(horizontal.x, abs(custom_uv.x)) * 
						step(abs(custom_uv.x), horizontal.y);

					// Accumulate alpha 
					float lalpha = alpha * clamp(color.a, 0.0, 1.0) * mask;
					calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
					accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

					return clamp(color, 0.0, 1.0).rgb;
				}`,[s,r,Bo.DrawFunctions.circle,Bo.DrawFunctions.ring,Bo.DrawFunctions.polygon,Bo.DrawFunctions.cross,Bo.DrawFunctions.diamond,Bo.DrawFunctions.checkerboard,Bo.DrawFunctions.line,Bo.DrawFunctions.wave]),l=e.include(o),c=[];return c.push("normal"),c.push(this.blending.build(e,"f")),c.push(this.style.build(e,"i")),c.push(this.offset.build(e,"v2")),c.push(this.colorA.build(e,"v4")),c.push(this.colorB.build(e,"v4")),c.push(this.frequency.build(e,"v2")),c.push(this.size.build(e,"f")),c.push(this.variation.build(e,"f")),c.push(this.smoothness.build(e,"f")),c.push(this.zigzag.build(e,"f")),c.push(this.rotation.build(e,"f")),c.push(this.vertical.build(e,"v2")),c.push(this.horizontal.build(e,"v2")),c.push(this.sides.build(e,"i")),c.push(this.isMask.build(e,"b")),c.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),c.push(this.alpha.build(e,"f")),c.push(this.calpha),e.format(l+"("+c.join(",")+")",this.getType(e),t)}else return console.warn("PatterNode is not compatible with "+e.shader+" shader."),e.format("vec3(0.0)",this.getType(e),t)}},wF=Bo;wF.DrawFunctions=function(){let e=new Xe(`float hashwithoutsine12(vec2 p) {
				vec3 p3 = fract(vec3(p.xyx) * 0.1031);
				p3 += dot(p3, p3.yzx + 33.33);
				return fract((p3.x + p3.y) * p3.z);
			}`),t=new Xe(`vec2 tile_and_center(in vec2 uv, in vec2 frequency, in float variation, in float zigzag, in float rotation) {
                // Create tiles in UV-space
                uv *= frequency;

                // Integer coords
                vec2 i = floor(uv);

                // Offset every other row based on zigzag param, then compute fractional coords
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = fract(uv);

				// Rotate the tile itself:
				// const float mid = 0.5;
				// f = vec2(
				// 	cos(rotation) * (f.x - mid) + sin(rotation) * (f.y - mid) + mid,
				// 	cos(rotation) * (f.y - mid) - sin(rotation) * (f.x - mid) + mid
				// );
				// f = fract(f);

                f = f * 2.0 - 1.0;

				// Recompute integer coords after shifting - then, random value per tile 
				i = floor(uv);
				float rand = (hashwithoutsine12(i) * 5.0 + 1.0);
				float jitter = mix(1.0, rand, variation);
				f *= jitter;

                return f;
            }`,[e]),i=new Xe(`float circle(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(
                    -smoothness, 
                     smoothness, 
                     length(f) - size
                );
            }`,[t]),n=new Xe(`float ring(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);

				float d = length(f);
                const float inner_width = 0.5;

                float outer = smoothstep(-smoothness, smoothness, d - size);
                float inner = smoothstep(-smoothness, smoothness, d - size * inner_width);
				return outer + (1.0 - inner);   
            }`,[t]),r=new Xe(`float sdf_ngon(in vec2 p, in float r, in int n) {
                float an = (PI * 2.0) / float(n);
                float he = r * tan(0.5 * an);
                
                // Rotate to first sector
                p = -p.yx; 
                float bn = an * floor((atan(p.y, p.x) + 0.5 * an) / an);
                vec2  cs = vec2(cos(bn), sin(bn));
                p = mat2(cs.x, -cs.y, cs.y, cs.x)*p;
            
                // Side of polygon
                return length(p - vec2(r, clamp(p.y, -he, he))) * sign(p.x - r);
            }
            
            float polygon(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation, in int sides) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_ngon(f, size, sides));
            }`,[t]),s=new Xe(`float sdf_cross(in vec2 p, in vec2 b, float r ) {
                p = abs(p); 
				p = (p.y > p.x) ? p.yx : p.xy;
                vec2  q = p - b;
                float k = max(q.y, q.x);
                vec2  w = (k > 0.0) ? q : vec2(b.y - p.x, -k);
                return sign(k) * length(max(w, 0.0)) + r;
            }
            
            // Avoid namespace conflicts 
            float xcross(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
                return smoothstep(-smoothness, smoothness, sdf_cross(f, vec2(size, size * 0.25), smoothness));
            }`,[t]),a=new Xe(`float ndot(vec2 a, vec2 b) { 
                return a.x*b.x - a.y*b.y; 
            }
            
            float sdf_diamond(in vec2 p, in vec2 b) {
                p = abs(p);
                float h = clamp(ndot(b - 2.0 * p, b) / dot(b, b), -1.0, 1.0);
                float d = length(p - 0.5 * b * vec2(1.0 - h, 1.0 + h));
                return d * sign(p.x * b.y + p.y * b.x - b.x * b.y);
            }

            float diamond(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, variation, zigzag, rotation);
	            return smoothstep(-smoothness, smoothness, sdf_diamond(f, vec2(size)));
            }`,[t]),o=new Xe(`float checkerboard(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                uv *= frequency;
                vec2 i = floor(uv);

                float offset = mod(i.y, 2.0);

                uv.x += offset + zigzag * offset;
                float x = floor(uv.x);
                
                return mod(x, 2.0);
            }`),l=new Xe(`float line(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                vec2 f = tile_and_center(uv, frequency, 0.0, zigzag, rotation);
				
				// Different approach for variation param here
				float row = floor(uv * frequency).y;
				float rand = hashwithoutsine12(vec2(row));
				float s = mix(size, size * rand, variation);

				return smoothstep(
					s - smoothness, 
					s + smoothness, 
					abs(f.y)
				);
            }`,[t]),c=new Xe(`// Uses bisection 
            float udf_cos(in vec2 p, in float a, in float b, in float c, in float d) {
                // Convert all data to a primitive cosine wave
                p = c * (p - vec2(d, a));
                
                const float TWO_PI = PI * 2.0;

                // Reduce to principal half cycle
                p.x = mod(p.x, TWO_PI); 
                if (p.x > PI) {
                    p.x = TWO_PI - p.x;
                }
            
                // Find zero of derivative (minimize distance)
                float xa = 0.0;
                float xb = TWO_PI;

                // 24 bit precision
                for (int i = 0; i < 24; i++) {
                    float x = 0.5 * (xa + xb);
                    float y = x - p.x + b * c * sin(x) * (p.y - b * c * cos(x));
                    if (y < 0.0) xa = x; 
                    else xb = x;
                }
                float x = 0.5 * (xa + xb);
                
                // Compute distance    
                vec2 q = vec2(x, b * c * cos(x));
                return length(p - q) / c;
            }

            float wave(in vec2 uv, in vec2 frequency, in float size, in float variation, in float smoothness, in float zigzag, in float rotation) {
                float repeat = frequency.x;
                uv *= repeat;
                vec2 i = floor(uv);
                float row_offset = mod(i.y, 2.0);
                uv.x += row_offset * zigzag;
                vec2 f = vec2(uv.x, fract(uv.y));

                // Generalized cosine: y(x) = a + b * cos(cx + d)
                const float amplitude = 0.125;
                float wave_frequency = frequency.y * 0.1;
                float distance_estimate = udf_cos(f, 0.50, amplitude, wave_frequency * (2.0 * PI), 0.0);

				// Different approach for variation param here
				float rand = hashwithoutsine12(vec2(i.y));
				float s = mix(size, size * rand, variation);

                return smoothstep(-smoothness, smoothness, distance_estimate - s * 0.5);
            }`);return{tileAndCenter:t,circle:i,ring:n,polygon:r,cross:s,diamond:a,checkerboard:o,line:l,wave:c}}();var SF=class extends Jt{constructor(e,t,i,n,r,s,a,o){super("v3"),this.nodeType="Rainbow",this.filmThickness=e,this.movement=t,this.wavelengths=i,this.noiseStrength=n,this.noiseScale=r,this.offset=s,this.isMask=o,this.alpha=a,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("vWorldViewDir"),e.require("worldNormal"),e.isShader("fragment")){e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");let i=e.include(SF.Nodes.rainbow),n=[];return n.push(this.filmThickness.build(e,"f")),n.push(this.movement.build(e,"f")),n.push(this.wavelengths.build(e,"v3")),n.push(this.noiseStrength.build(e,"f")),n.push(this.noiseScale.build(e,"f")),n.push(this.offset.build(e,"v3")),n.push(this.isMask.build(e,"b")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("RainbowNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},MF=SF;MF.Nodes=function(){let e=new Xe(`vec3 attenuation(vec3 wavelengths, float filmThickness, float movement, float noiseStrength, float noiseScale, vec3 offset) {
                 vec3 st = position / noiseScale;
				 vec3 q = vec3(simplex3d(st),
							  simplex3d(st + vec3(1.0)),
							  simplex3d(st + vec3(1.0)));

				 vec3 r = vec3(simplex3d(st + vec3(1.4, 1.3, 1.0) * q + vec3(1.7, 9.2, 1.0)),
							  simplex3d(st + vec3(2.0, 1.2, 1.0) * q + vec3(8.3, 2.8, 1.0)),
							  simplex3d(st * q));

                 float noise = simplex3d(st + r);

                 return .5 + .5 * cos((((filmThickness + (noise * noiseStrength)) / (vec3(wavelengths.r * 1.0, wavelengths.g * 0.8, wavelengths.b * 0.6) + 1.0)) * dot(normalize(vWorldViewDir + (offset * -0.001)), normalize(vWNormal))) + movement);
             }`,[Sr.simplex]);return{rainbow:new Xe(`vec3 rainbow(float filmThickness, float movement, vec3 wavelengths, float noiseStrength, float noiseScale, vec3 offset, bool isMask, float mask, float alpha, out float calpha) {
				vec3 res = clamp(attenuation(wavelengths, filmThickness, movement, noiseStrength, noiseScale, offset), 0.0, 2.0);

				float rainbowContribution = clamp(res.r + res.g + res.b, 0.0, 1.0);

				float lalpha = alpha * rainbowContribution * mask;
				calpha = mix(lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0), lalpha, float(isMask));
				accumAlpha += (1.0 - accumAlpha) * lalpha * (1.0 - float(isMask));

				return res;
             }`,[e])}}();var CF=class extends Jt{constructor(e,t,i,n,r,s,a,o,l,c){super("v3"),this.nodeType="Toon",this.positioning=e,this.colors=t,this.steps=i,this.source=n,this.isWorldSpace=r,this.noiseStrength=s,this.noiseScale=a,this.shadowColor=o,this.offset=l,this.alpha=c,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.require("worldNormal"),e.require("worldPosition"),e.isShader("fragment")){e.define("COLORS_MAX",10),e.addFragmentVariable(this.calpha,"float");let i=e.include(CF.Nodes.toon),n=[];return n.push(this.positioning.build(e,"i")),n.push(this.colors.build(e,"v4[]")),n.push(this.steps.build(e,"f[]")),n.push(this.source.build(e,"v3")),n.push(this.isWorldSpace.build(e,"b")),n.push(this.noiseStrength.build(e,"f")),n.push(this.noiseScale.build(e,"f")),n.push(this.shadowColor.build(e,"v4")),n.push(this.offset.build(e,"v3")),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("ToonNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},EF=CF;EF.Nodes=function(){let e=new Xe(`float rand(float n) {
				return fract(sin(n) * 43758.5453123);
			}`),t=new Xe(`float hash1(float p) { 
				p = fract(p * 0.011); 
				p *= p + 7.5; 
				p *= p + p; 
				return fract(p); 
			}`),i=new Xe(`float valueNoise(vec3 x) {
				const vec3 step = vec3(110, 241, 171);
			
				vec3 i = floor(x);
				vec3 f = fract(x);
			 
				// For performance, compute the base input to a 1D hash from the integer part of the argument and the 
				// incremental change to the 1D based on the 3D -> 1D wrapping
				float n = dot(i, step);
			
				vec3 u = f * f * (3.0 - 2.0 * f);
				return mix(mix(mix( hash1(n + dot(step, vec3(0, 0, 0))), hash1(n + dot(step, vec3(1, 0, 0))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 0))), hash1(n + dot(step, vec3(1, 1, 0))), u.x), u.y),
						   mix(mix( hash1(n + dot(step, vec3(0, 0, 1))), hash1(n + dot(step, vec3(1, 0, 1))), u.x),
							   mix( hash1(n + dot(step, vec3(0, 1, 1))), hash1(n + dot(step, vec3(1, 1, 1))), u.x), u.y), u.z);
			}`,[t]),n=new Xe(`vec3 hash3(vec3 x) {
				x = vec3(dot(x,vec3(127.1, 311.7, 74.7)),
						 dot(x,vec3(269.5, 183.3, 246.1)),
						 dot(x,vec3(113.5, 271.9, 124.6)));
			
				return fract(sin(x)*43758.5453123);
			}`),r=new Xe(`vec3 voronoiNoise(in vec3 x)
			{
				vec3 p = floor(x);
				vec3 f = fract(x);

				float id = 0.0;
				vec2 res = vec2(100.0);

				for(int k=-1; k<=1; k++)
				for(int j=-1; j<=1; j++)
				for(int i=-1; i<=1; i++)
				{
					vec3 b = vec3(float(i), float(j), float(k));

					// Comment out the "+ hash(p + b);" part below to get "square" cells
					vec3 r = vec3(b) - f + hash3(p + b);
					float d = dot(r, r);

					if (d < res.x)
					{
						id = dot(p + b, vec3(1.0, 57.0, 113.0));
						res = vec2(d, res.x);			
					}
					else if (d < res.y)
					{
						res.y = d;
					}
				}

				return vec3(sqrt(res), abs(id));
			}
			`,[n]);return{toon:new Xe(`vec3 toon(int positioning, vec4 colors[COLORS_MAX], float steps[COLORS_MAX], vec3 source, bool isWorldSpace, float noiseStrength, float noiseScale, vec4 shadowColor, vec3 offset, float mask, float alpha, out float calpha) {
				float t = 0.0;
				float shadow = 1.0;

				if (positioning == 0) {

					// Can't do this mode if lighting is "none"
					#if (defined(PHONG) || defined(LAMBERT) || defined(STANDARD))

						// Algorithm from Chapter 10 of Graphics Shaders
						const vec3 weights = vec3(0.2125, 0.7154, 0.0721);
						vec3 lpos;
						vec3 l;
						float dproduct;

						#if (NUM_POINT_LIGHTS > 0)

							#if defined(USE_SHADOWMAP) && (NUM_POINT_LIGHT_SHADOWS > 0)
								PointLightShadow pointLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_POINT_LIGHTS; i++) {
								// Light positions are in view-space for some reason?
								lpos = (inverse(viewMatrix) * vec4(pointLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								
								// TODO: we want to use "intensity" but it isn't available in the shader code
								//dproduct += dot(pointLights[UNROLLED_LOOP_INDEX].color, weights);

								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS)
									pointLightShadow = pointLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getPointShadow( 
											pointShadowMap[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowMapSize, 
											pointLightShadow.shadowBias, 
											pointLightShadow.shadowRadius,
											vPointShadowCoord[UNROLLED_LOOP_INDEX], 
											pointLightShadow.shadowCameraNear, 
											pointLightShadow.shadowCameraFar);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_DIR_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_DIR_LIGHT_SHADOWS > 0)
								DirectionalLightShadow directionalLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_DIR_LIGHTS; i++) {
								// Use the direction vector for directional lights instead
								l = (inverse(viewMatrix) * vec4(directionalLights[UNROLLED_LOOP_INDEX].direction, 0.0)).xyz;
		
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS)
									directionalLightShadow = directionalLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow( 
										UNROLLED_LOOP_INDEX,
										directionalShadowMap[UNROLLED_LOOP_INDEX], 
										directionalLightShadow.shadowMapSize, 
										directionalLightShadow.shadowBias, 
										directionalLightShadow.shadowRadius, 
										vDirectionalShadowCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						#if NUM_SPOT_LIGHTS > 0 
							
							#if defined(USE_SHADOWMAP) && (NUM_SPOT_LIGHT_SHADOWS > 0)
								SpotLightShadow spotLightShadow;
							#endif 

							#pragma unroll_loop_start
							for (int i = 0; i < NUM_SPOT_LIGHTS; i++) {
								lpos = (inverse(viewMatrix) * vec4(spotLights[UNROLLED_LOOP_INDEX].position, 1.0)).xyz;
								l = normalize(lpos - worldPosition);
								
								dproduct = dot(l, normalize(worldNormal)) * 0.5 + 0.5;
								t = max(t, dproduct);

								// Accumulate shadow contribution
								#if defined(USE_SHADOWMAP) && (UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS)
									spotLightShadow = spotLightShadows[UNROLLED_LOOP_INDEX];
									shadow *= getShadow(
										UNROLLED_LOOP_INDEX,
										spotShadowMap[UNROLLED_LOOP_INDEX], 
										spotLightShadow.shadowMapSize, 
										spotLightShadow.shadowBias, 
										spotLightShadow.shadowRadius, 
										vSpotLightCoord[UNROLLED_LOOP_INDEX]);
								#endif
							}
							#pragma unroll_loop_end

						#endif

						t = clamp(t, 0.0, 1.0);
				
					#endif

				} else if (positioning == 1) {
					
					vec3 origin = mix(position, worldPosition, float(isWorldSpace));
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	

				} else {

					vec3 origin = worldPosition;
					vec3 source = cameraPosition - offset;
					vec3 direction = normalize(source - origin);
					t = dot(direction, normalize(worldNormal)) * 0.5 + 0.5;	
					
				}

				if (noiseStrength > 0.0) {
					// Distort with noise
					vec3 st = position / noiseScale;
					
					// Voronoi "smooth" noise
					float noise = 1.0 - voronoiNoise(st).x;

					// Voronoi cellular noise
					//float noise = 1.0 - rand(voronoiNoise(st).z);

					// Position warp noise
					// vec3 offset = vec3(
					// 	simplex3d(st),
					// 	simplex3d(st + vec3(111.1, 143.89, 217.19)),
					// 	simplex3d(st + vec3(171.1, 247.89, 117.23))
					// );
					// st += offset;
					// float noise = valueNoise(st);

					t += noise * noiseStrength;
				}

				t = clamp(t, 0.0, 1.0);

				// Compute ramp color
				float p;
				vec4 color = colors[0];
				for (int i = 1; i < COLORS_MAX; i++) {
					p = clamp((t - steps[i-1]) / (steps[i] - steps[i-1]), 0.0, 1.0);
					color = mix(color, colors[i], smoothstep(0.0, 1.0, p));
				}

				// Incorporate custom shadow color
				if (positioning == 0) {

					vec3 blendedShadow = mix(color.rgb, shadowColor.rgb, shadowColor.a);
					color.rgb = mix(blendedShadow, color.rgb, shadow);
				
				}

				// Accumulate alpha as usual
				float lalpha = alpha * color.a * mask;
				calpha =  lalpha / clamp(lalpha + accumAlpha, 0.00001, 1.0);
				accumAlpha += (1.0 - accumAlpha) * lalpha;

				return color.xyz;

            }`,[Sr.simplex,e,i,r])}}();var jfe=function(){return{textureBicubic:new Xe(`float w0( float a ) {
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
        }
    
        float w1( float a ) {
            return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
        }
    
        float w2( float a ){
            return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
        }
    
        float w3( float a ) {
            return ( 1.0 / 6.0 ) * ( a * a * a );
        }
    
        // g0 and g1 are the two amplitude functions
        float g0( float a ) {
            return w0( a ) + w1( a );
        }
    
        float g1( float a ) {
            return w2( a ) + w3( a );
        }
    
        // h0 and h1 are the two offset functions
        float h0( float a ) {
            return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
        }
    
        float h1( float a ) {
            return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
        }
    
        vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
            uv = uv * texelSize.zw + 0.5;
    
            vec2 iuv = floor( uv );
            vec2 fuv = fract( uv );
    
            float g0x = g0( fuv.x );
            float g1x = g1( fuv.x );
            float h0x = h0( fuv.x );
            float h1x = h1( fuv.x );
            float h0y = h0( fuv.y );
            float h1y = h1( fuv.y );
    
            vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
            vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
            vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
    
            return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) + 
                   g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
        }

        vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
            vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
            vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
            vec2 fLodSizeInv = 1.0 / fLodSize;
            vec2 cLodSizeInv = 1.0 / cLodSize;
            vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
            vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
            return mix( fSample, cSample, fract( lod ) );
        }`)}}();function Wfe(e,t){return e>=t?new te(t/e,1):new te(1,e/t)}var AF=class extends Jt{constructor(e,t,i,n,r,s,a,o){super("v3"),this.nodeType="Transmission",this.thickness=e,this.ior=t,this.roughness=i,this.transmissionSamplerSize=n,this.transmissionSamplerMap=r,this.transmissionDepthMap=s,this.aspectRatio=a,this.alpha=o,this.calpha=`g${this.uuid.toString().replace(/-/g,"")}_calpha`}generate(e,t){if(e.extensions.shaderTextureLOD=!0,e.extensions.derivatives=!0,e.isShader("fragment")){e.define("NUM_SAMPLES",6),e.define("BLUR_SLOD",Math.pow(2,ht.transmissionLod.value)),e.require("worldPosition"),e.requires.worldNormal=!0,e.requires.modelMatrix=!0,e.requires.projectionMatrix=!0,e.addFragmentVariable(this.calpha,"float");let i=e.include(AF.Nodes.transmission),n=[];return n.push(this.thickness.build(e,"f")),n.push(this.ior.build(e,"f")),n.push(this.roughness.build(e,"f")),n.push(this.transmissionSamplerSize.build(e,"v2")),n.push(this.transmissionSamplerMap.getTexture(e,"t")),n.push(this.transmissionDepthMap.getTexture(e,"t")),n.push(this.aspectRatio.build(e,"v2")),n.push("normal"),n.push(this.mask?`luminance(${this.mask.flow(e,"v3").result})`:"1.0"),n.push(this.alpha.build(e,"f")),n.push(this.calpha),e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("TransmissionNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},TF=AF;TF.Nodes=function(){let e=new Xe(`vec3 blur(sampler2D sp, vec2 U, vec2 scale, float lod, sampler2D dm, vec2 unrefractedU, vec2 aspectRatio) {
                // Slightly modified version of this:
                // https://www.shadertoy.com/view/ltScRG

				// Special case for blur == 0.0
				if (lod == 0.0) {
					#ifdef TEXTURE_LOD_EXT
					return texture2DLodEXT( sp, U, 0.0).rgb;
					#else
					return textureLod( sp, U, 0.0).rgb;
					#endif
				}
				
				vec2 texelSize = vec2(1.0) / resolution;
                vec2 halton = haltonSequence[frameIndex];
                float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
                float temporalAngle  = temporalOffset * PI2;
				vec3 res = vec3(0.0);
                vec2 uv = vec2(0.0);
                vec2 offset = vec2(0.0);
                vec2 vogelSample = vec2(0.0);
                for (int i = 0; i < NUM_SAMPLES; i++) {
                    vogelSample =  vogelDiskSample(i, NUM_SAMPLES, temporalAngle) * texelSize;
                    offset = vogelSample * scale * (lod * 10.0); // TODO: used to be hardcoded to 20
                    uv = U + offset;
                    float opaqueDepth = unpackRGBAToDepth(textureLod(dm, uv, lod));
                    if (opaqueDepth != 0.0 && opaqueDepth < gl_FragCoord.z) {
                        uv = unrefractedU;
                        lod = lod > 4.0 ? lod : lod / 2.0;
                    }
                    res += textureLod(sp, uv, lod).rgb;
                }
                return res / float(NUM_SAMPLES);
            }`),t=new Xe(`vec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {
		        // Direction of refracted light.
		        vec3 refractionVector = refract( -v,  n, 1.0 / ior );
		        
				// Compute rotation-independant scaling of the model matrix.
		        vec3 modelScale;
		        modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		        modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		        modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );

		        // The thickness is specified in local space
		        return normalize( refractionVector ) * thickness * modelScale;
	        }`),i=new Xe(`float applyIorToRoughness( float roughness, float ior ) {
				// Scale roughness with IOR so that an IOR of 1.0 results in no microfacet refraction and
				// an IOR of 1.5 results in the default amount of microfacet refraction.
				return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
			}`),n=new Xe(`vec3 getTransmissionSample( vec2 fragCoord, float roughness, float ior, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 unrefractedCoords, vec2 aspectRatio) {
				// Threejs exports do not pass a depth map to this shader, so we have to fallback to the "Threejs method of blurring" - see
				// also the code in convertTransmission.ts, which runs during export
				#ifdef IS_THREEJS_EXPORT
					float lod = log2(transmissionSamplerSize.x) * applyIorToRoughness(roughness / 5.0, ior);
					return textureBicubic(transmissionSamplerMap, fragCoord.xy, lod).rgb;
				#else
					float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
					float lod = applyIorToRoughness(roughness, ior);
					return blur(transmissionSamplerMap, fragCoord, vec2(lod), min(framebufferLod / 5.5, 8.5), transmissionDepthMap, unrefractedCoords, aspectRatio);
				#endif
			}`,[jfe.textureBicubic,i,e]),r=new Xe(`vec3 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;

				// Project refracted vector on the framebuffer, while mapping to normalized device coordinates.
				vec4 ndcPos = projMatrix * viewMatrix *  vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;

				vec4 ndcPosUnrefracted = projMatrix * viewMatrix * vec4(position, 1.0 );
				vec2 unrefractedCoords = ndcPosUnrefracted.xy / ndcPosUnrefracted.w;
				unrefractedCoords += 1.0;
				unrefractedCoords /= 2.0;

				// Sample framebuffer to get pixel the refracted ray hits.
				return getTransmissionSample( refractionCoords, roughness, ior, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, unrefractedCoords, aspectRatio );
    		}`,[n,t]);return{transmission:new Xe(`vec3 transmission(float thickness, float ior, float roughness, vec2 transmissionSamplerSize, sampler2D transmissionSamplerMap, sampler2D transmissionDepthMap, vec2 aspectRatio, vec3 normal, float mask, float alpha, out float calpha) {
                vec3 v = vec3(0.);
                if (isOrthographic) {
                    v = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
                } else {
                    v = normalize(vWPosition - cameraPosition);
                }
                vec3 transmission = getIBLVolumeRefraction(vWNormal, -v, roughness,  vWPosition, modelMatrix, viewMatrix, projectionMatrix, ior, thickness, transmissionSamplerSize, transmissionSamplerMap, transmissionDepthMap, aspectRatio );
                
				float lalpha = alpha * mask;
				calpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );
				accumAlpha += ( 1.0 - accumAlpha ) * alpha;

				return transmission;
            }`,[r])}}();var yM=(e=>(e.NOISE="noise",e.MAP="map",e))(yM||{}),PF=class extends Jt{constructor(e,t,i,n,r,s,a,o,l,c,u){super("v3"),this.displacementTypeIndex=new ni(0),this.nodeType="VertexDisplacement",this.intensity=e,this.movementOrTexture=t,Object.values(yM)[this.displacementTypeIndex.value]==="map"&&(this.mat=new hF(this.movementOrTexture.value.matrix)),this.cropOrOffset=i,this.scale=c,this.noiseFunctionIndex=u,this.voronoiStyle=n,this.smoothness=r,this.seed=s,this.highCut=a,this.lowCut=o,this.quality=l}generate(e,t){if(e.isShader("vertex")){e.define("USE_LAYER_DISPLACE");let i,n=[];switch(n.push("displaced_position"),n.push("displaced_normal"),Object.values(yM)[this.displacementTypeIndex.value]){case"map":{i=e.include(PF.Nodes.map),n.push(this.movementOrTexture.getTexture(e,"t")),n.push("uv"),n.push(this.cropOrOffset.build(e,"f")),this.mat&&n.push(this.mat.build(e,"mat3"));break}case"noise":{let r=Object.values(EA)[this.noiseFunctionIndex.value],s=new Xe(`vec3 orthogonal(vec3 v) {
							return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
						}`),a=r=="voronoi"?`
					float v = ${r}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1), voronoiStyle, smoothness, seed, quality);
					v = remap(v, lowCut, highCut, 0.0, 1.0);
					v = smax(v, 0.0, smoothness * 0.25);
					v = smin(v, 1.0, smoothness * 0.25);

					return p + n * v * intensity;
					`:`
					return p + n * ${r}((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;
					`,o=new Xe(`vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality) {
							${a}
						}`,[Sr.simplex,Sr.simplexFractal,Sr.simplexAshima,Sr.fbm,Sr.perlin,Sr.voronoi]),l=new Xe(`vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, int voronoiStyle, float smoothness, float seed, float highCut, float lowCut, int quality, float intensity, out vec3 displaced_normal) {
							vec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 tangent1 = orthogonal(normal);
							vec3 tangent2 = normalize(cross(normal, tangent1));

                            // TODO(Max): The distance to the neighbors was originally scaled by 0.1.
                            // This caused some small oval/circular visual artifacts in the lighting.
                            // For now, simply using neighbors further away betters the problem,
                            // but we should figure out the underlying cause when we have some time.
                            // Maybe its related to how we calculate the tangent and bitangent?
							vec3 nearby1 = position + tangent1;
							vec3 nearby2 = position + tangent2;
							vec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							vec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement, voronoiStyle, smoothness, seed, highCut, lowCut, quality);
							displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
							return displaced_position;
						}`,[o,s]);i=e.include(l),n.push(this.scale.build(e,"f")),n.push(this.cropOrOffset.build(e,"v3")),n.push(this.movementOrTexture.build(e,"f")),n.push(this.voronoiStyle.build(e,"i")),n.push(this.smoothness.build(e,"f")),n.push(this.seed.build(e,"f")),n.push(this.highCut.build(e,"f")),n.push(this.lowCut.build(e,"f")),n.push(this.quality.build(e,"i"));break}}return n.push(this.intensity.build(e,"f")),n.push("displaced_normal"),e.format(i+"("+n.join(",")+")",this.getType(e),t)}else return console.warn("VertexDisplacementNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},DF=PF;DF.Nodes=function(){let e=new Xe(`vec3 orthogonal(vec3 v) {
				return normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));
			}`),t=new Xe(`float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {
				vec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;
				vec4 tmp = texture2D(tex, uvs);
				vec3 col = tmp.rgb;
				if (crop > 0.5) {
					if ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {
						return 0.0;
					}
				}
				return col.r;
			}`);return{map:new Xe(`vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {
				vec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;
				vec3 tangent1 = normalize(orthogonal(normal));
				vec3 tangent2 = normalize(cross(normal, tangent1));
				vec3 nearby1 = position + tangent1 * 0.1;
				vec3 nearby2 = position + tangent2 * 0.1;
				vec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				vec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;
				displaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));
				return displaced_position;
			}`,[e,t])}}();var ht={normalRenderTarget:new Wo,normalRenderTargetDepth:new Wo,transmissionRenderTarget:new Wo,aspectRatio:new Dn,transmissionSize:new Dn(2048,2048),transmissionRenderTargetDepth:new Wo,aoRenderTarget:new Wo,aoEnabled:new lr,pixelRatioNode:new Ke(1),resolution:new Dn,penumbraSize:new ah(5,.5),frameIndex:new ni(0),transmissionLod:new ni(2)};for(let e of Object.values(ht))e.isRenderGlobal=!0;var LF=class extends Fc{constructor(){super("basic"),this.nodeType="Basic",this.color=new Li(Fs),this.shadingAlpha=new Ke(1),this.shadingBlend=new ni(0),this.previousModelViewMatrix=new oo,this.previouseProjectionMatrix=new oo}get category(){return"phong"}generate(e){let t;if(e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:ht.frameIndex}),e.mergeUniform({resolution:ht.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(Xp.merge([We.fog])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>"].join(`
`));let n=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","	vNormal = transformedNormal;","#endif"),n.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=n.join(`
`)}else{this.color===void 0&&(this.color=new Li(Fs)),this.color.analyze(e,{slot:"color"}),this.alpha&&this.alpha.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"});let i=this.color.flow(e,"c",{slot:"color"}),n=this.alpha?this.alpha.flow(e,"f"):void 0,r=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,s=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0;e.requires.transparent=n!==void 0,e.addParsCode(["varying vec3 vWPosition;","#include <fog_pars_fragment>","#include <dithering_pars_fragment>","varying vec3 vViewPosition;","#include <normal_pars_fragment>"].join(`
`));let a=["#include <normal_fragment_begin>",i.code];n&&a.push(n.code,"#ifdef ALPHATEST"," if ( "+n.result+" <= ALPHATEST ) discard;","#endif"),s?a.push(s.code,`vec3 outgoingLight = ${i.result};`,`vec3 finalColor = spe_blend(outgoingLight, ${s.result}, 1.0, SPE_BLENDING_NORMAL);`):a.push(`vec3 finalColor = ${i.result};`);let o="1.0";this.mask&&(this.mask.analyze(e),o=`luminance(${this.mask.flow(e,"v3").result})`),n?a.push(`gl_FragColor = vec4( finalColor, accumAlpha * ${n.result} * ${o} );`):a.push("gl_FragColor = vec4("+i.result+", 1.0 );"),r&&a.push(`gl_FragColor.a *= ${r.result};`),a.push("#include <fog_fragment>","#include <dithering_fragment>"),t=a.join(`
`)}return t}},Xfe=class extends Fc{constructor(){super("lambert"),this.nodeType="Lambert",this.color=new Li(Fs),this.emissive=new Li(0),this.emissiveIntensity=new Ke(1),this.previousModelViewMatrix=new oo,this.previouseProjectionMatrix=new oo,this.shadingAlpha=new Ke(1),this.shadingBlend=new ni(0),this.occlusion=new lr(!0)}get category(){return"lambert"}build(e){let t;if(e.define("LAMBERT"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:ht.frameIndex}),e.mergeUniform({resolution:ht.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(Xp.merge([We.fog,We.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let n=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>",`
					vec3 diffuse = vec3( 1.0 );
					GeometricContext geometry;
					geometry.position = mvPosition.xyz;
					geometry.normal = normalize( transformedNormal );
					geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
				`),n.push(`
					GeometricContext backGeometry;
					backGeometry.position = geometry.position;
					backGeometry.normal = -geometry.normal;
					backGeometry.viewDir = geometry.viewDir;
					vLightFront = vec3( 0.0 );
					vIndirectFront = vec3( 0.0 );
					#ifdef DOUBLE_SIDED
						vLightBack = vec3( 0.0 );
						vIndirectBack = vec3( 0.0 );
					#endif
					IncidentLight directLight;
					float dotNL;
					vec3 directLightColor_Diffuse;
					vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
					vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
					#ifdef DOUBLE_SIDED
						vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
						vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
					#endif
					#if NUM_POINT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
							getPointLightInfo( pointLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_SPOT_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
							getSpotLightInfo( spotLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_DIR_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
							getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
							dotNL = dot( geometry.normal, directLight.direction );
							directLightColor_Diffuse = directLight.color;
							vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
							#ifdef DOUBLE_SIDED
								vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
							#endif
						}
						#pragma unroll_loop_end
					#endif
					#if NUM_HEMI_LIGHTS > 0
						#pragma unroll_loop_start
						for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
							vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
							#ifdef DOUBLE_SIDED
								vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
							#endif
						}
						#pragma unroll_loop_end
					#endif
				`,"	#include <shadowmap_vertex>","	#include <fog_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=n.join(`
`)}else{e.mergeUniform({penumbraSize:ht.penumbraSize}),e.mergeUniform({frameIndex:ht.frameIndex}),e.mergeUniform({aoMap:ht.aoRenderTarget}),e.mergeUniform({aoEnabled:ht.aoEnabled}),this.color===void 0&&(this.color=new Li(Fs)),this.color.analyze(e,{slot:"color"}),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let i=this.color.flow(e,"c",{slot:"color"}),n=this.emissive.flow(e,"c",{slot:"emissive"}),r=this.emissiveIntensity.flow(e,"f",{slot:"emissive"}),s=this.occlusion.flow(e,"b",{slot:"occlusion"}),a=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,u=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=c!==void 0,e.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vViewPosition;","varying vec3 vWPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef DOUBLE_SIDED","   #define DOUBLE_SIDED","#endif","#include <normal_pars_fragment>","#ifdef DOUBLE_SIDED","	varying vec3 vLightBack;","	varying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <clipping_planes_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let h=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx, viewdy));
				bool isFrontFacing = (dot(normal, faceNormal) >= 0.0);
				`,"#include <clipping_planes_fragment>"];h.push(i.code,"vec3 diffuseColor = "+i.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );"),c&&h.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),h.push("#ifdef DOUBLE_SIDED","	reflectedLight.indirectDiffuse += ( isFrontFacing ) ? vIndirectFront : vIndirectBack;","#else","	reflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );","#ifdef DOUBLE_SIDED","	reflectedLight.directDiffuse = ( isFrontFacing ) ? vLightFront : vLightBack;","#else","	reflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();"),n&&h.push(n.code,"reflectedLight.directDiffuse += "+n.result+" * "+r.result+";"),h.push("vec3 ao = aoEnabled && "+s.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = (reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) ;");let d="1.0";this.mask&&(this.mask.analyze(e),d=`luminance(${this.mask.flow(e,"v3").result})`),h.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${d} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${d}, ${o.result} );

					outgoingLight *= ao;
				}
				`),l&&h.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?h.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result} );`):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u&&h.push(`gl_FragColor.a *= ${u.result};`),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=h.join(`
`)}return t}},Rp=function(){let e=new Xe(`vec2 dHdxy(sampler2D bumpMap, vec2 bumpMapUv, float bumpScale) {

            // Gradient of UVs w.r.t. X coordinate (in screen-space)
            vec2 dSTdx = dFdx(bumpMapUv);

            // Gradient of UVs w.r.t. Y coordinate (in screen-space)
            vec2 dSTdy = dFdy(bumpMapUv);
            
            // Forward differencing
            float Hll = bumpScale * luminance(texture(bumpMap, bumpMapUv).rgb);
            float dBx = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdx).rgb) - Hll;
            float dBy = bumpScale * luminance(texture(bumpMap, bumpMapUv + dSTdy).rgb) - Hll;
            
            return vec2( dBx, dBy );
        }`),t=new Xe(`vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
            vec3 vSigmaX = dFdx( surf_pos.xyz );
            vec3 vSigmaY = dFdy( surf_pos.xyz );
            vec3 vN = surf_norm; // normalized
            
            vN = normalize(vN);

            vec3 R1 = cross( vSigmaY, vN );
            vec3 R2 = cross( vN, vSigmaX );

            R1 = normalize(R1);
            R2 = normalize(R2);
    
            float fDet = dot( vSigmaX, R1 ) * faceDirection;
    
            vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
            return normalize( abs( fDet ) * vN - vGrad );
        }`);return{dHdxy:e,perturbNormalArb:t}}(),qfe=class extends Fc{constructor(){super("phong"),this.nodeType="Phong",this.color=new Li(Fs),this.specular=new Li(1118481),this.shininess=new Ke(30),this.previousModelViewMatrix=new oo,this.previouseProjectionMatrix=new oo,this.shadingAlpha=new Ke(1),this.shadingBlend=new ni(0),this.occlusion=new lr(!0)}get category(){return"phong"}build(e){let t;if(e.define("PHONG"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:ht.frameIndex}),e.mergeUniform({resolution:ht.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(Xp.merge([We.fog,We.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <skinning_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let n=["#include <beginnormal_vertex>",`
				#include <skinbase_vertex>
				#include <skinnormal_vertex>
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif


				vec3 displaced_position = position;
				vec3 displaced_normal = objectNormal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","#include <skinning_vertex>","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("	#include <project_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=n.join(`
`)}else{e.mergeUniform({penumbraSize:ht.penumbraSize}),e.mergeUniform({frameIndex:ht.frameIndex}),e.mergeUniform({aoMap:ht.aoRenderTarget}),e.mergeUniform({aoEnabled:ht.aoEnabled}),this.color===void 0&&(this.color=new Li(Fs)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e);let i=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let n=this.color.flow(e,"c",{slot:"color"}),r=this.specular.flow(e,"c"),s=this.shininess.flow(e,"f"),a=this.shadingAlpha.flow(e,"f"),o=this.shadingBlend.flow(e,"i"),l=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,c=this.alpha?this.alpha.flow(e,"f"):void 0,u=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=c!==void 0,e.addParsCode(["varying vec3 vWPosition;","uniform vec3 emissive;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <dithering_pars_fragment>"].join(`
`));let h=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	BlinnPhongMaterial material;"];if(this.bumpMap){e.include(Rp.dHdxy),e.include(Rp.perturbNormalArb);let p=this.bumpMap.texture.flow(e,"t"),f=this.bumpMap.flow(e,"v3"),v=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",m="";this.bumpMap.projection.value===4?m=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${p.result}, uv0, ${v});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${p.result}, uv1, ${v});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${p.result}, uv2, ${v});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:m=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${p.result}, bumpMapCachedUv, ${v});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,h.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${f.result};
					${m}
					`)}h.push(n.code,"	vec3 diffuseColor = "+n.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","	vec3 totalEmissiveRadiance = emissive;",r.code,"	vec3 specular = "+r.result+";",s.code,"	float shininess = max( 0.0001, "+s.result+" );","	float specularStrength = 1.0;"),c&&h.push(c.code,"#ifdef ALPHATEST","if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),h.push("material.diffuseColor = diffuseColor;"),h.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),h.push("vec3 ao = aoEnabled && "+i.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;");let d="1.0";this.mask&&(this.mask.analyze(e),d=`luminance(${this.mask.flow(e,"v3").result})`),h.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${a.result} * ${d} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${a.result} * ${d}, ${o.result} );
					
					outgoingLight *= ao;
				}
				`),l&&h.push(l.code,`outgoingLight = spe_blend(outgoingLight, ${l.result}, 1.0, SPE_BLENDING_NORMAL);`),c?h.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${c.result});`):h.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),u&&h.push(`gl_FragColor.a *= ${u.result};`),h.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=h.join(`
`)}return t}},Yfe=class extends Fc{constructor(){super("standard"),this.nodeType="Standard",this.color=new Li(Fs),this.roughness=new Ke(.3),this.metalness=new Ke(0),this.reflectivity=new Ke(.5),this.previousModelViewMatrix=new oo,this.previouseProjectionMatrix=new oo,this.shadingAlpha=new Ke(1),this.shadingBlend=new ni(0),this.occlusion=new lr(!0)}get category(){return"physical"}build(e){let t;if(e.define("STANDARD"),e.requires.lights=!0,e.extensions.derivatives=!0,e.extensions.shaderTextureLOD=!0,e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:ht.frameIndex}),e.mergeUniform({resolution:ht.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(Xp.merge([We.fog,We.lights])),We.LTC_1&&(e.uniforms.ltc_1={value:void 0},e.uniforms.ltc_2={value:void 0}),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let n=["#include <beginnormal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#if defined( USE_LAYER_DISPLACE )
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#if !defined( USE_LAYER_DISPLACE )
					#include <begin_vertex>
				#endif /* !USE_LAYER_DISPLACE */
				`];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("#include <project_vertex>","#include <fog_vertex>","#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=n.join(`
`)}else{e.mergeUniform({penumbraSize:ht.penumbraSize}),e.mergeUniform({frameIndex:ht.frameIndex}),e.mergeUniform({aoMap:ht.aoRenderTarget}),e.mergeUniform({aoEnabled:ht.aoEnabled});let i={gamma:!0};this.color===void 0&&(this.color=new Li(Fs)),this.color.analyze(e,{slot:"color",context:i}),this.roughness.analyze(e),this.metalness.analyze(e);let n=this.occlusion.flow(e,"b",{slot:"occlusion"});this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e),this.reflectivity&&this.reflectivity.analyze(e);let r=this.color.flow(e,"c",{slot:"color",context:i}),s=this.roughness.flow(e,"f"),a=this.metalness.flow(e,"f"),o=this.shadingAlpha.flow(e,"f"),l=this.shadingBlend.flow(e,"i"),c=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,u=this.alpha?this.alpha.flow(e,"f"):void 0,h=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0,d=this.reflectivity?this.reflectivity.flow(e,"f"):void 0;e.requires.transparent=u!==void 0,e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","#include <normal_pars_fragment>","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>"].join(`
`));let p=["#include <clipping_planes_fragment>","	#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	PhysicalMaterial material;","	material.diffuseColor = vec3( 1.0 );"];if(this.bumpMap){e.include(Rp.dHdxy),e.include(Rp.perturbNormalArb);let v=this.bumpMap.texture.flow(e,"t"),m=this.bumpMap.flow(e,"v3"),g=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",y="";this.bumpMap.projection.value===4?y=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${v.result}, uv0, ${g});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${v.result}, uv1, ${g});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${v.result}, uv2, ${g});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:y=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${v.result}, bumpMapCachedUv, ${g});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,p.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${m.result};
					${y}
					`)}if(p.push(r.code,"	vec3 diffuseColor = "+r.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",a.code,"	float metalnessFactor = "+a.result+";"),this.roughnessMap){let v=this.roughnessMap.texture.flow(e,"t"),m=this.roughnessMap.flow(e,"v3"),g="";this.roughnessMap.projection.value===4?g=`
					float roughnessChange = 1.0;
					{
						vec2 uv0 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						float r0 = luminance(texture(${v.result}, uv0).rgb) * roughnessScale;
						float r1 = luminance(texture(${v.result}, uv1).rgb) * roughnessScale;
						float r2 = luminance(texture(${v.result}, uv2).rgb) * roughnessScale;

						roughnessChange = (r0 * weights.z + r1 * weights.x + r2 * weights.y);
					}
					float roughnessFactor = roughnessChange * ${s.result};
					`:g=`
					vec2 roughnessMapCachedUv = g${this.roughnessMap.uuid.toString().replace(/-/g,"")}_writeUvs;

					vec4 vals = texture(${v.result},  roughnessMapCachedUv);
					float roughnessFactor = luminance(vals.rgb) * ${s.result};
					`,p.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${m.result};

					const float roughnessScale = 1.0;

					${g}
				`)}else p.push(s.code,"	float roughnessFactor = "+s.result+";");u&&p.push(u.code,"#ifdef ALPHATEST","	if ( "+u.result+" <= ALPHATEST ) discard;","#endif"),p.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),p.push("material.diffuseColor = diffuseColor * ( 1.0 - metalnessFactor );","material.roughness = max( roughnessFactor, 0.0525 );","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.roughness = clamp( roughnessFactor, 0.04, 1.0 );"),d?p.push(d.code,"material.specularColor = mix( vec3( 0.16 * pow2( "+d.result+" ) ), diffuseColor, metalnessFactor );"):p.push("material.specularColor = mix( vec3( 0.04 ), diffuseColor, metalnessFactor );"),p.push("#include <lights_fragment_begin>"),p.push("#include <lights_fragment_end>"),p.push("vec3 ao = aoEnabled && "+n.result+" ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse)) + reflectedLight.directSpecular + reflectedLight.indirectSpecular;");let f="1.0";this.mask&&(this.mask.analyze(e),f=`luminance(${this.mask.flow(e,"v3").result})`),p.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${o.result} * ${f} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${o.result} * ${f}, ${l.result} );
					
					outgoingLight *= ao;
				}
				`),c&&p.push(c.code,`outgoingLight = spe_blend(outgoingLight, ${c.result}, 1.0, SPE_BLENDING_NORMAL);`),u?p.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${u.result} );`):p.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),h&&p.push(`gl_FragColor.a *= ${h.result};`),p.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=p.join(`
`)}return t}},Zfe=class extends Fc{constructor(){super("toon"),this.nodeType="Toon",this.color=new Li(Fs),this.specular=new Li(1118481),this.shininess=new Ke(30),this.previousModelViewMatrix=new oo,this.previouseProjectionMatrix=new oo,this.shadingAlpha=new Ke(1),this.shadingBlend=new ni(0)}get category(){return"toon"}build(e){let t;if(e.define("TOON"),e.requires.lights=!0,e.extensions.derivatives=!0,e.isShader("vertex")){let i=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform({frameIndex:ht.frameIndex}),e.mergeUniform({resolution:ht.resolution}),e.mergeUniform({previousModelViewMatrix:this.previousModelViewMatrix}),e.mergeUniform({previousProjectionMatrix:this.previouseProjectionMatrix}),e.mergeUniform(Xp.merge([We.fog,We.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vWPosition;","#include <fog_pars_vertex>","#include <normal_pars_vertex>","#include <shadowmap_pars_vertex>","#include <clipping_planes_pars_vertex>"].join(`
`));let n=["#include <beginnormal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <defaultnormal_vertex>
				#endif

				vec3 displaced_position = position;
				vec3 displaced_normal = normal;

				#ifdef USE_LAYER_DISPLACE
					vec3 transformed;
					vec3 transformedNormal;
				#endif
				`,"#include <normal_vertex>",`
				#ifndef USE_LAYER_DISPLACE
					#include <begin_vertex>
				#endif
				`];i&&n.push(i.code,i.result?"displaced_position = "+i.result+";":""),n.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),n.push("	#include <project_vertex>","	#include <fog_vertex>","	#include <clipping_planes_vertex>","	vViewPosition = - mvPosition.xyz;","	#include <worldpos_vertex>","	#include <shadowmap_vertex>","	#include <fog_vertex>"),n.push("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;"),t=n.join(`
`)}else{e.mergeUniform({penumbraSize:ht.penumbraSize}),e.mergeUniform({frameIndex:ht.frameIndex}),e.mergeUniform({aoMap:ht.aoRenderTarget}),e.mergeUniform({aoEnabled:ht.aoEnabled}),this.color===void 0&&(this.color=new Li(Fs)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e);let i=this.color.flow(e,"c",{slot:"color"}),n=this.specular.flow(e,"c"),r=this.shininess.flow(e,"f"),s=this.shadingAlpha.flow(e,"f"),a=this.shadingBlend.flow(e,"i"),o=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,l=this.alpha?this.alpha.flow(e,"f"):void 0,c=this.alphaOverride?this.alphaOverride.flow(e,"f"):void 0;e.requires.transparent=l!==void 0,e.addParsCode(["uniform float penumbraSize[5];","uniform sampler2D aoMap;","uniform bool aoEnabled;","varying vec3 vWPosition;","#include <normal_pars_fragment>","#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <dithering_pars_fragment>",`
					varying vec3 vViewPosition;
					struct ToonMaterial {
						vec3	diffuseColor;
						vec3	specularColor;
						float	specularShininess;
						float	specularStrength;
					};
					void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
			
						reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
						reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
					}
					void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
						reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
					}
					#define RE_Direct				RE_Direct_Toon
					#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
					#define Material_LightProbeLOD( material )	(0)
					`,"#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>"].join(`
`));let u=["#include <normal_fragment_begin>",`
				// NOTE: gl_FrontFacing alternative using face normal estimation.
				vec3 viewdx = dFdx(vViewPosition);
				vec3 viewdy = dFdy(vViewPosition);
				vec3 faceNormal = normalize(cross(viewdx,viewdy));
				if (dot(normal, faceNormal) < 0.0) {
					normal *= -1.0;
				}
				`,"	ToonMaterial material;"];if(this.bumpMap){e.include(Rp.dHdxy),e.include(Rp.perturbNormalArb);let d=this.bumpMap.texture.flow(e,"t"),p=this.bumpMap.flow(e,"v3"),f=this.bumpMapIntensity?this.bumpMapIntensity.flow(e,"f").result:"1.0",v="";this.bumpMap.projection.value===4?v=`
					vec3 bumpNormal = vec3(0.0);
					{
						vec2 uv0 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs0;
						vec2 uv1 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs1;
						vec2 uv2 = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs2;
						vec3 weights = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_triplanarWeights;

						vec2 grad0 = dHdxy(${d.result}, uv0, ${f});
						vec3 n0 = perturbNormalArb(-vViewPosition, normal, grad0, faceDirection);

						vec2 grad1 = dHdxy(${d.result}, uv1, ${f});
						vec3 n1 = perturbNormalArb(-vViewPosition, normal, grad1, faceDirection);

						vec2 grad2 = dHdxy(${d.result}, uv2, ${f});
						vec3 n2 = perturbNormalArb(-vViewPosition, normal, grad2, faceDirection);
						
						bumpNormal = n0 * weights.z + n1 * weights.x + n2 * weights.y;
						bumpNormal = normalize(bumpNormal);
					}

					normal = bumpNormal;
					`:v=`
					vec2 bumpMapCachedUv = g${this.bumpMap.uuid.toString().replace(/-/g,"")}_writeUvs;
					vec2 grad = dHdxy(${d.result}, bumpMapCachedUv, ${f});
					normal = perturbNormalArb( - vViewPosition, normal, grad, faceDirection );
					`,u.push(`// Call the Texture Layer's function once here so that it writes out its procedural UV coordinates
					${p.result};
					${v}
					`)}u.push(i.code,"	vec3 diffuseColor = "+i.result+";","	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",n.code,"	vec3 specular = "+n.result+";",r.code,"	float shininess = max( 0.0001, "+r.result+" );","	float specularStrength = 1.0;"),l&&u.push(l.code,"#ifdef ALPHATEST","if ( "+l.result+" <= ALPHATEST ) discard;","#endif"),u.push("material.diffuseColor = diffuseColor;"),u.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),u.push("vec3 ao = aoEnabled ? tex2D(aoMap, gl_FragCoord.xy / resolution).rgb : vec3(1.0);","vec3 outgoingLight = ((reflectedLight.directDiffuse + reflectedLight.indirectDiffuse) * ao) + reflectedLight.directSpecular;");let h="1.0";this.mask&&(this.mask.analyze(e),h=`luminance(${this.mask.flow(e,"v3").result})`),u.push(`
				if (outgoingLight != diffuseColor) {
					float lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );
					accumAlpha += ( 1.0 - accumAlpha ) * ${s.result} * ${h} * lightAccu;
					outgoingLight = spe_blend( diffuseColor, outgoingLight, ${s.result} * ${h}, ${a.result} );
				}
				`),o&&u.push(o.code,`outgoingLight = spe_blend(outgoingLight, ${o.result}, 1.0, SPE_BLENDING_NORMAL);`),l?u.push(`gl_FragColor = vec4( outgoingLight, accumAlpha * ${l.result} );`):u.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),c&&u.push(`gl_FragColor.a *= ${c.result};`),u.push("#include <encodings_fragment>","#include <fog_fragment>","#include <dithering_fragment>"),t=u.join(`
`)}return t}},Qfe=class{constructor(e=1e3*10){this.timeout=e,this.cache=new Map,this.head={data:null,time:0,src:null,next:null,prev:null},this.tail={data:null,time:1/0,src:null,next:null,prev:null},this.hasClean=!1,this.head.next=this.tail,this.tail.prev=this.head}log(...e){}remove(e){let t=this.cache.get(e);t&&(this.dispose(e,t.data),this.cache.delete(e),t.prev.next=t.next,t.next.prev=t.prev)}scheduleCleanup(){this.hasClean||(this.log("scheduled cleanup"),this.hasClean=!0,setTimeout(()=>{this.hasClean=!1,this.log("cleaning");let e=Date.now(),t=this.head.next;for(;t.time<e-this.timeout;)this.dispose(t.src,t.data),this.cache.delete(t.src),t=t.next,t.prev=this.head,this.head.next=t;this.head.next!==this.tail?this.scheduleCleanup():this.log("no more cleanup")},this.timeout+1e3))}has(e){var t;return(t=this.cache.get(e))==null?void 0:t.data}load(e){let t=Date.now(),i=this.cache.get(e);return i===void 0?(i={data:this.create(e),src:e,time:t,next:null,prev:null},this.cache.set(e,i)):(i.time=t,i.prev.next=i.next,i.next.prev=i.prev),i.prev=this.tail.prev,i.next=this.tail,this.tail.prev.next=i,this.tail.prev=i,this.scheduleCleanup(),i.data}},Kfe=class extends Qfe{create(e){return URL.createObjectURL(new Blob([e]))}dispose(e,t){URL.revokeObjectURL(t)}},Nb;function $fe(e){return typeof e=="string"?e:(Nb||(Nb=new Kfe),Nb.load(e))}var Jfe=class{constructor(e,t){this.data=e,this.cache=t,this.refCount=0}deref(){this.refCount,this.refCount-=1,this.refCount===0&&(this.cache.remove(this),this.dispose())}dispose(){this.refCount}},eme=class{constructor(){this.cache=new Map}remove(e){this.cache.delete(e.data)}load(e){let t=this.cache.get(e);return t===void 0&&(t=this.create(e),this.cache.set(e,t)),t.refCount+=1,t}},RF=class extends Jfe{constructor(e,t){super(e,t.imageHolderCache),this.data=e,this.shared=t,this.loaded=!1,this.isVideo=!1,this.isVideo=e.type==="video",this.updateSrc(e.data)}async updateSrc(e){if(typeof document>"u")return;this.disposeTextures(),this.loaded=!1;let t=()=>{this.loaded=!0;let n=[1e3,1001,1002];for(let r of n){let s=this[r];s&&(s.image=this.img,s.needsUpdate=!0)}this.shared.requestRender()};if(this.isVideo){if(this.img=document.createElement("video"),this.img.preload="auto",this.img.playsInline=!0,this.img.currentTime=.01,typeof e!="string"){var i=new FileReader;i.readAsDataURL(new Blob([e],{type:"video/mp4"}));let n;await new Promise(r=>{i.onloadend=s=>{var a;n=(a=s.target)==null?void 0:a.result,r(null)}}),this.img.src=n}else this.img.src=e;this.img.onloadeddata=()=>{t()}}else this.img=new Image,this.img.src=$fe(e),this.img.onload=t}getTexture(e){let t=this[e];if(t)return t;{let i;return this.isVideo?i=new mte(this.img,void 0,e,e):i=new ln(this.img,void 0,e,e),this.loaded&&(i.needsUpdate=!0),this[e]=i,i}}disposeTextures(){var e,t,i;(e=this[1e3])==null||e.dispose(),this[1e3]=void 0,(t=this[1001])==null||t.dispose(),this[1001]=void 0,(i=this[1002])==null||i.dispose(),this[1002]=void 0}dispose(){super.dispose(),this.disposeTextures()}},wh=class extends RF{};function ur(e,t){return t.color(e)}function tme(e,t){switch(e.type){case"fresnel":return rme(e,t);case"gradient":return sme(e);case"depth":return ame(e);case"normal":return ome(e);case"noise":return lme(e,t);case"rainbow":return cme(e);case"toon":return hme(e,t);case"outline":return ume(e,t);case"transmission":return dme(e);case"color":return nme(e,t);case"pattern":return pme(e,t)}}function ime(e){return{type:e.type}}function ba(e){let{alpha:t,mode:i,isMask:n}=e;return{...ime(e),alpha:t,mode:i,isMask:n}}function nme(e,t){return{...ba(e),color:ur(e.color,t)}}function rme(e,t){let{bias:i,scale:n,intensity:r,factor:s,color:a,isMask:o}=e;return{...ba(e),color:ur(a,t),bias:i,scale:n,intensity:r,factor:s}}function sme(e){let{gradientType:t,smooth:i,colors:n,steps:r,angle:s,offset:a,morph:o}=e;return{...ba(e),gradientType:t,smooth:i,colors:n.map(l=>new Ct(l[0],l[1],l[2],l[3])),num:n.length,steps:r,offset:new te(...a),morph:new te(...o),angle:s}}function ame(e){let{gradientType:t,near:i,far:n,isVector:r,isWorldSpace:s,origin:a,direction:o,colors:l,steps:c,smooth:u}=e;return{...ba(e),gradientType:t,near:i,far:n,isVector:r,isWorldSpace:s,origin:new T(...a),direction:o?new T(...o):new T(1,0,0),colors:l.map(h=>h!==void 0?new Ct(h[0],h[1],h[2],h[3]):new Ct(0,0,0,0)),steps:c.slice(0,l.length),smooth:u}}function ome(e){let{cnormal:t}=e;return{...ba(e),cnormal:new T(t[0],t[1],t[2])}}function lme(e,t){return{...ba(e),scale:e.scale,move:e.move,fA:new te(...e.fA),fB:new te(...e.fB),size:new T(...e.size),distortion:new te(...e.distortion),colorA:ur(e.colorA,t),colorB:ur(e.colorB,t),colorC:ur(e.colorC,t),colorD:ur(e.colorD,t),noiseType:e.noiseType,voronoiStyle:e.voronoiStyle,highCut:e.highCut,lowCut:e.lowCut,smoothness:e.smoothness,seed:e.seed,quality:e.quality}}function cme(e){return{...ba(e),filmThickness:e.filmThickness,movement:e.movement,wavelengths:new T(...e.wavelengths),noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,offset:new T(...e.offset)}}function hme(e,t){return{...ba(e),positioning:e.positioning,colors:e.colors.map(i=>new Ct(i[0],i[1],i[2],i[3])),num:e.colors.length,steps:e.steps,source:new T(...e.source),isWorldSpace:e.isWorldSpace,noiseStrength:e.noiseStrength,noiseScale:e.noiseScale,shadowColor:ur(e.shadowColor,t),offset:new T(...e.offset)}}function ume(e,t){return{...ba(e),outlineColor:ur(e.outlineColor,t),contourColor:ur(e.contourColor,t),outlineWidth:e.outlineWidth,contourWidth:e.contourWidth,outlineThreshold:e.outlineThreshold,contourThreshold:e.contourThreshold,outlineSmoothing:e.outlineSmoothing,contourFrequency:e.contourFrequency,contourDirection:new T(...e.contourDirection),positionalLines:e.positionalLines,compensation:e.compensation}}function dme(e,t){return{...ba(e),thickness:e.thickness,ior:e.ior,roughness:e.roughness}}function pme(e,t){return{...ba(e),style:e.style,projection:e.projection,axis:e.axis,blending:e.blending,offset:new te(...e.offset),colorA:ur(e.colorA,t),colorB:ur(e.colorB,t),frequency:new te(...e.frequency),size:e.size,variation:e.variation,smoothness:e.smoothness,zigzag:e.zigzag,rotation:e.rotation,vertical:new te(...e.vertical),horizontal:new te(...e.horizontal),sides:e.sides}}var gx=class extends Or{},IF={noise:["noiseType"],texture:["projection","axis","side"],video:["projection","axis","side"],displace:["noiseType"],light:["roughnessMap","bumpMap"],depth:["smooth","isWorldSpace","gradientType","isVector"],pattern:["style","projection","axis"]},OF={depth:["colors"]};function fme(e,t,i){var s,a;if(t==="isMask")return!0;let n=IF[e.type],r=OF[e.type];if(r!==void 0){let o=e.color;if(r.includes(t)){let l=(a=(s=o[t])==null?void 0:s.value)==null?void 0:a.length;if(l!==void 0&&l!==i.length)return!0}}return n!==void 0?n.includes(t):!1}function BF(e,t,i){let n=i.uniforms[`f${i.id}_texture`];if(!n)return!1;let r=!1,s=e;if("image"in s){let a=s.image,o=t.image(a),l=n;l.image instanceof wh||l.image.deref(),l.image=o}if("video"in s){let a=s.video,o=t.video(a),l=n;l.image instanceof wh||l.image.deref(),l.image=o}if("wrapping"in s){let a=n;a.wrap=s.wrapping}if("repeat"in s||"offset"in s){let a="mat",o=i.uniforms[`f${i.id}_${a}`];"repeat"in s&&(o.repeat=s.repeat),"offset"in s&&(o.offset=s.offset),o.updateMatrix()}return r}function mme(e,t,i,n){let r=!1;for(let[s,a]of Object.entries(e)){if(s==="bumpMap"||s==="roughnessMap"){r=!0;continue}if(!s||a===void 0)continue;if(UF(s,i,n)){s==="visible"&&i.type==="light"&&(r=!0);continue}i.visible=n.visible;let o=i.uniforms[`f${i.id}_${s}`];if(o&&!(o instanceof MA))switch(r=r||fme(i,s,a),o.constructor){case Li:if(typeof a=="string"){let l=t.getColor(a);l&&(o.value=l);break}else{let l=a;o.value instanceof gx?o.value=new Or(l.r,l.g,l.b,l.a):o.setRGBA(l);break}case zo:if(typeof a=="string"){let l=t.getColor(a);l&&(o.value=l);break}else{let l=a;o.value instanceof gx?o.value=new Or(l.r,l.g,l.b,l.a):o.value.setRGBA(l.r,l.g,l.b,l.a);break}case Dn:{let l=a;o.value.setX(l[0]),o.value.setY(l[1]);break}case bs:{let l=a;o.value.setX(l[0]),o.value.setY(l[1]),o.value.setZ(l[2]);break}case Wo:{BF(a,t,i);break}case oh:{o.value=a.map(l=>new Ct(...l));break}default:{o.value=a;break}}}return r}var Ih=class{constructor(e,t,i,n){this.id=e,this.uuid=t,this.data=i,this.uniforms={};for(let r in n)this.uniforms[`f${this.id}_${r}`]=n[r];for(let r in i)UF(r,this,i)}get type(){return this.data.type}static create(e,t,i,n){if(i.type==="light")return ko.createLigherLayer(e,t,i,n);if(i.type==="texture"||i.type==="video"){let r=i.type==="texture"?n.image(i.texture.image):n.video(i.texture.video),s=new gM(r,i.texture.wrapping),a=new Vfe(r),o=new Hfe(i.texture.repeat,i.texture.offset),l=new Ke(i.crop?1:0),c=new ni(i.projection??0),u=new ni(["x","y","z"].indexOf(i.axis)??0),h=new ni(i.side??0),d=new Dn(i.size?new te(i.size[0],i.size[1]):new te(100,100)),p=new Ke(i.blending??0),f=new Ke(i.alpha??1),v=new ni(i.mode??0),m=new lr(i.isMask??!1),g=new CA(s,a,l,c,u,h,d,p,o,f,v,m),y=new ui(g.calpha,"f");return new Ei(e,t,i,{texture:s,textureSize:a,crop:l,projection:c,axis:u,side:h,size:d,blending:p,mat:o,alpha:f,mode:v,isMask:m},g,v,y,m)}else if(i.type==="matcap"){let r=n.image(i.texture.image),s=new gM(r,i.texture.wrapping),a=new Ke(i.alpha??1),o=new ni(i.mode??0),l=new lr(i.isMask??!1),c=new yF(s,a,o,l),u=new ui(c.calpha,"f");return new Ei(e,t,i,{texture:s,alpha:a,mode:o,isMask:l},c,o,u,l)}else if(i.type==="displace")if(i.displacementType==="noise"){let r=new bs(new T(...i.offset)),s=new Ke(i.scale??10),a=new Ke(i.intensity??8),o=new Ke(i.movement??1),l=new ni(i.noiseType??0),c=new ni(i.voronoiStyle??0),u=new Ke(i.smoothness??.5),h=new Ke(i.seed??0),d=new Ke(i.highCut??1),p=new Ke(i.lowCut??0),f=new ni(i.quality??1),v=new DF(a,o,r,c,u,h,d,p,f,s,l);return new NF(e,t,i,{offset:r,scale:s,intensity:a,movement:o,noiseType:l,voronoiStyle:c,smoothness:u,seed:h,highCut:d,lowCut:p,quality:f},v)}else throw new Error;else return yme(e,t,i,n)}updateByOp(e,t,i){let n=e;if(n.path[0]===void 0){if(n.type===0)return"type"in n.props||"category"in n.props||"visible"in n.props?(i.scene.markNeedsUpdateRendererDirty(),!0):mme(n.props,i.shared,this,t)}else if(n.path[0]==="texture")return"texture"in t||"video"in t?BF(n.props,i.shared,this):!0;return!1}dispose(){if(gme(this)){let e=this.uniforms[`f${this.id}_texture`];if(!e)return!1;let t=e;t.image instanceof wh||t.image.deref()}}hasValueByKey(e){return this.uniforms[e]!==void 0}hasValue(e){return this.hasValueByKey(`f${this.id}_${e}`)}setValue(e,t){let i=`f${this.id}_${e}`;this.hasValueByKey(i)&&t!==void 0&&(this.uniforms[i].value=t)}getNode(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t]}getValue(e){let t=`f${this.id}_${e}`;if(this.hasValueByKey(t))return this.uniforms[t].value}getName(e){let t=/f\d+_(.*)/.exec(e);if(t&&t.length>1)return t[1];console.log(`Layer.getName: error ${e}`)}getNames(){let e=[];for(let t in this.uniforms){let i=this.getName(t);i&&e.push(i)}return e}},Ei=class extends Ih{constructor(e,t,i,n,r,s,a,o){super(e,t,i,n),this.params=n,this.color=r,this.mode=s,this.alpha=a,this.isMask=o}},NF=class extends Ih{constructor(e,t,i,n,r){super(e,t,i,n),this.position=r}},ko=class extends Ih{constructor(e,t,i,n,r){super(e,t,i,r),this.node=n}static createLigherLayer(e,t,i,n){let r,s=new Ke(i.alpha),a=new ni(i.mode),o=new Ke(i.bumpMapIntensity),l=new Ke(i.alphaOverride),c;if(!i.visible)r=new LF,c={};else if(i.category==="lambert"){r=new Xfe;let u=new Li(n.color(i.emissive)??0),h=new lr(i.occlusion??!0);c={emissive:u,occlusion:h},r.emissive=u,r.occlusion=h}else if(i.category==="toon"){r=new Zfe;let u=new Ke(i.shininess??30),h=new Li(n.color(i.specular)??1118481);c={shininess:u,specular:h},r.shininess=u,r.specular=h}else if(i.category==="physical"){r=new Yfe;let u=new Ke(i.roughness??.3),h=new Ke(i.metalness??0),d=new Ke(i.reflectivity??.5),p=new lr(i.occlusion??!0);c={roughness:u,metalness:h,reflectivity:d,occlusion:p},r.roughness=u,r.metalness=h,r.reflectivity=d,r.occlusion=p}else{r=new qfe;let u=new Ke(i.shininess??30),h=new Li(i.specular!==void 0?n.color(i.specular)??1118481:1118481),d=new lr(i.occlusion??!0);c={shininess:u,specular:h,occlusion:d},r.shininess=u,r.specular=h,r.occlusion=d}return r.alpha=new Ke(1),r.shadingAlpha=s,r.shadingBlend=a,r.bumpMapIntensity=o,r.alphaOverride=l,c.alpha=r.shadingAlpha,c.mode=r.shadingBlend,c.bumpMapIntensity=r.bumpMapIntensity,c.alphaOverride=r.alphaOverride,new ko(e,t,i,r,c)}get category(){return this.node.category}};function gme(e){let t=e instanceof Ih?e.type:e;return t==="texture"||t==="video"||t==="displace_map"||t==="matcap"}function gs(e){return{alpha:new Ke(e.alpha??1),mode:new ni(e.mode??0),isMask:new lr(e.isMask??!1)}}function vme(e,t,i,n){switch(e.type){case"color":{let r=new Li(n.color??Fs),s=gs(n),a=new vM(r,s.alpha),o=new ui(a.calpha,"f");return new Ei(t,i,e,{color:r,...s},a,s.mode,o,s.isMask)}case"fresnel":{let r=new Li(n.color??16777215),s=new Ke(n.bias??.1),a=new Ke(n.scale??1),o=new Ke(n.intensity??2),l=new Ke(n.factor??1),c=gs(n),u=new Gfe(r,s,a,o,l,c.alpha,c.mode,c.isMask),h=new ui(u.calpha,"f");return new Ei(t,i,e,{color:r,bias:s,scale:a,intensity:o,factor:l,...c},u,c.mode,h,c.isMask)}case"rainbow":{let r=new Ke(n.filmThickness??30),s=new Ke(n.movement??0),a=new bs(n.wavelengths??new T(0,0,0)),o=new Ke(n.noiseStrength??0),l=new Ke(n.noiseScale??1),c=new bs(n.offset??new T(0,0,0)),u=gs(n),h=new MF(r,s,a,o,l,c,u.alpha,u.isMask),d=new ui(h.calpha,"f");return new Ei(t,i,e,{filmThickness:r,movement:s,wavelengths:a,noiseStrength:o,noiseScale:l,offset:c,...u},h,u.mode,d,u.isMask)}case"transmission":{let r=new Ke(n.thickness??10),s=new Ke(n.ior??1.5),a=new Ke(n.roughness??.5),o=ht.transmissionSize,l=ht.transmissionRenderTarget,c=ht.transmissionRenderTargetDepth,u=window.innerWidth,h=window.innerHeight,d=u>=h?new Dn(h/u,1):new Dn(1,u/h),p=gs(n),f=new TF(r,s,a,o,l,c,d,p.alpha),v=new ui(f.calpha,"f");return new Ei(t,i,e,{thickness:r,ior:s,roughness:a,aspectRatio:d,...p},f,p.mode,v,p.isMask)}case"toon":{let r=new ni(n.positioning??0),s;n.colors?s=new oh(n.colors.length,n.colors):(s=new oh(10,new Ct(0,0,0,1)),s.value[1]=new Ct(1,1,1,1));let a;n.steps?a=new ah(n.steps.length,n.steps):(a=new ah(10,1),a.value[0]=0);let o=new bs(n.source??new T(0,0,0)),l=new lr(n.isWorldSpace??!0),c=new Ke(n.noiseStrength??0),u=new Ke(n.noiseScale??1),h=new zo(n.shadowColor),d=new bs(n.offset??new T(0,0,0)),p=gs(n),f=new EF(r,s,a,o,l,c,u,h,d,p.alpha),v=new ui(f.calpha,"f");return new Ei(t,i,e,{positioning:r,colors:s,steps:a,source:o,isWorldSpace:l,noiseStrength:c,noiseScale:u,shadowColor:h,offset:d,...p},f,p.mode,v,p.isMask)}case"outline":{let r=new Li(n.outlineColor??16777215),s=new Li(n.contourColor??16777215),a=new Ke(n.outlineWidth??.1),o=new Ke(n.contourWidth??.1),l=new Ke(n.outlineThreshold??.1),c=new Ke(n.contourThreshold??.1),u=new Ke(n.outlineSmoothing??.1),h=new Ke(n.contourFrequency??.1),d=new bs(n.contourDirection??new T(0,1,0)),p=new lr(n.positionalLines??!1),f=new lr(n.compensation??!0),v=ht.normalRenderTarget,m=ht.normalRenderTargetDepth,g=ht.pixelRatioNode,y=ht.resolution,x=gs(n),_=new bF(r,s,a,o,l,c,u,h,d,p,f,y,v,m,g,x.alpha),b=new ui(_.calpha,"f");return new Ei(t,i,e,{outlineColor:r,contourColor:s,outlineWidth:a,contourWidth:o,outlineThreshold:l,contourThreshold:c,outlineSmoothing:u,contourFrequency:h,contourDirection:d,positionalLines:p,compensation:f,...x},_,x.mode,b,x.isMask)}case"depth":{let r=new ni(n.gradientType??0),s=new lr(n.smooth??!1),a=new Ke(n.near??50),o=new Ke(n.far??200),l=new Ke(n.isVector??1),c=new Ke(n.isWorldSpace??0),u=new bs(n.origin??new T),h=new bs(n.direction??new T),d;n.colors?d=new oh(n.colors.length,n.colors):(d=new oh(2,new Ct(0,0,0,1)),d.value[1]=new Ct(1,1,1,1));let p;n.steps?p=new ah(n.steps.length,n.steps):(p=new ah(2,1),p.value[0]=0);let f=gs(n),v=new fF(r,s,a,o,l,c,u,h,d,p,f.alpha,f.isMask),m=new ui(v.calpha,"f");return new Ei(t,i,e,{gradientType:r,smooth:s,near:a,far:o,isVector:l,isWorldSpace:c,origin:u,direction:h,colors:d,steps:p,...f},v,f.mode,m,f.isMask)}case"noise":{let r=new Ke(n.scale??1),s=new bs(n.size??new T(100,100,100)),a=new Ke(n.move??1),o=new Dn(n.fA??new te(1.7,9.2)),l=new Dn(n.fB??new te(8.3,2.8)),c=new Dn(n.distortion??new te(1,1)),u=new zo(n.colorA),h=new zo(n.colorB),d=new zo(n.colorC),p=new zo(n.colorD),f=new ni(n.noiseType??0),v=new ni(n.voronoiStyle??0),m=new Ke(n.highCut??1),g=new Ke(n.lowCut??0),y=new Ke(n.smoothness??.5),x=new Ke(n.seed??.5),_=new ni(n.quality??1),b=gs(n),w=new xF(r,s,a,o,l,c,u,h,d,p,b.alpha,f,b.isMask,v,m,g,y,x,_),M=new ui(w.calpha,"f");return new Ei(t,i,e,{scale:r,size:s,move:a,fA:o,fB:l,distortion:c,colorA:u,colorB:h,colorC:d,colorD:p,noiseType:f,...b,voronoiStyle:v,highCut:m,lowCut:g,smoothness:y,seed:x,quality:_},w,b.mode,M,b.isMask)}case"normal":{let r=new bs(n.cnormal??new T(1,1,1)),s=gs(n),a=new pF(r,s.alpha),o=new ui(a.calpha,"f");return new Ei(t,i,e,{cnormal:r,...s},a,s.mode,o,s.isMask)}case"gradient":{let r=new ni(n.gradientType??0),s=new lr(n.smooth??!1),a;n.colors?a=new oh(n.colors.length,n.colors):(a=new oh(10,new Ct(0,0,0,1)),a.value[1]=new Ct(1,1,1,1));let o;n.steps?o=new ah(n.steps.length,n.steps):(o=new ah(10,1),o.value[0]=0);let l=new Dn(n.offset??new te(0,0)),c=new Dn(n.morph??new te(0,0)),u=new Ke(n.angle??0),h=gs(n),d=new gF(r,s,a,o,l,c,u,h.alpha,h.isMask),p=new ui(d.calpha,"f");return new Ei(t,i,e,{gradientType:r,smooth:s,colors:a,steps:o,offset:l,morph:c,angle:u,...h},d,h.mode,p,h.isMask)}case"pattern":{let r=new ni(n.style??0),s=new ni(n.projection??0),a=new ni(["x","y","z"].indexOf(n.axis)??0),o=new Ke(n.blending??0),l=new Dn(n.offset??new te(0,0)),c=new zo(n.colorA),u=new zo(n.colorB),h=new Dn(n.frequency??new te(10,10)),d=new Ke(n.size??.5),p=new Ke(n.variation??0),f=new Ke(n.smoothness??.5),v=new Ke(n.zigzag??0),m=new Ke(n.rotation??0),g=new Dn(n.vertical??new te(0,1)),y=new Dn(n.horizontal??new te(0,1)),x=new ni(n.sides??6),_=gs(n),b=new wF(r,s,a,o,l,c,u,h,d,p,f,v,m,g,y,x,_.alpha,_.isMask),w=new ui(b.calpha,"f");return new Ei(t,i,e,{style:r,projection:s,axis:a,blending:o,offset:l,colorA:c,colorB:u,frequency:h,size:d,variation:p,smoothness:f,zigzag:v,rotation:m,vertical:g,horizontal:y,sides:x,..._},b,_.mode,w,_.isMask)}default:{let r=new Li(1,0,0,1),s=gs(n),a=new vM(r,s.alpha),o=new ui(a.calpha,"f");return new Ei(t,i,e,{color:r,...s},a,s.mode,o,s.isMask)}}}function yme(e,t,i,n){let r=tme(i,n);return vme(i,e,t,r)}function UF(e,t,i){if(i.type==="displace"&&(e==="intensity"||e==="visible")){let n=t.uniforms[`f${t.id}_intensity`];return n?(n.value=i.intensity*(i.visible?1:0),n):void 0}if(i.type!=="displace"&&(e==="alpha"||e==="visible")){let n=t.uniforms[`f${t.id}_alpha`];if(!n)return;if(n.value=i.alpha*(i.visible?1:0),i.type==="outline"&&e==="visible"){let r=t.uniforms[`f${t.id}_compensation`];r&&(r.value=i.compensation&&i.visible)}return n}}function vx(e,t){let i=0,n=e.layers.find(r=>r.data.type==="light");if(n&&n.data.alphaOverride<1)return!0;for(let r of e.layers){if(r.data.type!=="displace"&&r.data.isMask)return!0;if(r.data.type!=="displace"&&"alpha"in r.data&&r.data.type!=="light"&&r.data.type!=="fresnel"&&r.data.type!=="texture"&&r.data.type!=="matcap"&&r.data.type!=="rainbow"&&r.data.type!=="outline"&&r.data.type!=="pattern"){let s=r.data.visible?r.data.alpha:0;if(s===1&&r.data.type==="depth"||r.data.type==="gradient"){for(let a of r.data.colors)if(a[3]<1){s=a[3];break}}else if(s===1&&r.data.type==="noise"){let a=t.color(r.data.colorA).a,o=t.color(r.data.colorB).a,l=t.color(r.data.colorC).a,c=t.color(r.data.colorD).a,u=Math.min(a,Math.min(o,Math.min(l,c)));u<1&&(s=u)}i+=(1-i)*s}}return i<1}var Lc=class extends oi{constructor(){super(void 0),this.flatShading=!1,this.needsJitter=!0,this.cacheKey="",this.fog=!0,this.dithering=!0,this.vertexColors=!0,this.transparent=!0}customProgramCacheKey(){return this.cacheKey}},xme=class extends Lc{constructor(e,t,i,n){super(),this.flatShading=e,this.side=t,this.wireframe=i,this.root=n}updateAfterBuild(){let e=this.root;this.lights=e.lights,this.vertexShader=e.vertexShader,this.fragmentShader=e.fragmentShader,this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.transparent=e.transparent,this.cacheKey=e.customProgramCacheKey()+"flat"+this.flatShading+this.side}onBeforeCompile(e,t){this.root.onBeforeCompile(e)}get data(){return this.root.data}get category(){return this.root.category}get hasAO(){return this.root.hasAO}getFlavor(e,t,i){return this.root.getFlavor(e,t,i)}get layers(){return this.root.layers}get fragment(){return this.root.fragment}getLayersOfType(e){return this.root.getLayersOfType(e)}getLayerByUuid(e){return this.root.getLayerByUuid(e)}updateByOp(e,t,i){this.root.updateByOp(e,t,i)}nodeMaterialDispose(){this.root.nodeMaterialDispose()}},AA=class extends Lc{constructor(e,t){super(),this.data=e,this.layerIdGen=0,this.flavors=[],this.masks={},this.type="NodeMaterial",this.updaters=[],this.reset0(e,t)}get nodeMaterial(){return this}getFlavor(e,t,i){let n=i?6:(e?3:0)+t;if(n===0)return this;this.flavors===void 0&&(this.flavors=[]),n-=1;let r=this.flavors[n];return r===void 0&&(r=new xme(e,t,i,this),this.flavors[n]=r,r.flatShading=e,r.side=t,r.updateAfterBuild()),r}get fragment(){return this.lightLayer.node}get category(){return this.lightLayer.category}get hasAO(){var e;return((e=this.lightLayer.getNode("occlusion"))==null?void 0:e.value)??!1}reset(e,t){this.data!==e&&this.reset0(e,t)}reset0(e,t){this.data=e;let i=e.layers??Xn.defaultTwoLayerData("phong").layers;try{this.layers=i.map(n=>Ih.create(this.layerIdGen++,n.id,n.data,t.shared))}catch{this.layers=[]}this.layers.reverse(),this.name=e.name??"Untitled Material",this.onUpdate(),this.transparent=vx(e,t.shared)}getLayersOfType(e){return this.layers.filter(t=>t.type===e)}getLayerByUuid(e){return this.layers.find(t=>t.uuid===e)}onUpdate(){this.cacheKey=this.computeCacheKey(),this.lightLayer=this.layers.find(e=>e instanceof ko),this.lightLayer===void 0&&(this.lightLayer=new ko(0,"",{...wr.defaultData("light","phong"),visible:!1},new LF,{})),this.dispose();for(let e of this.flavors)e&&e.dispose();this.applyTextureMaps(),this.applyMasks(),this.blendColors(),this.blendAfterColors(),this.blendPositions()}applyTextureMaps(){let e=this.layers.find(r=>r instanceof ko);if(!e)return;let t=e.data,i=t.bumpMap,n=t.roughnessMap;e.node.bumpMap=void 0,e.node.roughnessMap=void 0;for(let r=0;r<this.layers.length;++r){let s=this.layers[r];s instanceof Ei&&s.color instanceof CA&&(s.uuid===i&&(e.node.bumpMap=s.color),s.uuid===n&&(e.node.roughnessMap=s.color))}}updateByOp(e,t,i){if(t!==void 0?this.data=t:t=this.data,this.transparent=vx(t,i.shared),e.path[0]==="layers"){this.data=t;let n=i.shared,r=e.path[1];if(r===void 0){if(this.layers.reverse(),e.type===4){let s=Ih.create(this.layerIdGen++,e.id,e.data,i.shared);this.layers.splice(e.localIndex,0,s),i.scene.markNeedsUpdateRendererDirty()}else if(e.type===5)this.layers.splice(e.localIndex,1)[0].dispose(),i.scene.markNeedsUpdateRendererDirty();else if(e.type===6){let s=this.layers.findIndex(o=>o.uuid===e.id),a=this.layers[s];this.layers.splice(s,1),this.layers.splice(e.localIndex,0,a),i.scene.markNeedsUpdateRendererDirty()}this.layers.reverse(),this.onUpdate()}else{e.type===0&&e.props.occlusion!==void 0&&i.scene.markNeedsUpdateRendererDirty();let s=this.layers.find(a=>a.uuid===r);if(s){let a=t.layers.data(r);if(s.updateByOp({...e,path:e.path.slice(2)},a,i)){let o=Ih.create(this.layerIdGen++,r,a,n);this.layers.splice(this.layers.findIndex(l=>l.uuid===r),1,o),this.onUpdate()}}}}else this.reset(t,i)}applyMasks(){for(let e=0;e<this.layers.length;++e){let t=this.layers[e];t instanceof Ei?t.color.mask=void 0:t instanceof ko&&(t.node.mask=void 0)}for(let e=0;e<this.layers.length;++e){let t=this.layers[e];if(t instanceof Ei&&t.isMask.value&&t.data.visible&&e>0){let i=e-1,n=this.layers[i];n instanceof ko?n.node.mask=new _r(t.color,t.alpha,_r.MUL):n instanceof Ei&&(n.isMask.value||(n.color.mask=new _r(t.color,t.alpha,_r.MUL)))}}}blendColors(){let e=this.layers.findIndex(i=>i instanceof Ei),t=this.layers.findIndex(i=>i instanceof ko);if(e!==-1&&e<t){let i=this.layers[e].color;for(let n=e+1;n<t;++n){let r=this.layers[n];if(r instanceof Ei){if(r.isMask.value)continue;i=new CP(i,r.color,r.alpha,r.mode)}}this.fragment.color=i}else this.fragment.color=void 0}blendAfterColors(){let e=new ui("outgoingLight","f"),t=this.layers.findIndex(i=>i instanceof ko);if(this.layers.length>t+1){for(let i=t+1;i<this.layers.length;++i){let n=this.layers[i];if(n instanceof Ei){if(n.isMask.value)continue;e=new CP(e,n.color,n.alpha,n.mode)}}this.fragment.afterColor=e}else this.fragment.afterColor=void 0}blendPositions(){let e=this.layers.filter(t=>t instanceof NF);if(e.length>0){let t=e[0].position;for(let i=1;i<e.length;++i)e[i]&&(t=new _r(t,e[i].position,_r.ADD),t=new _r(t,new Ke(.5).setReadonly(!0),_r.MUL));this.fragment.position=t}else this.fragment.position=void 0}getDefines(){return this.defines}getUniforms(){return this.uniforms}getVertexShader(){return this.vertexShader}getFragmentShader(){return this.fragmentShader}onBeforeCompile(e){this.build(),e.defines=this.defines,e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.extensionDerivatives=this.extensions.derivatives===!0,e.extensionFragDepth=this.extensions.fragDepth===!0,e.extensionDrawBuffers=this.extensions.drawBuffers===!0,e.extensionShaderTextureLOD=this.extensions.shaderTextureLOD===!0}clampUniformsForPreview(e,t){let i=(n,r,s)=>Math.min(Math.max(n,r),s);for(let n of this.layers)if(n.type==="displace"){let r=i(n.uniforms[`f${n.id}_intensity`].value,e,t);n.uniforms[`f${n.id}_intensity`].value=r}}computeCacheKey(){let e="[";for(let{data:t}of this.data.layers)if(t.type==="light")e+=`"${t.visible?t.category.toUpperCase():"Basic"}"`;else{let i=(IF[t.type]??[]).map(o=>t[o]),n=(OF[t.type]??[]).map(o=>{var l;return((l=t[o])==null?void 0:l.length)??0}),r=[...i,...n],s="isMask"in t&&t.isMask,a=`"${t.type}-${t.visible}-${s}"`;r.length?e+=`[${a}, "${r.join('","')}"],`:e+=a}return e=e.slice(0,-1)+"]",e}updateFrame(e){for(let t=0;t<this.updaters.length;++t)e.updateNode(this.updaters[t])}build(){let e=new kfe;e.needsJitter=this.needsJitter,this.lights=this.lightLayer.data.visible,e.build(this.fragment,this.fragment),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.updaters=e.updaters;for(let t of this.flavors)t&&t.updateAfterBuild();return this}nodeMaterialDispose(){this.layers.forEach(e=>e.dispose()),super.dispose();for(let e of this.flavors)e&&e.dispose()}assetsLoaded(){for(let e of this.layers)if(e instanceof Ei){let t=e.params.texture;if(t instanceof gM&&!t.image.loaded)return!1}return!0}getHash(){let e="{";return e+='"fragment":'+this.fragment.getHash(),e+="}",e}};Object.defineProperties(Lc.prototype,{properties:{get:function(){return this.fragment.properties}}});var xM=class extends AA{},_me=Gp(sZ()),EP=new Map;function bme(e){if(typeof e=="string")return e;let t=EP.get(e);return t||(t={url:URL.createObjectURL(new Blob([e]))},EP.set(e,t)),t.url}var ym=class{constructor({src:e,volume:t,delay:i,loop:n}){this._volume=1,this.delay=0,this._loop=1,this.loopsRemaining=0,this._status="stopped",this.onEnd=()=>{this.loopsRemaining===1/0?this.replay():this.loopsRemaining>1?(this.replay(),this.loopsRemaining--):(this._status="stopped",this.loopsRemaining=this._loop)};let r;typeof e=="string"?r={src:e}:r={src:bme(e),format:"wav"},this.sound=new _me.Howl(r),this.sound.on("end",this.onEnd),this.src=e,t!==void 0&&(this.volume=t),i!==void 0&&(this.delay=i),n!==void 0&&(this.loop=n)}get status(){return this._status}get volume(){return this._volume}set volume(e){this._volume=e,this.sound.volume(e)}get loop(){return this._loop}set loop(e){this._loop=e,this.loopsRemaining=e}replay(){this.clearDelay(),this.delayTimerId=window.setTimeout(()=>{this.sound.play(),this.clearDelay()},this.delay)}fade(e,t=1e3){e?(this.sound.volume(this._volume),this.clearFade(),this.fadeTimerId=window.setTimeout(()=>{this.sound.fade(this._volume,0,t),this.clearFade()},e)):this.sound.fade(this._volume,0,t)}on(e,t,i){this.sound.on(e,t,i)}off(e,t,i){this.sound.off(e,t,i)}play(){this._status==="playing"||this.sound.playing()||(this._status==="paused"?(this.sound.seek()===0?this.replay():this.sound.play(),this._status="playing"):this._status==="stopped"&&(this.replay(),this._status="playing"))}pause(){this._status==="playing"&&(this.sound.pause(),this.clearFade(),this.clearDelay(),this._status="paused")}stop(){this.sound.stop(),this.loopsRemaining=this._loop,this.clearFade(),this.clearDelay(),this._status="stopped"}clearFade(){this.fadeTimerId&&(clearTimeout(this.fadeTimerId),delete this.fadeTimerId)}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}dispose(e=!1){this.off(),this.stop(),this.clearFade(),this.clearDelay()}},wme=class{constructor(){this.type="ShapePath",this.color=new ut,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Uy,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){var i;return(i=this.currentPath)==null||i.lineTo(e,t),this}quadraticCurveTo(e,t,i,n){var r;return(r=this.currentPath)==null||r.quadraticCurveTo(e,t,i,n),this}bezierCurveTo(e,t,i,n,r,s){var a;return(a=this.currentPath)==null||a.bezierCurveTo(e,t,i,n,r,s),this}splineThru(e){var t;return(t=this.currentPath)==null||t.splineThru(e),this}toShapes(){let e={ORIGIN:0,DESTINATION:1,BETWEEN:2,LEFT:3,RIGHT:4,BEHIND:5,BEYOND:6},t={loc:e.ORIGIN,t:0};function i(p,f,v,m){let g=p.x,y=f.x,x=v.x,_=m.x,b=p.y,w=f.y,M=v.y,S=m.y,C=(_-x)*(b-M)-(S-M)*(g-x),E=(y-g)*(b-M)-(w-b)*(g-x),P=(S-M)*(y-g)-(_-x)*(w-b),I=C/P,D=E/P;if(P===0&&C!==0||I<=0||I>=1||D<0||D>1)return null;if(C===0&&P===0){for(let L=0;L<2;L++)if(n(L===0?v:m,p,f),t.loc===e.ORIGIN){let B=L===0?v:m;return{x:B.x,y:B.y,t:t.t}}else if(t.loc===e.BETWEEN){let B=+(g+t.t*(y-g)).toPrecision(10),j=+(b+t.t*(w-b)).toPrecision(10);return{x:B,y:j,t:t.t}}return null}else{for(let j=0;j<2;j++)if(n(j===0?v:m,p,f),t.loc===e.ORIGIN){let z=j===0?v:m;return{x:z.x,y:z.y,t:t.t}}let L=+(g+I*(y-g)).toPrecision(10),B=+(b+I*(w-b)).toPrecision(10);return{x:L,y:B,t:I}}}function n(p,f,v){let m=v.x-f.x,g=v.y-f.y,y=p.x-f.x,x=p.y-f.y,_=m*x-y*g;if(p.x===f.x&&p.y===f.y){t.loc=e.ORIGIN,t.t=0;return}if(p.x===v.x&&p.y===v.y){t.loc=e.DESTINATION,t.t=1;return}if(_<-Number.EPSILON){t.loc=e.LEFT;return}if(_>Number.EPSILON){t.loc=e.RIGHT;return}if(m*y<0||g*x<0){t.loc=e.BEHIND;return}if(Math.sqrt(m*m+g*g)<Math.sqrt(y*y+x*x)){t.loc=e.BEYOND;return}let b;m!==0?b=y/m:b=x/g,t.loc=e.BETWEEN,t.t=b}function r(p,f){let v=[],m=[];for(let g=1;g<p.length;g++){let y=p[g-1],x=p[g];for(let _=1;_<f.length;_++){let b=f[_-1],w=f[_],M=i(y,x,b,w);M!==null&&v.find(S=>S.t<=M.t+Number.EPSILON&&S.t>=M.t-Number.EPSILON)===void 0&&(v.push(M),m.push(new te(M.x,M.y)))}}return m}function s(p,f,v){let m=new te;f.getCenter(m);let g=[];return v.forEach(y=>{y.boundingBox.containsPoint(m)&&r(p,y.points).forEach(x=>{g.push({identifier:y.identifier,isCW:y.isCW,point:x})})}),g.sort((y,x)=>y.point.x-x.point.x),g}function a(p,f,v,m,g){(g==null||g==="")&&(g="nonzero");let y=new te;p.boundingBox.getCenter(y);let x=[new te(v,y.y),new te(m,y.y)],_=s(x,p.boundingBox,f);_.sort((E,P)=>E.point.x-P.point.x);let b=[],w=[];_.forEach(E=>{E.identifier===p.identifier?b.push(E):w.push(E)});let M=b[0].point.x,S=[],C=0;for(;C<w.length&&w[C].point.x<M;)S.length>0&&S[S.length-1]===w[C].identifier?S.pop():S.push(w[C].identifier),C++;if(S.push(p.identifier),g==="evenodd"){let E=S.length%2===0,P=S[S.length-2];return{identifier:p.identifier,isHole:E,for:P}}else if(g==="nonzero"){let E=!0,P=null,I=null;for(let D=0;D<S.length;D++){let L=S[D];f[L]&&(E?(I=f[L].isCW,E=!1,P=L):I!==f[L].isCW&&(I=f[L].isCW,E=!0))}return{identifier:p.identifier,isHole:E,for:P}}else console.warn('fill-rule: "'+g+'" is currently not implemented.')}let o=0,l=999999999,c=-999999999,u=[];this.subPaths.forEach(p=>{let f=p.getPoints(),v=-999999999,m=999999999,g=-999999999,y=999999999;for(let x=0;x<f.length;x++){let _=f[x];_.y>v&&(v=_.y),_.y<m&&(m=_.y),_.x>g&&(g=_.x),_.x<y&&(y=_.x)}c<=g&&(c=g+1),l>=y&&(l=y-1),f.length&&u.push({curves:p.curves,points:f,isCW:JB.isClockWise(f),identifier:o++,boundingBox:new _ie(new te(y,m),new te(g,v))})});let h=u.map(p=>{var f;return a(p,u,l,c,(f=this.userData)==null?void 0:f.style.fillRule)}),d=[];return u.forEach(p=>{let f=h[p.identifier];if(f&&!f.isHole){let v=new Fy;v.curves=p.curves,h.filter(m=>(m==null?void 0:m.isHole)&&m.for===p.identifier).forEach(m=>{if(m){let g=u[m.identifier],y=new Uy;y.curves=g.curves,v.holes.push(y)}}),d.push(v)}}),d}},FF,AP=new Promise(e=>{FF=e}),TP=!1,z1;function Sme(){if(TP)return;if(z1)return z1;async function e(){let t=await J0(()=>import("./opentype-fc28cde9.js"),[]);FF(t),TP=!0}return z1=e(),z1}var Mme=class{async load(e,t,i=()=>{}){let{load:n}=await AP;n(e,(r,s)=>{r||!s?i(r??"Something went wrong"):t(s)})}async parse(e){let{parse:t,Bidi:i}=await AP;try{let n=t(e),r=new i,s=a=>n.charToGlyphIndex(a.char);return r.registerModifier("glyphIndex",null,s),r.applyFeatures(n,n.defaultRenderOptions.features),{font:n,bidi:r}}catch(n){console.error(n)}}};async function Cme(e){return await(await fetch(e)).arrayBuffer()}var Eme=new Mme;async function PP(e){let t,i,n=!1;if(e.url?(t=await Cme(e.url),i=e.url,n=e.url.startsWith("/")):e.data&&(t=e.data.buffer.slice(e.data.byteOffset,e.data.byteOffset+e.data.byteLength)),t){let r=await Eme.parse(t);if(r)return{font:r.font,url:i,intercepted:n,arr:t,bidi:r.bidi}}}function Ame(e,t){return t.state.glyphIndex===e||t.state.fina===e||t.state.medi===e||t.state.init===e}var Tme=class{constructor(e){this._arrayBuffer=new ArrayBuffer(1),this._isLoaded=!1,this._intercepted=!1,this._isUserFont=e.isUserFont??!1,this._loadingPromise=PP(e).then(t=>{t&&(this._arrayBuffer=t.arr,this._url=t.url,this.font=t.font,this._intercepted=t.intercepted,this._isLoaded=!0,this._bidi=t.bidi)})}update(e){this._isLoaded=!1,this._isUserFont=e.isUserFont??!1,this._loadingPromise=PP(e).then(t=>{t&&(this._arrayBuffer=t.arr,this._url=t.url,this.font=t.font,this._intercepted=t.intercepted,this._isLoaded=!0,this._bidi=t.bidi)})}get url(){return this._url}get intercepted(){return this._intercepted}get isLoaded(){return this._isLoaded}get loadingPromise(){return this._loadingPromise}reverseLigaturesTable(e,t,i){if(!this._bidi)return[];let n=this._bidi;n.getTextGlyphs(t);let r=n.tokenizer.tokens,s=[],a=0,o=i.length===r.length;for(let l=0;l<i.length;l++){let c=i[l].index,u=String.fromCharCode(i[l].unicode),h=r[a];if(Ame(c,h)||o)s.push({char:u,index:c,replacements:[h.state.glyphIndex],replacementChars:[h.char]}),a++;else{let d=h.char,p="",f=[h.state.glyphIndex],v=[],m=!1;for(;!m;)a++,p=t.charAt(a),d+=p,f.push(e.charToGlyphIndex(p)),v=e.stringToGlyphs(d),v.length===1&&v[0].index===c&&(m=!0),a>t.length&&(m=!0);s.push({char:u,index:c,replacements:f,replacementChars:Array.from(d)}),a++}}return s}generateShapes(e,t){if(!this._isLoaded)return;let i=this.font,n=t.fontSize/this.unitsPerEm,r=t.fontSize*t.lineHeight,s=e.map(g=>this.getTextWidth(g,t)),a=t.width,o=this.getCharWidth(`
`,t),l=t.horizontalAlign===1?o:0,c=this.computeSpaceWidthForLine(e,0,t),u=this.getLineInitialOffsetX(s[0],a,t.horizontalAlign,e[0],o),h=this.getLineInitialOffsetY(r,e.length,t.height,n,t.verticalAlign),d=[],p=e.map(g=>[]),f=e.map(g=>[]),v;for(let g=0;g<e.length;g++){let y=e[g],x={features:{liga:!0}},_=[];try{_=i.stringToGlyphs(y,x)}catch(w){console.warn(w)}u=this.getLineInitialOffsetX(s[g],a,t.horizontalAlign,y,o);let b=[];try{b=this.reverseLigaturesTable(i,y,_)}catch(w){console.warn(w)}c=this.computeSpaceWidthForLine(e,g,t);for(let w=0;w<_.length;w++){let M=_[w],S=M.index===0?`
`:M.unicode?String.fromCharCode(M.unicode):void 0,C=b[w],E=0,P=0;w===0&&t.horizontalAlign===2&&M.leftSideBearing!==void 0&&(P=-M.leftSideBearing*n),v&&(E=i.getKerningValue(M,v)*n),u+=P+E;let I=0;if(S===`
`)I=l;else if(S===" ")I=c;else{let D=this.createPath(M,n,u,h,t);D&&(I=D.offsetX-(E+P),d.push(D.path))}if(C.replacements.length===1)f[g].push([u,h]),p[g].push(I);else{let D=C.replacements.map(z=>(i.glyphs.get(z).advanceWidth??0)*n),L=D.reduce((z,O)=>z+=O,0),B=D.map(z=>z/L),j=u;for(let z=0;z<B.length;z++){let O=I*B[z];f[g].push([j,h]),p[g].push(O),j+=O}}u+=I,v=M}h-=r}let m=[];for(let g=0,y=d.length;g<y;g++)m.push(...d[g].toShapes());return{shapes:m,charWidths:p,lineWidths:s,charCoords:f}}get isUserFont(){return this._isUserFont}get arrayBuffer(){return this._arrayBuffer}get ascender(){var e;return((e=this.font)==null?void 0:e.ascender)??0}get descender(){var e;return((e=this.font)==null?void 0:e.descender)??0}get familyName(){var e;return((e=this.font)==null?void 0:e.names.fontFamily)??""}get subfamilyName(){var e;return((e=this.font)==null?void 0:e.names.fontSubfamily)??""}get unitsPerEm(){var e;return((e=this.font)==null?void 0:e.unitsPerEm)??1}getLineInitialOffsetX(e,t,i,n,r){return(i===3||i===2)&&n.indexOf(`
`)>=0&&(e-=r),i===3?t*.5-e*.5:i===2?t-e:0}getLineInitialOffsetY(e,t,i,n,r){let s=t*e,a=Math.abs(this.ascender-this.descender)*n,o=e-a,l=-this.ascender*n-o/2;return r===3?-(i-s-l):r===2?-(i*.5-s*.5-l):l}createPath(e,t,i,n,r){var l;let s=e.getPath(i,-n,r.fontSize,{kerning:!1,letterSpacing:r.letterSpacing});if(!s){console.error('THREE.Font: character "'+e+'" does not exists in font family '+this.familyName+".");return}let a=new wme,o=(e.advanceWidth??1)*t;if(e)for(let c of s.commands){let u=(l=a.currentPath)==null?void 0:l.currentPoint;if(!(u&&c.type!=="Z"&&u.x===c.x&&-u.y===c.y))switch(c.type){case"M":a.moveTo(c.x,-c.y);break;case"L":a.lineTo(c.x,-c.y);break;case"Q":a.quadraticCurveTo(c.x1,-c.y1,c.x,-c.y);break;case"C":a.bezierCurveTo(c.x1,-c.y1,c.x2,-c.y2,c.x,-c.y);break}}return a.subPaths.forEach(c=>{let u=Pme(c.curves);u!==void 0&&c.currentPoint.distanceTo(u)>0&&c.lineTo(u.x,u.y)}),{offsetX:o+r.fontSize*r.letterSpacing,path:a}}getCharWidth(e,t){var i;return((i=this.font)==null?void 0:i.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))??0}getTextWidth(e,t){var i;return((i=this.font)==null?void 0:i.getAdvanceWidth(e,t.fontSize,{kerning:!0,letterSpacing:t.letterSpacing}))??0}computeSpaceWidthForLine(e,t,i){let n=this.getCharWidth(" ",i),r=e[t];if(r){let s=this.countSpaces(r.trimEnd());if(i.horizontalAlign===4&&t<e.length-1&&s){let a=i.width,o=this.getTextWidth(r,i);return(a-(o-s*n))/s}}return n}countSpaces(e){return(e.match(/ /g)||[]).length}};function Pme(e){if(e.length){let t=e[0];if(t instanceof ma)return t.v1;if(t instanceof oa||t instanceof Pc)return t.v0}}var Dme=class{constructor(){this.objects=new Map,this.unreachable=new Set}getCached(e){return this.objects.get(e)}get size(){return this.objects.size}get(e,t){let i=this.objects.get(e);return i===void 0?(i=this.createObject(e,t),this.objects.set(e,i)):i.isShared=!0,i}mutateIfUnique(e,t){let i=this.objects.get(e);if(i&&i.isShared!==!0)return this.objects.delete(e),this.objects.set(t,i),i}startGc(){this.unreachable=new Set(this.objects.keys())}markAsReachable(e,t){let i=this.objects.get(e);t===i&&this.unreachable.delete(e)}endGc(){this.unreachable.forEach(e=>{this.disposeObject(this.objects.get(e)),this.objects.delete(e)}),this.unreachable.clear()}dispose(){this.objects.forEach(e=>{this.disposeObject(e)}),this.objects.clear()}},DP=class extends Dme{constructor(e){super(),this.flatShading=e}disposeObject(e){e.dispose()}createObject(e,t){let i=mx(e,t,this.flatShading);return i.computeBoundingSphere(),i}},Lme={markNeedsUpdateRendererDirty:()=>{}},Rme=class extends eme{constructor(e){super(),this.shared=e}create(e){return new RF(e,this.shared)}},TA=class{constructor(e,t={}){if(this.data=e,this.geometryCache=new DP(!0),this.geometryCache2=new DP(!1),this.imageHolderCache=new Rme(this),this.thisContext={scene:Lme,shared:this},this.deletedMaterial=new xM(Xn.defaultTwoLayerData("phong"),this.thisContext),this.deletedImage=new wh(cx.emptyImage,this),this.deletedVideo=new wh(ix.defaultVideo,this),this.materials={},this.images={},this.videos={},this.colors={},this.audios={},this.fonts={},this.requestRender=()=>{this._requestRender&&this._requestRender()},t.images)for(let[i,n]of Object.entries(t.images))this.addImage(i,n);if(t.videos)for(let[i,n]of Object.entries(t.videos))this.addVideo(i,n);if(t.audios)for(let[i,n]of Object.entries(t.audios))this.addAudio(i,n);this.reset(e)}setRequestRender(e){this._requestRender=e}reset(e){this.resetLib(e.lib);for(let[t,i]of Object.entries(e.images))this.addImage(t,i);for(let[t,i]of Object.entries(e.videos))this.addVideo(t,i);for(let[t,i]of Object.entries(e.colors))this.addColor(t,i);for(let[t,i]of Object.entries(e.materials))this.addMaterial(t,i);for(let[t,i]of Object.entries(e.audios))this.addAudio(t,i);for(let[t,i]of Object.entries(e.fonts))this.addFont(t,i)}addMaterial(e,t){if(this.materials[e]){let i=this.materials[e];i.reset(t,this.thisContext),i.dispose()}else{let i=new xM(t,this.thisContext);i.uuid=e,this.materials[e]=i}}deleteMaterial(e){this.materials[e]&&(this.materials[e].nodeMaterialDispose(),delete this.materials[e])}getMaterial(e){return this.materials[e]}getMaterialOrDeletedPlaceholder(e){return this.materials[e]??this.deletedMaterial}material(e){return typeof e=="string"?this.getMaterialOrDeletedPlaceholder(e):e==null?(console.error("material is undefined or null"),this.deletedMaterial):new AA(e,this.thisContext)}getMaterials(){return this.materials}addImage(e,t){return this.images[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),this.images[e].updateSrc(t.data),!0):(this.images[e]=new wh(t,this),!1)}deleteImage(e){let t=this.images[e];t&&(t.dispose(),delete this.images[e])}getDefaultImage(){return this.images.image_0}getImage(e){return this.images[e]??this.deletedImage}image(e){return typeof e=="string"?this.getImage(e):this.imageHolderCache.load(e)}addVideo(e,t){return this.videos[e]?(this.videos[e].updateSrc(t.data),!0):(this.videos[e]=new wh(t,this),!1)}deleteVideo(e){let t=this.videos[e];t&&(t.dispose(),delete this.videos[e])}getVideo(e){return this.videos[e]??this.deletedVideo}video(e){return typeof e=="string"?this.getVideo(e):this.imageHolderCache.load(e)}addColor(e,t){return this.colors[e]?(this.onColorOrImageUpdate&&this.onColorOrImageUpdate(),"a"in t?this.colors[e].setRGBA(t.r,t.g,t.b,t.a):this.colors[e].setRGBA(t.r,t.g,t.b,1),!0):("a"in t?this.colors[e]=new gx(t.r,t.g,t.b,t.a):this.colors[e]=new gx(t.r,t.g,t.b,1),!1)}updateColor(e,t){if(this.colors[e]){this.onColorOrImageUpdate&&this.onColorOrImageUpdate();let i=this.colors[e];return this.colors[e].r=t.r??i.r,this.colors[e].g=t.g??i.g,this.colors[e].b=t.b??i.b,this.colors[e].a=t.a??i.a,!0}return!1}deleteColor(e){this.colors[e]&&delete this.colors[e]}getColor(e){return this.colors[e]}color(e){let t;if(typeof e=="string"){let i=this.getColor(e);i?t=i:(console.warn("Tried to create color layer params with a color key that does not exist in the assets manager"),t=new Or(0,0,0,0))}else return"a"in e?new Or(e.r,e.g,e.b,e.a):new Or(e.r,e.g,e.b,1);return t}addAudio(e,t){this.audios[e]=t}getAudio(e){let t=this.audios[e];if(t instanceof ym)return t;{let i=new ym({src:t.data});return this.audios[e]=i,i}}deleteAudio(e){let t=this.audios[e];t&&(t instanceof ym&&t.dispose(),delete this.audios[e])}addFont(e,t){this.fonts[e]=new Tme(t),this.fonts[e].loadingPromise.then(()=>this.requestRender())}getFont(e){return this.fonts[e]}deleteFont(e){this.fonts[e]&&delete this.fonts[e]}dispose(){Object.keys(this.materials).forEach(e=>this.deleteMaterial(e)),this._requestRender=void 0,Object.values(this.audios).forEach(e=>{e instanceof ym&&e.dispose()}),this.audios={},this.geometryCache.dispose(),this.geometryCache2.dispose()}resetLib(e){for(let[t,i]of Object.entries(e.images))this.addImage(t,i.asset);for(let[t,i]of Object.entries(e.audios))this.addAudio(t,i.asset);for(let[t,i]of Object.entries(e.colors))this.addColor(t,i.asset);for(let[t,i]of Object.entries(e.fonts))this.addFont(t,i.asset);for(let[t,i]of Object.entries(e.materials))this.addMaterial(t,i.asset);for(let[t,i]of Object.entries(e.videos))this.addVideo(t,i.asset)}updateLibByOp(e,t){e.path[0]==="images"?e.path.length===1&&e.type===1?this.addImage(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteImage(e.id):e.path[0]==="videos"?e.path.length===1&&e.type===1?this.addVideo(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteVideo(e.id):e.path[0]==="audios"?e.path.length===1&&e.type===1?this.addAudio(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteAudio(e.id):e.path[0]==="colors"?e.path.length===1&&e.type===1?this.addColor(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteColor(e.id):e.path[0]==="materials"?e.path.length===1&&e.type===1?this.addMaterial(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteMaterial(e.id):e.path[0]==="fonts"?e.path.length===1&&e.type===1?this.addFont(e.id,e.data.asset):e.path.length===1&&e.type===2&&this.deleteFont(e.id):e.path[0]==="components"&&t.updateByLibOp(e,this)}updateByOp(e,t,i){this.data=t,e.path[0]==="images"?e.path.length===2&&e.type===0?e.props.data&&this.getImage(e.path[1]).updateSrc(e.props.data):e.path.length===1&&e.type===1?this.addImage(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteImage(e.id):e.path[0]==="videos"?e.path.length===2&&e.type===0?e.props.data&&this.getVideo(e.path[1]).updateSrc(e.props.data):e.path.length===1&&e.type===1?this.addVideo(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteVideo(e.id):e.path[0]==="audios"?e.path.length===2&&e.type===0?e.props.data&&this.addAudio(e.path[1],t.audios[e.path[1]]):e.path.length===1&&e.type===1?this.addAudio(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteAudio(e.id):e.path[0]==="colors"?e.path.length===2&&e.type===0?this.updateColor(e.path[1],e.props):e.path.length===1&&e.type===1?this.addColor(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteColor(e.id):e.path[0]==="materials"?e.path.length===1&&e.type===1?this.addMaterial(e.id,e.data):e.path.length===1&&e.type===2?this.deleteMaterial(e.id):e.path.length>1&&this.getMaterial(e.path[1]).updateByOp(hr.drop(e,2),t.materials[e.path[1]],{shared:this,scene:i}):e.path[0]==="fonts"?e.path.length===2&&e.type===0?this.updateFont(e.path[1],e,i):e.path.length===1&&e.type===1?this.addFont(e.id,e.data):e.path.length===1&&e.type===2&&this.deleteFont(e.id):e.path[0]==="lib"&&this.updateLibByOp(hr.drop(e,1),i)}updateFont(e,t,i){if(t.props.url){let n=this.getFont(e),r={...this.data.fonts[e],url:t.props.url};n.update(r),n.loadingPromise.then(()=>this.requestRender()),i.updateFont(e,this)}}};new TA(Ho.emptyData());var of=class extends zr{updateByPatchedOp(e,t,i){if(super.updateByPatchedOp(e,t,i),fue(e.path,["materials"])!==null&&e.type===0&&Array.isArray(this.material))for(let[n,r]of Object.entries(e.props)){let s=i.shared.material(r);this.material[Number(n)]=s}else if(Ps(e.path,["material"])&&this.material instanceof Lc)"material"in t&&typeof t.material!="string"&&this.material.updateByOp(hr.drop(e,1),t.material,i);else if(Ps(e.path,["materials","*"])&&Array.isArray(this.material)){let n=e.path[1];if("materials"in t&&n<this.material.length){let r=t.materials[n];typeof r!="string"&&this.material[n].updateByOp(hr.drop(e,2),r,i)}}}get needsAO(){return this.material!==void 0?(Array.isArray(this.material)?this.material[0]:this.material).hasAO:!1}updateState(e,t){var n,r;super.updateState(e,t),e.castShadow!==void 0&&(this.castShadow=e.castShadow),e.receiveShadow!==void 0&&(this.receiveShadow=e.receiveShadow);let i=this.dataPatched;if(((n=e.geometry)==null?void 0:n.type)!=="NonParametricGeometry"&&"material"in e&&e.material!==void 0&&(this.disposeMaterial(),this.material=t.shared.material(e.material).getFlavor(i.flatShading,i.side,i.wireframe),t.scene.markNeedsUpdateRendererDirty()),((r=e.geometry)==null?void 0:r.type)==="NonParametricGeometry"&&("materials"in e&&e.materials!==void 0?(this.disposeMaterial(),this.material=e.materials.map(s=>t.shared.material(s).getFlavor(i.flatShading,i.side,i.wireframe)),t.scene.markNeedsUpdateRendererDirty()):"material"in e&&e.material!==void 0&&(this.disposeMaterial(),this.material=[t.shared.material(e.material).getFlavor(i.flatShading,i.side,i.wireframe)],t.scene.markNeedsUpdateRendererDirty())),e.flatShading!==void 0||e.wireframe!==void 0||e.side!==void 0)if(Array.isArray(this.material))for(let s=0;s<this.material.length;s++)this.material[s]=this.material[s].getFlavor(i.flatShading,i.side,i.wireframe);else this.material=this.material.getFlavor(i.flatShading,i.side,i.wireframe)}disposeMaterial(){this.material&&WN(this.material).forEach(e=>{e instanceof Lc&&(e instanceof xM||e.nodeMaterialDispose())})}dispose(){this.disposeMaterial(),super.dispose()}},LP=new T,RP=new Ct,IP=new Ct,Ime=new T,OP=new ke,dr=class extends of{constructor(e,t,i){super(e,t),this.data=t,this.localGeometry=void 0,t.bindMode&&t.bindMatrix&&(this.isSkinnedMesh=!0,this.bindMode=t.bindMode,this.bindMatrix=new ke().fromArray(t.bindMatrix),this.bindMatrixInverse=new ke)}chooseGeoemtryCache(e){return e.geometryCache}markGeometryAsReachable(e){this.geometryCreateDeleyed instanceof mt&&this.chooseGeoemtryCache(e).markAsReachable(this.dataPatched.geometry,this.geometryCreateDeleyed)}get geometry(){if(this.localGeometry!==void 0)return this.localGeometry;if(this.geometryCreateDeleyed instanceof TA){let e=this.geometryCreateDeleyed,t=this.chooseGeoemtryCache(e);this.geometryCreateDeleyed=t.get(this.dataPatched.geometry,e)}return this.geometryCreateDeleyed}set geometry(e){this.localGeometry=e}get is2DAndNoDepth(){let e=this.dataPatched.geometry;return sx.is2DParametricMesh(e.type)&&e.depth===0}get is2DType(){return sx.is2DParametricMesh(this.geometry.userData.type)}get isNonParametric(){return this.geometry.userData.type==="NonParametricGeometry"}updateByPatchedOp(e,t,i){super.updateByPatchedOp(e,t,i),Ps(e.path,["geometry"])&&this.updateByPatchedOpGeometry(hr.drop(e,1),t.geometry,i)}removeInteractionGeometry(){var e;(e=this.localGeometry)==null||e.dispose(),this.localGeometry=void 0}updateGeometryInteractions(e,t){var n;this.invalidateDownstreamBooleanData();let i=this.data.geometry.type;if(i==="NonParametricGeometry"||i==="SubdivGeometry"){let r=e;if(this.localGeometry===void 0){let c={...this.data.geometry,...r};this.localGeometry=mx(c,t,this.data.flatShading)}let s,a,o;r.scaleBaked?[s,a,o]=r.scaleBaked:{width:s,height:a,depth:o}=r;let l=this.localGeometry.userData;l.sxPrev!==void 0&&fM(this.localGeometry.attributes,s/l.sxPrev,a/l.syPrev,o/l.szPrev),l.sxPrev=s,l.syPrev=a,l.szPrev=o}else{let r={...this.data.geometry,...e};(n=this.localGeometry)==null||n.dispose(),this.localGeometry=mx(r,t,this.data.flatShading)}}refreshAttachedCloners(e){for(let t of this.attachedSurfaceCloners)e.scene.addPendingUpdateCloner(t.object)}refreshAttachedPaths(e){for(let t of this.attachedPaths)e.scene.addPendingCommand(()=>t.updateShape())}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.refreshAttachedCloners(e),this.refreshAttachedPaths(e)}updateByPatchedOpGeometry(e,t,i){var r;let n=!1;e.type===0&&e.path.length===0&&tA(["scaleBaked"],Object.keys(e.props))&&this.geometryCreateDeleyed instanceof ar&&this.chooseGeoemtryCache(i.shared).mutateIfUnique(this.geometryCreateDeleyed.data,t)===this.geometryCreateDeleyed&&(n=!0,this.geometryCreateDeleyed.mutateDirectlyScaleBaked(t,e.props.scaleBaked),this.refreshAttachedCloners(i),this.refreshAttachedPaths(i)),n||((r=i.scene)==null||r.markGeometryCacheDirty(),this.createGeometryDelayed(i)),this.resetBBoxNeedsUpdate(),this.invalidateDownstreamBooleanData()}updateGeometryOnStateUpdate(e,t){this.createGeometryDelayed(t)}updateState(e,t){e.geometry!==void 0&&this.updateGeometryOnStateUpdate(e.geometry,t),super.updateState(e,t)}updateGeometryGroupsIfNeeded(){var e;Array.isArray(this.material)&&this.geometry.groups.length===0&&this.geometry.addGroup(0,Math.max(((e=this.geometry.getIndex())==null?void 0:e.count)??0,this.geometry.getAttribute("position").count),0)}updateEntityBoxSize(e,t){let i=this.geometry.userData.parameters;this.is2DType?e.set(0,0,i.depth*.5):this.isNonParametric?(e.setScalar(0),this.geometry.boundingSphere&&e.copy(this.geometry.boundingSphere.center),t.set(i.width,i.height,i.depth??0).multiplyScalar(.5)):e.setScalar(0),t.set(i.width,i.height,i.depth??0).multiplyScalar(.5)}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"&&this.bindMatrixInverse.copy(this.bindMatrix).invert()}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(e){let t=new Ct,i=this.geometry.attributes.skinWeight;for(let n=0,r=i.count;n<r;n++){t.fromBufferAttribute(i,n);let s=1/t.manhattanLength();s!==1/0?t.multiplyScalar(s):t.set(1,0,0,0),i.setXYZW(n,t.x,t.y,t.z,t.w)}}boneTransform(e,t){let i=this.skeleton;if(i===void 0)return;let n=this.geometry;RP.fromBufferAttribute(n.attributes.skinIndex,e),IP.fromBufferAttribute(n.attributes.skinWeight,e),LP.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let r=0;r<4;r++){let s=IP.getComponent(r);if(s!==0){let a=RP.getComponent(r);OP.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(Ime.copy(LP).applyMatrix4(OP),s)}}return t.applyMatrix4(this.bindMatrixInverse)}};function Ome(e){var a,o;if(e.geometry.attributes.extrudeNormal||!e.geometry.attributes.position||!e.geometry.attributes.normal)return;let t=new Map,i=e.geometry.attributes,n=i.position.array,r=i.normal.array,s=new Float32Array(n.length);for(let l=0;l<n.length;l+=3){let c=`${n[l]}_${n[l+1]}_${n[l+2]}`,u=new T(r[l],r[l+1],r[l+2]);t.has(c)?(a=t.get(c))==null||a.normals.push(u):t.set(c,{normals:[u],result:new T})}t.forEach((l,c)=>{for(let u of l.normals)l.result.add(u);l.result.divideScalar(l.normals.length)});for(let l=0;l<n.length;l+=3){let c=`${n[l]}_${n[l+1]}_${n[l+2]}`,u=(o=t.get(c))==null?void 0:o.result;u&&(s[l]=u.x,s[l+1]=u.y,s[l+2]=u.z)}e.geometry.setAttribute("extrudeNormal",new et(s,3))}function Bme(e){if(e.geometry.attributes.extrudeNormals||!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,i=new Float32Array(t.length),n=new T;for(let r=0;r<t.length;r+=3)n.set(t[r],t[r+1],t[r+2]).normalize(),i[r]=n.x,i[r+1]=n.y,i[r+2]=n.z;e.geometry.setAttribute("extrudeNormal",new et(i,3))}function PA(e){if(Array.isArray(e.material)){for(let t of e.material)if(t.getLayersOfType("outline").length===0)return}else if(!(e.material instanceof Lc)||e.material.getLayersOfType("outline").length===0)return;e instanceof dr&&e.is2DAndNoDepth?Bme(e):Ome(e)}function DA(e){if(!e.geometry.attributes.position)return;let t=e.geometry.attributes.position.array,i=new Float32Array(t.length),n=parseInt(e.uuid.replace(/\D/g,"")),r=[Dt.seededRandom(n),Dt.seededRandom(n+1e4),Dt.seededRandom(n+2e4)];for(let s=0;s<t.length;s++)i[s]=r[s%3];e.geometry.setAttribute("randomColor",new gt(i,3))}bA.then(e=>{});var Pa=new Vi,Gf=new T;function Nme(e){let t=!1;return e.scene.objects.traverse((i,n)=>{n.type==="Mesh"&&n.geometry.type==="SubdivGeometry"&&(t=!0)}),t}var U0=class extends dr{constructor(e,t,i){super(e,t,i),this.data=t,this.hiddenMatrixOld=new ke,this.smoothShading=!0,this.skipReactionUpdate=!1}chooseGeoemtryCache(e){return this.dataPatched.flatShading?e.geometryCache:e.geometryCache2}get subdivPointerNew(){return this.localGeometry!==void 0?this.subdivPointer:this.geometry.ensureSubdivPointer()}get originalGeometryNew(){return this.localGeometry!==void 0?this.originalGeometry:this.geometry.originalGeometry}get phongAngle(){return this.data.geometry.phongAngle??45}updateEntityBoxSize(e,t){let i=this.geometry.userData.parameters;e.copy(this.originalGeometryNew.boundingSphere.center),t.set(i.width,i.height,i.depth??0).multiplyScalar(.5)}createGeometryByControls(e){var s,a,o;if(this.skipReactionUpdate===!0)return;let t=(s=this.localGeometry)==null?void 0:s.uuid,{originalGeometry:i,subdividedGeometry:n,subdivPointer:r}=ar.build(e,this.subdivPointer,this.smoothShading,this.hasNonUniformScale?this.shearScale:void 0);this.subdivPointer=r,i!==void 0&&((a=this.originalGeometry)==null||a.dispose(),this.originalGeometry=i),n!==void 0&&((o=this.subdividedGeometry)==null||o.dispose(),this.subdividedGeometry=n??void 0),this.localGeometry=this.subdividedGeometry??this.originalGeometry,PA(this),DA(this),this.calcBoundingBox(),t&&(this.localGeometry.uuid=t)}updateState(e,t){if(super.updateState(e,t),e.flatShading!==void 0){let i=this.material;this.material=i.getFlavor(!1,i.side,i.wireframe),this.smoothShading=!e.flatShading,this.createGeometryDelayed(t)}}updateMesh(e=!1){ar.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1,this.originalGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0),this.subdividedGeometry&&ar.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1,this.subdividedGeometry,e&&this.hasNonUniformScale?this.shearScaleInv:void 0)}updateTopology(){this.originalGeometry.dispose(),this.originalGeometry=ar.buildLevel(this.subdivPointer,!0,this.smoothShading?this.phongAngle:-1),this.subdividedGeometry&&(this.subdividedGeometry.dispose(),this.subdividedGeometry=ar.buildLevel(this.subdivPointer,!1,this.smoothShading?this.phongAngle:-1)),this.localGeometry=this.subdividedGeometry??this.originalGeometry}raycast(e,t){let i=this.localGeometry;this.localGeometry=this.originalGeometryNew,zr.prototype.raycast.call(this,e,t),this.localGeometry=i}activateSVDCompensation(){!this.hasNonUniformScale||(this.matrix.copy(this.matrixWorldRigid),this.hiddenMatrixOld.copy(this.hiddenMatrix),this.hiddenMatrix.copy(this.parent.matrixWorld).invert())}deactivateSVDCompensation(){!this.hasNonUniformScale||(this.updateMatrix(),this.hasNonUniformScale=void 0,this.hiddenMatrix.copy(this.hiddenMatrixOld))}calcBoundingBox(){let e=this.originalGeometry;e.boundingSphere===null&&(e.boundingSphere=new ls,this.subdividedGeometry&&(this.subdividedGeometry.boundingSphere=e.boundingSphere));let t=e.attributes.position,i=e.boundingSphere.center;Pa.setFromBufferAttribute(t),Pa.getCenter(i),e.boundingSphere.radius=i.distanceTo(Pa.max),isNaN(e.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this),Pa.getSize(Gf),this.hasNonUniformScale&&Gf.divide(this.scale);let n={width:Gf.x,height:Gf.y,depth:Gf.z};return this.geometry.userData.parameters=n,n}updateBoundingSphere(e){let t=this.originalGeometry;Pa.min.set(e[0],e[2],e[4]),Pa.max.set(e[1],e[3],e[5]),this.hasNonUniformScale&&(Pa.min.applyMatrix4(this.shearScaleInv),Pa.max.applyMatrix4(this.shearScaleInv)),t.boundingSphere===null&&(t.boundingSphere=new ls);let i=t.boundingSphere.center;Pa.getCenter(i),t.boundingSphere.radius=i.distanceTo(Pa.max)}freeSubdivPointer(){var e,t;this.subdivPointer&&(ar.freeSubdivPointer(this.subdivPointer),this.subdivPointer=0),this.localGeometry=void 0,(e=this.originalGeometry)==null||e.dispose(),(t=this.subdividedGeometry)==null||t.dispose()}dispose(){super.dispose(),this.freeSubdivPointer()}updateByPatchedOpGeometry(e,t,i){super.updateByPatchedOpGeometry(e,t,i),this.localGeometry&&this.createGeometryByControls(t)}},BP=-1,Ume=1,Fme={x:[1,0,0],"-x":[-1,0,0],y:[0,1,0],"-y":[0,-1,0],z:[0,0,1],"-z":[0,0,-1]},zme={polygon_center:0,edge:1,vertex:2},k1=(e,t)=>(i,n)=>!t||i===0||e===0?0:e*n/100,St=(e,t)=>{let i=Math.abs(t),n=i*-1;return(e-BP)*(i-n)/(Ume-BP)+n};function kme(e){let t=[],i={};for(var n=0,r=e.length;n<r;n++){var s=JSON.stringify(e[n].pos.map(a=>Math.round(a*1e4)/1e4));i[s]||(t.push(e[n]),i[s]=!0)}return t}var Vme=new T,V1=new T,Hme=new T,Gme=new T;function sp(e,t){let i=Hme.fromArray(e),n=Gme.fromArray(t);V1.copy(n).sub(i);let r=V1.length();return V1.normalize().multiplyScalar(r*.5),Vme.copy(i).add(V1).toArray()}var Es=new Gn,H1=new T,yx=new T,ph=new T;function jme(e){let t=[];for(let i=0;i<=e.index.count;i++)if(H1.fromArray(e.index.array,i*3),Es.setFromAttributeAndIndices(e.attributes.position,H1.x,H1.y,H1.z),Es.getNormal(yx),Es.getMidpoint(ph),!(isNaN(ph.x)||isNaN(ph.y)||isNaN(ph.z))){let{a:n,b:r,c:s}=Es,a=n.toArray(),o=r.toArray(),l=s.toArray(),c=n.distanceTo(r),u=r.distanceTo(s),h=s.distanceTo(n),d=sp(a,o),p=sp(o,l),f=sp(l,a),v=[c,u,h],m=Math.max(...v),g=v.filter(_=>Math.round(_)===Math.round(m)).length>1,y=[],x=Es.getMidpoint(ph).toArray();m===c&&!g&&(y=[p,f,f],x=d),m===u&&!g&&(y=[d,f,f],x=p),m===h&&!g&&(y=[d,p,p],x=f),g&&(y=[d,p,f]),t.push({vertices:[a,o,l],faceCenters:y,midpoint:x,norm:Es.getNormal(yx).toArray()})}return t}function Wme(e){let t=[],{position:i}=e.attributes;for(let n=0;n<i.count;n++){Es.setFromAttributeAndIndices(i,n*3,n*3+1,n*3+2),Es.getNormal(yx),Es.getMidpoint(ph);let r=Es.a.toArray(),s=Es.b.toArray(),a=Es.c.toArray();t.push({vertices:[r,s,a],faceCenters:[sp(r,s),sp(s,a),sp(a,r)],midpoint:ph.toArray(),norm:yx.toArray()})}return t}var Xme=4,qme=.5,Ub=e=>.5*(1-Math.cos(e*Math.PI)),Yme=class{constructor(){this.perlin=new Array(4095+1)}noise(e,t=0,i=0){if(this.perlin==null){this.perlin=new Array(4095+1);for(let m=0;m<4095+1;m++)this.perlin[m]=Math.random()}e<0&&(e=-e),t<0&&(t=-t),i<0&&(i=-i);let n=Math.floor(e),r=Math.floor(t),s=Math.floor(i),a=e-n,o=t-r,l=i-s,c,u,h=0,d=.5,p,f,v;for(let m=0;m<Xme;m++){let g=n+(r<<4)+(s<<8);c=Ub(a),u=Ub(o),p=this.perlin[g&4095],p+=c*(this.perlin[g+1&4095]-p),f=this.perlin[g+16&4095],f+=c*(this.perlin[g+16+1&4095]-f),p+=u*(f-p),g+=256,f=this.perlin[g&4095],f+=c*(this.perlin[g+1&4095]-f),v=this.perlin[g+16&4095],v+=c*(this.perlin[g+16+1&4095]-v),f+=u*(v-f),p+=Ub(l)*(f-p),h+=p*d,d*=qme,n<<=1,a*=2,r<<=1,o*=2,s<<=1,l*=2,a>=1&&(n++,a--),o>=1&&(r++,o--),l>=1&&(s++,l--)}return h}noiseSeed(e){let t=(()=>{let i,n;return{setSeed(r){n=i=(r??Math.random()*4294967296)>>>0},getSeed(){return i},rand(){return n=(1664525*n+1013904223)%4294967296,n/4294967296}}})();t.setSeed(e),this.perlin=new Array(4095+1);for(let i=0;i<4095+1;i++)this.perlin[i]=t.rand()}},Zme=Yme,NP=new T,UP=new ke,FP=new Wp;function zP(e){let t=!1;return e.scene.objects.traverse((i,n)=>{n.type==="Mesh"&&n.geometry.type==="TextGeometry"&&(t=!0)}),t}var zF=class extends dr{constructor(e,t,i){super(e,t,i),this.data=t}get textGeometry(){return this.geometry}get charWidths(){return this.textGeometry.charWidths}get charCoords(){return this.textGeometry.charCoords}get wrappedText(){return this.textGeometry.wrappedText}get font(){return this.textGeometry.font}get initialOffsetY(){var t;let e=this.dataPatched;return((t=this.font)==null?void 0:t.getLineInitialOffsetY(this.lineHeight,this.wrappedText.length,e.geometry.height,this.fontScale,e.geometry.verticalAlign))??0}get fontScale(){let e=this.dataPatched;return this.font?e.geometry.fontSize/this.font.unitsPerEm:1}get AD(){return Math.abs(this.ascender-this.descender)}get ascender(){var e;return(((e=this.font)==null?void 0:e.ascender)??1)*this.fontScale}get descender(){var e;return(((e=this.font)==null?void 0:e.descender)??1)*this.fontScale}get lineHeight(){let e=this.dataPatched;return e.geometry.fontSize*e.geometry.lineHeight}raycast(e,t){let{matrixWorld:i}=this;if(!(isNaN(e.ray.origin.x)||this.scale.x===0||this.scale.y===0||this.scale.z===0)&&(UP.copy(i).invert(),FP.copy(e.ray).applyMatrix4(UP),FP.intersectBox(this.singleBBox,NP))){let n=NP.applyMatrix4(i),r=e.ray.origin.distanceTo(n);t.push({distance:r,point:n.clone(),object:this})}}},$n=1e-4,Da,kF,VF,HF,kP=new T,VP=new T;bA.then(e=>{Da=e,kF=[Da.get_face_center,Da.get_edge_midpoint,Da.get_vertex_position],VF=[Da.get_face_normal,Da.get_edge_normal,Da.get_vertex_normal],HF=[Da.face_count,Da.edge_count,Da.vertex_count]});var Qme=new ke,Kme=new ke,Ml=new T,qc=new T,jf=new T,Fb=new T,$me=new T,Jme=new T,bo=new Zme,ha=class extends pA($t){constructor(e,t){super(),this.parameters=t,this.objectForSample=void 0,this._pendingMediaLoad=!1,this.object=e}resetOnMove(){this.removeFromParent(),this.parent=null}expandClones(e){if(this.parent===null)this.updateState(this.parameters,e);else for(let t of this.children)t instanceof Wn&&t.expand()}invalidateTransform(e){this.matrixWorldNeedsUpdate=!0,this.traverse(t=>{t instanceof Wn&&t.object===e&&(t.matrixWorldNeedsUpdate=!0)})}onObjUpdateMatrix(){this.parameters.type!=="toObject"&&(this.matrixWorldNeedsUpdate=!0)}update(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters);break;case"toObject":this._updateToObject(this.parameters)}for(let e of this.children)e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD())}_updateCount(e){let t;if(e!==void 0?t=e:t=this.parameters.type==="grid"?Math.round(this.parameters.grid.count[0])*Math.round(this.parameters.grid.count[1])*Math.round(this.parameters.grid.count[2]):this.parameters.count,this.parameters.type==="toObject"&&!this.parameters.toObject.object&&(t=0),this.parameters.type==="toObject"&&this.objectForSample){for(let n=0,r=this.children.length;n<r;++n)this.remove(this.children[0]);let i=this.children;if(i.length===t)return;if(i.length<t)for(let n=0,r=t-i.length;n<r;++n){let s=new Wn(this.object);s.expand(),this.add(s)}else for(let n=0,r=i.length-t;n<r;++n)this.remove(i[n])}else{if(this.children.length===t)return;if(this.children.length<t)for(let i=0,n=t-this.children.length;i<n;++i){let r=new Wn(this.object);r.expand(),this.add(r)}else for(let i=0,n=this.children.length-t;i<n;++i)this.remove(this.children[0])}}_updateRadial(e){let t=e.radial,i=t.start*Dt.DEG2RAD,n=t.end*Dt.DEG2RAD,r=i-n,s=new bn(t.rotation[0],t.rotation[1],t.rotation[2]),a;switch(t.axis){case"z":a=new T(0,0,1);break;case"y":a=new T(0,1,0);break;default:case"x":a=new T(1,0,0);break}let o=e.randomnessObject??Jl.defaultData([1,1,1]).randomnessObject,l=o.noiseType==="perlin";bo.noiseSeed(o.seed);let c=bb((0,Uf.default)(o.seed)),u=k1(o.strength,this.parameters.randomness);for(let[h,d]of this.children.entries()){let p=h*(o.freqScale/10)+o.movement,f=l?bo.noise(p):c(p,p),v=h+1;d.scale.x=t.scale[0]+u(v,St(f,o.scale[0]))||$n,d.scale.y=t.scale[1]+u(v,St(f,o.scale[1]))||$n,d.scale.z=t.scale[2]+u(v,St(f,o.scale[2]))||$n,d.position.setScalar(0);let m=r/e.count*h-i;switch(t.axis){case"x":d.rotation.set(0,m,0);break;case"y":d.rotation.set(0,0,m);break;case"z":d.rotation.set(m,0,0);break}d.translateOnAxis(a,t.radius),d.position.x+=t.position[0]+u(v,St(f,o.position[0])),d.position.y+=t.position[1]+u(v,St(f,o.position[1])),d.position.z+=t.position[2]+u(v,St(f,o.position[2]));let g=u(v,St(f,o.rotation[0])),y=u(v,St(f,o.rotation[1])),x=u(v,St(f,o.rotation[2]));t.alignment===!0?(d.rotation.x+=s.x+g,d.rotation.y+=s.y+y,d.rotation.z+=s.z+x):d.rotation.set(s.x+g,s.y+y,s.z+x)}}_updateLinear(e){if(e.type!=="linear")throw new Error;let t=e.linear,i=new bn(t.rotation[0],t.rotation[1],t.rotation[2]),n=e.randomnessObject??Jl.defaultData([1,1,1]).randomnessObject,r=n.noiseType==="perlin";bo.noiseSeed(n.seed);let s=bb((0,Uf.default)(n.seed)),a=k1(n.strength,this.parameters.randomness);for(let[o,l]of this.children.entries()){let c=o*(n.freqScale/10)+n.movement,u=r?bo.noise(c):s(c,c),h=o+1,d=a(h,St(u,n.rotation[0])),p=a(h,St(u,n.rotation[1])),f=a(h,St(u,n.rotation[2]));l.scale.x=1+(t.scale[0]-1)*o+a(h,St(u,n.scale[0]))||$n,l.scale.y=1+(t.scale[1]-1)*o+a(h,St(u,n.scale[1]))||$n,l.scale.z=1+(t.scale[2]-1)*o+a(h,St(u,n.scale[2]))||$n,l.rotation.x=i.x*o+d,l.rotation.y=i.y*o+p,l.rotation.z=i.z*o+f,l.position.x=t.position[0]*o+a(h,St(u,n.position[0])),l.position.y=t.position[1]*o+a(h,St(u,n.position[1])),l.position.z=t.position[2]*o+a(h,St(u,n.position[2]))}}_updateGrid(e){let t=0,i=e.grid,n=e.randomnessObject??Jl.defaultData([1,1,1]).randomnessObject,r=k1(n.strength,this.parameters.randomness),s=n.noiseType==="perlin";bo.noiseSeed(n.seed);let a=Vde((0,Uf.default)(n.seed));if(i.useCenter===!0){let o={x:i.count[0]%2===0?2:1,y:i.count[1]%2===0?2:1,z:i.count[2]%2===0?2:1},l=new T(i.size[0]*(i.count[0]-o.x)*.5,i.size[1]*(i.count[1]-o.y)*.5,i.size[2]*(i.count[2]-o.z)*.5);for(let c=0;c<i.count[0];c++)for(let u=0;u<i.count[1];u++)for(let h=0;h<i.count[2];h++){let d=[(c+1)*(n.freqScale/10)+n.movement,(u+1)*(n.freqScale/10)+n.movement,(h+1)*(n.freqScale/10)+n.movement],p=s?bo.noise(...d):a(...d),f=this.children[t++];f.scale.x=1+r(t,St(p,n.scale[0]))||$n,f.scale.y=1+r(t,St(p,n.scale[1]))||$n,f.scale.z=1+r(t,St(p,n.scale[2]))||$n;let v=r(t,St(p,n.rotation[0])),m=r(t,St(p,n.rotation[1])),g=r(t,St(p,n.rotation[2]));f.rotation.set(v,m,g),f.position.x=i.size[0]*c-l.x+r(t,St(p,n.position[0])),f.position.y=i.size[1]*u-l.y+r(t,St(p,n.position[1])),f.position.z=i.size[2]*h-l.z+r(t,St(p,n.position[2]))}}else for(let o=0;o<i.count[0];o++)for(let l=0;l<i.count[1];l++)for(let c=0;c<i.count[2];c++){let u=[(o+1)*(n.freqScale/10)+n.movement,(l+1)*(n.freqScale/10)+n.movement,(c+1)*(n.freqScale/10)+n.movement],h=s?bo.noise(...u):a(...u),d=this.children[t++];d.scale.x=1+r(t,St(h,n.scale[0]))||$n,d.scale.y=1+r(t,St(h,n.scale[1]))||$n,d.scale.z=1+r(t,St(h,n.scale[2]))||$n;let p=r(t,St(h,n.rotation[0])),f=r(t,St(h,n.rotation[1])),v=r(t,St(h,n.rotation[2]));d.rotation.set(p,f,v),d.position.x=i.size[0]*o+r(t,St(h,n.position[0])),d.position.y=-i.size[1]*l+r(t,St(h,n.position[1])),d.position.z=-i.size[2]*c+r(t,St(h,n.position[2]))}}_updateToObject(e){var v;if(e.type!=="toObject")throw new Error;let{toObject:t}=e,i=new bn(t.rotation[0],t.rotation[1],t.rotation[2]),n=e.randomnessObject??Jl.defaultData([1,1,1]).randomnessObject,r=n.noiseType==="perlin";bo.noiseSeed(n.seed);let s=bb((0,Uf.default)(n.seed)),a=k1(n.strength,this.parameters.randomness);if(!t.object){for(let[,m]of this.children.entries())m.position.set(0,0,0),m.scale.setScalar(1),m.rotation.set(0,0,0);this.objectForSample=void 0;return}if(!this.objectForSample)return;if(this.objectForSample instanceof zF)if(!((v=this.objectForSample.font)!=null&&v.isLoaded)||this.objectForSample.geometry.attributes.position===void 0){this._pendingMediaLoad=!0;return}else this._pendingMediaLoad=!1;if(this.objectForSample.geometry===void 0&&this.objectForSample.isAncestorOf(this.object.uuid)){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) seem to be a child/descendant of the object it's being cloned to. Please re-parent it so that they are siblings instead.`);return}let o=this.getSubdivData(),l=[],c=m=>{let g=m.length,y=m.map(b=>b[0]).reduce((b,w)=>b+w,0),x=m.map(b=>b[1]).reduce((b,w)=>b+w,0),_=m.map(b=>b[2]).reduce((b,w)=>b+w,0);return[y/g,x/g,_/g]},u=m=>Math.round(m*1e6)/1e6;o.forEach(m=>{let g=o.filter(y=>u(m.pos[0])===u(y.pos[0])&&u(m.pos[1])===u(y.pos[1])&&u(m.pos[2])===u(y.pos[2]));g.length>1?l.push({pos:m.pos,norm:c(g.map(y=>y.norm))}):l.push(m)});let h=kme(l);if(h.length>0){let m=Math.round(h.length*t.count/100);this._updateCount(m)}else{let m=this.objectForSample.geometry.getAttribute("position");if(!m||isNaN(m.count)||m.count===0){console.warn(`Oh no! The object "${this.object.name}" (${this.object.uuid}) cannot be cloned on the surface of "${this.objectForSample.name}" (${this.objectForSample.uuid}) because the latter does not have a valid geometry.`);return}}this.objectForSample.updateMatrixWorld();let d=new Hde(this.objectForSample).build(),p=Fme[t.axis],f=this.children;d.setRandomGenerator((0,Uf.default)(this.object.uuid+t.seed));for(let[m,g]of f.entries()){let y=m*(n.freqScale/10)+n.movement,x=r?bo.noise(y):s(y,y),_=m+1,b=a(_,St(x,n.rotation[0])),w=a(_,St(x,n.rotation[1])),M=a(_,St(x,n.rotation[2]));t.spreadType==="random"?d.sample(jf,Fb):(h.length&&(jf.fromArray(h[m].pos),Fb.fromArray(h[m].norm)),this.objectForSample instanceof U0&&jf.applyMatrix4(Qme.copy(this.objectForSample.matrixWorld).invert())),jf.applyMatrix4(this.object.hiddenMatrix.clone().invert()),g.position.copy(jf),Ml.fromArray(p);let S=t.align==="normal"?Fb:this.object.getWorldDirection(Jme),C=qc.fromArray(t.position);qc.x+=qc.x+a(_,St(x,n.position[0])),qc.y+=qc.y+a(_,St(x,n.position[1])),qc.z+=qc.z+a(_,St(x,n.position[2]));let E=Math.acos(S.dot(Ml)),P=$me.crossVectors(Ml,S).normalize(),I=Kme.makeRotationAxis(P,E),D=S.clone().cross(this.object.up).normalize(),L=D.clone().cross(S).normalize(),B=new ke().makeBasis(D,S,L),j=new T(Ml.y,Ml.z,Ml.x).normalize(),z=j.clone().cross(Ml).normalize(),O=new ke().makeBasis(j,Ml,z).invert(),H=new ke().multiplyMatrices(B,O);g.rotation.setFromRotationMatrix(H),C.applyMatrix4(I),g.position.add(C),g.rotation.x=g.rotation.x+i.x+b,g.rotation.y=g.rotation.y+i.y+w,g.rotation.z=g.rotation.z+i.z+M,g.scale.setScalar(1),g.scale.x=g.scale.x+t.scale[0]+a(_,St(x,n.scale[0]))||$n,g.scale.y=g.scale.y+t.scale[1]+a(_,St(x,n.scale[1]))||$n,g.scale.z=g.scale.z+t.scale[2]+a(_,St(x,n.scale[2]))||$n,g.scale.multiply(this.object.scale),g.hiddenMatrix=this.object.hiddenMatrix}}getSubdivData(){if(!this.objectForSample)return[];let e=this.parameters.toObject.spreadType;if(e==="random")return[];if(this.objectForSample instanceof U0){let t=this.objectForSample,i=zme[e],n=HF[i],r=kF[i],s=VF[i],a=[],o=n(t.subdivPointerNew);for(let l=0;l<=o-1;l++){let c=r(t.subdivPointerNew,l),u=s(t.subdivPointerNew,l);kP.fromArray(c).applyMatrix4(t.matrixWorld),VP.fromArray(u),a.push({pos:kP.toArray(),norm:VP.toArray()})}return a}else return(this.objectForSample.geometry.index?jme(this.objectForSample.geometry):Wme(this.objectForSample.geometry)).map((t,i)=>e==="polygon_center"?{pos:t.midpoint,norm:t.norm}:e==="vertex"?[{pos:t.vertices[0],norm:t.norm},{pos:t.vertices[1],norm:t.norm},{pos:t.vertices[2],norm:t.norm}]:e==="edge"?[{pos:t.faceCenters[0],norm:t.norm},{pos:t.faceCenters[1],norm:t.norm},{pos:t.faceCenters[2],norm:t.norm}]:[]).flat()}updateState(e,t){var i;if(this.parameters=m2(e),this.parameters.type!=="toObject")(this.parent===null||this.parent!==this.object)&&(this.removeFromParent(),(i=this.object.parent)==null||i.add(this),this.matrix=this.object.matrix,this.hiddenMatrix=this.object.hiddenMatrix,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1);else if(this.parent===null||this.parent.uuid!==this.parameters.toObject.object){this.removeFromParent();let n=t.find(this.parameters.toObject.object);n instanceof zr?this.objectForSample=n:this.objectForSample=void 0,this.matrix=new ke,this.hiddenMatrix=new ke,this.matrixWorldNeedsUpdate=!0,this.matrixAutoUpdate=!1,n&&n.add(this)}this.update()}get pendingMediaLoad(){return this._pendingMediaLoad}},lg=e=>{var t;return t=class extends e{},t.geometryHelper=new ro(30,30,30),t},G1=new Wp,zb=new ls,HP=new ke,cg=(e,t,i,n,r=!1)=>{let s=t,a=e.matrixWorld;if(s.boundingSphere===null&&s.computeBoundingSphere(),zb.copy(s.boundingSphere),zb.applyMatrix4(a),i.ray.intersectsSphere(zb)===!1||(HP.copy(a).invert(),G1.copy(i.ray).applyMatrix4(HP),s.boundingBox!==null&&G1.intersectsBox(s.boundingBox)===!1))return;let o,l,c,u,h=s.index,d=s.attributes.position,p=s.drawRange,f,v;if(r===!1){let g=Math.max(0,p.start),y=Math.min(h.count,p.start+p.count);for(f=g,v=y;f<v;f+=3)if(l=h.getX(f),c=h.getX(f+1),u=h.getX(f+2),o=m(e,i,G1,d,l,c,u),o){o.faceIndex=Math.floor(f/3),n.push(o);return}}else{let g=s.attributes.position,y=new T,x=new T,_=new T,b=new T,w=2,M=1/((e.scale.x+e.scale.y+e.scale.z)/3),S=M*M,C=Math.max(0,p.start),E=Math.min(g.count,p.start+p.count);for(let P=C,I=E-1;P<I;P+=w){if(y.fromBufferAttribute(g,P),x.fromBufferAttribute(g,P+1),G1.distanceSqToSegment(y,x,b,_)>S)continue;b.applyMatrix4(e.matrixWorld);let D=i.ray.origin.distanceTo(b);D<i.near||D>i.far||n.push({distance:D,point:_.clone().applyMatrix4(e.matrixWorld),object:e})}}function m(g,y,x,_,b,w,M){let S=new T,C=new T,E=new T,P=new T,I=new T;if(S.fromBufferAttribute(_,b),C.fromBufferAttribute(_,w),E.fromBufferAttribute(_,M),x.intersectTriangle(S,C,E,!1,P)===null)return null;I.copy(P),I.applyMatrix4(g.matrixWorld);let D=y.ray.origin.distanceTo(I);return D<y.near||D>y.far?null:{faceIndex:1,distance:D,point:I.clone(),object:g}}},j1=new T,vs=new qp,e0e=class extends ng{constructor(e){let t=new mt,i=new Uc({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],r=[],s={},a=new ut(15711266),o=new ut(15711266),l=new ut(2857471);c("n1","n2",a),c("n2","n4",a),c("n4","n3",a),c("n3","n1",a),c("f1","f2",a),c("f2","f4",a),c("f4","f3",a),c("f3","f1",a),c("n1","f1",a),c("n2","f2",a),c("n3","f3",a),c("n4","f4",a),c("p","n1",o),c("p","n2",o),c("p","n3",o),c("p","n4",o),c("u1","u2",l),c("u2","u3",l),c("u3","u1",l);function c(h,d,p){u(h,p),u(d,p)}function u(h,d){n.push(0,0,0),r.push(d.r,d.g,d.b),s[h]===void 0&&(s[h]=[]),s[h].push(n.length/3-1)}t.setAttribute("position",new et(n,3)),t.setAttribute("color",new et(r,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}update(){let e=this.geometry,t=this.pointMap;vs.projectionMatrixInverse.elements=[.5112609807824982,-0,-0,-0,-0,.41421356237309503,-0,-0,-0,-0,-0,-.099999,-0,-0,-1.0000000000000002,.100001];let i=1,n=1,r=.8;Ws("n1",t,e,vs,-i,-n,r),Ws("n2",t,e,vs,i,-n,r),Ws("n3",t,e,vs,-i,n,r),Ws("n4",t,e,vs,i,n,r);let s=r;Ws("f1",t,e,vs,-i,-n,s),Ws("f2",t,e,vs,i,-n,s),Ws("f3",t,e,vs,-i,n,s),Ws("f4",t,e,vs,i,n,s);let a=s,o=.5;Ws("u1",t,e,vs,i*.7*o,n*1.1,a),Ws("u2",t,e,vs,-i*.7*o,n*1.1,a),Ws("u3",t,e,vs,0,n*(1.1+.9*o),a),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}};function Ws(e,t,i,n,r,s,a){j1.set(r,s,a).unproject(n);let o=t[e];if(o!==void 0){let l=i.getAttribute("position");for(let c=0,u=o.length;c<u;c++)l.setXYZ(o[c],j1.x,j1.y,j1.z)}}var t0e=class extends lg(e0e){constructor(e){super(e),this.object=e,this.object=e,this.name=`CombinedCameraHelper: ${e.uuid}`}updateMatrixWorld(e){super.updateMatrixWorld(e),this.updateTarget()}updateTarget(){let e=this.object.getTarget();this.updateWorldMatrix(!0,!1),this.worldToLocal(e)}raycast(e,t){cg(this.object,this.geometry,e,t,!0)}},_M;(e=>e.is=t=>"objectHelper"in t)(_M||(_M={}));var hg=(e,t)=>class extends fA(e){constructor(){super(...arguments),this.objectHelper=new t(this),this.gizmos={}}get geometryHelper(){return t.geometryHelper}raycast(i,n){this.objectHelper.raycast(i,n)}showGizmos(){for(let i in this.gizmos){let n=this.gizmos[i];n instanceof Hy&&(n.visible=!0)}}updateEntityBoxSize(i,n){this.objectHelper.visible&&this.geometryHelper instanceof ro?(i.setScalar(0),n.set(this.geometryHelper.parameters.width,this.geometryHelper.parameters.height,this.geometryHelper.parameters.height).multiplyScalar(.5)):super.updateEntityBoxSize(i,n)}hideGizmos(){for(let i in this.gizmos){let n=this.gizmos[i];n instanceof Hy&&(n.visible=!1)}}},W1=790,Iu=new T,kb=new T,Vb=new At,Hb=new T,Wf=new T,Gb=new T,qn=class extends hg(qp,t0e){constructor(e="",t={...D0.defaultData,name:""}){super(),this._cameraType="OrthographicCamera",this.targetOffset=Ap.DefaultTargetOffset,this.isUpVectorFlipped=!1,this.angleOffsetFromUp=0,this.wasMovedByUser=!1,this.wasMovedBySwitchCameraAction=!1,this.super_Entity(e,t),this.previousProjectionMatrix=new ke,this.matrixAutoUpdate=!0,this.width=window.innerWidth,this.height=window.innerHeight;let i=this.width,n=this.height;this.orthoCamera=new CE(i*-.5,i*.5,n*.5,n*-.5,-5e4,1e4),this.perspCamera=new Vn(45,i/n,50,1e4),this.left=this.orthoCamera.left,this.right=this.orthoCamera.right,this.top=this.orthoCamera.top,this.bottom=this.orthoCamera.bottom,this.far=this.orthoCamera.far,this.view=this.orthoCamera.view,this.aspect=this.perspCamera.aspect,this.focus=this.perspCamera.focus,this.filmGauge=this.perspCamera.filmGauge,this.filmOffset=this.perspCamera.filmOffset,this.objectHelper.update()}get isPerspectiveCamera(){return this.cameraType==="PerspectiveCamera"}get isOrthographicCamera(){return!this.isPerspectiveCamera}get cameraType(){return this._cameraType}set fov(e){this.perspCamera.fov=e}get fov(){return this.perspCamera.fov}setNear(e,t){e==="PerspectiveCamera"?this.perspCamera.near=t:this.orthoCamera.near=t}setZoom(e,t){t>=0&&(e==="PerspectiveCamera"?this.perspCamera.zoom=t:this.orthoCamera.zoom=t)}set cameraType(e){e==="PerspectiveCamera"?this.toPerspective():e==="OrthographicCamera"&&this.toOrthographic()}get near(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.near:this.orthoCamera.near}set near(e){this._cameraType==="PerspectiveCamera"?this.perspCamera.near=e:this.orthoCamera.near=e}get zoom(){return this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom:this.orthoCamera.zoom}set zoom(e){e>=0&&(this._cameraType==="PerspectiveCamera"?this.perspCamera.zoom=e:this.orthoCamera.zoom=e)}lookAt(e,t,i){typeof e=="number"&&(e=new T(e,t,i)),super.lookAt(e),this.getWorldPosition(Iu),this.targetOffset=Iu.distanceTo(e)}getTarget(e=new T){return this.getWorldDirection(kb),this.getWorldPosition(Iu),kb.multiplyScalar(this.targetOffset),e.copy(Iu).add(kb),e}getDistanceToTarget(){let e=this.getTarget();return this.getWorldPosition(Iu),Iu.distanceTo(e)}updateUp(){this.getWorldQuaternion(Vb),Hb.set(0,0,1).applyQuaternion(Vb),Wf.copy($t.DEFAULT_UP),this.isUpVectorFlipped&&Wf.negate(),Wf.applyQuaternion(Vb),Gb.copy($t.DEFAULT_UP).projectOnPlane(Hb),this.angleOffsetFromUp=Gb.angleTo(Wf),this.angleOffsetFromUp*=Gb.cross(Wf).dot(Hb)>=0?1:-1}updateTransformState(e){let t=super.updateTransformState(e);return e.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateUp(),t}getViewFrontToObject(e){let t=e.getWorldPosition(new T),i=e.getWorldDirection(new T).multiplyScalar(this.targetOffset);return{position:t.clone().add(i),target:t}}getViewToTarget(e){let t=this.getWorldDirection(new T).multiplyScalar(this.targetOffset);return{position:e.clone().sub(t),target:e}}getViewToObject(e){let t=new T;return e.getWorldPosition(t),this.getViewToTarget(t)}setViewplaneSize(e,t,i=!1){if(this.aspect=e/t,i){let n=e>t?this.aspect:1,r=e>t?1:this.aspect;this.left=-W1*.5*n,this.right=W1*.5*n,this.top=W1*.5*(1/r),this.bottom=-W1*.5*(1/r)}else this.left=-e*.5,this.right=e*.5,this.top=t*.5,this.bottom=-t*.5;this.updateProjectionMatrix()}copyViewPlaneSize(e){this.aspect=e.aspect,this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.updateProjectionMatrix()}toOrthographic(){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",this.objectHelper&&this.objectHelper.update()}toPerspective(){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",this.objectHelper&&this.objectHelper.update()}setFocalLength(e){this.perspCamera.setFocalLength(e),this.toPerspective()}getFocalLength(){return this.perspCamera.getFocalLength()}getEffectiveFOV(){return this.perspCamera.getEffectiveFOV()}getFilmWidth(){return this.perspCamera.getFilmWidth()}getFilmHeight(){return this.perspCamera.getFilmHeight()}setViewOffset(e,t,i,n,r,s){this._cameraType==="PerspectiveCamera"?this.perspCamera.setViewOffset(e,t,i,n,r,s):this.orthoCamera.setViewOffset(e,t,i,n,r,s)}clearViewOffset(){this._cameraType==="PerspectiveCamera"?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}copyHistory(){this.previousProjectionMatrix&&this.previousProjectionMatrix.copy(this.projectionMatrix)}updateProjectionMatrix(){this._cameraType==="PerspectiveCamera"?this.toPerspective():this._cameraType==="OrthographicCamera"&&this.toOrthographic()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}copy(e,t){return super.copy(e,t),this.parent=e.parent,this.orthoCamera.copy(e.orthoCamera),this.perspCamera.copy(e.perspCamera),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.far=e.far,this.view=e.view===null?null:Object.assign({},e.view),this._cameraType=e._cameraType,this.aspect=e.aspect,this.fov=e.fov,this.focus=e.focus,this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this.targetOffset=e.targetOffset,this.updateProjectionMatrix(),this}toCameraState(e=[]){let t={type:this.cameraType,far:this.far,orthographic:{near:this.orthoCamera.near,zoom:this.orthoCamera.zoom},perspective:{near:this.perspCamera.near,fov:this.perspCamera.fov,zoom:this.perspCamera.zoom},up:this.up.toArray(),targetOffset:this.targetOffset,isUpVectorFlipped:this.isUpVectorFlipped};return MS(t,e)}updateCameraSubtype(e,t){let i=e==="perspective"?"PerspectiveCamera":"OrthographicCamera";t.zoom!==void 0&&this.setZoom(i,t.zoom),t.near!==void 0&&this.setNear(i,t.near),t.fov!==void 0&&i==="PerspectiveCamera"&&(this.fov=t.fov)}updateState(e,t){this.updateCameraState(e,t)}updateCameraState(e,t){this.updateState_Entity(e,t),e.far!==void 0&&(this.far=e.far),e.orthographic!==void 0&&this.updateCameraSubtype("orthographic",e.orthographic),e.perspective!==void 0&&this.updateCameraSubtype("perspective",e.perspective),e.type!==void 0&&(this.cameraType=e.type),e.up!==void 0&&this.up.fromArray(e.up),e.targetOffset!==void 0&&(this.targetOffset=e.targetOffset),e.isUpVectorFlipped!==void 0&&(this.isUpVectorFlipped=e.isUpVectorFlipped),this.updateProjectionMatrix()}updateByPatchedOp(e,t,i){super.updateByPatchedOp(e,t,i),e.path.length===1&&e.type===0&&this.updateCameraSubtype(e.path[0],e.props)}toState(e){return{...super.toState(e),...this.toCameraState(e),type:this.cameraType}}},Ou=new ke,i0e=new ke;function GP(e){let t=!1;return e.scene.objects.traverse((i,n)=>{var r;((r=n.geometry)==null?void 0:r.type)==="BooleanGeometry"&&(t=!0)}),t}var Ip=class extends of{constructor(e,t,i){super(e,t),this.data=t,this.meshSetAddresses=[],this.needsTransformForDownstream=!1,this.geometry=new mt,this.onAfterRender=(n,r,s,a,o,l)=>{super.onAfterRender(n,r,s,a,o,l),this.recomputeBoolean()},this.geometry.userData.parameters={width:0,height:0,depth:0}}get booleanOp(){return this.data.geometry.operation}get phongAngle(){return this.data.geometry.phongAngle??45}get isLOD(){return this.recomputeBoolean(),!1}updateByPatchedOp(e,t,i){super.updateByPatchedOp(e,t,i),e.path.length===1&&e.path[0]==="geometry"&&e.type===0&&e.props.operation!==void 0&&(this.freeBooleanPointer(),this.resetBBoxNeedsUpdate())}freeBooleanPointer(){super.freeBooleanPointer(),this.geometry.dispose()}recomputeBoolean(e,t=!0){var n;if(this.booleanMeshSetAddress!==-1&&!e)return;for(let r=0;r<this.children.length;r++){let s=this.children[r];s instanceof Ip&&s.dataPatched.visible===!0&&s.recomputeBoolean(e===!0,t)}this.meshSetAddresses=[];for(let r=0;r<this.children.length;r++){let s=this.children[r];if(s instanceof zr&&s.dataPatched.visible===!0&&((n=s.geometry.attributes.position)==null?void 0:n.count)>0&&s.geometry.drawRange.count>0){if(Ou.multiplyMatrices(s.hiddenMatrix,s.matrix),s.booleanMeshSetAddress===-1){if((s.geometry.index??s.geometry.getAttribute("position")).count/3<15e5&&(s.booleanMeshSetAddress=Fo.getMeshSet(s.geometry,e===!0,t)),s.booleanMeshSetAddress===-1)return;Fo.transformMeshSet(s.booleanMeshSetAddress,Ou),s.booleanMatrixInvOld.copy(Ou).invert(),s.booleanWasTransformed=!1}else s instanceof Ip&&s.needsTransformForDownstream===!0?(Fo.transformMeshSet(s.booleanMeshSetAddress,Ou),s.needsTransformForDownstream=!1):s.booleanWasTransformed===!0&&(Fo.transformMeshSet(s.booleanMeshSetAddress,i0e.multiplyMatrices(Ou,s.booleanMatrixInvOld)),s.booleanMatrixInvOld.copy(Ou).invert(),s.booleanWasTransformed=!1);Fo.hasOpenEdges(s.booleanMeshSetAddress)===!1||r===this.children.length-1&&this.booleanOp===2?(this.meshSetAddresses.push(s.booleanMeshSetAddress),s.geometry.userData.wasFilteredFromBoolean=!1):s.geometry.userData.wasFilteredFromBoolean=!0}}if(this.meshSetAddresses.length===0){this.geometry.setAttribute("position",new et([],0)),this.geometry.setDrawRange(0,0);return}if(e===!0)return Fo.calcBooleanTopological(this.meshSetAddresses,this.booleanOp);let i=this.geometry;i.dispose(),this.geometry=new mt,this.geometry.userData=i.userData,this.geometry.boundingSphere=i.boundingSphere;try{this.booleanMeshSetAddress=Fo.calcBoolean(this.meshSetAddresses,this.booleanOp,this.geometry,this.phongAngle)}catch(r){this.booleanMeshSetAddress=0,console.error(r)}this.booleanMatrixInvOld.copy(this.matrix).invert(),this.needsTransformForDownstream=!0,PA(this),DA(this)}dispose(){super.dispose(),this.geometry.dispose()}},bM;(e=>{function t(i){return Vt.is(i)&&i instanceof sg}e.is=t})(bM||(bM={}));var LA=(e,t)=>class extends hg(e,t){updateState_Light(i,n){this.updateState_Entity(i,n),i.color!==void 0&&(this.color=n.shared.color(i.color)),i.intensity!==void 0&&(this.intensity=i.intensity),i.depth!==void 0&&(this.shadow.camera.far=i.depth,this.shadow.needsUpdate=!0),i.shadows!==void 0&&(this.castShadow=i.shadows)}},na=e=>e instanceof zr,qa=e=>e!==null&&e instanceof Ip,n0e=e=>e instanceof qn,r0e=e=>bM.is(e),wM=e=>_M.is(e),M2=class extends lg(Mie){constructor(e,t=15){super(t),this.object=e,this.object.updateMatrixWorld(),this.name=`EmptyObjectHelper: ${e.uuid}`,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.object.isBone&&(this.visible=!1)}raycast(e,t){cg(this.object,M2.geometryHelper,e,t)}update(){}},F0=class extends hg(Id,M2){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update()}updateState(e,t){this.updateState_Entity(e,t)}},GF={RED:0,GREEN:1,BLUE:2,ALPHA:3},ug="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",s0e=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;
#if PASS == 1
uniform vec4 kernel64[32];
#else
uniform vec4 kernel16[8];
#endif
varying vec2 vUv;void main(){
#ifdef FOREGROUND
vec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;
#else
float CoC=texture2D(cocBuffer,vUv).g*scale;
#endif
if(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{
#ifdef FOREGROUND
vec2 step=texelSize*max(CoC,CoCNearFar.g*scale);
#else
vec2 step=texelSize*CoC;
#endif
#if PASS == 1
vec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;
#else
vec4 maxValue=texture2D(inputBuffer,vUv);for(int i=0;i<8;++i){vec4 kernel=kernel16[i];vec2 uv=step*kernel.xy+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);uv=step*kernel.zw+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);}gl_FragColor=maxValue;
#endif
}}`,X1=class extends oi{constructor(e=!1,t=!1){super({name:"BokehMaterial",defines:{PASS:e?"2":"1"},uniforms:{kernel64:new Fe(null),kernel16:new Fe(null),inputBuffer:new Fe(null),cocBuffer:new Fe(null),texelSize:new Fe(new te),scale:new Fe(1)},blending:Qi,depthWrite:!1,depthTest:!1,fragmentShader:s0e,vertexShader:ug}),this.toneMapped=!1,t&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set cocBuffer(e){this.uniforms.cocBuffer.value=e}setCoCBuffer(e){this.uniforms.cocBuffer.value=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(e){return this.uniforms.scale.value=e}setScale(e){this.uniforms.scale.value=e}generateKernel(){let e=2.39996323,t=new Float32Array(128),i=new Float32Array(32),n=0,r=0;for(let o=0;o<80;++o){let l=o*e,c=Math.sqrt(o)/Math.sqrt(80),u=c*Math.cos(l),h=c*Math.sin(l);o%5===0?(i[r++]=u,i[r++]=h):(t[n++]=u,t[n++]=h)}let s=[],a=[];for(let o=0;o<128;)s.push(new Ct(t[o++],t[o++],t[o++],t[o++]));for(let o=0;o<32;)a.push(new Ct(i[o++],i[o++],i[o++],i[o++]));this.uniforms.kernel64.value=s,this.uniforms.kernel16.value=a}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t)}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}};function jP(e,t,i){return e*(t-i)-t}function SM(e,t,i){return Math.min(Math.max((e+t)/(t-i),0),1)}var a0e=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}void main(){float depth=readDepth(vUv);
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);
#else
float linearDepth=depth;
#endif
float signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}`,o0e=class extends oi{constructor(e){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new Fe(null),focusDistance:new Fe(0),focusRange:new Fe(0),cameraNear:new Fe(.3),cameraFar:new Fe(1e3)},blending:Qi,depthWrite:!1,depthTest:!1,fragmentShader:a0e,vertexShader:ug}),this.toneMapped=!1,this.uniforms.focalLength=this.uniforms.focusRange,this.adoptCameraSettings(e)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=pl){this.depthBuffer=e,this.depthPacking=t}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(e){this.uniforms.focusDistance.value=e}get worldFocusDistance(){return-jP(this.focusDistance,this.near,this.far)}set worldFocusDistance(e){this.focusDistance=SM(-e,this.near,this.far)}getFocusDistance(e){this.uniforms.focusDistance.value=e}setFocusDistance(e){this.uniforms.focusDistance.value=e}get focalLength(){return this.focusRange}set focalLength(e){this.focusRange=e}get focusRange(){return this.uniforms.focusRange.value}set focusRange(e){this.uniforms.focusRange.value=e}get worldFocusRange(){return-jP(this.focusRange,this.near,this.far)}set worldFocusRange(e){this.focusRange=SM(-e,this.near,this.far)}getFocalLength(e){return this.focusRange}setFocalLength(e){this.focusRange=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof Vn?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},l0e=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <encodings_fragment>
#include <dithering_fragment>
}`,c0e="uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",WP=class extends oi{constructor(e=new te){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new Fe(null),texelSize:new Fe(new te),halfTexelSize:new Fe(new te),kernel:new Fe(0),scale:new Fe(1)},blending:Qi,depthWrite:!1,depthTest:!1,fragmentShader:l0e,vertexShader:c0e}),this.toneMapped=!1,this.setTexelSize(e.x,e.y)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.inputBuffer=e}get scale(){return this.uniforms.scale.value}set scale(e){this.uniforms.scale.value=e}getScale(){return this.uniforms.scale.value}setScale(e){this.uniforms.scale.value=e}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(e){this.uniforms.kernel.value=e}setKernel(e){this.kernel=e}setTexelSize(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}setSize(e,t){let i=this.uniforms;i.texelSize.value.set(1/e,1/t),i.halfTexelSize.value.copy(i.texelSize.value).multiplyScalar(.5)}},h0e=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <encodings_fragment>
}`,u0e=class extends oi{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new Fe(null),opacity:new Fe(1)},blending:Qi,depthWrite:!1,depthTest:!1,fragmentShader:h0e,vertexShader:ug}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}getOpacity(e){return this.uniforms.opacity.value}setOpacity(e){this.uniforms.opacity.value=e}},d0e=`varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
#if EDGE_DETECTION_MODE == 1
#include <common>
#endif
#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}
#elif PREDICATION_MODE == 2
uniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}
#endif
#if PREDICATION_MODE != 0
vec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}
#endif
#if EDGE_DETECTION_MODE != 0
uniform sampler2D inputBuffer;
#endif
void main(){
#if EDGE_DETECTION_MODE == 0
const vec2 threshold=vec2(DEPTH_THRESHOLD);
#elif PREDICATION_MODE != 0
vec2 threshold=calculatePredicatedThreshold();
#else
const vec2 threshold=vec2(EDGE_THRESHOLD);
#endif
#if EDGE_DETECTION_MODE == 0
vec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 1
float l=luminance(texture2D(inputBuffer,vUv).rgb);float lLeft=luminance(texture2D(inputBuffer,vUv0).rgb);float lTop=luminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=luminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=luminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=luminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=luminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#elif EDGE_DETECTION_MODE == 2
vec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);
#endif
}`,p0e=`uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;
#if EDGE_DETECTION_MODE != 0
varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;
#endif
void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);
#if EDGE_DETECTION_MODE != 0
vUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);
#endif
gl_Position=vec4(position.xy,1.0,1.0);}`,C2={DEPTH:0,LUMA:1,COLOR:2},f0e={DISABLED:0,DEPTH:1,CUSTOM:2},m0e=class extends oi{constructor(e=new te,t=C2.COLOR){super({name:"EdgeDetectionMaterial",defines:{THREE_REVISION:jp.replace(/\D+/g,""),LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new Fe(null),depthBuffer:new Fe(null),predicationBuffer:new Fe(null),texelSize:new Fe(e)},blending:Qi,depthWrite:!1,depthTest:!1,fragmentShader:d0e,vertexShader:p0e}),this.toneMapped=!1,this.edgeDetectionMode=t}set depthBuffer(e){this.uniforms.depthBuffer.value=e}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=pl){this.depthBuffer=e,this.depthPacking=t}get edgeDetectionMode(){return Number(this.defines.EDGE_DETECTION_MODE)}set edgeDetectionMode(e){this.defines.EDGE_DETECTION_MODE=e.toFixed(0),this.needsUpdate=!0}getEdgeDetectionMode(){return this.edgeDetectionMode}setEdgeDetectionMode(e){this.edgeDetectionMode=e}get localContrastAdaptationFactor(){return Number(this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR)}set localContrastAdaptationFactor(e){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=e.toFixed("6"),this.needsUpdate=!0}getLocalContrastAdaptationFactor(){return this.localContrastAdaptationFactor}setLocalContrastAdaptationFactor(e){this.localContrastAdaptationFactor=e}get edgeDetectionThreshold(){return Number(this.defines.EDGE_THRESHOLD)}set edgeDetectionThreshold(e){this.defines.EDGE_THRESHOLD=e.toFixed("6"),this.defines.DEPTH_THRESHOLD=(e*.1).toFixed("6"),this.needsUpdate=!0}getEdgeDetectionThreshold(){return this.edgeDetectionThreshold}setEdgeDetectionThreshold(e){this.edgeDetectionThreshold=e}get predicationMode(){return Number(this.defines.PREDICATION_MODE)}set predicationMode(e){this.defines.PREDICATION_MODE=e.toFixed(0),this.needsUpdate=!0}getPredicationMode(){return this.predicationMode}setPredicationMode(e){this.predicationMode=e}set predicationBuffer(e){this.uniforms.predicationBuffer.value=e}setPredicationBuffer(e){this.uniforms.predicationBuffer.value=e}get predicationThreshold(){return Number(this.defines.PREDICATION_THRESHOLD)}set predicationThreshold(e){this.defines.PREDICATION_THRESHOLD=e.toFixed("6"),this.needsUpdate=!0}getPredicationThreshold(){return this.predicationThreshold}setPredicationThreshold(e){this.predicationThreshold=e}get predicationScale(){return Number(this.defines.PREDICATION_SCALE)}set predicationScale(e){this.defines.PREDICATION_SCALE=e.toFixed("6"),this.needsUpdate=!0}getPredicationScale(){return this.predicationScale}setPredicationScale(e){this.predicationScale=e}get predicationStrength(){return Number(this.defines.PREDICATION_STRENGTH)}set predicationStrength(e){this.defines.PREDICATION_STRENGTH=e.toFixed("6"),this.needsUpdate=!0}getPredicationStrength(){return this.predicationStrength}setPredicationStrength(e){this.predicationStrength=e}setSize(e,t){this.uniforms.texelSize.value.set(1/e,1/t)}},g0e=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#if THREE_REVISION >= 137
vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}
#endif
float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <encodings_fragment>
#endif
#include <dithering_fragment>
}`,v0e="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}",Xs={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},MM=class extends oi{constructor(e,t,i,n,r=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:jp.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new Fe(null),depthBuffer:new Fe(null),resolution:new Fe(new te),texelSize:new Fe(new te),cameraNear:new Fe(.3),cameraFar:new Fe(1e3),aspect:new Fe(1),time:new Fe(0)},blending:Qi,depthWrite:!1,depthTest:!1,dithering:r}),this.toneMapped=!1,e&&this.setShaderParts(e),t&&this.setDefines(t),i&&this.setUniforms(i),this.adoptCameraSettings(n)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(e){this.uniforms.depthBuffer.value=e}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}setDepthBuffer(e,t=pl){this.depthBuffer=e,this.depthPacking=t}setShaderParts(e){return this.fragmentShader=g0e.replace(Xs.FRAGMENT_HEAD,e.get(Xs.FRAGMENT_HEAD)).replace(Xs.FRAGMENT_MAIN_UV,e.get(Xs.FRAGMENT_MAIN_UV)).replace(Xs.FRAGMENT_MAIN_IMAGE,e.get(Xs.FRAGMENT_MAIN_IMAGE)),this.vertexShader=v0e.replace(Xs.VERTEX_HEAD,e.get(Xs.VERTEX_HEAD)).replace(Xs.VERTEX_MAIN_SUPPORT,e.get(Xs.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}setDefines(e){for(let t of e.entries())this.defines[t[0]]=t[1];return this.needsUpdate=!0,this}setUniforms(e){for(let t of e.entries())this.uniforms[t[0]]=t[1];return this}setExtensions(e){this.extensions={};for(let t of e)this.extensions[t]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(e){this.encodeOutput!==e&&(e?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(e){return this.encodeOutput}setOutputEncodingEnabled(e){this.encodeOutput=e}get time(){return this.uniforms.time.value}set time(e){this.uniforms.time.value=e}setDeltaTime(e){this.uniforms.time.value+=e}adoptCameraSettings(e){e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof Vn?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(e,t){let i=this.uniforms;i.resolution.value.set(e,t),i.texelSize.value.set(1/e,1/t),i.aspect.value=e/t}static get Section(){return Xs}},y0e=`#include <common>
#if THREE_REVISION < 143
#define luminance(v) linearToRelativeLuminance(v)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);l*=low*high;
#elif defined(THRESHOLD)
l=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=vec4(texel.rgb*l,l);
#else
gl_FragColor=vec4(l);
#endif
}`,x0e=class extends oi{constructor(e=!1,t=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:jp.replace(/\D+/g,"")},uniforms:{inputBuffer:new Fe(null),threshold:new Fe(0),smoothing:new Fe(1),range:new Fe(null)},blending:Qi,depthWrite:!1,depthTest:!1,fragmentShader:y0e,vertexShader:ug}),this.toneMapped=!1,this.colorOutput=e,this.luminanceRange=t}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get threshold(){return this.uniforms.threshold.value}set threshold(e){this.smoothing>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=e}getThreshold(){return this.threshold}setThreshold(e){this.threshold=e}get smoothing(){return this.uniforms.smoothing.value}set smoothing(e){this.threshold>0||e>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=e}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(e){this.smoothing=e}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(e){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(e){return this.colorOutput}setColorOutputEnabled(e){this.colorOutput=e}get useRange(){return this.luminanceRange!==null}set useRange(e){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(e){e!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=e,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(e){this.luminanceRange=e}},_0e=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef MASK_PRECISION_HIGH
uniform mediump sampler2D maskTexture;
#else
uniform lowp sampler2D maskTexture;
#endif
#if MASK_FUNCTION != 0
uniform float strength;
#endif
varying vec2 vUv;void main(){
#if COLOR_CHANNEL == 0
float mask=texture2D(maskTexture,vUv).r;
#elif COLOR_CHANNEL == 1
float mask=texture2D(maskTexture,vUv).g;
#elif COLOR_CHANNEL == 2
float mask=texture2D(maskTexture,vUv).b;
#else
float mask=texture2D(maskTexture,vUv).a;
#endif
#if MASK_FUNCTION == 0
#ifdef INVERTED
mask=step(mask,0.0);
#else
mask=1.0-step(mask,0.0);
#endif
#else
mask=clamp(mask*strength,0.0,1.0);
#ifdef INVERTED
mask=1.0-mask;
#endif
#endif
#if MASK_FUNCTION == 2
gl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);
#else
gl_FragColor=mask*texture2D(inputBuffer,vUv);
#endif
}`,jF={DISCARD:0,MULTIPLY:1,MULTIPLY_RGB_SET_ALPHA:2},b0e=class extends oi{constructor(e=null){super({name:"MaskMaterial",uniforms:{maskTexture:new Fe(e),inputBuffer:new Fe(null),strength:new Fe(1)},blending:Qi,depthWrite:!1,depthTest:!1,fragmentShader:_0e,vertexShader:ug}),this.toneMapped=!1,this.setColorChannel(GF.RED),this.setMaskFunction(jF.DISCARD)}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}set maskTexture(e){this.uniforms.maskTexture.value=e,delete this.defines.MASK_PRECISION_HIGH,e.type!==Zn&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(e){this.maskTexture=e}set colorChannel(e){this.defines.COLOR_CHANNEL=e.toFixed(0),this.needsUpdate=!0}setColorChannel(e){this.colorChannel=e}set maskFunction(e){this.defines.MASK_FUNCTION=e.toFixed(0),this.needsUpdate=!0}setMaskFunction(e){this.maskFunction=e}get inverted(){return this.defines.INVERTED!==void 0}set inverted(e){this.inverted&&!e?delete this.defines.INVERTED:e&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(e){this.inverted=e}get strength(){return this.uniforms.strength.value}set strength(e){this.uniforms.strength.value=e}getStrength(){return this.strength}setStrength(e){this.strength=e}},w0e=`#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)
#if __VERSION__ < 300
#define round(v) floor(v + 0.5)
#endif
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform lowp sampler2D areaTexture;uniform lowp sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);
#endif
}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){
#if !defined(DISABLE_CORNER_DETECTION)
vec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);
#endif
}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){
#if !defined(DISABLE_DIAG_DETECTION)
weights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){
#endif
vec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);
#if !defined(DISABLE_DIAG_DETECTION)
}else{e.r=0.0;}
#endif
}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}`,S0e="uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}",M0e=class extends oi{constructor(e=new te,t=new te){super({name:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new Fe(null),searchTexture:new Fe(null),areaTexture:new Fe(null),resolution:new Fe(t),texelSize:new Fe(e)},blending:Qi,depthWrite:!1,depthTest:!1,fragmentShader:w0e,vertexShader:S0e}),this.toneMapped=!1}set inputBuffer(e){this.uniforms.inputBuffer.value=e}setInputBuffer(e){this.uniforms.inputBuffer.value=e}get searchTexture(){return this.uniforms.searchTexture.value}set searchTexture(e){this.uniforms.searchTexture.value=e}get areaTexture(){return this.uniforms.areaTexture.value}set areaTexture(e){this.uniforms.areaTexture.value=e}setLookupTextures(e,t){this.searchTexture=e,this.areaTexture=t}get orthogonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_INT)}set orthogonalSearchSteps(e){let t=Math.min(Math.max(e,0),112);this.defines.MAX_SEARCH_STEPS_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setOrthogonalSearchSteps(e){this.orthogonalSearchSteps=e}get diagonalSearchSteps(){return Number(this.defines.MAX_SEARCH_STEPS_DIAG_INT)}set diagonalSearchSteps(e){let t=Math.min(Math.max(e,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=t.toFixed("1"),this.needsUpdate=!0}setDiagonalSearchSteps(e){this.diagonalSearchSteps=e}get diagonalDetection(){return this.defines.DISABLE_DIAG_DETECTION===void 0}set diagonalDetection(e){e?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}isDiagonalDetectionEnabled(){return this.diagonalDetection}setDiagonalDetectionEnabled(e){this.diagonalDetection=e}get cornerRounding(){return Number(this.defines.CORNER_ROUNDING)}set cornerRounding(e){let t=Math.min(Math.max(e,0),100);this.defines.CORNER_ROUNDING=t.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(t/100).toFixed("4"),this.needsUpdate=!0}setCornerRounding(e){this.cornerRounding=e}get cornerDetection(){return this.defines.DISABLE_CORNER_DETECTION===void 0}set cornerDetection(e){e?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}isCornerRoundingEnabled(){return this.cornerDetection}setCornerRoundingEnabled(e){this.cornerDetection=e}setSize(e,t){let i=this.uniforms;i.texelSize.value.set(1/e,1/t),i.resolution.value.set(e,t)}},C0e=new qp,Cl=null;function E0e(){if(Cl===null){let e=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),t=new Float32Array([0,0,2,0,0,2]);Cl=new mt,Cl.setAttribute!==void 0?(Cl.setAttribute("position",new gt(e,3)),Cl.setAttribute("uv",new gt(t,2))):(Cl.addAttribute("position",new gt(e,3)),Cl.addAttribute("uv",new gt(t,2)))}return Cl}var xr=class{constructor(e="Pass",t=new gc,i=C0e){this.name=e,this.renderer=null,this.scene=t,this.camera=i,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){let t=this.getFullscreenMaterial();t!==null&&(t.needsUpdate=!0),this.rtt=!e}}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new Ar(E0e(),e),t.frustumCulled=!1,this.scene===null&&(this.scene=new gc),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=pl){}render(e,t,i,n,r){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,i){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(t!==null&&typeof t.dispose=="function"){if(t instanceof gc||t===this.renderer)continue;this[e].dispose()}}}},CM=class extends xr{constructor(e,t=!0){super("CopyPass"),this.fullscreenMaterial=new u0e,this.needsSwap=!1,this.renderTarget=e,e===void 0&&(this.renderTarget=new Qt(1,1,{minFilter:Lt,magFilter:Lt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=t}get resize(){return this.autoResize}set resize(e){this.autoResize=e}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(e){this.autoResize=e}render(e,t,i,n,r){this.fullscreenMaterial.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){this.autoResize&&this.renderTarget.setSize(e,t)}initialize(e,t,i){i!==void 0&&(this.renderTarget.texture.type=i,i!==Zn?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":e.outputEncoding===Mt&&(this.renderTarget.texture.encoding=Mt))}},A0e=class extends xr{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(e,t,i,n,r){let s=e.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},jb=new ut,RA=class extends xr{constructor(e=!0,t=!0,i=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=e,this.depth=t,this.stencil=i,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(e,t,i){this.color=e,this.depth=t,this.stencil=i}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(e){this.overrideClearColor=e}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(e){this.overrideClearAlpha=e}render(e,t,i,n,r){let s=this.overrideClearColor,a=this.overrideClearAlpha,o=e.getClearAlpha(),l=s!==null,c=a>=0;l?(jb.copy(e.getClearColor(jb)),e.setClearColor(s,c?a:o)):c&&e.setClearAlpha(a),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),l?e.setClearColor(jb,o):c&&e.setClearAlpha(o)}},El=-1,Pr=class extends In{constructor(e,t=El,i=El,n=1){super(),this.resizable=e,this.base=new te(1,1),this.preferred=new te(t,i),this.target=this.preferred,this.s=n}get width(){let{base:e,preferred:t,scale:i}=this,n;return t.width!==El?n=t.width:t.height!==El?n=Math.round(t.height*(e.width/Math.max(e.height,1))):n=Math.round(e.width*i),n}set width(e){this.preferredWidth=e}get height(){let{base:e,preferred:t,scale:i}=this,n;return t.height!==El?n=t.height:t.width!==El?n=Math.round(t.width/Math.max(e.width/Math.max(e.height,1),1)):n=Math.round(e.height*i),n}set height(e){this.preferredHeight=e}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(e){this.s!==e&&(this.s=e,this.preferred.setScalar(El),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getScale(){return this.scale}setScale(e){this.scale=e}get baseWidth(){return this.base.width}set baseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseWidth(){return this.base.width}setBaseWidth(e){this.base.width!==e&&(this.base.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get baseHeight(){return this.base.height}set baseHeight(e){this.base.height!==e&&(this.base.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(e){this.baseHeight=e}setBaseSize(e,t){(this.base.width!==e||this.base.height!==t)&&(this.base.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}get preferredWidth(){return this.preferred.width}set preferredWidth(e){this.preferred.width!==e&&(this.preferred.width=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(e){this.preferredWidth=e}get preferredHeight(){return this.preferred.height}set preferredHeight(e){this.preferred.height!==e&&(this.preferred.height=e,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(e){this.preferredHeight=e}setPreferredSize(e,t){(this.preferred.width!==e||this.preferred.height!==t)&&(this.preferred.set(e,t),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height))}copy(e){this.base.set(e.getBaseWidth(),e.getBaseHeight()),this.preferred.set(e.getPreferredWidth(),e.getPreferredHeight()),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.base.width,this.base.height)}static get AUTO_SIZE(){return El}},Wb=!1,XP=class{constructor(e=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(e),this.meshCount=0,this.replaceMaterial=t=>{if(t.isMesh){let i;if(t.material.flatShading)switch(t.material.side){case Jr:i=this.materialsFlatShadedDoubleSide;break;case wn:i=this.materialsFlatShadedBackSide;break;default:i=this.materialsFlatShaded;break}else switch(t.material.side){case Jr:i=this.materialsDoubleSide;break;case wn:i=this.materialsBackSide;break;default:i=this.materials;break}this.originalMaterials.set(t,t.material),t.isSkinnedMesh?t.material=i[2]:t.isInstancedMesh?t.material=i[1]:t.material=i[0],++this.meshCount}}}setMaterial(e){if(this.disposeMaterials(),this.material=e,e!==null){let t=this.materials=[e.clone(),e.clone(),e.clone()];for(let i of t)i.uniforms=Object.assign({},e.uniforms),i.side=ya;t[2].skinning=!0,this.materialsBackSide=t.map(i=>{let n=i.clone();return n.uniforms=Object.assign({},e.uniforms),n.side=wn,n}),this.materialsDoubleSide=t.map(i=>{let n=i.clone();return n.uniforms=Object.assign({},e.uniforms),n.side=Jr,n}),this.materialsFlatShaded=t.map(i=>{let n=i.clone();return n.uniforms=Object.assign({},e.uniforms),n.flatShading=!0,n}),this.materialsFlatShadedBackSide=t.map(i=>{let n=i.clone();return n.uniforms=Object.assign({},e.uniforms),n.flatShading=!0,n.side=wn,n}),this.materialsFlatShadedDoubleSide=t.map(i=>{let n=i.clone();return n.uniforms=Object.assign({},e.uniforms),n.flatShading=!0,n.side=Jr,n})}}render(e,t,i){let n=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,Wb){let r=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,i);for(let s of r)s[0].material=s[1];this.meshCount!==r.size&&r.clear()}else{let r=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,i),t.overrideMaterial=r}e.shadowMap.enabled=n}disposeMaterials(){if(this.material!==null){let e=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(let t of e)t.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return Wb}static set workaroundEnabled(e){Wb=e}},T0e=class extends xr{constructor(e,t,i=null){super("RenderPass",e,t),this.needsSwap=!1,this.clearPass=new RA,this.overrideMaterialManager=i===null?null:new XP(i),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}get renderToScreen(){return super.renderToScreen}set renderToScreen(e){super.renderToScreen=e,this.clearPass.renderToScreen=e}get overrideMaterial(){let e=this.overrideMaterialManager;return e!==null?e.material:null}set overrideMaterial(e){let t=this.overrideMaterialManager;e!==null?t!==null?t.setMaterial(e):this.overrideMaterialManager=new XP(e):t!==null&&(t.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(e){this.overrideMaterial=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getSelection(){return this.selection}setSelection(e){this.selection=e}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(e){this.ignoreBackground=e}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(e){this.skipShadowMapUpdate=e}getClearPass(){return this.clearPass}render(e,t,i,n,r){let s=this.scene,a=this.camera,o=this.selection,l=a.layers.mask,c=s.background,u=e.shadowMap.autoUpdate,h=this.renderToScreen?null:t;o!==null&&a.layers.set(o.getLayer()),this.skipShadowMapUpdate&&(e.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(e,t),e.setRenderTarget(h),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(e,s,a):e.render(s,a),a.layers.mask=l,s.background=c,e.shadowMap.autoUpdate=u}},qP=class extends xr{constructor(e,t,{resolutionScale:i=1,width:n=Pr.AUTO_SIZE,height:r=Pr.AUTO_SIZE,renderTarget:s}={}){super("DepthPass"),this.needsSwap=!1,this.renderPass=new T0e(e,t,new VB({depthPacking:AB}));let a=this.renderPass;a.skipShadowMapUpdate=!0,a.ignoreBackground=!0;let o=a.getClearPass();o.overrideClearColor=new ut(16777215),o.overrideClearAlpha=1,this.renderTarget=s,this.renderTarget===void 0&&(this.renderTarget=new Qt(1,1,{minFilter:ai,magFilter:ai,stencilBuffer:!1}),this.renderTarget.texture.name="DepthPass.Target");let l=this.resolution=new Pr(this,n,r,i);l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,i,n,r){let s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,s)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t),this.renderTarget.setSize(i.width,i.height)}},kt={SKIP:0,ADD:1,ALPHA:2,AVERAGE:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,EXCLUSION:8,LIGHTEN:9,MULTIPLY:10,DIVIDE:11,NEGATION:12,NORMAL:13,OVERLAY:14,REFLECT:15,SCREEN:16,SOFT_LIGHT:17,SUBTRACT:18},P0e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}",D0e="vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}",L0e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}",R0e="float blend(const in float x,const in float y){return(y==0.0)?y:max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",I0e="float blend(const in float x,const in float y){return(y==1.0)?y:min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",O0e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}",B0e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}",N0e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}",U0e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}",F0e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}",z0e="float blend(const in float x,const in float y){return(y>0.0)?min(x/y,1.0):1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",k0e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}",V0e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}",H0e="float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",G0e="float blend(const in float x,const in float y){return(y==1.0)?y:min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",j0e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}",W0e="float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}",X0e="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}",q0e=new Map([[kt.SKIP,null],[kt.ADD,P0e],[kt.ALPHA,D0e],[kt.AVERAGE,L0e],[kt.COLOR_BURN,R0e],[kt.COLOR_DODGE,I0e],[kt.DARKEN,O0e],[kt.DIFFERENCE,B0e],[kt.EXCLUSION,N0e],[kt.LIGHTEN,U0e],[kt.MULTIPLY,F0e],[kt.DIVIDE,z0e],[kt.NEGATION,k0e],[kt.NORMAL,V0e],[kt.OVERLAY,H0e],[kt.REFLECT,G0e],[kt.SCREEN,j0e],[kt.SOFT_LIGHT,W0e],[kt.SUBTRACT,X0e]]),Y0e=class extends In{constructor(e,t=1){super(),this.f=e,this.opacity=new Fe(t)}getOpacity(){return this.opacity.value}setOpacity(e){this.opacity.value=e}get blendFunction(){return this.f}set blendFunction(e){this.f=e,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(e){this.blendFunction=e}getShaderCode(){return q0e.get(this.blendFunction)}},to={NONE:0,DEPTH:1,CONVOLUTION:2},uo=class extends In{constructor(e,t,{attributes:i=to.NONE,blendFunction:n=kt.SCREEN,defines:r=new Map,uniforms:s=new Map,extensions:a=null,vertexShader:o=null}={}){super(),this.name=e,this.renderer=null,this.attributes=i,this.fragmentShader=t,this.vertexShader=o,this.defines=r,this.uniforms=s,this.extensions=a,this.blendMode=new Y0e(n),this.blendMode.addEventListener("change",l=>this.setChanged())}getName(){return this.name}setRenderer(e){this.renderer=e}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(e){this.attributes=e,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(e){this.fragmentShader=e,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(e){this.vertexShader=e,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(e,t=pl){}update(e,t,i){}setSize(e,t){}initialize(e,t,i){}dispose(){for(let e of Object.keys(this)){let t=this[e];if(t!==null&&typeof t.dispose=="function"){if(t instanceof gc||t===this.renderer)continue;this[e].dispose()}}}};function YP(e,t,i){for(let n of t){let r="$1"+e+n.charAt(0).toUpperCase()+n.slice(1),s=new RegExp("([^\\.])(\\b"+n+"\\b)","g");for(let a of i.entries())a[1]!==null&&i.set(a[0],a[1].replace(s,r))}}function Z0e(e,t,i,n,r,s,a){let o=new Map([["fragment",t.getFragmentShader()],["vertex",t.getVertexShader()]]),l=o.get("fragment")!==void 0&&/mainImage/.test(o.get("fragment")),c=o.get("fragment")!==void 0&&/mainUv/.test(o.get("fragment")),u=[],h=[],d=!1,p=!1;if(o.get("fragment")===void 0)console.error("Missing fragment shader",t);else if(c&&a&to.CONVOLUTION)console.error("Effects that transform UV coordinates are incompatible with convolution effects",t);else if(!l&&!c)console.error("The fragment shader contains neither a mainImage nor a mainUv function",t);else{let f=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,v=MM.Section;if(c){let g=`	${e}MainUv(UV);
`;i.set(v.FRAGMENT_MAIN_UV,i.get(v.FRAGMENT_MAIN_UV)+g),d=!0}if(o.get("vertex")!==null&&/mainSupport/.test(o.get("vertex"))){let g=`	${e}MainSupport(`;g+=/mainSupport *\([\w\s]*?uv\s*?\)/.test(o.get("vertex"))?`vUv);
`:`);
`,i.set(v.VERTEX_MAIN_SUPPORT,i.get(v.VERTEX_MAIN_SUPPORT)+g),u=u.concat([...o.get("vertex").matchAll(/(?:varying\s+\w+\s+(\w*))/g)].map(y=>y[1])),h=h.concat(u).concat([...o.get("vertex").matchAll(f)].map(y=>y[1]))}h=h.concat([...o.get("fragment").matchAll(f)].map(g=>g[1])),h=h.concat([...t.defines.keys()].map(g=>g.replace(/\([\w\s,]*\)/g,""))),h=h.concat([...t.uniforms.keys()]),t.uniforms.forEach((g,y)=>s.set(e+y.charAt(0).toUpperCase()+y.slice(1),g)),t.defines.forEach((g,y)=>r.set(e+y.charAt(0).toUpperCase()+y.slice(1),g)),YP(e,h,r),YP(e,h,o);let m=t.blendMode;if(n.set(m.blendFunction,m),l){let g=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/,y=`${e}MainImage(color0, UV, `;a&to.DEPTH&&g.test(o.get("fragment"))&&(y+="depth, ",p=!0),y+=`color1);
	`;let x=e+"BlendOpacity";s.set(x,m.opacity),y+=`color0 = blend${m.blendFunction}(color0, color1, ${x});

	`,i.set(v.FRAGMENT_MAIN_IMAGE,i.get(v.FRAGMENT_MAIN_IMAGE)+y),y=`uniform float ${x};

`,i.set(v.FRAGMENT_HEAD,i.get(v.FRAGMENT_HEAD)+y)}i.set(v.FRAGMENT_HEAD,i.get(v.FRAGMENT_HEAD)+o.get("fragment")+`
`),o.get("vertex")!==null&&i.set(v.VERTEX_HEAD,i.get(v.VERTEX_HEAD)+o.get("vertex")+`
`)}return{varyings:u,transformedUv:d,readDepth:p}}var xx=class extends xr{constructor(e,...t){super("EffectPass"),this.fullscreenMaterial=new MM(null,null,null,e),this.effects=t.sort((i,n)=>n.attributes-i.attributes),this.skipRendering=!1,this.uniformCount=0,this.varyingCount=0,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(e){this.fullscreenMaterial.encodeOutput=e}get dithering(){return this.fullscreenMaterial.dithering}set dithering(e){let t=this.fullscreenMaterial;t.dithering=e,t.needsUpdate=!0}verifyResources(){let e=this.renderer.capabilities,t=Math.min(e.maxFragmentUniforms,e.maxVertexUniforms);this.uniformCount>t&&console.warn("The current rendering context doesn't support more than "+t+" uniforms, but "+this.uniformCount+" were defined"),t=e.maxVaryings,this.varyingCount>t&&console.warn("The current rendering context doesn't support more than "+t+" varyings, but "+this.varyingCount+" were defined")}updateMaterial(){let e=MM.Section,t=new Map([[e.FRAGMENT_HEAD,""],[e.FRAGMENT_MAIN_UV,""],[e.FRAGMENT_MAIN_IMAGE,""],[e.VERTEX_HEAD,""],[e.VERTEX_MAIN_SUPPORT,""]]),i=new Map,n=new Map,r=new Map,s=new Set,a=0,o=0,l=0,c=!1,u=!1;for(let d of this.effects)if(d.blendMode.blendFunction===kt.SKIP)l|=d.getAttributes()&to.DEPTH;else if(l&d.getAttributes()&to.CONVOLUTION)console.error("Convolution effects cannot be merged",d);else{l|=d.getAttributes();let p="e"+a++,f=Z0e(p,d,t,i,n,r,l);if(o+=f.varyings.length,c=c||f.transformedUv,u=u||f.readDepth,d.extensions!==null)for(let v of d.extensions)s.add(v)}let h=/\bblend\b/g;for(let d of i.values()){let p=d.getShaderCode().replace(h,`blend${d.blendFunction}`);t.set(e.FRAGMENT_HEAD,t.get(e.FRAGMENT_HEAD)+p+`
`)}if(l&to.DEPTH){if(u){let d=`float depth = readDepth(UV);

	`;t.set(e.FRAGMENT_MAIN_IMAGE,d+t.get(e.FRAGMENT_MAIN_IMAGE))}this.needsDepthTexture=this.getDepthTexture()===null}else this.needsDepthTexture=!1;if(c){let d=`vec2 transformedUv = vUv;
`;t.set(e.FRAGMENT_MAIN_UV,d+t.get(e.FRAGMENT_MAIN_UV)),n.set("UV","transformedUv")}else n.set("UV","vUv");t.forEach((d,p,f)=>f.set(p,d.trim().replace(/^#/,`
#`))),this.uniformCount=r.size,this.varyingCount=o,this.skipRendering=a===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderParts(t).setExtensions(s).setUniforms(r).setDefines(n)}recompile(){this.updateMaterial(),this.verifyResources()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(e,t=pl){this.fullscreenMaterial.depthBuffer=e,this.fullscreenMaterial.depthPacking=t;for(let i of this.effects)i.setDepthTexture(e,t)}render(e,t,i,n,r){for(let s of this.effects)s.update(e,t,n);if(!this.skipRendering||this.renderToScreen){let s=this.fullscreenMaterial;s.inputBuffer=t.texture,s.time+=n,e.setRenderTarget(this.renderToScreen?null:i),e.render(this.scene,this.camera)}}setSize(e,t){this.fullscreenMaterial.setSize(e,t);for(let i of this.effects)i.setSize(e,t)}initialize(e,t,i){this.renderer=e;for(let n of this.effects)n.initialize(e,t,i),n.addEventListener("change",r=>this.handleEvent(r));this.updateMaterial(),this.verifyResources(),i!==void 0&&i!==Zn&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(let e of this.effects)e.dispose()}handleEvent(e){switch(e.type){case"change":this.recompile();break}}},Q0e=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],WF=class extends xr{constructor({resolutionScale:e=.5,width:t=Pr.AUTO_SIZE,height:i=Pr.AUTO_SIZE,kernelSize:n=IA.LARGE}={}){super("KawaseBlurPass"),this.renderTargetA=new Qt(1,1,{minFilter:Lt,magFilter:Lt,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";let r=this.resolution=new Pr(this,t,i,e);r.addEventListener("change",s=>this.setSize(r.baseWidth,r.baseHeight)),this.blurMaterial=new WP,this.ditheredBlurMaterial=new WP,this.ditheredBlurMaterial.uniforms.scale=this.blurMaterial.uniforms.scale,this.ditheredBlurMaterial.dithering=!0,this.dithering=!1,this.kernelSize=n}getResolution(){return this.resolution}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get scale(){return this.blurMaterial.scale}set scale(e){this.blurMaterial.scale=e}getScale(){return this.blurMaterial.scale}setScale(e){this.blurMaterial.scale=e}getKernelSize(){return this.kernelSize}setKernelSize(e){this.kernelSize=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}render(e,t,i,n,r){let s=this.scene,a=this.camera,o=this.renderTargetA,l=this.renderTargetB,c=Q0e[this.kernelSize],u=this.blurMaterial,h=t,d,p;for(this.fullscreenMaterial=u,d=0,p=c.length-1;d<p;++d){let f=d&1?l:o;u.kernel=c[d],u.inputBuffer=h.texture,e.setRenderTarget(f),e.render(s,a),h=f}this.dithering&&(u=this.ditheredBlurMaterial,this.fullscreenMaterial=u),u.kernel=c[d],u.inputBuffer=h.texture,e.setRenderTarget(this.renderToScreen?null:i),e.render(s,a)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t);let n=i.width,r=i.height;this.renderTargetA.setSize(n,r),this.renderTargetB.setSize(n,r),this.blurMaterial.setSize(n,r),this.ditheredBlurMaterial.setSize(n,r)}initialize(e,t,i){i!==void 0&&(this.renderTargetA.texture.type=i,this.renderTargetB.texture.type=i,i!==Zn?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.ditheredBlurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):e.outputEncoding===Mt&&(this.renderTargetA.texture.encoding=Mt,this.renderTargetB.texture.encoding=Mt))}static get AUTO_SIZE(){return Pr.AUTO_SIZE}},K0e=class extends xr{constructor({width:e=Pr.AUTO_SIZE,height:t=Pr.AUTO_SIZE,renderTarget:i,luminanceRange:n,colorOutput:r}={}){super("LuminancePass"),this.fullscreenMaterial=new x0e(r,n),this.needsSwap=!1,this.renderTarget=i,this.renderTarget===void 0&&(this.renderTarget=new Qt(1,1,{minFilter:Lt,magFilter:Lt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target",this.renderTarget.texture.generateMipmaps=!1);let s=this.resolution=new Pr(this,e,t);s.addEventListener("change",a=>this.setSize(s.baseWidth,s.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(e,t,i,n,r){let s=this.fullscreenMaterial;s.inputBuffer=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t),this.renderTarget.setSize(i.width,i.height)}initialize(e,t,i){i!==void 0&&i!==Zn&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},$0e=class extends xr{constructor(e,t){super("MaskPass",e,t),this.needsSwap=!1,this.clearPass=new RA(!1,!1,!0),this.inverse=!1}get inverted(){return this.inverse}set inverted(e){this.inverse=e}get clear(){return this.clearPass.enabled}set clear(e){this.clearPass.enabled=e}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(e){this.inverted=e}render(e,t,i,n,r){let s=e.getContext(),a=e.state.buffers,o=this.scene,l=this.camera,c=this.clearPass,u=this.inverted?0:1,h=1-u;a.color.setMask(!1),a.depth.setMask(!1),a.color.setLocked(!0),a.depth.setLocked(!0),a.stencil.setTest(!0),a.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),a.stencil.setFunc(s.ALWAYS,u,4294967295),a.stencil.setClear(h),a.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?c.render(e,null):(c.render(e,t),c.render(e,i))),this.renderToScreen?(e.setRenderTarget(null),e.render(o,l)):(e.setRenderTarget(t),e.render(o,l),e.setRenderTarget(i),e.render(o,l)),a.color.setLocked(!1),a.depth.setLocked(!1),a.stencil.setLocked(!1),a.stencil.setFunc(s.EQUAL,1,4294967295),a.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),a.stencil.setLocked(!0)}},Va=class extends xr{constructor(e,t="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=e,this.inputBufferUniform=null,this.setInput(t)}setInput(e){if(this.inputBufferUniform=null,this.fullscreenMaterial!==null){let t=this.fullscreenMaterial.uniforms;t!==void 0&&t[e]!==void 0&&(this.inputBufferUniform=t[e])}}render(e,t,i,n,r){this.inputBufferUniform!==null&&t!==null&&(this.inputBufferUniform.value=t.texture),e.setRenderTarget(this.renderToScreen?null:i),e.render(this.scene,this.camera)}initialize(e,t,i){i!==void 0&&i!==Zn&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},Xb=1/1e3,J0e=1e3,ege=class{constructor(){this.previousTime=0,this.currentTime=0,this.delta=0,this.fixedDelta=1e3/60,this.elapsed=0,this.timescale=1,this.fixedDeltaEnabled=!1,this.autoReset=!1}setFixedDeltaEnabled(e){return this.fixedDeltaEnabled=e,this}isAutoResetEnabled(e){return this.autoReset}setAutoResetEnabled(e){return typeof document<"u"&&document.hidden!==void 0&&(e?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this.autoReset=e),this}getDelta(){return this.delta*Xb}getFixedDelta(){return this.fixedDelta*Xb}setFixedDelta(e){return this.fixedDelta=e*J0e,this}getElapsed(){return this.elapsed*Xb}getTimescale(){return this.timescale}setTimescale(e){return this.timescale=e,this}update(e){return this.fixedDeltaEnabled?this.delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=e!==void 0?e:performance.now(),this.delta=this.currentTime-this.previousTime),this.delta*=this.timescale,this.elapsed+=this.delta,this}reset(){return this.delta=0,this.elapsed=0,this.currentTime=performance.now(),this}handleEvent(e){document.hidden||(this.currentTime=performance.now())}dispose(){this.setAutoResetEnabled(!1)}},IA={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},tge=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(map,uv)*intensity,0.0,1.0);}`,ige=class extends uo{constructor({blendFunction:e=kt.SCREEN,luminanceThreshold:t=.9,luminanceSmoothing:i=.025,resolutionScale:n=.5,intensity:r=1,width:s=Pr.AUTO_SIZE,height:a=Pr.AUTO_SIZE,kernelSize:o=IA.LARGE}={}){super("BloomEffect",tge,{blendFunction:e,uniforms:new Map([["map",new Fe(null)],["intensity",new Fe(r)]])}),this.renderTarget=new Qt(1,1,{minFilter:Lt,magFilter:Lt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.renderTarget.texture.generateMipmaps=!1,this.uniforms.get("map").value=this.renderTarget.texture,this.luminancePass=new K0e({renderTarget:this.renderTarget,colorOutput:!0}),this.luminanceMaterial.threshold=t,this.luminanceMaterial.smoothingFactor=i,this.blurPass=new WF({resolutionScale:n,width:s,height:a,kernelSize:o});let l=this.blurPass.getResolution();l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}get resolution(){return this.blurPass.resolution}getResolution(){return this.blurPass.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(e){this.resolution.preferredWidth=e}get height(){return this.resolution.height}set height(e){this.resolution.preferredHeight=e}get dithering(){return this.blurPass.dithering}set dithering(e){this.blurPass.dithering=e}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(e){this.blurPass.kernelSize=e}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(e){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(e){this.uniforms.get("intensity").value=e}getIntensity(){return this.intensity}setIntensity(e){this.intensity=e}getResolutionScale(){return this.resolution.scale}setResolutionScale(e){this.resolution.scale=e}update(e,t,i){let n=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(e,t,n),this.blurPass.render(e,n,n)):this.blurPass.render(e,t,n)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t),this.renderTarget.setSize(i.width,i.height),this.luminancePass.resolution.copy(i)}initialize(e,t,i){this.blurPass.initialize(e,t,i),i!==void 0&&(this.renderTarget.texture.type=i,e.outputEncoding===Mt&&(this.renderTarget.texture.encoding=Mt))}},nge="uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",rge=class extends uo{constructor({blendFunction:e=kt.NORMAL,brightness:t=0,contrast:i=0}={}){super("BrightnessContrastEffect",nge,{blendFunction:e,uniforms:new Map([["brightness",new Fe(t)],["contrast",new Fe(i)]])})}get brightness(){return this.uniforms.get("brightness").value}set brightness(e){this.uniforms.get("brightness").value=e}getBrightness(e){return this.brightness}setBrightness(e){this.brightness=e}get contrast(){return this.uniforms.get("contrast").value}set contrast(e){this.uniforms.get("contrast").value=e}getContrast(e){return this.contrast}setContrast(e){this.contrast=e}},sge="void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=vec4(vec3(average(inputColor.rgb)),inputColor.a);}",age=class extends uo{constructor(e=kt.NORMAL){super("ColorAverageEffect",sge,{blendFunction:e})}},oge="varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;outputColor=vec4(ra.x,inputColor.g,ba.x,max(max(ra.y,ba.y),inputColor.a));}",lge="uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vec2 shift=offset*vec2(1.0,aspect);vUvR=uv+shift;vUvB=uv-shift;}",cge=class extends uo{constructor({blendFunction:e=kt.NORMAL,offset:t=new te(.001,5e-4)}={}){super("ChromaticAberrationEffect",oge,{vertexShader:lge,blendFunction:e,attributes:to.CONVOLUTION,uniforms:new Map([["offset",new Fe(t)]])})}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}},hge=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;
#else
uniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;
#endif
uniform lowp sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}`,uge=class extends uo{constructor(e,{blendFunction:t=kt.NORMAL,worldFocusDistance:i,worldFocusRange:n,focusDistance:r=0,focalLength:s=.1,focusRange:a=s,bokehScale:o=1,width:l=Pr.AUTO_SIZE,height:c=Pr.AUTO_SIZE}={}){super("DepthOfFieldEffect",hge,{blendFunction:t,attributes:to.DEPTH,uniforms:new Map([["nearColorBuffer",new Fe(null)],["farColorBuffer",new Fe(null)],["nearCoCBuffer",new Fe(null)],["scale",new Fe(1)]])}),this.camera=e,this.renderTarget=new Qt(1,1,{minFilter:Lt,magFilter:Lt,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTarget.texture.generateMipmaps=!1,this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new Va(new o0e(e));let u=this.cocMaterial;u.focusDistance=r,u.focusRange=a,i!==void 0&&(u.worldFocusDistance=i),n!==void 0&&(u.worldFocusRange=n),this.blurPass=new WF({kernelSize:IA.MEDIUM,width:l,height:c});let h=this.blurPass.getResolution();h.addEventListener("change",p=>this.setSize(h.getBaseWidth(),h.getBaseHeight())),this.maskPass=new Va(new b0e(this.renderTargetCoC.texture));let d=this.maskPass.fullscreenMaterial;d.maskFunction=jF.MULTIPLY,d.colorChannel=GF.GREEN,this.bokehNearBasePass=new Va(new X1(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new Va(new X1(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new Va(new X1(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new Va(new X1(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null,this.bokehScale=o}get cocTexture(){return this.renderTargetCoC.texture}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.circleOfConfusionMaterial}getBlurPass(){return this.blurPass}get resolution(){return this.blurPass.getResolution()}getResolution(){return this.blurPass.getResolution()}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(e){let t=[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];for(let i of t)i.fullscreenMaterial.setScale(e);this.maskPass.fullscreenMaterial.setStrength(e),this.uniforms.get("scale").value=e}getBokehScale(){return this.bokehScale}setBokehScale(e){this.bokehScale=e}getTarget(){return this.target}setTarget(e){this.target=e}calculateFocusDistance(e){let t=this.camera,i=t.position.distanceTo(e);return SM(-i,t.near,t.far)}setDepthTexture(e,t=pl){this.circleOfConfusionMaterial.depthBuffer=e,this.circleOfConfusionMaterial.depthPacking=t}update(e,t,i){let n=this.renderTarget,r=this.renderTargetCoC,s=this.renderTargetCoCBlurred,a=this.renderTargetMasked;if(this.target!==null){let o=this.calculateFocusDistance(this.target);this.circleOfConfusionMaterial.focusDistance=o}this.cocPass.render(e,null,r),this.blurPass.render(e,r,s),this.maskPass.render(e,t,a),this.bokehFarBasePass.render(e,a,n),this.bokehFarFillPass.render(e,n,this.renderTargetFar),this.bokehNearBasePass.render(e,t,n),this.bokehNearFillPass.render(e,n,this.renderTargetNear)}setSize(e,t){let i=this.resolution;i.setBaseSize(e,t);let n=i.width,r=i.height,s=[this.cocPass,this.blurPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];s.push(this.renderTargetCoC,this.renderTargetMasked),s.forEach(a=>a.setSize(e,t)),s=[this.renderTarget,this.renderTargetNear,this.renderTargetFar,this.renderTargetCoCBlurred],s.forEach(a=>a.setSize(n,r)),[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(a=>a.fullscreenMaterial.setSize(n,r))}initialize(e,t,i){[this.cocPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach(n=>n.initialize(e,t,i)),this.blurPass.initialize(e,t,Zn),i!==void 0&&(this.renderTarget.texture.type=i,this.renderTargetNear.texture.type=i,this.renderTargetFar.texture.type=i,this.renderTargetMasked.texture.type=i,e.outputEncoding===Mt&&(this.renderTarget.texture.encoding=Mt,this.renderTargetNear.texture.encoding=Mt,this.renderTargetFar.texture.encoding=Mt,this.renderTargetMasked.texture.encoding=Mt))}};new T;new ke;var dge="uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",pge=class extends uo{constructor({blendFunction:e=kt.NORMAL,hue:t=0,saturation:i=0}={}){super("HueSaturationEffect",dge,{blendFunction:e,uniforms:new Map([["hue",new Fe(new T)],["saturation",new Fe(i)]])}),this.hue=t}get saturation(){return this.uniforms.get("saturation").value}set saturation(e){this.uniforms.get("saturation").value=e}getSaturation(){return this.saturation}setSaturation(e){this.saturation=e}get hue(){let e=this.uniforms.get("hue").value;return Math.acos((e.x*3-1)/2)}set hue(e){let t=Math.sin(e),i=Math.cos(e);this.uniforms.get("hue").value.set((2*i+1)/3,(-Math.sqrt(3)*t-i+1)/3,(Math.sqrt(3)*t-i+1)/3)}getHue(){return this.hue}setHue(e){this.hue=e}};new ut;var fge=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,mge=class extends uo{constructor({blendFunction:e=kt.SCREEN,premultiply:t=!1}={}){super("NoiseEffect",fge,{blendFunction:e}),this.premultiply=t}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(e){this.premultiply!==e&&(e?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(e){this.premultiply=e}},gge="uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}",vge=class extends uo{constructor(e=30){super("PixelationEffect",gge,{uniforms:new Map([["active",new Fe(!1)],["d",new Fe(new te)]])}),this.resolution=new te,this.d=0,this.granularity=e}get granularity(){return this.d}set granularity(e){let t=Math.floor(e);t%2>0&&(t+=1),this.d=t,this.uniforms.get("active").value=t>0,this.setSize(this.resolution.width,this.resolution.height)}getGranularity(){return this.granularity}setGranularity(e){this.granularity=e}setSize(e,t){this.resolution.set(e,t),this.uniforms.get("d").value.setScalar(this.d).divide(this.resolution)}};new T;new T;var ZP="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC",QP="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAYAAAABNmBHAAAgAElEQVR4Xuy9CbhlV1ktOvbpq09DkiIkUBI6kxASIH0DlAQiIK1wRfSJTx+i4JX7vKIigs8HXpXvqVcvrcC9agQ7IDTSSWgqCQQliDRBJKkkhDSkqVPNqVOnP+8b//rH3P+eZ+199tlznVTlvVrft7+1T7OaueZY42/m37QALKNk2wHg1pITlB17mC+Pp11W3X/LHyT32vhg48/5SOv+PnwpsHA70JoGlueB1iKApeqzvOzn44GatTB76Xzhd7suBR7+WWADgDEAwwCG/L54b/poDLrHuvvm70Z2Avhsc+PVcxscBU8F8C8ADg5+ipIjD/PlGwfgju8B924E5seARUfLsiNmqQW0IjL8+7L2NYD/7COBzfcCm+aB8SVgdAkYIRCXKyDax4EdAanL5PuNPllNvXDlAHwFgP8AcC2AhRIoDXbsYb48dl5WkVFTE3LGDcC9m4CZCWBuFFgeAZaGAYJQQCRqDHT+McJrVb8zwATUXH02MHYfMHEIGFsAxgjApQqACYQORjtd/B7Axt/z79sC0+cMPgjjlwPwVwHcA+DfAHzTxcVgWBroqMN8+cYBeM71wH0TwKExYHYUWCIAHYRLTlkCYgcIBcAgU/n3qy8GRu4HRgnAOWBkERhddPAJhGJDBxkvw7cqimr+zFM/ZLnZF64cgL8BYD+AWwB8x/dlWuWagHiYL984AJ/0RWBy1AE4AizyM1yxYAcTigW55xMbAkxEiwEdkJ/ZCQxPAiOHgBECcKEC4TBZcKkSv+mTieNcNPNC26mLNsj45QD8LQDTAO4GcJt/7iw2bfoG4WG+vAGwm9ExiEg69zpg/wgwPQLMjgALzn4E4aIzoJjQ9g4024uygkj+pyuAoX0VAIfngOH5NgCHMhAm8Sv2y3XDZeBhNIp8OzJE8OsBzAKYBHAXgDt8/4O+MVT0j4f58o0D8Pxrgf3DwMwIMEPQEYRkNwfgsuuDZLskip0No0gWMD/9HGDoADAkAC4Aw/wsAgZAgs2Z0ABI0GU6IVmKv+f28KDnHxkA/G0A8y6G73N9kOCjXnh/Ebb6OvgwX75xAF5wLTA1VIHPADgMLDj4yIA5AAm6aCUnv4oz46eeDwxNAUMzwJAz4BABSNDFTwSfg7DDKHE23MG5PqIY8A1u/dINs9dBdy8AgnGPM2NfUBrsnw7z5RsH4IXXAAcJviFgluAbygBINnSLWOAjGxJ4pgOKDV0v/OSLKp8iGXBovhLBBOCQM2ACoTOhnYrAdItYbCij5JFzRyIAqRccAnDAQUjg6UNQ7hsMXP0cRQAexss3DsCLCECCLwCQzMcPwUi2MwAScAKbfnY/YRLFQ8DHX+IAJAMSfDkAF13kLvleIjhjQQHxUVS3jjgGpKeeNzYVQEjgUS8k+PghONdhIwAP4+XXBYCHKIJbwJyDTgaIAdCBJx3Q2M8tYAHP9m4df/ylQOsQ0JqtRLCx30K1wtLBggScQOgsKBGcWHAJeOwRC0BSM1mQIKRbhh+Bj98JQP6t4U0APEyXXxcAEnxkQAFwoVUxID9kvQg+c1C7vidRbIDkc24B//hTQGumDcCWA5DgMxASdNIFBUI5pCML8v8API5zfEQx4BudgqiczviSnJhQwCP4BMCGl+wO8+U7AJi/W4O4YS6+pmK/2ciADsAOBhTIIiAJnPB7AvNjP+0AnANaYkAHX2JBAc+tYaJXOqBZv24Vc386XW5dtkHGW+4HFAJonpOe+YYQZAShgKjv3PNvPQaxVoI8zJdfFwASfPzMUwS3Kt1v0UFIlos6oDFdAGFcliMAP/ryAEAGNwQRnDOgLbdlIEwrIs6AZ/QgkMMHQF6ZAKQcJAsSYPwIeAIk9wJgoPK1gi7+PwF4GC/fOAAvIQPSs0URTPBJ/Pp3GSEGRHfBCIQ0xowBtUbcAj7ys5X4Jfu1HIAGQrIgQRXEsAFQIORDFhiDY/rMHmrU4QUgR08AkgUjCAW6CD6CkwBsAIQC4GG6fPMA3OXiNzCg2I9gNCMksmAAoemDzoimFwL48M85AKkiuQVMAAp8CYRRDAt8GQiJ67N6GJODAXAHlsGguscA2AJg1IPGYmxOpBxFWkRN9LsATgIwXnNs/v/5z/9XCf8BO3YAtxbc/46/KDt+5+ea1Yku2VUxHz/z0v24FwMGK1gWsK2OUUxHHdCBeRUB6OxHABr4ZICIBd0QWSF+XRdMTAjgCdTrG9cBNwE4F8CpDkICyYLGsuhFt6zs+gISwUen8zEAjgMw4cfx2H6O/90yAFo84Cbg4ID3/9TfLTt+5+ebnRABkODjx0SwPi5ec/FrYpmqSAxM8Dn60CsqAFI6GfhqAMiDE/gokmvEr0C4PgDkBQm40wE8zMFEUDKEVoxIMLl/KS73mE7H9d+vcKHQQcjwW0Yu9nP8m8sAmOIBuWY6wP2/4s0ezjjg8TuvaR6ABJ70vxUApGrm7EbGE+i472BAB+WHfqHS/eoAaEwY2E9+wLSXTqhI7CXgnB6LCoOJ4BiST+hTnG0HcCwAglCx3ARoZEVFXnBPp/O/A/hXACc7CPs9/i1lAOyIB+RDX+P9/+pbQjjjAMfv/PL6AFDs1wFAgs/9fgKfgdE/ZEpuiQlbwAde6QAMBgiRmsSwA9BY0JfjovGRDBMH4TlcXGhcBOc6HkF0gjPhZgchxTLZMAci/04W/B6Ab3t09EPXcPyflgFwRTwgJ2MN9/8bf5qFM67x+B/aW4XQz42FeL0YrRyikztUFw0704mf9kXgxhOAqc3AAsPyRxxQCs/PdXOFY0W1KHy3QIUGtx+6vdnx1vsB+dsTncm2AogglFgVEAlUWrOMB2RyEmMCGQ/Y7/HvKns6tfGAnJQ+r/9b76oJZ1zD8WdyQjYBh8aBhVEHjELouQ8ukQ7VRSCJAALwkr+sALhnGzDD3JAJYJHg9uhoi4bx8ytkWUtvHT/7+Zc4dw1uZ3612fH2dkQf7yxIEEockwkJQn4IQoq8unhAhmPRKKFx0uv4K8ueTs94wD7u//VX9ghn7OP4c+4G7h8HpseB+dF2AKlFLwuAIZ8jD6NPrOhAffmfA9/ZBuzZCkyRWSeqBCWyoYGQ5yQrBpDbum/ME1HoPo0XEkSD2zlfbna8q6+EUJcTCxKEtHL5EQjP6BEPyIgYAZBvYt3xHyx7OqvGA65y/7/9wVXCGVc5/sl7qxD66dEqiYgRzAqhN1A4CBNAAlDyAFI+iZ9/N3DLJuC+jcDUBmCWyUnOrmTYCMIOkNclLg0B8/RsNLg9+UvNjnd1APLmmQpFHyEBROuWACQT8nN+H/GAvY7/VNnT6SsesMf13/CpahGnZzhjj+PPmwX2MYdDIfQexWyBAwEUOQDrRDN/98p3A7dvAO6fAA5sqHJDBEAyoUVGkwEd6HR12XU4kwzfl6fCXTZzjy57vvnR513X7Hj7AyDvggAUi9EyFgiZqNxPQF6345nOWbD1HQ/Y5fpvuLa/2+82/vNHgAPDFQDnhoF5j2C2qBWCI8bw1eRw5CL5l94L3DEOTI4DB8Y9OWmsEu/zBJ3rgsaybqBob/7A4C7jtWcooRrczr+u2fH2D0AOQgAUCxKEP7aGgLy64+m6KdjWFA9Yc/03/Osa4glrjr+AupqHz1sEs0cxG0BC9HIePLoit9eNkVf9L+DuUWByDJgaq4ybGYLPAWgiXmLedUE7dwC7saL7CqfPKXi4NYdaykCD410bAHlDEsNiwZ9wAPYbkJcfz6T2gm3N8YDZ9d/wHxUA+739fPwXPrSKYGb+BuP3jAFDElFH9HIWwbzCIGkBr/or4J4RYO8oMOW6ZVcAuvi1Cgoha04BCwT5gfMKHm7NoRde2+x41w5A3hQZkADk5+cGiAeMx3+/7AENFA8Yrv/G71cAXFM4Yzj+otOAaQLQA0gZxaIIZtMDFTigKJV8H9Iq6aZ59ZXAvSPAvpEKgBTtBODcSCWCZeRYtpzrmLyeGNCAyFl1v+Hei8qeb370Rdc2O97BAMi7EgB/2QG41nhAHU9LuWAbOB7Qr//GPRUA13r7Gv9FZwIMoVcEswEwfDoimEP0shKKtIphaZQAXv1+YM+wA3DEdcvRKkGJADQQEsQuhi1Tjt95vBsh5nx2IO59SsHDrTmUOStNjndwAAqEry0IyCMICkOyiuIBNwBvPFQQT7gBuPjc9oRYAIHyOEL4vIFEYVNaOou5vCGE/tV/A0wOVcnpzI47NOri3QFIBpSeaSDUdYLOSWvYImSGgftpJDa4MWJbAGxivGUA5MAOc0Be6eVLj7/4Mk+hzCOYPYpZDBiNkLh+G/M3yFyv/ltgL3W3YQfgcFUhgRY2PwY+Z7/EhAR1SFyXCOb57r28QfQBsJQBMn5D4y0HYLPje9Cd7RIC0PM3EiMofF4gVCBp1P840ix/gyz56r+vAMjk9Gl375iB4+CzveuZdLkkEPJ8ZEfX/6R73vOjzT5Si9hucLxHAVg4PwJgRwh9CKOXK8YA4ZEqKZXSQWh5P+5AftXfA/uGKvYjCKn72cctbFrZNECka5L5CPwIPtMH3TVz17MLB5gdLgA2Nd6jACycHwLQxFEUSR5ASvARDB0h9AQb9bXIgCGk6lUfAPYTgEPAITKgg1BObk58srTJgG58WMkWMaAbQQT1nc8rHGANAJsc71EAFs4PAagQestgC1lsBJ4BMCSOK6dDUcwqqaFiQr/0QeAAAdjy+jBiQQeeMSBZT3nCPUDIa9z+/MIB1gCwyfEeBWDh/BCAeQSzgkjFfGLBBD5nxQ4DxN0wv3hVxX5TBGDwL5obxvVA5YqYL5BeMLd66YYxJpRB0gK+96LCAdYAsMnxHgVg4fwIgMrhUPKQ2C+Bz0PmBTqBMQehAbDlIjj4F80KJguSVZ0FuXpjoCOgXawLjALhbT9eOMAuAGxqvEcBWDg/l1IE05Ed0ygZnyHdz0VwCqEPIfNyx0QQvvLDFQCp+8nfZk5und8tXwIgWcHSNX0N2CJmnAl3v6RwgNnhl17T7HiPArBwfghAS7mV/hey2JS9FvM3BLpUUi1YwDRMXvkRYJoAlAh2l0dcZ04s6JUTDIjyBcrl4yDc/dLCAdYAsMnxHgVg4fxwKVwJgGEJNmWtxpQMpX9on2eRhVA+O56AjMfnP+e3Xvf3NwG4xIPTleiY55bpGh6UbafNU0l0z0p+5Jh5HqYJ6b51nP6XP8cx12XNHQVgIQB/bFPVg2OC7Q+WgVFWng/FvtWLI06uWh5oguKEcXVS/9sEAF//VGD7t4ETDgJbF4CNi8CGZWBs2fPL/H6Vwp2KEtVk4fJ+v/EIYPN9wKa5qu+IncfPwXHVZe/aOL3EbwS7xv8A1rQvnO0j8PArTgTGZ4BxFv9mIxhOCGsv+0OPYDRghcLfkWkEuq0+G00x4OtfDGz+d2DbHmDLjL8si8AYP/7CGIAiEEMTG92zXqSbH+d9R2aA0XnvO+JjthiIrOVDHHPOkBrzUQAWAPsZp3oPDpa/Xag6EVkLBK+5rAnJC3/nYk/APD704WiEAV8OTHwX2LQH2DgFbJgFNrBhjd8r79deGoEwsllgNBOzy8CdjweG9wBj08AIAci2D6HafmyAk4/Z7SJ72hGYRwFYAMDLTwOGp4FRFgD3HhzqRGQiyeurqOdG6r0Rm8IEZjzRlkiqCWoEgK8Axm4BJu4HJhyAbFhDxmbDGnZO4j0SgLGDkpibgEq66TJw/1nA0F5gdLpq+zDqFfd5LMeWqu5HNST0uJOIllg+qgMWgI+HPv0xwLA3gWHpW2sC441gCECbmKziaGrnUdMO4aHeh6MxAP4SMHI7ML4HGD8AjHvHJGNAgpDgY/ck3stipRemvVhc+uASMPUEYGh/9dIRgGx8Y+MNbR/00uVtH0wEx94j/v0oAxaA8Ed+GBieAYZZg5kADC0QWGOFzGJlcGPzl1BxNLXD8sk4xftwNAbA/wwM3wGMUmxOOQBnHXzetIYvibonmSiuYTNjriVg7glAiwBk0fNZH6+PmX9P6kfNmCXGpftJ7TgKwBIAnln14BAAYxMYm5C6RjCyCoOyr0qkD/c+HI0B8DXA8N3AyCQwesD1VQKH7EcASm1Q+y4CkN9pUKiVF5nLvy+fBbTUd8QBaH1HvNBROiZvfsNnrF4kcvPwpdsBLBeU18Nf7AB23Dp4ecHC8oBgUlJJecLS+7+WOpE3gbE+HKw+yoevCYkMGKqPJrdEKARutaFYRs1fiEZ0wP8CDN8LDO8FRqYq3W10pgKgfYLaYCzootgA6KXaTA90y374TKB1sBozy77xHFZ536utRgAmEaw6g5kUSFZwSXnA330qsOlfgHMPDlZesLA8IOjoLypPWHj/11EnCiVwkz7kAExtsGraYUWdSDX5TmsagL8KDBGA7Bd30JsW0oWivnEOQNP7yGTSBR101AlZSUtGyfgZDkCWY1HnJdcBVe6325hTvelg2CQjZNDygG/2An0j1wKnL6y9vGBheUC8prQ8YeH9X39OVQSc7Mc6fCaKvAeHdCIVf4yMYCynTpX+nb97NJmlSQb8r8DQHm9YOFUZTKOzoXGhs6AxF0HIexcLBvWBuiHN8s2ne98R3qc6L4Vyb2oBVjfm9MIFHbjDCh6kPOBbQoG+oW8CO5bWVl6wsDwgfr20PGHh/X/1iaEIuDcCTIW/1Q4rFv8OnYiW3c+W2iKwUjKbyjQNwL1uuR6sAEgDgq1brXOmV81PxhNB6DUDBSYzQJwFtz623XcktX1Q1VWKaTF/zZhVazBVYA1tX5MazsGvobwe/jQr0Ne6BTh5uf/ygoXlAfG60vKEhff/rSe1i4DnTWDUACY1guFTDqLYdCBvf6DJYSMYATBfOx1kLfj1v1axH10nQ3Sd0GUkBnTfpemtBJgseIKQAHLQcVxa2TnuMW0Aqui5es8xBIegVdVVE8VhzHnLh65WMB9An+X18K6aAn2tO4ETl6vqbKuVFywsDwhevqg8YeH93/Rk70JE90nowxZbIJjvS3WYNSGUwGHJTpPxwwcbBuBrgRYBeKACn7VtpdUu/c0NJxO9BIxcKu4TTODzbkonPLoaL0vyUQRb2y8HsL1ckfWzMeuFi40Qezqi+yiPhyt7FOjr6/gCFwgP7Xb5vssTFt7/nQRg6MGRWmDRoeyTlpgw68GRTwgZgo1gGmXAX6/8dtaylSKY/koyID9BhzML3q1gAos2AcOrZYSoq/pJp1VtODRm9Z3LS/7WjVkvXOzEtOpKyGrlAT+4SoG+VY8vBGCvy/dVnrDw/vee65NBJiAjBIVcAJQjOm+DkCZEeiGAMw6sAwDZsJrAdhFM9rPGhd4904Co5oVuCZPV6kD40Ec6+9W8dBTBsfdc3nkpvnB82fp2RPcs79dHgb51LA9ofsDV6vut5/3PnxcAmLVBiDqgevDaJLkYrpuQxzcNwN8AWgIgRbB8loEBzXDwl4cGiDGft58SCOWGedgjvOJ+bPvgRkiuA+ZjzhnQQOiFNVbloa7l/fos0LdO5QENgEXlCfs8Qbf7HyMA3QVjYihYhLENgjX9y/qwxQmRU/asfd0ZcLU2CHVGyusJQLKfVi98CS12T5f7iECkHpsMkAhCF8+nshWH2I/jXsOYO144GV/9ApAIrS3vt4YCfetQHtAA2G+/4PW4/2PPbzMgmUMi2NoeSCRxIt2/FvuxWURIWCXg357gfTjEDNIHnTRXRCpH5ugKwGl3HpMBXQc0v6WLYVm/5limj04rG762K2uYY9jBkr9+rI03NL5ZbczS/dJ+LQyoga4o77fGAn0NlwdMAOy3vl/T938KAcj121z8Bn+Y9eWQJRz8Y6kNagDh2ey5EvxjxQD8TWdAuneCCO4An1vw5vdzQMmdktwq7pLZQR+dM34+ZumAxvY1Y04uqOAJ6FsExzeto7zfAAX6GiwPaLWR1lrfr8n7f/Rl3QGzmsis+/uO71V9OFgP2gpPhgr7TGRqRUT6dyvr4aIs/pm/2zVUNbBSv6G8e5pEv0Cvec7Po7+bTtjlBRlkvAMBkDeQyvsNWKCvofKACYBrre/X1P0/oWEAnnFD1YdjhtXxR73mX10FfCHHE9pVWcGAI/S0gKsfA2y+twrFZw6Hxf/F0Pk8Ri/kpGSnMuDx5T0iACgQHioo0NdAecBUHW6QdsV2/cL7v/Cyqr5gnc42CCOcfX1VIZ/V8We9IDmTzVXwPDJiXuKXPxtDBma8+lzP4WAgKkPxCUAPE4v5GzEuMX0PYJPLhB6FJsc7MAMmkVxaYC/K9gG+F1++8AQ7Gwbgk78I7GFpXgIwFiRXOwaJZPUbiR0yCUDRk+cHf+YpwMj9HgfI8ClGPyvsSiH0WSKRuYlitLb/zHM/JOSs5C/YIC9cMQDZr/dwxgOW9gtGYUBi0wA8l304vDQvAchilFbpIBQhZ7Ejq6ZQ0/Yhil8y4j89Axie9DAsD6FX9HOK3QtROTFkviN83kG4felIY8DCeLrSeMDSfsEovAECUFsTjHD+tcB+tkFgcXKvBRir7qtFl9owmO4Xy/1G3bAFfPrZHorFNWBFwHjQAFctIghj2kBarw06If/+MM9ZqTN6DgsDojCerjQesLRfMApvoGkAWh8Ob/tgAPSKWCp8ngNQtadjmTdltvNvn3peFYhgQQgh+iUmEaUAUoXM1yRLmWuFLaE9Z+XIAWBhPF1pPGBpv2AU3kDTALzwmqo6qtVh9kJErAudABia38TC5wJgS2xIhAwBn3yhByL4EhzXfRXxYsDTJ4IvrNN2JFMxZcBzVo4cABbG05XGA5b2C0bhDTQNQLZBYH1AVsQSAAU+imI1obHyblnjG/kJk3U8BHz8xVUQAhnQIl5CyNgKAGp5LKSSCoAySh5Jj79vTagcxUaIBeRNe79g9gq+DXig4wGzy+PONfT7RWFA4noAkGXZVAhcBckJQgNgrLiaNb3paIDo1vHHX+oA9LQBi4DxJcOUPJUnTgU2NJUyROs8irGARxQAC+PpCtsFd40H/AEf0gMQkLgeACT41PiGoLOKqyrJq3K/Ya9mNyr5FusN/uPLPIeDa8Bc+w3rtyl4VFHaMZc3i9RWBM9jjzgAFsbTFbYLRmm/YBTeQNMAtD4cBKDXBTQGdAB2MGBo8SCLmEuS1AFVAJ3A/NhPt0PoCcA8bSDG76XI7aySg6JYuGfKwJHFgH0E5B3ueMCe/Y4L+xVHAOZ+9EHcEgQgwbeiEYx6jwTdz4qfu7EhEJqxGqruf/RnHIAEnxgwBM0aC8aUAYWNBRCmoIll4HTqO122QcZbrgMWxtMVtgvuOx6wa7/jwhtoGoDWh4MBJ16WN4lfr8AqI0TVV1O1fa9BbQzovkAy4Ed+NgCQUSxZCFWvCOaOFREXyUwZOPIA2GdA3uGOB6wPaOz+QPv5S+MA3OXiN9aclghW+d3IgupBF2pPqxcxGenDPxfSRh2ASiKKiVP2PaZScvAKoA0VDc6cOlIB2GdA3uGOB1zR77iwX/F6AFB9ONSOQW0frA50sILVcckWJyIDSgwPAVcJgFbYuZ3FJvAlEHbJ3IsgJLGedeBIA+AAAXmHOx6wo99xYb/i9QKg2iAIfDJEJHqj4SExbEty0gkdhB/6P9oZbBZIGiKYVb9GKaN50lRHBLOvhDxh/5EKwDUG5B3ueMB2QGM/grb7/6wHAPNGMAY+GSGUjC52VX2f2CD4+HO0gqkZfegXKgBaHkcWtS0AWii9xG1ImrLlN5XR8L8fmQD05BVrmEENmpYSP9QX+KHiqj2/82+HqqDWwnbBRfGATdzAegGwru2DpRq7Mzq2fpAf0Nq0Rl2wBXzglZ4yUAPAmDSVWDBPHQjLcgTqOZ6zUvdKHh4ruDCerox/Dnu7YqwXAC1NI/QcEQuK6WK/kdgCTGC0PYAP/KIDMBgglq+hIkrOfsaCviLSofcJgJ5AdM7kkSaCj/HqQKVIGvD4swF8bcBjmzjsaQ2H5D/6acBd9wALB4DFWWB5AVherMp4GKIYEOp7+26UF0aSfT/xYuDG7wDjrIpAERytXf2vajj7ueryQXSFl10K/ON3gIWDwCLvjfGB8Z54O+Ee4ve6513uB2R1yzsqC+twbC8HcNVhfAeaBuDP/TvwtS3A/ePAIfYFVlPq2HHTuyulZCTlhbjhETF5yxTQGgPGhoHhIWC4VSXGD3n0tLkMHXHxu+YyB+MlPwDuZs5K6FlsbCzdVO9DuKfkHM8AEkP7B8fOkwDcD+B7np42+JkGOvKdAL4E4K8P0zvQdET0b14D3DgB3D0B7B8HZka9WzrD88N6sFm+YcUjrn7E1ZDvMtF9DBgeAYaHgSGB0PNHCD4BLwLRsByAyX/ij0/dDUxuqlIG5hix7eFhvLcOVUAtyPSydAFmOQNe6EYGV/9ZESiKgIEgtbaD/gHALQC4ovY5r5KwtjOU/XfTAHzzLuCmIeDuMWDvKHBwpMoN0WQzNtAaYSs0K4ZlOSAjGG9kPjCBRwZ0ABKEBJexYAZEAU3A7Oi1BeDym4EDnjQ1TwCGWMW8MXcKks0YOyZNlQOQjcgYIUHllEzYQ0ktm+r6oz8G4F4AXwXwRd8/kO9A0wB8y65KmPxgGJgcqYJTKYpTv2CCzyddQJRDOjKivn+Deh8BF8BnwBtaCUA+YYEyAU8h+c6Az9gNHHRmrgOgmDA3jHQ+iWupCeUAvNSrA9HNwqx+muk9nJVNg/CTfrmbAPwbgK8D+PcHkIibjob5o13A3XypWsAkG1cPA9PDFQDZM1id0i1KxsWfOrKnAFXlifCFFMMRcASigOcs2MGAIfE9iWXplS6On7UbmPaUUTXQrgsVMzcRj5Folg2V5ayUA5BWYKwOxKUafnosWjcJwk+7W5F2EKvlE3xcXaNYfiCYsGkA/smuqug6hcleAnAImPbO6YwRpMgjCAVAm/yQmKTv5hNsAf/i7SyNBSl2a8Qv/4/M1yF+BZSYlNQCnnVrpbC+mToAACAASURBVJcaI7sOSEY2NpaDXLqpR+vE/OVksDgImgGgghHoYJbTWc7oJtFWc65/cg2AYvh2ALsB3AzgVv95nS/f4QdsIkT9T3cBrGtITWZfC5hqtQHInsEGQn3UDDvEDEY/ICf7SxMOrAg8T+c00JGkvHGd2DABUYZIAONzCUDppCFhSukCBsLQrFtZe/IixYQpSyEoJoqnuPWrVRAubQh83HNlZB23z7j1ywmj6CIIqUPxw2Xeu9bx2jx10wz4Z7sqTYZaDD8EIDuoE3hMVEphWg66JIp90k0sBxBcy+iPIIaT1RtEsHS/yIAqw+VSNPWQfe5tlVEk8auXgVa5BUsEJuT5uoliAbE5AGotmIAjCPnR9xDG3TQernYAUupTdBGEFMf83OkApHG+XlvTAPwfuyrgSZOhas3u6cwTsUBVn2gTwyFMi8wjHZAA1M9fYGHDULJD1m8Cpa8fRxDad+l+Ykf/3XNvd11U+qiL39SxXevSsshdDFvgbI1O2AwAtRZMZzTBRuDFjxe1Xg8QEIB8yyj5yYIUxfQIkfkIRnmHCM712JoG4FsdgHHp3ACoMH2G6jM4lWzoQarSvwQ6MSB/vporVaFkh+mCLlpVR8Z+dqDZLoDOpHSiQeAFDkBjPrlgCHgCUaFifg67H/9uYjn4Ai1vpTERTAASBaoQJBAKeNqHlL6mwPDZYAOROag/EYRkPX34MwHIvzW9rQcA+TLpI22G7EcQKlJGsYIJhC6ClUMiXfBTbFUQAej6nPS/OuAl9pOOqIc2BLzg++3VmWgIEUz82cRuCAtLIHQQm0gO52uOAb22sC3JEWgRfPpZf2sQBQIgLydPEIFGwPEj8MlF2bSbsulghLftqsCXq9HGgHysznrGgi5qzTUTFH8FLhAUn3hIJwCN0HLncw37qaF2zoYvuKNivmQIuUNc7GvWt6sHNs26twA6vhyq8NEMAHlyntFrDCcQehyaPTl+FwAbXDcmAKMRThakEk8Q8kPg8SPL0qzLBl+A9QCgR6uZGs3vfHz8TtBZvkgGQrEPBVAUg2Sij50QAOjiVKI3saADJRm7dSLYWfSFDkCem/dhZeMy9pPY5QvSDYQyUJoDIK8qMezh3wY6fSL49PcGgCAA8pScJLIgAUYQEmz8RPA17StvGoBv39W24eREiBoNQSgWNI1HBkdgxJSw1AI+dFIbgOYmkjimQ1r6XXC3rAbCHycAgytohf8vsB/r2KRaRq7zpZ+D37HMX0s3DDcCUGLYaw53MJ4YUODzusqlGCQAOQCejuxA8UULUkxIwAmMAp8Wa3qkN/R9W+sBwOhIEPjk5SLr8HeKFbTQfb77csPIMHGl/4MPbReslPhNe4+MiTpi9AFGV4nI7MfvagNQLh/pfrYnDAS8aJQ42A2w4em2cAyWQUuJVQTGWLs1uL7DG9J1RjhA+jvYk4t3KXeMqijpzrud4At9z3XtP16yGfjKZmCGooYh1tZzvv8xXPFl4PoJYC97k9FlwZWD+Azi/deMZWeP13eQCGEyoERudChIjbb3mJYwH7V0QIKuCwj/gfMj0asn2I0FXRSHXfL/iRkNgLyeVj8ccMY//J1fyxzTAXT2+xoQViKYD/1hDqLxPiYxTgSvQrphphG97tz4Slqafnj7uk1kIQDZrvWTw8B3jwEW+RLxPgSiCERdPwPR7+wCPg/gulFgfruDkOMQkFc5x84e708JAMmCuRNBXi4TIg5CGRzGiBGE/D4E/C2r2vcAYJoify62i0aJSMhB+2IHoNwu0fkcjQ85pu3ack5nIBREqneYFyWLkAXIJHESe00Cyx5QyeL6F/tyEcDcrOW2n7fX8df0mME+/vQ/PQjhoy3gzo3AISYf80MQaQx1peH9wb7v2mrtmCBkIMMejp3jIJD1MsaxaMZ8v5N/67INAsB3BAYU4JL4DSo1J15AFPAEwuQHZJzkKfUAtOHLJSOQRWndBYQvCQA01cfnNopfsaCJaD2baBn79QjSTiOEP1EcawIpkq2kegBTNgHWEpOKF8Uwq2NRFPM4AqCf46/rA2U9/uVDvurB01zvAJpiiwOl3fEeciCGF+Ij11f+QkbSfMPfIzqw57mEFZ9Dl3Ps5HXWAYByHJAJKV7N+s0cCQQhwSlfm4lGZ0KB8C/rABgZUS6ZHITBSEhCowUYAAksF7cStWREyxRwtuPpOlgw+5s9sq6OaIJIIlUgEhA1edoTgHxa9HVw5jibZNF+j/9yGQA/7pbujZ4bwv2+cWB6tFo0NzYnkxFA+cvEAo43VBoEo2e+48EMXEOmD9F6xhCE8RwZEJ80VblKvDlmzwicfqy93/o+8K8TwB2jVSgW138FrJQTXBNlnJgmrjZwanow9CBP/rL9wF0jwAGWDtFyoN9PHutnIHT05mPXz93dMGQAPniJsjiBXiTbxDZFMF9NLUPQxKR5qezz1Y6/YZDH0D6GkdAkYJIvRalAdHAMmPZoYhb6NhDWvEyf/ma737CXN7R1ZC7hUbPgcFgqt/ZZjADnM1xqEVhYBpb4CUk5UsL7jQvj///5buDrLeCOEeD+YQchYwG9VIfyg1NaZszFiCH6DkRGLze5/dgk8IMWcMCjdCiCzR8od1B8OTwvJM8JEShFut1fzMhi+eRJr6LI7hYP2M/xVLwKNoZjUTwRMAQQmYyhWGQxsSADOflZ4kukj7PhZ75bETjBpkAGahMkcrGgwhsXeCyBHBj1wmOBQwvAwqKzoFeRV8ZaerjKYAuirmPY/o9X7q5Cyr7fAvYMAftCPGAEoYlBiVtFwLjtp2U4irj7yOANbi+crHyrfCbTquJV44O0F1FrwQGIMZFqdQDyP/gGSZ8TC0ZRRsOlVzzgasd/u+zpMByLehAfCgMQCDyGZJHFCCgLZ2f8mgI5qauEcVx9e5vACTgCTwEMWr5TdIpWKJb5MvrnoocDswvAPAG4VLGg6UKeqmi4iuDz4er30oX0FP7u5moMvIf7W8B+jwlUNAzFnlZCIhvGFRCeWzrgXSSIBreXTFZSgVLHAp4UHOFuociEEsn2PJwl/XEk0dzfSojeerFg1IOo5BKAveIBex1P67lgUzgWQaJwLAKRH04i14ItgDKEtGsRnWx49b2Vkk9wUefTGrKCF7R0JxZMqxN8cmPAxWcAcxGABKEAKPA5u9lEaAbCmKMI+sDN1X3z+ro24wEZFc0VEE64ABgT180PF9ZdBcDb6JpqcPtPk+1ACbmKjJnllwyuILunEAWjZHkBsrsRUnfD0qEiC5IJfyisgMhzWhcP2O14Ro4WbASgAMQJ48SJwchmBCDFa8qpyBbSP7OvU4PQ0p2W7+LSnSJUFOrI4V7w5IoBTQQTfJ6oTSYk2mQcpGRyH2syGjIF6EM3V/fM++C1CfwUExhCsmzCaQT43lZC3e1hBpEHh36XEqrB7Scmq5dV0XZxmV8WuDFzAF9iwhow9seAGoBcGtKjqAc+1l9rLb/1igesO55ysmCrC8ei6IxRMAKTWNBi6Xw98xNTFUi0jEcmpYgRAPhddpVi9OIEPP5cYD4CcLkCooHPwaW9kV+iwWrQHT8uA1fd3F7DFvgUHUP2k8jTiogAqLoxFpDgbMj9jXSuN7i9dLIdaxzBp5XVBMIMgFEnFAPKT9qPd6A9BIGI7MfPmf4U+40HzI8nWgq2PBxL4FEkjKJixGRRFyQQPzzd1iAUzCAQas1YOmAEoFjwkecDC/PAwhKw6CxIkCXwOdVJLxTobMjBdyIgfvimNvNJ7Evf4jWtdnRYD1YNGVuG93VWuWs4Jf+mlZCCZxwP/cnJ6mXVKk2+tK8lQQVHRTGc64SDAZB3Ey3JcxyACkToJx4wHl+YwqloGDICmYmTFgMQFBET8yyYzyAG/AfWX8mCGQg0BTRoHwt9KVaPE/HQ890AIfgWK+CRAaMRYnVdxHbhdY8Wslw1V93UDsmPIj9GxgiAioRRMIJNvoti+SW/Ikd0gwAU8+XxJcbGITJPDvI6XdCFREFSknTB83xka40H1PGF9dnycCxFwygkK0bASJQSVAbAYeD98xUAe5U3jKIwBosSgNsuABYogl3/IwgFPrOIg1Xc4ZrpAsSrvruykl2ucykapkMMh4CExD5DwJfWAYAxwk4MKPAJgOIjGSEGwuCakRhemw6Yv0UUwRf7L00L9pnsNx6Qx4feY4O8pDEcixOjsoTKKpMYjSFYYjOC8Eq3Wnnr0YYS+0Tmi2HysrPGLqwASNYzBnT2Mz2QD91laxLB0gs12GAh81cf/o/OcHyJ+qj0S/zxnhUZbSyYWaL8+Rq2S29wowiWkJPan4MvgrDDGAlRe7KIywDIgR3meEDWg9HbJgApNTkXo8o0i7oVgxnEgFr8F7jEdnU5GvqfJQKQKyEOPlsNIQvyvupAGHS/Okv4qv9oh+PHxMLk8ggBCRxvAmEN+AiEzz2iQfQBeNmkh4K52hJBKOaNe/FSLobLRXCz43rQnu2yi9oMSMDxs2jo8303ERz1wsCGZECF4kd3DwEYYwJjhoNlQrgIjlYodbBPrwMAZfEmyzcIv27gs6XDzC/IR1DOgA9a6DRz4wZAsZ+LYXvQYsHoD4ziOFklna6YD3+nnU6dZ7bGDAcBUImIAmEUw/zbJ1i/scGNDJiLXmle3RhQ+l/aq57gUQCWzwwBKPeLsZ/LFrGg/ShRXAe64Ajkv30kALAjF8R11Dy3K7KRwJcsUTaqWScARou3w/INVnCH+A36n8RvM3nB5XP4oD6DATBYwGb5ajlOLOh6X8JaBKRG77+7ygGYp1bn+V25/01AzBnwQ1ypanD7KWfA1QDYC3zJIj7KgOUzc9nFbetX/r+O5biwNhyX5uSEDr5o0xsJwLp8/m4A7GaJUv/j3/5+HQFYJ3oFPPkho/hNeqBcMkcB2BAA6XrxmMBkfFAci/m0JpwzXw0TXvXtzrz+PKc/Ml/ugzM9MDqCAbz/keVjjGcQA/YLvjoguo1mRslRI6RwfsiA5nqhL5D6nscF8gfTdfxpS+/hLzvWfzMQCoB1Fq/8b3VWaPIDZqsRV64DALsZHVHs1gEvsqFAeBSApQC8pHK90Oql4UEAyvCwNeGcBXNLOPMLftgZsI75ouUr9ousp2TEyIJ/sU4AzC1e+WIFshyAHPZREVwItrrD3wGAhibTYBhxVpe/xePyrNBuWaoNp3DgFwC81O+RAepK/a5Lfe51jxr7JwA83nPXYgq1asl0yX5N48+f4VEGLATlK1vAo5YB1gBSRmsM+NFE57lcfPD5pPFWCJImtyvGgGfOAacBYO59zFglgHgPefZsXV6/gPXBYeC0RVgyJNOGYuJjPka9eHWgjL9bWzhWk0/n/wPn+k8bgFNmgYcsVflZnBRmIShtJM/m7JGibGBoOIIez9wKPP4AcNpylfbNlGfdI+9NjBjz8JVzppckZuJ+dBw4aQ44drk6j1LIY9JkPD7P4s2lwVEGLHwJnncscNIh4Nh5YMsSsHm5ndOu1BGFThJ8/K6JrZtoslST2+XHA6ftB05ZAE5crgAups5TfaL6EF+UyIif3gAcOwtsXep82eIYY9JkXpMgMp/AeZQBC2b8OduBYw8C2+aALQvARgJwGZhY7swEzbNa88IRvAVO1qkF91J36DNOBE7eD2yfB45fqphLnevzdGeBKBfL8UX5/CZgyyyweRHYsFwxYHzRNK6oetSBMDLjUQAWTPqPngpsnQK2zgKbCMAlYMMSME4ALrcnR6JYQIwsoUnjpDRstOLy7cBJB4CHUGwuAtuW2nUDVH1EFUhycSwWjGD64mZg0xywcaECoI0z5P3X5P6nWlHdgHgUgAUAfOYOYMtBYNMssHEe2LgITBCADkIzSJZXpCOnIg25uPrhgnupO/TyhwLHHwSOmwW2LVSik2pCrDsQskzNIBGIpBdGI+VfNgMb5oENCxX4yPRjPj4xaJ0+WGeEHRXBDUz2Mx4FbDoIbJypADixUAFwzAFI8KUJChMV2SUaAGc1cE/xFJef3FYRti64nkqWDrqqEhbrsm5zvZCdPCd8nHzJOLZuABRz9hTHZwPL7LnLnoNMIY2VyaKcjtZLHOAbNgNPngKe4BacfGF1pnydD+hphQ/8XV5UiEueLGnDN1tWXj/3/4cTwAUzwGPcRcFJiDpPt3FLmf5vjwE2HAQ2zPrEzDv7OQg5OSM+ScYQy5Xbo8465u/ZfLTJ7fKHAdumKxVh8wKwealSE6inEoSy2MWCdbUHIghv3AqMzwHji9VLZuDzD8cXxxWZs5c7apmW0fMBnIHKn5X7d6I5npvRz94O7LgXuGIReJSb+Xl1tzqflybwRwqf9i97BQRWomWJQ7oZVFtJoqDX/b/oGODsvcBTATB9gsfGqmzdjtVz+G+PAyamgYmZCoDjFE2anCVg1CeJwOMnTRB/DmUINVkkgia3y08BtkwDW+YqAFJFMD1VAAw6XG61R31O9/fdrcDYPDDmY0zjc1UjivBuAMx1QdMB+WAYXU8dhEU16dOSkppbcHFSrng8MHwnsGMPcN5ypURHp2xMIa7zDz2z8Gn/kVe0YomO0wEwBYKujL7v/zHA6C3AxfOVh58g5AsZxx4fZM7sf3h6BcDxWWeGBZ+cMEFiwGEHHRnDzun7ONHs/djkRgBunql0VDOSHIDU3cxSD4aEajhFXS4H4S1bgVGN0V8we7E0Fh9jVDG6Obr1LJMRwn+kOCaTEYT0dsfqZHXl/p7PrLi9wIY7gO0H2yAgCAWCWCowKrYE8nMLn/a7PQn9X7zIJPPkCcK+758y7x7guNsB6l98gZjLLYet3Ay5n0sv4R+fCYxPA2MOwLEAQLIDPyP8uBg2cRYmzFweAYilKkn+OC8/Fdh0CNhEA4nGA40kd6FES13WLO8v1qHKAfh9B+DoYjU2Ak/js/8NAIwg7OUb7LCC+WAfB4CpBJoIiTRNRmS1l13kqWh3Adv2A8cdqqp1MB+aIOSxWv6pq5D2kkIAvt8rF7BLJksN/jMqfa7v+7/Ak4B3A6ceqpasKMq5akAmlLWY37t8ZW97PDB2qALg2BxgAFwANEGcnI5JcrDZRPlkaXL4u1KJUAfAjbTQ59x6dSvdLPXAgGYshZWR6JIRaXB/NwFI8C1WwLMXzMeSwLfcXuKrA2G+wrLCDcN/IIg4ERRn0qvyySAQX6mG1XuA4fuAbTOVwktRRr2MLCoQyvEZ/UY/WwjAj3jtFJZkU79g1ghkgEBf98+0Umb/3A2M3lkBl/fOcdMok2EjkZyv8773LAfgHDDKjwNwxEUw9yailpwdxBAEYhBbAuGzG3aKkQEJwAkCkOCjlb7Y6SYyf2UwlAS+vKYnAXjfNmDEX7DEfA5CjUcsnzvbu1nDtUMmCDkRZEEyGdlAk6G6lQTSa6m0MP6HuY73AxNTlcJLZ6WOJYC5/CNxLpHMgdKIKNl69Qvu6/75AjHOiTU87gKOOViJb748BKCWrnK/maTA+58AjM0Ao7PA6Lx/xBAupoYDC9okBRAmPdBZ47lNA/DhwMRsxX7mPgl+SrmK5EaRNRslXFQ9CKB9DkADn79cZtkHFkysJ103eBbqlh97DpmTQTYgk9VNxu+xYbXKU3lhFoJPOgdFGY+lPkgQxokkgF9Xgj4AvfoFs84eX4Ke9x9fIC+tRfDxvvniif358sSir2LCj5wNjBKAc8CIi2AxxLCzIAGY9L7AhGIKgpATw4l8wToB0JjPrfTkp+SLQbHrOqm5jNyajS6VCMIpApDAWwQ4LrGgXqzIfnq5cv0vN0ZXHTInME5GBNLb1DGdOYQsI7AfGKFjlgqve8wJwG4T+fuFAFytXzCLb+VgWnH/fIGYfc46Hs7iHC8ZkPcdXx4VfVXJw8+cA4wIgM6AHSLKWZCTESfLfg7WsIyRF3ckiRQ+HACXkwHptyP4KHrpJvKVGnOhRF9eBF9wE0mUEogz2wC+WGI/vVxiQQIxAs9+rmHA6E1YFYB8DJwQMZl0OrLZ++i7sfT8zroYHLS9df4RACWKxSZvLXzG/fQLZqk2gqn2/vUCUQ9UZaM9wDaPeSPrC4A5C1KV+NITKwCS/SiCR/jRBDlLmP7nHynsxno1IPwJSyRpbiMADXzuPDYfZfBTEoAmcuVQdiaW0zwXwQsCYDYmMaDA1wG8TBSvaoR0G77EcGSET6hjOvVApfRPAUN0zjr45JzVcSqiTxD+VeGzXku/4Nr7JwDJOkxFIwt6j6+RqUrlkO4bXzp1gCAAv04AzgLDDsBhKugLFUvQUhTwCEKbnKCw14HwJ9cDgGQ9WegRgDI8XEcVEDvAl7lVlglAgi+I4CR+Zf1mLGgMmDFhBGFfDCicRJFERviSABjLS7FC0MFKMU+07wOPE0kGvaoQgGvtF9z1/iODkwn3VWoEXxres5ib9xx1wZufBAwLgAQexbAD0JiQwJOuJBA68/H3Zhk6+3CifqqwWNMKN8wjKgbk6gWJgC+FMaBb5vJVmsUbV2vCqo3cRWZcCIACoax53+ulkqNd7iqOcU1WcC9cxEm5kQBUdZ+sTnSL/jEtTWngi21jhJNJBivZBukXvOL+yYBkcOqxKjJ4AGgxzMrBVwdAMmHrZOAYF2l6y/mwV6xD17zmWo6MbRyeWtOHwxJ91IIhr6rqZS70DPPLXDVUrfBwzHKr1EUp6/h0T/6L/GcCqslt4IhoTcwdAqDSs7I60WQH6R329pHuFyuXDJmEjuOSbdB+wSvuP5bGUjmsA5XoUvcvBXKKAQnApUdXwah0b8jXR2YzJTsC0ZHB33FL+2yiX3h/1YeD1fFZGT81g/H6yqkVa9YEpqMhTADle8erHA6t7Mh6j4ZBXdBGjFyO4CSIm9wGBiBvgqxwIAJQlXIyEJLyI/i0SkAG/FbhaEr6BXfcv+5dLKhCg4z1C1HEBJ8+BODQGZXfk/quAZC6ketAZEQCTWAU8PIJt0fgwHzZvVWNaKqi7JLOmtDWFy42g1FxH/XfqGkII0C+a0tnDkfsGxQjn3VPsk7tXmuy+Xp0JhtoJosAaFcUAJUYKiYJxcqHqKAH9rPlG2cMrmCUbMX9guMLpGTcCMKDlZGhMK8IPnPIn1X5PA2AwegwEEYmDGBMjOI5whGQP3NPBT7VJlRNaKvF4t2IWHbDErtDlSk1p4lJ7/zd246tglGZryIfrFhQ7pU8WCAX0ZENG+57U14Z4YrCeLrSxXdev6TfLwrbxT7znMrfKQXfHLQCnyvmRIv0Q3430ezMmL98P393G3wqz6am1NYzzoGn+svqRmTAU2citctqAX/2EI8F9ACEmLHXLZGoFxtSl2xyK2bAYwrj6Xr12+1noL/jUTCD9vvFrn6u0v1/nvGkaoVBAQi0eummMAuXQHMWJAA7gCixG8U0gFfcXdlBKk4Z6zELgAJfZEKrxpC1xOIl/+Sk7jkcdYlSco90y9+gK6vJrRiADD0piad7RuFo3udNCgft94vCdrGXn+tujgV3QAcHLcFnroelivHkchEL8ue0uQ74S3eubAITS3IQhKkMRjBMokgWG3L//2z3VSnP4VDgQWxUEEUxAZFHL0eR3HDfm3IRbDHkBfF0zy4EIKNhSvr9goGEBdvTz/MIYQLQdVsTwRTFDj5jQmdArRDYJQNDSs961R3tPhx5NXoVgoxleHnarjohgLec3D2HI492yQNvIwvqO9fJm9zKGbAwnu6FhaP5pFuMg/b7tTbpBdvTz68cz/zI8azVj8iAHTqgmFHXDUB89R2dtaC7tUGw4kDOgFb0R2wYRDGZ8g9O8aU4XwPOczhiwGlMjqqLWiFYGu570wADFsbTvaxg8nkow7E8nM/atfKzln6/1mS4YHv6BQ4+Z0BbqHcd0NwwYbVD3+1yWhXJxPBrbq8AqE/XApSqAxiBV2MZ/54DMOZwKE00rnDUWcR5KiV/brjtSAMALIyn+/mCyeehjIYp6fdrvVELth8RAClyHXxmhPi6r1m8FM0ucgk8+y4RHC1kAK/5XgW+2hZYofafWcPq1B5AqDqEYsQ3nepR2gqhV2yiol1COkD0C+aOaoGx4aL7DQCwMJ7uVwomn4fm7VrX2u/XAlELth+5sHPtN+l/Ap6sX2dCsZ/phZkIJgv9l++1wbcq+2WFv2NXIjNKAPzuw7MUAV8DTuynFIEsQy83RgTAhiv+NgBABaQOGE/3mwWTLwAqHnaQfr9GnwUbARgDNBUlkpzQboyYCyYDYdILdf0l4NduW9kGoa4geNdazLElKoA3Prx7DofiETtC6XvE7hGEzJlpcis3Qgrj6d5UOJoYDcMglrX2+y0NPtl5UZUjkfx/Hqbecoe0OZzdF1gHQrln9Bhee4s3f3Zxm4MvAk9VSFdUIw0i+Q2PaBtISiBSSFgCYMjMW00MP7pwvvLDmwFgQTzdHxcOSGvBg/b7ZRZByWYAlOERluKM3Ra9CKWc0q73dTBhMFT4ZwIw9l5Lrpes+HjeBiGCUOKXeuBvPcKTiEIOR0f+RhDBMYi0Lhea4GTaa5NbOQAVDzhgPB1La5RssV3rIP1+7yy5OAADoAchEHBkFbKfGRpiweAPtMs5IFNokyOGk/7rAYC9OhBFwNXVY1at5tftCBHaWVS2AJdEcEinrDNC+Lumiyc1B8AB4+muLARAXTDCWvr93lR4/Z0Xt6ODFQkj8WtumEwHTKDLQejAfN3uds/dfjoQdatGLxb8jQBAYz6/boxiFgAVudzNIc2/s3xLk1szAORoB4yn+2DhaATAGJCtbpkCYq9+v4V+aBgAQ4i66XtaC85YkDog/zdZvzUgfN1N7a633Xqv6fe9msDIHfNaB6Ay2JRE1AHAEDIfI5nzZCLeN4Nbm9yaA+CA8XSsul6yqV0rJ2WQfr+splCyCYBR/HJyKX4phs0PKBZ0lqOYTpvniAiUAmAd+HKjo1cvDjHgr+3wPJQsVCymUZrPMuRsRBDG4AQCsunyJtFGHwAAIABJREFUcc0BUJlxQoH62q8ST8cggpKNAFRGwCD9fkuvbwAkyGgJE3C+Nz1P1q9/T3F1EZBxvZh50s6AEYC5yyUHXt5/Q8zI5/KrAmAIkkipkyGPYwXz1aRT8v5ZO6jJrRyAvKOvNXlLazsXs9bo/ztc29Pohgotp5J49Rcj/pzfIwGS//3OM4CNd1dpntQpFUmjEH4LYIgnyn/OLjL8FeDGhwJbNgFjI8DIEDA8BAy1PFK7FSKf43cNKrvHx+8C/vmxwMgmYHgEaA35J0StpvvzL/nP8RbLAfhyT207TChgDRiu/ZL9DsfWNABvYzbhCDBKoBAk/pEobGWTqp819hzQ1/0k0PoaMDEJbJjxVZFgDad0SaUO5LksWVj+XScDmw5UEUDJ6U4d0nVbC91S3ovfVHp5al64cgC+k7mZAP768KCA0WD3A/ieLz090CDceVmlAuhBljLgrfcAw6PAyDAwPFwBkCAbItM4a/FiNtERjBl76W9ffD2AbwJDdwFj+6syImRXrd5Y2FjIYcnzWPLEqnsfC0zsr6qBMQmfIDR/pyJ6xMhKyMrSDiKD2xja6TADTt0/AGAs1KcAUCFrOLF6tbtiRVFavT/wuMCa7MfVTlH098YBeBcwNAIMEYAUlS4uBULOmK3LCnwOPANlEIOSoF9+C4DvVoWXhvdWZVOYqWgi3vOXDUQhgieB0EElViMYJ08HxqeqnG8D4IIDkAzo51DKQQJvBKUmKACzbM4+5hUivwrgiwC4LzvjmgCh6nBcgiMTcv9Abo0D8E6g5eCjfpUA6AxoQIzgi8ALmWwC4z//DxcPPwBak8DQFDB8yJPpPZHeGCyC0KN5DFCByfh9/+OAsekKgEzCTwD047X0SCPM1IYQjCv2E/MJoGVwUUQoPboq0MdqkWVn7RtDDMahB4g+P6qhXFpjVtkDtRGA2nKjos7IyOyHFUbIrXe0FXsTuzIYfNb4O2M3ATGIYQOmPn6hG6gi3eUkQQAeAIYOAUOzALMVh2pAlESqGFBAXAYOMQVjxll03iO/yYKRAT0FQXkwZkjp1pz51LO2XAT3KtD3AIAwj4Wg05kfiuUHYlsXAJLVnP0INLM0OYFx78AzcRySeTsw2AJueI+Dj2Fne4EWKz5MA0MzDkCCkAByUWqsJzarEanzj2zXwjEGFHuGY+pYsMojzZL1G9EBexXou339IRBrC3lJGmNDuSHX+w7WC4Cm6wWxm8DngLTImgC8pBcGBuTXf/1fXnyTugnFwxTQOgi0CECyIFlsvvJfEnh0mhsYI/s5uxFYi1xZof7oOqSAawwYjRGBzYGXbtWXaCIrlvHUagX6SP/ruMVYCEbEqECXAMjfree2HgA0ESur1/0vtnNwGSsG0RsZME20/+/XWH6Mugk/yngPAGy5GDYALjiIHIgRUIrsZjM7Ax+BSx1S4pfffQVIep8dL7dMDsTGjJB+CvQxTHmdtrw4l0CovFruC2NOe975egDQsCXRK/eK634JhBK90q2C7I1i+Gt0jxF40k1cPJAB7UP2m3MGJAAFQrGei9iUTH9yBUDTHfU3B5+BOIKQ43BWtNtPcWIOzEZE8FoK9K0DCGNxLi3FqaKA9gTgeoFwPQAoI0OulWT11oEwiFz7cwbErzNxWtEYBB+VY76Vh4DWrH8IOoGQ7Ocg1CqMRLPltmxvs1/SHaP4dcAJePYyyUCRIzrTB8tE8FoL9DUMwl61kQQ87Rmy2PS2rgB0a1ci18RudEJH57OsY02y/+83/sZdBKr4FXQTApBvprGgQCg9UEAM+h9F6ugJDkC3gJPBEvRGrYoYCBX9IxEcS5K4i6cZAHIw8oXQ4mLBb35YH5d7OekadtTV1UZSjaEIPH4nQzYNwgjAHNwDuWGYpZc7lzPfX1cQur5oBorfzDf+zi0yVTuSkuxBI2Q+PhQDIUEnMLo1TBCZLufGw/ixbQa0KB8CTODjPohdY78IQmfDjmW7Yo/doAX6GqIiAtDHaYswSmeMubV81kp11L6hy2PdAcgblfslOKC1IiKRmyRxZgV/8++DS8BFrxXi5Hd/U6MeSKdqEsEKhpBRsgRMbAtuG4KU/+9ry5brzP/lPVMv1EPOQegharrVcgZUhVHFxNPcp9VFtlOWkL437C0WABWypFRGsV0sb5Hn2zYBwvUGoKl10v1knDgo0y7XA8Pfv0UACnjaK33Co9gJQAOe64FkNvtZAHQdjz9v2Nz2GSa3jYej2W3KGuZ9ixGdIVSoKT13B2s5AHkGheST6qn0erHv5AIgAAU+LVfw/wq3CEAV7clBKDDGZG9/5oVXx/oyYARczcqH5GyH8eFplTawFvAtrtXLGpNrQDGbejupB3omlIHQGc/ErzOcGSRs8zrhAbbuL1Tco/JfbLlNwHOmi2kIcs3owbdwNpYtynDQhsFcgvuG9/YapGFvYX22zZcAU0/GwA2LJ/4AmGF9mwEbBu98Y3cMF+uAGQCj2HVp3BbPuo3IlqxAy5wHAq4OfARmEBXGfNIBa0BIsG0ecwC67merHgRpZLwocrWaovuTxew/V0txJQ2DWeae3WAGbdhb2DB4+wRw7w5g8Qpv88liyGtoWHzMi4C9fAEHbBi8kwUKu2xNAdBxaGBLbJdZux1LwAGECYAEm6wyfpelJrEgFnRDxESwgyUxIUsVMwjVy5AYO0bG89Auu1/5BF38KqjBHlUAYXsteNCGwTeWNuwtk4JMkrlzGNizA1hm69g1Nix+zDOBW0aBeRZZGqBh8M4emfWNADDT+zqMjQyESdQFHfDbZECCLRgdHeCTe8CBaKJY1rDnBRCIAuGW4TYAZeFG8ZuMkGiQ1IEwGCJtHZBmy1obBsvVMnDD3jIAerti3LEBOMjGcOpa3WfD4ic9t6oveDtLfw7QMHjnH6wPAybW6yaG4+8D4HIQfvtDIVtLejpBFsVvUI7NIBHw3DUjRzL3rDVtsYPOkAScuX3coNDynT2VYJCkn+PjqvUD8hVbS8NgjphGxcANe8sAGNoVY/824BCBtIaGxRe8pLKZdpMkTvXiJ2toGHzSNHDPScAyq3er4qPyGaNc7JCRXWLT2TjwGmCOeQashq6+qSpZmp8vojQpheF58ncdZVjLnjWPHr4VWKTKxrHGUqq97qXu3jp0wPy+eEC/DYNZsZAO6IEb9pY9lNCuGPcNV830ZmkM9dmw+OKfbdcXvJMPdY0Ng0/7GnDXKcDMccBS7MwdKz8KCAKQIgY0MWGCtr4TOHAasMwOkTqf6unyuLykfd254nkb7qsw/iVg7jhgmSX31Vpd9yRHeLx+zRhjEGRbB6wDYT8NdymyubzDzCCGfpMJWfSRYfr9HP/aMgBm7YoxNQHMbQHm+ID6aFh8yS93tAvGQb7da2gYfPoXgbtPAqaPA+a3AEubgGU1RM6B060fgkRoCzj+TcD+04CFE4BldZdRc4/YxlxgjJMewSiwN1zWfsOngdljq3EmY08vm5i/7j5yIMqpvupKyGoNg9lngYosl9wY/0dZdrMzYl8Ne8sAWNOu2MA3zw/F2CoNiy99XbvftrcLriz6PhsGn3U9cM9xMODObQYWCMANwPJ49UliuW6SaqqBn/gGYP8pwPyJwNIxwDK76ahDeN6uXYCuYyABkEza4LbpY5WEWdSLxjF26/dQB0SJ6r4ByAN6NQxmkWcqrnQ00x1DEDJFjR8CcNWGvWVPp6ZdMQ6OVOCb3wAscPJ6NCy+7PerkP5Q3tBY1PrT9tEw+JwbgPu2AlNbgVkCcCOwtAFYcgAuiwWlM/XqDjMEbP9t4MB2YO54YJFMo/5gHIcALV1TRZ17FXOhPtvgtvkqf9H4kvHDlyKK4l6VzvVSBF22uwjOb7pbw+CfcwBSkyeFEHAUx/yw9JTyEbo27C17Ol3aFWNuAlgIn9QxO2tYfNlbK6MvaxeMRYquvL9rTcPgJ30TuH8LcHAzMOugX3QALo21WXBZLEHwRF1OgHS2eOgbgIPHA7PHAezNu7QFWFZ7JnXJ5rnqxHEulvlzwyVNN3+wern5Yovl7SXLGwvn4riLWO4fgMRJXcPd/+pmOymELEhRzBxJAo9gVL4kwVnbsLccgHEpWi3epocCAMeBRU5eTcPiy/6qtl0wpvhA+2gYfO7NwOQm4OBGYGaDs+5ExYDGgqP+ccAkINaVpB8GTv4d4OBxwNw2YGFrxYCmV0YxLNYheCXau7EhV3ga3Lb8g4+R45uoGLADgHWqhsBXA8K1AZADyRvuvtkBSArh+i9DsQhCOtf0UUgW/7aiYW/Z0+nRrhizoxXwFhyAi5y4rGHxU66qAFhT3rDSIVdpGHzencDejcDBDcDsBDBP1uX1CMJRwFiQIBzxieL3KIY1YW5MPOxNwLRb8gs0aghAss1GZ1O+SFHsdRPt0i/PLHu++dFb/x4mXfhcbWxhfCtYMFr/uWvKxfDaAcg7ipPCvFOVpuo3HrCjYW/ZA+rRrti6TS6MVQ+L4NPH2nx698GnXF0BsKa8Iab4dFZpGHz+JLBvApieqAA4J8CPOQuOBBAOV0CUYbIskRkAecrvAdNbXc/aDCxSpyT4CEIyTgRgneiLIp3nP6fs+a4A4N8B8/48CUC+ZGJA29fpuLmxJW+5h5kNFg2jiWHSi0r0Uv4pCoZsxw8DUfnhd4Vk0XGdGvaWPaBV2hVjdjgA0BlpkQ/K9bmn/HOVqtClvKEBqlfD4AtmgP3jDsBxB6DA7tdbcvYzJvQJkii2n4NOeMpbgJktbYPGACiF3wFoEx1ZMNe/4jnPLXu+KwD4t/5SO/iMBcXuesHylyACMBPDgzGg7opM8mEHIGdwrfGA1rC37AH10a64Yr4APvvOSdwEPOVbKxu+K2pdKRTmdI3dqkPPVgbSTBGAY8AsATjWniBdx0QxJylOFCcr6HBiw1P/CDgU3EgEIMW52M8YkLolQRddIN1AyKWiBretf9MJQN6HsaCPxe4rvgDdHOcOxDIAcmDFDXvLnk4f7Yqt63gEIB/Yoj+4p9xaAbBHeUPM8qF2aRh84QQwNQYcGgdmx4C50WqCFngNsgSvQ+Dxu4MuiawhwIAXVk1O+e/A7CZgThY1dcno1nHL2oDIyZULpBsAFTBZ9pjT0QQgn2V6ufRicS8QRgbs5ZYpEsENDejBfpoLrwAOjgIzZMBRZ0AHoUC+SOA56xJwNlEyTFw5FxBPeWvlzpnbANCdQ1eSGTRybMuydgMggVBsKmtYoC6Mt8znZxsZMLzAxoAOvsh+ydDqtXx4FIDl8L/omQ7A0QqA82S/ERdTI22mNfaTuBIIxR4BhKe+y61punQC+MytI/Zz/c9EuvyBeetLAfGZ5WOMZ9j2/gqABB1fMLsHAVBqhfTcyH5d9MByEdzs+B50Z7voGZX+NzNSsd8cwUcG5ASRKYbdHRNYwhhDIHRgGmO0gFP+HJh15jOXjnyKblVT5Cbfoq+yJOszF8P8+VnNPlICkMAzds/YLxlYznrJwIpO6egTPMqA5ZNDAB6iCCYAyYBcBqTRQ0e4630SxZyQJQIvMJ8mSeLrYe+p/GzGfnTpEIBy6US/out+K1wg+brs88rHmDOgAVCMnrEfxxMte1Mt6j7u9zzKgIXzczEBOJIB0BnCJoqgIfDEhM58SWzJEPGJe9hfVH42un/Mfxl9bgSiBySIBWnAJBDGEDAB8QWFA8wO3/a+wH4+rg4RLPYLul8tCI8CsJmJMQAOuwFC9qMI9g9Z0CxhZz65K0wfFBPqu7PEyVdWAOTHVlTcpxhXHZLz1w0ZA6EDLhkCskRf0sw4dRYC0PQ/vVSRAYPo7QCdj7GqVOSMeBSAzUzMxZcDMwLgcKX/zbv45SQlHXDIgagJc+bjZBqAWhUoH/Y+B2D0J7rFa6LYDRmzomsAaOeKqxEvbWacHQB08JkRIteSXiSBLYJOLB+X4xrzAzY7vgfd2S4RAKkDDgPzNEAIxMASSWF38WsgkuXLyXTRSRCe/DduSZMBMwe6ObTd8JBj24Aot07uDObPP9XsIzUGFPs5+JJ/M6oT4buxHv9X7BeY8KgOWDg/Z58GTC9Xq5FxTXOw9c3Cm6k5fPcjgbHbgAlvVG2tH1T3Oavoq6BlniZ+12n5u/2sDbOvasqoFg8x2Lnbcd1GdhSAhXN+7qMrAC4sA8sORJ6yHwD28z+Ft4fdv8UyqUDrDmCEBcpZ39kLS6aq9l4D2rLb/KYsFTPWdfbvh86vQu2s1K/K+zIjTsXIVQ9a59Egs4Y6sZfIA/EcSp/jEXv8BWcAhxaA+SVgSQAkGAMICcwVlNLlqTc9Gbv/HAA7MrL4+f1VlXwrUq7SvCoyGcrrWpGhuur2fNGYwM8YT67hT3s1LaZvqn5MLM0bzmHMmIFSgdFNj/mIBct63NhFZwEzDsBFgpDPeanNgATfCtGsX9TIKwNrg9tuVkhlng7TI/YArX1VkXKrEe1l2SynN1RCsFJsqnQv3UIMxhwIRjU5AGN9QUteVz3BUAvahuNgjC3HxLAND7nBp/cgONXF5wCz8xUDGgCjKPbvevlzcKUHH2ag6cnYzepYBB9Zi2FxDJdjoXJv1WDFiLJ6MKqKZUzoQFTfj2HmwTKcTpVWvcxHKm6kKgoORAEvVclPD6NdzLXpMT8IYNPcLV7yJGB2AVhYrAC4SNA5AxKM9ryDPE5fs6eeVKWGZ2M3S3MQfEyJUKV8L1ZpJXpVJ9pLilmlAxWkVJHKwIhjjD9TtVXVm1HdOy/pJiaMFRWM+bo0rWl4yM1N7oPhTJecC8wRgAttBjQWdBBGESwgSiV0Pb9DRgu0TY19N+M1mRKh8niqFx3rRDsLqjgl9yaGXT80vcL1wnE252PAZCzAHQCoiqoW3yYWFIt664fUpKaREr1NPakH6XkuOQ+YDwy4FMSwgU8GSRSz0UJx3Vx/5vFNbrs/EiLRY+v4ACITww6iJEodQKwBIyBRv9vwhKzUW6z66TUGEwhDS3ezqusAyNxnJn8xa1KRPSFts9YfFB/QDZcAm78CnDBT5U8rCqjfc3yh8Gn/hGd/MsKf1+QzYJ4891Jye13iy1cAE9cDJ+6FpYrEkidxDN3OtXR+FwBGMezoMmxJLOumAuD4J4rxJrfdH/XCoLGFVKiUbw+LAPQqWWaMMLrd6/+JycSIm85w9lOpt1j1MwAwFTiqAWEUxeYH5ENn/jInUVHeMXQ/f/jRePvCa4DhTwLHfBc4frGqqaNJzLPw6iZxV+HTplFGvZrXZT45N39+HW3TujlZv8D6fp8HRq8Dts9XIOR5YtakgBgdrrrt5Qsq8Ssd0BhQ4HMwmVitAWHAY/LbLDQNQDaTVJ8Q6W4qVB51OOqDZDPVB3TLOBepW5jmqaLbec3jGgBGMSxvvemDYkQ9GoKF1ShUCSKCqBeQrvmfVZPC1keBjXcCmw911tTJ8q5XgOLaQgA+x/OdWA2EGZ98gbjleTHdQHQN+2iwls3nK3/Zhj3VeQhovYzdxmArSwQgDRA3QiSCJUrTnjfl4KozRCSCCeYmt90EoJJbVCk/1+FiCwFZxLk4dRfLFia6x8LbYkD9v9cXtLG6+O4AYQRfrgPygVIcqyhTXcWFOJH8fh3rz7EKwnUArq8mcGwK2MCC1i7WY7Zenh56feHT/jE3yliE4TZncd636gPFCKWavGhcRx2J+cvs9MlSw0Ty3cCm+c7n0G0MExdW4BMIbTXE9UCynvyCCX+Ovm4gbByA/xisVgJPpXrzLj4EoRJjJIZrWHArS9iprK+KcefgiyB0XVKGjOmCmW9xhRVMUSyRFnNeFGEdI2q+/HFXclkp9WsAbgTG9wGj08CI64WxRk/OTDcUAvBHXSLQxcVCDMQSWbzv+1e7WVbz+k5w2tJtsbcCYV6WJY7hmAsDA7r1Sz3OgOgoM+KTOJbcjSI5yGIaNE1uuwlAAU/MF+tF5/0sIghVLdVdM2S0bSzHx2Mi+FTxXf8X925NC4BycK8QwfmgVX1LlcFiykEMcL2BndJJ7aQfijKfxLGDwAhByM7aC5U4qwPzNwufNnNuOH4VZaCPlPo2AahqFqoPVFc14ga2m+WEEL0cAz9kdPrOmMu8r1o/rTsXz7f9oswFs+jO6LAqkvC3Ggg5Fg6mwW03CUI6X12h8lyfcz3QHqr3DIl64DbqaQKc9mI87QXACD6vpJqY0EVxz2CEyCI5eMSGX2e7VtI5J4yTRyZhscrvt1nQuivOAaNLlYESwcySgiVbr37Bfd0/u31yEgg2FVaiPCeVOguqAfGov0iR0R9JABJ0bnwk9nMxw+fOh55EbgRhzozrBUA1polN9CLwok5HEEUQBjFMQB7D+j656PW+IrJ8O/bBCo4sGFdGejqiyYCx3mKe9/JtTiBvmI5OFiTisg9LtJFF7gZGDrUbHKs79+hyu5hSaUvh1foFr3r/6vZJCiXgCDwVVFJ7MVmRLsrGltuFCc68yFdACMDAflwR4QM3HPoKgIExt4gz42SuaQb8hBOE2oZmlu+KFlKR3QSssMJxDPWbbjpfLoJrxG8CYT8MKGZSVTCxYFTIb84nkCxCIPLDiby30gXFghaF4c2ReR466Uu2fvoFr3r/fKAEFxvpqMcd9yonIrkuK5LLV7MVCM+/uDJCyIC2J8a0z1iwqyESgMl15Sa33QKgmtPEBnp11mwuXgO70Ud4DHWzfgDYC3zBEOk7HlA6XKyHQzb8HgGoCSQLqsxorIy1Bxie7Wx0rFaf+wr9Xv32C+56/7HbJ5VHtRYT+GJrsehHcya57PyKAQk6+vBkBZPpjPEExlwU59awg3C24W6KBsC6tqHR+MidyVG3i3rdAnAsH2T093XT+zLr197MTA80h3SfsZP2UqpCrPQ46oF317VrpeiKXTJ9MhMLkgGdCacKG/mupV9w1/vnwyGgCDCKWzJe3lqsyzLWZWe6/kc/oKzgKH4jC7oolhdC4jiuzM0WPo+cPQ2AsX1obFCTO5Jzn566PwbReiwnfTWjI4KvDoh1juh+aT+WKSYD3i8Aql2rJk+VsVQly5kkddv2FvHT61icqO7Fr71/IkLNXOi0FQjV0046oBy6wZ922Q95ICqDEaL4XWw3COcf9Mw73DFB9AqE6wZAAS8XuzGQIDKf+oVkqxt00ttAc+YT0PJ9qRFSB8xoye5Xu1ZVeCSgCLbYLVNswoncHxoeLwCzBGjBNki/4BX3z9lXgUCyIIGmhova83cRgO5Te9yLgP3MfmsBS8xs8/U67ePQOqy9umBUruDchqo8sHSd3PMfT5ifo+ack8eFHI6QEcnT5GvdOnVdXof+ptJ+BVPWceiaRHA8Us/nkACo8mzqlqmWrbFDppT5A5UIZm7CPA2Vgm3QfsEd909kKIqB1qJAKCBG8ZstZz3xHOAAiwmpDIdng1maZQAkZzsHZ537YfQrwNyxoQ+HakrnS0h1mUA1C96TdJTmORyhC3oeqdwROi+GDhkFI6bYNrcNDEDeAkXwQizPRpmnIs3OdqZPSaRFUcbchHlgie6agq2kX7Dd/+d8lUJVXuUzk8ERmS+2vfd4uvN2VOV5rSwb0y3JhgIh9wJeN3YMQCIgR78Q+nDEVYBYZUrUpbXFnM7COSdf7N4IPvtDnT2BY/h8Chh10MXQeYGS+7GGjaQiABpuNIFiECnzdWJMIUHcazLptC7YivsF8/7FgLFMqpiQL5TuNbKfA/DC46rqqAbAwIKWK+timRUBEiNGsOQsyQm+Gpjd4n046hbT84KPuYjOmHHyp92gcgDS2OoIuVIeh/xyUkaVwyEWdLrewHE3uBUDcKIwnq40HpDXL+n3CzbaKdguel5VnFJl2awaghLQBTzteZ0cjLq2A2n0M6EPh2pC57Wg41poLzZsAZNso0Hw6eVR/J8bF9YjWGmVCpGKwQLBRCcrbiSxNLgVAxCF8XSl8YDHHFPW7xeFBRwv/rGqOKUBkODzqgdWPYAM53vTASMQu4Bx9J+69OHIF+N71F1O1gUB+AsBfFqKC+4Wi4BWX+CYgOTAU36wdMVNVKka3MoBWBhPxyiuko3xkSX9fvGMkqsDlzzHC1N6SQ4DoINOe7KelWWTheziObeKCdARApD1AdVnRH048gKUAmAEYi6Oh4DJV4VoGDWqjq4XLbO5o1jBoimEPhPJmwu9FvnTLgdgYTwd2wyXbMyRKen3i2eXXB245FlVYUpVxUpGiLtmGBlrTEhVUwV8dEkVKAq3MHJ1uzRbRx+OOgDWFX6MsXJU/36lJoEoA2AKvw8+uwTEDIBbStdOs8ddDsDCeDom7ZdszBIs6fcL9ror2C75US9IxJJsEsHdGFBil4yYuUwknofJgF4XcEUfjrz+X7fKo4EJJ//PkMORO6FrVjQMeL5kJhZMMXzLwNZCt1nzDFgYT8cQwpLt4hDON0i/X7ys5OrAJVe0S/ISgFY7j9ZvnQ7I3+lyqpYaL98CWp/N+nDkZdhi6bW8An1kP3fRTLKVWlwF6RZCH2L4zDDR0k1IqeTNb2OQSYNbOQMWxtMxeqtkY6I+ny9VEz6btfb7xc+XXB249AoXv85+tIBVgJJ6n4lf6oV+mfjdDJNMH0wAVFX90GMk1f5TxlS3Fggh92DyN0IORy5665KIfCktsl+K3VsGtpVOWOMiuDCerlSnjQ2rB+n3C+pIBdulz8wqonrNPLKgwKaC5B3s53qhXVq6oDNg6sOhqvqhEr3V2VNLBjmnSSNdrOLJ1zkAu6VPRjFcFz4fXDJ8i45hG94Gt3IGjOFYA8TTlQZ/qGH1oP1+8ZtlT1MAtHK8mQg25zOZUSCLIliWcbw8wfW5Ln04ssqnHX04euiCk6/3de66MPpuAQVZAEFkw2MKFw6a1wEL4+lSBvmAOMhD8vkOkFX77feLNw14YT/ssmc4A6oOdHBEkwXlgjH2k4Nal6wB4fIuX9LzZjAmorNeHMo5Tc0OewHwDTUh9HXxfGJsYkAbAAAgAElEQVS/uvCpoAcew6zBBrdyBlQwwoDxdLZWXLDFkHyF8xGE/fb7xR8XXByAAVC1oB18HQYIT+8uGfP75SCUs1o64he8v4j6cIQ+IqkPhxrBCHjdjBH6AblQkAeY1ondukSiELmsUPpjbyp7XuvDgAXxdNZVvWCLIfmKg6Bbhrjup98v3lVwcQLw8gqA5v9zC9jErutltg8gMxDWWMBaMVkmANWFyEV6R0uH2I1IzW7ypbkQOTP5f2ch9KsFkwp0kQlDAOmxzHpscGuGAQvi6VD4RgmAg/b7xZVlT5MATNXwqQc6KGwf2U2uGV2uzg3D4ua7fDnPwZcKgIdq9GaIBPZb0YdD7hgyIFWMXiH0eQ5vXS5HcMkc++9lz2t9GLAgns7KxxZsCkgdtN8vWD+vYDMAUpcja7lOR9eLVcIP4tcuob/3AOHCdW02VTX62ApB4Mv1v24gnPy9HiH03fJ366KYHYTHsgBBg1s5AxbG0+HLZaOp65i+ln6/YM5EwdYBwGj1cmUkE7+8THLNdAHhwrUOXtcrO/pwhF4cct2oN68BMDCfmsJM/n6PEPoYPp8bH3kCkbtjji2tJJA962YAWBBPZ0WBCrbYsFoOf9pDAiENk179fkuvf9nTXewKcBSjsn7ldonWbgQpx+26otaLIwAlfi2QQSJY3Yjy5i9dmsFM/oEDMM/Z7Uf0RiYUA7J+ToNbOQC3e0WBBm9qLad6HICG1ZK1XB5PoxnuOOIcxSXe/Of8xHV/P+FpwN47gKUpYHmuSve0pKZgCKSq5wqniWE1WZz/xouBm74KTMwBI17lVBXwtWSs+8/vL45Ff3vhpcAnvwos8d48DZX3M2hx9XIAnu0IIO0chu35AOgLL0yuG/jOmwbg028G/mNz1YWdETbm4I5BrFlov+EtD2wIo7l+Atg8D2xY7iw3V5diEqO54mnj6XdMAYcU+6gon7A3NSO2qFjlyZYDkAX6uD5Iam44YaUfVNDNxaJcLIPXcGGpfi6PnZdVD1wPspQBX/wl4OaNwN6Jqg+xwrxslcVFuYJblehkcYYZGPS3L20BxueBcS8nwg5H5kZkx6TQSbXFZcCQKadx5Cz5mPurAFxrRaa17pAR2PFC+ElSHKQ/0QjQcgCyGyM9v3SnsDBRJgL6msWCf6IfWeUJac8UFlpY8500DcCfvgb43hiwZwyYVhd2D/VSrKGAmIDnBkiafEcN9cprHgKMzgNjS1V7rRjRlceyrqif6KAkMgXIM+6tAnDl+zSL36O9+U8p9jGHQo285/2XA/AnXeNnKAorDXH/AILwbSvLEz6Ql2+cAf/3XcCdw8DkKHBwpOpFbE2wadzIdyh3jjNQirYWEwYq+/zJwMh8pf+xKNSwM6DZMmzNRRbM2K+2Ii6TlFrAWfd5V3i/F7IgT2LBF5LbIdkqxLPWvtzlAGQ3RpU3Y7AiixMxLOUB2t7pKQ8M0qCTnp8HkojJgNqaMEJesQv4AR3Iw8DB4QqAs+6SWRiqgJgY0HVDAdBA4Ba4xN7ndlSFAAjAYX4IPO5dBDMAdS2i+Jx7XTf1eEdTDfgAQnR34p/wQkRmjNAoByDT/ugFphXAmjAEn8qaPQAgZCs0lSckCNmVigEbFMsPBBE3DcBX7gLuawH7hoAD7EM8DMw48AhATrjtQwiXoqkTEwWd7LOneXNCbz6Tiq/TInb2M8ZzIFrTQbGiy92oGz7pXl/7jvdAJnb2470IbB3T77Sai+hyAP5voTqW6sKwFAc/TAdc5+3dvcsTrvPVYSK4SQb8xV3+6IaAqSHg0FDVh3iOIFTIFxtit9orL5Z/LD1Q4s+B8OnHVuXwhhdd5DoLGsgCCJ04q66X/Ju/vSaeAxDPvbdtmdtKDV90gVEPIl/xySkviOhmAEjrlzSkwj40SlQZYZ39I+8JBMx8mZryhOsKwqYB+KpdVSDFvhYwPVR9BD7uyX4SwRS59nNI+bRck/DzJ05v12M0nY8fAk8iWL5BB5qASPGRCi8EVjzv3mqpkC9ACrrwhKukB67GhpqRRowQMqCiYbj8oOoHeUWpdYIBAUj8c8WjrjyhNIJ1unzjDPjqXdUjJAAP8TMEzLYq9uOHICQALe/EwWe+QgddAqCzzD8+vgIgg0qp+5nYjaDzCgjmnCYone0klqP4JSgvvK+6LoFPoFMlkPGh+0rPWta4RHTNJJQz4M8EAGoNTPVU8opS64CC9zoAWTFChcq7lCdch6s3L4J/2QFIEBKA1P9mHIBmhPh3Ai354RyAAmWsR/PRs6vOR8Z8FMPS97yxtIlYgVB/I7jC0rIKSfLXF1EEB+BFFjQ3jCLA49OWsRTTEPzvzQEwry7VrZ5KwzAQAPssT9jw1dcHgCrORQCS/bgn+1HsCYQSveaHkzvGv1scgU/6R55Y1YIxhvOm1EZekQWl8wVDxJgwc88QiJc6AKX/meHDawX9z16M/Em7bO8Q08GBP/jEkAEVjMBoAFWXUjRA3KtNwOBXW3EkAZhrALktpC6lKtTV4OU7RHB+3kHWgv/zrnYZl2kCkF4uF8MGQGc+MqEYUCA0n1tkwxbw4ScHAHr71Q7W4++c8czwcBAmHVB/c7Bcek9b3FuwbdD/kjGWgzJjQ3thGmVA3jhfOyU+RxB6FamOFp8NrhsTgLy8Cpzm5QlVptAU+6CiNgXCaIQ0BcDYV8b0P4pi30vfIxD5+w72C9aliegW8MHzqrmh/meuFhYi0pKbs6D9fsh/n1XFMrYMbPgUByCZz6J+uEknDA9AornWFRb01WZEsACoHhOqyC7wdetT0QAK2KqOb5MCUvPyhLE0oQxzqaYNXL5xBvyVXe12vByLADjXAvgxBvSPGFGMIjCmJbEW8HfntxtQmxT0cmxp9UPAdKAZ1upA6EB7qgDo6oCUxXRtPVSpAwJpnUhuxAqWCCYK1MBExZljY5S8SYr+pxAFAuBayhNG26jw8usCQLX0SAAkwwcAEngyQizaXoziIli+Oe7/9kJvNk1LmBMe9ECO3XRB7aPeF0EYHNVPdT8gj016YBcWtBfBVYJuz7mF7VgGY/pO8f5WdQ1/7U67nIKNS7j0wIbDPFZsyNHHY7od/xdlEHj8CcC3TgCWHgGAPSxiSdt4312u/8SPAl8/Dlh4pDeZW2PD4J1c9+uyDaIDkgEJQKnTfG/N8nUAmu5HUnMW5ARbPfEuIHy/ACjRK7FL5pOR4RaxgTHofKl8r/S1ZWBnAGDKefbn3AFIPRPXB7sFiVQimKVgGdl5ooNwLQ1/1U+DQGSXQ9r5Evy1q9rZbP1lGQDZsPpzI8APHgXgod7qUx11YtBbFzC+/C+BL7SAWwhgdoLkONSLqy5oLogYft3ZI1F7EAC+phsAnekokhP4HIzml/PvthQWmPB9LJ7jxkcSr14jWj4/0wFlgJD5eoDw6fe4DzAYPHokWhHJZ3TFSkn4h7YOSOBwEtiMTv1aY0uktFYTmI2/43EMQmCuAJmUE0gmVD8EFdPpdnxhVhqzDr8F4NMtYM9Jfg98EVTeNu9Q2OFZBX7vr9vtgm/lcezczZ61ZNN8DCvilYCdPXqNDQpAlfGTKm0M6AA0PTAyoMSx64cRfPQHXsniOTI+fEWDFGp+Qb9BeySRBV2kpl0QxxGAlHDmkI56X6z+EP7UDYSdRgh/IouwIZ36lHabBE0GJ0r10Rgb/xA/tt/j/6aMAf+7R4CxzuBXWRGULwBfIrY6UNfpvLae7n0I+LO/reoLMqiVMbW38oUhkNkQIzZO7tIweGePcmWlAFTjAYHPVGwXxWoLYblEDkLuTT8MDPhXLJ4jALpaJB+ggU6xfgJknT7IKXIQXh4Y0FZCog+wxiUTwSkXUbSMV1rB/A31OXWuFpPUda/mRHKi1e6U+hA7Zq7l+A+UAfDtHg/LrptkQpZ727cRWOL9542Pa3rOvuOqagUltgtmJM08j4/PILbIDKz6w5PAHsbraTnMGdZWIwIzxIfeK0rn578J3LAVuH8CODRahV/FFQ/1IumIvXP1QudNfyNT8oVqcHviPcBd48A0g2RDuoDqHdb2SalZAdG9dnfDkAE0gXnH5ijWCDbKCq5/MRiV0QD8HgHQ63jG0hdsLGxA3x9Bw1Asli7hO3BwApgng/Gjvq01IHrXJ7q3Cz7E++YziF2rs1ZLZ+8H9jJsSoECWXj6igmR87aLgfbGq4GvbgLu2gjsHwdmCEIPSI1h+SkCRjpfUC3iNWcpoRrcnrYbuGsUOMBo7QBCxSTG/igxVcBIVGPWM1h1JYQPnyKNExGZMDIJ9b66eEBGxPDY1Y5nv+GCjfGAxD+DDpiawphABWZPjwNzNLAEIH4XCH0M7/5c93bBfI8Yk2cgVAdvdT10ifDkBWC/r9lGH51NhIsnsWHOfPmEUKT94WeAG8eAO8aAfWPAwVEHISNQlKQUglJjJExqC+H6Nq93kOpUg9szbwLuHa66QzFWkaFieXxi6hgVHOMCYGRuJ+5V4jYJIDKI9KlsAvFDq8QDrnb8NWVPh9EwdFkQ79TlSMIsN0Mi5s9MoOGno4U6f3YAvefL7Y7rvdoFLxOANSA8f7xSgWmd0kCQbmZ6mTLEnJ0UqWLhUkxlrBn6n3wWuGkYuGukCsufGq2iojnRFpafsU7MDxErJuZhYCsJosHtWTcBe1oeq+hxigJgXBrMmTBPnJKLrr+VED54ibHYvZos8sO+DNcrHrDX8YVVyglAKud0LtMjFPtNMz6QLDY7VomLJd671AEH4Xu+3g7nWq28ISvX58/hguOBg8vtFQvV/hEzxfqOevuTfpjri8vAWz8L3NYCfjBc6ZYHmBcitnFd06pxyb8W4gPlgonBqffTtdTg9pybqiVNBssyUsdUD7eGO9amnf3sXtxQipl7Wg/sD4A8AwHIyZMYky50Tp/xgN2OL8y051qw2hXzwRCEdT2nmck1RxHG+w5jeO9NFQBpR6ldMIMXlFWgVndqF2dVFsJzuOgRwMElB6DcI6rznemD0RnbwQiSRS3g7Z+tVIl7PC9kahiYZm6IizuLigliT/VoUog+p8P9l3wJ7qGEanB77k3VczroUToWLCsABud4ypaLCUoxf9i/9w9ADiICULrQRWuIB6w7nuZrwaZwLBGwClSqSyz3AhHbaRGEFGOmC44D72UVgjW2C2Z4lIF4ArjodODQcqUGqAxfcpG4mJVuVqcL5tbs2z/veV0tYK/nhTAqesYNHdO5PCJZos+WuzxHJIViuXFyJxupNLg976ZK2lizUKodilGUgzyGhokF8yw5Mf+qRkjdjfuDtwkkm7DTkNaBaQ2ox1q3eMD8+B6O3H6em8Kx1Ccx9ptWl9iYIUAAWrI3I3nHgPdOtsO5eOuxXXBdj0V1vOL/so3Cxef60tlSpYwveKf0pAu6ohfdJ8k4CUqgvr5jV6VGTBKALeCAh+VbZLTnh5gu6D44A6H8cVlkNK95O1WkBrfn31R5HSy+JCwPplAxRegE/2T+AloGncNmbQyogUQx/KwB4gHj8YWNTwRAOW0FIIIndoqNkTAxz/bd09XDGLBdMM6/pLKi5whAX60gCK2ujxzEAqGL2pQ1Jis5AJEAFHvTujYAKjRf+SEugm1d2COQLU/DAwQ44caEw8AtZzSIPgAvuKkdrWMM6M7xCMBoiBn4YpCE2NCfxWAA5MEuwvCCEICwlnhAHV+YORfDsWJGgPpMKwg1b9QpFnzHbD2BK2JGul9s8KkYW17vLALQRTCBpzXZpS4gtCXXMAkduuAy8E7PijPWprXJ5CR38ygw1fJDohh2BlRAgq2OeN7uTWc1D0AFNtmL54ESBsCaJcLkDajxj5ZXRiCIGA0waDwgjy8sk5+HY+X9ppUbJSCp6TnFCMXwny1WAFQ8rUAc2wUrRL6mXTAefWnFfnz3FpbagQKLAqAzoZjAKkkpXkNO5GCEvOMLFXOnnC4xIKOjnQGNdWSM+GqHQGd7JSsxUf+JzQLwhTdV4je1nQvr1MkPGtlf9yP2Dy+gAqZ6rQytfvdHSDxgLwBF8AmAYjHWluEDiKGMiqOVvtejXTBOuRSYJwDJAARgZAGWL9Nk+IM3SzgTydE4eec1nZHbtDaNAf1Dpd/SMx2END6kD0oXtFhBXmcY+OY6AFChnKnzl7NfdMR3qCAae2B+VVMYXASvDs3/X/zHJZcB84vuiqABEo0QPnhnwqQLyRURmZBPytnwHde0M1vN2lR6picoKULaxHDIEdHkW2iWg4/7b5zb7DSQAVd0/griV2JYojfpwRGEYsGBrOBmx/OgP5sAKANkcbFzNWTRnX/GSGImMYH/LYlk+gGvdT+bW+SWH+Ig1GqL5QeTtR2EYj5LVHfjw/ZDwL8yJ6TB7UU3VVoTjTYxYDK+Ivv7dzNAZIxpZSiU8jjKgIWTcykZkBawDBBnQdMr5QeTKI5iWCB09AmEb7+ucnOQ/aTPWn6wuzyS4u+R0Ob6CUGqJpIDA97AdqINbgRgBJ69CG4Jp6q/ckjXqB/RKla4WpkO2ODgHoynigA0JiLwaNiEt95YQKJ4FRC+7brKzRH9jZbN6iJYuSHm9I5iOAOhHNJfZkh+gxsBKPbLu3+JgaWDdojhMO5kkDWSlNTg4B6MpyIAjf3IggJgMD4MCARjFMU9QCgAykhSKnUCYHB9JB0wy5aTRUxmup4h+Q1uAmDs+hpXgFLnB6ULONOn5xACNJqxghsc3IPxVBGAiQG9aLeilWUJW1FvVXEN0TKp1C6At19TMSCBpz1dHtT/JH7N9yaxp6QkF73KBxYIr10nAMproB44qQGTj6sjUrtOFPtLeFQHLES9AdDFrq1E6M13MaxVCTNAXNFThIylLcor40zxtgDAPKuVwDMrOKw+SBTbtR2MND7sZwC7Qvm4wqHa4T/uIrhb+7n0EgbQdTijoyg+agWXT8llDsAFWr/B8qP1K7bT0pvtVwHhW6+t2C/m8svvZlawi2CKe37nhFtapkDnILRqBQA+v04AjMyn79EIkXO/DnzyCBwVweX4wxs9B4rRZgyPVFqykgDd+5JSpBU5r0vHyHz+jsc3ub0KABsZMCyQgeExKyFPVIz3lmcM6OfPAGCADYPE67Jfs6h7G0o+xvi7oyK4cLZfOgpsXwC2Lq9MwuuVERonKn4nSJrcXnQKcM7dwMMXgYcsVxkSebJgzOWPqdB1ad2f3gpsnwK2LXWeR9m3danUIV1lBSCPArBwtp+7DThuBti6UDWDmWA/DvXk8LRptfPtNUlihYZTOPCi04GH3wFsnwGOW6iAs5n3GeJJ+KLoE+9VDClQ8R6vOQHYegDYwuY3S6H/iJ8jb11ck0q9Qhoc9QMWgPBZJwFbpoFN88DGRWBiqQIgWyJY3lPozaGJ1KTEPh36zpTkJrcXPRE44S7g+Cng2DlgyyKwaclfFoIwvCwx9Zn3Q1DmIPx/2/sSaMuusszvjfXq1ZRUElJkKsBEGQyYhJCBSkUqAW1tsBdpuxEVaBzowXZqe1g90G2LotjQdmMjKqtBxQERdAWUAkUlZNBGkQRNyIAEMAkxpFKpqjfUG3t9//m/c/+737njPq9uVeqcte66b7jnnn32/s6///3v//++Tz0dmD0KzC4DM6vAFpd/0L3Gh6yTDgnvLwKzAWDGiH/ThcC2OWDrErB1pRgQisIQhAa+AED+HEEY6uNLyrRnZLSl6tSbrgLOeBQ44yiw8ziwfaV4UGbdegmA5QMTLFlqsfn7XecDW+eAmePAltXiXnkuZSBkRcm4UGXtU2uo3xsAZgz6y54JzMwDWzkgBOAqMMVBCSAUObh8QuN/CiTgcWAuyWhL1amvvBbY+VgxbW477paa7gIBqCnUrbUBiQuhAKDUot13IbBlDtiyBEyvtO5VDxvvVfxW/JkWNFrCeK8NAGsY7BsvKQC4hQCkJNaKy2LRIsg6SJ3IQSe1onKKC2CsOYMeN+0Dtj0ObDsGbFsEZmWp5S74g2Ir2uA22BScAJGA+dJFwPQ8ML0ETAUAkgDTPq9zdK/+sMWpPF19NxYwA4g3PtsHxAE4SQC6FdSgmGWRRIJLZJll8EGKjHiX1jwaN10HzD4BbD0GzC4WrsKMW2pNobZoCu6CLCDfCTqzgg6sr+wFphaAKQfgZHKvpRSYg7HN5XCL2AbAZwPrZGaj6ippXhgn0kqmU1woxnHedg5AATuWHig2FE1uVRwoxoX+Wcbg89S3AqCKPONcCi8oPtVP+9++G3j+oSK2xRBFDElUxbTS+3nvc4FpDsjxllXQoJg8FgdCQoGJJTTicLcQ6vPL6wbg9cDM4cJv27oAzFA5ky9/UOSvmg8oP86n0dICBn25JwjARWDSAUgBHN6vfdbv10AbARh8X91vDM2ss+NvAECKPVLCsHoyUgRqrlbnRwB933OBc+4DXrIC0IEmiLnE75di8HsyAcjzWUVGUi6uICMpVwwJVMXdeOk3XAxc+Hng+vV2esAYw+sWoP31r3eLcLwQBeQUrEHh4Jo2h4vDmJPuAyMLGAeEn7uqbgB+I7DlSWBGCwe31Gb9aL20kGDb/EGRxY6WTz8f2wtM8l4pgL1SgM8esHCvsuylME4nn9cfQLtldg6TZ0kUKorAfij23vAPCmqp3fcCl60XFINid1PlZrf41/dnApB6wSQjutUfIDJR8CGIQOwWEH7DywpKrWc8CFzqRLHkVYrB2jS2FQH5vkuBycXCAlIUUAAkCM2iRBA6+ARCe7DjYmQduLYTleiQ/XTTS4DpI+6nLhZW2nzVCEBaMLd+soIGqjD1ampdugiYWCpeBKA9bBJC9ActAk8LES26SqsftInLZ44dQif4Igdhym5WLrPDyuYH/7HTCNwDnPko8LXrBccjQaioe6BiKad3+QY/MGTH6rS3OBvCnQDuAIyqhiDkQ9RX+29yE3on8IwjxQPI8zkTiApGU3oVkD/4fGDieAuAdMw5MFQjEgg1DYsUku+a3uI0TGBfV7PotwHwaOEmbHEATvuDIutni6UAQoFRIFRYhfe/dhEw7tbe9Of0Si1g8HkrwRcevDajz07gIJ7n05rYyWIpb4ya/7vv8PRdFpj/LXDmkQLAnA4jCCOlTBRN/rFMAJKgkkVHpGUjySSBSFeg7/azqk8EgbSEq8UDRACLKDXSyaQ7Br//DcA4LSCtwnKhTEkQcmAIQhtM+Uaajl0uS9NatITXWzpzfcdNB4DpY+6nBgDaCtanYLN6fCj4u1ay0QIqtML/EYC61wSA9tAJeP6eWsAoDysFpg1eB0HIQRCIIkVeCqQf/05P3WCB+UPA+CPAzvmCaFWDKEuYcl1yMN+Y2dckqGTeHPEvvWDSNhOAfbefX0A6rS8CUw8X9066bFIfdqMHJID++DJgLACQumyc3gyAEYRRKFCLD1eu5ODLF6QvXedx0w3A1BwwxdAJLTXjd8seQnGrZ9bPFxLyA7WIKON63tYtCQBN/sv9QPm6BkLp0vl9t/m6ietR6fbyBA4gnXtORwRRpNnTtPpW6gWLH83lKqcOFTEnDiKtoHwy8RNFhrefyeztbnrBfbWfgttsP+kIyO32ELD1cHHvInrlvWs6TsnB7qAUlg/suFtAWkE55zYQ0QpqcALoNCXTEt7A3KoaDwGQfqoAOEUBa7fUbKctltwCajVbxvSiyvoasM0BaBKwwdKb9fN7NfcqBWGiSWykWXER0umeacUEonQgCKRfIgDFjya5yq8Wfsfs8dYgiuMxgpAg/vnMzu6mF0z6Zj5APdvPQec0TEosnvQosGOhaLuIYvnwEYSithE52F1XFAA0p5yigD4otCqygFKnpHUpLYP0OcKURYv6Mj4MNR433QhM0gL6QongawOg+6rl9CswKoSkEIxPyTsuAPigCYBmAXVfYcVf+n0SRYw6dP1YwNgHsgSajiJP429RrpWOM6cxDiJB6NINM4w7LbUGMQUwB/M9mZ3dSy+YVG0EoBiDBST5ddZ+PkCsAiIlQZDa3LVatJ0WXG2PbL98AB+4omB3oP/HgTUhmGgBfRqWf2TTrUSjExDSP/qWzQDgfAFAWyzR8rkFtDAKX75jo6nUguZxZ8NByHbvvqBQ36T1swcsBaBAGGRg40Ir+rt9WUDhQ5ZAU7Es2e9LLzglqHRxNkbeuW+oQRRls5jaMjnK0a9ecNf2R4LAwO829kQB3LTtEYQPUwzQAWgW0AGo8AQH0ljp/V17pm0KRcEifGuNOnocO1rACQbKPXhs8TtNwVr5uh+n6Zf3wDgu29g2FdMtOc8B6PdpFj08ZFrplw+ZA5FTvAQQ0/BT36FPDkRqBT9Jag7xYlQItY0f88j78sZzCcKPZlrAQfSCK9uvB4h577SCotUiEJ8opq8IQFl/PUBPEoBLxbRE62LSqG4dFB8r5bHcOtiOQSqT5T7RKzYDgJx+BUCCTxZQCwhaQc9oKcEnEBKknj5FsJ1LAPo9xoWWPWDy+6IIoqbeaO0VA+zHB0zxIQDKkn1GgtXiRxMIAx0Vn0Db+lkuFjLRCt5WEwD71Qvu2H5OfekD5FaciQay/GIbFgBXriwAyGmJADR1ck3DwTE3TQ4B0LetzBJErTYAr2BBSI3HTS8tLKBZPo/fWQDZp197Z3scjGb5BDp/L3+njMweB6B83Gj9wj3atOsPWin9WgXCFlVO/3ctf4iD8XkBkH5USlAZlNPZAQqARr5vxu1yjmH0givbX0UQKI63o0Wun/xHuR8E4VnPK5JQLd4VNttTBvK2uoiKOUf/f+GjwMNBh0NMV6J0c0NpcRv7mrYv3kh8/uHxYp+bVpwLp3R7sts2YzouSq3KGa+q7+x7Co4nazAerRKsVlV1QitF59dyyFZaYY0HMu9mWL3gtvZXMbymBIFMZ1ov2h0B+LTLisxgW+Eq5uU92iZ72ud9vvR+4JFp4NjkRh2ONi0OB1/UBCkvEYRhfuNs4OmhhiPKnFQlx6aAjMnSXJUAACAASURBVPjmz1w41nnwO4cCIBvBwZgTAOUHRq3gyDExD4zRGVYEnpm5LqmQc0M5esFt7acFl0SlHiBxuTkYxxdaihUC4QVXFu5FCUD5QtJl85sjGA0ziQxqeu/fem+hw0F2fLLQGxFlYMRvo7v1WmIVtpt1DFkXvOR7LwJ2HSkyoZmEypoVVe8p7b6qEMnidGG/Vl/L2aPOIwuA1pAIQE3DAmFa4j9f7CPaFpCHKujr5xzZesGdHqAqKz5X+FLRAl58le+jui+kTBALMcgZ73CDBkpN2/7+bfcWOhwUyCEAjQTcAVhKdjkPc2RajewKyu/n1//qJcA2uhBMRGXQOcn9U6JIOjXHQqSYOsVoQp1HNgAvz8yny80H5PVz9H6RqVd849WtXQ/zA0Ow2ayGLJ474L0G79vvbulwkJi8BGCg4S01SKqofoNvSIC+5zkhFUupV8rUTpJN06KpaBkFQm5M1HlkA3AyM5/u9Zl38zrk6f0iU6/4hmscgK5ISUtCTowyDqb7UxwsqFJW3fo/vbuIBJEZ1YRgyHwQKNi0KEl1OKTCZJdxtPDn//v8ooaDaVgqFyiTD2IKfcjZS4Fo+7g+HXOPv84jG4DIzKfLzQf8KVfI/FNKrQ6h94tfz+vOA9cGAAbrpylY2SDlVTTt+uCnV3/V3a7DQQAysJAwobZJgUXi78Qayhd812WeiOAZzEyUiAkHMeu5BF5FwZQAWLPwknkLQy9CrPMy8+lIHZFzvN3T+YbV+8X7c64OHHix74V6zIxB+RJ0wQ+UU992tYoFy3fcXcTDxQkoPsCUhFIczKVCegSg5B8A/PILN9ZwxBSxtiKiUAOi7JW0dLTustF8AGbm0/1o3vjjnSGdj+lYlGwdRO8XN+c1wABIoHk6k61yuSCJITq3jDY9Vx0BqK++uwAfX6JkI/hME0SC1EGguiQ+isqcQRLrF6/0jO2w+6FMnZhyZYsQ1W50qOHgPX1NXndtODsfgMwHzMin+0+ZN0S9YOllMzWfLwKQSS396P3iY3kNOLDPM1y065H4gOW3p4uTDkB8zWdb7FgbdDhEgJkCUDRvogTmd/vPv3BVAUBuvylNzAAYi4hisVQnEHoIqWblrxqm4Mx8ujfljT+YjsWBYgIOc0oJPsq1slCpH71fKybJOEoAuuVTRSCnYlmU6P/Z4iSJEcbLv+Yu9/1EAh7JKEXDKxq4ChUiKymRbwjgHdcUWTARgLYXHSr2LOU+BV7MVwzxwOfkOWybYAGZD5iRT0edjpxD6VhcOQ6j94tP51wdOHBdMeXa9OqWRcmWXA1XLUIUH6zyCwlAs3z+YBkfs1u+VIejJEF3ckrjI9T0y/aMA2+/tgAg08VURKT8vbKMUgAMIGzzAcOi5HknHQAz8+l+MW/829KxhtH7tTz+jIMAJPCYMULAWd6fvi+EY9ouoZBM/Kx/4LUBgFLgNC5o16FrE8JJVJgkiFhaQQBv3+dVbMrWVsC8UxFRkjjaVsW2DtRdOJ/vAyohVYK7A+bTvTdj8HlqTMcaRu/XxHkzjgNkIOWuDr8jnYYDKDutgpUhra0uAlAyCCUAK8BXcjBXgLCk/h0D/hcByDxFAdAzoFUqUBYRJTUcMWdPP7ONL6i5bLQeALJRQ+bT/W7G4AuAOXq/lsGdcRgAY+glLkYclJVTsa6ptCX3uQjAKINQstFrAZKIwWxQIhIJuovB/Nx+r2LzFCwlj8Y0evl/MYk0kieVtcvrwGUnHQCVjjVkPl3mItQsIPuElx9G79dOzDgMgGkAWlNyBJn8xKprBRC+zgEo4LWRgcdVcOCjjlNvmx84DrzNAahaFZWLygKWxUNibIhTcPD9BMLLa65bzreAMSGVoXvJ/Cgh1WUfO+XTZS5CDYDs9GH1fnOrIDcAkABTTDCCLYK0Cwi/586WcKJUiEpC8CCBYDsiiSplqUIUmOjf+o2tIiKVUJbgU5uSWl4DWwX4+PcXnrQATBNS+8yny1yEopdcay+930y5YhgAg+9n2OoUeI5TdQer+32fdhmGoOBZanBo+g1yEKU4dYgFSvqB//vZBIBt9RshkTbW8ZZZ2hUgvDL3iU3uux4LSBM0ZD7dPRnTH08VAIfV+2XAOucQAMuVcKfFSD/+IAABsEoGwYAoHZIKEEYxRIHwLS8pUuhjFVs6/ZZhIVWyxVKBBIRXnbQATBNS+8ynI4tBzkEACv+chlUVIKE/5cRGsWmlKfIzudc3APLQSlg3E2OCyVRc1kpU3DgBmKoQsWtlBcswjPu+nfTYtBL+GQdgOf16GCZW6pXlBCqWSgqJypoOAFfXXDifbwFJLvi5HAjlnUsiIe6AjOp4iQNQHRlT2PlgJCUbbc2s+v/hFwFb/q7gm6HlYpBbmTV2sscQyy/qFBj2v0/cAdz/HGD7NDA1AUyOOU+1CwWOewNjKj6/O03F1/WuugW4/XJgfBoYmwDGdH7IxB5kLPIB+I8AfNwZgga5ck2fJbEm8V9zNWPfrasbgMuPAcuseJ8Exsb9FdBhA+7gaQNKB6TfcgCYug+YJT+g89aoBDMmIMScP12uTKj13uDv8zsKig/uJ1uQOsnojm3qB5P5ACRBH3OhPuzzRN9DV88HqQLEWPJnvTy5nm/t/1s4BcuSpRZtGAu4fi+wtBVYEyccrYwn6hF8/FkJp9bKxAKVFsn/d8urgbHPA9NPOEOWl4+2cfoFHhfVrJTZPKHSj5daOtup6JyCpPx8rHWRVQ7WOlrYCMx8AHIzlxkALPD9c0VB+x/A3E/+E2fUYHXdF7KTGwdvTd0AHP9r4PgWYG0KWBdfsBdsMPfPrKKsoL9XAVLAvO2fFylCE4cKliyrDVZNcGS1CqEYhWFiAZV+XntaURdTLmpCEbpchTYLqi6NrkMCzLzt5Xc4HwyJmmkJ+Z73jQOh4NWeDUZiK1K08f0EXt7CMHVawIk7gaVpYJUA9LI1Ao8bzKX1cytoFtFfpdCIWz7rgzHgth8u0oPGDwETc8CEMySUzFaikgtlpW1Ta8JqNba7lVljSRgW+Q6ZP/57WQvj6fydBjXfAjKbgEvMLwWCvhNoipgNpnQshlS4IGFWzIk6ylWwAz93ETLxGWB5ClidLABoIOS7pmGfG+33YAG5mND0G8F4678vkiPJczNOAC4UyQm2N8w94kirFlfIAl7i402d6dbPWWAtrsjOFiuCvAJZOQE0pHTFsckHYDeCvhNgipQNxoAz8/8IPr5nbvH2jd+6AThJAE4AqwTdZKEBLDoDgU4+YVkPHIBoPwareOt/BkDexsMFAFnbzNJYm0IDnVwbt4uyur1kwL7Tp+iZM/08WT9Rc7DHUmuYTr/x+6o4ovvu9fjBbgR9JyA+omwwxvZI5ULg6ZW7y9FPf9QNwKm/CgCcKABovh8ByVy/UCtJq2f+X1yYJPGU27lIZLbuEWDsWBHesZeDz4iURLUWa1TE47LqK12fZmd3OXidFctqm92KatVs1jAEsNv6sdymaa2g8+xUL4I+Pn2beCgbLGWHI/h8G3oTr45iK86POlbBU9yKI/AcfLR+ouQwH9BfmmbLlTHboOnZ/T9+5vaf8FUaAThXsFOQ45mUcgZCWTAxe0UQ+urYMO1/37GtxQmoLCBtRSp30LrDp2SFdzYMgk/R+VNwvwR9mwQDsaspGSfJgYDYNTbp8psCQFJxEIBkQjDrxt8dXCUIY+COH5MVFPi8SOn2n/QYLZ9Gp0cxANIP5IvAkzVzxivRydnKNzBa8fddM84b6AFyAriMF2pajk9kYIeoClXmA3AQgr5NQEHMBqMVFMNaIOayNRL/vhlH3RZwmhbQQUcAasrVVGz4EtjCu/3dfb/ID3PbT7uKAZ/MhcIC0vqRTo4W0IBIEAmEtFwCYqjW03bcmdwBYeoWgetUbrR8snrloiR2drpACf+rD4D9EvTVjIJu7HBV+781X752Czj9lwUZkTEgcPoNPp5Nv4oBRhCG6dd+1DkMz1JIhR1BAHJ7zwqO3fIRRM5tmDK5CoQKsSgOeBYBKFZULTqcB9r6Ni5KYmd3WKDUA0BlhNLM8EbT1QBXBU72aI5ZjUcVOxz7WLkQ8d37vsart/uA6RcPsxNSAtAXHDYNC1AEpf9s01kKwuBwGU7HgVt/1jtD1e60fgQigSe/j5bQp+KYpGB+H62jT7P8/ZypBIC8Dhcx8eY9wF015abhmnoAyJ5WSrKeNgKO9SHxnT/LSasJBim5lRjWBEIVeROInKL1qunybRawLgASdEy74qjaNNzJCgqEEYzBGvK0297mAFSHEIB6ebKDgc8J1ksmV8t29f1en6L5v6cxIK5iK6Xne/5jCTiFcTqVn/r/tWDPWwXnEPTVgIKUHU7ljASawKefIwDpMdRxRB+wFgD+RREDJABpwSzz2c0LfxczVjkVKwaYgtBBezu3SvX08d39P5uO3QKahXMQciourZRAGKZWar/YZ1xXRPe8wQr2AUK7TvbOVTZBXx4MBECRnConUBSFEXT6mf/TK+/qmzAF/0UBOPqBZYF52HrTFCw2LH5G8UCzJEko5nZqmRnPh/uCXmpnVpDTsIPPwKApOaSA2QLDLSHf97iPx0tpISLfz7bl4iFfsUsnj+HZWEeOYDCDnDmCvZkEgedcCjxGseIhBYt3vx049HwMLRh8gA9gh2MoH9ABqKJzxf0McO7XlSAU4HzhYYFq+5D7hwBu/98OQLlIBCKnW39SlXNY+nqeiq2dkQg+gnGPb9/ZpT0lq6MV5D96gLCwgDmCwbdnCvZmCgY/dxy47xxg5SWuUjigYPHFbwA+fyGwfr2rXrMvPB+vp3L3GHCgi9JOHQCkRVPppeUBigXLFymyejYTB4YsgfA20ofRAlYB0FfAlvQqP0/TsX5PLOB5DNu471cmIwiBaRww/F01J+mz2pqChxUMZvpJlmBv3iTocsW4dzewfhkGFix+2febXDAeJO/YEILBB7pU1g8LQFo98QASVGYNQ6DZfEG3fnEqrgLhbf/HV15anbkFNCvohWSl9XPQ2XTM/2s3I4DwPIZwBEDfgitH0Ek6N6x+u/iD7T4g/YdBBYPpWHEaHlqwNw+AQa4Yj54JrJO+aQDB4pt+oCAyYvOPEIQDCgYfeF/9U3AbAMX7ItAlVtAspKZdz5SOlvA2pstxjES3wJ+92NgAGK2gwi78QoVfEhBeQACqNNP1RdoA18kKdgDhxkUI/zKIYDCnqyzB3jwAJnLFOEIW7QEEi1/1Y21ywVglCAcQDD5/Efj7M4CVrZ5AKlkhxeQUaxBI4nvFzxf8IfCVC4HV7cC6ZEX5nen3VX1vAGLZq8ysrvHY+QBwbGfI2E6JpLvdX+ksthpUvQrmX/sVDGZVUJZgb17vJHLFeGQcmCdVb5+Cxd/5xjZ6QzzMLOQBBIOfTV2Ps4HFHQ7CLQUQmUrV0rgKJMsCjsxGAqTn/hzw0EXA4tnAyg5gbTYBorKkUyLnkB9YVhTxu+kT13iccwtwdBewPAus+b2ar9xJAafqfgMQO4dh+J9+BHe5gqZZZzYok1JJUcpaR6bp93P+W/N6p0KuGIemgEWKgPQhWPxdP7NBLhiHKYHUp2DwpZ8rLOD8tmJQVplOLxAqmbRKC6EDYC7/CeCRPcCx3cDSrsISrs04CPm9ArZk55UvKAspYLqPaPdR4/H0g8DRHcDyVr/X6VabLHk2PhjpPVZY7d5xwF6CwS9y/4LbbVyQsEKIufGiKe0p2JvXOx3kinF0GjhOQY+oNRtljji9TQPf/fOV9IZY4Gq4D8Hgy/4W+Oo2YG5bUUy04vUcLCqSJVRWszJbNgxSmMau+q/Ao2cBR88EjtOqbgNWWaTkIFz3YiWrF4nAjtN0nBZrJnU+/8PA3CxwfMYB6LUra3oglL0tps6wlVha5rLiqd9AdDfB4Je6U0s/0BXTDYh80Sr2FOzNA2AXuWIszABL1JaKWq1R+nwGeM17OsoFY5XTVw/B4Cv+Djg0C8xvLYqJCECzgsxmZlq9T8e0XGUyaUizavPtxoFr/zvw2BnA0Z3A8e2FVV3x6c4sqwObckeyhiXAowUSADhD1XhceDMwx37lvU4XxVN2n3rJIocygkr/Vbs7fe+EdBLcfaXXQ3IPWIrpBB6XlnwpR76jYG9e7/SQKzarxM7qJFj8mg8UarMV9IZ4gvNDD8HgKx8HDs8A8zMFAFnPYQPDl0Co2g4fpDZLqKCxT0/7fhJ4fCdwbFvhRiwRgJruCOwUgCpeCvUjZmEFxhfk9W969kW/B8xvKQqnVgg+B6CB0MsI7P70AHgmd2n1NQ0rv7FvALIlVYK73MnQCDLThSGZoDpuP7uCeuX5n8zroB5yxThGnQ0CgyBMxY63Aq/5aBHG6EBviDlOLV0Eg1+0AByZLgbl+HRxnZXJoqqttA4ODovlJZVuSjTQFtq+NwNPbHMAzramdVpVs6wEoPtdNg37wJfvsYiJP9NFqvHY+7vAwjSwxAeNxVO8T6aNVRRRlT6hHrJ0Ovaw0WDJCKng7g86APvNB9wg2JvXO33IFWOBgn8EIf2nRLD4tbe1+AU7yAWbZeskGHwVdd2mgAUCcNKnJgLQrZ/V9/Jnn5JUYmnAE3hCmv3+t8AWQfSzyPK/POOgJgDdsgqA5nfJAvLdLV+bz0kK4RqPZ3wQWJxyAPqDVhZQyQr7gyaXI9axWCFVAGLvRUhV46PgLnUWBs0HbBPszeudPuWKsTRZAJDTo8l8ui/42juL5veQC7ZpsEow+OrZQlqVVuH4FLA8WVyDAOTAmHUQCAWQkOlsQAwDt/9/AE8SgPQpNa07+AhAA6HLXbb5Xr4IaAMfv/eGvP5NzyYA7UGjBWTWjh40v9fSyscHLtaxhJWxFVsNNAXH1khw983+DYPmA5aCvXkdNIBccemfceooAfhAAcA+6A2xLuAGucxrzgKOMexDfV9OwbS2BB/BEoqLSrBoYGgJ3E8qLcIEsP/ngCPuUy7S13L3wb6PU56/m/Xj4Ps0TKCXQA6AXuNeZY3HMz5QANAeND1kwcKXlj6wOZQ+b7R+Pi0PD0DeFAfk590CKg8qncfoFzIRVWVqfFfBhgn25vXOAHLFWCDbvPstBsJZ4LUPt+jdesgFg+qVptWq11bg2gtgfuLiRAAgQeg+oEmsOujsXb5SsAoCIN/3vx04OlNM6Yv0tdx1MKvK7/TFjVmeCD4HQQQhf159eV7/pmc/kwCcKABoeYvR0oept7SEoZQ0Tr1lPuPQFlAtO0nyAcWhpzw/FSjFzGjLx+RGvxzoSeC1hwsA9klvaFN5FAy+9mJgnhaQ0qqagglADo4c9AhCDpJPl5ZommQ8738HcGw6AJBW1VecZv0cePwOY0/wl1lAD/WUCx0mMlDLr8bjmb+Dwp3x4nkDYbD0thIO5aNtfmDi/xGEeRawxhs7Vb/q2huABQJwAlhyy2cC0xoggjAAUCWWAkksOiIY978TmOOqeqqwqAx3WGhHK06n7TDwOcAV/iipPAKjwgrZm2o8nkUA0gKmAHTrp+o9MTrEYvq44o9pZIOtgmu8mafCV72YAKT/RwAy5OPOuVlAAk9Oule6xQRTWUKlWtkU/IvAHAHti5oIwDK841ZPFtCmdr0U8PaC9hVultd4CIC8P2Ztt/m5/qC11TJXlJDGGpfGAmYODgFoCxACkLpuWh3KCgqE8gNVZK4KtxgjJAB/2X1Krao1rfN7CWZf3LSBT4uAEIyWBVpipL7GgwA0AW25GbGENBTRx3rm1M2w39mmrFVwjTd1Kn+VAZALEE5LtIDyMWUBvbLNLGHgd5H/V07BDp7r3uU+Jadgn3ptxekA5MBri0/Wp4wzBjDbCnkMWMqVpE8GJwLQqvfc0pqbkVj5aNk7gbCxgJno30cAjntowtXNaZ1suvSKNhsYTcVKmw9F5xGE+94dfEoP+JYhD/8OC8eIPUsUHokVVKB78XszbzAF4Pvd//PCKVGIpOAr78mn4DZOm8YC1jco+w6EFTDDPJqeCEBZBa5GffVbhmQ8DtZW5TYOvPhXip0GTuu22lTMLSw+aAVl9QhEWjurI/aQiLJkTMLsX9R3r/ymZ73fp1+37OU9hunXSkdl7T3QrhKCtlCM59k2i5CMMSIAGdqxEIwrmptzTsCEut5yilKoJLAcxCq3fe8tLCDBFwO+tKjyuxSCMdYEXoeDrHcHvu0tTwLzmwHA4N/Gh6zNCqqeOSxC2lb8tQSiMwbuqXIqAcjFh2JjBKGJyShQG6ygVbfJegULWBYcMR3rvb6oCRaQwFPgl1M5rR7/JtBZOIZWx/0+s4QeY5z/1/X2tFnAxPpFELaVkdLN8MWGVr4pCBsfMHN8bmTKfCjZ0Ncp456/x58zLzfw6Qf3ABd8pUgEYmqk5bGyek06IQl1bkXScnlN/u8L24Gdx1qVq91KQvrpgwaAAw9p+wnXPw1YjyWMGtDo2ASOFGMU7SIEUzdYD34vMPmXwLbHgdkFYAtlGiim6DpxJtvq9LtlVr/aWKEB8pUXAOOPAFPzwBTZ9r04vdQ9Ts4pAZ3cd+yHxgfMAOH+vcA69/9Uxijmz/AerYpdar1lNSMYzV+vWY/34I8DY58Gph8Bpo8A04vAFEFIknIHohGVR62QhFRSYjQE6qFri2z3iaPAhHNNlxKwArI0Q1IAxwfReacbC5gBPp66/5ICgLKCtqnsrKKlrFZUFPKOr7osMTtdsxzqQRZ93Q1MPARMPllohUxRqkEK6gShOP0S+dY2hlRv99y+ovRi7IiTnTvLqmg6xDPYpqAUgRgsoR7MxgJmgHD/c4E1FXu7FRRbvEgd7evXWlbPpp9EgUjiJpwe6zwOMlvpAWCMVusJYPIYMOlSDZRpoGiNxKzbdIQlXONMWJbGtw4svdgz3El47nzTRvPrrKptAJT6ZrzfintvAJgx4vsvdQvIXK5VYF3sUZxmJUvgA1FOvwF8spKyBtM1y6EepI4LqVMedbEaTp0EIKdPKh5FqYYqSxgo2jgFr13j6XXHnOiSZOeBVSvyC8qC2r05FVvVw9cAMAOA178AWPMp2LJaaekiCPXExwHw660n1oB/niGQazwOkkSepbJ/72I1x4CJ+cJ6lYI1riccrVicUuVSmIW82pkwnHHVOKbFsOozQGkFkwewnBES37ABYMaAX39ZAUCCb82nIlo+40p2gNnvsoKunxH1xGwA/LOzdQOQJPIuHzV2GBg7Cow7AI0l33XfjOsv6oVodes6ISbBsAZMX+kJxU56KY7pkmFVhOciuvTzSt05v0+ryuT/9gDrZNe4wPMsI7VJP3GcP7gUOOdvgL1rRYJ0ZI5IV3hV4/wrGYPPU3/AiRhYusy2K7mU999P+z90ObD7LuBZK0Xdkeq9NSX2+o4HLwfWlopFCC0fgciBMtAFC8CGrYXVoVjnU2G7rTXrzh4kfRzLY1kyGwBoeiGcPiXb5eAzdXWnazPCSScb4j3xfmav8Cx2p50lAMW0VXINitCogl2r9H2dcctWwQxQsn6ZTBbMNtcgdKIbiZj51VcBk38CXPxoQcfCUg8pjcYgZScw/momACnXyr4leBhs5QaBTHpf7X8dMPYJYO8XgAv9e8QJlAZZq8D4xSuANYKPJQn0AR2AHKy1MACKe9nfFI6IEqduEWoHIJ9wlsVKLekoMCa9EAegSTYQeM4TXco2SEMkAHEbBZoj4bbYtdyCVrFqGXgTSxgXYTZeHLi9AMjEQRCVUXP/n4KUaaT8vVTi+Rtg7GPAuYcAWlMCgUVkQfJ2Q12yBvPXMwHImhDWwf81imsTiLSEvHZkr+jY/p9CQRD4p8DOBwteItai05qn31FFdfLlFxYWgCDUIkRkj/TxbCEi/89jfPZ3X2VqYSJQbmUNQY3HQT7hbv2sLoerVwKQHNEEoCsm8R4MhPRjXUGzVEIKIoY7yaEYuY4dgGb5RXruoSgtSCLLarkICQ9f6QNykGjFdjsIBaI4kGlt8W+Rg5g0HJ8qAp47nihAzFpuWtPIMBZJlASILvR6fQ0DCVbJCkJOJCqnk4pGpb99tZ8MopyiKDX7WWDiwYKXiEQOehCrgKh+eJQ+EQHo1Lby/zRlyf8TIbf9XS5ftIb8I92YugH4ay2pLusorl7dAoonWtMwQSTdOFuQSLTGHyIC8kxSIQuA4hwU2WUAoO4/grBcDbsfWElSzg+JCoYDoEGM1ixSkHzgF/wG7y8sIa3J7JPAGWuFJSQIaU01iJHUiYP4e33BrPOHmG/JMaOfTZVYRhwGav87vWKPJ9/rSH4IOGO5sITqg/ggxXs4TOaBAECbeoOsgfl+DrQShFqcEIhyyt0MbMusEkx76iAZXKM8BvXiZAGlF+KaIbaadYpem4aDgpJZQz6YJABV5VcHAJZ0v4FxX6KG5UpYs0KnqjhRuagEVgPglYAl9ciHf8mdUrJh0Qx9vkDBzBywfbkYQIGwahA/kglATsHsDzKA0BATiPyZ4NEDwIeoa/uFYKKXL2f24nQoIgd9R3yQCMTFqwIAfdBWI7+yB5ZLECYLETd85YJl+2YAUNosLIel/xYlu4Jsl6bhNhD6it4WJCvA2Zc4Gxo73RcgJeOqFmGR6rcChLYACyGojmEYdj59KnZ+tIQRhH9IvWA2hiREjDeRI9Cly7fMF3EtWRFawhQIf5IJwE56wdTIYdt7tp9ys1K8JnoJvod9Wn682PNkP4hUy1ndWgstAtBDMLYN5/6PAc5DGNoF4SrZfN+4+IhT8jqwg2Cp8ThIJ5vfSWBXAVCrWN9SMxDK+skaOvhoAc8me654pmUB3f0wyt+E8FyRAGmPlOEoiSD2qgvmAKoOm52fAuiTDHSyIRxx+lI0QxxADubfF5vffMmSajrWlP7nmZ3dSy+4r/ZzAUEHnQ8R70HsXlK+PgJsW68G4XYGZj0EY2EYATCAT6tAhmE0DXcC4faapcwMgAIfLb0kuzT9Qmw5uwAAIABJREFUSi+EfeALkSrpBovbrQDnkm8wAo8/E3i+CCsZ98NCpAp8cUekZyBavI4ET/TnaAk/RQCyAXy6uNSPA0i+wMeB6ePA5HFgZq2wpNGK3FUDAHmv3fSCe7afX8CB4UNEEOolVi/3obastNwJ9cO5BOBKEQMsAcifHWzRAigWWAlCn5K2bQYAOe1KMjTIR2kRUhKVS7IrLia0v+3xwHMZMCbYNP0KfG79zAqK5DxOvyEuWu6VD5KSHy2YAEQAfpaRdl5UkuUctIpBnCIIl4psD03FtIIP1ADAlBuJM47EqqUX3LX9kSBQcuuyftK78xUkHyQ+RLqHZ3Fv1KcgLj5kAQ1s0Qo6IA1nHhNLQzA8ZxvBXuNx8DcS5UYpNnoYxsCnUIqvZo0F3wPTMa7Hv53HOJVbS/l+5bumX7d+5WLE44hxIRJB2NMCqj9ixwuE90svWCaIA6bAp959EKeWChAyA0PTOV2unGMQveCO7bfqHbcS4rJR7Ewqnw5AWhLuImg2uFQAXAVs8RGmntW4+g2hB3P79L/EJ9zGvqrxOPibiVihAOgrWQOf/EBfBcsPNBBqW9Hv6zzGqFzmoXz3B9AePgXiq6bgiv4YOB9QHS8AfpkAFMMjrWAcQA0iO9XJiQyAnos2vV7ESHOOQfWCO7Zf7F40mZFQScRKAYBaSU6vAVcTgN7xXHiUFpDTMK2dFh56912BTiDcvpkATIXzCL4g3WXTZ4jpGfjoF/oihL+fx+0yWUABLwIwtYKKIabgCzHQvi2ggBKn0McEQDaKT5cGkIOo6SuyYzEfjQB0EM5nZgAPoxe8of3sgSqCQM3jkdFLvpRvR13+7UVRuhUFSavNO6otwp88ZZ3+t4M6HLtch6OT9AG/q9cmtf//gV1JDYcnQ2zY6/YakfSrU+Pg1M45NqPt3IEtoM7WFHokyrWKkooglCMWLYjiUXMtK3g8Uzd1WL3gDe3vRRCoUEYCwGtYFxxqgA2E/jI20F5hhmQod98BHNnlxOTig1aGiDanO21yV4DygWuB8YeB6fnC9WEtiKVVKeE0ZGiXWczeJoWMIig5a9V5DA1ANoKDeDylZ9NSXxyAsiKawrQqmCv2HVf5e8aRoxfc1n7xs+khItAUvojvyWryxVcWJZksVSyZoQRA3dcAoHzax4Gj2wtu6FVKM7gMgti02jbV476oUJJs1j/AbA1mQ3Pm8eTRsoZDtR+xZKCiEKmMXTIeXHPGdhYArX8FwG4DGMEnAHIK4yvT58nWC2b73cexaZgWWaEKgU1gjNbPP7PvOYGsUSBkv3hBtmRWNzxjTk9RWktvxp6POj0vARjY9sWkFel8RWxegjIF4RjwAOnZWMPBTGjqvHmszxJOBUD3xyznL2bqROvoP3N3q84jG4C7M/PpcvMBef0cvV9k6hXv+2Yno5QfGArRbaCC0mWv2YtF3ecerNDhkNZIIsXQRv5dlTtGADJSz2gEE1EJQM//026HdIEZLC8B6A0tk0g1Ja8DuzJdphS82QBEZj5dbj7gxZN5er/IZI+67pscgE7QaDOUMyC0Wb8+gXjuR4F5J6YsaXnFhBoAGEVvUhb60jISgCQnoh/OLBgvIrL8v7DdFkEYM5dtNg97tvz5zJqzdfIBmJlPl5sP+DJP5xtW7xffnzeh7H+Z+3+RpkyWT1YxuURJYVtx6T0fCTocouQV85VkHRIGegEuEv/YKpkA/JceVmL8kv6t5/9pu62tfiPWcFQVEa0DZ9WcLJEPwMx8uvfnjT9IgZyj94t/ldeA/S9tMaGa9SNdmsIxbvVscVJ1GScoMt4UPwhAsmMZ0aXzQBsvdGRBjQz0FUpEJRAJQOq4KAnBdz+sfiPJ3bOYn8fsykyVWMfiN3BOzckS+QDMzKe7OW/88aqQzsfE5kH1fvGjeQ0wADodmVGwOeiMsUqHrGOnS4UFy9P/wAEojkEnI+IqOIJQNLgpCXhcmLAtD/D+kgQE235L93tj+YBqgTX9BiCeW/NedT4AmQ+YkU/3sbzxBymQuZhm8g1T+QbV+wWFdjKO/Te2mEFNlCb6gPF708VJ1TXHgKd91GnZpDfi1k/gM2vqU3DUnCuBmNQe3P9vw6pe229KOvB0K1k+ZS+rnrfM2AlA3JMZtah/EZKZT3drxuDz1O/yxAwu9JgJxr3lQfR+8aa8Buy/wdWQZAVl+ZzCrG3q9c/YrkmHy3IRYryAAqAkEBIlopJxNNUbER+fA/H+/+AAdP9PmS9dazicJybm7mlB8nR2dI1HvgVkOlZGPt2nM29GCamcGZjAwlQ+vvrV+8X/zGsAAUiLVPp/wd+zaTMFWw+/kAA0GQQnpCw5mDsAMIrcRB5mC/+MAffTwgfwKY2KfmCZ6ZIkUShrxXxBX4yYaV8Hzmcn13jUA8CMfDqWYeQcSkhVOl8U6uxH7xekrsg49h8oiCENgC5TUG5vKxxT8f2aRtOtcAKQ1s8soPuOVUIwpchNlEEIOyNSIrrvv3hwnckWIZPZsnbcDyzTpvg3lU8mpZQqozyfK74aj3wAKh1LgrsD5tMxiz/nkGD1sHq/YNFOxkEAcuW7oqmXlisuQOT7VV2jwi/kTgj1RkoZhBje8Z83SCAEEJZW0C3gff8tADCt4VASaWIBK0HI9q8BF5yUAMzIp8tNx5Jg9bB6v/jdDPSRns0BWIZeUitIo9IhHmhXTvzCPQddccnZ76U1V/IvC4SBCFyg26DFNg7c++Mhhb6qiCikT7WVUmr6lYn2nRKyrdZ51GMBlZIc07GUBdMjny6XCiUmpA6j94vMZbgBMFo552pu27PXAqXTyAUQcitOQjAm9xX0N9pIwIPmSCmH5QuPqER0L4kDYgp9zOUL6fYxkbZcFceyAreAF3GlV+NRDwAz8uksnT3jiILVSmpWNlhMze+k94vMZfgGAPJeHDjpCrgM01Tdry9OzvmYAzAqLVWIwEShwzbRwwSEn+MqP6bQK5tZlWyhjCCCsC19Xv7gOnBRbgp7cu/5AOyVjqVMmA75dJZ9nHF0yohWNlhMxKnS+0XmMtwAmFq4imnYbrEqNJPc+9kfd62RKh0On8qV9hXZ9askEPgAfI56ziocUgVbzGT28lEtRMoKtg7lBHtznfZNA+CQ+XQWM8k4uglWK/NLYKzS+8U9GReXD0g/Tyvh4Ne17Yb4Zbr6g6y7/aNWcoPpjKRTsJIags5IJwkEAv6en05S6GUBfRWsUExZyVZVQCQwrgN7Wfdd41GPBczIp8ODeXfTSbBa6YYxlY8/p3q/udc3C+jTbtvqt2oadnB2m4oNgMn0W0p+hYWHWbwg9yU/0Kb9EIy+5y2hiCit4UgKyTeAkN8Valk4Le/ldlONRz4AWWBRM6fdIPfHstw/G+SE5rMnVQ/kA5AkLHS0ak7V7reXfhgACaBqDtD3e/nmc5k9kA/A80JReq+U38zGVp3ObJo/BvAOD3dtwiWar9zEHsgHIGlFubqSx7+Jja36anLLcDvvgwA+NDpDfILv+qlzuXwAXuSjrkKemlO2e3U1uWUYnL8dwB/5e2apca9LNv+vsQfyAUheX4VguB+mzIsaG9ntqxhF4Xbe3QD+n7/uHLAW9wQ1tblMRQ/UA0CaHC7plXEh+q4T0OWcfhleYTSHBK0EH/mi+fcRuKQn4I6fWpeoB4AevCz3HOOm9yb3F5mBlZBNclYCj1aRfyfrbgPCTR6AzK+vD4CyglX7jpmN7HY66d1E0ctdIrEEE4wEIMlam+Pk7YF6AMj7EwAVbU82vTerCwhAXopJN9zVI+AYrOeULLZgErY2x8nZA/kAJGWr0naUWdFpy2cT+oCWjpdjLFxE5UzYIBBpEUX5nLnlvAktb76SPVAfAOUHpiAMm96bsVtCAMaKALICMyxDq6cXfycA+b/mOLl6oF4AiqBRIEzBp7/X2Af0+fi1XIioMIlAI+AIPIGPmeROWV3j1Zuvyu2B+gHoFfZiDS2lC0LiY52WUADkQoTTMH1BFSYRdHoRfKSu5v9qrizMHYPT+vx6ARhSuDcAzzmDo5ZGHT1PAKYMwQxME2jiSo/gEwBrrq+u41ZOy++oD4BaCcsXTPiSI3ey8s4KGoG8QwCMFM+0ggQhLR0BF19SXuD/ayakz7uR0/TsMcxg3SjfqWNA0hsrga/ojaq/8WPcC+YIk4Ke4CMSuB2XVht1Oj8zIfXlU8BtU8DhmYRXWdfrdF1fgr3+S8At48CD04DVjXQSDO70PTUnaJ5uOCwsIIFHSSFy1pKPWCDsZxCpw8UVgKSPxLXM937OzxxAljzcPAbcswU4Qh4V3UN8mKoeKm/bu78IfKJQa8VD48CylHQiL3O3/qg5Rf30BKACMtJXjXKQcfBSK8Dfqc3KVCwuN2VFGRnm/yKZtq4Re5ifyQQgM2A+BeB3GHaZBo5MAIue0l7Kt3cC4xhw+5eL7TuCkJk1jBtyerbUfYG5ExjZ/pqrxE5fAOrOq5SmowVIrRp1IyT2R6+fg0bgVYG4CsyZe2UsaiOGKXr4Sfp9k8CxCYAFSKyvXeY1o1BxQux91yMtfsHPutgnnyUuUvhc0ZsgUXib+nVkq6+ZKaABIHsgVZnuwD9sVo66rrR4ImdhLGSQ8zPL/JgBQxeU1ouWkO9PTgDzbgmXxrzMkatl3keivfG5x4r4IRcz5BfkO5vEZ0kgpIfBZ8yKjlL17syy0tMNcOn9dl4Fy6dLFabj1Mpvow9Ify+I4Nlo9Xt+ZqU9VdJpqZh4QDDyxUyYOYJwHDg+DhgI/WUVZl7aSEt93+GO9Ia2iuZKOfA7lhp9JpvAVy61w2mOwO5hmCgMHC1H9O24gu6UD9jP+ZmbtLRaSsei9SL4XDPbAEh/kGQ/pSUcc0lbApFWb67lQUhpVnLBsoKqqZclFMmUtrxPcwxl3X7vOCAtYLSCcugFQmqhdssH7HU+RznjiOlYXA8wqkOfkItTAom+oKygca4ES8jY+N3z7fSG4hfUtp3ihUHruVSsFy1iRvNP+1N7A5BdJACmVpAgZPhGOyCigEjlPLudn7kvFtOxuB4g6OjD8UWLRkCZFRwrLCEXJQQhp2K+37lQeBCRX1A7KPQto1prFEmSYn2mB9EAsO+kYfk8KQhZF8yjVz5gp/MztyOUjiW9bCUhEBhKRCCgSis45uQ/PhX/xfFWMgOnWu2gxB0TF/o0kEZ/kCDM1Ts+3RHYnwVUL6XhDFrAswfIB6w6P1MrTulY0sum1VICglKwCEACqvQFCUK3gHcsFQCM/ILayqP1k9JshVqrncMalOYYvgcGAyCvIwuod8YBJQmZpmGJeyRwkGw4n8jJOJQNw3idLFhMRNB0SgASTJyKoy/4ieXCeFfJBUeV2SoAclFyR0bbm1OHTUiN0/DTAwD7zQeM52dqj8VsGEkVE2jKetG7AEhQ0frJAv6RC0trC1skl+IWlNinGLbSaZg7Mc0xfA8MbgF1LQV1z08A2G8+oM7PVF9Ms2GUE0gQyp+Lwu2yagLgR9ZaYpkSypQ6a6Q2DCqzpkvietXIFdoZfuieGmcOD0DeP0HEbBhNwYPmA/L8zJQsATAKnguEqS+XTqkE4YfWWwCUFZTksYAYwZfIBeN9Tw0cjOwu8gDIZqsoSSvhEeQDiiGYFoyWiSDRypWgi69UP5sc5fIcquSCNeXqe2X9ZAHfM7Khe2pcOB+AT41+aO5iRD3QAHBEHd9ctuiBBoANEkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cvAFgg4GR9kADwJF2f3PxBoANBkbaAw0AR9r9zcUbADYYGGkPNAAcafc3F28A2GBgpD3QAHCk3d9cfOxqYJ2au9RdPtdp/khoEOlglDYT39V1PzQFXLsMXAlgt9PCxJKPbufyf8/KHIPfBPAZABf79Xc5XQ0ZQ1Q7360NbxoHrlsDvs5ZRsgo0une06by6X1mZvtP99PNAp4F4LsBXA5gjw8EGTeqaGF4QhzQF80CX7cAvGIdeDYAfhdZ2sTKUcVrpE7nd31N5gj8e2dIo2osk7NZpMdK0Z19tv+bJ4F9K8D1ACj8yfNSikHeg+5Z969m57Y/8/ZP+dPLKZhP/rcA+AYAF7g1oRUhEMUzFMt6eSJfX78b2DkPfM0i8GIAX+uWlAMppreUUErn8p2gzTl+2flg/sDbTkvIOik+CP20//mzwAXzwDcCuNTPJeFXpEpM6QEjIHm/zTF8D7T5gATYNQCe69aAloRTGulfBESBSYNyxR5g/Bhw7hKwZwl4vk9LnM5JmsBzUyDGAX3B8G23Mz/g9BuUa/0IiutfMkj7zwKmngAuXSvOpUvAWYBtF4BTnspIj/O8zPaf7qdvWITw6eZA0JLQEhKEGgxZhUj/dz3NzSKwbR44exnYvVKcy+mM5Km0JhxInUtrGkmzCPicg3W5LMGkQiZZTm9xS9Z3+4m2o8C5c4X15pTKW2Lb+fCx7WLtjYxzqiql29Icw/dA5SqYf6RTTilg+lYCIXmICKQ4IK9wxfSJY8AZK8CuFWDnanEua9ZTAMsaCog3Dt92O/MvnRGBtGwkqKRmMEkqCaa+2k+0LQDTh4rP88UHj74kF1WaATo9QHQ7mmP4HugYhtEKj4PB6ZQ+FS0hQahpldPya1kXTOqNY8DscgG+HavAttUCvBxInitrkgL4lcO33c7spBdM3kAuSnq2nx9gQfAh4JyVwvrxwel2z3p4aMlzH6DM2z/lT+8aB+Q/OT4EEqckWQSBkGD6EQKQnDCLwBSnYgcf32fXioGUFawC4esyu7CXXnDP9tOCsyD4KLB1rmgvX7zfbu2WG/Jtme0/3U/vKxBNAMoi0KcjkATCN3HOEr3UAjDrwOP71rXixYEkeKMFlSX8ocwR6KUXTJ7AaNE2tF8WfA4Ye7Kw1mwvX/yZn+eKnvcrfzC6IK/ObP/pfnpfAGQnySoISBqUXyAASS1AK0JfagWYcRDOrAF66TxZQU7jBOEbM0egH71gcgXSFZAV54NQtj9YcNIpbONCyh8Ygi8CVospApDuB63g92W2/3Q/vW8AsqM4gLIKBBIH8bcJwMCNMX68BTqBb8s6sGWtsIA6jwDk662ZI9CvXjA5A6NVa2t/IAicnC/aGV+8T74IQPm/AmGuBc+8/VP+9IEAyLslAKMV/LgAyIUInfnjwPQqMOOgI/DstQ5Mr7UAqMF8V2YXDqoXXNl+EQQ6N9v29aKdesUpWJZbAPyPme0/3U8fGIDssDid/pUASCvCaXgJmFguAEfgEXT27gDkuwaUg/nbmSMwjF7whvbLhSDL5TwwvdRqo9oqHzACkCB8U2b7T/fThwIgO01T1IMCoAZxGRhbKoAXQUcQTjkI+a4B5e5FzjGsXvCG9gdqrLGFYrpVG/UuHzBOw2/LaXxzbh43DKeoJwlAHqLndSs4udoCoIBHQE45EPk3DuitmYOQoxdctp8+rFwIWsGFYiFFoLGNchcEQC6e+OJC5J2Z7T/dTx/aApYdJ37AyJK/DIwvFxYvWr0IwEn/H1Opco5sveDUhSAAF4HJpQJkWixp6k2n4IYfMGf0amDHev2I8+l4/UbvNw8Eozw72wJePOJ8und7EkKj9ztKGA1/7WwATo44n45pWI3e7/AAGPWZ2QBkYHCU+XTMfGGQmYIxjd7vqOE0+PXzATjifDrKtTZ6v4MP/MlyRj4AR5xPF+VaqZLJF1UzKdPV6P2eLDDr3I58AI44n07ZMARbo/d78gMubWE+AEecT8e9YOn2Uheu0fs9tUCYD8AR59MpG6bR+z21gKfW1gNAz4geRT5dTEZo9H5PPRDmAzBmRM8BJzqfLiYjSKKr0fs9dYBYDwBHmE9XtRfMsIz04aQZ1+j9npygrA+Akqs8wfl0BCCTWRq935MTYL1aVQ8Ao1zlAnAi8+kEQGZTNXq/vYb75Pt/fQAcUT5dBGCj93vyAaxXi+oDoFLyT3A+3Rcavd9eY3xS/z8fgCQX/LPR3SOzkon55jg1eyAfgD8M4NcAPD6aDmBtB1e4NMDNcer1QD4AbwbwxwDe4UvRE9wHZG1gNSXDLlwLNcep1QP5APxzzwj9IIAPnXhT5ORc5EYCA9HNcWr1QD4AmRH6FQBMTSZZH98ZmD5Bh5g1FopiNns1x6nTA/kAvAfAEwDudnI+EvQxPfkEzYfaCXRSBluQMB7YHKdGD+QDsBNBH/9+AkAobqTADGK7Inw1x8nfA/kA7EXQt8kgrGAGMfBxZ5Cv5ji5eyAfgL0I+r68uR0QmUFoBQU8vfNvzXHy9kA9AORoMw7CdGQCjoUZDwL4kv/+8OZ1gJhBIjGDgMh3vTavBc035/RAPgD7JegjODfhiMwgoqeJwNPPTaB6Ezq/hq+sB4AcXeXEP+ZhGVo9vRimIQD5v5oPAZCupgDI9wg8/qz/1Xz55usyeyAfgMMQ9GU2Op4eAchpOIJQQEz/VuPlm6/K7IH6AMjgGzdl6QtyX5jWjpQFevF3lq3xf6yhrOlIAUgQCojR8gmE+l9Nl2++JrMH6gEgR5UA5KYsc+AZmCbQCDi+IvgEQMob1XBEAHIajgBMLV+0kCdws6aGu3zqfkV9AGTwjftg3JRVVRAtHQEXX/wbAcoXP5d5CID8GoJKvqDAloKOoIz/y7x8c3pmD4zhaqwjRzCYyQg5gr2ZgsFTLweWr8XQgsXjbwLWrnNtMlKgNoLBmZAa7PTCAuYIBlMvlWQswwr2UlUw45jdDSx8HbD+Ctd+HVCwePKbgJV9aASDM8Yg59TWFDysYPBtmYK91IbNOHaPA/M7gUXKXA4hWDz79cA8+W0aweCMURj+1HYfcBjBYO54MMY3tGDv8I3nmWSHOzYOLJ0LLPGXAQWLz3oB8MQUsEa16kYwOG8whjh74yJkUMFgbsNlCfYO0epwissVY34bsHw2sEIRkAEEi/dcU0SP5qhF1ggG5w3GEGdXr4L5134Fg4kAjuDQgr1DtDqcUmZETwArZwAru4BVqsv0KVh8/o3F4v0QXZBGMDhvMIY4u3MYhv95Zh+Cu1xBcxuOU/HfeDIq5cv7FuwdotXhlCBXjOXZAnyrO4BV6in0IVh8wStLuWCsUAyvEQzOG5ABz+4eB+R/ewnu/kOP/3G/l4kJTERlljQtIot2e53/IwO2OPl4FLtcnCqAp9cahT56CBZf+LpSLhhz1N5qBIPzBmTAs/sLRHcTDKbiNHdBGGymOC/3hglEvgjAnoK9A7Y4+XgiV4zVWYDAs/etxaubYPFFP1QkLtCIP8neaASD8wZkwLP7AyC/tJNg8L/xLNBu+YBdBXsHbHEFAINcMVamgdWZAoRrfPdXm8KitLdmgYveWAq+2y7iMqfuRjA4b1AGOLt/APJLqwSD3+y5T1yI0AoSbAxMMzGV1o8/My2ro2DvAK2t+GgiV4zj4+3AIwDXtwBrVJeuECze+9aW4Dut4PxkIhYsdetGMDhvoDqcPRgA+SWp4O4veQ5Uv/mAGwR78+6rQq4Yq9PAOi2fA4/vBkKudKVU7VZw77uKvWFuZbtcMNb5v0YwOG9g+jx7cADyi6Pg7gccgIxlcA5TKhaD01yYKBmVFpBZMfx/m2Bvny3t8LGqoqTliZbVI+gMgHwnMAnCIFi897cLAAZ6QyzFzzSCwXkD1OPs4QDIL5XgLmk5JHk/SD5gKdibd38VcsVYGmuBTaAzEHLHgyCcaokB7/1IkUET5IKxwF5pBIPzBqbPs4cHIC/AaeqvPL9pmHxAE+zts6VdLCD/lcgVY3UyWD0Bj1ZwqgCggXA7sPfWAoAJvaEtZBrB4Lyx6efsPADyCtmCvf00s/NnOsgVY3m8BTRZPZuGBUACdArY+5lWDqGmYbIrLHEx0ggG5w1OH2fnA7CPizQfaXqgUw80AGywMdIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0BxoAjrT7m4s3AGwwMNIeaAA40u5vLt4AsMHASHugAeBIu7+5eAPABgMj7YEGgCPt/ubiDQAbDIy0B8ZYNMbkX+ZekpuIiOQrPar+xs889HJg6jZg5jAwvVZ8B+ll9PlO5/Fc/o+ECjnHfi8zYfkvM5ulmp4qJXVqx5deD4zfAkw/CGxdAZgoHfuh131QkaI5hu8Bs4Ds8B0AWLnIRGCBsFfn87JffDMwdjOw5R5g8giwZa34jnQQUwDo99wBfJ4TM7COiNdlaj2rA/jeV/vfDeATAP4UGH8I2Lrc6gc+SHqY4oMZ74VSKM0xfA+UUzB/oBUUCKMl6zSQ/PsXqZD5KQC/A0w/DEwcAcYXgYnVwppwADuBkefnCim90FmBWXwnK87Uen53BI8sbuwqaz9p5UgnQhBS+ZN1zE8Ak0utviCwq8DI8/nx5hi+Bzb4gJzKZE1SEFZZgS9/2pWR/gTAJ4HJQ8DEMWB8ARhfBsaWCwDquwQKvvNgHXvOcYVbPFJPkw+dDxC/W1Y4tWDpw/Rlgo4lo1T4/KxTihDNpJwj3/UiMLXemprjffC7eWpzDN8DlYsQDiKtVxzEqoHkyX9HRizW+nIgaQnvAiaeBCbmC0s4tgSMu2rMePAR9X252jXklaTFU108K0MHav/nvJ6ZxVVk9OI7GR2IZoGQNc/HgbHgIwqILIVujuF7oOMqWFawCoRxkfEIB5CWgkREBCNf9wMTc8A4QciBWyoGz16rwNgaML5eWKpctYZL3N+TWLX0gvtuP0HHk2n16JDyxXmVhfU0qywbJbr5GSuXKxA/sV5Y9UYWdnjwyS3qKKgarWA69Wg6fjQOIK0HadnIjPVFB+AiME4AuiUkCFnESyCSkmAuU7Cjm15wX+2X2ifBRn9A8mKcW2UFjULVQcgVDl80u40SYh763FfvquhLCxitoBYUsoJfjXKttByMq9CKcHn4sPuCbgXNJwyWkECcz5Q376UX3LNncZyQAAADEklEQVT9fFgIJs6lBBwtn3Tt6FpIz4RWnuQxPh2XIGzm4CwQ9hWIFgBTK0gQHiIAJddKq0ELQh+KL1qUR4MvSEsoENIKrgALHNiMox+94K7tl9qnnMio8MSf6SNwGpYVjCDk/Ju7isq496fCqX0BkDeqlWwKwic1gAQSpzGREnFgREz01eALLvvq2Kfi45m6cf3qBXdsfxRbJMho8dimqOhEK8cXQRr9QVpvPoDNMXQP9A3ACELFxPh+jACkP0fLIKFCCRRqKuPUdqjlC9o07JZwKVNHeBC94DQcZO0XAAkmgotAk9QYrR9f/BvByYfMSATDVMzwTXMM3QMDAVAgVHCZ7/MaQK4QZUHiNCbBQlqUw74YCb7gcmYkelC9YFlwvVv7RRAorTuBkECU9asCID9/x9B935zYzyKkqpfiNHxcA0gLQgvBAaPVkCqm3h2AtC5m/RyEqzw/4xhGL3hD++MmslgqCbgUfLKAcRrmTlBzDN0DA1tAXUlWcDm1IOIIJAjlT/Fd05lbFQFwjdtgGcewesFt7Rc/Gx8iWjUCjGCT1YvWT1MwgUqrf3NG45tTbcu0aximWx9xENcEQHGbcYAEwtSXSqY0gnCdgeuMI0cvuGx/FUGgFhwEYrR80QckWN+X0fjm1DwAWv8RgJFilJZBznz0pQg+AZAAlVWh1GvGka0XzB0cCQi30aSGVa9AF62fLOB7MhrfnJoPwPER59Px+o3e76mL5Kwp2G57xPl0kxc3er+nLvyKtLmhfUC78RHn081ONnq/pzcAR5xPR9mRRu/31IVgvgUccT4dNaobvd/TGYAjzqejumqj93s6A3DE+XRUg2VSCjdaGr3fUw+I+VPwiPPpqJjO8J1Nw43e7ymHwHoAKMFd7QErAeEE5NNJMb3R+z3lsGcNzgfgiPPpomJ6o/d76oGwPgCOKJ8uKqY3er+nKwBHmE+noqRG7/fUA199U/AI8+kEwEbv93QHoEhZTnA+nYqSGr3fBoAtaiqBUImdm5hPJwA2er+nKwBHnE+X1gUzSbnR+z11wPj/AeCpPDD3t7rvAAAAAElFTkSuQmCC",yge="uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",xge="varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",fh={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},XF=class extends uo{constructor({preset:e=fh.MEDIUM,edgeDetectionMode:t=C2.COLOR,predicationMode:i=f0e.DISABLED}={}){super("SMAAEffect",yge,{vertexShader:xge,blendFunction:kt.NORMAL,attributes:to.CONVOLUTION|to.DEPTH,uniforms:new Map([["weightMap",new Fe(null)]])});let n,r;arguments.length>1&&(n=arguments[0],r=arguments[1],arguments.length>2&&(e=arguments[2]),arguments.length>3&&(t=arguments[3])),this.renderTargetEdges=new Qt(1,1,{minFilter:Lt,stencilBuffer:!1,depthBuffer:!1}),this.renderTargetEdges.texture.name="SMAA.Edges",this.renderTargetWeights=this.renderTargetEdges.clone(),this.renderTargetWeights.texture.name="SMAA.Weights",this.uniforms.get("weightMap").value=this.renderTargetWeights.texture,this.clearPass=new RA(!0,!1,!1),this.clearPass.overrideClearColor=new ut(0),this.clearPass.overrideClearAlpha=1,this.edgeDetectionPass=new Va(new m0e),this.edgeDetectionMaterial.edgeDetectionMode=t,this.edgeDetectionMaterial.predicationMode=i,this.weightsPass=new Va(new M0e);let s=new aN;s.onLoad=()=>{let a=new ln(n);a.name="SMAA.Search",a.magFilter=ai,a.minFilter=ai,a.generateMipmaps=!1,a.needsUpdate=!0,a.flipY=!0,this.weightsMaterial.searchTexture=a;let o=new ln(r);o.name="SMAA.Area",o.magFilter=Lt,o.minFilter=Lt,o.generateMipmaps=!1,o.needsUpdate=!0,o.flipY=!1,this.weightsMaterial.areaTexture=o,this.dispatchEvent({type:"load"})},s.itemStart("search"),s.itemStart("area"),n!==void 0&&r!==void 0?(s.itemEnd("search"),s.itemEnd("area")):typeof Image<"u"&&(n=new Image,r=new Image,n.addEventListener("load",()=>s.itemEnd("search")),r.addEventListener("load",()=>s.itemEnd("area")),n.src=ZP,r.src=QP),this.applyPreset(e)}get edgesTexture(){return this.renderTargetEdges.texture}getEdgesTexture(){return this.edgesTexture}get weightsTexture(){return this.renderTargetWeights.texture}getWeightsTexture(){return this.weightsTexture}get edgeDetectionMaterial(){return this.edgeDetectionPass.fullscreenMaterial}get colorEdgesMaterial(){return this.edgeDetectionMaterial}getEdgeDetectionMaterial(){return this.edgeDetectionMaterial}get weightsMaterial(){return this.weightsPass.fullscreenMaterial}getWeightsMaterial(){return this.weightsMaterial}setEdgeDetectionThreshold(e){this.edgeDetectionMaterial.edgeDetectionThreshold=e}setOrthogonalSearchSteps(e){this.weightsMaterial.orthogonalSearchSteps=e}applyPreset(e){let t=this.edgeDetectionMaterial,i=this.weightsMaterial;switch(e){case fh.LOW:t.edgeDetectionThreshold=.15,i.orthogonalSearchSteps=4,i.diagonalDetection=!1,i.cornerDetection=!1;break;case fh.MEDIUM:t.edgeDetectionThreshold=.1,i.orthogonalSearchSteps=8,i.diagonalDetection=!1,i.cornerDetection=!1;break;case fh.HIGH:t.edgeDetectionThreshold=.1,i.orthogonalSearchSteps=16,i.diagonalSearchSteps=8,i.cornerRounding=25,i.diagonalDetection=!0,i.cornerDetection=!0;break;case fh.ULTRA:t.edgeDetectionThreshold=.05,i.orthogonalSearchSteps=32,i.diagonalSearchSteps=16,i.cornerRounding=25,i.diagonalDetection=!0,i.cornerDetection=!0;break}}setDepthTexture(e,t=pl){this.edgeDetectionMaterial.depthBuffer=e,this.edgeDetectionMaterial.depthPacking=t}update(e,t,i){this.clearPass.render(e,this.renderTargetEdges),this.edgeDetectionPass.render(e,t,this.renderTargetEdges),this.weightsPass.render(e,this.renderTargetEdges,this.renderTargetWeights)}setSize(e,t){this.edgeDetectionMaterial.setSize(e,t),this.weightsMaterial.setSize(e,t),this.renderTargetEdges.setSize(e,t),this.renderTargetWeights.setSize(e,t)}dispose(){let{searchTexture:e,areaTexture:t}=this.weightsMaterial;e!==null&&t!==null&&(e.dispose(),t.dispose()),super.dispose()}static get searchImageDataURL(){return ZP}static get areaImageDataURL(){return QP}},_ge=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,q1={DEFAULT:0,ESKIL:1},bge=class extends uo{constructor({blendFunction:e=kt.NORMAL,technique:t=q1.DEFAULT,eskil:i=!1,offset:n=.5,darkness:r=.5}={}){super("VignetteEffect",_ge,{blendFunction:e,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new Fe(n)],["darkness",new Fe(r)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(e){this.technique!==e&&(this.defines.set("VIGNETTE_TECHNIQUE",e.toFixed(0)),this.setChanged())}get eskil(){return this.technique===q1.ESKIL}set eskil(e){this.technique=e?q1.ESKIL:q1.DEFAULT}getTechnique(){return this.technique}setTechnique(e){this.technique=e}get offset(){return this.uniforms.get("offset").value}set offset(e){this.uniforms.get("offset").value=e}getOffset(){return this.offset}setOffset(e){this.offset=e}get darkness(){return this.uniforms.get("darkness").value}set darkness(e){this.uniforms.get("darkness").value=e}getDarkness(){return this.darkness}setDarkness(e){this.darkness=e}},fl=class{constructor(e,t){this.enabled=!1,this.effect=new e(t),Object.defineProperty(this,"opacity",{enumerable:!0,set(i){this.effect.blendMode.opacity.value=i},get(){return this.effect.blendMode.opacity.value}}),Object.defineProperty(this,"blendFunction",{enumerable:!0,set(i){this.effect.blendMode.setBlendFunction(Number(i))},get(){return this.effect.blendMode.blendFunction}}),this.blendFunction=kt.NORMAL}},wge=class extends fl{constructor(){super(ige),this.blendFunction=kt.SCREEN}set intensity(e){this.effect.intensity=e}get intensity(){return this.effect.intensity}set luminanceThreshold(e){this.effect.luminanceMaterial.threshold=e}get luminanceThreshold(){return this.effect.luminanceMaterial.threshold}set luminanceSmoothing(e){this.effect.luminanceMaterial.smoothing=e}get luminanceSmoothing(){return this.effect.luminanceMaterial.smoothing}set blurScale(e){this.effect.blurPass.scale=e}get blurScale(){return this.effect.blurPass.scale}set kernelSize(e){this.effect.blurPass.kernelSize=e}get kernelSize(){return this.effect.blurPass.kernelSize}},Sge=class extends fl{constructor(){super(rge)}set contrast(e){this.effect.uniforms.get("contrast").value=e}get contrast(){return this.effect.uniforms.get("contrast").value}set brightness(e){this.effect.uniforms.get("brightness").value=e}get brightness(){return this.effect.uniforms.get("brightness").value}},Mge=class extends fl{constructor(){super(cge),this.effect.offset=new te(.01,.01)}set offset(e){this.effect.offset.set(e[0]/1e3,e[1]/1e3)}get offset(){return[this.effect.offset.x*1e3,this.effect.offset.y*1e3]}},Cge=class extends fl{constructor(){super(age)}},Ege=class extends fl{constructor(){super(pge),this._hue=0}set hue(e){this._hue=e,this.effect.setHue(e)}get hue(){return this._hue}set saturation(e){this.effect.uniforms.get("saturation").value=e}get saturation(){return this.effect.uniforms.get("saturation").value}},Age=class extends fl{constructor(){super(mge),this.blendFunction=kt.OVERLAY}},Tge=class extends fl{constructor(){super(bge)}get eskil(){return this.effect.eskil}set eskil(e){this.effect.eskil=e}get darkness(){return this.effect.uniforms.get("darkness").value}set darkness(e){this.effect.uniforms.get("darkness").value=e}get offset(){return this.effect.uniforms.get("offset").value}set offset(e){this.effect.uniforms.get("offset").value=e}},Pge=class extends fl{constructor(e){super(uge,e)}set focalLength(e){this.effect.circleOfConfusionMaterial.uniforms.focalLength.value=e}get focalLength(){return this.effect.circleOfConfusionMaterial.uniforms.focalLength.value}set focusDistance(e){this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value=e}get focusDistance(){return this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value}get bokehScale(){return this.effect.bokehScale}set bokehScale(e){this.effect.bokehScale=e}},Dge=class extends fl{constructor(){super(vge)}get granularity(){return this.effect.getGranularity()}set granularity(e){this.effect.setGranularity(e)}},Lge=`#define GLSLIFY 1
varying vec2 vUv;varying vec2 vTexCoords[9];uniform vec2 resolution;void main(){vUv=position.xy*0.5+0.5;vec2 texelSize=vec2(1.0)/resolution;vTexCoords[0]=vUv+vec2(-texelSize.x,-texelSize.y);vTexCoords[1]=vUv+vec2(0.0,-texelSize.y);vTexCoords[2]=vUv+vec2(texelSize.x,-texelSize.y);vTexCoords[3]=vUv+vec2(-texelSize.x,0.0);vTexCoords[4]=vUv+vec2(0.0,0.0);vTexCoords[5]=vUv+vec2(texelSize.x,0.0);vTexCoords[6]=vUv+vec2(-texelSize.x,texelSize.y);vTexCoords[7]=vUv+vec2(0.0,texelSize.y);vTexCoords[8]=vUv+vec2(texelSize.x,texelSize.y);gl_Position=vec4(position.xy,1.0,1.0);}`,Rge=`#define GLSLIFY 1
#include <common>
varying vec2 vUv;varying vec2 vTexCoords[9];uniform sampler2D inputBuffer;uniform sampler2D historyBuffer;uniform sampler2D velocityBuffer;uniform sampler2D depthBuffer;uniform vec2 resolution;
#define USE_YCOCG
#define USE_CATMULL_ROM
const float feedback_min=0.5;const float feedback_max=0.95;vec3 RGB_YCoCg(vec3 c){return vec3(c.x/4.0+c.y/2.0+c.z/4.0,c.x/2.0-c.z/2.0,-c.x/4.0+c.y/2.0-c.z/4.0);}vec3 YCoCg_RGB(vec3 c){return clamp(vec3(c.x+c.y-c.z,c.x+c.z,c.x-c.y-c.z),vec3(0.0),vec3(1.0));}vec4 sample_color(sampler2D tex,vec2 uv){
#ifdef USE_YCOCG
vec4 c=texture(tex,uv);return vec4(RGB_YCoCg(c.rgb),c.a);
#else
return texture(tex,uv);
#endif
}vec4 sample_catmull_rom(sampler2D tex,vec2 uv,vec2 texSize){vec2 samplePos=uv*texSize;vec2 texPos1=floor(samplePos-0.5)+0.5;vec2 f=samplePos-texPos1;vec2 w0=f*(-0.5+f*(1.0-0.5*f));vec2 w1=1.0+f*f*(-2.5+1.5*f);vec2 w2=f*(0.5+f*(2.0-1.5*f));vec2 w3=f*f*(-0.5+0.5*f);vec2 w12=w1+w2;vec2 offset12=w2/(w1+w2);vec2 texPos0=texPos1-1.0;vec2 texPos3=texPos1+2.0;vec2 texPos12=texPos1+offset12;texPos0/=texSize;texPos3/=texSize;texPos12/=texSize;vec4 result=vec4(0.0);result+=texture2D(tex,vec2(texPos12.x,texPos0.y))*w12.x*w0.y;result+=texture2D(tex,vec2(texPos0.x,texPos12.y))*w0.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos12.y))*w12.x*w12.y;result+=texture2D(tex,vec2(texPos3.x,texPos12.y))*w3.x*w12.y;result+=texture2D(tex,vec2(texPos12.x,texPos3.y))*w12.x*w3.y;return result;}vec3 choose_motion_vector(){
#ifdef CHOOSE_LONGEST_MOTION_VECTOR
float longest=-1.0;vec3 v_choose=vec3(-1.0);for(int i=0;i<9;i++){vec3 v=texture2D(velocityBuffer,vTexCoords[i]).rgb;float l=length(v.xy);if(l>longest){longest=l;v_choose=v;}}return v_choose;
#else
float closest_depth=1000.0;vec2 closest_uv_offset=vec2(0.0);for(int i=0;i<9;i++){float neighbor_depth=texture2D(depthBuffer,vTexCoords[i]).r;if(neighbor_depth<closest_depth){closest_uv_offset=vTexCoords[i];closest_depth=neighbor_depth;}}return texture2D(velocityBuffer,closest_uv_offset).rgb;
#endif
}vec4 clipAabb(vec3 aabb_min,vec3 aabb_max,vec4 avg,vec4 input_texel){const float FLT_EPS=0.00000001;vec3 p_clip=0.5*(aabb_max+aabb_min);vec3 e_clip=0.5*(aabb_max-aabb_min)+FLT_EPS;vec4 v_clip=input_texel-vec4(p_clip,avg.w);vec3 v_unit=v_clip.xyz/e_clip;vec3 a_unit=abs(v_unit);float ma_unit=max(a_unit.x,max(a_unit.y,a_unit.z));if(ma_unit>1.0){return vec4(p_clip,avg.w)+v_clip/ma_unit;}else{return input_texel;}}vec3 clip_aabb_variance(in vec3 cOld,in vec3 cNew,in vec3 centre,in vec3 halfSize){if(all(lessThanEqual(abs(cOld-centre),halfSize))){return cOld;}vec3 dir=(cNew-cOld);vec3 near=centre-sign(dir)*halfSize;vec3 tAll=(near-cOld)/dir;float t=0.0001;for(int i=0;i<3;i++){if(tAll[i]>=0.0&&tAll[i]<t){t=tAll[i];}}if(t>=0.0001){return cOld;}return cOld+dir*t;}void main(){vec3 v=choose_motion_vector();vec2 velocity=v.rg;vec2 previousPixelPos=vUv-velocity;vec4 currentColor=sample_color(inputBuffer,vUv);
#ifdef USE_CATMULL_ROM
vec4 previousColor=sample_catmull_rom(historyBuffer,previousPixelPos,resolution);
#else
vec4 previousColor=sample_color(historyBuffer,previousPixelPos);
#endif
#ifdef USE_YCOCG
previousColor=vec4(RGB_YCoCg(previousColor.rgb),previousColor.a);
#endif
vec4 ctl=sample_color(inputBuffer,vTexCoords[0]);vec4 ctc=sample_color(inputBuffer,vTexCoords[1]);vec4 ctr=sample_color(inputBuffer,vTexCoords[2]);vec4 cml=sample_color(inputBuffer,vTexCoords[3]);vec4 cmc=sample_color(inputBuffer,vTexCoords[4]);vec4 cmr=sample_color(inputBuffer,vTexCoords[5]);vec4 cbl=sample_color(inputBuffer,vTexCoords[6]);vec4 cbc=sample_color(inputBuffer,vTexCoords[7]);vec4 cbr=sample_color(inputBuffer,vTexCoords[8]);vec4 cmin=min(ctl,min(ctc,min(ctr,min(cml,min(cmc,min(cmr,min(cbl,min(cbc,cbr))))))));vec4 cmax=max(ctl,max(ctc,max(ctr,max(cml,max(cmc,max(cmr,max(cbl,max(cbc,cbr))))))));vec4 cavg=(ctl+ctc+ctr+cml+cmc+cmr+cbl+cbc+cbr)/9.0;vec4 cmin5=min(ctc,min(cml,min(cmc,min(cmr,cbc))));vec4 cmax5=max(ctc,max(cml,max(cmc,max(cmr,cbc))));vec4 cavg5=(ctc+cml+cmc+cmr+cbc)/5.0;cmin=0.5*(cmin+cmin5);cmax=0.5*(cmax+cmax5);cavg=0.5*(cavg+cavg5);
#ifdef USE_YCOCG
vec2 chroma_extent=vec2(0.25*0.5*(cmax.r-cmin.r));vec2 chroma_center=currentColor.gb;cmin.yz=chroma_center-chroma_extent;cmax.yz=chroma_center+chroma_extent;cavg.yz=chroma_center;
#endif
vec4 previousColorClipped=clamp(previousColor,cmin,cmax);
#ifdef LUMINANCE_DIFFERENCES
#ifdef USE_YCOCG
float lum0=currentColor.r;float lum1=previousColorClipped.r;
#else
float lum0=luminance(currentColor.rgb);float lum1=luminance(previousColorClipped.rgb);
#endif
float unbiased_diff=abs(lum0-lum1)/max(lum0,max(lum1,0.2));float unbiased_weight=1.0-unbiased_diff;float unbiased_weight_sqr=unbiased_weight*unbiased_weight;float k_feedback=mix(feedback_min,feedback_max,unbiased_weight_sqr);vec4 result=mix(currentColor,previousColorClipped,vec4(k_feedback));
#else
const float alpha=0.1;vec4 result=mix(currentColor,previousColorClipped,1.0-alpha);
#endif
#ifdef USE_YCOCG
gl_FragColor=vec4(YCoCg_RGB(result.rgb).rgb,result.a);
#else
gl_FragColor=result;
#endif
}`,Ige=`#define GLSLIFY 1
varying vec2 vUv;void main(){gl_Position=vec4(position.xy,1.0,1.0);vUv=position.xy*0.5+0.5;}`,Oge=`#define GLSLIFY 1
layout(location=1)out vec4 gVelocity;varying vec2 vUv;uniform sampler2D inputBuffer;void main(){gl_FragColor=texture2D(inputBuffer,vUv);gVelocity=vec4(0.0);}`,EM=class extends oi{constructor(){super({name:"PassthroughMaterial",uniforms:{inputBuffer:new Fe(null)},blending:Qi,depthWrite:!1,depthTest:!1,vertexShader:Ige,fragmentShader:Oge})}set inputBuffer(e){this.uniforms.inputBuffer.value=e}},Bge=class extends xr{constructor(){super("TAAResolvePass"),this.MRTCompatible=!0,this.needsSwap=!1,this.passThroughMaterial=new EM,this.resolutionVector=new te,this.resolveMaterial=new oi({name:"TAAResolveMaterial",uniforms:{inputBuffer:new Fe(null),historyBuffer:new Fe(null),velocityBuffer:new Fe(null),depthBuffer:new Fe(null),resolution:new Fe(new te)},blending:Qi,depthWrite:!1,depthTest:!1,vertexShader:Lge,fragmentShader:Rge}),this.historyRenderTarget=new Qt(1024,1024,{minFilter:Lt,stencilBuffer:!1,depthBuffer:!1}),this.historyRenderTarget.texture.name="TAA.History",this.resultRenderTarget=new Qt(1024,1024,{minFilter:Lt,stencilBuffer:!1,depthBuffer:!1}),this.resultRenderTarget.texture.name="TAA.Output"}setSize(e,t){this.historyRenderTarget.setSize(e,t),this.resultRenderTarget.setSize(e,t)}render(e,t){this.fullscreenMaterial=this.resolveMaterial,this.resolveMaterial.uniforms.inputBuffer.value=t.texture[0],this.resolveMaterial.uniforms.velocityBuffer.value=t.texture[1],this.resolveMaterial.uniforms.depthBuffer.value=t.depthTexture,this.resolveMaterial.uniforms.historyBuffer.value=this.historyRenderTarget.texture,this.resolveMaterial.uniforms.resolution.value.set(t.width,t.height),e.setRenderTarget(this.resultRenderTarget),e.render(this.scene,this.camera),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(this.historyRenderTarget),e.render(this.scene,this.camera);let i=this.renderToScreen?null:t;this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=this.resultRenderTarget.texture,e.setRenderTarget(i),e.render(this.scene,this.camera)}dispose(){this.resultRenderTarget.dispose(),this.historyRenderTarget.dispose(),this.resolveMaterial.dispose(),this.passThroughMaterial.dispose()}},Nge=class extends xr{constructor(e,t,i){super("TransmissionPass",void 0,t),this.MRTCompatible=!0,this.depthPass=new qP(e,t,{renderTarget:i.transmissionDepthTarget}),this.passThroughMaterial=new EM,this.splineScene=e,this.needsSwap=!1}updatePasses(e){this.passThroughMaterial=new EM,this.depthPass=new qP(this.splineScene,this.camera,{renderTarget:e.transmissionDepthTarget})}setCamera(e){this.camera=e}setScene(e){this.splineScene=e}render(e,t,i){let n=this.camera.layers.mask,r=e;r.setRenderTarget(r.transmissionRenderTarget),this.fullscreenMaterial=this.passThroughMaterial,this.passThroughMaterial.inputBuffer=t.texture[0],r.clear(),r.render(this.scene,this.camera),this.camera.layers.disable(3),this.depthPass.render(e,t,i),r.shadowMap.needsUpdate=!1,r.shadowMap.autoUpdate=!1;let s=this.renderToScreen?null:t;this.camera.layers.set(3),e.setRenderTarget(s),e.render(this.splineScene,this.camera),this.camera.layers.mask=n}},KP=new gc,Uge=new oi({transparent:!0,vertexShader:`
        void main() {
            gl_Position = vec4(0.0);
        }
    `,fragmentShader:`
        layout(location = 1) out vec4 gVelocity;

        void main() {
            gl_FragColor = vec4(0.0);
			gVelocity = vec4(0.0);
        }
    `}),AM=class extends xr{constructor(e,t,i){super("OpaquePass",t??KP,i),this.MRTCompatible=!0,this.hasTransmissionPass=!1,this.clear=!0,this.clearColorOnly=!1,this.clearDepth=!1,this.needsSwap=!1,this.originalMaterials=new Map,this.MRTCompatible=e}setCamera(e){this.camera=e}setScene(e){this.scene=e??KP}getScene(){return this.scene}render(e,t){this.camera.layers.enable(3),this.hasTransmissionPass&&(this.originalMaterials.clear(),this.scene.traverse(n=>{n.layers.isEnabled(3)&&n instanceof zr&&(this.originalMaterials.set(n.id,n.material),n.material=Uge)}),e.shadowMap.needsUpdate=!0,e.shadowMap.autoUpdate=!0),this.camera.layers.enable(8);let i=this.renderToScreen?null:t;e.setRenderTarget(i),this.clearColorOnly&&e.clear(!0,!1,!0),this.clear&&e.clear(),e.render(this.scene,this.camera),this.clearDepth&&e.clear(!1,!0,!1),this.hasTransmissionPass&&this.originalMaterials.forEach((n,r)=>{let s=this.scene.getObjectById(r);s&&(s.material=n)})}},Fge=class{constructor(e,{depthBuffer:t=!0,stencilBuffer:i=!1,multisampling:n=0,frameBufferType:r=0}={}){this.renderer=e,this.helperStartIndex=0,this.copyPass=new CM,this.depthTexture=null,this.timer=new ege,this._width=1,this._height=1,this.passes=[],this.helperPasses=[],this.autoRenderToScreen=!0,this.inputBuffer=this.createBuffer(t,i,r,n,!0,"input buffer mrt"),this.inputBufferSingle=this.createBuffer(t,i,r,n,!1," input buffer single"),this.inputBufferSingle.texture.dispose(),this.inputBufferSingle.depthTexture.dispose(),this.inputBufferSingle.texture=this.inputBuffer.texture[0],this.inputBufferSingle.depthTexture=this.inputBuffer.depthTexture,this.outputBuffer=this.inputBuffer.clone(),this.outputBuffer.name="output buffer mrt",this.outputBufferSingle=this.createBuffer(t,i,r,n,!1,"output buffer single"),this.outputBufferSingle.texture.dispose(),this.outputBufferSingle.depthTexture.dispose(),this.outputBufferSingle.texture=this.outputBuffer.texture[0],this.outputBufferSingle.depthTexture=this.outputBuffer.depthTexture,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){let t=this.inputBuffer,i=this.multisampling;i>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):i!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("creating new input buffer"),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e,!0,"new input buffer"),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){var t;if(this.renderer=e,e!==null){let i=e.getSize(new te),n=((t=e.getContext().getContextAttributes())==null?void 0:t.alpha)??!1,r=this.inputBuffer.texture[0].type;r===Zn&&e.outputEncoding===Mt&&(this.inputBuffer.texture[0].encoding=Mt,this.outputBuffer.texture[0].encoding=Mt,this.inputBuffer.dispose(),this.outputBuffer.dispose(),console.log("doing some kinda dispose??")),e.autoClear=!1,this.setSize(i.width,i.height,!1);for(let s of this.passes)s.initialize(e,n,r)}}replaceRenderer(e,t=!0){let i=this.renderer,n=i.domElement.parentNode;return this.setRenderer(e),t&&n!==null&&(n.removeChild(i.domElement),n.appendChild(e.domElement)),i}createDepthTexture(){let e=this.depthTexture=new wp(this._width,this._height);return this.inputBuffer.depthTexture=e,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(e.format=Wh,e.type=Ah):e.type=Ql,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(let e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,i,n,r,s){let a=this.renderer,o=a===null?new te:a.getDrawingBufferSize(new te),l={minFilter:Lt,magFilter:Lt,wrapS:Fi,wrapT:Fi,stencilBuffer:t,depthBuffer:e},c;return n>0?(c=new Qt(o.width,o.height,l),c.samples=n):(r?(c=new vQ(o.width,o.height,2,l),c.texture[1].type=_p):c=new Qt(o.width,o.height,l),c.depthTexture=new wp(2048,2048),c.depthTexture.type=es),i===Zn&&a!==null&&a.outputEncoding===Mt&&(Array.isArray(c.texture)?c.texture.forEach(u=>u.encoding=Mt):c.texture.encoding=Mt),Array.isArray(c.texture)?c.texture.forEach((u,h)=>{u.name=`EffectComposer.Buffer ${r} ${h}`,u.generateMipmaps=!1}):(c.texture.name=`EffectComposer.Buffer ${r}`,c.texture.generateMipmaps=!1),c.name=s,c}addPass(e,t){var o;let i=this.passes,n=this.renderer,r=n.getDrawingBufferSize(new te),s=((o=n.getContext().getContextAttributes())==null?void 0:o.alpha)??!1,a;if(e.MRTCompatible&&(a=this.inputBuffer.texture[0].type),e.MRTCompatible||(a=this.inputBuffer.texture.type),e.setRenderer(n),e.setSize(r.width,r.height),e.initialize(n,s,a),this.autoRenderToScreen&&(i.length>0&&(i[i.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),t!==void 0?i.splice(t,0,e):i.push(e),this.autoRenderToScreen&&(i[i.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){let l=this.createDepthTexture();for(e of i)e.setDepthTexture(l)}else e.setDepthTexture(this.depthTexture)}setHelperStartIndex(e){this.helperStartIndex=e}removePass(e){let t=this.passes,i=t.indexOf(e);if(i!==-1&&t.splice(i,1).length>0){if(this.depthTexture!==null){let n=(r,s)=>r||s.needsDepthTexture;t.reduce(n,!1)||(e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&i===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){let e=this.passes;this.deleteDepthTexture(),e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){let t=this.renderer,i=this.copyPass,n=this.inputBuffer,r=this.outputBuffer,s=this.inputBufferSingle,a=this.outputBufferSingle,o=!1,l,c,u,h;e===void 0&&(e=this.timer.update().getDelta());for(let d of this.passes)d.enabled&&(d.MRTCompatible?d.render(t,n,r,e,o):d.render(t,s,a,e,o),d.needsSwap&&(o&&(i.renderToScreen=d.renderToScreen,l=t.getContext(),c=t.state.buffers.stencil,c.setFunc(l.NOTEQUAL,1,4294967295),i.render(t,n,r,e,o),c.setFunc(l.EQUAL,1,4294967295)),u=n,h=s,n=r,s=a,r=u,a=h),d instanceof $0e?o=!0:d instanceof A0e&&(o=!1))}setSize(e,t,i){let n=this.renderer;if(this._width=e,this._height=t,e===void 0||t===void 0){let s=n.getSize(new te);e=s.width,t=s.height}n.setSize(e,t,i);let r=n.getDrawingBufferSize(new te);this.inputBuffer.setSize(r.width,r.height),this.outputBuffer.setSize(r.width,r.height),this.inputBufferSingle.setSize(r.width,r.height),this.outputBufferSingle.setSize(r.width,r.height);for(let s of this.passes)s.setSize(r.width,r.height)}reset(){let e=this.timer.isAutoResetEnabled();this.dispose(),this.autoRenderToScreen=!0,this.timer.setAutoResetEnabled(e)}dispose(){for(let e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.inputBufferSingle!==null&&this.inputBufferSingle.dispose(),this.outputBufferSingle!==null&&this.outputBufferSingle.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose()}},zge=new oi({name:"CombineMaterial",uniforms:{inputBufferA:new Fe(null),inputBufferB:new Fe(null)},blending:Qi,depthWrite:!1,depthTest:!1,vertexShader:`
varying vec2 vUv;
void main() {
    gl_Position = vec4(position.xy, 1.0, 1.0);
    vUv = position.xy * 0.5 + 0.5;
}
`,fragmentShader:`
    varying vec2 vUv;
    uniform sampler2D inputBufferA;
    uniform sampler2D inputBufferB;

    // TODO: Why do we need these when postpro of framemode is enabled???
    layout(location = 1) out vec4 gVelocity;

    void main() {
	vec4 resA = texture2D(inputBufferA, vUv);
	vec4 resB = texture2D(inputBufferB, vUv);
    float a = resA.a + resB.a * ( 1.0 - resA.a );

	vec4 res;
	res.rgb =  resA.rgb + (resB.rgb * (1.0 - resA.a));
	res.a = resA.a + resB.a * (1.0 - resA.a);
	gl_FragColor = res;
    gVelocity = vec4(0.0);
    }
`}),kge=class extends xr{constructor(e){super("HelperPass",void 0,e),this.MRTCompatible=!1,this.fullscreenMaterial=zge,this.helperPass=new AM(!1,void 0,this.camera),this.helperPass.hasTransmissionPass=!1,this.helperPass.clear=!1,this.helperPass.renderToScreen=!1,this.helperPassOnTop=new AM(!1,void 0,this.camera),this.helperPassOnTop.hasTransmissionPass=!1,this.helperPassOnTop.clear=!1,this.helperPassOnTop.renderToScreen=!1;let t=new XF({preset:fh.LOW,edgeDetectionMode:C2.COLOR});this.effectPass=new xx(this.camera,t),this.rt=new Qt(10,10,{minFilter:Lt,magFilter:Lt,wrapS:Fi,wrapT:Fi,depthBuffer:!0})}setSize(e,t){this.rt.setSize(e,t),this.effectPass.setSize(e,t)}set sceneHelpers(e){this.helperPass.setScene(e)}get sceneHelpers(){return this.helperPass.getScene()}set sceneHelpersOnTop(e){this.helperPassOnTop.setScene(e)}get sceneHelpersOnTop(){return this.helperPassOnTop.getScene()}setCamera(e){this.helperPass.setCamera(e),this.helperPassOnTop.setCamera(e)}initialize(e,t,i){super.initialize(e,t,i),this.effectPass.initialize(e,t,i)}dispose(){super.dispose(),this.rt.dispose(),this.effectPass.dispose()}render(e,t,i){this.rt.depthTexture=t.depthTexture;let n=e.getClearAlpha();e.setClearAlpha(0),this.helperPass.clearDepth=!0,this.helperPass.clearColorOnly=!0,this.helperPass.render(e,this.rt),this.helperPassOnTop.render(e,this.rt),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.rt,i),this.fullscreenMaterial.uniforms.inputBufferA.value=i.texture,this.fullscreenMaterial.uniforms.inputBufferB.value=t.texture,e.setClearAlpha(n),e.setRenderTarget(null),e.clear(),e.render(this.scene,this.camera)}},Vge=`#define GLSLIFY 1
#include <skinning_pars_vertex>
out vec3 n;void main(){
#include <beginnormal_vertex>
#include <skinbase_vertex>
#include <skinnormal_vertex>
#include <defaultnormal_vertex>
#include <begin_vertex>
#include <skinning_vertex>
vec4 view_space=viewMatrix*modelMatrix*vec4(transformed,1.0);gl_Position=projectionMatrix*view_space;n=normalize(transformedNormal);}`,Hge=`#define GLSLIFY 1
in vec3 n;void main(){gl_FragColor=vec4(n,1.0);}`,Gge=`#define GLSLIFY 1
out vec2 v_uv;void main(){v_uv=uv;gl_Position=vec4(position.xy,1.0,1.0);}`,jge=`#define GLSLIFY 1
in vec2 v_uv;const float pi=3.14159265;const float num_steps=4.0;const float num_directions=4.0;uniform float near;uniform float far;uniform float fov;uniform vec4 proj_info;uniform bool is_ortho;uniform vec2 resolution;uniform float radius_of_influence;uniform float radius_in_screen_space;uniform float exponent;uniform vec3 ao_color;uniform float bias;uniform sampler2D texture_depth;uniform sampler2D texture_normals;uniform sampler2D texture_blue_noise;uniform sampler2D texture_blue_noise_in_disk;uniform sampler2D texture_color_pass;uniform int frame_index;uniform bool fog_enabled;uniform float fog_near;uniform float fog_far;vec3 uv_to_view_space(vec2 uv,float eye_z){return vec3((uv*proj_info.xy+proj_info.zw)*(is_ortho ? 1.0 : eye_z),eye_z);}float linearize_depth(float depth_sampled){float z=is_ortho ? depth_sampled : depth_sampled*2.0-1.0;return mix((2.0*near*far)/(far+near-z*(far-near)),near+z*(far-near),float(is_ortho));}vec3 get_view_position(vec2 uv_coords){float linear_depth=linearize_depth(texture(texture_depth,uv_coords).x);return uv_to_view_space(uv_coords,linear_depth);}vec3 min_difference(vec3 p,vec3 right,vec3 left){vec3 v1=right-p;vec3 v2=p-left;return(dot(v1,v1)<dot(v2,v2))? v1 : v2;}vec3 rebuild_normal(in vec2 uv,in vec3 p){vec2 one_over_resolution=1.0/resolution;vec3 r=get_view_position(uv+vec2(one_over_resolution.x,0));vec3 l=get_view_position(uv+vec2(-one_over_resolution.x,0));vec3 t=get_view_position(uv+vec2(0,one_over_resolution.y));vec3 b=get_view_position(uv+vec2(0,-one_over_resolution.y));return normalize(cross(min_difference(p,r,l),min_difference(p,t,b)));}float falloff(float distance_squared){float neg_inv_r2=-1.0/(radius_of_influence*radius_of_influence);return distance_squared*neg_inv_r2+1.0;}float ao_contribution(vec3 P,vec3 N,vec3 S){vec3 to_sample=S-P;float norm_squared=dot(to_sample,to_sample);float norm=sqrt(norm_squared);float cos_theta=dot(N,to_sample)/norm;return clamp(cos_theta-bias,0.0,1.0)*clamp(falloff(norm_squared),0.0,1.0);}float compute_ambient_occlusion(vec2 uv,float radius_in_screen_space,vec3 pc,vec3 view_space_n){vec2 one_over_resolution=1.0/resolution;ivec2 noise_uv=ivec2(int(mod(gl_FragCoord.x,128.0)),int(mod(gl_FragCoord.y,128.0)));float noise=texelFetch(texture_blue_noise,noise_uv,0).r;noise=fract(noise+0.61803398875*float(frame_index));float theta=noise*2.0*3.1415;float ct=cos(theta);float st=sin(theta);float step_size=radius_in_screen_space/(num_steps+1.0);const float angle_step=2.0*pi/num_directions;float contribution=0.0;for(int i=0;i<int(num_directions);++i){float current_pixel=step_size+1.0;for(int j=0;j<int(num_steps);++j){int index=i*int(num_steps)+j;vec2 blue_noise_sample=texelFetch(texture_blue_noise_in_disk,ivec2(index,0),0).rg;vec2 disk_point;disk_point.x=blue_noise_sample.x*ct-blue_noise_sample.y*st;disk_point.y=blue_noise_sample.x*st+blue_noise_sample.y*ct;vec2 sample_direction=disk_point;vec2 snapped_uv=round(current_pixel*sample_direction)*one_over_resolution+uv;vec3 ps=get_view_position(snapped_uv);current_pixel+=step_size;contribution+=ao_contribution(pc,view_space_n,ps);}}float mult=1.0/(1.0-bias);contribution*=mult/(num_directions*num_steps);return clamp(1.0-contribution*2.0,0.0,1.0);}
#define USE_GBUFFER_NORMALS
void main(){vec3 view_space_p=get_view_position(v_uv);
#ifdef USE_GBUFFER_NORMALS
vec3 view_space_n=texture(texture_normals,v_uv).rgb;view_space_n.z*=-1.0;
#else
vec3 view_space_n=-rebuild_normal(v_uv,view_space_p);
#endif
float radius_ss=radius_in_screen_space/(is_ortho ? 1.0 : view_space_p.z);float ao=compute_ambient_occlusion(v_uv,radius_ss,view_space_p,view_space_n);float final=pow(ao,exponent);if(view_space_p.z>=far){final=1.0;}vec3 color=mix(ao_color,vec3(1.0),final);if(fog_enabled){float fog_factor=smoothstep(fog_near,fog_far,view_space_p.z);color=mix(color,vec3(1.0),fog_factor);}gl_FragColor=vec4(color,1.0);}`,Wge=`#define GLSLIFY 1
out vec2 v_uv;void main(){gl_Position=vec4(position.xy,1.0,1.0);v_uv=uv;}`,Xge=`#define GLSLIFY 1
in vec2 v_uv;uniform sampler2D texture_ao_lrez;uniform sampler2D texture_depth_lrez;uniform sampler2D texture_depth_hrez;uniform float near;uniform float far;float linearize_depth(float depth_sampled){float z=depth_sampled*2.0-1.0;return(2.0*near*far)/(far+near-z*(far-near));}vec2 nearest_depth_filter(in vec2 uv){vec2 resolution=vec2(textureSize(texture_depth_lrez,0));vec2 texel_size=1.0/resolution;vec2 offset=uv-0.5*texel_size;float d_hrez=texture(texture_depth_hrez,uv).r;float a=abs(d_hrez-texture(texture_depth_lrez,offset).r);float b=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,0.0)).r);float c=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(0.0,texel_size.y)).r);float d=abs(d_hrez-texture(texture_depth_lrez,offset+vec2(texel_size.x,texel_size.y)).r);float min_diff=min(a,min(b,min(c,d)));if(min_diff==a)return offset;if(min_diff==b)return offset+vec2(texel_size.x,0.0);if(min_diff==c)return offset+vec2(0.0,texel_size.y);if(min_diff==d)return offset+vec2(texel_size.x,texel_size.y);}void main(){
#ifdef DEBUG
float d_lrez=texture(texture_depth_lrez,v_uv).r;float d_hrez=texture(texture_depth_hrez,v_uv).r;float output_d=mix(linearize_depth(d_lrez)/far,linearize_depth(d_hrez)/far,step(0.5,v_uv.x));gl_FragColor=vec4(vec3(output_d),1.0);
#else
vec2 filtered_uv=nearest_depth_filter(v_uv);vec4 ao=texture(texture_ao_lrez,filtered_uv);gl_FragColor=vec4(ao.rgb,1.0);gl_FragColor=ao;
#endif
}`,Xf=[[.478712,.875764],[-.337956,-.793959],[-.955259,-.028164],[.864527,.325689],[.209342,-.395657],[-.106779,.672585],[.156213,.235113],[-.413644,-.082856],[-.415667,.323909],[.141896,-.93998],[.954932,-.182516],[-.766184,.410799],[-.434912,-.458845],[.415242,-.078724],[.728335,-.491777],[-.058086,-.066401],[.20299,.686837],[-.808362,-.556402],[.507386,-.640839],[-.723494,-.22924],[.48974,.317826],[-.622663,.765301],[-.01064,.929347],[.663146,.647618],[-.096674,-.413835],[.525945,-.321063],[-.122533,.366019],[.195235,-.687983],[-.563203,.098748],[.418563,.561335],[-.378595,.800367],[.826922,.001024],[-.085372,-.766651],[-.92192,.183673],[-.590008,-.721799],[.167751,-.164393],[.032961,-.56253],[.6329,-.107059],[-.46408,.569669],[-.173676,-.958758],[-.242648,-.234303],[-.275362,.157163],[.382295,-.795131],[.562955,.115562],[.190586,.470121],[.770764,-.297576],[.237281,.93105],[-.666642,-.455871],[-.905649,-.298379],[.33952,.157829],[.701438,-.7041],[-.062758,.160346],[-.220674,.957141],[.642692,.432706],[-.77339,-.015272],[-.671467,.24688],[.158051,.062859],[.806009,.527232],[-.05762,-.247071],[.333436,-.51671],[-.550658,-.315773],[-.652078,.589846],[.008818,.530556],[-.210004,.519896]],qge=new oi({vertexShader:Vge,fragmentShader:Hge}),Y1=new oi({vertexShader:Wge,fragmentShader:Xge,uniforms:{texture_ao_lrez:new Fe(null),texture_depth_lrez:new Fe(null),texture_depth_hrez:new Fe(null),near:new Fe(null),far:new Fe(null)}}),Yge=class extends xr{constructor(e,t){super("AmbientOcclusionPass",void 0,t),this.fogEnabled=!1,this.fogNear=1,this.fogFar=1e3,this.frameIndex=0,this._runHalfRes=!0,this._width=1,this._height=1;let i=1024,n=1024;this.gBuffer=new Qt(i,n,{type:es,depthTexture:new wp(i,n),minFilter:Lt,magFilter:Lt}),this.depthBufferHighRes=new Qt(i,n,{depthTexture:new wp(i,n)}),this.aoBuffer=new Qt(i,n,{minFilter:Lt,magFilter:Lt}),this.splineScene=e,this.splineCamera=t;let r=new Float32Array(Xf.length*2);for(let a=0;a<Xf.length;a++){let o=a*2;r[o+0]=Xf[a][0],r[o+1]=Xf[a][1]}this.blueNoiseInDiskTexture=new By(r,Xf.length,1,MB,es),this.blueNoiseInDiskTexture.wrapS=Zo,this.blueNoiseInDiskTexture.wrapT=Zo,this.blueNoiseInDiskTexture.needsUpdate=!0,this.hbaoMaterial=new oi({vertexShader:Gge,fragmentShader:jge,uniforms:{near:new Fe(null),far:new Fe(null),fov:new Fe(null),proj_info:new Fe(new Ct),is_ortho:new Fe(!1),resolution:new Fe(new te),radius_of_influence:new Fe(8),radius_in_screen_space:new Fe(1),exponent:new Fe(1),ao_color:new Fe(new T),bias:new Fe(.5),texture_depth:new Fe(null),texture_normals:new Fe(null),texture_blue_noise:new Fe(null),texture_blue_noise_in_disk:new Fe(this.blueNoiseInDiskTexture),frame_index:new Fe(0),fog_enabled:new Fe(!1),fog_near:new Fe(1),fog_far:new Fe(1e3)}}),this.radius=128,this.aoColor={r:0,g:0,b:0},this.bias=.5,this.hbaoMaterial.uniforms.texture_depth.value=this.gBuffer.depthTexture,this.hbaoMaterial.uniforms.texture_normals.value=this.gBuffer.texture,this.needsSwap=!0,this.aaBuffer=new Qt(i,n,{minFilter:Lt,magFilter:Lt,wrapS:Fi,wrapT:Fi,depthBuffer:!1,type:es});let s=new XF({preset:fh.ULTRA,edgeDetectionMode:C2.COLOR});this.effectPass=new xx(this.camera,s)}initialize(e,t,i){super.initialize(e,t,i),this.effectPass.initialize(e,t,i)}setBlueNoiseTexture(e){this.hbaoMaterial.uniforms.texture_blue_noise.value=e}setSize(e,t){this._width=e,this._height=t,this.depthBufferHighRes.setSize(e,t);let i=this._runHalfRes?.5:1,n=e*i,r=t*i;this.gBuffer.setSize(n,r),this.aoBuffer.setSize(n,r),this.hbaoMaterial.uniforms.resolution.value.set(n,r),this.aaBuffer.setSize(n,r),this.effectPass.setSize(n,r)}get runHalfRes(){return this._runHalfRes}set runHalfRes(e){this._runHalfRes=e,this.setSize(this._width,this._height)}setCamera(e){this.splineCamera=e}setScene(e){this.splineScene=e}render(e,t,i){this.splineScene.overrideMaterial=qge;let n=this.splineCamera.layers.mask;if(this.splineCamera.layers.set(5),e.setRenderTarget(this.gBuffer),e.clear(),e.render(this.splineScene,this.splineCamera),e.setRenderTarget(this.depthBufferHighRes),e.clear(),e.render(this.splineScene,this.splineCamera),this.splineScene.overrideMaterial=null,this.splineCamera.layers.mask=n,this.hbaoMaterial.uniforms.radius_of_influence.value=this.radius,this.hbaoMaterial.uniforms.ao_color.value.set(this.aoColor.r,this.aoColor.g,this.aoColor.b),this.hbaoMaterial.uniforms.bias.value=this.bias,this.hbaoMaterial.uniforms.fog_enabled.value=this.fogEnabled,this.hbaoMaterial.uniforms.fog_near.value=this.fogNear,this.hbaoMaterial.uniforms.fog_far.value=this.fogFar,this.hbaoMaterial.uniforms.frame_index.value=this.frameIndex,this.frameIndex++,this.splineCamera.isPerspectiveCamera){this.hbaoMaterial.uniforms.near.value=this.splineCamera.perspCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.perspCamera.far;let r=this.splineCamera.perspCamera.projectionMatrix.elements,s=2/r[0],a=2/r[5],o=-(1-r[8])/r[0],l=-(1+r[9])/r[5];this.hbaoMaterial.uniforms.proj_info.value.set(s,a,o,l);let c=this.splineCamera.perspCamera.fov*(Math.PI/180),u=this.hbaoMaterial.uniforms.resolution.value.y/(Math.tan(c*.5)*2),h=this.hbaoMaterial.uniforms.radius_of_influence.value*.5*u;this.hbaoMaterial.uniforms.radius_in_screen_space.value=h,this.hbaoMaterial.uniforms.is_ortho.value=!1}else{this.hbaoMaterial.uniforms.near.value=this.splineCamera.orthoCamera.near,this.hbaoMaterial.uniforms.far.value=this.splineCamera.orthoCamera.far;let r=this.splineCamera.orthoCamera.projectionMatrix.elements,s=2/r[0],a=2/r[5],o=-(1+r[12])/r[0],l=-(1-r[13])/r[5];this.hbaoMaterial.uniforms.proj_info.value.set(s,a,o,l);let c=.5*(this.hbaoMaterial.uniforms.resolution.value.y/a),u=this.hbaoMaterial.uniforms.radius_of_influence.value*c;this.hbaoMaterial.uniforms.radius_in_screen_space.value=u,this.hbaoMaterial.uniforms.is_ortho.value=!0}this.runHalfRes?(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aoBuffer),e.clear(),e.render(this.scene,this.camera),this.fullscreenMaterial=Y1,Y1.uniforms.texture_ao_lrez.value=this.aoBuffer.texture,Y1.uniforms.texture_depth_lrez.value=this.gBuffer.depthTexture,Y1.uniforms.texture_depth_hrez.value=this.depthBufferHighRes.depthTexture,e.setRenderTarget(e.aoRenderTarget),e.clear(),e.render(this.scene,this.camera)):(this.fullscreenMaterial=this.hbaoMaterial,e.setRenderTarget(this.aaBuffer),e.clear(),e.render(this.scene,this.camera),this.effectPass.renderToScreen=!1,this.effectPass.render(e,this.aaBuffer,e.aoRenderTarget))}dispose(){this.gBuffer.dispose(),this.depthBufferHighRes.dispose(),this.aoBuffer.dispose()}},Zge=`
varying vec2 vUv;
void main() {
    vUv = uv;
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Qge=`
uniform sampler2D tInput;
uniform sampler2D tMap;
uniform vec2 resolution;
varying vec2 vUv;

uniform vec2 uResolution;
uniform vec2 uCoords;

// Draws a rectangle at center <st> with size <size>
float rectangle(vec2 st, vec2 size) {
    size = vec2(0.5) - size * 0.5;
    vec2 uv = vec2(step(size.x, st.x), step(size.y, st.y));
    uv *= vec2(step(size.x, 1.0 - st.x), step(size.y, 1.0 - st.y));

    return uv.x * uv.y;
}

uniform vec2 uSize;
uniform float uScale;
uniform float uDPR;
uniform float uCurrent;
uniform vec3 uSceneColor;

void main() {
    vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
    screenUv *= 1.0 / uDPR;

    vec2 center = vec2(0.5, -0.5);
    vec2 outsideUv = screenUv;
    outsideUv += center;
    outsideUv -= uCoords.xy / uResolution.xy;
    outsideUv = (outsideUv - 0.5) + 0.5;
    outsideUv -= center;
    vec2 s = (uSize / uResolution) * uScale;
    float isOutside = 1.0 - rectangle(outsideUv, s);
    
    vec2 mid = vec2(0.5);
    vec2 insideUv = (screenUv - mid + s * mid) / s;
    vec4 background = texture2D(tInput, screenUv);
    vec4 image = texture2D(tMap, insideUv);
    gl_FragColor = mix(image, background, isOutside);
}
`,Kge=class extends Va{constructor(){super(new oi({vertexShader:Zge,fragmentShader:Qge,uniforms:{tInput:new Fe(null),tMap:new Fe(null),uResolution:new Fe(new te),uSize:new Fe(new te),uCoords:new Fe(new te),uScale:new Fe(1),uSceneColor:new Fe(new ut(16711680)),uDPR:new Fe(1),uCurrent:new Fe(0)}}),"tInput"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.tMap.value}set texture(e){this.uniforms.tMap.value=e}},$ge=`
void main() {
    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Jge=`
uniform sampler2D toScene;
uniform sampler2D fromScene;
uniform vec2 resolution;

uniform vec2 uResolution;
uniform float uDPR;

uniform float mixRatio;
uniform sampler2D tMixTexture;
uniform int useTexture;
uniform float threshold;

void main() {
	vec2 screenUv = gl_FragCoord.xy / uResolution.xy;
	screenUv *= 1.0 / uDPR;

	vec4 texel1 = texture2D( fromScene, screenUv );
	vec4 texel2 = texture2D( toScene, screenUv );

	if (useTexture==1) {
		
		vec4 transitionTexel = texture2D( tMixTexture, screenUv );
		float r = mixRatio * (1.0 + threshold * 2.0) - threshold;
		float mixf=clamp((transitionTexel.r - r)*(1.0/threshold), 0.0, 1.0);
		
		gl_FragColor = mix( texel1, texel2, mixf );
	} else {
		
		gl_FragColor = mix( texel1, texel2, mixRatio );
		
	}
}
`,e1e=[],t1e=class extends Va{constructor(){super(new oi({vertexShader:$ge,fragmentShader:Jge,uniforms:{toScene:new Fe(null),fromScene:new Fe(null),uResolution:new Fe(new te),uDPR:new Fe(1),mixRatio:new Fe(0),threshold:new Fe(.1),useTexture:new Fe(0),tMixTexture:{value:e1e[0]}}}),"toScene"),this.needsSwap=!0}get uniforms(){return this.fullscreenMaterial.uniforms}get texture(){return this.uniforms.fromScene.value}set texture(e){this.uniforms.fromScene.value=e}};function $P(e,t){return t&&t.enabled&&e.push(t.effect),e}var i1e=e=>Object.values(kt).includes(e)?e:kt.NORMAL,n1e=class extends In{constructor(e){super(),this.postprocessingState=ax.defaultData,this._scene=new gc,this._camera=new qn,this.effects=new Map,this.blueNoiseTexture=new By,this._renderToScreen=!0,this.clock=new aie,this.renderer=e,this.debug=!1,this.effects.set("bloom",new wge),this.effects.set("chromaticAberration",new Mge),this.effects.set("vignette",new Tge),this.effects.set("noise",new Age),this.effects.set("colorAverage",new Cge),this.effects.set("hueSaturation",new Ege),this.effects.set("brightnessContrast",new Sge),this.effects.set("depthOfField",new Pge),this.effects.set("pixelation",new Dge),this.effectComposer=new Fge(this.renderer),this.effectComposer.autoRenderToScreen=!1,this.opaquePass=new AM(!0,this.scene,this.camera),this.opaquePass.clear=!0,this.transmissionPass=new Nge(this.scene,this.camera,this.renderer),this.aoPass=new Yge(this.scene,this.camera),this.taaPass=new Bge,this.taaPass.renderToScreen=!1,this.helperPass=new kge(this.camera),this.helperPass.renderToScreen=!1,this.overlayPass=new Kge,this.overlayPass.enabled=!1,this.sceneTransitionPass=new t1e,this.sceneTransitionPass.enabled=!1,this._initCopyPass(),this._initPasses()}set overlayTexture(e){e!==void 0?(this.overlayPass.texture=e,this.overlayPass.enabled=!0):this.overlayPass.enabled=!1}get overlayTexture(){return this.overlayPass.texture}set sceneHelpers(e){this.helperPass.sceneHelpers=e}get sceneHelpers(){return this.helperPass.sceneHelpers}set sceneHelpersOnTop(e){this.helperPass.sceneHelpersOnTop=e}get sceneHelpersOnTop(){return this.helperPass.sceneHelpersOnTop}get scene(){return this._scene}set scene(e){this._scene=e,this.opaquePass.setScene(e),this.transmissionPass.setScene(e),this.aoPass.setScene(e)}get camera(){return this._camera}set camera(e){this._camera=e,this.opaquePass.setCamera(e),this.transmissionPass.setCamera(e),this.aoPass.setCamera(e),this.helperPass.setCamera(e)}updateRenderToScreen(){let e=!1;for(let t=this.effectComposer.passes.length-1;t>=0;t--){let i=this.effectComposer.passes[t];if(i.enabled===!0&&!e&&this._renderToScreen){i.renderToScreen=!0,e=!0;continue}i.renderToScreen=!1}}disableHelpers(){this.helperPass.enabled=!1,this.updateRenderToScreen()}enableHelpers(){this.helperPass.enabled=!0,this.updateRenderToScreen()}updateBlueNoiseTexture(e){this.blueNoiseTexture=new By(e,128,128),this.blueNoiseTexture.wrapS=Zo,this.blueNoiseTexture.wrapT=Zo,this.blueNoiseTexture.minFilter=ai,this.blueNoiseTexture.magFilter=ai,this.blueNoiseTexture.needsUpdate=!0}setAmbientOcclusionParams(e,t,i,n,r,s,a,o){this.aoPass.enabled=e,this.aoPass.radius=t,this.aoPass.bias=i,this.aoPass.aoColor=n,this.aoPass.fogEnabled=r,this.aoPass.fogNear=s,this.aoPass.fogFar=a,this.aoPass.runHalfRes!==!o&&(this.aoPass.runHalfRes=!o)}setTransmissionPassEnabled(e){this.transmissionPass.enabled=e,this.opaquePass.hasTransmissionPass=e}_initPasses(){var e,t;if((e=this.uvEffectPass)==null||e.dispose(),(t=this.effectPass)==null||t.dispose(),this.effectComposer.removeAllPasses(),this.transmissionPass.updatePasses(this.renderer),this.effectComposer.addPass(this.aoPass),this.effectComposer.addPass(this.opaquePass),this.effectComposer.addPass(this.transmissionPass),this.effectComposer.addPass(this.taaPass),this.postprocessingState.enabled){let i=[this.effects.get("pixelation")].reduce($P,[]);i.length>0&&(this.uvEffectPass=new xx(this.camera,...i),this.uvEffectPass.renderToScreen=!1,this.effectComposer.addPass(this.uvEffectPass));let n=[this.effects.get("chromaticAberration"),this.effects.get("bloom"),this.effects.get("colorAverage"),this.effects.get("hueSaturation"),this.effects.get("brightnessContrast"),this.effects.get("vignette"),this.effects.get("noise")].reduce($P,[]);n.length>0&&(this.effectPass=new xx(this.camera,...n),this.effectPass.renderToScreen=!1,this.effectComposer.addPass(this.effectPass))}this.effectComposer.addPass(this.overlayPass),this.effectComposer.addPass(this.sceneTransitionPass),this.effectComposer.addPass(this.helperPass)}_initCopyPass(){if(this._savePass)return;let e=new te;this.renderer.getDrawingBufferSize(e),this._rt=new Qt(e.x,e.y,{depthBuffer:!1,stencilBuffer:!1,wrapS:Zo,wrapT:Zo}),this._rt.samples=0,this._savePass=new CM(this._rt,!1),this._savePass.renderToScreen=!1}setCopyPass(e){this._rt=e,this._savePass=new CM(this._rt,!1),this.renderToScreen=!1}get renderToScreen(){return this._renderToScreen}set renderToScreen(e){if(this._renderToScreen===e)return;let t=this.effectComposer;!t||(e===!0?t.removePass(this._savePass):t.addPass(this._savePass),this._renderToScreen=e,this.updateRenderToScreen())}set sceneTransitionFromTexture(e){e!==this.sceneTransitionPass.texture&&(e!==null?this.sceneTransitionPass.enabled=!0:(this.sceneTransitionPass.enabled=!1,this.updateRenderToScreen()),this.sceneTransitionPass.texture=e)}get texture(){return this._rt&&this._rt.texture}get renderTarget(){return this._rt}updatePostprocessing(e){let{enabled:t,...i}=e,n=!1;t!==this.postprocessingState.enabled&&(n=!0);for(let r of Object.entries(i)){let s=r[1],a=this.effects.get(r[0]);if(a){a.enabled!==s.enabled&&(n=!0),a.enabled=s.enabled;for(let[o,l]of Object.entries(s))o==="blendFunction"?a.blendFunction=i1e(l):a[o]=l}}this.postprocessingState=e,n&&this._initPasses()}render(){this.effectComposer.render(this.clock.getDelta())}setScissor(e,t,i,n){e instanceof Ct?(this.effectComposer.inputBuffer.scissor.set(e.x,e.y,e.z,e.w),this.effectComposer.outputBuffer.scissor.set(e.x,e.y,e.z,e.w)):(this.effectComposer.inputBuffer.scissor.set(e,t,i,n),this.effectComposer.outputBuffer.scissor.set(e,t,i,n));let r=this.renderer.getPixelRatio();this.effectComposer.inputBuffer.scissor.multiplyScalar(r),this.effectComposer.outputBuffer.scissor.multiplyScalar(r),this.renderer.setScissor(e,t,i,n)}setScissorTest(e){this.effectComposer.inputBuffer.scissorTest=e,this.effectComposer.outputBuffer.scissorTest=e,this.renderer.setScissorTest(e)}setViewport(e,t,i,n){e instanceof Ct?(this.effectComposer.inputBuffer.viewport.copy(e),this.effectComposer.outputBuffer.viewport.copy(e)):(this.effectComposer.inputBuffer.viewport.set(e,t,i,n),this.effectComposer.outputBuffer.viewport.set(e,t,i,n))}resize(e,t,i){if(this.effectComposer.setSize(e,t,i),this._rt){let n=this.renderer.getPixelRatio();this._rt.setSize(e*n,t*n)}}dispose(){var e,t;(e=this.uvEffectPass)==null||e.dispose(),(t=this.effectPass)==null||t.dispose(),this.effectComposer.dispose()}},r1e=e=>`

// PCSS implementation based on:
// https://www.gamedev.net/articles/programming/graphics/contact-hardening-soft-shadows-made-fast-r4906/
// NOTE: This number affects how big the shadow blur can
// possibly get. Bigger number == bigger blur, but less precise results

const float  gPenumbraFilterSize = 80.0;
const int   gPenumbraSamples = ${e};
const int gShadowSamples = ${e};
const float gShadowSamplesRpc = 1.0f / float(gShadowSamples);

#ifdef USE_SHADOWMAP
    #if NUM_DIR_LIGHT_SHADOWS > 0

        uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
        varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];

        struct DirectionalLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];

    #endif

    #if NUM_SPOT_LIGHT_SHADOWS > 0

        uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
        varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_SHADOWS ];

        struct SpotLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
        };

        uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];

    #endif

    #if NUM_POINT_LIGHT_SHADOWS > 0

        uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
        varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];

        struct PointLightShadow {
            float shadowBias;
            float shadowNormalBias;
            float shadowRadius;
            vec2 shadowMapSize;
            float shadowCameraNear;
            float shadowCameraFar;
        };

        uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];

    #endif

    /*
    #if NUM_RECT_AREA_LIGHTS > 0

        // TODO (abelnation): create uniforms for area light shadows

    #endif
    */

float computePenumbra(int index, sampler2D shadowMap, float temporalAngle, float texelSize, vec2 uv, float compare, float texelScalar, float shadowRadius)
{
    float penumbra = 1.0;
    float blockerDepthAvg = 0.0;
    float blockerCount = 0.0;

    #pragma unroll_loop_start
    for(int i = 0; i < gPenumbraSamples; i ++)
    {
        vec2 offset = (vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize) * texelScalar;
        float depth = unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) );

        if(depth < compare + 0.0001)
        {
            blockerDepthAvg += depth;
            blockerCount++;
        }
    }
    #pragma unroll_loop_end

    if (blockerCount > 0.0)
    {
        blockerDepthAvg /= blockerCount;

        // Compute penumbra
        penumbra = (compare - blockerDepthAvg) / (blockerDepthAvg);
        penumbra *= penumbra;
        penumbra *= 200.0 * penumbraSize[min(index, 5 - 1)]; // Magic number that affects how quickly the penumbra grows

        return clamp(penumbra, 0.00, 1.0);
    }
    return 0.0;
}

float vogelShadow(int index, sampler2D shadowMap, vec2 uv, float texelSize, float compare, float shadowRadius)
{
    float shadow         = 0.0f;

    // NOTE: When using TAA, we should use screen space interleaved gradient noise
    vec2 halton = haltonSequence[frameIndex];
    float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
    float temporalAngle  = temporalOffset * PI2;

    float texelScalar = (gPenumbraFilterSize) / (texelSize * 1024.);
    float penumbra = computePenumbra(index, shadowMap, temporalAngle, texelSize, uv, compare, texelScalar, shadowRadius);
    if (penumbra == -1.0) {
        return 1.0;
    }

    #pragma unroll_loop_start
    for (int i = 0; i < gShadowSamples; i++)
    {
        vec2 vogelSample =  vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;
        // Overall blurring offset
        vec2 offset = vogelSample * (shadowRadius * 2.);

        // Penumbra offset
        offset += vogelSample * (penumbra * texelScalar);

        shadow += step( compare, unpackRGBAToDepth( texture2D( shadowMap, uv + offset ) ) );
    }
    #pragma unroll_loop_end

    return shadow * gShadowSamplesRpc;
}


    float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {

        return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );

    }

    vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {

        return unpackRGBATo2Half( texture2D( shadow, uv ) );

    }

    float VSMShadow (sampler2D shadow, vec2 uv, float compare ){

        float occlusion = 1.0;

        vec2 distribution = texture2DDistribution( shadow, uv );

        float hard_shadow = step( compare , distribution.x ); // Hard Shadow

        if (hard_shadow != 1.0 ) {

            float distance = compare - distribution.x ;
            float variance = max( 0.00000, distribution.y * distribution.y );
            float softness_probability = variance / (variance + distance * distance ); // Chebeyshevs inequality
            softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); // 0.3 reduces light bleed
            occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );

        }
        return occlusion;

    }

    float getShadow( int i, sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {

        float shadow = 1.0;

        shadowCoord.xyz /= shadowCoord.w;
        shadowCoord.z += shadowBias;

        // if ( something && something ) breaks ATI OpenGL shader compiler
        // if ( all( something, something ) ) using this instead

        bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
        bool inFrustum = all( inFrustumVec );

        bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );

        bool frustumTest = all( frustumTestVec );

        if ( frustumTest ) {

        #if defined( SHADOWMAP_TYPE_PCF )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            return vogelShadow(i, shadowMap, shadowCoord.xy, texelSize.x, shadowCoord.z, shadowRadius );

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )

            vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
            float dx = texelSize.x;
            float dy = texelSize.y;

            vec2 uv = shadowCoord.xy;
            vec2 f = fract( uv * shadowMapSize + 0.5 );
            uv -= f * texelSize;

            shadow = (
                texture2DCompare( shadowMap, uv, shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
                texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
                     f.x ) +
                mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
                     texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
                     f.y ) +
                mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
                          f.x ),
                     mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
                          texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
                          f.x ),
                     f.y )
            ) * ( 1.0 / 9.0 );

        #elif defined( SHADOWMAP_TYPE_VSM )

            shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );

        #else // no percentage-closer filtering:

            shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );

        #endif

        }

        return shadow;

    }

    // cubeToUV() maps a 3D direction vector suitable for cube texture mapping to a 2D
    // vector suitable for 2D texture mapping. This code uses the following layout for the
    // 2D texture:
    //
    // xzXZ
    //  y Y
    //
    // Y - Positive y direction
    // y - Negative y direction
    // X - Positive x direction
    // x - Negative x direction
    // Z - Positive z direction
    // z - Negative z direction
    //
    // Source and test bed:
    // https://gist.github.com/tschw/da10c43c467ce8afd0c4

    vec2 cubeToUV( vec3 v, float texelSizeY ) {

        // Number of texels to avoid at the edge of each square

        vec3 absV = abs( v );

        // Intersect unit cube

        float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
        absV *= scaleToCube;

        // Apply scale to avoid seams

        // two texels less per square (one texel will do for NEAREST)
        v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );

        // Unwrap

        // space: -1 ... 1 range for each square
        //
        // #X##         dim    := ( 4 , 2 )
        //  # #         center := ( 1 , 1 )

        vec2 planar = v.xy;

        float almostATexel = 1.5 * texelSizeY;
        float almostOne = 1.0 - almostATexel;

        if ( absV.z >= almostOne ) {

            if ( v.z > 0.0 )
                planar.x = 4.0 - v.x;

        } else if ( absV.x >= almostOne ) {

            float signX = sign( v.x );
            planar.x = v.z * signX + 2.0 * signX;

        } else if ( absV.y >= almostOne ) {

            float signY = sign( v.y );
            planar.x = v.x + 2.0 * signY + 2.0;
            planar.y = v.z * signY - 2.0;

        }

        // Transform to UV space

        // scale := 0.5 / dim
        // translate := ( center + 0.5 ) / dim
        return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );

    }

    float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {

        float shadow = 1.0;
        vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );

        // for point lights, the uniform @vShadowCoord is re-purposed to hold
        // the vector from the light to the world-space position of the fragment.
        vec3 lightToPosition = shadowCoord.xyz;

        // dp = normalized distance from light to fragment position
        float compare = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); // need to clamp?
        compare += shadowBias;

        // bd3D = base direction 3D
        vec3 bd3D = normalize( lightToPosition );

        vec2 halton = haltonSequence[frameIndex];
        float temporalOffset = getNoiseInterleavedGradient(gl_FragCoord.xy + halton);
        float temporalAngle  = temporalOffset * PI2;

        #if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_VSM )
            for (int i = 0; i < gShadowSamples; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                // NOTE: Removed for now
                // Penumbra offset
                //offset += vec3(vogelSample.x, vogelSample.y, vogelSample.y)  * (penumbra * gPenumbraFilterSize);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * gShadowSamplesRpc;

        #elif defined( SHADOWMAP_TYPE_PCF_SOFT )
            for (int i = 0; i < 16; i++) {
                vec2 vogelSample = vogelDiskSample(i, gShadowSamples, temporalAngle) * texelSize;

                // Overall blurring offset
                vec3 offset = vec3(vogelSample.x, vogelSample.y, -vogelSample.x) * (shadowRadius + 5.);

                shadow += texture2DCompare( shadowMap, cubeToUV( bd3D + offset, texelSize.y ), compare );

            }
            return shadow * (1.0 / 16.0);
        #else // no percentage-closer filtering

            return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), compare );

        #endif

    }

#endif
`,s1e=Et.lights_fragment_begin,a1e=Et.shadowmask_pars_fragment,JP=null,o1e=e=>{switch(e){case"low":return 8;case"medium":return 16;case"high":return 32;default:return 16}},l1e=(e="medium")=>{if(JP===e)return!1;JP=e;let t=o1e(e);Et.shadowmap_pars_fragment=r1e(t);let i=s1e.slice();i=i.replace("getShadow( spotShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX + 3, spotShadowMap[ i ]"),i=i.replace("getShadow( directionalShadowMap[ i ]","getShadow( UNROLLED_LOOP_INDEX, directionalShadowMap[ i ]"),Et.lights_fragment_begin=i;let n=a1e.slice();return n=n.replaceAll("getShadow(","getShadow( UNROLLED_LOOP_INDEX, "),Et.shadowmask_pars_fragment=n,!0},c1e=`
attribute vec3 randomColor;
varying vec3 vNormal;
flat out vec3 vColor;

void main()
{
vNormal = normal;
vColor = randomColor;
gl_Position = projectionMatrix * (modelViewMatrix * vec4(position, 1.0));
}
`,h1e=`
uniform float depthContrast;
varying vec3 vNormal;
flat in vec3 vColor;
void main()
{
vec3 normal = (normalize(vNormal)).rgb;

float contrastDepth = (gl_FragCoord.z - 0.5) * depthContrast + 0.5;

vec3 resultColor = mix(mix(vColor, normal, 0.2), vec3(contrastDepth), 0.4);
gl_FragColor = vec4(resultColor, vColor.r);
}
`,qb=new oi({vertexShader:c1e,fragmentShader:h1e,uniforms:{depthContrast:{value:1}}}),eD=new ln,u1e=class extends HB{constructor(e){super(e),this._pixelRatio=this.getPixelRatio(),this.viewportWidth=1,this.viewportHeight=1,this.resolution=new te,this.pipeline=new n1e(this),this.dummyCamra=new qn,this.sceneTransitionDuration=0,this.sceneTransitionTimeRemaining=-1,this.isXRCopyPassSet=!1,this.clear=(r=!0,s=!0,a=!0)=>{let o=this.getContext(),l=0;r&&(l|=o.COLOR_BUFFER_BIT),s&&(l|=o.DEPTH_BUFFER_BIT),a&&(l|=o.STENCIL_BUFFER_BIT),o.clear(l),o.clearBufferfv(o.COLOR,1,[0,0,0,1])},this.autoClear=!1;let t=this.setPixelRatio.bind(this),i=this.setSize.bind(this);this.shadowMap.enabled=!0,this.shadowMap.type=yE;let n=this.getContext();if(n&&"drawingBufferColorSpace"in n)try{n.drawingBufferColorSpace="display-p3"}catch(r){console.warn(r)}this.setPixelRatio=r=>{this._pixelRatio!==r&&(this._pixelRatio=r,t(r))},this.setSize=(r,s,a=!0)=>{var o,l;(this.viewportWidth!==r||this.viewportHeight!==s)&&(this.viewportWidth=r,this.viewportHeight=s,i(r,s,a),(o=this.normalRenderTarget)==null||o.setSize(r*this._pixelRatio,s*this._pixelRatio),this._resizeTransmission(r,s),(l=this.transmissionDepthTarget)==null||l.setSize(r*this._pixelRatio/2,s*this._pixelRatio/2),this.pipeline.resize(r,s,a))},this._superDispose=this.dispose,this.dispose=this._currentDispose}createAORenderTarget(){this.aoRenderTarget===void 0&&(this.aoRenderTarget=new Qt(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:Lt,magFilter:Lt,wrapS:Fi,wrapT:Fi,depthBuffer:!1}))}_resizeTransmission(e,t){var i,n;(i=this.transmissionRenderTarget)==null||i.setSize(e*this._pixelRatio/(this.hdTransmission?1:2),t*this._pixelRatio/(this.hdTransmission?1:2)),(n=this.aoRenderTarget)==null||n.setSize(e*this._pixelRatio/1,t*this._pixelRatio/1)}get hdTransmission(){return ht.transmissionLod.value===1}set hdTransmission(e){ht.transmissionLod.value=e===!0?1:2,this._resizeTransmission(this.viewportWidth,this.viewportHeight)}createTransmissionRenderTarget(){this.transmissionRenderTarget===void 0&&(this.transmissionRenderTarget=new Qt(this.viewportWidth*this._pixelRatio/(this.hdTransmission?1:2),this.viewportHeight*this._pixelRatio/(this.hdTransmission?1:2),{generateMipmaps:!0,minFilter:xp,magFilter:Lt,wrapS:Fi,wrapT:Fi,depthBuffer:!1}),this.transmissionDepthTarget=new Qt(this.viewportWidth*this._pixelRatio/2,this.viewportHeight*this._pixelRatio/2,{minFilter:ai,magFilter:ai,depthBuffer:!1}))}createNormalRenderTarget(){this.normalRenderTarget===void 0&&(this.normalRenderTarget=new Qt(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio,{generateMipmaps:!1,minFilter:ai,magFilter:ai,type:es,depthTexture:new wp(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio)}))}renderNormal(e,t,i){this.normalRenderTarget&&(this.setClearColor(0),i.layers.enable(8),i.layers.disable(0),i.layers.disable(3),t.traverseEntity(n=>{n.layers.isEnabled(8)&&(n.copyPreviousMatrix=!1)}),this.setRenderTarget(this.normalRenderTarget),this.clear(),i instanceof qn?qb.uniforms.depthContrast.value=(i.far-i.near)/1e4:qb.uniforms.depthContrast.value=1,t.overrideMaterial=qb,this.render(t,i),this.setClearColor(t.bgColor,t.bgColor.a),this.setRenderTarget(null),t.overrideMaterial=e.wireframeState?DM:null,i.layers.enable(0),i.layers.enable(3),t.traverseEntity(n=>{n.layers.isEnabled(8)&&(n.copyPreviousMatrix=!0)}))}renderSplineSceneWithDummyCamera(e,t,i=1){this.dummyCamra.updateCameraState(t.dataPatched);let n=t.height,r=t.width,s=this.viewportWidth/this.viewportHeight;r<n?r=n*s:n=r/s,this.dummyCamra.setViewplaneSize(r,n);for(let a=0;a<i;a++)this.renderSplineScene(e,this.dummyCamra)}renderSplineScene(e,t,{sceneHelpers:i=void 0,sceneHelpersOnTop:n=void 0,overrideTransmission:r=void 0,overrideNormal:s=void 0}={}){let a=e instanceof UA?e.activePage:e,o=a.visible;a.visible=!0;let l=a.scene;this.xr.enabled&&(this.isXRCopyPassSet===!1&&this.getRenderTarget()!==null&&(this.pipeline.setCopyPass(this.getRenderTarget()),this.isXRCopyPassSet=!0),this.xr.updateCamera(t)),this.setClearColor(a.bgColor,a.bgColor.a),a.penumbraSizeArray.forEach((d,p)=>{ht.penumbraSize.value[p]=d}),ht.pixelRatioNode.value=this.getPixelRatio(),this.resolution.x!==0&&this.resolution.y!==0?ht.resolution.value.set(this.resolution.x,this.resolution.y):ht.resolution.value.set(this.viewportWidth*this._pixelRatio,this.viewportHeight*this._pixelRatio),s!==void 0?(ht.normalRenderTarget.value=s,ht.normalRenderTargetDepth.value=eD):l.needsNormal()&&(this.createNormalRenderTarget(),ht.normalRenderTarget.value=this.normalRenderTarget.texture,ht.normalRenderTargetDepth.value=this.normalRenderTarget.depthTexture,this.renderNormal(l,a,t));let c=a.data.ao,u=c.occlusion;u&&(this.createAORenderTarget(),ht.aoRenderTarget.value=this.aoRenderTarget.texture),ht.aoEnabled.value=u,this.pipeline.setAmbientOcclusionParams(c.occlusion,c.radius,c.bias,a.aoColor,a.fog!==null,a.backupFog.near,a.backupFog.far,c.aoFullRes),this.pipeline.aoPass.setBlueNoiseTexture(this.pipeline.blueNoiseTexture);let h=!1;if(r!==void 0)ht.transmissionRenderTarget.value=r,ht.transmissionRenderTargetDepth.value=eD,this.pipeline.setTransmissionPassEnabled(!1);else{let d=l.needsTransmission();d&&(this.transmissionRenderTarget===void 0&&(h=!0),this.createTransmissionRenderTarget(),ht.transmissionRenderTarget.value=this.transmissionRenderTarget.texture,ht.aspectRatio.value=Wfe(this.viewportWidth,this.viewportHeight),ht.transmissionRenderTargetDepth.value=this.transmissionDepthTarget.texture),this.pipeline.setTransmissionPassEnabled(d)}t.layers.enable(3),t.layers.enable(8),this.pipeline.sceneHelpers=i,this.pipeline.sceneHelpersOnTop=n,this.pipeline.scene=a,this.pipeline.camera=t,h&&this.pipeline.transmissionPass.updatePasses(this),this.pipeline.postprocessingState!==a.postprocessing&&(this.pipeline.updatePostprocessing(a.postprocessing),!i&&!n&&this.pipeline.disableHelpers()),this.clearAlphaOverride!==void 0&&this.setClearAlpha(this.clearAlphaOverride),a.overrideMaterial=l.wireframeState?DM:null,this.pipeline.render(),ht.frameIndex.value=(ht.frameIndex.value+1)%16,t instanceof qn&&t.copyHistory(),a.visible=o}renderFromSceneForSceneTransitionPass(e,t,i){this.pipeline.renderToScreen=!1,this.pipeline.renderTarget,this.renderSplineScene(e,t),this.pipeline.sceneTransitionFromTexture=this.pipeline.renderTarget.texture,this.sceneTransitionDuration=i,this.sceneTransitionTimeRemaining=i,this.pipeline.renderToScreen=!0;let n=this.pipeline.sceneTransitionPass.uniforms;n.uDPR.value=window.devicePixelRatio,n.uResolution.value.set(this.domElement.width,this.domElement.height).divideScalar(window.devicePixelRatio)}_currentDispose(){var e,t,i,n,r,s;this._superDispose(),this.pipeline.dispose(),(e=this.aoRenderTarget)==null||e.dispose(),(t=this.transmissionRenderTarget)==null||t.dispose(),(i=this.transmissionDepthTarget)==null||i.dispose(),(n=this.normalRenderTarget)==null||n.dispose(),(s=(r=this.normalRenderTarget)==null?void 0:r.depthTexture)==null||s.dispose()}},qF=class extends lg(Sie){constructor(e,t=15,i=10066329){super(e,t,i),this.object=e,this.added=!1,this.name=`DirectionalLightHelper: ${e.uuid}`}raycast(e,t){cg(this.object,qF.geometryHelper,e,t)}},YF=class extends lg(wie){constructor(e,t=15,i=6710886){super(e,t,i),this.object=e,this.name=`PointLightHelper: ${e.uuid}`}raycast(e,t){cg(this.object,YF.geometryHelper,e,t)}},TM=class extends lg(bie){constructor(e,t=6710886){super(e,t),this.object=e,this.name=`SpotLightHelper: ${e.uuid}`}raycast(e,t){cg(this.object,TM.geometryHelper,e,t)}update(){if(this.object!==void 0){let e=TM._vector,t=this.object.distance?this.object.distance:1e3,i=t*Math.tan(this.object.angle);this.cone.scale.set(i,i,t),e.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(e);let n=this.color!==void 0?this.color:this.light.color;if(this.cone.material instanceof Array)for(let r=0,s=this.cone.material.length;r<s;r++)this.cone.material[r].color.set(n);else this.cone.material.color.set(n)}}},ZF=TM;ZF._vector=new T;function d1e(e,t){e.shadow.camera.right=t/2,e.shadow.camera.left=-t/2,e.shadow.camera.top=t/2,e.shadow.camera.bottom=-t/2,e.shadow.needsUpdate=!0}var QF=class extends LA(rie,qF){constructor(e,t,i){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=2048,this.shadow.mapSize.height=2048,this.shadow.normalBias=1,this.layers.enable(3);let n=this.shadow.camera;n.top=1250,n.bottom=-1250,n.right=1250,n.left=-1250,n.near=-1e4,n.far=2500;let r=new Vy(this.shadow.camera);r.visible=!1,this.gizmos.shadowmap=r}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof Vy&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t);let i=e.depth!==void 0&&e.depth!==this.shadow.camera.far||e.size!==void 0&&e.size/2!==this.shadow.camera.right;e.size!==void 0&&d1e(this,e.size),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null)),e.penumbraSize!==void 0&&t.scene.markPenumbraSizeDirty(),i&&this.update()}},tD=new T,iD=new T,nD=new At,KF=class extends LA(eie,ZF){constructor(e,t,i){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let n=this.shadow.camera;n.fov=Dt.RAD2DEG*2*this.angle,n.aspect=1,n.near=100,n.far=2500;let r=new Vy(this.shadow.camera);r.visible=!1,this.gizmos.shadowmap=r,this.update()}update(){this.shadow.camera.updateProjectionMatrix();for(let e in this.gizmos){let t=this.gizmos[e];t instanceof Vy&&t.update()}}updateMatrixWorld(e){super.updateMatrixWorld(e),iD.setFromMatrixPosition(this.matrixWorld),nD.setFromRotationMatrix(this.matrixWorld),tD.copy(this.up).applyQuaternion(nD).negate().multiplyScalar(this.distance),this.target.position.copy(iD).add(tD),this.target.updateMatrixWorld(),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),e.distance!==void 0&&(this.distance=e.distance),e.decay!==void 0&&(this.decay=e.decay),e.angle!==void 0&&(this.angle=e.angle),e.penumbra!==void 0&&(this.penumbra=e.penumbra),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.penumbraSize!==void 0&&t.scene.markPenumbraSizeDirty(),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},bc=class extends fA(gc){constructor(e,t){super(),this.data=t,this.bgColor=new Or(1,1,1,1),this.fog=null,this.backupFog=new GB(16777215,.1,2e3),this.fogUseBGColor=!1,this.isActive=!1,this.aoColor=new ut,this.penumbraSizeArrayCache=null,this.super_Entity(e,t),this.personalCamera=new qn(rf,{...D0.defaultData,...t.camera,name:"Personal Camera"}),this.personalCamera.objectHelper.visible=!1,this.add(this.personalCamera),this.activeCamera=this.personalCamera,this.ambientLight=new $te(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.ambientLight.layers.enable(3),this.ambientLight.removeFromParent(),this.add(this.ambientLight)}get scene(){return this.parent}get postprocessing(){return this.data.postprocessing}updateVisible(){}setBackgroundColor(e){this.bgColor=e,this.fogUseBGColor===!0&&(this.backupFog.color=e)}updateAmbientLight(e,t){e.color!==void 0&&(this.ambientLight.color=ur(e.color,t)),e.intensity!==void 0&&(this.ambientLight.intensity=e.intensity),e.enabled!==void 0&&(e.enabled?this.add(this.ambientLight):this.remove(this.ambientLight))}onDeactive(){this.isActive=!1}onActive(e){this.isActive=!0,e.fog=this.fog,this.updateShadow(this.data.shadow)}forceMaterialsUpdate(){this.traverseEntity(e=>{if(e instanceof of)if(Array.isArray(e.material))for(let t of e.material)t.needsUpdate=!0;else e.material.needsUpdate=!0,e.material.dispose()})}updateShadow(e){e.softShadowQuality!==void 0&&this.isActive&&l1e(e.softShadowQuality)&&this.forceMaterialsUpdate()}updateFog(e,t){if(e.enabled?this.fog=this.backupFog:this.fog=null,this.isActive){let i=this.scene;i.fog=this.fog}this.fogUseBGColor=e.useBackgroundColor,e.useBackgroundColor?this.backupFog.color.set(this.bgColor):this.backupFog.color=ur(e.color,t),this.backupFog.near=e.near,this.backupFog.far=e.far}updateAo(e,t){e.aoColor!==void 0&&(this.aoColor=ur(e.aoColor,t))}updateByOp(e,t,i,n){super.updateByOp(e,t,i,n);let r=t;Ps(e.path,["fog"])?this.updateFog(r.fog,i.shared):Ps(e.path,["ao"])?this.updateAo(r.ao,i.shared):Ps(e.path,["ambient"])?this.updateAmbientLight(r.ambient,i.shared):Ps(e.path,["shadow"])&&this.updateShadow(r.shadow)}updateState(e,t){this.updateState_Entity(e,t),e.backgroundColor!==void 0&&this.setBackgroundColor(ur(e.backgroundColor,t.shared)),e.fog!==void 0&&this.updateFog(e.fog,t.shared),e.ambient!==void 0&&this.updateAmbientLight(e.ambient,t.shared),e.ao!==void 0&&this.updateAo(e.ao,t.shared),e.shadow!==void 0&&this.updateShadow(e.shadow)}raycast(e,t){super.raycast(e,t)}switchActiveCamera(e){e&&e.isDescendantOf(this)&&(this.activeCamera!==this.personalCamera&&(this.activeCamera.objectHelper.visible=!0),this.activeCamera=e,e.objectHelper.visible=!1)}get playCamera(){var e;return((e=this.scene)==null?void 0:e.find(this.data.publish.playCamera))??this.personalCamera}switchToPlayCamera(){this.switchActiveCamera(this.playCamera)}get penumbraSizeArray(){return this.penumbraSizeArrayCache===null&&this.updatePenumbraSizeArray(),this.penumbraSizeArrayCache}updatePenumbraSizeArray(){this.penumbraSizeArrayCache=new Array(5).fill(.5);let e=0,t=0;this.traverseEntity(i=>{if(!i.visible)return!0;i instanceof QF&&i.visible&&e<3&&(this.penumbraSizeArrayCache[e]=i.data.penumbraSize,e+=1),i instanceof KF&&i.visible&&e<5-3&&(this.penumbraSizeArrayCache[3+t]=i.data.penumbraSize,t+=1)})}raycastWithClones(e){let t=[],i=n=>{for(let r of n.children){let s=r.cloner;Vt.is(r)&&(r.visible||s!=null&&s.object.data.visible)&&((na(r)||wM(r)&&this.scene.enableHelpers&&r.objectHelper.visible)&&(e.intersectObject(r,!1,t),PM(r,e,t,!0)),i(r))}};return i(this),t}},p1e=class extends LA(iie,YF){constructor(e,t,i){super(),this.super_Entity(e,t),this.castShadow=!0,this.shadow.mapSize.width=1024,this.shadow.mapSize.height=1024,this.shadow.normalBias=1,this.layers.enable(3);let n=this.shadow.camera;n.fov=90,n.aspect=1,n.near=100,n.far=2500;let r=new T(-n.far+this.position.x,-n.far+this.position.y,-n.far+this.position.z),s=new T(n.far+this.position.x,n.far+this.position.y,n.far+this.position.z),a=new Vi(r,s),o=new Hy(a,new ut(16755200));o.visible=!1,this.gizmos.shadowmap=o,this.update()}update(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this.gizmos))for(let e in this.gizmos){let t=this.gizmos[e];if(t instanceof Hy){let i=this.shadow.camera,n=new T(-i.far+this.position.x,-i.far+this.position.y,-i.far+this.position.z),r=new T(i.far+this.position.x,i.far+this.position.y,i.far+this.position.z);t.box.set(n,r),t.updateMatrixWorld(!0)}}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.objectHelper&&this.objectHelper.update()}updateState(e,t){this.updateState_Light(e,t),e.distance!==void 0&&(this.distance=e.distance),e.decay!==void 0&&(this.decay=e.decay),e.shadowRadius!==void 0&&(this.shadow.radius=e.shadowRadius),e.shadowResolution!==void 0&&(this.shadow.mapSize.set(e.shadowResolution,e.shadowResolution),this.shadow.map&&(this.shadow.map.dispose(),this.shadow.map=null))}},f1e=class extends dr{get forceComputeSize(){return!0}get shape(){return this.geometry.userData.shape}updateEntityBoxSize(e,t){let i=this.geometry.getAttribute("position");i!==void 0?wA(i,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:i.count,e,t):super.updateEntityBoxSize(e,t)}},OA=class extends dr{constructor(e,t,i){super(e,t,i),this._shapeId=null,this._context=i}updateState(e,t){super.updateState(e,t),this.updateShape()}updateShape(){var n;let e=this.data.geometry.extrusion.shape,t;if(e.type==="Custom"){let r=e.shapeId;if(r!==this._shapeId&&this.detachShape(),r){this._shapeId=r;let s=this._context.scene.find(r);s!=null&&s.data&&(s.attachedPaths.add(this),t=(n=s.geometry.userData)==null?void 0:n.shape),t||this._context.scene.addPendingCommand(()=>this.updateShape())}}else{let r;switch(e.type){case"Rectangle":r=KU;break;case"Ellipse":r=_A;break;case"Polygon":r=QU;break;case"Star":r=$U;break;default:throw new Error(`Unknown shape type: ${e.type}`)}t=r.create({parameters:e}).userData.shape}let i=this.geometry;t&&i.inputs&&(i.inputs.shapeData=t,i.build(),this.attachedSurfaceCloners.forEach(r=>r.update()))}detachShape(){var e;this._shapeId!==null&&((e=this._context.scene.find(this._shapeId))==null||e.attachedPaths.delete(this))}createGeometryDelayed(e){this.geometryCreateDeleyed=e.shared,this.updateShape(),this.refreshAttachedPaths(e)}updateTransformState(e){return super.updateTransformState(e)}updateGeometryInteractions(e,t){super.updateGeometryInteractions(e,t),this.updateShape()}updateEntityBoxSize(e,t){let i=this.geometry.getAttribute("position");i!==void 0?wA(i,this.geometry.drawRange.start,this.geometry.drawRange.count<1/0?this.geometry.drawRange.count:i.count,e,t):super.updateEntityBoxSize(e,t)}},ap=class extends hg(Id,M2){constructor(e,t,i){super(),t.type==="Instance"&&typeof e=="string"&&(t=this.transformAssignData(t,i)),this.super_Entity(e,t),this.objectHelper.update()}get isComponentRoot(){return this.data.type==="Component"&&typeof this.identity=="string"}get isInstanceRoot(){return this.data.type==="Instance"&&typeof this.identity=="string"}transformAssignData(e,t){let i=ux.getComponentData({scene:t.scene.data,shared:t.shared.data},e.component);if(i){let n,r;for(let s of ec.rootOverrideProps)e[s]===void 0?(n===void 0&&(n={...e}),n[s]=i.data[s]):(r===void 0&&(r={}),r[s]=e[s],n===void 0&&(n={...e}),n[s]=vc.apply(i.data[s],e[s]));return this.overrideData=r,n}else return{...fr.defaultData,...e,...il(fr.defaultData,ec.rootOverrideProps)}}updateByOp(e,t,i,n){let r;if(this.isInstanceRoot&&!n){if(t=this.transformAssignData(t,i),e.type===0&&e.path.length===0&&this.component)for(let s of ec.rootOverrideProps)s in e.props&&e.props[s]===void 0&&(r===void 0&&(r={...e,props:{...e.props}}),r.props[s]=this.component.data[s]);else if(e.type===0&&e.path.length>0&&ec.rootOverrideProps.includes(e.path[0])){let s=e.path[0];r===void 0&&(r={...e,path:[],props:{[s]:t[s]}})}}super.updateByOp(r??e,t,i,n)}updateState(e,t){this.updateState_Entity(e,t)}expandInstanceChildren(e){let t=this.data;if(this.component===void 0){let i=e.scene.find(t.component)??null,n=!1;if(i!==this.oldComponent){if(this.oldComponent){let r=0;for(let s of this.children)if(Vt.is(s))e.scene.disposeAndUnregisterEntityRecursivelyIfNotReregistered(s),BA(s),r+=1;else break;this.children.splice(0,r)}n=!0}if(i){let r={};$F(e,[this.uuid],t.overrides,this,i,i,0,n,r);for(let s of this.children)if(Vt.is(s)){let a=s.data;a.type==="Empty"&&a.animations&&s.traverseEntity(o=>{if(o instanceof dr&&o.isSkinnedMesh){let l=o.dataPatched;if(l.bones&&l.boneInverses){let c=l.bones.map(d=>e.scene.find(r[d])),u=l.boneInverses.map(d=>new ke().fromArray(d)),h=new AE(c,u);o.bind(h,o.bindMatrix)}}else o.matrixAutoUpdate=!0})}}this.oldComponent=this.component}}};function BA(e){if(e.component){let t=e.component.instances.indexOf(e);t>=0&&e.component.instances.splice(t,1);for(let i of e.children)Vt.is(i)&&BA(i)}}function rD(e,t,i,n){return e.component===t&&tA(e.identity,n)?e.overrideData===i?2:1:0}function $F(e,t,i,n,r,s,a,o,l){if(a>50)return!1;if(n.component!==r){if(n.component){let u=n.component.instances.indexOf(n);u>=0&&n.component.instances.splice(u,1)}r.instances.push(n),n.component=r}r instanceof ap&&r.isInstanceRoot&&r.expandInstanceChildren(e);let c=0;for(let u of r.children)if(Vt.is(u)){let h=[...t,...typeof u.identity=="string"?[u.identity]:u.identity],d=ox.resolve(i,h,1);d!=null&&!(d instanceof cn)&&(Object.setPrototypeOf(d,cn.prototype),console.error("wrong prototype"));let p=null,f;if(!o){let v=n.children[c];if(p=Vt.is(v)?v:null,p!==null){let m=rD(p,u,d,h);f=m>=1?p.stateSelection:void 0,m!==2&&(p=null)}if(p===null&&(p=e.scene.findInstance(h)??null,p!==null)){let m=rD(p,u,d,h);if(f=m>=1?p.stateSelection:void 0,m!==2)p=null;else{let g=p.parent.children.indexOf(p);p.parent.children.splice(g,1),n.children.splice(c,0,p),p.parent===n?g<=c&&console.error("not possible"):(p.parent=n,p.matrixWorldNeedsUpdate=!0,p.resetBBoxNeedsUpdate(),p.updateVisible(),e.pendingDeletes.delete(p))}}}if(p===null){let v=d?vc.apply(u.data,d):u.data;Yh.is(v.type)&&(v={...v,type:"Empty"}),p=tc.createEntity(h,v,e),p.overrideData=d,n.add(p),n.children.splice(n.children.length-1,1),n.children.splice(c,0,p),p.updateState(p.data,e),f&&p.changeSelectedState(f,e),e.scene.registerInstanceAndSetUuid(p)}if(p.isBone){let v=p.identity[p.identity.length-1];l[v]=p.uuid}c+=1,$F(e,t,i,p,u,s,a+1,o,l)}if(!o){let u=c;for(;;){let h=n.children[c];if(Vt.is(h))e.pendingDeletes.add(h);else break;c+=1}n.children.splice(u,c-u)}return!0}var m1e=class extends hg(jB,M2){constructor(e,t){super(),this.super_Entity(e,t),this.objectHelper.update(),this.matrixAutoUpdate=!0}updateState(e,t){this.updateState_Entity(e,t)}};function g1e(e,t,i){let n;return t.geometry.type==="TextGeometry"?new zF(e,t,i):(t.geometry.type==="SubdivGeometry"?n=new U0(e,t,i):t.geometry.type==="PathGeometry"?n=new OA(e,t,i):t.geometry.type==="VectorGeometry"?n=new f1e(e,t,i):t.geometry.type==="BooleanGeometry"?n=new Ip(e,t,i):n=new dr(e,t,i),n)}function NA(e,t,i){return t.type==="Mesh"?g1e(e,t,i):t.type==="Empty"?new F0(e,t):t.type==="Bone"?new m1e(e,t):t.type==="Page"?new bc(e,t):t.type==="PointLight"?new p1e(e,t,i):t.type==="SpotLight"?new KF(e,t,i):t.type==="DirectionalLight"?new QF(e,t,i):t.type==="Component"||t.type==="Instance"?new ap(e,t,i):Yh.is(t.type)?new qn(e,t):(console.error(t),new F0(e,t))}tc.createEntity=NA;function v1e(e,t,i){let n=NA(e.identity,t,i),r=e.children,s=e.attachedPaths,a=e.parent,o=e.component,l=e.instances,c=e.overrideData,u=e.uuid,h=e.stateSelection;e.dispose();for(let d of Object.keys(e))delete e[d];Object.setPrototypeOf(e,Object.getPrototypeOf(n));for(let d of Object.keys(n))e[d]=n[d];e.children=[...e.children,...r],e.attachedPaths=s,e.parent=a,e.component=o,e.instances=l,e.uuid=u,e.overrideData=c,e.updateState(e.data,i),h&&e.changeSelectedState(h,i),e.resetBBoxNeedsUpdate()}tc.changeEntityProptotype=v1e;tc.Cloner=ha;function y1e(e,t,i,n){e.updateByOp(t,i,n,!1)}function sD(e,t){let i=!1,n=t.getLayersOfType("transmission"),r=t.getLayersOfType("outline");return r.length>0&&(e.layers.set(8),n.length>0&&e.layers.enable(3),i=!0,DA(e),PA(e)),n.length===0&&r.length===0&&e.layers.set(0),e instanceof of&&e.needsAO&&e.layers.enable(5),i}function aD(e,t){if(!t.layers)return!1;let i=!1,n=t.getLayersOfType("transmission").filter(s=>s.data.visible),r=t.getLayersOfType("outline").filter(s=>s.data.visible);return n.length>0&&(e.layers.set(3),r.length>0&&e.layers.enable(8),i=!0),n.length===0&&r.length===0&&e.layers.set(0),e.needsAO&&e.layers.enable(5),i}function x1e(e){let t=!1;return e.traverseEntity(i=>{if(i instanceof of)if(Array.isArray(i.material))for(let n=0;n<i.material.length;n++)sD(i,i.material[n])&&(t=!0);else sD(i,i.material)&&(t=!0)}),t}function _1e(e){let t=!1;return e.traverseEntity(i=>{if(i instanceof of)if(Array.isArray(i.material))for(let n=0;n<i.material.length;n++)aD(i,i.material[n])&&(t=!0);else aD(i,i.material)&&(t=!0)}),t}var b1e=new lN,w1e=new ke,S1e=new Wp;function PM(e,t,i,n=!1){let r=e.cloner;if(r)for(let s of r.children){let a=w1e.copy(s.matrixWorld).invert(),o=S1e.copy(t.ray).applyMatrix4(a),l=e.matrixWorld;o.applyMatrix4(l);let c=b1e;c.set(o.origin,o.direction),c.near=t.near,c.far=t.far;let u=c.intersectObject(e,!1);u.length>0&&i.push({...u[0],object:n?s:e})}}var M1e=class{constructor(){this._constraints=new Map}setConstraint(e,t){t===null?this._constraints.delete(e):this._constraints.set(e,t)}removeDependencies(e){this._constraints.delete(e)}applyConstraints(e){let t=new Set;this._constraints.forEach((i,n)=>{let r=[n,i],s=i;for(;this._constraints.has(s);)s=this._constraints.get(s),t.has(s)||r.push(s);for(let a=r.length-2;a>=0;a--)if(!t.has(r[a])){let o=e.find(r[a]);o?o.applyPathSnapping(e):console.warn(`missing entity ${r[a]}`),t.add(r[a])}})}findDependency(e,t){let i=e;for(;this._constraints.has(i);)if(i=this._constraints.get(i),i===t)return!0;return!1}},DM=new ig;DM.wireframe=!0;var oD=new T,UA=class extends gc{constructor(e,t){super(),this.data=e,this.enableHelpers=!1,this.wireframeState=!1,this.needsTransmissionDirty=!0,this.needsNormalDirty=!0,this._needsTransmission=!1,this._needsNormal=!1,this.geometryCacheChanged=!1,this.entityByUuid={},this.entityIdentityToEntity={},this.toExpandCloner=new Set,this.toUpdateCloner=new Set,this.pendingCommands=[],this.pathConstraints=new M1e,this.errorPage=new bc("fdasfa",{...Lp.defaultData,name:""}),this.invisibleObjects=new F0("jflkdsafjasdifjaslk",{...KS.defaultData,visible:!1,name:"buildin invisible"}),this.needsRecomputeInstances=!1,this.init(e,t),this.matrixAutoUpdate=!1}markGeometryCacheDirty(){this.geometryCacheChanged=!0}markNeedsUpdateRendererDirty(){this.needsTransmissionDirty=!0,this.needsNormalDirty=!0}needsTransmission(){return this.needsTransmissionDirty&&(this._needsTransmission=_1e(this),this.needsTransmissionDirty=!1),this._needsTransmission}needsNormal(){return this.needsNormalDirty&&(this._needsNormal=x1e(this),this.needsNormalDirty=!1),this._needsNormal}registerInstanceAndSetUuid(e){let t=e.identity.join("-"),i=this.entityIdentityToEntity[t];i&&(e.uuid=i.uuid),this.entityIdentityToEntity[t]=e,this.entityByUuid[e.uuid]=e}markPenumbraSizeDirty(){for(let e of this.children)e instanceof bc&&(e.penumbraSizeArrayCache=null)}findInstance(e){return this.entityIdentityToEntity[e.join("-")]}get bgColor(){return this.activePage.bgColor}get postprocessing(){return this.activePage.data.postprocessing}getWithSortKey(e){let t=this.find(e);if(t===void 0)return;let i=[],n=t;for(;n!==this;){let r=n;n=n.parent;let s=n.children.indexOf(r);i.splice(0,0,s)}return{entity:t,sortKey:i}}getAllSorted(e){let t=[];for(let i of e){let n=this.getWithSortKey(i.id);n!==void 0&&t.push(n)}return t.sort((i,n)=>Zhe(i.sortKey,n.sortKey)),t.map(i=>i.entity)}nonExistOrDescendantOf(e,t){let i=this.find(e);if(i===void 0)return!0;for(;i;){if(i.uuid===t)return!0;i=i.parent}return!1}find(e){if(this.activePage&&this.activePage.personalCamera.parent){if(e==="f23858d0-4a3b-4bd8-8173-66ed0af7f6fb-personalCamera")return this.activePage.personalCamera;if(e===rf)return this.activePage.personalCamera}if(e===""||e===void 0)return;let t=this.entityByUuid[e];return t===void 0?this.getObjectByProperty("uuid",e):t}debugEnsureEntity(e){let t=this.find(e);if(t){if(Array.isArray(t.identity)&&this.findInstance(t.identity)===void 0){console.error("not found instance");debugger}}else{console.error("not found");debugger}}addPendingExpandCloner(e){this.toExpandCloner.add(e)}addPendingUpdateCloner(e){this.toUpdateCloner.add(e)}markToExpandCloner(e){this.toExpandCloner.add(e),e.traverseEntityAncestors(t=>{this.toExpandCloner.add(t)})}doPendingExpandCloner(){this.toExpandCloner.forEach(e=>{e.expandCloner(this)}),this.toExpandCloner.clear()}doPendingUpdateCloner(){this.toUpdateCloner.forEach(e=>{var t;(t=e.cloner)==null||t.update()}),this.toUpdateCloner.clear()}doPendingUpdates(){this.doPendingExpandCloner(),this.doPendingUpdateCloner(),this.applyPendingCommands()}addPendingCommand(e){this.pendingCommands.push(e)}applyPendingCommands(){this.pendingCommands.forEach(e=>e()),this.pendingCommands.length=0}updateByLibOp(e,t){e.path.length===1&&e.path[0]==="components"&&e.type===1&&this.createChildrenObjects([{...e.data.asset,id:e.id}],this.invisibleObjects,t)}updateTreeByOp(e,t){var i;if(e.path.length===0&&e.type===7){let n=e.parent===null?this:this.find(e.parent);if(n===void 0)throw new Error("unexpected");let r=this.createObject(e.id,e.data,e.children,n,e.localIndex,t);r.updateVisible(),r.resetBBoxNeedsUpdate(),na(r)&&qa(r.parent)&&(r.invalidateUpstreamBooleanData(),r.parent.invalidateDownstreamBooleanData().recomputeBoolean()),this.markNeedsRecomputeInstancesForAncessors(n),this.markNeedsRecomputeInstancesForChildren(r),this.markToExpandCloner(r),this.markPenumbraSizeDirty()}else if(e.path.length===0&&e.type===8){let n=this.find(e.id);if(n===void 0)throw new Error("unexpected");this.markToExpandCloner(n),n.resetBBoxNeedsUpdate(),this.unregisterObject(n);let r=n.parent;this.markNeedsRecomputeInstancesForAncessors(r),this.markNeedsRecomputeInstancesForChildren(n),this.markPenumbraSizeDirty(),n.parent.remove(n),qa(n.parent)&&(n.parent.invalidateUpstreamBooleanData(),n.parent.invalidateDownstreamBooleanData().recomputeBoolean()),na(n)&&(n.freeBooleanPointer(),r instanceof Ip&&r.invalidateDownstreamBooleanData().recomputeBoolean()),n instanceof OA&&n.detachShape(),this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(n),this.pathConstraints.removeDependencies(n.uuid)}else if(e.path.length===0&&e.type===9){let n=this.find(e.id);if(n===void 0)throw new Error("unexpected");this.markNeedsRecomputeInstancesForChildren(n);let r=n.parent;this.markNeedsRecomputeInstancesForAncessors(r),(i=n.cloner)==null||i.resetOnMove(),this.markToExpandCloner(n);let s=e.parent===null?this:this.find(e.parent);if(s===void 0)throw new Error("unexpected");s.add(n),this.markNeedsRecomputeInstancesForAncessors(s),this.markToExpandCloner(n),n.invalidateClonerTransform(n),n.updateVisible(),n.resetBBoxNeedsUpdate(),this.markPenumbraSizeDirty();let a=e.localIndex;s.children.splice(a,0,s.children.pop()),na(n)&&(n.invalidateUpstreamBooleanData(),qa(n.parent)?n.parent.invalidateDownstreamBooleanData().recomputeBoolean():r instanceof Ip&&r.invalidateDownstreamBooleanData().recomputeBoolean())}this.markNeedsUpdateRendererDirty(),this.markGeometryCacheDirty()}get playPage(){return this.find(this.data.publish.playPage)??this.errorPage}updatePage(e){this.activePage&&this.activePage.onDeactive(),this.activePage=this.errorPage;for(let t of this.children)t instanceof bc&&(t.visible=t.uuid===e,t.visible&&(this.activePage=t,this.activePage.onActive(this)))}updateEntityByOp(e,t,i,n){if(t.type===0){if(("overrides"in t.props||"component"in t.props)&&this.markNeedsRecomputeInstances(),"visible"in t.props&&this.markPenumbraSizeDirty(),t.path.includes("overrides")&&"states"in t.props){let{rest:s}=t.props;t={...t,props:s},this.markNeedsRecomputeInstances()}t.path[0]==="pathSnapping"&&t.props.pathId!==void 0&&this.pathConstraints.setConstraint(e,t.props.pathId)}let r=this.find(e);if(r)try{y1e(r,t,i,{scene:this,shared:n}),r instanceof dr&&r.updateGeometryGroupsIfNeeded()}catch(s){console.error(s)}}get activeCamera(){return this.activePage.activeCamera}switchActiveCamera(e){this.activePage.switchActiveCamera(e)}isInvisibleObjects(e){return e===this.invisibleObjects||e.hasAnccestor(this.invisibleObjects)}init(e,t){let i=Object.entries(t.data.lib.components).map((n,r)=>({data:n[1].asset.data,children:n[1].asset.children,id:n[0],fi:r}));this.invisibleObjects.updateState(this.invisibleObjects.data,{scene:this,shared:t}),this.add(this.invisibleObjects),this.createChildrenObjects(i,this.invisibleObjects,t),this.createChildrenObjects(e.objects,this,t),this.updatePage(e.publish.playPage),this.activePage.switchToPlayCamera(),this.expandInstances(t,!0),this.traverseEntity(n=>{qa(n)&&n.recomputeBoolean(),n instanceof qn&&n.updateUp()}),this.doPendingExpandCloner(),this.applyPendingCommands()}markNeedsRecomputeInstances(){this.needsRecomputeInstances=!0}markNeedsRecomputeInstancesForChildren(e){e.traverseEntity(t=>{(t.data.type==="Component"||t.data.type==="Instance")&&this.markNeedsRecomputeInstances()})}markNeedsRecomputeInstancesForAncessors(e){Vt.is(e)&&(e.data.type==="Component"&&this.markNeedsRecomputeInstances(),e.traverseAncestors(t=>{Vt.is(t)&&t.data.type==="Component"&&this.markNeedsRecomputeInstances()}))}relativeizeInner(e,t,i,n,r,s,a){if(e){let o=n.find(e);o&&o!==n&&r.forInstancesRec(l=>{l.data=P0(l.data,c=>{let u=c.events.data(a.id),h=l.goUp(s);if(h){let d=[...WN(h.identity),e].join("-"),p=this.entityIdentityToEntity[d];if(p){let f=p.uuid,v=eo.zoom(u,t);v[i]=f}else console.warn("cannot find instance")}}).data})}}rewriteActions(e,t,i,n,r,s){e.forEach(a=>{a.data.type==="Transition"?this.relativeizeInner(a.data.object,[...t,a.id],"object",i,n,r,s):a.data.type==="Animation"&&this.relativeizeInner(a.data.object,[...t,a.id],"object",i,n,r,s)})}rewriteEventsBeforeGoToPlayMode(){this.traverseEntity(e=>{if(e instanceof ap&&typeof e.identity=="string"&&e.data.type==="Component")return e.traverseEntity((t,i)=>{t.data.events.forEach(n=>{if(n.data.type==="GameControl"){let r=!1;if(t.forInstancesRec(s=>{s.data=P0(s.data,a=>{s.isInstanceRoot||(a.events.delete(n.id),r=!0)}).data}),r===!1)for(let s of nM.list)this.rewriteActions(n.data.gameActions[s],["gameActions",s],e,t,i,n)}else n.data.type==="Conditional"?(n.data.condition.type==="Distance"?(this.relativeizeInner(n.data.condition.fromObject,["condition"],"fromObject",e,t,i,n),this.relativeizeInner(n.data.condition.toObject,["condition"],"toObject",e,t,i,n)):n.data.condition.type==="State"?this.relativeizeInner(n.data.condition.object,["condition"],"object",e,t,i,n):n.data.condition.type==="Comparison"&&(n.data.condition.lOperand.type==="Property"&&this.relativeizeInner(n.data.condition.lOperand.value[0],["condition","lOperand","value"],0,e,t,i,n),n.data.condition.rOperand.type==="Property"&&this.relativeizeInner(n.data.condition.rOperand.value[0],["condition","rOperand","value"],0,e,t,i,n)),this.rewriteActions(n.data.inActions,["inActions"],e,t,i,n),this.rewriteActions(n.data.outActions,["outActions"],e,t,i,n)):"actions"in n.data&&this.rewriteActions(n.data.actions,["actions"],e,t,i,n)})}),!0})}expandInstances(e,t,i){let n=new Set;this.traverseEntity(r=>{if(r instanceof ap&&r.isInstanceRoot)return r.expandInstanceChildren({scene:this,shared:e,pendingDeletes:n}),t||r.resetBBoxNeedsUpdate(),i&&r.traverseEntity(s=>{i.addClip(s)}),!0});for(let r of n)this.disposeAndUnregisterEntityRecursivelyIfNotReregistered(r),BA(r)}recomputeInstances(e,t){this.needsRecomputeInstances&&(this.needsRecomputeInstances=!1,this.traverseEntity(i=>{i instanceof ap&&i.isInstanceRoot&&(i.component=void 0)}),this.expandInstances(e,!1,t))}disposeAndUnregisterEntityRecursivelyIfNotReregistered(e){e.traverseEntity(t=>{let i=typeof t.identity=="string"?t.identity:t.identity.join("-");this.entityIdentityToEntity[i]===t&&(delete this.entityByUuid[t.uuid],delete this.entityIdentityToEntity[i]),t.dispose()})}clearScene(){for(let e of this.children)Vt.is(e)&&e.disposeRecursively();this.children.length=0}resetAfterClear(e,t){this.init(e,t)}raycast(e){return this.raycast1(e,!1)}raycast1(e,t){let i=[],n=r=>{for(let s of r.children){let a=s.cloner;if(Vt.is(s)&&!s.raycastLock&&(s.visible||a!=null&&a.object.data.visible))if(t===!0&&s.isInstanceRoot){let o=[];if(e.intersectObject(s,!0,o),o.length){let l=o[0];l.object=s,l.point.applyMatrix4(l.object.matrixWorld);let c=s.matrixWorld.clone().invert();l.point.applyMatrix4(c),i.push(l)}}else(na(s)||wM(s)&&this.enableHelpers&&s.objectHelper.visible)&&(e.intersectObject(s,!1,i),PM(s,e,i)),n(s)}};return n(this),i}raycastWithClones(e){let t=[],i=n=>{for(let r of n.children){let s=r.cloner;Vt.is(r)&&(r.visible||s!=null&&s.object.data.visible)&&((na(r)||wM(r)&&this.enableHelpers&&r.objectHelper.visible)&&(e.intersectObject(r,!1,t),PM(r,e,t,!0)),i(r))}};return i(this),t}forEachEntity(e){for(let t of this.children)Vt.is(t)&&e(t)}traverseConcreteEntity(e){for(let t of this.children)Vt.is(t)&&t.isConcreteEntity&&t.traverseEntity(e)}traverseEntity(e){for(let t of this.children)Vt.is(t)&&t.traverseEntity(e)}updateFont(e,t){this.traverseEntity(i=>{if(i instanceof dr&&i.data.type==="Mesh"&&i.data.geometry.type==="TextGeometry"&&i.data.geometry.font===e){let n=i.geometry,r=i.data.geometry;n.updateFont(e,t).then(()=>{n.update(r);let s=i.invalidateDownstreamBooleanData();qa(s)&&s.recomputeBoolean()})}})}traverseObject(e){for(let t of this.children)N0.is(t)&&t.traverseObject(e)}traverseVisibleEntity(e){for(let t of this.children)Vt.is(t)&&t.visible&&t.traverseVisibleEntity(e)}dispose(){this.clearScene()}createChildrenObjects(e,t,i){let n=0;for(let r of e)this.createObject(r.id,r.data,r.children,t,n,i),n+=1}registerObjectCreatedInLegacy(e){this.entityByUuid[e.uuid]=e}unregisterObject(e){delete this.entityByUuid[e.uuid];for(let t of e.children)this.unregisterObject(t)}createObject(e,t,i,n,r,s){var l;let a={scene:this,shared:s},o=NA(e,t,a);return o&&(this.entityByUuid[e]=o,n.add(o),n.children.splice(r,0,n.children.pop()),i.length>0&&(o.isInstanceRoot?console.error("instance should not have children!"):this.createChildrenObjects(i,o,s)),o.updateState(t,a),o instanceof dr&&o.updateGeometryGroupsIfNeeded(),o.updateVisible(),o.cloner&&this.toExpandCloner.add(o),(l=t.pathSnapping)!=null&&l.pathId&&this.pathConstraints.setConstraint(e,t.pathSnapping.pathId)),t.type==="Empty"&&t.animations&&o.traverseEntity(c=>{if(c instanceof dr&&c.isSkinnedMesh){let u=c.dataPatched;if(u.bones&&u.boneInverses){let h=u.bones.map(f=>this.find(f)),d=u.boneInverses.map(f=>new ke().fromArray(f)),p=new AE(h,d);c.bind(p,c.bindMatrix)}}else c.matrixAutoUpdate=!0}),o}getCenter(e){let t=[];for(let n=0,r=e.length;n<r;++n){let{id:s,recursive:a}=e[n],o=this.find(s),l=a?o.recursiveBBox:o.singleBBox;t.push(...l.vertices)}let i=new Vi;return i.setFromPoints(t),i.getCenter(oD),oD}copyMatrixWorld(e,t){if(e===null){t.identity();return}let i=this.find(e);i?t.copy(i.matrixWorld):t.identity()}copyParentMatrixWorld(e,t){var n;if(e===null){t.identity();return}let i=(n=this.find(e))==null?void 0:n.parent;i?t.copy(i.matrixWorld):t.identity()}traverseMaterial(e){this.traverseEntity(t=>{if(t instanceof zr)if(Array.isArray(t.material))for(let i=0;i<t.material.length;i++)t.material[i]instanceof Lc&&e(t.material[i]);else t.material instanceof Lc&&e(t.material)})}updateViewPlaneSize(e,t,i=!1){this.traverseConcreteEntity(n=>{n instanceof qn&&n.setViewplaneSize(e,t,i)})}},Xv=(e,t)=>{let i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)},C1e=(e,t)=>{let i=t.x-e.x,n=t.y-e.y;return A1e(Math.atan2(n,i))},E1e=(e,t,i)=>{let n={x:0,y:0};return i=LM(i),n.x=e.x-t*Math.cos(i),n.y=e.y-t*Math.sin(i),n},LM=e=>e*(Math.PI/180),A1e=e=>e*(180/Math.PI),T1e=e=>isNaN(e.buttons)?e.pressure!==0:e.buttons!==0,Yb=new Map,lD=e=>{Yb.has(e)&&clearTimeout(Yb.get(e)),Yb.set(e,setTimeout(e,100))},_x=(e,t,i)=>{let n=t.split(/[ ,]+/g),r;for(let s=0;s<n.length;s+=1)r=n[s],e.addEventListener?e.addEventListener(r,i,!1):e.attachEvent&&e.attachEvent(r,i)},cD=(e,t,i)=>{let n=t.split(/[ ,]+/g),r;for(let s=0;s<n.length;s+=1)r=n[s],e.removeEventListener?e.removeEventListener(r,i):e.detachEvent&&e.detachEvent(r,i)},JF=e=>(e.preventDefault(),e.type.match(/^touch/)?e.changedTouches:e),hD=()=>{if(typeof window>"u")return;let e=window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;return{x:e,y:t}},RM=(e,t)=>{t.top||t.right||t.bottom||t.left?(e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left):(e.style.left=t.x+"px",e.style.top=t.y+"px")},FA=(e,t,i)=>{let n=ez(e);for(let r in n)if(n.hasOwnProperty(r))if(typeof t=="string")n[r]=t+" "+i;else{let s="";for(let a=0,o=t.length;a<o;a+=1)s+=t[a]+" "+i+", ";n[r]=s.slice(0,-2)}return n},P1e=(e,t)=>{let i=ez(e);for(let n in i)i.hasOwnProperty(n)&&(i[n]=t);return i},ez=e=>{let t={};return t[e]="",["webkit","Moz","o"].forEach(function(i){t[i+e.charAt(0).toUpperCase()+e.slice(1)]=""}),t},Zb=(e,t)=>{for(let i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},D1e=(e,t)=>{let i={};for(let n in e)e.hasOwnProperty(n)&&t.hasOwnProperty(n)?i[n]=t[n]:e.hasOwnProperty(n)&&(i[n]=e[n]);return i},IM=(e,t)=>{if(e.length)for(let i=0,n=e.length;i<n;i+=1)t(e[i]);else t(e)},L1e=(e,t,i)=>({x:Math.min(Math.max(e.x,t.x-i),t.x+i),y:Math.min(Math.max(e.y,t.y-i),t.y+i)});typeof window<"u"&&(tz="ontouchstart"in window,iz=!!window.PointerEvent,nz=!!window.MSPointerEvent);var tz,iz,nz,qf={touch:{start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"},pointer:{start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"},MSPointer:{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}},Ud,z0={};iz?Ud=qf.pointer:nz?Ud=qf.MSPointer:tz?(Ud=qf.touch,z0=qf.mouse):Ud=qf.mouse;function ou(){}ou.prototype.on=function(e,t){var i=this,n=e.split(/[ ,]+/g),r;i._handlers_=i._handlers_||{};for(var s=0;s<n.length;s+=1)r=n[s],i._handlers_[r]=i._handlers_[r]||[],i._handlers_[r].push(t);return i};ou.prototype.off=function(e,t){var i=this;return i._handlers_=i._handlers_||{},e===void 0?i._handlers_={}:t===void 0?i._handlers_[e]=null:i._handlers_[e]&&i._handlers_[e].indexOf(t)>=0&&i._handlers_[e].splice(i._handlers_[e].indexOf(t),1),i};ou.prototype.trigger=function(e,t){var i=this,n=e.split(/[ ,]+/g),r;i._handlers_=i._handlers_||{};for(var s=0;s<n.length;s+=1)r=n[s],i._handlers_[r]&&i._handlers_[r].length&&i._handlers_[r].forEach(function(a){a.call(i,{type:r,target:i},t)})};ou.prototype.config=function(e){var t=this;t.options=t.defaults||{},e&&(t.options=D1e(t.options,e))};ou.prototype.bindEvt=function(e,t){var i=this;return i._domHandlers_=i._domHandlers_||{},i._domHandlers_[t]=function(){typeof i["on"+t]=="function"?i["on"+t].apply(i,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},_x(e,Ud[t],i._domHandlers_[t]),z0[t]&&_x(e,z0[t],i._domHandlers_[t]),i};ou.prototype.unbindEvt=function(e,t){var i=this;return i._domHandlers_=i._domHandlers_||{},cD(e,Ud[t],i._domHandlers_[t]),z0[t]&&cD(e,z0[t],i._domHandlers_[t]),delete i._domHandlers_[t],this};var zA=ou;function dn(e,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=e,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=dn.id,dn.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}dn.prototype=new zA;dn.constructor=dn;dn.id=0;dn.prototype.buildEl=function(e){return this.ui={},this.options.dataOnly?this:(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front),this)};dn.prototype.stylize=function(){if(this.options.dataOnly)return this;var e=this.options.fadeTime+"ms",t=P1e("borderRadius","50%"),i=FA("transition","opacity",e),n={};return n.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},n.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:"rgba(255, 255, 255, .4)",border:"solid 2px rgba(0, 0, 0, .1)"},n.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:"rgba(255, 255, 255, .8)",border:"solid 2px rgba(0, 0, 0, .1)"},Zb(n.el,i),this.options.shape==="circle"&&Zb(n.back,t),Zb(n.front,t),this.applyStyles(n),this};dn.prototype.applyStyles=function(e){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var i in e[t])this.ui[t].style[i]=e[t][i];return this};dn.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)?this:(this.options.zone.appendChild(this.ui.el),this)};dn.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)?this:(this.options.zone.removeChild(this.ui.el),this)};dn.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()};dn.prototype.show=function(e){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout(function(){t.ui.el.style.opacity=1},0),t.showTimeout=setTimeout(function(){t.trigger("shown",t.instance),typeof e=="function"&&e.call(this)},t.options.fadeTime)),t};dn.prototype.hide=function(e){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout(function(){var i=t.options.mode==="dynamic"?"none":"block";t.ui.el.style.display=i,typeof e=="function"&&e.call(t),t.trigger("hidden",t.instance)},t.options.fadeTime),t.options.restJoystick){let i=t.options.restJoystick,n={};n.x=i===!0||i.x!==!1?0:t.instance.frontPosition.x,n.y=i===!0||i.y!==!1?0:t.instance.frontPosition.y,t.setPosition(e,n)}return t};dn.prototype.setPosition=function(e,t){var i=this;i.frontPosition={x:t.x,y:t.y};var n=i.options.fadeTime+"ms",r={};r.front=FA("transition",["top","left"],n);var s={front:{}};s.front={left:i.frontPosition.x+"px",top:i.frontPosition.y+"px"},i.applyStyles(r),i.applyStyles(s),i.restTimeout=setTimeout(function(){typeof e=="function"&&e.call(i),i.restCallback()},i.options.fadeTime)};dn.prototype.restCallback=function(){var e=this,t={};t.front=FA("transition","none",""),e.applyStyles(t),e.trigger("rested",e.instance)};dn.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}};dn.prototype.computeDirection=function(e){var t=e.angle.radian,i=Math.PI/4,n=Math.PI/2,r,s,a;if(t>i&&t<i*3&&!e.lockX?r="up":t>-i&&t<=i&&!e.lockY?r="left":t>-i*3&&t<=-i&&!e.lockX?r="down":e.lockY||(r="right"),e.lockY||(t>-n&&t<n?s="left":s="right"),e.lockX||(t>0?a="up":a="down"),e.force>this.options.threshold){var o={},l;for(l in this.direction)this.direction.hasOwnProperty(l)&&(o[l]=this.direction[l]);var c={};this.direction={x:s,y:a,angle:r},e.direction=this.direction;for(l in o)o[l]===this.direction[l]&&(c[l]=!0);if(c.x&&c.y&&c.angle)return e;(!c.x||!c.y)&&this.trigger("plain",e),c.x||this.trigger("plain:"+s,e),c.y||this.trigger("plain:"+a,e),c.angle||this.trigger("dir dir:"+r,e)}else this.resetDirection();return e};var R1e=dn;function ki(e,t){var i=this;i.nipples=[],i.idles=[],i.actives=[],i.ids=[],i.pressureIntervals={},i.manager=e,i.id=ki.id,ki.id+=1,i.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:1,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},i.config(t),(i.options.mode==="static"||i.options.mode==="semi")&&(i.options.multitouch=!1),i.options.multitouch||(i.options.maxNumberOfNipples=1);let n=getComputedStyle(i.options.zone.parentElement);return n&&n.display==="flex"&&(i.parentIsFlex=!0),i.updateBox(),i.prepareNipples(),i.bindings(),i.begin(),i.nipples}ki.prototype=new zA;ki.constructor=ki;ki.id=0;ki.prototype.prepareNipples=function(){var e=this,t=e.nipples;t.on=e.on.bind(e),t.off=e.off.bind(e),t.options=e.options,t.destroy=e.destroy.bind(e),t.ids=e.ids,t.id=e.id,t.processOnMove=e.processOnMove.bind(e),t.processOnEnd=e.processOnEnd.bind(e),t.get=function(i){if(i===void 0)return t[0];for(var n=0,r=t.length;n<r;n+=1)if(t[n].identifier===i)return t[n];return!1}};ki.prototype.bindings=function(){var e=this;e.bindEvt(e.options.zone,"start"),e.options.zone.style.touchAction="none",e.options.zone.style.msTouchAction="none"};ki.prototype.begin=function(){var e=this,t=e.options;if(t.mode==="static"){var i=e.createNipple(t.position,e.manager.getIdentifier());i.add(),e.idles.push(i)}};ki.prototype.createNipple=function(e,t){var i=this,n=i.manager.scroll,r={},s=i.options,a={x:i.parentIsFlex?n.x:n.x+i.box.left,y:i.parentIsFlex?n.y:n.y+i.box.top};if(e.x&&e.y)r={x:e.x-a.x,y:e.y-a.y};else if(e.top||e.right||e.bottom||e.left){var o=document.createElement("DIV");o.style.display="hidden",o.style.top=e.top,o.style.right=e.right,o.style.bottom=e.bottom,o.style.left=e.left,o.style.position="absolute",s.zone.appendChild(o);var l=o.getBoundingClientRect();s.zone.removeChild(o),r=e,e={x:l.left+n.x,y:l.top+n.y}}var c=new R1e(i,{color:s.color,size:s.size,threshold:s.threshold,fadeTime:s.fadeTime,dataOnly:s.dataOnly,restJoystick:s.restJoystick,restOpacity:s.restOpacity,mode:s.mode,identifier:t,position:e,zone:s.zone,frontPosition:{x:0,y:0},shape:s.shape});return s.dataOnly||(RM(c.ui.el,r),RM(c.ui.front,c.frontPosition)),i.nipples.push(c),i.trigger("added "+c.identifier+":added",c),i.manager.trigger("added "+c.identifier+":added",c),i.bindNipple(c),c};ki.prototype.updateBox=function(){var e=this;e.box=e.options.zone.getBoundingClientRect()};ki.prototype.bindNipple=function(e){var t=this,i,n=function(r,s){i=r.type+" "+s.id+":"+r.type,t.trigger(i,s)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",n),e.on("dir:up dir:right dir:down dir:left",n),e.on("plain:up plain:right plain:down plain:left",n)};ki.prototype.pressureFn=function(e,t,i){var n=this,r=0;clearInterval(n.pressureIntervals[i]),n.pressureIntervals[i]=setInterval((function(){var s=e.force||e.pressure||e.webkitForce||0;s!==r&&(t.trigger("pressure",s),n.trigger("pressure "+t.identifier+":pressure",s),r=s)}).bind(n),100)};ki.prototype.onstart=function(e){var t=this,i=t.options,n=e;e=JF(e),t.updateBox();var r=function(s){t.actives.length<i.maxNumberOfNipples?t.processOnStart(s):n.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach(function(a){if(Object.values(n.touches).findIndex(function(l){return l.identifier===a})<0){var o=[e[0]];o.identifier=a,t.processOnEnd(o)}}),t.actives.length<i.maxNumberOfNipples&&t.processOnStart(s))};return IM(e,r),t.manager.bindDocument(),!1};ki.prototype.processOnStart=function(e){var t=this,i=t.options,n,r=t.manager.getIdentifier(e),s=e.force||e.pressure||e.webkitForce||0,a={x:e.pageX,y:e.pageY},o=t.getOrCreate(r,a);o.identifier!==r&&t.manager.removeIdentifier(o.identifier),o.identifier=r;var l=function(u){u.trigger("start",u),t.trigger("start "+u.id+":start",u),u.show(),s>0&&t.pressureFn(e,u,u.identifier),t.processOnMove(e)};if((n=t.idles.indexOf(o))>=0&&t.idles.splice(n,1),t.actives.push(o),t.ids.push(o.identifier),i.mode!=="semi")l(o);else{var c=Xv(a,o.position);if(c<=i.catchDistance)l(o);else{o.destroy(),t.processOnStart(e);return}}return o};ki.prototype.getOrCreate=function(e,t){var i=this,n=i.options,r;return/(semi|static)/.test(n.mode)?(r=i.idles[0],r?(i.idles.splice(0,1),r):n.mode==="semi"?i.createNipple(t,e):(console.warn("Coudln't find the needed nipple."),!1)):(r=i.createNipple(t,e),r)};ki.prototype.processOnMove=function(e){var t=this,i=t.options,n=t.manager.getIdentifier(e),r=t.nipples.get(n),s=t.manager.scroll;if(!T1e(e)){this.processOnEnd(e);return}if(!r){console.error("Found zombie joystick with ID "+n),t.manager.removeIdentifier(n);return}if(i.dynamicPage){var a=r.el.getBoundingClientRect();r.position={x:s.x+a.left,y:s.y+a.top}}r.identifier=n;var o=r.options.size/2,l={x:e.pageX,y:e.pageY};i.lockX&&(l.y=r.position.y),i.lockY&&(l.x=r.position.x);var c=Xv(l,r.position),u=C1e(l,r.position),h=LM(u),d=c/o,p={distance:c,position:l},f,v;if(r.options.shape==="circle"?(f=Math.min(c,o),v=E1e(r.position,f,u)):(v=L1e(l,r.position,o),f=Xv(v,r.position)),i.follow){if(c>o){let x=l.x-v.x,_=l.y-v.y;r.position.x+=x,r.position.y+=_,r.el.style.top=r.position.y-(t.box.top+s.y)+"px",r.el.style.left=r.position.x-(t.box.left+s.x)+"px",c=Xv(l,r.position)}}else l=v,c=f;var m=l.x-r.position.x,g=l.y-r.position.y;r.frontPosition={x:m,y:g},i.dataOnly||RM(r.ui.front,r.frontPosition);var y={identifier:r.identifier,position:l,force:d,pressure:e.force||e.pressure||e.webkitForce||0,distance:c,angle:{radian:h,degree:u},vector:{x:m/o,y:-g/o},raw:p,instance:r,lockX:i.lockX,lockY:i.lockY};y=r.computeDirection(y),y.angle={radian:LM(180-u),degree:180-u},r.trigger("move",y),t.trigger("move "+r.id+":move",y)};ki.prototype.processOnEnd=function(e){var t=this,i=t.options,n=t.manager.getIdentifier(e),r=t.nipples.get(n),s=t.manager.removeIdentifier(r.identifier);!r||(i.dataOnly||r.hide(function(){i.mode==="dynamic"&&(r.trigger("removed",r),t.trigger("removed "+r.id+":removed",r),t.manager.trigger("removed "+r.id+":removed",r),r.destroy())}),clearInterval(t.pressureIntervals[r.identifier]),r.resetDirection(),r.trigger("end",r),t.trigger("end "+r.id+":end",r),t.ids.indexOf(r.identifier)>=0&&t.ids.splice(t.ids.indexOf(r.identifier),1),t.actives.indexOf(r)>=0&&t.actives.splice(t.actives.indexOf(r),1),/(semi|static)/.test(i.mode)?t.idles.push(r):t.nipples.indexOf(r)>=0&&t.nipples.splice(t.nipples.indexOf(r),1),t.manager.unbindDocument(),/(semi|static)/.test(i.mode)&&(t.manager.ids[s.id]=s.identifier))};ki.prototype.onDestroyed=function(e,t){var i=this;i.nipples.indexOf(t)>=0&&i.nipples.splice(i.nipples.indexOf(t),1),i.actives.indexOf(t)>=0&&i.actives.splice(i.actives.indexOf(t),1),i.idles.indexOf(t)>=0&&i.idles.splice(i.idles.indexOf(t),1),i.ids.indexOf(t.identifier)>=0&&i.ids.splice(i.ids.indexOf(t.identifier),1),i.manager.removeIdentifier(t.identifier),i.manager.unbindDocument()};ki.prototype.destroy=function(){var e=this;e.unbindEvt(e.options.zone,"start"),e.nipples.forEach(function(i){i.destroy()});for(var t in e.pressureIntervals)e.pressureIntervals.hasOwnProperty(t)&&clearInterval(e.pressureIntervals[t]);e.trigger("destroyed",e.nipples),e.manager.unbindDocument(),e.off()};var I1e=ki;function En(e){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=hD(),t.config(e),t.prepareCollections();var i=function(){var r;t.collections.forEach(function(s){s.forEach(function(a){r=a.el.getBoundingClientRect(),a.position={x:t.scroll.x+r.left,y:t.scroll.y+r.top}})})};if(typeof window>"u")return t.collections;_x(window,"resize",function(){lD(i)});var n=function(){t.scroll=hD()};return _x(window,"scroll",function(){lD(n)}),t.collections}En.prototype=new zA;En.constructor=En;En.prototype.prepareCollections=function(){var e=this;e.collections.create=e.create.bind(e),e.collections.on=e.on.bind(e),e.collections.off=e.off.bind(e),e.collections.destroy=e.destroy.bind(e),e.collections.get=function(t){var i;return e.collections.every(function(n){return i=n.get(t),!i}),i}};En.prototype.create=function(e){return this.createCollection(e)};En.prototype.createCollection=function(e){var t=this,i=new I1e(t,e);return t.bindCollection(i),t.collections.push(i),i};En.prototype.bindCollection=function(e){var t=this,i,n=function(r,s){i=r.type+" "+s.id+":"+r.type,t.trigger(i,s)};e.on("destroyed",t.onDestroyed.bind(t)),e.on("shown hidden rested dir plain",n),e.on("dir:up dir:right dir:down dir:left",n),e.on("plain:up plain:right plain:down plain:left",n)};En.prototype.bindDocument=function(){var e=this;e.binded||(e.bindEvt(document,"move").bindEvt(document,"end"),e.binded=!0)};En.prototype.unbindDocument=function(e){var t=this;(!Object.keys(t.ids).length||e===!0)&&(t.unbindEvt(document,"move").unbindEvt(document,"end"),t.binded=!1)};En.prototype.getIdentifier=function(e){var t;return e?(t=e.identifier===void 0?e.pointerId:e.identifier,t===void 0&&(t=this.latest||0)):t=this.index,this.ids[t]===void 0&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]};En.prototype.removeIdentifier=function(e){var t={};for(var i in this.ids)if(this.ids[i]===e){t.id=i,t.identifier=this.ids[i],delete this.ids[i];break}return t};En.prototype.onmove=function(e){var t=this;return t.onAny("move",e),!1};En.prototype.onend=function(e){var t=this;return t.onAny("end",e),!1};En.prototype.oncancel=function(e){var t=this;return t.onAny("end",e),!1};En.prototype.onAny=function(e,t){var i=this,n,r="processOn"+e.charAt(0).toUpperCase()+e.slice(1);t=JF(t);var s=function(o,l,c){c.ids.indexOf(l)>=0&&(c[r](o),o._found_=!0)},a=function(o){n=i.getIdentifier(o),IM(i.collections,s.bind(null,o,n)),o._found_||i.removeIdentifier(n)};return IM(t,a),!1};En.prototype.destroy=function(){var e=this;e.unbindDocument(!0),e.ids={},e.index=0,e.collections.forEach(function(t){t.destroy()}),e.off()};En.prototype.onDestroyed=function(e,t){var i=this;if(i.collections.indexOf(t)<0)return!1;i.collections.splice(i.collections.indexOf(t),1)};var O1e=En,uD=new O1e,B1e={create:function(e){return uD.create(e)},factory:uD},rz=new Map,jm=new Map,Sh=class{constructor(e,t,i,n){this.data=t;let{audio:r,volume:s,delay:a,loop:o}=t;if(!r)throw new Error("Missing property");let l=typeof r=="string"?n.getAudio(r).src:r.data;this.audioPlayer=new ym({src:l,volume:s,delay:a,loop:o}),jm.has(i.uuid)?jm.get(i.uuid).push(this):jm.set(i.uuid,[this]),rz.set(e,this)}playByToggle(){this.data.toggle==="stop"?this.audioPlayer.status==="playing"?this.audioPlayer.stop():(this.audioPlayer.stop(),this.audioPlayer.play()):this.data.toggle==="pause"?this.audioPlayer.status==="playing"?this.audioPlayer.pause():this.audioPlayer.play():(this.audioPlayer.stop(),this.audioPlayer.play())}dispose(){this.audioPlayer.stop()}},OM=class{constructor(e){this.data=e}dispatch(){this.data.playAudio?this.pauseAudio(this.data.playAudio):this.data.object?this.pauseAllAudiosFromObject(this.data.object):this.pauseAllAudios()}pauseAudio(e){let t=rz.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.audioPlayer[this.data.interaction](),this.disposeDelay()},this.data.delay)):t.audioPlayer[this.data.interaction]())}pauseAllAudiosFromObject(e){let t=jm.get(e);!(t!=null&&t.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(i=>i.audioPlayer[this.data.interaction]()),this.disposeDelay()},this.data.delay)):t.forEach(i=>i.audioPlayer[this.data.interaction]()))}pauseAllAudios(){let e=[...jm.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(t=>{t.forEach(i=>{i.audioPlayer[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):e.forEach(t=>{t.forEach(i=>{i.audioPlayer[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},Wm=class{constructor(e,t,i,n){if(this.data=t,t.interaction==="play")this.interaction=new Sh(e,t,i,n);else if(t.interaction==="pause"||t.interaction==="stop")this.interaction=new OM(t);else throw new Error("Missing property")}dispatchBasic(){this.interaction instanceof Sh?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){this.interaction instanceof Sh?this.interaction.audioPlayer.play():this.interaction.dispatch()}dispatchGameControl(e){this.interaction instanceof Sh&&(e==="start"?this.interaction.audioPlayer.play():this.interaction.audioPlayer.stop())}dispose(){this.interaction.dispose()}},N1e="text/plain",U1e="us-ascii",dD=(e,t)=>t.some(i=>i instanceof RegExp?i.test(e):i===e),F1e=(e,{stripHash:t})=>{let i=/^data:(?<type>[^,]*?),(?<data>[^#]*?)(?:#(?<hash>.*))?$/.exec(e);if(!i)throw new Error(`Invalid URL: ${e}`);let{type:n,data:r,hash:s}=i.groups,a=n.split(";");s=t?"":s;let o=!1;a[a.length-1]==="base64"&&(a.pop(),o=!0);let l=(a.shift()||"").toLowerCase(),c=[...a.map(u=>{let[h,d=""]=u.split("=").map(p=>p.trim());return h==="charset"&&(d=d.toLowerCase(),d===U1e)?"":`${h}${d?`=${d}`:""}`}).filter(Boolean)];return o&&c.push("base64"),(c.length>0||l&&l!==N1e)&&c.unshift(l),`data:${c.join(";")},${o?r.trim():r}${s?`#${s}`:""}`};function z1e(e,t){if(t={defaultProtocol:"http:",normalizeProtocol:!0,forceHttp:!1,forceHttps:!1,stripAuthentication:!0,stripHash:!1,stripTextFragment:!0,stripWWW:!0,removeQueryParameters:[/^utm_\w+/i],removeTrailingSlash:!0,removeSingleSlash:!0,removeDirectoryIndex:!1,sortQueryParameters:!0,...t},e=e.trim(),/^data:/i.test(e))return F1e(e,t);if(/^view-source:/i.test(e))throw new Error("`view-source:` is not supported as it is a non-standard protocol");let i=e.startsWith("//");!i&&/^\.*\//.test(e)||(e=e.replace(/^(?!(?:\w+:)?\/\/)|^\/\//,t.defaultProtocol));let n=new URL(e);if(t.forceHttp&&t.forceHttps)throw new Error("The `forceHttp` and `forceHttps` options cannot be used together");if(t.forceHttp&&n.protocol==="https:"&&(n.protocol="http:"),t.forceHttps&&n.protocol==="http:"&&(n.protocol="https:"),t.stripAuthentication&&(n.username="",n.password=""),t.stripHash?n.hash="":t.stripTextFragment&&(n.hash=n.hash.replace(/#?:~:text.*?$/i,"")),n.pathname){let s=/\b[a-z][a-z\d+\-.]{1,50}:\/\//g,a=0,o="";for(;;){let c=s.exec(n.pathname);if(!c)break;let u=c[0],h=c.index,d=n.pathname.slice(a,h);o+=d.replace(/\/{2,}/g,"/"),o+=u,a=h+u.length}let l=n.pathname.slice(a,n.pathname.length);o+=l.replace(/\/{2,}/g,"/"),n.pathname=o}if(n.pathname)try{n.pathname=decodeURI(n.pathname)}catch{}if(t.removeDirectoryIndex===!0&&(t.removeDirectoryIndex=[/^index\.[a-z]+$/]),Array.isArray(t.removeDirectoryIndex)&&t.removeDirectoryIndex.length>0){let s=n.pathname.split("/"),a=s[s.length-1];dD(a,t.removeDirectoryIndex)&&(s=s.slice(0,-1),n.pathname=s.slice(1).join("/")+"/")}if(n.hostname&&(n.hostname=n.hostname.replace(/\.$/,""),t.stripWWW&&/^www\.(?!www\.)[a-z\-\d]{1,63}\.[a-z.\-\d]{2,63}$/.test(n.hostname)&&(n.hostname=n.hostname.replace(/^www\./,""))),Array.isArray(t.removeQueryParameters))for(let s of[...n.searchParams.keys()])dD(s,t.removeQueryParameters)&&n.searchParams.delete(s);if(t.removeQueryParameters===!0&&(n.search=""),t.sortQueryParameters){n.searchParams.sort();try{n.search=decodeURIComponent(n.search)}catch{}}t.removeTrailingSlash&&(n.pathname=n.pathname.replace(/\/$/,""));let r=e;return e=n.toString(),!t.removeSingleSlash&&n.pathname==="/"&&!r.endsWith("/")&&n.hash===""&&(e=e.replace(/\/$/,"")),(t.removeTrailingSlash||n.pathname==="/")&&n.hash===""&&t.removeSingleSlash&&(e=e.replace(/\/$/,"")),i&&!t.normalizeProtocol&&(e=e.replace(/^http:\/\//,"//")),t.stripProtocol&&(e=e.replace(/^(?:https?:)?\/\//,"")),e}var k1e=class{constructor({url:e,context:t},i){if(this.eventManager=i,!e)throw new Error("Missing property");this.url=e.startsWith("mailto:")?e:z1e(e,{removeTrailingSlash:!1,removeSingleSlash:!1}),this.context=t??"tab"}dispatch(){var e;jN?window.location.assign(this.url):(this.context==="tab"?window.open(this.url,"_blank"):this.context==="window"?window.open(this.url,"_blank",`width=${window.innerWidth}, height=${window.innerHeight}`):window.open(this.url,"_parent"),(e=this.eventManager.controlsManager.orbitControls)==null||e.onPointerUp(dt[0]),Qhe())}},sz=class{constructor(e,t,i){this.data=e,this.page=t,this.eventManager=i,this.timeoutIdQueue=[],this.dispatchInner=()=>{this.objects.forEach(this.destroyCallback)},this.destroyCallback=n=>{var o,l;this.timeoutIdQueue.shift();let r=this.page.scene.find(n);if(r===void 0)return;let s=this.controlsManager.sharedGameControlGlobals.rapierWorld,a=s?(o=r.dataPatched.physics)==null?void 0:o.fusedBody:!0;if(r.cloner){for(let c of r.cloner.children)a?(c.playModeVisible=!1,c.rigidBody&&((l=r.dataPatched.physics)==null?void 0:l.rigidBody)==="positioned"&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(c.rigidBody.collider(0).handle),s.removeRigidBody(c.rigidBody),c.rigidBody=void 0),c.bvhGeometry&&(c.bvhGeometry=void 0)):this.clone===void 0||this.clone===c?(c.playModeVisible=!1,c.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(c.rigidBody.collider(0).handle),s.removeRigidBody(c.rigidBody),c.rigidBody=void 0)):c.playModeVisible===void 0&&(c.playModeVisible=!0);(a||this.clone===void 0||this.clone===!1)&&(r.visible=!1,r.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(r.rigidBody.collider(0).handle),s.removeRigidBody(r.rigidBody),r.rigidBody=void 0),r.bvhGeometry&&(r.bvhGeometry=void 0))}else r.rigidBody&&(this.controlsManager.sharedGameControlGlobals.colliderToEntity.delete(r.rigidBody.collider(0).handle),s.removeRigidBody(r.rigidBody),r.rigidBody=void 0),r.bvhGeometry&&(r.bvhGeometry=void 0),r.visible=!1;s===void 0?this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(c=>c.bvhGeometry!==void 0):this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim=this.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.filter(c=>c.rigidBody!==void 0),this.eventManager.requestRender()},this.objects=[...e.objects],this.controlsManager=i.controlsManager}dispatch(e){this.clone=e,this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()}dispatchFromStart(){this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))}dispose(){this.timeoutIdQueue.forEach(e=>window.clearTimeout(e))}},az=class{constructor(e,t,i,n){this.data=e,this.page=t,this.eventManager=n,this.sharedAssets=i}dispatch(){clearTimeout(this.timeoutId),delete this.timeoutId,this.timeoutId=window.setTimeout(()=>{var e;ZA(this.page,this.sharedAssets,!0),this.eventManager.reset(),(e=this.eventManager.controlsManager.gameControl)==null||e.reset(!0),this.page.switchToPlayCamera(),this.eventManager.controlsManager.requestRender(),delete this.timeoutId},(this.data.delay??0)*1e3)}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},oz={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,timelineChangeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0,rewind:!0},kA={duration:1e3,delay:0,endDelay:0,startOnceDelay:0,pingPongDelayCorrection:0,pingPongEndDelayCorrection:0,easing:"easeOutElastic(1, .5)",round:0},V1e=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],bx={CSS:{},springs:{}};function ua(e,t,i){return Math.min(Math.max(e,t),i)}function Xm(e,t){return e.indexOf(t)>-1}function Qb(e,t){return e.apply(null,t)}var ft={arr:function(e){return Array.isArray(e)},obj:function(e){return Xm(Object.prototype.toString.call(e),"Object")},pth:function(e){return ft.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return!("isNode"in e)&&(e.nodeType||ft.svg(e))},str:function(e){return typeof e=="string"},fnc:function(e){return typeof e=="function"},und:function(e){return typeof e>"u"},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return ft.hex(e)||ft.rgb(e)||ft.hsl(e)},key:function(e){return!oz.hasOwnProperty(e)&&!kA.hasOwnProperty(e)&&e!=="targets"&&e!=="keyframes"}};function lz(e){var t=/\(([^)]+)\)/.exec(e);return t?t[1].split(",").map(function(i){return parseFloat(i)}):[]}function cz(e,t){var i=lz(e),n=ua(ft.und(i[0])?1:i[0],.1,100),r=ua(ft.und(i[1])?100:i[1],.1,100),s=ua(ft.und(i[2])?10:i[2],.1,100),a=ua(ft.und(i[3])?0:i[3],.1,100),o=Math.sqrt(r/n),l=s/(2*Math.sqrt(r*n)),c=l<1?o*Math.sqrt(1-l*l):0,u=1,h=l<1?(l*o+-a)/c:-a+o;function d(f){var v=t?t*f/1e3:f;return l<1?v=Math.exp(-v*l*o)*(u*Math.cos(c*v)+h*Math.sin(c*v)):v=(u+h*v)*Math.exp(-v*o),f===0||f===1?f:1-v}function p(){var f=bx.springs[e];if(f)return f;for(var v=1/6,m=0,g=0;;)if(m+=v,d(m)===1){if(g++,g>=16)break}else g=0;var y=m*v*1e3;return bx.springs[e]=y,y}return t?d:p}function H1e(e){return e===void 0&&(e=10),function(t){return Math.ceil(ua(t,1e-6,1)*e)*(1/e)}}var G1e=function(){var e=11,t=1/(e-1);function i(u,h){return 1-3*h+3*u}function n(u,h){return 3*h-6*u}function r(u){return 3*u}function s(u,h,d){return((i(h,d)*u+n(h,d))*u+r(h))*u}function a(u,h,d){return 3*i(h,d)*u*u+2*n(h,d)*u+r(h)}function o(u,h,d,p,f){var v,m,g=0;do m=h+(d-h)/2,v=s(m,p,f)-u,v>0?d=m:h=m;while(Math.abs(v)>1e-7&&++g<10);return m}function l(u,h,d,p){for(var f=0;f<4;++f){var v=a(h,d,p);if(v===0)return h;var m=s(h,d,p)-u;h-=m/v}return h}function c(u,h,d,p){if(!(0<=u&&u<=1&&0<=d&&d<=1))return;var f=new Float32Array(e);if(u!==h||d!==p)for(var v=0;v<e;++v)f[v]=s(v*t,u,d);function m(g){for(var y=0,x=1,_=e-1;x!==_&&f[x]<=g;++x)y+=t;--x;var b=(g-f[x])/(f[x+1]-f[x]),w=y+b*t,M=a(w,u,d);return M>=.001?l(g,w,u,d):M===0?w:o(g,y,y+t,u,d)}return function(g){return u===h&&d===p||g===0||g===1?g:s(m(g),h,p)}}return c}(),hz=function(){var e={linear:function(){return function(n){return n}}},t={Sine:function(){return function(n){return 1-Math.cos(n*Math.PI/2)}},Circ:function(){return function(n){return 1-Math.sqrt(1-n*n)}},Back:function(){return function(n){return n*n*(3*n-2)}},Bounce:function(){return function(n){for(var r,s=4;n<((r=Math.pow(2,--s))-1)/11;);return 1/Math.pow(4,3-s)-7.5625*Math.pow((r*3-2)/22-n,2)}},Elastic:function(n,r){n===void 0&&(n=1),r===void 0&&(r=.5);var s=ua(n,1,10),a=ua(r,.1,2);return function(o){return o===0||o===1?o:-s*Math.pow(2,10*(o-1))*Math.sin((o-1-a/(Math.PI*2)*Math.asin(1/s))*(Math.PI*2)/a)}}},i=["Quad","Cubic","Quart","Quint","Expo"];return i.forEach(function(n,r){t[n]=function(){return function(s){return Math.pow(s,r+2)}}}),Object.keys(t).forEach(function(n){var r=t[n];e["easeIn"+n]=r,e["easeOut"+n]=function(s,a){return function(o){return 1-r(s,a)(1-o)}},e["easeInOut"+n]=function(s,a){return function(o){return o<.5?r(s,a)(o*2)/2:1-r(s,a)(o*-2+2)/2}}}),e}();function VA(e,t){if(ft.fnc(e))return e;var i=e.split("(")[0],n=hz[i],r=lz(e);switch(i){case"spring":return cz(e,t);case"cubicBezier":return Qb(G1e,r);case"steps":return Qb(H1e,r);default:return Qb(n,r)}}function uz(e){try{var t=document.querySelectorAll(e);return t}catch{return}}function E2(e,t){for(var i=e.length,n=arguments.length>=2?arguments[1]:void 0,r=[],s=0;s<i;s++)if(s in e){var a=e[s];t.call(n,a,s,e)&&r.push(a)}return r}function A2(e){return e.reduce(function(t,i){return t.concat(ft.arr(i)?A2(i):i)},[])}function pD(e){return ft.arr(e)?e:(ft.str(e)&&(e=uz(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function HA(e,t){return e.some(function(i){return i===t})}function GA(e){var t={};for(var i in e)t[i]=e[i];return t}function BM(e,t){var i=GA(e);for(var n in e)i[n]=t.hasOwnProperty(n)?t[n]:e[n];return i}function T2(e,t){var i=GA(e);for(var n in t)i[n]=ft.und(e[n])?t[n]:e[n];return i}function j1e(e){var t=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(e);return t?"rgba("+t[1]+",1)":e}function W1e(e){var t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,i=e.replace(t,function(o,l,c,u){return l+l+c+c+u+u}),n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(i),r=parseInt(n[1],16),s=parseInt(n[2],16),a=parseInt(n[3],16);return"rgba("+r+","+s+","+a+",1)"}function X1e(e){var t=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e),i=parseInt(t[1],10)/360,n=parseInt(t[2],10)/100,r=parseInt(t[3],10)/100,s=t[4]||1;function a(d,p,f){return f<0&&(f+=1),f>1&&(f-=1),f<1/6?d+(p-d)*6*f:f<1/2?p:f<2/3?d+(p-d)*(2/3-f)*6:d}var o,l,c;if(n==0)o=l=c=r;else{var u=r<.5?r*(1+n):r+n-r*n,h=2*r-u;o=a(h,u,i+1/3),l=a(h,u,i),c=a(h,u,i-1/3)}return"rgba("+o*255+","+l*255+","+c*255+","+s+")"}function q1e(e){if(ft.rgb(e))return j1e(e);if(ft.hex(e))return W1e(e);if(ft.hsl(e))return X1e(e)}function rl(e){var t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e);if(t)return t[1]}function Y1e(e){if(Xm(e,"translate")||e==="perspective")return"px";if(Xm(e,"rotate")||Xm(e,"skew"))return"deg"}function NM(e,t){return ft.fnc(e)?e(t.target,t.id,t.total):e}function Qa(e,t){return e.getAttribute(t)}function jA(e,t,i){var n=rl(t);if(HA([i,"deg","rad","turn"],n))return t;var r=bx.CSS[t+i];if(!ft.und(r))return r;var s=100,a=document.createElement(e.tagName),o=e.parentNode&&e.parentNode!==document?e.parentNode:document.body;o.appendChild(a),a.style.position="absolute",a.style.width=s+i;var l=s/a.offsetWidth;o.removeChild(a);var c=l*parseFloat(t);return bx.CSS[t+i]=c,c}function dz(e,t,i){if(t in e.style){var n=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),r=e.style[t]||getComputedStyle(e).getPropertyValue(n)||"0";return i?jA(e,r,i):r}}function WA(e,t){if(ft.dom(e)&&!ft.inp(e)&&(Qa(e,t)||ft.svg(e)&&e[t]))return"attribute";if(ft.dom(e)&&HA(V1e,t))return"transform";if(ft.dom(e)&&t!=="transform"&&dz(e,t))return"css";if(e[t]!=null)return"object"}function pz(e){if(ft.dom(e)){for(var t=e.style.transform||"",i=/(\w+)\(([^)]*)\)/g,n=new Map,r;r=i.exec(t);)n.set(r[1],r[2]);return n}}function Z1e(e,t,i,n){var r=Xm(t,"scale")?1:0+Y1e(t),s=pz(e).get(t)||r;return i&&(i.transforms.list.set(t,s),i.transforms.last=t),n?jA(e,s,n):s}function XA(e,t,i,n){switch(WA(e,t)){case"transform":return Z1e(e,t,n,i);case"css":return dz(e,t,i);case"attribute":return Qa(e,t);default:return e[t]||0}}function qA(e,t){var i=/^(\*=|\+=|-=)/.exec(e);if(!i)return e;var n=rl(e)||0,r=parseFloat(t),s=parseFloat(e.replace(i[0],""));switch(i[0][0]){case"+":return r+s+n;case"-":return r-s+n;case"*":return r*s+n}}function fz(e,t){if(ft.col(e))return q1e(e);if(/\s/g.test(e))return e;var i=rl(e),n=i?e.substr(0,e.length-i.length):e;return t?n+t:n}function YA(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Q1e(e){return Math.PI*2*Qa(e,"r")}function K1e(e){return Qa(e,"width")*2+Qa(e,"height")*2}function $1e(e){return YA({x:Qa(e,"x1"),y:Qa(e,"y1")},{x:Qa(e,"x2"),y:Qa(e,"y2")})}function mz(e){for(var t=e.points,i=0,n,r=0;r<t.numberOfItems;r++){var s=t.getItem(r);r>0&&(i+=YA(n,s)),n=s}return i}function J1e(e){var t=e.points;return mz(e)+YA(t.getItem(t.numberOfItems-1),t.getItem(0))}function gz(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return Q1e(e);case"rect":return K1e(e);case"line":return $1e(e);case"polyline":return mz(e);case"polygon":return J1e(e)}}function eve(e){var t=gz(e);return e.setAttribute("stroke-dasharray",t),t}function tve(e){for(var t=e.parentNode;ft.svg(t)&&ft.svg(t.parentNode);)t=t.parentNode;return t}function vz(e,t){var i=t||{},n=i.el||tve(e),r=n.getBoundingClientRect(),s=Qa(n,"viewBox"),a=r.width,o=r.height,l=i.viewBox||(s?s.split(" "):[0,0,a,o]);return{el:n,viewBox:l,x:l[0]/1,y:l[1]/1,w:a/l[2],h:o/l[3]}}function ive(e,t){var i=ft.str(e)?uz(e)[0]:e,n=t||100;return function(r){return{property:r,el:i,svg:vz(i),totalLength:gz(i)*(n/100)}}}function nve(e,t){function i(o){o===void 0&&(o=0);var l=t+o>=1?t+o:0;return e.el.getPointAtLength(l)}var n=vz(e.el,e.svg),r=i(),s=i(-1),a=i(1);switch(e.property){case"x":return(r.x-n.x)*n.w;case"y":return(r.y-n.y)*n.h;case"angle":return Math.atan2(a.y-s.y,a.x-s.x)*180/Math.PI}}function fD(e,t){var i=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,n=fz(ft.pth(e)?e.totalLength:e,t)+"";return{original:n,numbers:n.match(i)?n.match(i).map(Number):[0],strings:ft.str(e)||t?n.split(i):[]}}function yz(e){var t=e?A2(ft.arr(e)?e.map(pD):pD(e)):[];return E2(t,function(i,n,r){return r.indexOf(i)===n})}function xz(e){var t=yz(e);return t.map(function(i,n){return{target:i,id:n,total:t.length,transforms:{list:pz(i)}}})}function rve(e,t){var i=GA(t);if(/^spring/.test(i.easing)&&(i.duration=cz(i.easing)),ft.arr(e)){var n=e.length,r=n===2&&!ft.obj(e[0]);r?e={value:e}:ft.fnc(t.duration)||(i.duration=t.duration/n)}var s=ft.arr(e)?e:[e];return s.map(function(a,o){var l=ft.obj(a)&&!ft.pth(a)?a:{value:a};return ft.und(l.delay)&&(l.delay=o?0:t.delay),ft.und(l.endDelay)&&(l.endDelay=o===s.length-1?t.endDelay:0),l}).map(function(a){return T2(a,i)})}function sve(e){for(var t=E2(A2(e.map(function(s){return Object.keys(s)})),function(s){return ft.key(s)}).reduce(function(s,a){return s.indexOf(a)<0&&s.push(a),s},[]),i={},n=function(s){var a=t[s];i[a]=e.map(function(o){var l={};for(var c in o)ft.key(c)?c==a&&(l.value=o[c]):l[c]=o[c];return l})},r=0;r<t.length;r++)n(r);return i}function ave(e,t){var i=[],n=t.keyframes;n&&(t=T2(sve(n),t));for(var r in t)ft.key(r)&&i.push({name:r,tweens:rve(t[r],e)});return i}function ove(e,t){var i={};for(var n in e){var r=NM(e[n],t);ft.arr(r)&&(r=r.map(function(s){return NM(s,t)}),r.length===1&&(r=r[0])),i[n]=r}return i.duration=parseFloat(i.duration),i.delay=parseFloat(i.delay),i}function lve(e,t){var i;return e.tweens.map(function(n){var r=ove(n,t),s=r.value,a=ft.arr(s)?s[1]:s,o=rl(a),l=XA(t.target,e.name,o,t),c=i?i.to.original:l,u=ft.arr(s)?s[0]:c,h=rl(u)||rl(l),d=o||h;return ft.und(a)&&(a=c),r.from=fD(u,d),r.to=fD(qA(a,u),d),r.start=i?i.end:0,r.end=r.start+r.delay+r.duration+r.endDelay,r.easing=VA(r.easing,r.duration),r.isPath=ft.pth(s),r.isColor=ft.col(r.from.original),r.isColor&&(r.round=1),i=r,r})}var _z={css:function(e,t,i){return e.style[t]=i},attribute:function(e,t,i){return e.setAttribute(t,i)},object:function(e,t,i){return e[t]=i},transform:function(e,t,i,n,r){if(n.list.set(t,i),t===n.last||r){var s="";n.list.forEach(function(a,o){s+=o+"("+a+") "}),e.style.transform=s}}};function bz(e,t){var i=xz(e);i.forEach(function(n){for(var r in t){var s=NM(t[r],n),a=n.target,o=rl(s),l=XA(a,r,o,n),c=o||rl(l),u=qA(fz(s,c),l),h=WA(a,r);_z[h](a,r,u,n.transforms,!0)}})}function cve(e,t){var i=WA(e.target,t.name);if(i){var n=lve(t,e),r=n[n.length-1];return{type:i,property:t.name,animatable:e,tweens:n,duration:r.end,delay:n[0].delay,endDelay:r.endDelay}}}function hve(e,t){return E2(A2(e.map(function(i){return t.map(function(n){return cve(i,n)})})),function(i){return!ft.und(i)})}function wz(e,t){var i=e.length,n=function(s){return s.timelineOffset?s.timelineOffset:0},r={};return r.duration=i?Math.max.apply(Math,e.map(function(s){let a=s.startOnceDelay??0,o=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return n(s)+a+o+l+s.duration*(s.loop??1)})):t.duration,r.delay=i?Math.min.apply(Math,e.map(function(s){let a=s.startOnceDelay??0,o=s.pingPongDelayCorrection??0;return n(s)+a+o+s.delay})):t.delay,r.endDelay=i?r.duration-Math.max.apply(Math,e.map(function(s){let a=s.startOnceDelay??0,o=s.pingPongDelayCorrection??0,l=s.pingPongEndDelayCorrection??0;return n(s)+a+o+s.duration*(s.loop??1)-s.endDelay-l})):t.endDelay,r}var mD=0;function uve(e){var t=BM(oz,e),i=BM(kA,e),n=ave(i,e),r=xz(e.targets),s=hve(r,n),a=wz(s,i),o=mD;return mD++,T2(t,{id:o,children:[],animatables:r,animations:s,duration:a.duration,delay:a.delay,endDelay:a.endDelay,startOnceDelay:i.startOnceDelay,pingPongDelayCorrection:i.pingPongDelayCorrection,pingPongEndDelayCorrection:i.pingPongEndDelayCorrection})}var Os=[],gD=[],qv,dve=function(){function e(){qv=requestAnimationFrame(t)}function t(i){var n=Os.length;if(n){for(var r=0;r<n;){var s=Os[r];s.paused?(Os.splice(r,1),n-=1):(s.tick(i),r++)}e()}else qv=cancelAnimationFrame(qv)}return e}();function pve(e){document.hidden?(Os.forEach(function(t){return t.pause(e.timeStamp)}),gD=Os.slice(0),zi.running=Os=[]):gD.forEach(function(t){return t.play(e.timeStamp)})}typeof document<"u"&&document.addEventListener("visibilitychange",pve);function zi(e){e===void 0&&(e={});var t=0,i=0,n=0,r,s,a=0,o=null;function l(w){var M=window.Promise&&new Promise(function(S){return o=S});return w.finished=M,M}var c=uve(e);l(c);function u(){var w=c.direction;w!=="alternate"&&(c.direction=w!=="normal"?"normal":"reverse"),c.reversed=!c.reversed,s.forEach(function(M){(M.loop===1||M.loop%2===0)&&(M.reversed=c.reversed)})}function h(){c.direction="normal",c.reversed=!1,s.forEach(function(w){return w.reversed=!1})}function d(w){return c.reversed?c.duration-w:w}function p(){t=0,i=d(c.currentTime)*(1/zi.speed)}function f(w,M,S=!1){M&&(c.reversed?M.seek(M.duration*M.loop-(w-M.timelineOffset-M.pingPongDelayCorrection),S):M.seek(w-M.timelineOffset-M.startOnceDelay-M.pingPongDelayCorrection,S))}function v(w,M=!1){if(c.reversed)for(var S=a;S--;)f(w,s[S],M);else for(var C=0;C<a;C++)f(w,s[C],M)}function m(w){var se,ie,re,de,he,X,Ee,Oe,Me,Ne;var M=0,S=c.animations,C=S.length;for(c.direction!=="alternate"&&((se=c.parent)==null?void 0:se.direction)==="alternate"?((ie=c.parent)==null?void 0:ie.rewind)===!1&&c.reversePlayback===!0&&c.rewind===!1&&((re=c.parent)!=null&&re.reversed&&c.direction==="alternate"?w=c.duration-c.delay+c.endDelay-w:w=c.duration+c.delay-c.endDelay-w):_(!1,(de=c.parent)==null?void 0:de.rewind,c.rewind,(he=c.parent)==null?void 0:he.reversePlayback,c.reversePlayback)&&((X=c.parent)!=null&&X.reversed&&c.direction==="alternate"?w=c.duration-c.delay+c.endDelay-w:w=c.duration+c.delay-c.endDelay-w);M<C;){var E=S[M],P=E.animatable,I=E.tweens,D=I.length-1,L=I[D];D&&(L=E2(I,function(Pe){return w<Pe.end})[0]||L);let He;(Ee=c.parent)!=null&&Ee.reversed&&c.direction==="alternate"?He=ua(w-L.start-L.endDelay,0,L.duration)/L.duration:He=ua(w-L.start-L.delay,0,L.duration)/L.duration;for(var B=isNaN(He)?1:L.easing(He),j=L.to.strings,z=L.round,O=[],H=L.to.numbers.length,k=void 0,N=0;N<H;N++){var F=void 0;let Pe,Ce;c.direction!=="alternate"?((Oe=c.parent)==null?void 0:Oe.rewind)===!1&&c.reversePlayback===!0&&c.rewind===!1?(Pe=L.to.numbers[N],Ce=L.from.numbers[N]||0):(Ce=L.to.numbers[N],Pe=L.from.numbers[N]||0):_(!0,(Me=c.parent)==null?void 0:Me.rewind,c.rewind,(Ne=c.parent)==null?void 0:Ne.reversePlayback,c.reversePlayback)?(Pe=L.to.numbers[N],Ce=L.from.numbers[N]||0):(Ce=L.to.numbers[N],Pe=L.from.numbers[N]||0),L.isPath?F=nve(L.value,B*Ce):F=Pe+B*(Ce-Pe),z&&(L.isColor&&N>2||(F=Math.round(F*z)/z)),O.push(F)}var Q=j.length;if(!Q)k=O[0];else{k=j[0];for(var G=0;G<Q;G++){j[G];var K=j[G+1],W=O[G];isNaN(W)||(K?k+=W+K:k+=W+" ")}}_z[E.type](P.target,E.property,k,P.transforms),E.currentValue=k,M++}}function g(w){c[w]&&!c.passThrough&&c[w](c)}function y(){c.remaining&&c.remaining!==!0&&c.remaining--}let x={0:!1,1:!0,2:!1,3:!0,4:!1,5:!1,6:!1,7:!1,8:!1,9:!0,10:!0,11:!1,12:!1,13:!1,14:!0,15:!0,16:!1,17:!0,18:!0,19:!1,20:!1,21:!1,22:!0,23:!0,24:!1,25:!0,26:!1,27:!0,28:!1,29:!1,30:!1,31:!1};function _(w,M,S,C,E){return x[w<<4|M<<3|S<<2|C<<1|E]}function b(w,M=!1){var I;var S=c.duration;let C=c.delay,E=S-c.endDelay;(I=c.parent)!=null&&I.reversed&&c.direction==="alternate"&&(C=c.endDelay,E=S-c.delay);var P=d(w);if(c.progress=ua(P/S*100,0,100),M||(c.reversePlayback=P<c.currentTime),a&&v(P,M),!c.began&&c.currentTime>=0&&(c.began=!0,g("begin")),!c.loopBegan&&c.currentTime>0&&(c.loopBegan=!0,g("loopBegin")),(c.reversed||P>=0)&&P<=C&&c.currentTime!==0&&(m(0),g("change")),(P>=E&&c.currentTime!==S+c.pingPongDelayCorrection||!S)&&(m(S),g("change")),P>C&&P<E?(c.changeBegan||(c.changeBegan=!0,c.changeCompleted=!1,g("changeBegin")),m(P),g("change")):c.changeBegan?(c.changeCompleted=!0,c.changeBegan=!1,g("change"),a&&g("timelineChangeComplete")):c.began&&P>E&&g("changeComplete"),c.currentTime=ua(P,0,S+c.pingPongDelayCorrection),c.began&&g("update"),w>=S)if(y(),!c.remaining)c.paused=!0,c.completed||(c.completed=!0,g("loopComplete"),g("complete"),!c.passThrough&&"Promise"in window&&(o(),l(c)));else{a?t+=c.duration/zi.speed:t+=c.duration;for(let D of s)D.setStartTime(0),D.remaining=D.loop;g("loopComplete"),c.loopBegan=!1,c.direction==="alternate"?u():a&&h()}}return c.reset=function(){var w=c.direction;c.passThrough=!1,c.currentTime=0,c.progress=0,c.paused=!0,c.began=!1,c.loopBegan=!1,c.changeBegan=!1,c.completed=!1,c.changeCompleted=!1,c.reversePlayback=!1,c.reversed=w==="reverse",c.remaining=c.loop,s=c.children,a=s.length;for(var M=a;M--;)c.children[M].reset();(c.reversed&&c.loop!==!0||w==="alternate"&&c.loop===1)&&c.remaining++,m(c.reversed?c.duration:0)},c.setStartTime=function(w){t=w},c.set=function(w,M){return bz(w,M),c},c.tick=function(w){n=w,t||(t=n),b((n+(i-t))*zi.speed)},c.seek=function(w,M=!1){b(w-t,M)},c.pause=function(w){c.paused=!0,a&&(r=w??performance.now())},c.play=function(w){!c.paused||(c.completed&&c.reset(),c.paused=!1,Os.push(c),a&&r!==void 0&&(t+=(w??performance.now())-r),qv||dve())},c.reverse=function(){u(),c.completed=!c.reversed,p()},c.restart=function(){c.reset(),c.play()},c.reset(),c.autoplay&&c.play(),c}function vD(e,t){for(var i=t.length;i--;)HA(e,t[i].animatable.target)&&t.splice(i,1)}function fve(e){for(var t=yz(e),i=Os.length;i--;){var n=Os[i],r=n.animations,s=n.children;vD(t,r);for(var a=s.length;a--;){var o=s[a],l=o.animations;vD(t,l),!l.length&&!o.children.length&&s.splice(a,1)}!r.length&&!s.length&&n.pause()}}function mve(e,t){t===void 0&&(t={});var i=t.direction||"normal",n=t.easing?VA(t.easing):null,r=t.grid,s=t.axis,a=t.from||0,o=a==="first",l=a==="center",c=a==="last",u=ft.arr(e),h=parseFloat(u?e[0]:e),d=u?parseFloat(e[1]):0,p=rl(u?e[1]:e)||0,f=t.start||0+(u?h:0),v=[],m=0;return function(g,y,x){if(o&&(a=0),l&&(a=(x-1)/2),c&&(a=x-1),!v.length){for(var _=0;_<x;_++){if(!r)v.push(Math.abs(a-_));else{var b=l?(r[0]-1)/2:a%r[0],w=l?(r[1]-1)/2:Math.floor(a/r[0]),M=_%r[0],S=Math.floor(_/r[0]),C=b-M,E=w-S,P=Math.sqrt(C*C+E*E);s==="x"&&(P=-C),s==="y"&&(P=-E),v.push(P)}m=Math.max.apply(Math,v)}n&&(v=v.map(function(D){return n(D/m)*m})),i==="reverse"&&(v=v.map(function(D){return s?D<0?D*-1:-D:Math.abs(m-D)}))}var I=u?(d-h)/m:h;return f+I*(Math.round(v[y]*100)/100)+p}}function gve(e){e===void 0&&(e={});var t=zi(e);return t.duration=0,t.add=function(i,n){var r=Os.indexOf(t),s=t.children;r>-1&&Os.splice(r,1);function a(d){d.passThrough=!0}for(var o=0;o<s.length;o++)a(s[o]);var l=T2(i,BM(kA,e));l.targets=l.targets||e.targets;var c=t.duration;l.autoplay=!1,l.timelineOffset=ft.und(n)?c:qA(n,c),a(t);var u=zi(l);a(u),s.push(u),u.parent=t;var h=wz(s,e);return t.delay=h.delay,t.endDelay=h.endDelay,t.duration=h.duration,u.loop===!0&&(t.duration=1/0),t.seek(0),t.reset(),t.autoplay&&t.play(),t},t}zi.version="3.2.0";zi.speed=1;zi.running=Os;zi.remove=fve;zi.get=XA;zi.set=bz;zi.convertPx=jA;zi.path=ive;zi.setDashoffset=eve;zi.stagger=mve;zi.timeline=gve;zi.easing=VA;zi.penner=hz;zi.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};var Sz=zi,yD=new T,xD=new T,_D=new At;function vve(e,t,i,n){if(n===0)return i.copy(e);if(n===1)return i.copy(t);let r=e.w*t.w+e.x*t.x+e.y*t.y+e.z*t.z;if(r>=1)return i.copy(e);let s=1-r*r;if(s<=Number.EPSILON){let u=1-n;return i.w=u*e.w+n*t.w,i.x=u*e.x+n*t.x,i.y=u*e.y+n*t.y,i.z=u*e.z+n*t.z,i.normalize(),i}let a=Math.sqrt(s),o=Math.atan2(a,r),l=Math.sin((1-n)*o)/a,c=Math.sin(n*o)/a;return i.w=e.w*l+t.w*c,i.x=e.x*l+t.x*c,i.y=e.y*l+t.y*c,i.z=e.z*l+t.z*c,i}function Zh(e,t,i,n,r){let s=i[e]?i[e]:void 0,a=n[e];if(a==null)return;let o=s??t[e],l=a;if(o!==l)return{update:c=>{let u=Dt.lerp(o,l,c);r?t[e]=Math.trunc(u):t[e]=u},start:()=>{t[e]=o},end:()=>{t[e]=l}}}function Mz(e,t,i,n,r){let s=i[e]?i[e]:void 0,a=n[e];if(!a)return;let o=t[e],l=[...s??o],c=[...a];if(!(l.length!==c.length||tA(l,c)))return{update:u=>{l.forEach((h,d)=>{let p=Dt.lerp(h,c[d],u);t[e][d]=r?Math.trunc(p):p})},start:()=>{Object.assign(t[e],l)},end:()=>{Object.assign(t[e],c)}}}function bD(e,t,i,n){let r=i[e]?i[e]:void 0,s=n[e];if(!s)return;let a=t[e],o=r?new T().fromArray(r):a.clone(),l=new T().fromArray(s);if(!o.equals(l))return{update:c=>{a.lerpVectors(o,l,c)},start:()=>{a.copy(o)},end:()=>{a.copy(l)}}}function yve(e,t,i,n){let r=i[e]?i[e]:void 0,s=n[e];if(!s)return;let a=t[e],o=r?new ke().fromArray(r):a.clone(),l=new T,c=new At,u=new T;o.decompose(l,c,u);let h=new ke().fromArray(s),d=new T,p=new At,f=new T;if(h.decompose(d,p,f),!o.equals(h))return{update:v=>{_D.slerpQuaternions(c,p,v),yD.lerpVectors(l,d,v),xD.lerpVectors(u,f,v),a.compose(yD,_D,xD)},start:()=>{a.compose(l,c,u)},end:()=>{a.compose(d,p,f)}}}function xve(e,t,i,n,r){let s=i[e]?i[e]:void 0,a=n[e];if(!a)return;let o=t[e],l=s?typeof s=="string"?r.getColor(s).clone():new ut().setRGB(s.r,s.g,s.b):o.clone(),c=typeof a=="string"?r.getColor(a).clone():new ut().setRGB(a.r,a.g,a.b);if(l.equals(c))return;let u=o.clone();return t[e]=u,{update:h=>{u.lerpColors(l,c,h)},start:()=>{u.copy(l)},end:()=>{u.copy(c)}}}function zc(e,t,i,n){if(typeof t[e]=="number")return Zh(e,t,i??{},n);if(Array.isArray(t[e]))return Mz(e,t,i??{},n)}function _ve(e,t,i){var a,o,l,c;let n=[],r=e.cameraType==="OrthographicCamera"?(a=t.orthographic)==null?void 0:a.zoom:(o=t.perspective)==null?void 0:o.zoom,s=e.cameraType==="OrthographicCamera"?(l=i.orthographic)==null?void 0:l.zoom:(c=i.perspective)==null?void 0:c.zoom;if(s!==void 0){let u=r??e.zoom,h=s;u!==h&&n.push({update:d=>{e.zoom=Dt.lerp(u,h,d),e.updateProjectionMatrix()},start:()=>{e.zoom=u,e.updateProjectionMatrix()},end:()=>{e.zoom=h,e.updateProjectionMatrix()}})}if(i.targetOffset!==void 0){let u=Zh("targetOffset",e,t,i);u&&n.push(u)}return n}function bve(e,t,i,n){if(i.scaleBaked===void 0)return;let r=t.scaleBaked??e.data.geometry.scaleBaked,s=i.scaleBaked;if(Dh.isEqual(r,s))return;let a=[];return a.push({update:o=>{e.updateGeometryInteractions({scaleBaked:[Dt.lerp(r[0],s[0],o),Dt.lerp(r[1],s[1],o),Dt.lerp(r[2],s[2],o)]},n),e.invalidateDownstreamBooleanData()},start:()=>{e.updateGeometryInteractions({scaleBaked:r},n),e.invalidateDownstreamBooleanData()},end:()=>{e.updateGeometryInteractions({scaleBaked:s},n),e.invalidateDownstreamBooleanData()}}),a}function wve(e,t,i){if(!i.extrusion)return;let n=e.extrusion,r=t.extrusion??{},s=i.extrusion,a=[];return EU.forEach(o=>{let l=zc(o,n,r,s);l&&a.push(l)}),a}function Sve(e,t,i,n){let r=[];if(!("geometry"in i))return r;let s=e.geometry.userData.parameters,a="geometry"in t?t.geometry:{},o=i.geometry;if(e instanceof U0){let l=bve(e,a,o,n);l&&r.push(...l)}else{let l={};if(Object.assign(l,il(s,A9)),A9.forEach(c=>{let u=zc(c,l,a,o);u&&r.push(u)}),e instanceof OA){Object.assign(l,{extrusion:{...s.extrusion}});let c=wve(l,a,o);c&&r.push(...c)}r.length&&r.push({update:c=>{e.updateGeometryInteractions(l,n),e.updateGeometryGroupsIfNeeded()},start:c=>{e.updateGeometryInteractions(l,n),e.updateGeometryGroupsIfNeeded()},end:c=>{e.updateGeometryInteractions(l,n),e.updateGeometryGroupsIfNeeded()}})}return r}function Mve(e,t,i,n){let r=[];if(i.intensity!==void 0){let s=Zh("intensity",e,t,i);s&&r.push(s)}if(i.color!==void 0){let s=xve("color",e,t,i,n);s&&r.push(s)}return r}function Cve(e,t,i,n){let r=[];if(Array.isArray(e.material)){if(!("materials"in i&&i.materials))return r;let s="materials"in t&&t.materials?t.materials:[],a=i.materials;e.material.forEach((o,l)=>{if(!a[l])return;let c=s[l]??{},u=a[l];typeof c=="string"||typeof u=="string"||r.push(...wD(o,c,u,n))})}else{if(!("material"in i&&i.material))return r;let s="material"in t&&t.material?t.material:{},a=i.material;if(typeof s=="string"||typeof a=="string")return r;r.push(...wD(e.material,s,a,n))}return r}function wD(e,t,i,n){var a;let r=[],s=vx(i,n)||!!t.layers&&vx(t,n);r.push(Ove(e,s));for(let o of e.layers){let l=(a=t.layers)==null?void 0:a.data(o.uuid),c=i.layers.data(o.uuid);if(!c||!(o.visible??!0)||!(c.visible??!0))continue;let u=o.getNames().filter(h=>!SU.some(d=>h.includes(d)));for(let h of u)try{let d=o.getValue(h),p;if(h==="colors")p=Rve(o,l,c,h);else if(Array.isArray(d))h==="steps"&&(p=Lve(o,l,c,h));else if(typeof d=="number")p=Eve(o,l,c,h);else{if(typeof d=="boolean")continue;d instanceof te?p=Ave(o,l,c,h):d instanceof T?p=Tve(o,l,c,h):d instanceof Or?p=Dve(o,l,c,h,n):d instanceof ut?p=Pve(o,l,c,h,n):"isTexture"in d&&(p=Ive(o,l,c,h))}p&&(Array.isArray(p)?r.push(...p):r.push(p))}catch(d){console.error(`lerpMaterial: unexpected material layer for ${h}`,d)}}return r}function Eve(e,t,i,n){if(!e.hasValue(n)||!(n in i))return;let r=t?t[n]:e.getValue(n),s=i[n];if(r!==s)return{update:a=>{e.setValue(n,Dt.lerp(r,s,a))},start:()=>{e.setValue(n,r)},end:()=>{e.setValue(n,s)}}}function Ave(e,t,i,n){if(!e.hasValue(n)||!(n in i))return;let r=e.getValue(n),s=t?new te().fromArray(t[n]):r.clone(),a=new te().fromArray(i[n]);if(!s.equals(a))return{update:o=>{r.lerpVectors(s,a,o)},start:()=>{r.copy(s)},end:()=>{r.copy(a)}}}function Tve(e,t,i,n){if(!e.hasValue(n)||!(n in i))return;let r=e.getValue(n),s=t?new T().fromArray(t[n]):r.clone(),a=new T().fromArray(i[n]);if(!s.equals(a))return{update:o=>{r.lerpVectors(s,a,o)},start:()=>{r.copy(s)},end:()=>{r.copy(a)}}}function Pve(e,t,i,n,r){if(!e.hasValue(n)||!(n in i))return;let s=t?t[n]:void 0,a=i[n],o=e.getValue(n),l=s?typeof s=="string"?r.getColor(s).clone():new ut().setRGB(s.r,s.g,s.b):o.clone(),c=typeof a=="string"?r.getColor(a).clone():new ut().setRGB(a.r,a.g,a.b);if(l.equals(c))return;let u=o.clone();return{update:h=>{e.getValue(n)!==u&&e.setValue(n,u),u.lerpColors(l,c,h)},start:()=>{u.copy(l)},end:()=>{u.copy(c)}}}function Dve(e,t,i,n,r){if(!e.hasValue(n)||!(n in i))return;let s=t?t[n]:void 0,a=i[n],o=e.getValue(n),l=s?typeof s=="string"?r.getColor(s).clone():new ut().setRGB(s.r,s.g,s.b):o.clone(),c=typeof a=="string"?r.getColor(a).clone():new Or(a.r,a.g,a.b,a.a);if(l.equals(c))return;let u=o.clone();return{update:h=>{e.getValue(n)!==u&&e.setValue(n,u),u.lerpColors(l,c,h)},start:()=>{u.copy(l)},end:()=>{u.copy(c)}}}function Lve(e,t,i,n="steps"){if(!e.hasValue(n)||!(n in i))return;let r=[],s=e.getValue(n),a=t?t[n]:s,o=i[n];for(let l=0;l<s.length;++l){let c=a[l],u=o[l];c!==u&&r.push({update:h=>{s[l]=Dt.lerp(c,u,h)},start:()=>{s[l]=c},end:()=>{s[l]=u}})}return r.length?r:void 0}function Rve(e,t,i,n="colors"){if(!e.hasValue(n)||!(n in i))return;let r=[],s=e.getValue(n),a=t?t[n]:s.map(l=>l.toArray()),o=i[n];for(let l=0;l<s.length;++l){let c=[...a[l]],u=[...o[l]];tx.isEqual(c,u)||r.push({update:h=>{s[l].fromArray(tx.lerp(c,u,h))},start:()=>{s[l].fromArray(c)},end:()=>{s[l].fromArray(u)}})}return r.length?r:void 0}function Ive(e,t,i,n="texture"){if(!e.hasValue(n)||!(n in i))return;let r=e.getNode("mat");if(!r)return;let s=t?t[n]:r,a=i[n],o=[...s.repeat],l=[...s.offset],c=[...a.repeat],u=[...a.offset];if(!Bd.isEqual(o,c)||!Bd.isEqual(l,u))return{update:h=>{r.repeat=Bd.lerp(o,c,h),r.offset=Bd.lerp(l,u,h),r.updateMatrix()},start:()=>{r.repeat=[...o],r.offset=[...l],r.updateMatrix()},end:()=>{r.repeat=[...c],r.offset=[...u],r.updateMatrix()}}}function Ove(e,t){return{update:()=>{e.transparent=t}}}var Kb=new T,SD=new bn;function Bve(e,t,i,n){let r=[],s,a,o,l,c,u,h={slide:(t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping).slide,offset:(t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping).offset};if(c=Zh("slide",h,t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping,i.pathSnapping??e.dataPatched.pathSnapping),c&&r.push(c),u=Zh("offset",h,t.pathSnapping??e.updatedPathSnapping??e.dataPatched.pathSnapping,i.pathSnapping??e.dataPatched.pathSnapping),u&&r.push(u),!c&&!u&&(s=bD("position",e,t,i),s&&r.push(s),a=bD("scale",e,t,i),a&&r.push(a),o=Nve(e,t,i,n),o&&r.push(o),l=yve("hiddenMatrix",e,t,i),l&&r.push(l)),s||a||o||l||c||u){let d=()=>{var p;e.updateMatrix(),e.hasNonUniformScale&&(e.updateMatrixWorld(),e.updateMatrixWorldSVD()),(p=e.parent)!=null&&p.matrixWorldFusedFalse&&(e.matrixWorld.multiplyMatrices(e.parent.matrixWorldFusedFalse,e.matrix),e.matrixWorldNeedsUpdate=!1),na(e)&&qa(e.parent)&&e.invalidateDownstreamBooleanData(!0),e.updatePathSnapping(Object.assign({},t.pathSnapping,h))};r.push({update:d,start:d,end:d})}return r}function Nve(e,t,i,n){let r=t!=null&&t.rotation?t.rotation:void 0,s=i.rotation;if(!s)return;let a=r?new T().fromArray(r):new T().setFromEuler(e.rotation),o=new T().fromArray(s);if(a.equals(o))return;let l=Kb.subVectors(o,a);if(n&&l.toArray().every(c=>Math.abs(c)<2*Math.PI)){let c=new At().setFromEuler(SD.setFromVector3(a)),u=new At().setFromEuler(SD.setFromVector3(o));return{update:h=>{vve(c,u,e.quaternion,h)},start:()=>{e.rotation.setFromVector3(a)},end:()=>{e.rotation.setFromVector3(o)}}}else return{update:c=>{Kb.lerpVectors(a,o,c),e.rotation.setFromVector3(Kb)},start:()=>{e.rotation.setFromVector3(a)},end:()=>{e.rotation.setFromVector3(o)}}}function Uve(e,t,i){let n=[];if(!("cloner"in i)||!e.cloner)return n;let r=e.cloner,s="cloner"in t?t.cloner:{},a=i.cloner;vU.forEach(d=>{let p;d==="count"?p=Zh("count",r.parameters,s,a,!0):p=zc(d,r.parameters,s??{},a),p&&n.push(p)});let o=Fve(r,s,a);o!=null&&o.length&&n.push(...o);let l=zve(r,s,a);l!=null&&l.length&&n.push(...l);let c=kve(r,s,a);c!=null&&c.length&&n.push(...c);let u=Vve(r,s,a);u!=null&&u.length&&n.push(...u);let h=Hve(r,s,a);return h!=null&&h.length&&n.push(...h),n.length&&n.push({update:()=>{r.update()}}),n}function Fve(e,t,i){if(e.parameters.type!=="radial")return;let n=t.radial,r=i.radial;if(!r)return;let s=e.parameters.radial,a=[];return yU.forEach(o=>{let l=zc(o,s,n??{},r);l&&a.push(l)}),a}function zve(e,t,i){if(e.parameters.type!=="linear")return;let n=t.linear,r=i.linear;if(!r)return;let s=[],a=e.parameters.linear;return xU.forEach(o=>{let l=zc(o,a,n??{},r);l&&s.push(l)}),s}function kve(e,t,i){if(e.parameters.type!=="grid")return;let n=t.grid,r=i.grid;if(!r)return;let s=[],a=e.parameters.grid;return _U.forEach(o=>{let l;o==="count"?l=Mz(o,a,n??{},r,!0):l=zc(o,a,n??{},r),l&&s.push(l)}),s}function Vve(e,t,i){if(e.parameters.type!=="toObject")return;let n=t.toObject,r=i.toObject;if(!r)return;let s=[],a=e.parameters.toObject;return bU.forEach(o=>{let l;o==="count"?l=Zh(o,a,n??{},r,!0):l=zc(o,a,n??{},r),l&&s.push(l)}),s}function Hve(e,t,i){if(!e.parameters.randomness)return;let n=t.randomnessObject,r=i.randomnessObject;if(!r)return;let s=[],a=e.parameters.randomnessObject;return wU.forEach(o=>{let l=zc(o,a,n??{},r);l&&s.push(l)}),s}function MD(e,t,i,n,r){let s=[];return e.data.visible&&s.push(...Bve(e,t,i,r)),e.data.visible&&s.push(...Uve(e,t,i)),na(e)?(e instanceof dr&&e.data.visible&&s.push(...Sve(e,t,i,n)),e.data.visible&&s.push(...Cve(e,t,i,n))):r0e(e)?e.data.visible&&s.push(...Mve(e,t,i,n)):n0e(e)&&s.push(..._ve(e,t,i)),s.length?{update:a=>{s.forEach(o=>o.update(a))},start:a=>{s.forEach(o=>{var l;return(l=o.start)==null?void 0:l.call(o,a)})},end:a=>{s.forEach(o=>{var l;return(l=o.end)==null?void 0:l.call(o,a)})}}:void 0}var CD=new T;function ZA(e,t,i=!1){let n=[];e.traverseChildren(r=>{var l,c,u,h,d;if(i&&((l=r.rigidBody)==null||l.setTranslation(r.position0,!0),(c=r.rigidBody)==null||c.setRotation(r.rotation0,!0),(u=r.rigidBody)==null||u.setLinvel(CD,!0),(h=r.rigidBody)==null||h.setAngvel(CD,!0)),!Vt.is(r))return;let s=r.uuid,a=r.data;if(delete r.states,r.uuid===rf)return;let o=!1;n.some(p=>{var f;return(f=e.scene.find(s))==null?void 0:f.isDescendantOf(p)})?o=!0:((d=a.physics)==null?void 0:d.fusedBody)===!0&&a.physics.rigidBody==="dynamic"&&n.push(s),r.data=a,r.currentState=null,r.reversibleToState=null,r.currentTransitionEvent=null;for(let p of a.states){let f={...p.data};e.data.globalPhysics.usePhysics===!0&&a.physics&&(a.physics.rigidBody==="dynamic"||o)&&(p.data.position!==void 0&&delete f.position,p.data.rotation!==void 0&&delete f.rotation,p.data.hiddenMatrix!==void 0&&delete f.hiddenMatrix),r.states||(r.states={}),r.states[p.id]=_h.patch(a,f)}jve(e.scene,r,null,t,a.events.find(p=>p.data.type==="Follow"||p.data.type==="LookAt")!==void 0),Gve(e)})}function Gve(e){e.traverseEntity(t=>{for(let i of t.data.events){let n=[];switch(i.data.type){case"Follow":case"MouseHover":case"Scroll":case"MouseDown":case"MouseUp":case"MousePress":case"KeyUp":case"KeyDown":case"KeyPress":case"Collision":n.push(...i.data.actions);break;case"GameControl":for(let r of Object.values(i.data.gameActions))n.push(...r);break;case"DragDrop":n.push(...i.data.dragDropActions.drag,...i.data.dragDropActions.drop);break;case"Conditional":n.push(...i.data.inActions,...i.data.outActions);break}for(let r of n)if(r.data.type==="Create"&&r.data.hideBase==="Yes"){let s=e.scene.find(r.data.object);s&&(s.visible=!1)}}})}function jve(e,t,i,n,r=!1){if(t instanceof dr&&t.removeInteractionGeometry(),t.changeSelectedState(i,{scene:e,shared:n},r),t instanceof dr&&t.updateGeometryGroupsIfNeeded(),t instanceof qn&&t.updateCameraState(t.dataPatched,{scene:e,shared:n}),t.cloner)for(let s of t.cloner.children)s.playModeVisible=void 0;t.updateVisible()}function Cz(e){let t;if(e.easing===5){let{control1:i,control2:n}=e;t=`cubicBezier(
			${i[0]}, ${i[1]}, ${n[0]}, ${n[1]}
		)`}else if(e.easing===6){let{mass:i,stiffness:n,damping:r,velocity:s}=e;t=`spring( ${i}, ${n}, ${r}, ${s} )`}else{let i;switch(e.easing){case 0:i=kl.linear;break;case 1:i=kl.ease;break;case 2:i=kl.easeIn;break;case 3:i=kl.easeOut;break;case 4:i=kl.easeInOut;break;default:i=kl.linear}let[n,r,s,a]=i;t=`cubicBezier( ${n}, ${r}, ${s}, ${a} )`}return{duration:e.duration,easing:t}}function Ez(e){let t={delay:0,loop:e.repeat===-1?!0:e.repeat+1};if(e.repeat===0)t.direction="normal",t.rewind=!1;else switch(e.direction){case"pingpong":t.direction="alternate",t.rewind=!1;break;case"pingpong-rewind":t.direction="alternate",t.rewind=!0;break;default:t.direction="normal",t.rewind=!1;break}switch(t.delay=0,t.endDelay=0,t.startOnceDelay=0,t.pingPongDelayCorrection=0,t.pingPongEndDelayCorrection=0,e.delayDirection){case"start-once":t.startOnceDelay=e.delay;break;case"start":t.delay=e.delay;break;case"end":t.endDelay=e.delay;break;case"start-end":case void 0:t.delay=e.delay,t.endDelay=e.delay;break}return t.direction==="alternate"&&(t.delay/=2,t.endDelay/=2,e.delayDirection==="start"?(t.pingPongDelayCorrection=t.delay,typeof t.loop=="number"&&t.loop%2===0&&(t.pingPongEndDelayCorrection=t.delay)):e.delayDirection==="end"?typeof t.loop=="number"&&t.loop%2!==0&&(t.pingPongEndDelayCorrection=t.endDelay):e.delayDirection==="start-end"&&(t.pingPongDelayCorrection=t.delay,t.pingPongEndDelayCorrection=t.endDelay)),t}var Wve={type:"beginState"},Xve={type:"completeState",isfromEntity:!1},ED=class{constructor(e,t,i,n,r,s){if(this.object=e,this.data=n,this.sharedAssets=r,this.allowSlerp=s,this.targets={t:0},this.firstLoop=!0,this._changeBegan=!1,this._changeCompleted=!0,this.onChange=()=>{this.callback&&(this.callback.update(this.targets.t),this.object.dispatchEvent({type:"requestRender"})),this.targets.t===0||this.targets.t===1?this._changeCompleted||(this._changeCompleted=!0,this._changeBegan=!1,this.onChangeComplete()):(this._changeCompleted&&(this._changeCompleted=!1),this._changeBegan||(this._changeBegan=!0,this.onChangeBegin()))},this.onChangeBegin=()=>{this.object.reversibleToState=this.to.id;let a=this.targets.t>.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=a,this.object.dispatchEvent({type:"beginState",state:a}),this.object.traverseEntity(o=>{o!==this.object&&o instanceof qn&&o.dispatchEvent(Wve)})},this.onChangeComplete=()=>{this.firstLoop&&(this.onFirstLoop(),this.firstLoop=!1),this.object.reversibleToState=this.to.id;let a=this.targets.t<.5?this.from.id:this.to.id;this.object.prevState!==this.object.currentState&&(this.object.prevState=this.object.currentState),this.object.currentState=a,this.object.dispatchEvent({type:"completeState",state:a}),this.object.traverseEntity(o=>{o!==this.object&&o instanceof qn&&o.dispatchEvent(Xve)})},this.onFirstLoop=()=>{this.useCurrentState&&(this.callback=MD(this.object,this.from.data,this.to.data,this.sharedAssets,this.allowSlerp))},t===void 0){let a=Yv(this.object,this.object.currentState===i?this.object.prevState:this.object.currentState);if(!a)throw new Error("Missing property");this.from=a}else{let a=Yv(this.object,t);if(!a)throw new Error("Missing property");this.from=a}if(i===void 0)throw new Error("Missing property");{let a=Yv(this.object,i);if(!a)throw new Error("Missing property");this.to=a}this.useCurrentState=t===void 0||i===void 0,this.params={targets:this.targets,t:1,autoplay:!1,...Ez(n),...Cz(n),change:this.onChange},this.callback=MD(this.object,t===void 0?{}:this.from.data,i===void 0?{}:this.to.data,this.sharedAssets,this.allowSlerp)}get changeBegan(){return this._changeBegan}get changeCompleted(){return this._changeCompleted}},qm=class extends In{constructor(e,t,i){if(super(),this.data=e,this.page=t,this.sharedAssets=i,this.toggleIsForward=!1,this.timelineNeedsRebuild=!1,this.useToggle=!1,this.onTimelineChangeComplete=()=>{var r;this.data.tweens[0].data.direction!=="normal"&&(this.toggleIsForward=!this.toggleIsForward),this.timelineNeedsRebuild!==!1&&((r=this.timeline)==null||r.pause(),this.buildTimeline({isForward:this.toggleIsForward,isRebuild:!0}),this.timeline.play())},!e.object)throw new Error("Missing property");let n=this.page.scene.find(e.object);if(!n)throw new Error("Missing property");if(!n.states)throw new Error("Missing property");if(this.object=n,e.tweens.length<2)throw new Error("Missing property");this.tweens=Array(this.data.tweens.length-1),this.startOnceDelay=e.tweens[0].data.delayDirection==="start-once"?e.tweens[0].data.delay:0,this.init()}get playing(){return this.tweens.some(e=>e.changeBegan)??!1}init(){this.initialCurrentState=Yv(this.object,this.object.currentState).id,this.toggleIsForward=!1}get currentState(){return this.useToggle?this.initialCurrentState:this.object.currentState}buildTimeline({isForward:e=!0,isRebuild:t=!1}={}){var i,n,r,s;try{let a=Ez(this.data.tweens[0].data),o=a.loop;t&&typeof a.loop=="number"&&a.loop--,(i=this.timeline)==null||i.pause(),this.timeline=Sz.timeline({autoplay:!1,...a,...o===!0||o>1?{timelineChangeComplete:this.onTimelineChangeComplete}:{}});let l=this.tweens.findIndex(c=>c==null?void 0:c.changeBegan);if(this.timelineNeedsRebuild=l!==-1&&(o===!0||o>1),a.pingPongDelayCorrection&&t===!1&&(this.timelineNeedsRebuild=!0),e){let c=l===-1?0:l;for(let u=c;u<this.data.tweens.length-1;u++){let h=this.data.tweens[u],d=this.data.tweens[u+1],p;u===c&&(this.object.wasMovedByUser===!0||((n=this.object.previousAction)==null?void 0:n.playing)===!0)?(p=void 0,this.object instanceof qn&&(this.object.wasMovedByUser=!1)):p=h.data.state===void 0?this.currentState:h.data.state;let f=new ED(this.object,p,d.data.state===void 0?this.currentState:d.data.state,d.data,this.sharedAssets,this.data.allowSlerp??!1);l!==-1&&u===c&&Object.assign(f.params,{startOnceDelay:0}),this.tweens[u]=f,this.timeline.add(f.params,this.timeline.duration+(u===c?a.delay:0)+(u===c&&!t?a.pingPongDelayCorrection:0))}this.timeline.duration+=a.endDelay}else{let c=l===-1?this.data.tweens.length-1:l+1;for(let u=c;u>0;u--){let h=this.data.tweens[u],d=this.data.tweens[u-1],p;u===c&&(this.object.wasMovedByUser===!0||((r=this.object.previousAction)==null?void 0:r.playing)===!0)?(p=void 0,this.object instanceof qn&&(this.object.wasMovedByUser=!1)):p=h.data.state===void 0?this.currentState:h.data.state;let f=new ED(this.object,p,d.data.state===void 0?this.currentState:d.data.state,h.data,this.sharedAssets,this.data.allowSlerp??!1);l!==-1&&u===c&&Object.assign(f.params,{startOnceDelay:0}),this.tweens[u-1]=f,this.timeline.add(f.params,this.timeline.duration+(u===c?a.endDelay:0))}this.timeline.duration+=a.delay+(t?0:a.pingPongDelayCorrection)}}catch(a){a instanceof Error&&console.error(a.message)}((s=this.object.previousAction)==null?void 0:s.playing)===!0&&this.object.previousAction.pause(),this.object.previousAction=this}play(){if(this.playing)return!1;clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{try{this.buildTimeline(),this.timeline.play()}catch(e){e instanceof Error&&console.error(e.message)}},this.startOnceDelay)}pause(){var e;(e=this.timeline)==null||e.pause(),clearTimeout(this.timeoutId),this.tweens=Array(this.data.tweens.length-1),delete this.timeoutId}stop(){this.pause();let e=this.data.tweens[0].data.state===void 0?this.initialCurrentState:this.data.tweens[0].data.state;this.object.changeSelectedState(e,{scene:this.page.scene,shared:this.sharedAssets}),this.object.currentState=e}seek(e){var t;this.timeline===void 0&&this.buildTimeline(),(t=this.timeline)==null||t.seek(e*this.timeline.duration,!0)}toggle(e){var t;this.useToggle=!0,clearTimeout(this.timeoutId),this.toggleIsForward=e??!this.toggleIsForward,this.playing?((t=this.timeline)==null||t.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()):this.timeoutId=window.setTimeout(()=>{var i;(i=this.timeline)==null||i.pause(),this.buildTimeline({isForward:this.toggleIsForward}),this.timeline.play()},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause()}};function Yv(e,t){var r;let i,n;if(typeof t=="string"?(i=t,n=(r=e.states)==null?void 0:r[i]):t===null&&(i=null,n=e.data),!(i===void 0||n===void 0))return{id:i,data:n}}var qve={type:"beginState"},AD={type:"completeState",isfromEntity:!1},TD={type:"requestRender"},Az=class extends In{constructor(e,t){super(),this.data=e,this.page=t,this.toggleIsForward=!1,this.useToggle=!1,this.posStart=new T,this.posEnd=new T,this.qStart=new At,this.qEnd=new At,this.zoomStart=1,this.zoomEnd=1}init(){}get playing(){return this.animation&&this.animation.began&&!this.animation.completed}buildAnimation(e=!1){if(!this.data.animate)return;let t=this.page.scene.find(this.data.targetCamera);if(!t||!t.visible)throw new ReferenceError("Target camera not founded or not visible");let i={t:0};this.posStart.copy(this.page.activeCamera.position),this.qStart.copy(this.page.activeCamera.quaternion),this.zoomStart=this.page.activeCamera.zoom,this.animation=Sz({targets:i,t:1,...Cz(this.data),update:()=>{i.t===0&&(this.useToggle&&!this.toggleIsForward?(this.posEnd.copy(this.fromCamera.position),this.qEnd.copy(this.fromCamera.quaternion),this.zoomEnd=this.fromCamera.zoom,this.switchCamera(this.fromCamera.uuid)):(this.posEnd.copy(t.position),this.qEnd.copy(t.quaternion),this.zoomEnd=t.zoom,this.fromCamera=this.page.activeCamera,this.switchCamera(t.uuid)),this.page.activeCamera.dispatchEvent(qve));let n=this.page.activeCamera;n.position.lerpVectors(this.posStart,this.posEnd,i.t),n.quaternion.slerpQuaternions(this.qStart,this.qEnd,i.t),n.zoom=this.zoomStart+(this.zoomEnd-this.zoomStart)*i.t,n.wasMovedBySwitchCameraAction=!0,n.updateMatrix(),n.updateMatrixWorld(),n.updateProjectionMatrix(),n.dispatchEvent(TD),i.t===1&&n.dispatchEvent(AD)}})}switchCamera(e){let t=this.page.scene.find(e);if(!t||!t.visible)throw new ReferenceError("Target camera not founded or not visible");this.page.switchActiveCamera(t),this.page.activeCamera.dispatchEvent({type:"cameraChange",camera:t})}play(){if(!this.playing&&this.page.activeCamera.uuid!==this.data.targetCamera)try{clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var e;delete this.timeoutId,this.data.animate?(this.buildAnimation(),(e=this.animation)==null||e.play()):this.switchCamera(this.data.targetCamera)},this.data.delay*1e3)}catch{}}pause(){var e;(e=this.animation)==null||e.pause(),clearTimeout(this.timeoutId),delete this.timeoutId}toggle(e){var t,i;this.useToggle=!0,clearTimeout(this.timeoutId),this.toggleIsForward=e??!this.toggleIsForward;try{this.playing?((t=this.animation)==null||t.pause(),this.buildAnimation(!0),(i=this.animation)==null||i.play()):this.timeoutId=window.setTimeout(()=>{var n,r;delete this.timeoutId,this.data.animate?((n=this.animation)==null||n.pause(),this.buildAnimation(),(r=this.animation)==null||r.play()):(this.toggleIsForward?(this.fromCamera=this.page.activeCamera,this.switchCamera(this.data.targetCamera)):this.switchCamera(this.fromCamera.uuid),this.page.activeCamera.dispatchEvent(AD),this.page.activeCamera.dispatchEvent(TD))},this.data.delay*1e3)}catch{}}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){this.pause(),this.toggleIsForward=!1}},Ym=class extends In{constructor(e,t,i){var o,l,c;super(),this.page=t,this.animationControls=i,this.startOnceDelay=0,this.toggleIsForward=!1;let n=e.object,r=t.scene.find(e.object);r&&Array.isArray(r.identity)&&(n=r.identity[0]),this.data={...e,object:n};let s=this.animationControls.clipIdToAction[e.clipId+"/"+n];this.duration=((o=s==null?void 0:s.getClip())==null?void 0:o.duration)??1;let a=((c=(l=s==null?void 0:s.getClip())==null?void 0:l.tracks[0])==null?void 0:c.times.length)??1/0;this.leftFrameTime=this.data.crop[0]/a*this.duration,this.rightFrameTime=this.data.crop[1]/a*this.duration,this.startOnceDelay=e.delay}get playing(){var e;return((e=this.threeAnimAction)==null?void 0:e.isRunning())??!1}play(e=!1){window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{var i;if(this.threeAnimAction=this.animationControls.play(this.data),!this.threeAnimAction)return;this.threeAnimAction.reset(),this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime;let t=this.data.object;Object.entries(this.animationControls.clipIdToAction).forEach(([n,r])=>{let s=n.split("/")[1];this.threeAnimAction!==r&&s===t&&r.isRunning()&&(e?r.fadeOut(.2):r.stop())}),e&&((i=this.threeAnimAction)==null||i.fadeIn(.2))},this.startOnceDelay)}pause(){this.threeAnimAction&&(this.threeAnimAction.paused=!0),window.clearTimeout(this.timeoutId),delete this.timeoutId}stop(){var e;(e=this.threeAnimAction)==null||e.fadeOut(.2)}seek(e){this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction&&(this.threeAnimAction.paused=!0,this.threeAnimAction.time=Dt.clamp(this.threeAnimAction.time+1/60*e,this.leftFrameTime,this.rightFrameTime-16e-5),this.animationControls.needsUpdate=!0,this.animationControls.requestRender())}toggle(e,t=!1){this.toggleIsForward=e??!this.toggleIsForward,this.threeAnimAction&&(this.threeAnimAction._loopCount=0),this.playing?this.threeAnimAction&&(this.threeAnimAction.timeScale=this.toggleIsForward?1:-1,this.toggleIsForward?(this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime)):this.timeoutId=window.setTimeout(()=>{var i;if(this.threeAnimAction=this.animationControls.play(this.data),this.threeAnimAction){this.toggleIsForward?(this.threeAnimAction.time=this.leftFrameTime,this.threeAnimAction._clip.start=this.leftFrameTime,this.threeAnimAction._clip.duration=this.rightFrameTime):(this.threeAnimAction.time=this.rightFrameTime,this.threeAnimAction._clip.start=this.rightFrameTime,this.threeAnimAction._clip.duration=this.leftFrameTime),this.threeAnimAction.paused=!1,this.threeAnimAction.timeScale=this.toggleIsForward?1:-1;let n=this.data.clipId.split("/")[1];Object.entries(this.animationControls.clipIdToAction).forEach(([r,s])=>{let a=r.split("/")[1];this.threeAnimAction!==s&&a===n&&s.isRunning()&&(t?s.fadeOut(.2):s.stop())}),t&&((i=this.threeAnimAction)==null||i.fadeIn(.2))}},this.startOnceDelay)}playFromCurrent(){this.toggle(!0)}reverseFromCurrent(){this.toggle(!1)}dispose(){var t;let e=(t=this.animationControls.clipIdToAction[this.data.clipId+"/"+this.data.object])==null?void 0:t.getClip();e&&(e.duration=this.duration),this.pause()}},Tz=class{constructor(e,t,i,n){this.data=e,this.page=t,this.eventManager=i,this.shared=n,this.timeOutId=-1,this.scene=t.scene}dispatch(){this.data.target!==this.page.uuid&&(window.clearTimeout(this.timeOutId),this.timeOutId=window.setTimeout(()=>{this.play()},this.data.delay*1e3))}dispose(){window.clearTimeout(this.timeOutId)}play(){if(this.scene.children.every(t=>t.uuid!==this.data.target))return;this.data.transition==="fade"&&this.data.duration>0&&this.eventManager.eventContext.renderer.renderFromSceneForSceneTransitionPass(this.scene,this.scene.activeCamera,this.data.duration*1e3),this.eventManager.deactivate(),this.eventManager.controlsManager.deactivate();let e=this.scene.activeCamera;this.scene.updatePage(this.data.target),this.scene.activePage.switchToPlayCamera(),this.scene.activeCamera.copyViewPlaneSize(e),ZA(this.scene.activePage,this.shared),this.eventManager.activate(),this.eventManager.controlsManager.activate(this.eventManager)}};function cs(e,t,i,n,r,s){let a={Audio:[],Video:[],Link:[],Destroy:[],Create:[],Reset:[],Transition:[],SwitchCamera:[],Animation:[],SceneTransition:[]};return t.forEach(({id:o,data:l})=>{try{l.type==="Audio"?Ca[e.type].includes("Audio")&&a.Audio.push(new Wm(o,l,s,n)):l.type==="Video"?Ca[e.type].includes("Video")&&a.Video.push(new QA(o,l,s)):l.type==="Link"?Ca[e.type].includes("Link")&&a.Link.push(new k1e(l,r)):l.type==="Create"?Ca[e.type].includes("Create")&&a.Create.push(new Qm(l,i,r.controlsManager)):l.type==="Destroy"?Ca[e.type].includes("Destroy")&&a.Destroy.push(new sz(l,i,r)):l.type==="Reset"?Ca[e.type].includes("Reset")&&a.Reset.push(new az(l,i,n,r)):l.type==="Transition"?Ca[e.type].includes("Transition")&&a.Transition.push(new qm(l,i,n)):l.type==="SwitchCamera"?Ca[e.type].includes("SwitchCamera")&&a.SwitchCamera.push(new Az(l,i)):l.type==="SceneTransition"?Ca[e.type].includes("SceneTransition")&&a.SceneTransition.push(new Tz(l,i,r,n)):l.type==="Animation"&&Ca[e.type].includes("Animation")&&a.Animation.push(new Ym(l,i,r.animationControls))}catch{}}),a}function kr(e){Object.values(e).forEach(t=>{t.forEach(i=>{(i instanceof Wm||i instanceof QA||i instanceof Ym||i instanceof qm||i instanceof Qm||i instanceof sz||i instanceof Az||i instanceof Tz||i instanceof az)&&i.dispose()})})}function Yve(e,t){let i;if("material"in e){let n=e.material;Array.isArray(n)?i=e.material[0].layers.find(r=>r.uuid===t):i=e.material.layers.find(r=>r.uuid===t)}if(i)return i.color.texture.image.img instanceof HTMLVideoElement?i.color.texture.image.img:void 0}var Pz=new Map,Zm=new Map,op=class{constructor(e,t,i){this.data=t,this.delay=0,this.status="stopped";let{layerId:n,loop:r,volume:s,delay:a}=t;if(this.object=i,n===void 0)throw new Error("Missing property");let o=Yve(i,n);o&&(this.videoElement=o,this.videoElement.loop=r===1/0,this.videoElement.autoplay=!0,s!==void 0&&(this.videoElement.volume=s)),a!==void 0&&(this.delay=a),Zm.has(i.uuid)?Zm.get(i.uuid).push(this):Zm.set(i.uuid,[this]),Pz.set(e,this),this.pause()}mute(){!this.videoElement||(this.videoElement.muted=!0)}unMute(){!this.videoElement||(this.videoElement.muted=!1)}play(e){if(!this.videoElement)return;let t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);e?(this.mute(),this.delay+=150):t?(this.mute(),window.setTimeout(()=>{this.unMute()},100)):this.unMute(),this.delayTimerId=window.setTimeout(()=>{if(!this.videoElement)return;let i=this.videoElement.play();i!==void 0&&i.then(n=>{}).catch(n=>{this.play()}),this.clearDelay()},this.delay),this.status="playing"}clearDelay(){this.delayTimerId&&(clearTimeout(this.delayTimerId),delete this.delayTimerId)}pause(){!this.videoElement||(this.videoElement.pause(),this.status="paused")}stop(){!this.videoElement||(this.videoElement.pause(),this.videoElement.currentTime=0,this.status="stopped",this.clearDelay())}playByToggle(){this.data.toggle==="stop"?this.status==="playing"?this.stop():(this.stop(),this.play()):this.data.toggle==="pause"?this.status==="playing"?this.pause():this.play():(this.stop(),this.play())}dispose(){!this.videoElement||(this.stop(),this.videoElement.muted=!0)}},UM=class{constructor(e){this.data=e}dispatch(){this.data.playVideo?this.pauseVideo(this.data.playVideo):this.data.object?this.pauseAllVideosFromObject(this.data.object):this.pauseAllVideos()}pauseVideo(e){let t=Pz.get(e);!t||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t[this.data.interaction](),this.disposeDelay()},this.data.delay)):t[this.data.interaction]())}pauseAllVideosFromObject(e){let t=Zm.get(e);!(t!=null&&t.length)||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{t.forEach(i=>i[this.data.interaction]()),this.disposeDelay()},this.data.delay)):t.forEach(i=>i[this.data.interaction]()))}pauseAllVideos(){let e=[...Zm.values()];!e.length||(this.data.delay>0?(this.disposeDelay(),this.timeoutId=window.setTimeout(()=>{e.forEach(t=>{t.forEach(i=>{i[this.data.interaction]()})}),this.disposeDelay()},this.data.delay)):e.forEach(t=>{t.forEach(i=>{i[this.data.interaction]()})}))}disposeDelay(){clearTimeout(this.timeoutId),delete this.timeoutId}dispose(){clearTimeout(this.timeoutId),delete this.timeoutId}},QA=class{constructor(e,t,i){if(this.data=t,t.interaction==="play")this.interaction=new op(e,t,i);else if(t.interaction==="pause"||t.interaction==="stop")this.interaction=new UM(t);else throw new Error("Missing property")}dispatchBasic(){this.interaction instanceof op?this.interaction.playByToggle():this.interaction.dispatch()}dispatchConditional(){this.interaction instanceof op?this.interaction.play():this.interaction.dispatch()}dispose(){this.interaction.dispose()}},PD=(()=>{let e,t,i,n;function r(o){!e&&!DD()&&(t==null?void 0:t.sharedGameControlGlobals.createdObjects.length)>0&&(e=requestAnimationFrame(s)),o&&(t=o,n=o.requestRender)}function s(o){let l=i?o-i:0,c=t.sharedGameControlGlobals.createdObjects,u=t.sharedGameControlGlobals.nCreatedPerAction,h=c.length,d=0;for(;d<h;){let p=c[d];p.userData.createdTime===void 0&&(p.userData.createdTime=o),p.userData.lifetime===void 0&&p.userData.quantity===void 0||p.userData.lifetime&&o-p.userData.createdTime<p.userData.lifetime||p.userData.quantity&&u[p.userData.actionId]<=p.userData.quantity?(p.userData.velocity&&(p.position.addScaledVector(p.userData.velocity,l/1e3),p.updateMatrix(),n()),d++):(u[p.userData.actionId]>p.userData.quantity&&u[p.userData.actionId]--,c.splice(d,1),p.removeFromParent(),t.sharedGameControlGlobals.rapierWorld&&p.rigidBody?(t.sharedGameControlGlobals.colliderToEntity.delete(p.rigidBody.collider(0).handle),t.sharedGameControlGlobals.rapierWorld.removeRigidBody(p.rigidBody)):(p.bvhGeometry=void 0,t.sharedGameControlGlobals.entitiesWithTransformAnim=t.sharedGameControlGlobals.entitiesWithTransformAnim.filter(f=>f.bvhGeometry!==void 0)),h--,n())}e=d>0?requestAnimationFrame(s):void 0,i=d>0?o:void 0}function a(){DD()?e&&(cancelAnimationFrame(e),e=void 0,i=void 0):r()}return typeof document<"u"&&document.addEventListener("visibilitychange",a),r})();function DD(){return!!document&&document.hidden}var LD=new At,Zve=new T,Qve=new T,Qm=class{constructor(e,t,i){this.data=e,this.page=t,this.controlsManager=i,this.intervalId=null,this.timeoutIdQueue=[],this.uniqueId=Dt.generateUUID(),this.dispatch=()=>{this.data.delay?this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3)):this.dispatchInner()},this.dispatchFromStart=()=>{this.timeoutIdQueue.push(window.setTimeout(this.dispatchInner,this.data.delay*1e3))},this.dispatchThrottled=Uhe(this.dispatch,1e3/this.data.creationSpeed),this.dispatchStart=()=>{this.intervalId===null&&(this.intervalId=window.setInterval(this.dispatch,1e3/this.data.creationSpeed))},this.dispatchStop=()=>{this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null)},this.dispatchInner=()=>{this.timeoutIdQueue.shift();let r=new Wn(this.object);if(r.playModeVisible=!0,r.expand(),this.data.coordinateSystem!=="world"){let a=this.data.coordinateSystem,o=this.page.scene.find(a);o&&(o.updateMatrixWorldSVD(),r.hiddenMatrix.copy(o.matrixWorldRigid))}r.position.fromArray(this.data.position),r.rotation.fromArray(this.data.rotation),r.updateMatrix(),this.page.add(r);let s=this.controlsManager.sharedGameControlGlobals;s.createdObjects.push(r),s.nCreatedPerAction[this.uniqueId]===void 0?s.nCreatedPerAction[this.uniqueId]=1:s.nCreatedPerAction[this.uniqueId]++,r.updateWorldMatrix(!0,!0),r.traverseObject(this.traverseObjectCB),PD(),this.controlsManager.requestRender()},this.traverseObjectCB=r=>{var l,c,u,h;r.hasNonUniformScale&&r.updateMatrixWorldSVD();let s;if(this.controlsManager.sharedGameControlGlobals.rapierWorld){if(r instanceof ha)if(r.objectForSample){if(r.objectForSample.dataPatched.physics.fusedBody)return;s=r.object}else return r.object.dataPatched.physics.fusedBody===!0&&r.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(r instanceof Wn)s=r.object;else if(s=r,(l=s.dataPatched.cloner)==null?void 0:l.hideBase)return!0}else{if(r instanceof ha)return;r instanceof Wn?s=r.object:s=r}this.data.destroy==="Time"?r.userData.lifetime=this.data.lifetime*1e3:this.data.destroy==="Quantity"&&(r.userData.quantity=this.data.destroyAfterQuantity,r.userData.actionId=this.uniqueId);let a=new T().fromArray(this.data.velocity),o=s.dataPatched;if(!(o.physics.enabled==="visibility"?!o.visible:!o.physics.enabled)&&(this.controlsManager.sharedGameControlGlobals.rapierWorld?(this.controlsManager.addRigidBody(r,s,{fromCreate:!0,dynamic:this.data.dynamic}),this.data.destroy==="Collision"&&((c=r.rigidBody)==null||c.collider(0).setActiveEvents(1),r.userData.hasCollisionDestroy=!0),r.matrixWorld.decompose(Zve,LD,Qve),a.applyQuaternion(LD),this.data.velocity.some(d=>d!==0)&&this.data.dynamic&&((u=r.rigidBody)==null||u.setLinvel(a.divideScalar(this.controlsManager.pixelsPerMeter),!0))):("geometry"in r.object&&this.controlsManager.addBoundsTree(r),this.data.velocity.some(d=>d!==0)&&this.data.dynamic&&(r.userData.velocity=a)),((h=s.dataPatched.physics)==null?void 0:h.fusedBody)===!0))return!0};let n=this.page.scene.find(this.data.object);if(!n)throw new Error("Missing Property");if(this.object=n,this.data.coordinateSystem!=="world"&&!this.page.scene.find(this.data.coordinateSystem))throw new Error("Missing Property");PD(i)}dispose(){this.intervalId!==null&&(window.clearInterval(this.intervalId),this.intervalId=null),this.timeoutIdQueue.forEach(e=>window.clearTimeout(e)),this.dispatchThrottled.cancel(),this.page.remove(...this.controlsManager.sharedGameControlGlobals.createdObjects),this.controlsManager.sharedGameControlGlobals.createdObjects=[]}},Dz=200,$b=.02,Jb=.3,Kve=65;new T;var RD=new T,ID=new T,$ve=new T,An=new T,Jn=new T,Al=new T,Z1=new ke,ew=new ke,Jve=new ke;new ke;var Wr=new At,wo=new At,La=new bn(0,0,0,"YXZ"),eye=new T(1,0,0),qs=new T(0,1,0),tye=new T(0,0,1),tw=new T(1,1,1),iw=new ls,iye=1,nye=.025,rye=16e-6,OD=12,sye=20,vn=new Is,ys=new Vi,aye={type:"requestRender"},oye={type:"updateMatrix"},BD=Math.PI/6,FM=class extends In{constructor(e,t,i,n,r,s,a,o,l){var f;super(),this.object=e,this.domElement=t,this.data=i,this.gloabalPhysics=n,this.controlsManager=r,this.cameraFollow=s,this.camera=a,this.page=o,this.sharedAssets=l,this.enableDamping=!0,this.hiddenMatrix0=new ke,this.target0=new T,this.zoom0=1,this.rotForce=1,this.moveForce=1,this.pixelsPerMeter=Dz,this.euler0=new bn(0,0,0,"YXZ"),this.position0Cam=new T,this.quat0Cam=new At,this.scale0Cam=new T,this.hiddenMatrix0Cam=new ke,this.threshEndTranslate=.01,this.threshEndRotate=1e-8,this.threshEndRotVel=.005,this.collider={type:"capsule",radius:40,segment:new Is(new T(0,-40,0),new T(0,40,0)),matrix:new ke,position:new T,rotation:new At},this.euler=new bn(0,0,0,"YXZ"),this.eulerDelta=new T,this.lastPosition=new T,this.lastCameraQuaternion=new At,this.lastCameraPosition=new T,this.PI_2=Math.PI/2,this.prevMouse=new te,this.velocityTarget=new T,this.velocity=new T,this.directionXZ=new T,this.rotVelocityStick=new T,this.rotVelocityTarget=new T,this.rotVelocity=new T,this.rotDirection=new T,this.nonColliderRotOffset=new ke,this.nonColliderPosOffset=new ke,this.firstPointerId=-1,this.rot=new T,this.path=[],this.movementState={moveNegZ:0,movePosZ:0,moveNegX:0,movePosX:0,moveNegY:0,movePosY:0,rotPosX:0,rotNegX:0,rotPosY:0,rotNegY:0,jump:0,run:0},this.vrEulerYOffset=0,this.onObject=!1,this.actionState={},this.keyAssignments=[["moveNegZ","W"],["moveNegX","A"],["movePosZ","S"],["movePosX","D"],["rotPosX","ArrowUp"],["rotPosY","ArrowLeft"],["rotNegX","ArrowDown"],["rotNegY","ArrowRight"],["jump"," "]],this.collisionEnabled=!0,this.offsetMatrix=new ke,this.objectToTarget=new T,this.objectToTarget0=new T,this.objectToCamXZ=new T,this.objectToCamXZ0=new T,this.targetToCamera=new T,this.targetToCamera0=new T,this.cameraPolarAxis0=new T,this.targetPos=new T,this.targetQuat=new At,this.lerpFactorPos=new T().setScalar(.3),this.lerpFactorPosStart=.3,this.lerpFactorPosEnd=.3,this.lerpFactorRotStart=.3,this.lerpFactorRotEnd=.3,this.lerpFactorPosCamera=.3,this.lerpFactorRotCamera=.3,this.objXZQuat=new At,this.objXZQuatInv=new At,this.objXZRotMat=new ke,this.isFirstPerson=!1,this.actions={},this.didHit=!1,this.groundVelocity=new T,this.pushedVelocity=new T,this.groundYRotation=0,this.objectRealQuat=new At,this.colliderWorldQuat=new At,this.groundNormal=new T,this.groundTilt=new At,this.groundTiltInv=new At,this.lastHitObj=null,this.isFirstFrame=!0,this.rotationAccumWhenOrientWithCamera=0,this.navMeshPathDest=null,this.position=new T,this.quaternion=new At,this.scale=new T,this.initialAction=!0,this.onPointerDown=v=>{v.target!==this.domElement||this.firstPointerId!==-1||(this.firstPointerId=v.pointerId,this.domElement.ownerDocument.addEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this.onPointerUp),this.rotBy!=="keys"&&!ts&&(!J8||e9>=15.5)&&this.domElement.requestPointerLock(),this.prevMouse.set(v.clientX,v.clientY))},this.onPointerUp=v=>{this.firstPointerId=-1,this.domElement.ownerDocument.removeEventListener("pointermove",this.onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this.onPointerUp),v.pointerType==="mouse"&&this.domElement.ownerDocument.exitPointerLock()},this.onPointerMove=v=>{if(v.pointerId!==this.firstPointerId)return;let m=v.clientX-this.prevMouse.x,g=v.clientY-this.prevMouse.y;this.prevMouse.set(v.clientX,v.clientY),v.pointerType==="mouse"&&this.rotBy!=="keys"&&(J8&&e9<15.5&&!ts?(this.eulerDelta.y=-m*this.mouseOrbitSensitivity,this.eulerDelta.x=-g*this.mouseOrbitSensitivity):(this.eulerDelta.y=-v.movementX*this.mouseOrbitSensitivity,this.eulerDelta.x=-v.movementY*this.mouseOrbitSensitivity)),v.pointerType!=="mouse"&&this.rotByTouch==="drag"&&(this.eulerDelta.y=-m*this.mouseOrbitSensitivity*5,this.eulerDelta.x=-g*this.mouseOrbitSensitivity*5),this.controlsManager.requestRender()},this.onPointerlockChange=v=>{this.domElement.ownerDocument.pointerLockElement===this.domElement?FM.isLocked=!0:FM.isLocked=!1},this.onPointerlockError=()=>{console.error("SPE.GameControls: Unable to use Pointer Lock API")},this.handleVisibilityChange=()=>{if(document!=null&&document.hidden)for(let v in this.movementState)this.movementState[v]=0},this.onKeyDown=v=>{!(v.target instanceof HTMLInputElement)&&(v.code==="ArrowLeft"||v.code==="ArrowUp"||v.code==="ArrowRight"||v.code==="ArrowDown"||v.code==="Space")&&v.preventDefault();for(let m of this.keyAssignments)if(v.key.toUpperCase()===m[1]||v.key===m[1]){this.movementState[m[0]]=1;break}this.controlsManager.requestRender()},this.onKeyUp=v=>{for(let m of this.keyAssignments)if(v.key.toUpperCase()===m[1]||v.key===m[1]||v.code.slice(3,v.code.length).toUpperCase()===m[1]){this.movementState[m[0]]=0;break}},this.copyVRGamePadValues=(v,m)=>{for(let g=2;g<4;g++){let y=v.axes[g];m===0?g===2?this.movementState.movePosX=y:this.movementState.movePosZ=y:(v.buttons[3].pressed?this.movementState.jump=1:this.movementState.jump=0,g===2?(Math.abs(this.movementState.rotPosY)<.3&&Math.abs(y)>=.3&&(this.vrEulerYOffset+=y<0?1:-1),this.movementState.rotPosY=y):this.moveMode==="fly"&&(this.movementState.moveNegY=y))}},this.sharedGameControlGlobals=r.sharedGameControlGlobals,e===a&&(this.isFirstPerson=!0),this.hiddenMatrix0.copy(this.object.hiddenMatrix),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.euler0.setFromQuaternion(this.quaternion,"YXZ");let c=this.euler0.clone(),u=c.y;if(this.objectRealQuat.copy(this.quaternion),c.y=0,this.quaternion.setFromEuler(c),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),c.set(0,u,0),this.quaternion.setFromEuler(c),this.rot.setFromEuler(c),this.object.matrixAutoUpdate=!1,(this.isFirstPerson||this.cameraFollow===!0)&&(this.target0.copy(this.camera.getTarget()),this.zoom0=this.camera.zoom),this.cameraFollow===!0){this.position0Cam.copy(this.camera.position),this.quat0Cam.copy(this.camera.quaternion),this.scale0Cam.copy(this.camera.scale),this.hiddenMatrix0Cam.copy(this.camera.hiddenMatrix),this.camera.parent?(this.camera.hiddenMatrix.copy((f=this.camera)==null?void 0:f.parent.matrixWorld),this.camera.matrix.copy(this.camera.matrixWorld)):this.camera.hiddenMatrix.identity(),this.camera.matrix.copy(this.camera.matrixWorld),this.camera.matrix.decompose(this.camera.position,this.camera.quaternion,this.camera.scale),this.camera.matrixAutoUpdate=!1,this.offsetMatrix.copy(this.object.matrix).invert().multiply(this.camera.matrix);let v=new T(0,0,-1).applyQuaternion(this.camera.quaternion),m=new T().subVectors(this.position,this.camera.position);this.objectToCamXZ.copy(m),this.objectToCamXZ.y=0,this.objectToCamXZ0.copy(this.objectToCamXZ);let g,y;Math.abs(v.y)<1e-6?(m.y=0,v.y=0,y=m.projectOnVector(v)):m.y/v.y>0?y=v.multiplyScalar(m.y/v.y):y=v.multiplyScalar(m.length()),this.targetToCamera0.copy(y).negate(),g=this.camera.position.clone().add(y),this.objectToTarget0.subVectors(g,this.position);let x=new bn().setFromQuaternion(this.camera.quaternion,"YXZ");this.cameraPolarOffset=-x.x,x.x=0,x.z=0,x.y-=Math.PI/2,this.cameraPolarAxis0.set(0,0,-1).applyEuler(x)}if(this.object instanceof qn&&(this.object.matrixAutoUpdate=!1),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.rotByTouch=i.rotByTouch??"joystick",this.rotBy=i.rotBy??"keys",this.rotationMode=i.rotationMode??"normal",this.moveMode=i.moveMode??"walk",this.collisionEnabled=i.collisionEnabled,this.speedTranslate=(i.speedTranslate??250)*iye,this.speedOrbit=(i.speedRotate??100)*nye,this.mouseOrbitSensitivity=(i.speedRotate??100)*rye,this.keyAssignments=i.keyAssignments.map(v=>{let m=[v[0],v[1]];return m[1]==="▲"?m[1]="ArrowUp":m[1]==="◀"?m[1]="ArrowLeft":m[1]==="▼"?m[1]="ArrowDown":m[1]==="▶"?m[1]="ArrowRight":m[1]==="⇧"?m[1]="Shift":m[1]==="↵"?m[1]="Enter":m[1]==="Space"?m[1]=" ":m[1]==="⌘"?m[1]="Meta":m[1]==="Ctrl"?m[1]="Control":m[1]==="Esc"&&(m[1]="Escape"),m}),i.rotBy==="mouse"){let v;v=this.keyAssignments.findIndex(m=>m[0]==="rotNegX"),v!==-1&&(this.keyAssignments[v][1]=""),v=this.keyAssignments.findIndex(m=>m[0]==="rotPosX"),v!==-1&&(this.keyAssignments[v][1]=""),v=this.keyAssignments.findIndex(m=>m[0]==="rotPosY"),v!==-1&&(this.keyAssignments[v][1]=""),v=this.keyAssignments.findIndex(m=>m[0]==="rotNegY"),v!==-1&&(this.keyAssignments[v][1]="")}this.lerpFactorPosStart=1-.02**(1/((i.delayPos[0]??.3)*60)),this.lerpFactorPosEnd=1-.02**(1/((i.delayPos[1]??.3)*60)),this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.lerpFactorRotStart=1-.02**(1/((i.delayRot[0]??.3)*60)),this.lerpFactorRotEnd=1-.02**(1/((i.delayRot[1]??.3)*60)),this.lerpFactorPosCamera=1-.02**(1/((i.delayPosCamera??.3)*60)),this.lerpFactorRotCamera=1-.02**(1/((i.delayRotCamera??.3)*60)),this.gravity=(this.gloabalPhysics.gravity??Pp.defaultData.gravity)*OD,this.usePhysics=this.gloabalPhysics.usePhysics??Pp.defaultData.usePhysics,this.jumpPower=i.jumpPower*sye,this.resetYPosition=this.position.y+Math.abs(i.resetYPosition)*(this.gravity>0?1:-1),this.alignToGround=i.alignToGround??!1,this.orientMode=i.autoOrientMove?i.orientMode:"none",this.orientWith=i.orientWith??hx.defaultDataThirdPerson.orientWith,this.slopeThresh=Kve*Math.PI/180,i.collider.type==="capsule"?(this.collider.radius=i.collider.radius,this.collider.segment.start.y=i.collider.height/2-i.collider.radius,this.collider.segment.end.y=-this.collider.segment.start.y,this.offset=i.collider.height*$b/this.pixelsPerMeter,this.stepThresh=i.collider.height*Jb/this.pixelsPerMeter,this.colliderHeight=i.collider.height):i.collider.type==="sphere"?(this.collider.radius=i.collider.radius,this.collider.segment.start.y=0,this.collider.segment.end.y=0,this.offset=2*i.collider.radius*$b/this.pixelsPerMeter,this.stepThresh=2*i.collider.radius*Jb/this.pixelsPerMeter,this.colliderHeight=i.collider.radius*2):(this.offset=i.collider.height*$b/this.pixelsPerMeter,this.stepThresh=i.collider.height*Jb/this.pixelsPerMeter,this.colliderHeight=i.collider.height),this.collider.type=i.collider.type;let h=new T().fromArray(i.collider.position),d=new At().setFromEuler(new bn().fromArray([...i.collider.rotation,"XYZ"]));this.collider.position.copy(h).multiply(this.scale),this.collider.rotation.copy(d),this.collider.matrix.compose(h,d,tw),i.cameraXAxis!==void 0&&(this.cameraXAxis=i.cameraXAxis,this.cameraYAxis=i.cameraYAxis,this.minPolarAngle=i.cameraRotXLimits[0],this.maxPolarAngle=i.cameraRotXLimits[1],this.minAzimuthAngleRel=i.cameraRotYLimits[0],this.maxAzimuthAngleRel=i.cameraRotYLimits[1]),this.forwardDir=i.forwardDirection??"-z",this.runMultiplier=i.runMultiplier??2;let p=i.navmesh.destinationHelperRadius*2;if(p>0){let v=new yt;v.push({fi:0,data:{...wr.defaultData("light","phong"),alpha:0},id:"layer1"}),v.push({fi:0,data:{...wr.defaultData("color"),color:i.navmesh.destinationHelperColor,alpha:i.navmesh.destinationHelperColor.a},id:"layer2"});let m=new AA({layers:v},{scene:this.page.scene,shared:this.sharedAssets});this.navMeshPathDest=new Ar(IU.create({parameters:{width:p,height:p/10,hollow:.7}}),m),this.navMeshPathDest.material.userData.opacity0=i.navmesh.destinationHelperColor.a}this.activate()}reset(e=!1){if(this.object.hiddenMatrix.copy(this.hiddenMatrix0),e){this.object.updateMatrix(),this.object.updateMatrixWorld(),this.object.matrix.copy(this.object.matrixWorld),this.object.matrix.decompose(this.position,this.quaternion,this.scale),this.object.parent?this.object.hiddenMatrix.copy(this.object.parent.matrixWorld).invert():this.object.hiddenMatrix.identity();let t=new bn().setFromQuaternion(this.quaternion,"YXZ"),i=t.y;this.objectRealQuat.copy(this.quaternion),t.y=0,this.quaternion.setFromEuler(t),this.objXZQuat.copy(this.quaternion),this.objXZQuatInv.copy(this.objXZQuat).invert(),this.objXZRotMat.makeRotationFromQuaternion(this.quaternion),t.set(0,i,0),this.quaternion.setFromEuler(t),this.rot.setFromEuler(t),this.euler.setFromQuaternion(this.quaternion,"YXZ"),this.velocityTarget.set(0,0,0),this.velocity.set(0,0,0)}else this.object instanceof qn?this.object.matrixAutoUpdate=!0:this.object.updateMatrix();this.cameraFollow===!0&&(this.camera.quaternion.copy(this.quat0Cam),this.camera.position.copy(this.position0Cam),this.camera.scale.copy(this.scale0Cam),this.camera.hiddenMatrix.copy(this.hiddenMatrix0Cam),this.camera.matrixAutoUpdate=!0),this.controlsManager.requestRender()}activate(){this.instantiateActions(),this.domElement.ownerDocument.addEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.addEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.addEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.addEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.addEventListener("visibilitychange",this.handleVisibilityChange)}deactivate(){this.disposeActions(),this.domElement.ownerDocument.removeEventListener("pointerdown",this.onPointerDown),this.domElement.ownerDocument.removeEventListener("keydown",this.onKeyDown),this.domElement.ownerDocument.removeEventListener("keyup",this.onKeyUp),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this.onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this.onPointerlockError),this.domElement.ownerDocument.removeEventListener("visibilitychange",this.handleVisibilityChange)}dispose(){var e;this.deactivate(),(e=this.navMeshPathDest)!=null&&e.parent&&this.page.remove(this.navMeshPathDest)}instantiateActions(){let e=this.data,t=this.page,i=this.sharedAssets,n=this.object;e.gameActions!==void 0&&Object.entries(e.gameActions).forEach(([r,s],a)=>{s.forEach(({id:o,data:l})=>{try{this.actions[r]===void 0&&(this.actions[r]=[]),l.type==="Transition"?this.actions[r].push(new qm(l,t,i)):l.type==="Animation"?this.actions[r].push(new Ym(l,t,this.controlsManager.eventManager.animationControls)):l.type==="Audio"?this.actions[r].push(new Wm(o,l,n,i)):l.type==="Video"?this.actions[r].push(new QA(o,l,n)):l.type==="Create"&&this.actions[r].push(new Qm(l,t,this.controlsManager))}catch{}})}),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"),this.initialAction&&(this.initialAction=!1)}disposeActions(){this.initialAction=!1,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),kr(this.actions)}dispatchStartEvent(e){this.actions[e]!==void 0&&(this.actionState[e]||(this.actionState[e]=!0,this.actions[e].forEach(t=>{t instanceof qm?t.play():t instanceof Ym?t.play(this.initialAction===!1):t instanceof Qm?t.dispatchStart():t instanceof Wm&&t.dispatchGameControl("start")})))}dispatchStopEvent(e){this.actions[e]!==void 0&&(!this.actionState[e]||(this.actionState[e]=!1,this.actions[e].forEach(t=>{t instanceof qm?(t.stop(),t.object.currentState!==null&&t.object.changeSelectedState(null,{scene:this.page.scene,shared:this.sharedAssets})):t instanceof Ym||(t instanceof Qm?t.dispatchStop():t instanceof Wm&&t.dispatchGameControl("stop"))})))}get colliderWorldPosition(){return An.copy(this.collider.position).applyQuaternion(this.objectRealQuat).add(this.position)}update(e,t,i){var o,l,c,u,h,d,p,f,v,m,g;if(this.gravity<0?this.position.y<this.resetYPosition:this.position.y>this.resetYPosition)return this.reset(!0),!0;this.sharedGameControlGlobals.gamePads.forEach(this.copyVRGamePadValues);let n=(this.isFirstFrame?16.6:e)/1e3;this.isFirstFrame&&(this.isFirstFrame=!1);let r=n*60,s=!1;if(this.usePhysics&&this.collisionEnabled){let y=Jn.set(0,(this.velocity.y===0?this.pixelsPerMeter*Math.max(Math.abs(this.gravity)/(10*OD),1)*(this.gravity>0?1:-1):this.velocity.y)*n,0).divideScalar(this.pixelsPerMeter),x=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter),this.colliderWorldQuat,y,(o=this.object.rigidBody)==null?void 0:o.collider(0).shape,1,!1,16,void 0,void 0,this.object.rigidBody);if(x){this.onObject=!0,this.groundNormal.set(x.normal2.x,x.normal2.y,x.normal2.z).applyQuaternion(this.colliderWorldQuat).negate(),this.alignToGround&&this.groundTiltAdjustment(this.groundNormal),Math.acos(this.groundNormal.y)<this.slopeThresh&&(s=!0),((l=x.collider.parent())==null?void 0:l.bodyType())===0&&Math.acos(this.groundNormal.y)*(180/Math.PI)>45&&(this.onObject=!1);let _=x.collider.parent();this.groundYRotation=0,this.groundVelocity.set(0,0,0);for(let b of this.sharedGameControlGlobals.entitiesWithTransformAnim)if(b.rigidBody===_&&b.userData.isFollowingObj!==this.object.uuid){(b.hasNonUniformScale?b.matrixWorldRigid:b.matrixWorld).decompose(An,wo,Jn),this.groundVelocity.subVectors(An,b.prevT),this.object.getWorldPosition(Jn).add(this.collider.position).sub(An),this.groundYRotation=La.setFromQuaternion(wo).y-b.prevR.y,Al.copy(Jn).applyAxisAngle(qs,this.groundYRotation),this.groundVelocity.add(Al.sub(Jn)).divideScalar(n);break}}else this.onObject=!1}if(this.moveMode==="walk"&&this.collisionEnabled&&(this.movementState.jump===1&&this.onObject&&(this.velocityTarget.y=this.jumpPower,this.movementState.jump=0,this.dispatchStopEvent("idle"),this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.dispatchStopEvent("jump"),this.dispatchStartEvent("jump"),this.onObject=!1),this.onObject?this.velocityTarget.y/=2:this.velocityTarget.y+=this.gravity*r),this.moveMode==="fly"&&(this.velocityTarget.y=(this.movementState.movePosY-this.movementState.moveNegY)*this.speedTranslate),this.directionXZ.z=this.movementState.movePosZ-this.movementState.moveNegZ,this.directionXZ.x=this.movementState.movePosX-this.movementState.moveNegX,this.forwardDir==="+z"&&this.directionXZ.multiplyScalar(-1),this.directionXZ.manhattanLength()>0&&(this.path=[]),this.navMeshPathDest){let y=this.navMeshPathDest.material;if(this.moveMode==="walk"&&this.path.length>1){this.navMeshPathDest.position.copy(this.path[this.path.length-1]),this.navMeshPathDest.parent||this.page.add(this.navMeshPathDest);let x=An.subVectors(this.path[1],this.position),_=Jn.subVectors(this.path[1],this.path[0]);x.dot(_)<0?this.path.shift():(this.directionXZ.x=_.x,this.directionXZ.z=_.z),y.opacity=y.userData.opacity0}else y.opacity-=.05*y.userData.opacity0,this.navMeshPathDest.material.opacity<=0&&this.navMeshPathDest.parent&&this.page.remove(this.navMeshPathDest)}this.directionXZ.normalize(),this.movementState.run?this.moveForce=this.runMultiplier:this.moveForce=1,this.velocityTarget.z=this.directionXZ.z*this.speedTranslate*this.moveForce,this.velocityTarget.x=this.directionXZ.x*this.speedTranslate*this.moveForce,(this.moveMode==="walk"?this.velocityTarget.x+this.velocityTarget.z===0:this.velocityTarget.manhattanLength()===0)?this.lerpFactorPos.setScalar(this.lerpFactorPosEnd):this.lerpFactorPos.setScalar(this.lerpFactorPosStart),this.moveMode==="walk"&&(this.lerpFactorPos.y=1),this.didHit===!1&&this.pushedVelocity.manhattanLength()===0||this.usePhysics===!1?(this.velocity.x+=(this.velocityTarget.x-this.velocity.x)*(1-(1-this.lerpFactorPos.x)**r),this.velocity.y+=(this.velocityTarget.y-this.velocity.y)*(1-(1-this.lerpFactorPos.y)**r),this.velocity.z+=(this.velocityTarget.z-this.velocity.z)*(1-(1-this.lerpFactorPos.z)**r)):this.velocity.copy(this.velocityTarget),(this.moveMode==="walk"?this.velocity.x**2+this.velocity.z**2<this.speedTranslate:this.velocity.lengthSq()<this.speedTranslate)?(this.dispatchStopEvent("move"),this.dispatchStopEvent("run"),this.onObject&&(this.dispatchStopEvent("jump"),this.dispatchStartEvent("idle"))):(this.dispatchStopEvent("idle"),this.onObject&&(this.dispatchStopEvent("jump"),this.movementState.run?(this.dispatchStopEvent("move"),this.dispatchStartEvent("run")):(this.dispatchStopEvent("run"),this.dispatchStartEvent("move"))));let a=$ve.copy(this.velocity);if(this.orientMode!=="none"&&this.isFirstPerson===!1){let y=Jn.copy(a);y.y=0,a.set(0,a.y,y.length()*(this.forwardDir==="+z"?1:-1))}if(this.directionXZ.manhattanLength()>0&&this.orientMode!=="none")if(this.orientWith==="camera"&&this.path.length<=1){let y=An;this.camera.getWorldDirection(y);let x=Al.copy(qs).multiplyScalar(y.dot(qs));y.sub(x);let _=Jn.copy(this.directionXZ);_.x*=-1,this.rot.y=y.angleTo(_)*(y.cross(_).y>0?-1:1)+this.rotationAccumWhenOrientWithCamera}else this.rot.y=(this.path.length>1?0:this.euler.y)+Math.atan2(-this.directionXZ.z,this.directionXZ.x)+Math.PI/2*(this.forwardDir==="+z"?1:-1);if(La.setFromVector3(this.rot),this.moveMode==="walk"&&(La.x=0),a.applyEuler(La),s&&(wo.setFromUnitVectors(qs,this.groundNormal),a.applyQuaternion(wo)),i){let y=La.set(0,this.vrEulerYOffset*BD,0);i.applyEuler(y),a.x+=i.x,a.z+=i.z,this.nonColliderPosOffset.elements[13]+=i.y*n}if(this.usePhysics===!0){let y=Jn;this.pushedVelocity.set(0,0,0);for(let x of this.sharedGameControlGlobals.entitiesWithTransformAnim){let _=Al.setFromMatrixPosition(x.matrixWorld).sub(x.prevT).divideScalar(n).divideScalar(this.pixelsPerMeter),b=x.rigidBody.collider(0).castCollider(_,this.object.rigidBody.collider(0),An.copy(a).divideScalar(this.pixelsPerMeter),n,!1);_.multiplyScalar(this.pixelsPerMeter);let w=Vt.is(x)?x:x.object;if(b!==null&&this.lastHitObj!==w){let M;x instanceof Wn&&(M=x);let S=this.sharedGameControlGlobals.entityToCollisionEvents[w.uuid];if(S)for(let C of S)C.data.target==="character"&&(C.dispatch(M),w.dispatchEvent(VM));this.lastHitObj=w}if(b!==null){this.pushedVelocity.copy(_),y.copy(b.normal1).applyQuaternion(x.quaternion);break}}if(this.pushedVelocity.manhattanLength()!==0){let x=y.dot(a);x<0&&a.addScaledVector(y,-x),a.add(this.pushedVelocity)}else a.add(this.groundVelocity)}if(this.rotDirection.y=Number(this.movementState.rotPosY)-Number(this.movementState.rotNegY),this.rotDirection.x=Number(this.movementState.rotPosX)-Number(this.movementState.rotNegX),this.rotDirection.normalize(),this.rotationMode==="normal"&&(this.movementState.rotPosX||this.movementState.rotNegX)||this.rotationMode==="steer"&&(this.movementState.rotPosX||this.movementState.rotNegX)&&(this.movementState.movePosZ||this.movementState.moveNegZ||this.moveMode==="walk")?this.rotVelocityStick.x=-this.rotDirection.x*this.speedOrbit*this.rotForce:this.rotVelocityStick.x=0,this.rotationMode==="normal"&&(this.movementState.rotPosY||this.movementState.rotNegY)||this.rotationMode==="steer"&&(this.movementState.rotPosY||this.movementState.rotNegY)&&(this.movementState.movePosZ||this.movementState.moveNegZ)?this.rotVelocityStick.y=-this.rotDirection.y*this.speedOrbit*this.rotForce:this.rotVelocityStick.y=0,this.rotVelocityTarget.subVectors(this.eulerDelta.divideScalar(n),this.rotVelocityStick),this.rotVelocityTarget.manhattanLength()===0?this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotEnd)**r):this.rotVelocity.lerp(this.rotVelocityTarget,1-(1-this.lerpFactorRotStart)**r),this.euler.x+=this.rotVelocity.x*n,this.euler.y+=this.rotVelocity.y*n+this.groundYRotation,this.rotVelocityTarget.y===0&&this.directionXZ.manhattanLength()===0?this.rotationAccumWhenOrientWithCamera=0:(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.rotationAccumWhenOrientWithCamera+=this.rotVelocity.y*n),this.isFirstPerson===!1&&this.orientMode!=="none"&&this.directionXZ.manhattanLength()>0){if(this.orientMode==="radial"){this.objectToCamXZ.copy(this.objectToCamXZ0).applyAxisAngle(qs,this.euler.y-this.euler0.y);let y=Jn.copy(this.objectToCamXZ).normalize(),x=Al.copy(a).multiplyScalar(n);x.y=0;let _=x.sub(An.copy(y).multiplyScalar(x.dot(y))).cross(y).y;this.euler.y-=Math.atan2(_,this.objectToCamXZ.length())}}else this.rot.y+=this.rotVelocity.y*n+this.groundYRotation,this.rotVelocityTarget.y!==0&&(this.cameraFollow===!1||this.cameraYAxis==="Locked")&&(this.euler.y=this.rot.y);if(this.cameraFollow===!0&&(this.moveMode==="walk"?this.cameraXAxis==="Limit"?this.euler.x=Dt.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):this.euler.x=Dt.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset,this.PI_2+this.cameraPolarOffset):this.cameraXAxis==="Limit"&&(this.euler.x=Dt.clamp(this.euler.x,-this.PI_2,this.PI_2))),this.moveMode==="fly"?this.rot.x=this.euler.x:this.isFirstPerson&&(t?(La.copy(t),La.y=0):(La.copy(this.euler),La.y=0),this.nonColliderRotOffset.makeRotationFromEuler(La)),t&&(this.moveMode==="walk"?(this.rot.y=t.y,this.rot.x=0,this.rot.z=0):this.rot.setFromEuler(t),this.rot.y+=this.vrEulerYOffset*BD),Wr.setFromAxisAngle(eye,this.rot.x),wo.setFromAxisAngle(qs,this.rot.y),wo.multiply(Wr),Wr.setFromAxisAngle(tye,this.rot.z),wo.multiply(Wr),this.quaternion.copy(wo),this.objectRealQuat.multiplyQuaternions(this.quaternion,this.objXZQuat),this.objectRealQuat.multiply(this.objXZQuat),this.colliderWorldQuat.copy(this.objectRealQuat).multiply(this.collider.rotation),this.collisionEnabled)if(this.usePhysics){let y=Jn.copy(a).multiplyScalar(n/this.pixelsPerMeter),x=null;this.didHit=!1;let _=new T;for(let b=0;b<5;b++){let w=y.length(),M=Al.copy(y).normalize();if(x=this.sharedGameControlGlobals.rapierWorld.castShape(this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(_),this.colliderWorldQuat,M,(c=this.object.rigidBody)==null?void 0:c.collider(0).shape,w,!1,24,void 0,void 0,this.object.rigidBody),x!==null){this.didHit=!0;let S=this.sharedGameControlGlobals.colliderToEntity.get(x.collider.handle);if(S!==this.lastHitObj&&b===0){this.lastHitObj=S;let I=this.sharedGameControlGlobals.entityToCollisionEvents[S==null?void 0:S.uuid];if(I){for(let D of I)if(D.data.target==="character"){let L=((u=this.sharedGameControlGlobals.rapierWorld)==null?void 0:u.getCollider(x.collider.handle))._parent,B;if(S.cloner){for(let j of S.cloner.children)if(j.rigidBody===L){B=j;break}}D.dispatch(B),S.dispatchEvent(VM)}}}let C=RD.set(x.normal2.x,x.normal2.y,x.normal2.z).applyQuaternion(this.colliderWorldQuat),E=ID.copy(M).multiplyScalar(x.toi).dot(C),P=x.toi;if(P===0&&(this.position.y+=this.offset*this.pixelsPerMeter),E>this.offset&&(P=x.toi*(E-this.offset)/E,_.addScaledVector(M,P)),y.copy(M).multiplyScalar(w-P),Math.acos(-C.y)>this.slopeThresh){let I=this.colliderWorldPosition.divideScalar(this.pixelsPerMeter).add(_),D=Al.copy(x.witness2).applyQuaternion(this.colliderWorldQuat);D.y=0;let L=I.add(D);L.y+=this.stepThresh;let B=this.sharedGameControlGlobals.rapierWorld.castShape(L,this.colliderWorldQuat,y,(h=this.object.rigidBody)==null?void 0:h.collider(0).shape,1,!1,24,void 0,void 0,this.object.rigidBody);B!==null&&B.toi===0&&(C.y=0,C.normalize())}y.addScaledVector(C,-y.dot(C))}else{b===0&&this.directionXZ.manhattanLength()!==0&&(this.lastHitObj=null),_.add(y);break}}this.position.addScaledVector(_,this.pixelsPerMeter),(d=this.object.rigidBody)==null||d.setTranslation(An.copy(this.position).divideScalar(this.pixelsPerMeter),!0),(p=this.object.rigidBody)==null||p.setRotation(Wr.copy(this.quaternion).premultiply(this.groundTilt).multiply(this.objXZQuat),!0)}else{let y=this.onObject?1:5,x=a.multiplyScalar(n/y);for(let _=0;_<y;_++)this.position.add(x),_===0&&this.checkTrigger(),this.collisionAdjustment(n/y)}else this.position.addScaledVector(a,n);if(this.moveMode==="walk"&&this.onObject&&(this.velocityTarget.y=0,this.velocity.y=0),this.quaternion.premultiply(this.groundTilt).multiply(this.objXZQuat),this.object.matrix.compose(this.position,this.quaternion,this.scale),this.object.matrixWorldNeedsUpdate=!0,this.object.matrix.multiply(this.nonColliderPosOffset).multiply(this.nonColliderRotOffset),this.quaternion.premultiply(this.groundTiltInv).multiply(this.objXZQuatInv),this.cameraFollow===!0){this.updateFollowArms();let y=this.objectToTarget.add(this.position),x=this.targetToCamera.add(y);Z1.lookAt(x,y,qs).setPosition(x),Z1.decompose(this.targetPos,this.targetQuat,An),this.camera.quaternion.slerp(this.targetQuat,1-(1-this.lerpFactorRotCamera)**r),this.camera.position.lerp(this.targetPos,1-(1-this.lerpFactorPosCamera)**r),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.cameraYAxis==="Limit"&&this.orientMode==="cartesian"&&(this.euler.y=Dt.clamp(this.euler.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel)),this.euler.x=Dt.clamp(this.euler.x,-this.PI_2+(this.cameraPolarOffset<0?this.cameraPolarOffset:0),this.PI_2+(this.cameraPolarOffset>0?this.cameraPolarOffset:0))}return this.eulerDelta.set(0,0,0),this.object.dispatchEvent(oye),this.path.length<2&&this.lastPosition.distanceToSquared(this.position)<this.threshEndTranslate&&Math.abs(this.rotVelocity.x)<this.threshEndRotVel&&Math.abs(this.rotVelocity.y)<this.threshEndRotVel&&(this.camera===void 0||this.isFirstPerson||this.lastCameraPosition.distanceToSquared(this.camera.position)<this.threshEndTranslate&&8*(1-this.lastCameraQuaternion.dot(this.camera.quaternion))<this.threshEndRotate)&&(this.moveMode==="fly"||this.onObject===!0||this.collisionEnabled===!1)&&((v=(f=this.navMeshPathDest)==null?void 0:f.material)==null?void 0:v.opacity)<-.04*((g=(m=this.navMeshPathDest)==null?void 0:m.material)==null?void 0:g.userData.opacity0)?!1:(this.camera&&(this.lastCameraPosition.copy(this.camera.position),this.lastCameraQuaternion.copy(this.camera.quaternion)),this.lastPosition.copy(this.position),this.object.dispatchEvent(aye),!0)}updateFollowArms(){this.objectToTarget.copy(this.objectToTarget0),this.targetToCamera.copy(this.targetToCamera0);let e=Wr.setFromAxisAngle(qs,this.cameraYAxis==="Limit"&&this.orientMode!=="radial"?Dt.clamp(this.euler.y-this.euler0.y,this.minAzimuthAngleRel,this.maxAzimuthAngleRel):this.euler.y-this.euler0.y);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&this.objectToTarget.applyQuaternion(e);let t;this.cameraXAxis==="Limit"?t=Dt.clamp(this.euler.x,-this.maxPolarAngle+this.cameraPolarOffset+1e-6,-this.minPolarAngle+this.cameraPolarOffset-1e-6):t=Dt.clamp(this.euler.x,-this.PI_2+this.cameraPolarOffset+1e-6,this.PI_2+this.cameraPolarOffset-1e-6);let i=An.copy(this.cameraPolarAxis0);(this.cameraYAxis!=="Locked"||this.orientMode==="radial")&&i.applyQuaternion(e);let n=wo.setFromAxisAngle(i,t);this.cameraYAxis!=="Locked"&&this.targetToCamera.applyQuaternion(e),this.cameraXAxis!=="Locked"&&this.targetToCamera.applyQuaternion(n)}groundTiltAdjustment(e){qs.angleTo(e)*180/Math.PI<15||qs.angleTo(e)*180/Math.PI>85?Wr.identity():Wr.setFromUnitVectors(qs,e),this.groundTilt.slerp(Wr,.06),this.groundTiltInv.copy(this.groundTilt).invert()}checkTrigger(){let e;for(let t=0;t<this.sharedGameControlGlobals.triggers.length;t++){let[i,n,r,s]=this.sharedGameControlGlobals.triggers[t];for(let a=0;a<this.sharedGameControlGlobals.entitiesWithTransformAnim.length;a++){let o=this.sharedGameControlGlobals.entitiesWithTransformAnim[a];if(r===o||s.isValidTriggeringObject(Vt.is(o)?o:o.object)===!1)continue;let l=ew.copy(r.matrixWorld).decompose(An,Wr,Jn).compose(An,Wr,tw).multiply(n),c=Z1.copy(o.matrixWorld).invert().multiply(l);i instanceof Vi?e=o.bvhGeometry.boundsTree.intersectsBox(i,c):(iw.radius=i,iw.center.setFromMatrixPosition(c),e=o.bvhGeometry.boundsTree.intersectsSphere(iw)),e?s.currentIntersectedObjects.indexOf(o)===-1&&(s.currentIntersectedObjects.push(o),s.dispatch(),r.dispatchEvent(mxe)):s.currentIntersectedObjects=s.currentIntersectedObjects.filter(u=>u!==o)}}}collisionAdjustment(e){var r;let t=ID.set(0,0,0);this.object.matrix.compose(this.position,this.quaternion,this.scale);let i=Z1.multiplyMatrices(this.object.matrix,this.objXZRotMat).multiply(this.collider.matrix).decompose(An,Wr,Jn).compose(An,Wr,tw);this.sharedGameControlGlobals.entitiesWithTransformAnim.forEach(s=>{if(s===this.object||s.isDescendantOf(this.object))return;ys.makeEmpty(),s.updateMatrixWorldSVD();let a=s.matrixWorldRigid,o=ew.copy(a).invert(),l=Jve.copy(ew).multiply(i);vn.copy(this.collider.segment),vn.start.applyMatrix4(l),vn.end.applyMatrix4(l);let c=RD.copy(this.position).applyMatrix4(o);ys.expandByPoint(vn.start),ys.expandByPoint(vn.end),ys.min.addScalar(-this.collider.radius),ys.max.addScalar(this.collider.radius),s.bvhGeometry.boundsTree.shapecast({traverseBoundsOrder(u){return u.distanceToPoint(vn.end)},intersectsBounds:u=>u.intersectsBox(ys),intersectsTriangle:u=>{let h=An,d=Jn,p=u.closestPointToSegment(vn,h,d);if(p<this.collider.radius){let f=this.collider.radius-p,v=d.sub(h).normalize(),m=Al.copy(c);m.addScaledVector(v,f);let g=m.applyMatrix4(a).sub(this.position);t.add(g),vn.start.addScaledVector(v,f),vn.end.addScaledVector(v,f)}}})}),ys.makeEmpty(),vn.copy(this.collider.segment),vn.start.applyMatrix4(i),vn.end.applyMatrix4(i),ys.expandByPoint(vn.start),ys.expandByPoint(vn.end),ys.min.addScalar(-this.collider.radius),ys.max.addScalar(this.collider.radius),(r=this.sharedGameControlGlobals.staticMeshBVH)==null||r.shapecast({traverseBoundsOrder(s){return s.distanceToPoint(vn.end)},intersectsBounds:s=>s.intersectsBox(ys),intersectsTriangle:s=>{let a=An,o=Jn,l=s.closestPointToSegment(vn,a,o);if(l<this.collider.radius){let c=this.collider.radius-l,u=o.sub(a).normalize();this.alignToGround&&this.groundTiltAdjustment(u),t.addScaledVector(u,c),vn.start.addScaledVector(u,c),vn.end.addScaledVector(u,c)}}}),this.onObject=Math.abs(t.y)>Math.abs(e*this.velocity.y*.25),this.onObject&&this.dispatchStopEvent("jump");let n=Math.max(0,t.length()-1e-5);t.normalize().multiplyScalar(n),this.position.add(t)}},Lz=FM;Lz.isLocked=!1;var lye=Gp(yB());function jo(e,t){let i=new mt;if(!e.getAttribute("position"))return i.setAttribute("position",new et([],3)),i.setIndex([]),i;let{positions:n,triIndices:r}=S2(e.getAttribute("position"),e.getIndex());return i.setAttribute("position",new et(n,3)),i.setIndex(r),t&&i.applyMatrix4(t),i}var cye=new ke,hye=new ke,Ra=[[0,0,0],[0,0,0],[0,0,0]];function Rz(e){let t=e.elements;Ra[0][0]=t[0],Ra[0][1]=t[4],Ra[0][2]=t[8],Ra[1][0]=t[1],Ra[1][1]=t[5],Ra[1][2]=t[9],Ra[2][0]=t[2],Ra[2][1]=t[6],Ra[2][2]=t[10];let{u:i,v:n}=(0,lye.SVD)(Ra),r=cye.set(i[0][0],i[0][1],i[0][2],0,i[1][0],i[1][1],i[1][2],0,i[2][0],i[2][1],i[2][2],0,0,0,0,1),s=hye.set(n[0][0],n[0][1],n[0][2],0,n[1][0],n[1][1],n[1][2],0,n[2][0],n[2][1],n[2][2],0,0,0,0,1);return r.multiply(s.transpose())}var uye=class extends lN{constructor(){super(),this.layers.enable(3),this.layers.enable(8)}setFromCamera(e,t){t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):t.isPerspectiveCamera?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):console.error("Raycaster: Unsupported camera type.")}intersectVisibleObjects(e,t=!0,i=[]){return e.forEach(n=>{n.visible&&this.intersectObject(n,t,i)}),i}createRaycastLineHelper(){let e=new Uc({color:65280,linewidth:10}),t=new T(this.ray.origin.x,this.ray.origin.y,this.ray.origin.z),i=new T(this.ray.direction.x,this.ray.direction.y,this.ray.direction.z),n=this.camera.far-this.camera.near,r=new T().addVectors(t,i.multiplyScalar(n)),s=new mt;return s.setFromPoints([t,r]),new Ny(s,e)}},Iz=e=>e instanceof F0||e instanceof ap;function dye(e,t){return e.distance-t.distance}function Oz(e,t,i){if(!(!Go(t)||!t.visible)){na(t)&&t.raycast(e,i);for(let n of t.children)Oz(e,n,i)}}function zM(e,t,i){if(!i.some(r=>wx(e,r)!==void 0))return[];let n=[];return t.children.forEach(r=>Oz(e,r,n)),n.sort(dye),n}function kM(e){let t=[];if(e.length){let i=e[0].object;Go(i)&&t.push(i);let n=i.parent;for(;n;)Iz(n)&&t.push(n),n=n.parent}return t}function wx(e,t){if(na(t)){if(t.visible){let i=[];return t.raycast(e,i),i.length?i[0]:void 0}}else if(Iz(t))return Bz(e,t)}function Bz(e,t){if(!(!Go(t)||!t.visible)){if(na(t)){let i=[];if(t.raycast(e,i),i.length)return i[0]}for(let i of t.children){let n=Bz(e,i);if(n)return n}}}function pye(e,t,i){return{x:(e-(i.left+window.scrollX))/i.width*2-1,y:-((t-(i.top+window.scrollY))/i.height)*2+1}}var fye=class{constructor(e,t,i,n,r,s,a,o){this.renderer=e,this.publish=t,this.scene=i,this.getCamera=n,this.sharedAssets=r,this.requestRender=s,this.isExport=a,this.frame=o,this.raycaster=new uye,this.raycasterNeedsUpdate=!0,this._useWindowEvents=!1,this._useWindowEvents=t.mouseEventTarget==="window",this.domElement=e.domElement,this.eventElement=this._useWindowEvents?window:e.domElement}get stopRaycast(){return this.publish.stopRaycast}get page(){return this.scene.activePage}set useWindowEvents(e){this._useWindowEvents=e,this.eventElement=e?window:this.renderer.domElement}get useWindowEvents(){return this._useWindowEvents}updateRaycaster(e){var r;if(!this.raycasterNeedsUpdate)return;this.raycasterNeedsUpdate=!1;let{pageX:t,pageY:i}=((r=e.touches)==null?void 0:r.length)>0?e.touches[0]:e,n=this.domElement.getBoundingClientRect();this.raycaster.setFromCamera(pye(t,i,n),this.getCamera())}},Nz=(e=>(e[e.keydown=0]="keydown",e[e.keyup=1]="keyup",e[e.pointerdown=2]="pointerdown",e[e.pointerup=3]="pointerup",e[e.pointermove=4]="pointermove",e[e.wheel=5]="wheel",e[e.scroll=6]="scroll",e))(Nz||{}),po=class{constructor(e){this.eventContext=e,this.domEventsNeeded=new Set,this.hasVideoAction=!1}connect(){}disconnect(){}},KA=[["start","Start"],["keyDown","KeyDown"],["keyUp","KeyUp"],["mouseDown","MouseDown"],["mouseUp","MouseUp"],["mouseHover","MouseHover"],["collision","Collision"],["lookAt","LookAt"],["follow","Follow"],["scroll","Scroll"]],Uz=e=>{var t;return(t=KA.find(([i,n])=>n===e))==null?void 0:t[0]},dg=e=>{var t;return(t=KA.find(([i])=>i===e))==null?void 0:t[1]},mye=(e,t)=>{let i=Uz(e);if(i){let n=new CustomEvent(i,{bubbles:!0});return Object.defineProperty(n,"target",{writable:!1,value:t}),n}},gye=class extends po{constructor(e){super(e),this.objectsPerEvents=new Map,this.splineEvents={},this.onBeginEvent=i=>{var s;if(!i.eventName||!i.target||i.eventName==="Scroll")return;let n=(s=this.splineEvents[Uz(i.eventName)])==null?void 0:s[i.target.uuid];if(!n)return;i.eventName==="Scroll"&&i.deltaY!==void 0&&Object.assign(n,{deltaY:i.deltaY});let{domElement:r}=this.eventContext;r.dispatchEvent(n)};let{page:t}=this.eventContext;t.traverseEntity(i=>{var n,r;if((n=i.data)!=null&&n.events.length){for(let[s,a]of KA)if(i.data.events.some(o=>o.data.type===a&&!o.data.disabled)){this.objectsPerEvents.has(s)?(r=this.objectsPerEvents.get(s))==null||r.push(i):this.objectsPerEvents.set(s,[i]);let o={id:i.uuid,name:i.name},l=mye(a,o),c=this.splineEvents[s];c?c[i.uuid]=l:this.splineEvents[s]={[i.uuid]:l}}}})}connect(){this.objectsPerEvents.forEach(e=>{e.forEach(t=>{t.addEventListener("beginEvent",this.onBeginEvent)})})}disconnect(){this.objectsPerEvents.forEach(e=>{e.forEach(t=>{t.removeEventListener("beginEvent",this.onBeginEvent)})})}},vye=class{constructor(e,t,i,n,r,s){if(this.id=e,this.data=t,this.object=i,this.entered=!1,this.alreadyPlayedNonTogglingActions=new Set,this.useToggle=t.toggle,(t.type==="KeyDown"||t.type==="KeyUp"||t.type==="KeyPress")&&!t.key)throw new Error("Missing property");this.actions=cs(t,t.actions,n,r,s,i)}disconnect(){kr(this.actions)}dispatchHeld(e){this.actions.Create.forEach(t=>{e&&t.dispatchThrottled.cancel(),t.dispatchThrottled()})}dispatch(e=!1){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this?(t.object.currentTransitionEvent=this,t.init()):this.useToggle===!1&&this.alreadyPlayedNonTogglingActions.add(t)}),this.useToggle?(this.actions.Transition.forEach(t=>{t.toggle()}),this.actions.Animation.forEach(t=>{t.toggle()}),this.actions.SwitchCamera.forEach(t=>{t.toggle()})):this.data.type==="MousePress"||this.data.type==="KeyPress"?this.entered||(this.entered=!0,this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent()),this.actions.Create.forEach(t=>t.dispatchStart())):(this.actions.Transition.some(t=>t.playing)||this.actions.Transition.forEach(t=>{this.alreadyPlayedNonTogglingActions.has(t)===!1&&t.play()}),this.actions.SwitchCamera.some(t=>t.playing)||this.actions.SwitchCamera.forEach(t=>{t.play()}),this.actions.Animation.forEach(t=>{t.play()})),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}),e===!1&&this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()})}dispatchRelease(){this.entered&&(this.entered=!1,this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.Animation.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent()),this.actions.Create.forEach(e=>e.dispatchStop()))}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.SceneTransition.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()})}},yye=class extends po{constructor(e,t){super(e),this.objectsPerTypes={MouseDown:[],MouseUp:[],MousePress:[],KeyDown:[],KeyUp:[],KeyPress:[]},this.canvasMouseEvents=[],this.windowMouseEvents=[],this.eventsPerObjects={MouseDown:{},MouseUp:{},MousePress:{},KeyDown:{},KeyUp:{},KeyPress:{}},this.heldKeys={},this.heldKeysPress={},this._prevObjects=[],this.onWindowMouseDown=r=>{(r.target===this.eventContext.domElement||r.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(s=>{(s.data.type==="MouseDown"||s.data.type==="MousePress")&&s.dispatch()}),this.windowMouseEvents.forEach(s=>{(s.data.type==="MouseDown"||s.data.type==="MousePress")&&s.dispatch()})},this.onWindowMouseUp=r=>{(r.target===this.eventContext.domElement||r.target.tagName==="SPLINE-VIEWER")&&this.canvasMouseEvents.forEach(s=>{s.data.type==="MouseUp"?s.dispatch():s.data.type==="MousePress"&&s.dispatchRelease()}),this.windowMouseEvents.forEach(s=>{s.data.type==="MouseUp"?s.dispatch():s.data.type==="MousePress"&&s.dispatchRelease()})},this.onMouseDown=r=>{dt.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseEvent("MouseDown"))},this.onMouseUp=r=>{dt.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseEvent("MouseUp"))},this.onMousePressDown=r=>{dt.length>1||(this.eventContext.updateRaycaster(r),this.handleMousePressEvent())},this.onMousePressRelease=r=>{dt.length>1||(this.eventContext.updateRaycaster(r),this.handleMousePressEvent(!0))},this.onKeyDown=r=>{this.heldKeys[r.key]||(this.handleKeyEvent(r,"KeyDown"),this.handleKeyEventHeld(r,"KeyDown",!0)),this.heldKeys[r.key]=!0},this.onKeyUp=r=>{this.handleKeyEvent(r,"KeyUp"),this.handleKeyEventHeld(r,"KeyUp",!0)},this.onKeyPressDown=r=>{this.heldKeysPress[r.key]?this.handleKeyEventHeld(r,"KeyPress"):(this.handleKeyEvent(r,"KeyPress"),this.handleKeyEventHeld(r,"KeyPress",!0)),this.heldKeysPress[r.key]=!0},this.onKeyPressUp=r=>{this.handleKeyEvent(r,"KeyPress",!0)},this.releaseHeldKey=r=>{delete this.heldKeys[r.key]},this.releaseHeldKeyPress=r=>{delete this.heldKeysPress[r.key]},this._onUserEvent=({eventName:r,target:s,reverse:a})=>{var l,c,u,h;if(!r||!s)return;let o=dg(r);o&&(o==="MouseDown"||o==="MouseUp"||o==="MousePress"?(s.dispatchEvent({type:"beginEvent",eventName:o}),(c=(l=this.eventsPerObjects[o])==null?void 0:l[s.uuid])==null||c.forEach(d=>{d.dispatchUserEvent(a)})):(o==="KeyDown"||o==="KeyUp"||o==="KeyPress")&&(s.dispatchEvent({type:"beginEvent",eventName:o}),(h=(u=this.eventsPerObjects[o])==null?void 0:u[s.uuid])==null||h.forEach(d=>{d.dispatchUserEvent()})))};let{page:i,sharedAssets:n}=this.eventContext;i.traverseEntity(r=>{var a,o;if(!((a=r.data)!=null&&a.events.length))return;let s=["MouseDown","MouseUp","MousePress","KeyDown","KeyUp","KeyPress"];for(let l of s){let c=this.eventsPerObjects[l];r.data.events.filter(({data:u})=>u.type===l&&u.disabled!==!0).forEach(({id:u,data:h})=>{try{let d=new vye(u,h,r,i,n,t);d.actions.Video.length&&(this.hasVideoAction=!0),(h.type==="MouseDown"||h.type==="MouseUp"||h.type==="MousePress")&&(h.mode==="Canvas"||h.mode==="Window")?h.mode==="Canvas"&&this.canvasMouseEvents.push(d):c[r.uuid]?c[r.uuid].push(d):c[r.uuid]=[d]}catch{}}),(o=c[r.uuid])!=null&&o.length&&this.objectsPerTypes[l].push(r)}})}connect(){var t,i,n,r,s,a;let{domElement:e}=this.eventContext;this.heldKeys={},this.heldKeysPress={},this.domEventsNeeded.clear(),typeof window<"u"&&(window.addEventListener("pointerdown",this.onWindowMouseDown,{capture:!0}),window.addEventListener("pointerup",this.onWindowMouseUp,{capture:!0})),(t=this.objectsPerTypes.MouseDown)!=null&&t.length&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMouseDown)),(i=this.objectsPerTypes.MouseUp)!=null&&i.length&&(this.domEventsNeeded.add("pointerup"),e.addEventListener("pointerup",this.onMouseUp)),(n=this.objectsPerTypes.MousePress)!=null&&n.length&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMousePressDown),this.domEventsNeeded.add("pointerup"),e.addEventListener("pointerup",this.onMousePressRelease)),(r=this.objectsPerTypes.KeyDown)!=null&&r.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyDown),document.addEventListener("keyup",this.releaseHeldKey)),(s=this.objectsPerTypes.KeyUp)!=null&&s.length&&(this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyUp)),(a=this.objectsPerTypes.KeyPress)!=null&&a.length&&(this.domEventsNeeded.add("keydown"),document.addEventListener("keydown",this.onKeyPressDown),document.addEventListener("keyup",this.releaseHeldKeyPress),this.domEventsNeeded.add("keyup"),document.addEventListener("keyup",this.onKeyPressUp)),Object.entries(this.objectsPerTypes).forEach(([o,l])=>{l.forEach(c=>{c.addEventListener("userEvent",this._onUserEvent)})})}disconnect(){let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),this.heldKeys={},this.heldKeysPress={},typeof window<"u"&&(window.removeEventListener("pointerdown",this.onWindowMouseDown,{capture:!0}),window.removeEventListener("pointerup",this.onWindowMouseUp,{capture:!0})),e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerdown",this.onMousePressDown),e.removeEventListener("pointerup",this.onMouseUp),e.removeEventListener("pointerup",this.onMousePressRelease),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("keydown",this.onKeyPressDown),document.removeEventListener("keyup",this.onKeyPressUp),document.removeEventListener("keyup",this.releaseHeldKey),Object.values(this.eventsPerObjects).forEach(t=>{Object.values(t).forEach(i=>{i.forEach(n=>{n.disconnect()})})}),this.canvasMouseEvents.forEach(t=>{t.disconnect()}),Object.entries(this.objectsPerTypes).forEach(([t,i])=>{i.forEach(n=>{n.removeEventListener("userEvent",this._onUserEvent)})})}handleMouseEvent(e){let{stopRaycast:t,raycaster:i,page:n}=this.eventContext,r=this.objectsPerTypes[e];if(r.length)if(t){let s=zM(i,n,r);kM(s).forEach(a=>{this.eventsPerObjects[e][a.uuid]&&this.handleObjectMouseEventDispatch(a,e)})}else r.forEach(s=>{wx(i,s)&&this.handleObjectMouseEventDispatch(s,e)})}handleMousePressEvent(e=!1){let t="MousePress",i=this.objectsPerTypes[t],n=[];if(i.length){if(!e){let{stopRaycast:r,raycaster:s,page:a}=this.eventContext;if(r){let o=zM(s,a,i);n=kM(o)}else i.forEach(o=>{wx(s,o)&&n.push(o)})}this._prevObjects.length&&this._prevObjects.forEach(r=>{n.includes(r)||this.handleObjectMouseEventDispatchRelease(r,t)}),n.length&&n.forEach(r=>{this.handleObjectMouseEventDispatch(r,t)}),this._prevObjects=n}}handleObjectMouseEventDispatch(e,t){var i,n;e.dispatchEvent({type:"beginEvent",eventName:t}),(n=(i=this.eventsPerObjects[t])==null?void 0:i[e.uuid])==null||n.forEach(r=>{r.dispatch()})}handleObjectMouseEventDispatchRelease(e,t){var i,n;e.dispatchEvent({type:"beginEvent",eventName:t}),(n=(i=this.eventsPerObjects[t])==null?void 0:i[e.uuid])==null||n.forEach(r=>{r.dispatchRelease()})}handleKeyEvent(e,t,i=!1){this.objectsPerTypes[t].forEach(n=>{let r=this.eventsPerObjects[t][n.uuid];r.some(({data:s})=>"key"in s&&s.key===e.key)&&n.dispatchEvent({type:"beginEvent",eventName:t}),r.forEach(s=>{"key"in s.data&&s.data.key===e.key&&(i?s.dispatchRelease():s.dispatch(!0))})})}handleKeyEventHeld(e,t,i=!1){this.objectsPerTypes[t].forEach(n=>{this.eventsPerObjects[t][n.uuid].forEach(r=>{"key"in r.data&&r.data.key===e.key&&r.dispatchHeld(i)})})}},xye=new T,_ye=new T,Fz=class{constructor(e,t,i,n,r){this.actionsIn=cs(e,e.inActions,i,n,r,t),this.actionsOut=cs(e,e.outActions,i,n,r,t)}disconnect(){kr(this.actionsIn),kr(this.actionsOut)}},bye=class extends Fz{constructor(e,t,i,n,r,s){super(t,i,n,r,s),this.id=e,this.data=t,this.object=i,this.stage="out",this.objects=[],this.onUpdateMatrix=()=>{for(let d of this.objects)if(!d.visible)return;let c=xye.setFromMatrixPosition(this.objects[0].matrixWorld),u=_ye.setFromMatrixPosition(this.objects[1].matrixWorld),h=c.distanceTo(u)<=this.distance?"in":"out";if(this.stage!==h){this.stage=h;let d=h==="in"?this.actionsIn:this.actionsOut;d.Audio.forEach(p=>p.dispatchConditional()),d.Video.forEach(p=>p.dispatchConditional()),d.Link.forEach(p=>p.dispatch()),d.Create.forEach(p=>p.dispatch()),d.Destroy.forEach(p=>p.dispatch()),d.Reset.forEach(p=>p.dispatch()),d.Transition.forEach(p=>{p.object.currentTransitionEvent!==this&&(p.object.currentTransitionEvent=this),p.init()}),d.Transition.forEach(p=>p.play()),d.Animation.forEach(p=>p.play()),d.SwitchCamera.forEach(p=>p.play()),d.SceneTransition.forEach(p=>p.dispatch())}};let{distance:a,fromObject:o,toObject:l}=t.condition;this.distance=a;for(let c of[o,l]){if(!c)throw new Error("Missing property");let u=n.find(c);if(!u)throw new Error("Missing property");this.objects.push(u)}}connect(){window.setTimeout(()=>{this.objects.forEach(e=>{e.addEventListener("updateMatrix",this.onUpdateMatrix)}),this.onUpdateMatrix()},0)}disconnect(){super.disconnect(),this.stage="out",this.objects.forEach(e=>{e.removeEventListener("updateMatrix",this.onUpdateMatrix)})}},wye=class extends Fz{constructor(e,t,i,n,r,s){var l;super(t,i,n,r,s),this.id=e,this.data=t,this.object=i,this.onBegin=({target:c,state:u})=>{this.toState!==u&&(this.actionsOut.Audio.forEach(h=>h.dispatchConditional()),this.actionsOut.Video.forEach(h=>h.dispatchConditional()),this.actionsOut.Link.forEach(h=>h.dispatch()),this.actionsOut.Create.forEach(h=>h.dispatch()),this.actionsOut.Destroy.forEach(h=>h.dispatch()),this.actionsOut.Reset.forEach(h=>h.dispatch()),this.actionsIn.Transition.forEach(h=>h.pause()),this.object.currentTransitionEvent=this,this.actionsOut.Transition.forEach(h=>h.play()),this.actionsOut.Animation.forEach(h=>h.play()),this.actionsIn.SwitchCamera.forEach(h=>h.pause()),this.actionsOut.SwitchCamera.forEach(h=>h.play()),this.actionsOut.SceneTransition.forEach(h=>h.dispatch()))},this.onComplete=({target:c,state:u})=>{this.toState===u&&(this.actionsIn.Audio.forEach(h=>h.dispatchConditional()),this.actionsIn.Video.forEach(h=>h.dispatchConditional()),this.actionsIn.Link.forEach(h=>h.dispatch()),this.actionsIn.Create.forEach(h=>h.dispatch()),this.actionsIn.Destroy.forEach(h=>h.dispatch()),this.actionsIn.Reset.forEach(h=>h.dispatch()),this.actionsOut.Transition.forEach(h=>h.pause()),this.actionsOut.Transition.forEach(h=>h.pause()),this.object.currentTransitionEvent=this,this.actionsIn.Transition.forEach(h=>h.play()),this.actionsIn.Animation.forEach(h=>h.play()),this.actionsOut.SwitchCamera.forEach(h=>h.pause()),this.actionsIn.SwitchCamera.forEach(h=>h.play()),this.actionsIn.SceneTransition.forEach(h=>h.dispatch()))};let{condition:a}=t;if(!a.object)throw new Error("Missing property");let o=n.find(a.object);if(!o)throw new Error("Missing property");if(this.toObject=o,a.state&&!((l=this.toObject.states)!=null&&l[a.state]))throw new Error("Missing property");this.toState=a.state}connect(){(this.actionsOut.Audio.length||this.actionsOut.Video.length||this.actionsOut.Create.length||this.actionsOut.Destroy.length||this.actionsOut.Transition.length||this.actionsOut.Animation.length||this.actionsOut.SwitchCamera.length||this.actionsOut.SceneTransition.length)&&this.toObject.addEventListener("beginState",this.onBegin),(this.actionsIn.Audio.length||this.actionsIn.Video.length||this.actionsOut.Create.length||this.actionsIn.Destroy.length||this.actionsIn.Transition.length||this.actionsIn.Animation.length||this.actionsIn.SwitchCamera.length||this.actionsIn.SceneTransition.length)&&this.toObject.addEventListener("completeState",this.onComplete)}disconnect(){super.disconnect(),(this.actionsOut.Audio.length||this.actionsOut.Video.length||this.actionsOut.Create.length||this.actionsOut.Destroy.length||this.actionsOut.Transition.length||this.actionsOut.Animation.length||this.actionsOut.SwitchCamera.length||this.actionsOut.SceneTransition.length)&&this.toObject.removeEventListener("beginState",this.onBegin),(this.actionsIn.Audio.length||this.actionsIn.Video.length||this.actionsOut.Create.length||this.actionsIn.Destroy.length||this.actionsIn.Transition.length||this.actionsIn.Animation.length||this.actionsIn.SwitchCamera.length||this.actionsIn.SceneTransition.length)&&this.toObject.removeEventListener("completeState",this.onComplete)}},Sye=class extends po{constructor(e,t){super(e),this.eventsPerConditions={Comparison:[],Distance:[],State:[]},this.hasVideoAction=!1;let{page:i,sharedAssets:n}=this.eventContext;i.traverseEntity(r=>{var s;if((s=r.data)!=null&&s.events.length){for(let{id:a,data:o}of r.data.events)if(!o.disabled&&o.type==="Conditional")try{let l;o.condition.type==="Comparison"||(o.condition.type==="Distance"?l=new bye(a,o,r,i,n,t):o.condition.type==="State"&&(l=new wye(a,o,r,i,n,t))),l&&(this.eventsPerConditions[o.condition.type].push(l),(l.actionsIn.Video.length||l.actionsOut.Video.length)&&(this.hasVideoAction=!0))}catch{}}})}connect(){super.connect(),Object.values(this.eventsPerConditions).forEach(e=>e.forEach(t=>t.connect()))}disconnect(){super.disconnect(),Object.values(this.eventsPerConditions).forEach(e=>e.forEach(t=>t.disconnect()))}},Yf=new T,Tl=new T,Yc=new T,ND=new Qr,Mye=.01,jt=new T,nn=new T,UD=new T,Mh=new At,nw=new bn,Cye=new ke,rw=new Sn,Bu=new T,Ia=new T,Nu=.2;function sw(e,t){!t||(t[0]<t[1]&&(e.x=Math.min(Math.max(e.x,t[0]),t[1])),t[2]<t[3]&&(e.y=Math.min(Math.max(e.y,t[2]),t[3])),t[4]<t[5]&&(e.z=Math.min(Math.max(e.z,t[4]),t[5])))}var Eye=function(){let e=new ke;return(t,i,n)=>{let r=t.obj;e.copy(r.hiddenMatrix),r.parent!==null&&e.premultiply(r.parent.matrixWorld),e.invert(),r.position.copy(i),t.reference==="global"&&sw(r.position,t.limits),r.position.applyMatrix4(e),t.reference==="parent"?sw(r.position,t.limits):t.reference==="local"&&(Mh.copy(t.quat0).invert(),r.position.sub(t.position0),r.position.applyQuaternion(Mh),sw(r.position,t.limits),Mh.invert(),r.position.applyQuaternion(Mh),r.position.add(t.position0)),e.multiply(n??r.matrixWorld).decompose(jt,r.quaternion,nn),r.updateMatrix(),r.hasNonUniformScale&&(r.updateMatrixWorld(),r.updateMatrixWorldSVD()),r instanceof zr&&qa(r.parent)&&r.invalidateDownstreamBooleanData(!0)}}(),Aye=class{constructor(e,t,i,n,r,s){this.object=e,this.data=t,this.dropDestIds=[],this.activeIdx=null,this.wasDragEventTriggered=!1,this.resetDampingFactor=this.data.resetSpeed===0?1:8/this.data.resetSpeed+1,this.snapDampingFactor=this.data.snapSpeed===0?1:8/this.data.snapSpeed+1,this.actionsDrag=cs(t,t.dragDropActions.drag,i,n,r,this.object),this.actionsDrop=cs(t,t.dragDropActions.drop,i,n,r,this.object);let a=[];this.data.objects.forEach(o=>{let l=i.find(o);!l||l.data.visible!==!1&&(a.push(l),s[l.uuid]&&s[l.uuid].forEach(c=>{let u=i.find(c);!u||u.data.visible!==!1&&a.push(u)}))}),this.data.dropDestinations.forEach(o=>{let l=i.find(o);!l||l.data.visible!==!1&&(this.dropDestIds.push(l.uuid),s[l.uuid]&&s[l.uuid].forEach(c=>{let u=i.find(c);!u||u.data.visible!==!1&&this.dropDestIds.push(u.uuid)}))}),this.dragItems=a.map(o=>(this.data.planeMode==="locked"&&(o.userData.lockedPlane=!0),o.userData.worldPosition0=new T().setFromMatrixPosition(o.matrixWorld),{obj:o,fromPosition:new T().setFromMatrixPosition(o.matrixWorld),pointStart:new T,pointEnd:new T,paused:!0,currentDampingFactor:this.data.dampingFactor,reset:!1,position0:new T().copy(o.position),quat0:new At().copy(o.quaternion),snapped:!1,orientationMatrix:new ke,limits:this.data.limits,reference:this.data.referenceFrame}))}get activeDragItem(){return this.activeIdx!==null?this.dragItems[this.activeIdx]:null}dispose(){kr(this.actionsDrag),kr(this.actionsDrop),this.dragItems.forEach(e=>{e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart),e.obj.recursiveBBoxNeedsUpdate=!0,e.obj.userData.lockedPlane=void 0,e.obj.position.copy(e.position0),e.obj.quaternion.copy(e.quat0),e.obj.updateMatrix()})}},Tye=class extends po{constructor(e,t){super(e),this.eventManager=t,this.events=[],this.lastDropDestination=null,this.dragTimeout=null,this.onPointerDown=n=>{var o;if(dt.length>1)return;this.eventContext.updateRaycaster(n);let{raycaster:r,page:s}=this.eventContext,a=s.raycastWithClones(r);if(this.lastDropDestination=null,a.length===0){this.activeEvent=null;return}for(let l of this.events){let c=0;for(let{obj:u,pointEnd:h,pointStart:d}of l.dragItems){if(u===a[0].object||u===a[0].object.object||Vt.is(u)&&u.isAncestorOf(a[0].object.uuid)){if(l.activeIdx=c,l.activeDragItem.reset=!1,l.activeDragItem.currentDampingFactor=l.data.dampingFactor,l.activeDragItem.snapped=!1,l.data.cursor==="hand"&&this.setCursor("grabbing"),this.eventManager.controlsManager.usePhysics){l.activeDragItem.obj.rigidBody&&l.activeDragItem.obj.rigidBody.setBodyType(2,!0);let p=l.activeDragItem.obj;u.hasNonUniformScale&&u.updateMatrixWorldSVD(),(p.hasNonUniformScale?p.matrixWorldRigid:p.matrixWorld).decompose(jt,Mh,nn),nw.setFromQuaternion(Mh),p.prevR===void 0?(p.prevR=nw.clone(),p.prevT=jt.clone()):(p.prevR.copy(nw),p.prevT.copy(jt)),this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.push(l.activeDragItem.obj)}this.calcPlaneIntersectPos(u,d,l.data.plane,l.data.referenceFrame),h.copy(d),(this.eventManager.controlsManager.usePhysics&&((o=u.data.physics)==null?void 0:o.rigidBody)==="dynamic"||l.data.drop===!1||l.data.resetOnSnapFail===!1)&&l.activeDragItem.fromPosition.setFromMatrixPosition(l.activeDragItem.obj.matrixWorld),this.activeEvent=l,this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!1);return}c++}}this.activeEvent=null},this.onPointerMove=n=>{var o,l,c,u;if(dt.length>1)return;this.eventContext.updateRaycaster(n);let{raycaster:r,page:s}=this.eventContext,a=s.raycastWithClones(r);if(dt.length===0){let h=!1;for(let d of this.events){for(let{obj:p}of d.dragItems)if(p===((o=a[0])==null?void 0:o.object)||p===((c=(l=a[0])==null?void 0:l.object)==null?void 0:c.object)||Vt.is(p)&&p.isAncestorOf((u=a[0])==null?void 0:u.object.uuid)){switch(h=!0,d.data.cursor){case"hand":this.setCursor("grab");break;case"move":this.setCursor("move");break}break}if(h)break}h||this.setCursor("default");return}if(this.activeEvent&&this.activeEvent.activeDragItem){let h=this.activeEvent.activeDragItem;h.snapped=!1;let d;if(this.activeEvent.data.drop&&(d=a.filter(p=>h.obj!==p.object&&!h.obj.isAncestorOf(p.object.uuid)&&!(p.object instanceof F0)&&(this.activeEvent.data.dropOn==="all"||this.activeEvent.dropDestIds.some(f=>f===p.object.uuid||s.scene.find(f).isAncestorOf(p.object.uuid))))[0]),d){let p=UD.copy(d.face.normal).applyMatrix3(rw.getNormalMatrix(d.object.matrixWorld));if(this.activeEvent.data.snapTo==="center")h.fromPosition.setFromMatrixPosition(d.object.matrixWorld);else if(this.activeEvent.data.snapTo==="surface"){if(h.fromPosition.copy(d.point),this.activeEvent.data.snapSurfaceMode==="bbox"){jt.copy(p).applyMatrix3(rw.setFromMatrix4(h.obj.matrixWorld).transpose());let f=h.obj;jt.x>Nu?nn.x=-f.recursiveBBox.min.x:jt.x<-Nu&&(nn.x=-f.recursiveBBox.max.x),jt.y>Nu?nn.y=-f.recursiveBBox.min.y:jt.y<-Nu&&(nn.y=-f.recursiveBBox.max.y),jt.z>Nu?nn.z=-f.recursiveBBox.min.z:jt.z<-Nu&&(nn.z=-f.recursiveBBox.max.z),nn.applyMatrix3(rw.invert())}else nn.copy(p).multiplyScalar(this.activeEvent.data.snapSurfaceOffset);h.fromPosition.add(nn)}this.activeEvent.data.autoOrient&&(jt.set(0,1,0).cross(p),jt.length()<1e-4&&jt.set(-1,0,0).cross(p),nn.crossVectors(UD,jt),h.orientationMatrix.makeBasis(jt,nn,p)),h.pointStart.copy(h.fromPosition),h.pointEnd.copy(h.pointStart),h.currentDampingFactor=this.activeEvent.snapDampingFactor,h.snapped=!0,this.lastDropDestination!==d.object&&(this.lastDropDestination=d.object,this.activeEvent.actionsDrop.Transition.forEach(f=>{f.play()}),this.activeEvent.actionsDrop.Animation.forEach(f=>{f.play()}),this.activeEvent.actionsDrop.Audio.forEach(f=>{f.dispatchGameControl("start")}),this.activeEvent.actionsDrop.Create.forEach(f=>{f.dispatchThrottled()}))}else h.orientationMatrix.makeRotationFromQuaternion(h.quat0),this.lastDropDestination=null,h.currentDampingFactor=this.activeEvent.data.dampingFactor,this.calcPlaneIntersectPos(h.obj,h.pointEnd,this.activeEvent.data.plane,this.activeEvent.data.referenceFrame),this.activeEvent.actionsDrop.Transition.forEach(p=>{p.stop(),p.object.currentState!==null&&p.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrop.Animation.forEach(p=>{p.stop()}),this.activeEvent.actionsDrop.Audio.forEach(p=>{p.dispatchGameControl("stop")});this.activeEvent.actionsDrag.Create.forEach(p=>{p.dispatchThrottled()}),this.activeEvent.wasDragEventTriggered===!1&&(this.activeEvent.wasDragEventTriggered=!0,this.activeEvent.actionsDrag.Transition.forEach(p=>{p.play()}),this.activeEvent.actionsDrag.Animation.forEach(p=>{p.play()}),this.activeEvent.actionsDrag.Audio.forEach(p=>{p.dispatchGameControl("start")})),this.dragTimeout&&window.clearTimeout(this.dragTimeout),this.dragTimeout=window.setTimeout(()=>{!this.activeEvent||(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Audio.forEach(p=>{p.dispatchGameControl("stop")}),this.activeEvent.actionsDrag.Transition.forEach(p=>{p.stop(),p.object.currentState!==null&&p.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(p=>{p.stop()}))},500),this.updateDragItem(h),h.obj.dispatchEvent({type:"requestRender"})}},this.onPointerUp=n=>{var r;if(this.activeEvent&&this.activeEvent.activeDragItem){this.activeEvent.data.cursor==="hand"&&this.setCursor("grab");let s=((r=this.activeEvent.activeDragItem.obj.data.physics)==null?void 0:r.rigidBody)==="dynamic";this.activeEvent.activeDragItem.snapped===!1&&this.activeEvent.data.drop&&this.activeEvent.data.resetOnSnapFail&&(this.eventManager.controlsManager.usePhysics===!1||!s)&&(this.activeEvent.activeDragItem.reset=this.activeEvent.data.resetOnSnapFail,this.activeEvent.activeDragItem.paused=!1,this.activeEvent.activeDragItem.currentDampingFactor=this.activeEvent.resetDampingFactor),this.eventManager.controlsManager.usePhysics&&s&&(this.eventManager.controlsManager.sharedGameControlGlobals.entitiesWithTransformAnim.pop(),this.activeEvent.activeDragItem.obj.rigidBody.setBodyType(0,!0),this.activeEvent.activeDragItem.paused=!0),this.activeEvent.wasDragEventTriggered===!0&&(this.activeEvent.wasDragEventTriggered=!1,this.activeEvent.actionsDrag.Transition.forEach(a=>{a.stop(),a.object.currentState!==null&&a.object.changeSelectedState(null,{scene:this.eventContext.page.scene,shared:this.eventContext.sharedAssets})}),this.activeEvent.actionsDrag.Animation.forEach(a=>{a.stop()}),this.activeEvent.actionsDrag.Audio.forEach(a=>{a.dispatchGameControl("stop")})),this.eventManager.controlsManager.orbitControls&&(this.eventManager.controlsManager.orbitControls.enabled=!0)}};let i={};e.page.traverseEntity(n=>{n.component&&(i[n.component.uuid]?i[n.component.uuid].push(n.uuid):i[n.component.uuid]=[n.uuid])}),e.page.traverseEntity(n=>{var r;(r=n.data)==null||r.events.filter(s=>s.data.type==="DragDrop"&&!s.data.disabled).forEach(s=>{this.events.push(new Aye(n,s.data,e.page,e.sharedAssets,t,i))})})}connect(){if(!this.events.length)return;this.domEventsNeeded.clear(),this.domEventsNeeded.add("pointerdown");let e=this.eventContext.domElement;e.addEventListener("pointerdown",this.onPointerDown),e.addEventListener("pointermove",this.onPointerMove),e.addEventListener("pointerup",this.onPointerUp),this.domEventsNeeded.add("pointermove")}disconnect(){if(!this.events.length)return;this.domEventsNeeded.clear();let e=this.eventContext.domElement;e.removeEventListener("pointerdown",this.onPointerDown),e.removeEventListener("pointermove",this.onPointerMove),e.removeEventListener("pointerup",this.onPointerUp),this.events.forEach(t=>t.dispose())}setCursor(e){this.eventContext.domElement.style.cursor=e}onAnimationFrameDamping(){for(let e of this.events)for(let t of e.dragItems)t.paused||this.updateDragItem(t,!0)}calcPlaneIntersectPos(e,t,i,n){let{getCamera:r,raycaster:s}=this.eventContext;r().getWorldDirection(Tl),Tl.negate();let a=Mh.identity();switch(n==="parent"?Cye.multiplyMatrices(e.parent.matrixWorld,e.hiddenMatrix).decompose(jt,a,nn):n==="local"&&e.matrixWorld.decompose(jt,a,nn),i){case"x":jt.set(1,0,0).applyQuaternion(a),Bu.copy(Tl).cross(jt),Ia.copy(jt).cross(Bu);break;case"y":jt.set(0,1,0).applyQuaternion(a),Bu.copy(Tl).cross(jt),Ia.copy(jt).cross(Bu);break;case"z":jt.set(0,0,1).applyQuaternion(a),Bu.copy(Tl).cross(jt),Ia.copy(jt).cross(Bu);break;case"xy":Ia.set(0,0,1).applyQuaternion(a);break;case"yz":Ia.set(1,0,0).applyQuaternion(a);break;case"xz":Ia.set(0,1,0).applyQuaternion(a);break;case"adaptive":Tl.angleTo(nn.set(0,1,0))>Math.PI/6?(jt.crossVectors(nn.set(0,1,0),Tl),Ia.crossVectors(jt,nn)):Ia.set(0,1,0);break;default:Ia.copy(Tl);break}Yc.setFromMatrixPosition(e.matrixWorld);let o=e.userData.lockedPlane?e.userData.worldPosition0:Yc;if(ND.setFromNormalAndCoplanarPoint(Ia,o),!!s.ray.intersectPlane(ND,t)&&(i==="x"||i==="y"||i==="z")){let l=nn.subVectors(t,o).dot(jt);t.copy(o).addScaledVector(jt,l)}}updateDragItem(e,t=!1){var i,n;Yc.setFromMatrixPosition(e.obj.matrixWorld),e.reset==="current"?Yf.subVectors(e.fromPosition,Yc).divideScalar(e.currentDampingFactor):e.reset==="original"?(Yf.subVectors(e.obj.userData.worldPosition0,Yc).divideScalar(e.currentDampingFactor),e.fromPosition.copy(e.obj.userData.worldPosition0),e.pointStart.copy(e.fromPosition),e.pointEnd.copy(e.pointStart)):Yf.subVectors(e.pointEnd,e.pointStart).add(e.fromPosition).sub(Yc).divideScalar(e.currentDampingFactor),e.paused=e.currentDampingFactor>1?Yf.length()<Mye:!0,(this.activeEvent&&this.activeEvent.data.dampingFactor===1||t)&&Eye(e,Yf.add(Yc),(i=this.activeEvent)!=null&&i.data.drop&&((n=this.activeEvent)!=null&&n.data.autoOrient)?e.orientationMatrix:null),e.obj.dispatchEvent({type:"beginEvent",eventName:"DragDrop"}),this.eventManager.requestRender()}},Uu=new T,aw=new T,So=new T,Mo=new T,FD=new Qr,Pye=.01,Dye={type:"requestRender"},Lye=function(){let e=new T,t=new T;return(i,n,r)=>r>0?(e.subVectors(i,n),e.length()<=r?i:t.copy(n).add(e.normalize().multiplyScalar(r))):n}(),zD=function(){let e=new ke;return(t,i)=>{t.position.copy(i),t.parent!==null&&(e.copy(t.parent.matrixWorld).invert(),t.position.applyMatrix4(e)),e.copy(t.hiddenMatrix).invert(),t.position.applyMatrix4(e),t.updateMatrix(),t.hasNonUniformScale&&(t.updateMatrixWorld(),t.updateMatrixWorldSVD()),t instanceof zr&&qa(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),Rye=class{constructor(e,t,i,n,r){this.data=e,this.object=t,this.paused=!1,this.currentDampingFactor=1,this.snapComplete=!1,this.isReset=!1,this.worldPosition0=new T,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...IS.defaultData,...e,...e.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},e.target===void 0||e.target==="cursor"||(this.target=i.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.resetDampingFactor=80/this.data.resetSpeed+1,this.object.getWorldPosition(this.worldPosition0),this.actions=cs(e,e.actions,i,n,r,t)}},Iye=class extends po{constructor(e,t){super(e),this.events=[],this.pairOfEventListeners=[],this.onMouseMove=n=>{if(!(dt.length>1)){this.eventContext.updateRaycaster(n);for(let r of this.events)r.target===void 0&&this.updateSingleEvent(r)}},this.onMouseEnter=n=>{for(let r of this.events)r.target===void 0&&(r.isReset=!1,r.currentDampingFactor=r.data.dampingFactor)},this.onMouseLeave=n=>{for(let r of this.events)r.target===void 0&&(r.data.resetOnPointerLeave&&(r.isReset=!0,r.currentDampingFactor=r.resetDampingFactor),this.updateSingleEvent(r))},this.onTargetChange=n=>()=>{this.updateSingleEvent(n)};let{page:i}=this.eventContext;i.traverseEntity(n=>{var s,a;let r=(s=n.data)==null?void 0:s.events.find(o=>o.data.type==="Follow"&&!o.data.disabled);r&&(!i.data.globalPhysics.usePhysics||((a=n.dataPatched.physics)==null?void 0:a.rigidBody)!=="dynamic")&&this.events.push(new Rye(r.data,n,i,e.sharedAssets,t))})}connect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),ts&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),t.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents||(e.addEventListener("pointerenter",this.onMouseEnter),e.addEventListener("pointerleave",this.onMouseLeave));for(let i of this.events)if(i.target!==void 0){let n=i.target,r=this.onTargetChange(i);this.pairOfEventListeners.push([n,r]),n.addEventListener("requestRender",r)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),ts&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave);for(let[i,n]of this.pairOfEventListeners)i.removeEventListener("requestRender",n);for(let i of this.events)i.paused=!0,i.isReset=!1,kr(i.actions)}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e,!0)}updateSingleEvent(e,t=!1){var a;this.events.forEach(o=>{o.actions.Create.forEach(l=>{l.dispatchThrottled()})});let{plane:i,limitDistance:n,limitDistanceEnabled:r}=e.data;if(e.object.getWorldPosition(So),e.isReset)Mo.copy(e.worldPosition0);else if(e.target)e.target.getWorldPosition(Mo);else{let{getCamera:o,raycaster:l}=this.eventContext;if(i==="custom"?(o().getWorldDirection(aw),aw.negate(),Uu.copy(aw)):i==="xy"?Uu.set(0,0,1):i==="xz"?Uu.set(0,1,0):i==="yz"&&Uu.set(1,0,0),FD.setFromNormalAndCoplanarPoint(Uu,So),!l.ray.intersectPlane(FD,Mo))return}if(!e.isReset){if(Mo.distanceTo(e.worldPosition0)>n&&r&&e.target)if(e.snapComplete=!1,e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&e.timeoutId!==null&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,e.data.resetAfterDistanceLimit)Mo.copy(e.worldPosition0),e.currentDampingFactor=e.resetDampingFactor;else return;else if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout(()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)},e.data.snapDelay*1e3)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),e.delayFinished===!1)return}e.data.enabledTranslation[0]===!1&&(Mo.x=So.x),e.data.enabledTranslation[1]===!1&&(Mo.y=So.y),e.data.enabledTranslation[2]===!1&&(Mo.z=So.z);let s=Lye(So,Mo,e.wasOutside?0:e.data.maxDelta);if(e.currentDampingFactor>1){let o=Uu.subVectors(s,So).divideScalar(e.currentDampingFactor);So.add(o),t&&zD(e.object,So),e.paused=o.length()<Pye}else zD(e.object,s),e.paused=!0;(a=e.object)==null||a.dispatchEvent({type:"beginEvent",eventName:"Follow"}),e.object.dispatchEvent(Dye)}},Zf=new T,Q1=new T,Qf=new ke,Fu=new At,Pl=new At,Kf=new T,$f=new T,Zc=new T,Co=new T,ow=new Qr,Oye=1e-6,Bye={type:"requestRender"},Nye={type:"changeRotation"},kD=function(){let e=new ke;return function(t,i){t.parent!==null?e.multiplyMatrices(t.parent.matrixWorld,t.hiddenMatrix):e.copy(t.hiddenMatrix),i.premultiply(Rz(e).invert()),t.rotation.setFromRotationMatrix(i),t.updateMatrix(),t instanceof zr&&qa(t.parent)&&t.invalidateDownstreamBooleanData(!0)}}(),Uye=class{constructor(e,t,i){this.object=t,this.paused=!1,this.currentDampingFactor=1,this.isReset=!1,this.worldQuaternion0=new At,this.timeoutId=null,this.delayFinished=!0,this.wasOutside=!1,this.data={...OS.defaultData,...e,...e.resetOnPointerLeave===void 0&&{resetOnPointerLeave:!1}},e.target===void 0||e.target==="cursor"||(this.target=i.find(e.target)),this.data.dampingFactor&&(this.currentDampingFactor=this.data.dampingFactor),this.object.getWorldQuaternion(this.worldQuaternion0),this.resetDampingFactor=80/this.data.resetSpeed+1}},Fye=class extends po{constructor(e){super(e),this.events=[],this.pairOfEventListeners=[],this.pairOfUserEventListeners=[],this.onMouseMove=i=>{if(!(dt.length>1)){this._lastMouseEvent=i,this.eventContext.updateRaycaster(i);for(let n of this.events)n.target===void 0&&this.updateSingleEvent(n)}},this.onMouseEnter=i=>{for(let n of this.events)n.target===void 0&&(n.isReset=!1,n.currentDampingFactor=n.data.dampingFactor)},this.onMouseLeave=i=>{for(let n of this.events)n.target===void 0&&(n.data.resetOnPointerLeave&&(n.isReset=!0,n.currentDampingFactor=n.resetDampingFactor),this.updateSingleEvent(n))},this.onScroll=i=>{if(this._lastMouseEvent){let n=new PointerEvent("pointermove",{clientX:this._lastMouseEvent.clientX,clientY:this._lastMouseEvent.clientY,bubbles:!0,cancelable:!0,view:window});this.eventContext.eventElement.dispatchEvent(n)}},this.onTargetChange=i=>()=>{this.updateSingleEvent(i)},this.createUserEventListener=i=>({eventName:n,target:r})=>{if(!n||!r)return;let s=dg(n);s&&s==="LookAt"&&this.updateSingleEvent(i)};let{page:t}=this.eventContext;t.traverseEntity(i=>{var r,s;let n=(r=i.data)==null?void 0:r.events.find(a=>a.data.type==="LookAt"&&!a.data.disabled);n&&(!t.data.globalPhysics.usePhysics||((s=i.dataPatched.physics)==null?void 0:s.rigidBody)!=="dynamic")&&this.events.push(new Uye(n.data,i,t))})}connect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),ts&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMouseMove)),this.domEventsNeeded.add("pointermove"),t.addEventListener("pointermove",this.onMouseMove),this.eventContext.useWindowEvents?t.addEventListener("scroll",this.onScroll):(e.addEventListener("pointerenter",this.onMouseEnter),e.addEventListener("pointerleave",this.onMouseLeave));for(let i of this.events){if(i.target!==void 0){let s=this.onTargetChange(i),a=i.target;this.pairOfEventListeners.push([a,s]),a.addEventListener("requestRender",s)}let n=this.createUserEventListener(i),r=i.object;this.pairOfUserEventListeners.push([r,n]),r.addEventListener("userEvent",n)}}disconnect(){if(!this.events.length)return;let{domElement:e,eventElement:t}=this.eventContext;this.domEventsNeeded.clear(),ts&&e.removeEventListener("pointerdown",this.onMouseMove),t.removeEventListener("pointermove",this.onMouseMove),e.removeEventListener("pointerenter",this.onMouseEnter),e.removeEventListener("pointerleave",this.onMouseLeave),t.removeEventListener("scroll",this.onScroll);for(let[i,n]of this.pairOfEventListeners)i.removeEventListener("requestRender",n);for(let[i,n]of this.pairOfUserEventListeners)i.removeEventListener("userEvent",n);for(let i of this.events)i.paused=!0,i.isReset=!1}onAnimationFrameDamping(){for(let e of this.events)e.paused||this.updateSingleEvent(e)}updateSingleEvent(e){var d;let{tilt:t,axis:i,distance:n,plane:r,limitDistance:s,enabledRotation:a,limitDistanceEnabled:o}=e.data,{getCamera:l,raycaster:c}=this.eventContext,{object:u,target:h}=e;if(u.getWorldPosition(Kf),!e.isReset)if(e.target)e.target.getWorldPosition($f);else{if(r==="custom"?(l().getWorldDirection(Q1),Q1.negate(),ow.setFromNormalAndCoplanarPoint(Q1,Kf)):(r==="xy"?Zf.set(0,0,1):r==="xz"?Zf.set(0,1,0):r==="yz"&&Zf.set(1,0,0),ow.setFromNormalAndCoplanarPoint(Zf,Kf)),!c.ray.intersectPlane(ow,$f))return;n>0&&(r==="custom"||r===void 0)&&$f.addScaledVector(Q1,n)}if(e.isReset||(h?t==="target"?Zc.copy(h.up).applyMatrix4(Qf.extractRotation(h.matrixWorld)).normalize():a.some(p=>p===!1)?(i==="x"?(Co.set(0,0,1),a[2]===!1&&Co.set(0,1,0)):i==="y"?(Co.set(1,0,0),a[0]===!1&&Co.set(0,0,1)):(Co.set(0,1,0),a[1]===!1&&Co.set(1,0,0)),Zc.copy(Co).applyQuaternion(e.worldQuaternion0).normalize()):Zc.set(0,1,0):r==="custom"?Zc.set(0,1,0):Zc.copy(Zf)),e.isReset)Pl.copy(e.worldQuaternion0);else if(Kf.distanceTo($f)>s&&o&&h)if(e.data.snapDelay&&(e.delayFinished=!1,typeof window<"u"&&e.timeoutId!==null&&(window.clearTimeout(e.timeoutId),e.timeoutId=null)),e.wasOutside=!0,e.data.resetAfterDistanceLimit)Pl.copy(e.worldQuaternion0),e.currentDampingFactor=e.resetDampingFactor;else return;else{if(e.wasOutside&&(e.data.snapDelay&&typeof window<"u"&&(e.timeoutId=window.setTimeout(()=>{e.delayFinished=!0,e.paused=!1,this.updateSingleEvent(e)},e.data.snapDelay*1e3)),e.currentDampingFactor=e.data.dampingFactor,e.wasOutside=!1),e.delayFinished===!1)return;zye(Qf,$f,Kf,Zc,i,Co),Pl.setFromRotationMatrix(Qf),Fu.setFromUnitVectors(Co.applyQuaternion(Pl),Zc),a.some(p=>p===!1)&&t!=="target"&&Pl.premultiply(Fu).normalize()}e.currentDampingFactor>1?(u.updateWorldMatrix(!0,!1),Fu.setFromRotationMatrix(Rz(u.matrixWorld)),Fu.slerp(Pl,1/e.currentDampingFactor),kD(u,Qf.makeRotationFromQuaternion(Fu)),e.paused=8*(1-Fu.dot(Pl))<Oye):(kD(u,Qf.makeRotationFromQuaternion(Pl)),e.paused=!0),(d=e.object)==null||d.dispatchEvent({type:"beginEvent",eventName:"LookAt"}),u.dispatchEvent(Bye),u.dispatchEvent(Nye)}},xs=new T,en=new T,Ni=new T;function zye(e,t,i,n,r,s){let a=e.elements;Ni.subVectors(t,i),Ni.lengthSq()===0&&(Ni.z=1),Ni.normalize(),en.crossVectors(n,Ni),en.lengthSq()===0&&(Math.abs(n.z)===1?Ni.x+=1e-4:Ni.z+=1e-4,Ni.normalize(),en.crossVectors(n,Ni)),en.normalize(),xs.crossVectors(Ni,en),r==="x"?s.z===1?[en,xs,Ni]=[Ni,en,xs]:(en.negate(),[en,Ni]=[Ni,en]):r==="y"?s.x===1?[en,xs,Ni]=[xs,Ni,en]:(en.negate(),[xs,Ni]=[Ni,xs]):s.x===1&&(en.negate(),[en,xs]=[xs,en]),a[0]=en.x,a[4]=xs.x,a[8]=Ni.x,a[1]=en.y,a[5]=xs.y,a[9]=Ni.y,a[2]=en.z,a[6]=xs.z,a[10]=Ni.z}var kye=class{constructor(e,t,i,n,r,s){this.id=e,this.data=t,this.object=i,this.entered=!1,this.actions=cs(t,t.actions,n,r,s,i)}disconnect(){kr(this.actions)}dispatchEnter(){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.entered||(this.entered=!0,this.actions.Transition.forEach(e=>e.playFromCurrent()),this.actions.Animation.forEach(e=>e.play()),this.actions.Create.forEach(e=>e.dispatch()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.SwitchCamera.forEach(e=>e.playFromCurrent()),this.actions.SceneTransition.forEach(e=>e.dispatch()))}dispatchLeave(){this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.entered&&(this.entered=!1,this.actions.Transition.forEach(e=>e.reverseFromCurrent()),this.actions.SwitchCamera.forEach(e=>e.reverseFromCurrent()))}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.Create.forEach(t=>t.dispatch()),this.actions.Destroy.forEach(t=>t.dispatch()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.SceneTransition.forEach(t=>t.dispatch())}},Vye=class extends po{constructor(e,t){super(e),this.eventsPerObjects={},this.objects=[],this._prevObjects=[],this.onMouseDown=r=>{dt.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseHoverEvent())},this.onMouseUp=r=>{dt.length>1||this.handleMouseHoverEvent(!0)},this.onMouseMove=r=>{dt.length>1||(this.eventContext.updateRaycaster(r),this.handleMouseHoverEvent())},this.onUserEvent=({eventName:r,target:s,reverse:a})=>{var l;if(!r||!s)return;let o=dg(r);o&&o==="MouseHover"&&(s.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(l=this.eventsPerObjects[s.uuid])==null||l.forEach(c=>c.dispatchUserEvent(a)))};let{page:i,sharedAssets:n}=this.eventContext;i.traverseEntity(r=>{var s,a;if(!(!r.visible||!((s=r.data)!=null&&s.events.length))){for(let{id:o,data:l}of r.data.events)if(!l.disabled&&l.type==="MouseHover")try{let c=new kye(o,l,r,i,n,t);this.eventsPerObjects[r.uuid]?this.eventsPerObjects[r.uuid].push(c):this.eventsPerObjects[r.uuid]=[c]}catch{}(a=this.eventsPerObjects[r.uuid])!=null&&a.length&&this.objects.push(r)}})}connect(){if(!this.objects.length)return;let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),ts&&(this.domEventsNeeded.add("pointerdown"),e.addEventListener("pointerdown",this.onMouseDown),this.domEventsNeeded.add("pointerup"),e.addEventListener("pointerup",this.onMouseUp)),this.domEventsNeeded.add("pointermove"),e.addEventListener("pointermove",this.onMouseMove),this.objects.forEach(t=>{t.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if(!this.objects.length)return;let{domElement:e}=this.eventContext;this.domEventsNeeded.clear(),ts&&(e.removeEventListener("pointerdown",this.onMouseDown),e.removeEventListener("pointerup",this.onMouseUp)),e.removeEventListener("pointermove",this.onMouseMove),Object.values(this.eventsPerObjects).forEach(t=>{t.forEach(i=>{i.disconnect()})}),this.objects.forEach(t=>{t.removeEventListener("userEvent",this.onUserEvent)})}handleMouseHoverEvent(e=!1){let t=[];if(!e){let{stopRaycast:i,raycaster:n,page:r}=this.eventContext;if(i){let s=zM(n,r,this.objects);t=kM(s)}else this.objects.forEach(s=>{wx(n,s)&&t.push(s)})}this._prevObjects.length&&this._prevObjects.forEach(i=>{var n;t.includes(i)||(i.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(n=this.eventsPerObjects[i.uuid])==null||n.forEach(r=>r.dispatchLeave()))}),t.length&&t.forEach(i=>{var n;i.dispatchEvent({type:"beginEvent",eventName:"MouseHover"}),(n=this.eventsPerObjects[i.uuid])==null||n.forEach(r=>r.dispatchEnter())}),this._prevObjects=t}},Hye=class{constructor(e,t,i,n,r,s){this.id=e,this.data=t,this.object=i,this.scrollCounter=0,this.actions=cs(t,t.actions,n,r,s,i)}connect(){this.scrollCounter=0}disconnect(){kr(this.actions)}dispatch(e){this.actions.Transition.forEach(n=>{n.object.currentTransitionEvent!==this&&(n.object.currentTransitionEvent=this,n.init())});let t=e>0?1:-1;this.scrollCounter+=t,this.scrollCounter=Math.min(Math.max(this.scrollCounter,0),this.data.steps);let i=this.scrollCounter/this.data.steps;this.actions.Transition.forEach(n=>n.seek(i)),this.actions.Animation.forEach(n=>n.seek(t)),this.actions.Create.forEach(n=>n.dispatchThrottled())}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>{t.playFromCurrent()}),this.actions.Animation.forEach(t=>{t.playFromCurrent()})),this.actions.Create.forEach(t=>t.dispatchThrottled())}},Gye=class{constructor(e,t,i,n,r,s,a){this.id=e,this.data=t,this.object=i,this.domElement=s,this.eventManager=a,this.scrollStart=0,this.scrollEnd=0,this.actions=cs(t,t.actions,n,r,a,i)}computeScrollBounds(){let e=this.domElement.getBoundingClientRect(),t=document.body,i=document.documentElement,n=window.pageYOffset||i.scrollTop||t.scrollTop,r=i.clientTop||t.clientTop||0,s=Math.round(e.top+n-r);if(this.data.startFrom==="enter"){let a=window.innerHeight,o=e.height,l=this.data.enterAnchor,c=l==="top"?a:l==="bottom"?a-o:a-o*.5;this.scrollStart=s-c}else this.scrollStart=0;this.scrollStart+=this.data.startOffset??0,this.scrollEnd=this.scrollStart+(this.data.endAfter??400),this.box=e,this.computeScroll({x:window.scrollX,y:window.scrollY})}connect(){this.computeScrollBounds()}disconnect(){kr(this.actions)}handleResize(){this.computeScrollBounds()}get isInvalidBox(){return this.box===void 0||this.box.width===0&&this.box.height===0&&this.box.top===0&&this.box.bottom===0}computeScroll({x:e,y:t}){this.actions.Transition.forEach(r=>{r.object.currentTransitionEvent!==this&&(r.object.currentTransitionEvent=this,r.init())});let i=this.scrollEnd-this.scrollStart,n=Math.min(1,Math.max(0,(t-this.scrollStart)/i));this.actions.Transition.forEach(r=>r.seek(n)),this.actions.Animation.forEach(r=>r.seek(n)),this.actions.Create.forEach(r=>r.dispatchThrottled())}dispatch(e){this.isInvalidBox&&this.computeScrollBounds(),this.computeScroll(e)}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>{t.playFromCurrent()}),this.actions.Animation.forEach(t=>{t.playFromCurrent()})),this.actions.Create.forEach(t=>t.dispatchThrottled())}},jye=class extends po{constructor(e,t){super(e),this.wheelEventsPerObject=new Map,this.scrollEventsPerObject=new Map,this.isInview=!0,this.handleResize=()=>{[...this.scrollEventsPerObject.entries()].forEach(([a,o])=>{o.forEach(l=>l.handleResize())})},this.onScroll=a=>{if(!this.isInview)return;let o={y:window.scrollY,x:window.scrollX};[...this.scrollEventsPerObject.entries()].forEach(([l,c])=>{l.dispatchEvent({type:"beginEvent",eventName:"Scroll",scroll:o}),c.forEach(u=>u.dispatch(o))})},this.onWheel=a=>{!this.isInview||a.ctrlKey||[...this.wheelEventsPerObject.entries()].forEach(([o,l])=>{o.dispatchEvent({type:"beginEvent",eventName:"Scroll",deltaY:a.deltaY}),l.forEach(c=>c.dispatch(a.deltaY))})},this.onUserEvent=({eventName:a,target:o,reverse:l})=>{var u;if(!a||!o)return;let c=dg(a);c&&c==="Scroll"&&(o.dispatchEvent({type:"beginEvent",eventName:"Scroll"}),(u=this.wheelEventsPerObject.get(o))==null||u.forEach(h=>{h.dispatchUserEvent(l)}))};let{page:i,sharedAssets:n,domElement:r,isExport:s}=this.eventContext;i.traverseEntity(a=>{var o,l,c;if((o=a.data)!=null&&o.events.length){for(let{id:u,data:h}of a.data.events)if(!h.disabled&&h.type==="Scroll")if(h.trigger==="load"||!s){let d=new Hye(u,h,a,i,n,t);this.wheelEventsPerObject.has(a)?(l=this.wheelEventsPerObject.get(a))==null||l.push(d):this.wheelEventsPerObject.set(a,[d])}else{let d=new Gye(u,h,a,i,n,r,t);this.scrollEventsPerObject.has(a)?(c=this.scrollEventsPerObject.get(a))==null||c.push(d):this.scrollEventsPerObject.set(a,[d])}}}),this.intersectionObserver=new IntersectionObserver(a=>{let o=a[0];o&&(this.isInview=o.isIntersecting)},{root:null})}connect(){this.intersectionObserver.observe(this.eventContext.domElement),[...this.wheelEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(i=>i.connect()),e.addEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(i=>i.connect()),e.addEventListener("userEvent",this.onUserEvent)}),[...this.wheelEventsPerObject.values()].some(e=>e.length)&&(this.domEventsNeeded.add("wheel"),window.addEventListener("wheel",this.onWheel)),[...this.scrollEventsPerObject.values()].some(e=>e.length)&&(this.domEventsNeeded.add("scroll"),window.addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.handleResize))}disconnect(){window.removeEventListener("wheel",this.onWheel),window.removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.handleResize),this.intersectionObserver.unobserve(this.eventContext.domElement),this.domEventsNeeded.clear(),[...this.wheelEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(i=>i.disconnect()),e.removeEventListener("userEvent",this.onUserEvent)}),[...this.scrollEventsPerObject.entries()].forEach(([e,t])=>{t.forEach(i=>i.disconnect()),e.removeEventListener("userEvent",this.onUserEvent)})}},Wye=class{constructor(e,t,i,n,r,s){this.id=e,this.data=t,this.object=i,this.actions=cs(t,t.actions,n,r,s,i)}disconnect(){kr(this.actions)}dispatch(){this.actions.Transition.forEach(e=>{e.play()}),this.actions.Animation.forEach(e=>{e.play()}),this.actions.SwitchCamera.forEach(e=>{e.play()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatchFromStart()}),this.actions.Destroy.forEach(e=>{e.dispatchFromStart()})}dispatchAfter(e){this.actions.Audio.forEach(t=>{(t.interaction.data.triggerAfter??"any")===e&&(t.interaction instanceof Sh?t.interaction.audioPlayer.play():t.interaction instanceof OM&&t.interaction.dispatch())}),this.actions.Video.forEach(t=>{let i=t.interaction.data.triggerAfter??"autoplay";i===e&&(t.interaction instanceof op?t.interaction.play(i==="autoplay"):t.interaction instanceof UM&&t.interaction.dispatch())})}dispatchUserEvent(e){this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),e?(this.actions.Transition.forEach(t=>t.reverseFromCurrent()),this.actions.Animation.forEach(t=>t.reverseFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.reverseFromCurrent())):(this.actions.Transition.forEach(t=>t.playFromCurrent()),this.actions.Animation.forEach(t=>t.playFromCurrent()),this.actions.SwitchCamera.forEach(t=>t.playFromCurrent())),this.actions.SceneTransition.forEach(t=>t.dispatch()),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch()}),this.actions.Audio.forEach(t=>{t.interaction instanceof Sh?t.interaction.audioPlayer.play():t.interaction instanceof OM&&t.interaction.dispatch()}),this.actions.Video.forEach(t=>{t.interaction instanceof op?t.interaction.play():t.interaction instanceof UM&&t.interaction.dispatch()})}},Xye=class extends po{constructor(e,t){super(e),this.eventManager=t,this.eventsPerObject=new Map,this.eventsAfterPerObject=new Map,this.onMouseDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([i,n])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach(r=>{r.dispatchAfter("mouseDown")})})},this.onKeyDown=()=>{[...this.eventsAfterPerObject.entries()].forEach(([i,n])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach(r=>{r.dispatchAfter("keyDown")})})},this.onAny=()=>{let{domElement:i,isExport:n}=this.eventContext;(n?document:i).removeEventListener("pointerdown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([r,s])=>{r.dispatchEvent({type:"beginEvent",eventName:"Start"}),s.forEach(a=>{a.dispatchAfter("any")})})},this.onSceneTransitionAudioVideoPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([i,n])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach(r=>{r.actions.Audio.forEach(s=>{s.interaction instanceof Sh&&s.interaction.audioPlayer.play()}),r.actions.Video.forEach(s=>{let a=s.interaction.data.triggerAfter??"autoplay";s.interaction instanceof op&&s.interaction.play(a==="autoplay")})})})},this.onPlay=()=>{[...this.eventsAfterPerObject.entries()].forEach(([i,n])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach(r=>{r.dispatchAfter("autoplay")})})},this.onUserEvent=({eventName:i,target:n,reverse:r})=>{var a,o;if(!i||!n)return;let s=dg(i);s&&s==="Start"&&(n.dispatchEvent({type:"beginEvent",eventName:"Start"}),(a=this.eventsPerObject.get(n))==null||a.forEach(l=>{l.dispatchUserEvent(r)}),(o=this.eventsAfterPerObject.get(n))==null||o.forEach(l=>{l.dispatchUserEvent(r)}))}}connect(){let{sharedAssets:e,page:t}=this.eventContext;if(t.traverseEntity(i=>{var n,r,s,a;if((n=i.data)!=null&&n.events.length)for(let{id:o,data:l}of i.data.events){if(l.disabled||l.type!=="Start")continue;let c=new Wye(o,l,i,t,e,this.eventManager);(c.actions.Transition.length||c.actions.Animation.length||c.actions.SwitchCamera.length||c.actions.Create.length||c.actions.Destroy.length||c.actions.SceneTransition.length)&&(this.eventsPerObject.has(i)?(r=this.eventsPerObject.get(i))==null||r.push(c):this.eventsPerObject.set(i,[c])),c.actions.Audio.length&&(this.eventsAfterPerObject.has(i)?(s=this.eventsAfterPerObject.get(i))==null||s.push(c):this.eventsAfterPerObject.set(i,[c])),c.actions.Video.length&&(this.hasVideoAction=!0,this.eventsAfterPerObject.has(i)?(a=this.eventsAfterPerObject.get(i))==null||a.push(c):this.eventsAfterPerObject.set(i,[c]))}}),[...this.eventsAfterPerObject.values()].some(i=>i.length)){if(this.eventManager.activateCount===0){let{domElement:i,isExport:n}=this.eventContext,r=n?document:i;r.addEventListener("pointerdown",this.onMouseDown,{once:!0}),r.addEventListener("mousedown",this.onMouseDown,{once:!0}),document.addEventListener("keydown",this.onKeyDown,{once:!0}),r.addEventListener("pointerdown",this.onAny),r.addEventListener("mousedown",this.onAny),document.addEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([s,a])=>{s.addEventListener("userEvent",this.onUserEvent)})}else this.onSceneTransitionAudioVideoPlay();this.onPlay()}[...this.eventsPerObject.entries()].forEach(([i,n])=>{i.dispatchEvent({type:"beginEvent",eventName:"Start"}),n.forEach(r=>r.dispatch()),i.addEventListener("userEvent",this.onUserEvent)})}disconnect(){if([...this.eventsAfterPerObject.values()].some(e=>e.length)){let{domElement:e,isExport:t}=this.eventContext,i=t?document:e;i.removeEventListener("pointerdown",this.onMouseDown),i.removeEventListener("mousedown",this.onMouseDown),document.removeEventListener("keydown",this.onKeyDown),i.removeEventListener("pointerdown",this.onAny),i.removeEventListener("mousedown",this.onAny),document.removeEventListener("keydown",this.onAny),[...this.eventsAfterPerObject.entries()].forEach(([n,r])=>{n.removeEventListener("userEvent",this.onUserEvent),r.forEach(s=>s.disconnect())})}[...this.eventsPerObject.entries()].forEach(([e,t])=>{e.removeEventListener("userEvent",this.onUserEvent),t.forEach(i=>i.disconnect())}),this.eventsPerObject.clear(),this.eventsAfterPerObject.clear()}},qye=class{constructor(e,t,i,n,r,s){this.id=e,this.data=t,this.object=i,this.disabled=!1,this.actions=cs(t,t.actions,n,r,s,i),this.target=t.target,this.useToggle=t.toggle}disconnect(){kr(this.actions)}dispatch(e){this.disabled||(this.actions.Transition.forEach(t=>{t.object.currentTransitionEvent!==this&&(t.object.currentTransitionEvent=this,t.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Collision"}),this.useToggle?(this.actions.Transition.forEach(t=>{t.toggle()}),this.actions.Animation.forEach(t=>{t.toggle()})):(this.actions.Transition.forEach(t=>{t.play()}),this.actions.Animation.forEach(t=>{t.play()})),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Link.forEach(t=>{t.dispatch()}),this.actions.Reset.forEach(t=>{t.dispatch()}),this.actions.Create.forEach(t=>{t.dispatch()}),this.actions.Destroy.forEach(t=>{t.dispatch(e??!1)}),this.actions.Audio.forEach(t=>{t.dispatchBasic()}),this.actions.Video.forEach(t=>{t.dispatchBasic()}))}},Yye="https://unpkg.com/@splinetool/runtime@0.9.455/build/",Zye="https://unpkg.com/@splinetool/navmesh-wasm@0.9.455/build/",Qye=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import('${Yye}' + 'navmesh.js'),
		fetch('${Zye}' + 'navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,Kye=`
(async function() {
	const [wasmImport, wasmBinary] = await Promise.all([
		import(self.location.origin + '/_libraries/navmesh.js'),
		fetch(self.location.origin + '/_libraries/navmesh.wasm').then((res) => res.arrayBuffer()),
	]);
	const wasmModule = wasmImport.default;
	self.module = await wasmModule({ wasmBinary });
	postMessage('ready');
})();
`,$ye=`

onmessage = function(messageEvent) {
	const meshData = messageEvent.data;
	const positions = meshData[0];
	const offset = meshData[1];
	const indices = meshData[2];
	const indicesLength = meshData[3];
	const parameters = meshData[4];

	const module = self.module;
	const rc = new module.rcConfig();
	rc.cs = parameters.cs;
	rc.ch = parameters.ch;
	rc.borderSize = parameters.borderSize ? parameters.borderSize : 0;
	rc.tileSize = parameters.tileSize ? parameters.tileSize : 0;
	rc.walkableSlopeAngle = parameters.walkableSlopeAngle;
	rc.walkableHeight = parameters.walkableHeight;
	rc.walkableClimb = parameters.walkableClimb;
	rc.walkableRadius = parameters.walkableRadius;
	rc.maxEdgeLen = parameters.maxEdgeLen;
	rc.maxSimplificationError = parameters.maxSimplificationError;
	rc.minRegionArea = parameters.minRegionArea;
	rc.mergeRegionArea = parameters.mergeRegionArea;
	rc.maxVertsPerPoly = parameters.maxVertsPerPoly;
	rc.detailSampleDist = parameters.detailSampleDist;
	rc.detailSampleMaxError = parameters.detailSampleMaxError;

	if (!self.navMesh) {
		self.navMesh = new module.NavMesh();
	}
	self.navMesh.build(positions, offset, indices, indicesLength, rc);

	const navmeshData = navMesh.getNavmeshData();
	const arrView = new Uint8Array(module.HEAPU8.buffer, navmeshData.dataPointer, navmeshData.size);
	const ret = new Uint8Array(navmeshData.size);
	ret.set(arrView);
	navMesh.freeNavmeshData(navmeshData);

	postMessage(ret);
}
`,Jye=.001,exe={cs:6,ch:2,walkableSlopeAngle:90,walkableHeight:20,walkableClimb:5,walkableRadius:0,maxEdgeLen:12,maxSimplificationError:1.3,minRegionArea:8,mergeRegionArea:20,maxVertsPerPoly:6,detailSampleDist:6,detailSampleMaxError:1},zz,Nt,Tn;Jhe.then(e=>{zz=e,Nt=new e.Vec3,Tn=new e.Vec3});var txe=new T,ixe=class{constructor(e=!1,t=!1){this.usePhysics=e,this.isExport=t,this.onPointerDown=i=>{if(dt.length!==1)return;let{raycaster:n,page:r}=this.eventContext;this.eventContext.updateRaycaster(i);let s=r.raycastWithClones(n);if(s.length!==0){if(this.gameControl){let a=txe.copy(this.gameControl.colliderWorldPosition);a.y-=this.gameControl.colliderHeight/2,this.gameControl.path=this.computePath(a,s[0].point)}this.eventContext.requestRender()}},this.traverseWithPhysics=(i,n)=>r=>{var d,p,f,v,m,g,y;let s;if(r instanceof ha)if(r.objectForSample){if(r.objectForSample.dataPatched.physics.fusedBody)return;s=r.object}else return r.object.dataPatched.physics.fusedBody===!0&&r.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(r instanceof Wn)s=r.object;else if(s=r,((d=s.dataPatched.cloner)==null?void 0:d.disabled)===!1&&((p=s.dataPatched.cloner)==null?void 0:p.hideBase)&&((f=s.dataPatched.physics)==null?void 0:f.fusedBody)!==!0)return!0;if(n&&!s.userData.navmesh)return;let a=s.dataPatched;if(!a.visible&&((v=a.physics)==null?void 0:v.enabled)!==!0)return!0;r.updateMatrixWorldSVD();let o=Sx(a),l=s.userData.hasDestroy,c=s.userData.hasDrag,u=!1,h=!1;for(let x of a.events)x.data.disabled!==!0&&(x.data.type==="GameControl"?u=!0:x.data.type==="Follow"&&(h=!0));if(u||o||h||l||c)return!0;if(this.usePhysics&&((m=a.physics)==null?void 0:m.rigidBody)==="dynamic"){if(this.usePhysics&&((g=a.physics)!=null&&g.fusedBody))return!0}else if("geometry"in r&&r.geometry&&i.push(jo(r.geometry,r.matrixWorld)),this.usePhysics&&((y=a.physics)==null?void 0:y.fusedBody))return r.traverseObject((x,_)=>{var M,S;if(_===0)return;let b;if(x instanceof ha)if(x.objectForSample){if(x.objectForSample.dataPatched.physics.fusedBody)return;b=x.object}else return x.object.dataPatched.physics.fusedBody===!0&&x.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(x instanceof Wn)b=x.object;else if(b=x,(M=x.dataPatched.cloner)==null?void 0:M.hideBase)return!0;let w=b.dataPatched;if(!w.visible&&((S=w.physics)==null?void 0:S.enabled)!==!0)return!0;"geometry"in x&&x.geometry&&i.push(jo(x.geometry,x.matrixWorld))}),!0},this.traverseNoPhysics=(i,n)=>r=>{let s;if(r instanceof ha)return;r instanceof Wn?s=r.object:s=r;let a=s.dataPatched;if(a.physics.enabled==="visibility"?!a.visible:!a.physics.enabled)return!0;if(n&&!s.userData.navmesh)return;let o=r.geometry,l=s.userData.hasDestroy===!0,c=s.userData.hasDrag===!0;if(Sx(a)||l||c||s.dataPatched.events.some(u=>u.data.disabled!==!0&&u.data.type==="GameControl"))return!0;o&&i.push(jo(o,r.matrixWorld))},this.navmeshWasm=zz,this.navMesh=new this.navmeshWasm.NavMesh,this._workerURL=URL.createObjectURL(new Blob([(t?Qye:Kye)+$ye])),this._worker=new Worker(this._workerURL)}init(e,t,i){this.gameControl=t,this.eventContext=i,this.resolution=e.ch,this.setDefaultQueryExtent(new T().setScalar(e.ch*e.walkableRadius*1.2)),this._worker.onmessage=()=>{this.createNavMesh(i.page,e,n=>{this.buildFromNavmeshData(n.data)})},this.eventContext.renderer.domElement.addEventListener("pointerdown",this.onPointerDown)}createNavMesh(e,t,i){t.objects.forEach(l=>{var u;let c=e.scene.find(l);c.traverseEntity(h=>{h.userData.navmesh=!0}),(u=c.cloner)==null||u.traverseObject(h=>{h.userData.navmesh=!0})});let n=[],r=(this.usePhysics?this.traverseWithPhysics:this.traverseNoPhysics)(n,t.zones==="custom");if(e.traverseChildren(r),t.objects.forEach(l=>{var u;let c=e.scene.find(l);c.traverseEntity(h=>{h.userData.navmesh=void 0}),(u=c.cloner)==null||u.traverseObject(h=>{h.userData.navmesh=void 0})}),n.length===0)return!1;let s=bh(n),{positions:a,triIndices:o}=S2(s.getAttribute("position"),s.getIndex());return this._worker.postMessage([a,a.length/3,o,o.length,{...exe,...t}]),this._worker.onmessage=i,!0}createDebugNavGeometry(){let e,t,i=this.navMesh.getDebugNavMesh(),n=i.getTriangleCount(),r=new Uint32Array(n*3),s=new Float32Array(n*3*3);for(e=0;e<n*3;e++)r[e]=e;for(e=0;e<n;e++)for(t=0;t<3;t++){let o=i.getTriangle(e).getPoint(t);s[e*9+t*3+0]=o.x,s[e*9+t*3+1]=o.y,s[e*9+t*3+2]=o.z}let a=new mt;return a.setIndex(new gt(r,1)),a.setAttribute("position",new gt(s,3)),a}getClosestPoint(e){return Nt.x=e.x,Nt.y=e.y,Nt.z=e.z,this.navMesh.getClosestPoint(Nt)}getClosestPointToRef(e,t){Nt.x=e.x,Nt.y=e.y,Nt.z=e.z;let i=this.navMesh.getClosestPoint(Nt);t.set(i.x,i.y,i.z)}getRandomPointAround(e,t){return Nt.x=e.x,Nt.y=e.y,Nt.z=e.z,this.navMesh.getRandomPointAround(Nt,t)}getRandomPointAroundToRef(e,t,i){Nt.x=e.x,Nt.y=e.y,Nt.z=e.z;let n=this.navMesh.getRandomPointAround(Nt,t);i.set(n.x,n.y,n.z)}moveAlong(e,t){return Nt.x=e.x,Nt.y=e.y,Nt.z=e.z,Tn.x=t.x,Tn.y=t.y,Tn.z=t.z,this.navMesh.moveAlong(Nt,Tn)}moveAlongToRef(e,t,i){return Nt.x=e.x,Nt.y=e.y,Nt.z=e.z,Tn.x=t.x,Tn.y=t.y,Tn.z=t.z,this.navMesh.moveAlong(Nt,Tn)}computePath(e,t){let i=this.getClosestPoint(t);Tn.x=i.x,Tn.y=i.y,Tn.z=i.z,this.getClosestPoint(e);let n=this.navMesh.computePath(Nt,Tn),r=n.getPointCount(),s=[];for(let a=0;a<r;a++){let o=n.getPoint(a);s.push(new T(o.x,o.y,o.z))}return s}createCrowd(e,t){return new nxe(this,e,t)}setDefaultQueryExtent(e){Nt.x=e.x,Nt.y=e.y,Nt.z=e.z,this.navMesh.setDefaultQueryExtent(Nt)}getDefaultQueryExtent(){return this.navMesh.getDefaultQueryExtent()}buildFromNavmeshData(e){let t=e.length*e.BYTES_PER_ELEMENT,i=this.navmeshWasm._malloc(t),n=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,i,t);n.set(e);let r=new this.navmeshWasm.NavmeshData;r.dataPointer=n.byteOffset,r.size=e.length,this.navMesh.buildFromNavmeshData(r),this.navmeshWasm._free(n.byteOffset)}getNavmeshData(){let e=this.navMesh.getNavmeshData(),t=new Uint8Array(this.navmeshWasm.HEAPU8.buffer,e.dataPointer,e.size),i=new Uint8Array(e.size);return i.set(t),this.navMesh.freeNavmeshData(e),i}getDefaultQueryExtentToRef(e){let t=this.navMesh.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}dispose(){var e;this.navMesh.destroy(),this._worker.terminate(),URL.revokeObjectURL(this._workerURL),(e=this.eventContext)==null||e.renderer.domElement.removeEventListener("pointerdown",this.onPointerDown)}addCylinderObstacle(e,t,i){return Nt.x=e.x,Nt.y=e.y,Nt.z=e.z,this.navMesh.addCylinderObstacle(Nt,t,i)}addBoxObstacle(e,t,i){return Nt.x=e.x,Nt.y=e.y,Nt.z=e.z,Tn.x=t.x,Tn.y=t.y,Tn.z=t.z,this.navMesh.addBoxObstacle(Nt,Tn,i)}removeObstacle(e){this.navMesh.removeObstacle(e)}isSupported(){return this.navmeshWasm!==void 0}},nxe=class{constructor(e,t,i){this.navmeshWasmWrapper=e,this.transforms=[],this.agents=new Array,this.reachRadii=new Array,this._agentDestinationArmed=new Array,this._agentDestination=new Array,this.crowd=new this.navmeshWasmWrapper.navmeshWasm.Crowd(t,i,this.navmeshWasmWrapper.navMesh.getNavMesh())}onReachTarget(e,t){}addAgent(e,t,i){let n=new this.navmeshWasmWrapper.navmeshWasm.dtCrowdAgentParams;n.radius=t.radius,n.height=t.height,n.maxAcceleration=t.maxAcceleration,n.maxSpeed=t.maxSpeed,n.collisionQueryRange=t.collisionQueryRange,n.pathOptimizationRange=t.pathOptimizationRange,n.separationWeight=t.separationWeight,n.updateFlags=7,n.obstacleAvoidanceType=0,n.queryFilterType=0,n.userData=0;let r=this.crowd.addAgent(new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z),n);return this.transforms.push(i),this.agents.push(r),this.reachRadii.push(t.reachRadius?t.reachRadius:t.radius),this._agentDestinationArmed.push(!1),this._agentDestination.push(new T(0,0,0)),r}getAgentPosition(e){return this.crowd.getAgentPosition(e)}getAgentPositionToRef(e,t){let i=this.crowd.getAgentPosition(e);t.set(i.x,i.y,i.z)}getAgentVelocity(e){return this.crowd.getAgentVelocity(e)}getAgentVelocityToRef(e,t){let i=this.crowd.getAgentVelocity(e);t.set(i.x,i.y,i.z)}getAgentNextTargetPath(e){return this.crowd.getAgentNextTargetPath(e)}getAgentNextTargetPathToRef(e,t){let i=this.crowd.getAgentNextTargetPath(e);t.set(i.x,i.y,i.z)}getAgentState(e){return this.crowd.getAgentState(e)}overOffmeshConnection(e){return this.crowd.overOffmeshConnection(e)}agentGoto(e,t){this.crowd.agentGoto(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z));let i=this.agents.indexOf(e);i>-1&&(this._agentDestinationArmed[i]=!0,this._agentDestination[i].set(t.x,t.y,t.z))}agentTeleport(e,t){this.crowd.agentTeleport(e,new this.navmeshWasmWrapper.navmeshWasm.Vec3(t.x,t.y,t.z))}updateAgentParameters(e,t){let i=this.crowd.getAgentParameters(e);t.radius!==void 0&&(i.radius=t.radius),t.height!==void 0&&(i.height=t.height),t.maxAcceleration!==void 0&&(i.maxAcceleration=t.maxAcceleration),t.maxSpeed!==void 0&&(i.maxSpeed=t.maxSpeed),t.collisionQueryRange!==void 0&&(i.collisionQueryRange=t.collisionQueryRange),t.pathOptimizationRange!==void 0&&(i.pathOptimizationRange=t.pathOptimizationRange),t.separationWeight!==void 0&&(i.separationWeight=t.separationWeight),this.crowd.setAgentParameters(e,i)}removeAgent(e){this.crowd.removeAgent(e);let t=this.agents.indexOf(e);t>-1&&(this.agents.splice(t,1),this.transforms.splice(t,1),this.reachRadii.splice(t,1),this._agentDestinationArmed.splice(t,1),this._agentDestination.splice(t,1))}getAgents(){return this.agents}update(e){if(this.navmeshWasmWrapper.navMesh.update(),e<=Jye)return;let t=1/60,i=10;{let n=Math.floor(e/t);n>i&&(n=i),n<1&&(n=1);let r=e/n;for(let s=0;s<n;s++)this.crowd.update(r)}for(let n=0;n<this.agents.length;n++){let r=this.agents[n],s=this.getAgentPosition(r);if(this.transforms[n].copy(s),this._agentDestinationArmed[n]){let a=s.x-this._agentDestination[n].x,o=s.z-this._agentDestination[n].z,l=this.reachRadii[n],c=this._agentDestination[n].y-this.reachRadii[n],u=this._agentDestination[n].y+this.reachRadii[n],h=a*a+o*o;s.y>c&&s.y<u&&h<l*l&&(this.onReachTarget(r,this._agentDestination[n]),this._agentDestinationArmed[n]=!1)}}}setDefaultQueryExtent(e){let t=new this.navmeshWasmWrapper.navmeshWasm.Vec3(e.x,e.y,e.z);this.crowd.setDefaultQueryExtent(t)}getDefaultQueryExtent(){return this.crowd.getDefaultQueryExtent()}getDefaultQueryExtentToRef(e){let t=this.crowd.getDefaultQueryExtent();e.set(t.x,t.y,t.z)}getCorners(e){let t,i=this.crowd.getCorners(e),n=i.getPointCount(),r=[];for(t=0;t<n;t++){let s=i.getPoint(t);r.push(new T(s.x,s.y,s.z))}return r}dispose(){this.crowd.destroy()}};function rxe(e){let t=!1;return e.scene.objects.forEach(i=>{i.data.type==="Page"&&!t&&i.data.publish.gameControlObject&&L0.traverseModuleInstances(e,i.id,(n,r,s)=>{for(let a of s)a.data.type==="GameControl"&&a.data.navmesh.enabled&&(t=!0)})}),t}var sxe={type:"change"},VD={type:"changeZoom"},axe={type:"changePan"},zu={type:"start"},ku={type:"end",changed:!0},oxe={type:"end",changed:!1},lw=new At,HD=new te,lxe=2*Math.PI,cxe=1e-8,hxe=.01,cw=new T,K1=new te,hw=new T,$1=new At,GD=new ke,uxe={type:"requestRender"},kz=class extends In{constructor(e,t,i={isPlayMode:!1,isExport:!1}){super(),this.object=e,this.domElement=t,this.options=i,this.enabled=!0,this.useKeyEvents=!0,this.enableDamping=!1,this.enableZoom=!0,this.enableRotate=!0,this.enablePan=!0,this.autoRotate=!1,this.rotationLimitsMode=0,this.panLimitsMode=0,this.rotationSoftLimit=2,this.panSoftLimit=2,this.hoverRotatePanMode=0,this.zoomLimitsEnabled=!1,this.mouseButtons=[0,5],this.mouseButtonsPlay=[3,4,5],this.touches=[null,fs.DOLLY_ROTATE,fs.PAN],this.offset=new T,this.eye=new T,this.lastPosition=new T,this.lastQuaternion=new At,this.current=new te,this.overShoot=new te,this.overRatio=new te,this.spherical=new u8,this.sphericalDelta=new u8,this.panOffset=new T,this.panLeftV=new T,this.panUpV=new T,this.panV=new T,this.rotateStart=new te,this.rotateEnd=new te,this.rotateDelta=new te,this.panStart=new te,this.panEnd=new te,this.panDelta=new te,this.dollyStart=new te,this.dollyEnd=new te,this.dollyDelta=new te,this.rotationRangeFactor=new te,this.panRangeFactor=new te,this.state=-1,this.zoomChanged=!1,this.isPointerDown=!1,this.isThetaFlipped=!1,this.prevScale=0,this.scale=1,this.gesture=!1,this.timer=-1,this.timerHover=-1,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPhi=0,this.maxPhi=Math.PI,this.minTheta=-1/0,this.maxTheta=1/0,this.minH=0,this.maxH=Math.PI,this.minV=-1/0,this.maxV=1/0,this.autoRotateClockwise=!0,this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.resetHoverEffectOnPointerLeave=!1,this.hasChange=!1,this.useWindowEvents=!1,this.isTouchZoom=!0,this.autoRotateSpeed=2,this.dampingFactor=.125,this.zoomSpeed=2,this.rotateSpeed=1,this.panSpeed=1,this.hoverRotatePanStrength=.1,this.thetaIsFree=!1,this.phiIsFree=!1,this.needsUpdate=!0,this.onCameraChange=n=>{this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange),this.object=n.camera,this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)},this.update=()=>{this.object.updateWorldMatrix(!0,!1),this.object.matrixWorld.decompose(hw,$1,cw),this.offset.copy(hw).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.autoRotate&&this.state===-1&&this.rotateLeft((this.autoRotateClockwise===!0?1:-1)*this.getAutoRotationAngle()),this.rotationLimitsMode!==0&&this.applyLimits(this.sphericalDelta,this.rotationLimitsMode,this.rotationSoftLimit,this.maxTheta,this.minTheta,this.maxPhi,this.minPhi,this.rotationRangeFactor),this.rotationLimitsMode!==2&&(this.spherical.phi+=this.sphericalDelta.phi),(this.rotationLimitsMode!==1||this.autoRotate===!0)&&(this.spherical.theta+=this.sphericalDelta.theta),this.spherical.radius*=this.scale,this.zoomLimitsEnabled&&(this.spherical.radius=Math.max(this.minDistance,Math.min(this.maxDistance,this.spherical.radius))),this.panLimitsMode!==0&&(this.target.applyQuaternion(lw.copy($1).invert()),this.panOffset.applyQuaternion(lw),this.applyLimits(this.panOffset,this.panLimitsMode,this.panSoftLimit,this.maxH,this.minH,this.maxV,this.minV,this.panRangeFactor),this.target.applyQuaternion($1),this.panOffset.applyQuaternion($1)),this.panLimitsMode===2&&(this.panOffset.y=0),this.panLimitsMode===1&&(this.panOffset.x=0),this.state===-1&&!this.gesture?(this.panOffset.multiplyScalar(1-this.dampingFactor),this.target.add(this.panOffset)):(this.target.add(this.panOffset),this.panOffset.set(0,0,0)),this.offset.setFromSpherical(this.spherical),hw.copy(this.target).add(this.offset),this.object.position.copy(this.target).add(this.offset),this.object.parent&&(GD.copy(this.object.parent.matrixWorld).invert(),this.object.position.applyMatrix4(GD));let n=this.spherical.phi%lxe;return this.eye.copy(this.offset).normalize(),this.object.up.copy($t.DEFAULT_UP).applyAxisAngle(this.eye,this.object.angleOffsetFromUp),n>0&&n>Math.PI||n<0&&n>-Math.PI?(this.object.up.negate(),this.object.lookAt(this.target),this.object.isUpVectorFlipped=!0):(this.object.lookAt(this.target),this.object.isUpVectorFlipped=!1),this.state===-1||this.enableDamping===!0?(this.sphericalDelta.theta*=1-this.dampingFactor,this.sphericalDelta.phi*=1-this.dampingFactor):this.sphericalDelta.set(0,0,0),this.scale=1,this.zoomChanged||this.lastPosition.distanceToSquared(this.object.position)>hxe||8*(1-this.lastQuaternion.dot(this.object.quaternion))>cxe?(this.dispatchEvent(sxe),this.object.dispatchEvent(uxe),this.lastPosition.copy(this.object.position),this.lastQuaternion.copy(this.object.quaternion),this.zoomChanged=!1,!0):(this.isPanOverShoot=!1,this.isRotateOverShoot=!1,this.object.wasMovedBySwitchCameraAction=!1,this.sphericalDelta.set(0,0,0),this.panOffset.set(0,0,0),!1)},this.onPointerDown=n=>{this.enabled!==!1&&(n.pointerType==="touch"||n.pointerType==="pen"&&ts?this.onPointerDownTouch(n):this.onPointerDownMouse(n),this.state!==-1&&(this.isPointerDown=!0,this.dispatchEvent(zu),this.domElement.addEventListener("pointermove",this.onPointerMove),this.domElement.addEventListener("pointerup",this.onPointerUp),n.stopPropagation(),n.pointerType==="touch"||n.pointerType==="pen"&&ts||this.domElement.setPointerCapture(n.pointerId)))},this.onPointerLeave=n=>{this.resetHoverEffectOnPointerLeave&&!this.useWindowEvents?(this.hoverRotatePanMode===1?(this.sphericalDelta.theta=-this.spherical.theta,this.sphericalDelta.phi=-this.spherical.phi,cw.subVectors(this.position0,this.target0),this.spherical.setFromVector3(cw),this.sphericalDelta.theta+=this.spherical.theta,this.sphericalDelta.phi+=this.spherical.phi,this.sphericalDelta.theta/=8,this.sphericalDelta.phi/=8):this.hoverRotatePanMode===2&&this.panOffset.subVectors(this.target0,this.target).divideScalar(8),this.update()):this.pointerLeaveEvent=n},this.onPointerEnter=n=>{this.resetHoverEffectOnPointerLeave||this.pointerLeaveEvent===void 0?K1.set(n.clientX-this.domElement.clientWidth/2,n.clientY-this.domElement.clientHeight/2):K1.set(n.clientX-this.pointerLeaveEvent.clientX,n.clientY-this.pointerLeaveEvent.clientY),this.hoverRotatePanMode===1?(this.rotateDelta.copy(K1).multiplyScalar(this.rotateSpeed*this.hoverRotatePanStrength).rotateAround(HD,-this.object.angleOffsetFromUp),this.rotateLeft(2*Math.PI*this.rotateDelta.x/this.domElement.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/this.domElement.clientHeight),this.rotateStart.set(n.clientX,n.clientY)):this.hoverRotatePanMode===2&&(this.panDelta.copy(K1).multiplyScalar(this.panSpeed*this.hoverRotatePanStrength),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.set(n.clientX,n.clientY)),this.update()},this.onPointerMove=n=>{this.enabled!==!1&&(this.checkRaycastLock()||(n.pointerType==="touch"||n.pointerType==="pen"&&ts?this.onPointerMoveTouch(n):this.onPointerMoveMouse(n),n.stopPropagation()))},this.onPointerUp=n=>{this.isPointerDown=!1,dt.length===0&&(this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)),dt.length>1&&n.preventDefault(),this.hasChange?this.dispatchEvent(ku):this.dispatchEvent(oxe),this.state=-1,n&&(n.stopPropagation(),n.pointerType==="touch"||n.pointerType==="pen"&&ts||this.domElement.releasePointerCapture(n.pointerId))},this.onPointerDownMouse=n=>{let r;switch(this.useKeyEvents?r=this.mouseButtons[n.button]:r=this.mouseButtonsPlay[n.button],r){case 0:if(n.altKey===!0&&!n.shiftKey&&!m1(n)){if(this.enableRotate===!1)return;this.handleMouseDownRotate(n),this.state=0}else if(this.key===" "){if(this.enablePan===!1)return;this.handleMouseDownPan(n),this.state=2}break;case 4:if(this.enablePan===!1)return;this.handleMouseDownPan(n),this.state=2;break;case 3:if(m1(n)||n.shiftKey){if(this.enablePan===!1)return;this.handleMouseDownPan(n),this.state=2}else{if(this.enableRotate===!1)return;this.handleMouseDownRotate(n),this.state=0}break;case 5:if(m1(n)||n.shiftKey){if(this.enableRotate===!1)return;this.handleMouseDownRotate(n),this.state=0}else{if(this.enablePan===!1)return;this.handleMouseDownPan(n),this.state=2}break;default:this.state=-1}},this.onPointerMoveMouse=n=>{switch(this.state){case 0:if(this.enableRotate===!1)return;this.handleMouseMoveRotate(n);break;case 1:if(this.enableZoom===!1)return;this.handleMouseMoveDolly(n);break;case 2:if(this.enablePan===!1)return;this.handleMouseMovePan(n);break}this.object.wasMovedByUser=!0},this.onPointerDownTouch=n=>{switch(dt.length>1&&n.preventDefault(),this.touches[dt.length-1]){case fs.ROTATE:if(this.enableRotate===!1){this.state=-1;return}this.handleTouchStartRotate(),this.state=3;break;case fs.PAN:if(this.enablePan===!1){this.state=-1;return}this.handleTouchStartPan(),this.state=4;break;case fs.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchStartDollyPan(),this.state=5;break;case fs.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchStartDollyRotate(),this.state=6;break;default:this.state=-1}},this.onPointerMoveTouch=n=>{switch(dt.length>1&&n.preventDefault(),this.state){case 3:if(this.enableRotate===!1)return;this.handleTouchMoveRotate(n),this.update();break;case 4:if(this.enablePan===!1)return;this.handleTouchMovePan(n),this.update();break;case 5:if(this.enableZoom===!1&&this.enablePan===!1)return;this.handleTouchMoveDollyPan(n),this.update();break;case 6:if(this.enableZoom===!1&&this.enableRotate===!1)return;this.handleTouchMoveDollyRotate(n),this.update();break;default:this.state=-1}this.object.wasMovedByUser=!0},this.dispatchEndDebounced=eA(()=>this.dispatchEvent(ku),33),this.onMouseWheel=n=>{this.enabled===!1||this.enableZoom===!1&&this.enablePan===!1||this.checkRaycastLock()||(!this.options.isExport&&this.domElement.clientHeight===document.body.clientHeight&&this.domElement.clientWidth===document.body.clientWidth&&n.preventDefault(),this.dispatchEvent(zu),this.handleMouseWheel(n),this.dispatchEndDebounced(),this.object.wasMovedByUser=!0)},this.onGesture=n=>{if(n.preventDefault(),this.enabled!==!1&&!this.checkRaycastLock()&&!jN)if(n.type==="gesturechange"){if(this.enableZoom===!1||this.isTouchZoom===!1)return;this.dispatchEvent(zu),n.scale>this.prevScale?this.dollyIn(this.getZoomScale()):n.scale<this.prevScale&&this.dollyOut(this.getZoomScale()),this.prevScale=n.scale,this.update(),this.object.wasMovedByUser=!0}else this.dispatchEvent(ku)},this.onContextMenu=n=>{n.preventDefault()},this.onTouchEnd=n=>{n.preventDefault()},this.onKeyDown=n=>{this.enabled!==!1&&(this.key=n.key,n.key===" "&&this.dispatchEvent(zu))},this.onKeyUp=n=>{this.enabled!==!1&&(this.key=void 0,this.state!==-1&&n.key==="Alt"&&this.onPointerUp(dt[0]),n.key===" "&&this.dispatchEvent(ku))},this.onPointerHover=n=>{n.pointerType!=="mouse"||this.enabled===!1||this.state!==-1||this.hoverRotatePanMode===2&&this.isPanOverShoot||this.hoverRotatePanMode===1&&this.isRotateOverShoot||(this.isPointerDown=!0,this.hoverRotatePanMode===2?this.handleMouseMovePan(n,this.hoverRotatePanStrength):this.hoverRotatePanMode===1&&this.handleMouseMoveRotate(n,this.hoverRotatePanStrength))},this.onBeginState=()=>{this.enabled=!1,this.needsUpdate=!1},this.onCompleteState=n=>{n.isfromEntity&&this.options.isPlayMode||(this.enabled=!0,this.needsUpdate=!0,this.object.updateUp(),this.object.getTarget(this.target))},this.target=this.object.getTarget(),this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.quat0=this.object.quaternion.clone(),this.isUpVectorFlipped0=this.object.isUpVectorFlipped,this.offset.copy(this.object.position).sub(this.target),this.spherical.setFromVector3(this.offset),this.object.isUpVectorFlipped&&(this.spherical.phi*=-1,this.spherical.theta-=Math.PI),this.addEventListenersToCamera()}dispatchEvent(e){e.type==="start"?this.hasChange=!1:this.hasChange=!0,super.dispatchEvent(e)}addEventListenersToCamera(){this.object.addEventListener("beginState",this.onBeginState),this.object.addEventListener("completeState",this.onCompleteState),this.object.addEventListener("cameraChange",this.onCameraChange)}removeEventListenersFromCamera(){this.object.removeEventListener("beginState",this.onBeginState),this.object.removeEventListener("completeState",this.onCompleteState),this.object.removeEventListener("cameraChange",this.onCameraChange)}updateUseWindowEvents(e){if(window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("pointermove",this.onPointerHover),this.useWindowEvents=e,this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover)),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let t=this.useWindowEvents?window:this.domElement;t.addEventListener("pointerleave",this.onPointerLeave),t.addEventListener("pointerenter",this.onPointerEnter)}}fromJSON(e,t){this.setEnableDampingSpeed(e.enableDamping),this.enablePan=e.enablePan,this.enableZoom=e.enableZoom,this.enableRotate=e.enableRotate,this.rotationLimitsMode=e.rotationLimitsMode,this.thetaIsFree=e.rotationHorizontalOffset.min===e.rotationHorizontalOffset.max&&e.rotationHorizontalOffset.min===Math.PI,this.phiIsFree=e.rotationVerticalOffset.min===e.rotationVerticalOffset.max&&e.rotationVerticalOffset.min===Math.PI,this.panLimitsMode=e.panLimitsMode,this.panSoftLimit=e.panSoftLimit,this.rotationSoftLimit=e.rotationSoftLimit,this.hoverRotatePanMode=e.hoverRotatePanMode,this.useWindowEvents=t==="window",this.hoverRotatePanMode!==0&&(this.useWindowEvents?window.addEventListener("pointermove",this.onPointerHover):this.domElement.addEventListener("pointermove",this.onPointerHover));let i=e.hoverRotatePanStrength/100;this.hoverRotatePanStrength=i**2,this.zoomLimitsEnabled=e.zoomLimitsEnabled,this.minZoom=e.zoomLimits.min,this.maxZoom=Math.max(e.zoomLimits.min,e.zoomLimits.max),this.minDistance=1e3/e.zoomLimits.max,this.maxDistance=Math.max(this.minDistance,1e3/e.zoomLimits.min),this.autoRotate=e.autoRotate,this.autoRotateSpeed=e.autoRotateSpeed,this.autoRotateClockwise=e.autoRotateClockwise;let n=this.object.getTarget().applyQuaternion(lw.copy(this.object.quaternion).invert());this.minV=-e.panVerticalOffset.min+n.y,this.maxV=e.panVerticalOffset.max+n.y,this.minH=-e.panHorizontalOffset.min+n.x,this.maxH=e.panHorizontalOffset.max+n.x,this.panRangeFactor.set(this.maxH-this.minH,this.maxV-this.minV).divideScalar(2),this.rotationRangeFactor.setScalar(Math.PI).divideScalar(4),this.minPhi=Oa(this.spherical.phi-e.rotationVerticalOffset.min),this.maxPhi=Oa(this.spherical.phi+e.rotationVerticalOffset.max),this.minTheta=Oa(Oa(this.spherical.theta)-e.rotationHorizontalOffset.min),this.maxTheta=Oa(Oa(this.spherical.theta)+e.rotationHorizontalOffset.max),this.isThetaFlipped=this.minTheta>this.maxTheta,e.orbitTouches===1&&(this.touches[0]=fs.ROTATE),e.panTouches===1&&(this.touches[0]=fs.PAN),e.orbitTouches===2&&(this.touches[1]=fs.DOLLY_ROTATE),e.panTouches===2&&(this.touches[1]=fs.DOLLY_PAN),e.orbitTouches===3&&(this.touches[2]=fs.ROTATE),e.panTouches===3&&(this.touches[2]=fs.PAN),this.isTouchZoom=e.isTouchZoom,this.resetHoverEffectOnPointerLeave=e.resetHoverEffectOnPointerLeave??!1}connect(){if(this.domElement.addEventListener("contextmenu",this.onContextMenu),this.domElement.addEventListener("pointerdown",this.onPointerDown),this.domElement.addEventListener("wheel",this.onMouseWheel),window.addEventListener("keydown",this.onKeyDown,!1),window.addEventListener("keyup",this.onKeyUp,!1),this.domElement.addEventListener("gesturestart",this.onGesture),this.domElement.addEventListener("gesturechange",this.onGesture),this.domElement.addEventListener("gestureend",this.onGesture),this.domElement.addEventListener("touchend",this.onTouchEnd),this.hoverRotatePanMode!==0&&!this.useWindowEvents){let e=this.useWindowEvents?window:this.domElement;e.addEventListener("pointerleave",this.onPointerLeave),e.addEventListener("pointerenter",this.onPointerEnter)}this.pointerLeaveEvent=void 0}dispose(){this.removeEventListenersFromCamera(),this.domElement.removeEventListener("contextmenu",this.onContextMenu),this.domElement.removeEventListener("pointerdown",this.onPointerDown),this.domElement.removeEventListener("wheel",this.onMouseWheel),window.removeEventListener("keydown",this.onKeyDown,!1),window.removeEventListener("keyup",this.onKeyUp,!1),this.domElement.removeEventListener("pointermove",this.onPointerHover),window.removeEventListener("pointermove",this.onPointerHover),this.domElement.removeEventListener("gesturestart",this.onGesture),this.domElement.removeEventListener("gesturechange",this.onGesture),this.domElement.removeEventListener("gestureend",this.onGesture),this.domElement.removeEventListener("touchend",this.onTouchEnd),this.domElement.removeEventListener("pointerleave",this.onPointerLeave),this.domElement.removeEventListener("pointerenter",this.onPointerEnter),window.removeEventListener("pointerleave",this.onPointerLeave),window.removeEventListener("pointerenter",this.onPointerEnter),this.domElement.removeEventListener("pointermove",this.onPointerMove),this.domElement.removeEventListener("pointerup",this.onPointerUp)}applyLimits(e,t,i,n,r,s,a,o){this.overShoot.set(0,0);let l,c,u;e instanceof T?(l=e.x,c=e.y,this.current.set(this.target.x,this.target.y),u=!0):(l=e.theta,c=e.phi,this.current.set(Oa(this.spherical.theta),Oa(this.spherical.phi)),u=!1),i===0&&(this.current.x+=l,this.current.y+=c),(t===3||t===2)&&(!u&&this.isThetaFlipped?this.current.x>n&&this.current.x<0?this.overShoot.x=n-this.current.x:this.current.x<r&&this.current.x>0&&(this.overShoot.x=r-this.current.x):this.current.x>n?this.overShoot.x=n-this.current.x:this.current.x<r&&(this.overShoot.x=r-this.current.x)),(t===3||t===1)&&(this.current.y>s?this.overShoot.y=s-this.current.y:this.current.y<a&&(this.overShoot.y=a-this.current.y)),u||(this.overShoot.x=Oa(this.overShoot.x),this.overShoot.y=Oa(this.overShoot.y)),i!==0?(this.overRatio.copy(this.overShoot).divide(o),this.overRatio.x=Math.min(Math.abs(this.overRatio.x),1),this.overRatio.y=Math.min(Math.abs(this.overRatio.y),1),i===1&&(this.overRatio.x=jD(Math.abs(this.overRatio.x)),this.overRatio.y=jD(Math.abs(this.overRatio.y))),this.isPointerDown||i===1?i===2&&(this.overRatio.x>.9&&!this.thetaIsFree||this.overRatio.y>.9&&!this.phiIsFree)?this.isPointerDown=!1:(l*this.overShoot.x<0&&!this.thetaIsFree&&(l*=1-this.overRatio.x),c*this.overShoot.y<0&&!this.phiIsFree&&(c*=1-this.overRatio.y)):i===2&&(!u&&(this.overRatio.x>.002&&!this.thetaIsFree||this.overRatio.y>.002&&!this.phiIsFree)||u&&(Math.abs(this.overShoot.x)>2||Math.abs(this.overShoot.y)>2)?(this.thetaIsFree||(l=this.overShoot.x*.05),this.phiIsFree||(c=this.overShoot.y*.05),u?this.isPanOverShoot=!0:this.isRotateOverShoot=!0):u?this.isPanOverShoot=!1:this.isRotateOverShoot=!1)):(l+=this.overShoot.x,c+=this.overShoot.y),e instanceof T?(e.x=l,e.y=c):(this.thetaIsFree||(e.theta=l),this.phiIsFree||(e.phi=c))}setEnableDampingSpeed(e){this.enableDamping=e,this.rotateSpeed=e===!0?.2:1}stopDamping(){this.sphericalDelta.theta=0,this.sphericalDelta.phi=0}getAutoRotationAngle(){return 2*Math.PI/60/60*this.autoRotateSpeed}getZoomScale(){return Math.pow(.95,this.zoomSpeed)}rotateLeft(e){this.sphericalDelta.theta-=e}rotateUp(e){this.sphericalDelta.phi-=e}panLeft(e,t){this.panLeftV.setFromMatrixColumn(t,0),this.panLeftV.multiplyScalar(-e),this.panOffset.add(this.panLeftV)}panUp(e,t){this.panUpV.setFromMatrixColumn(t,1),this.panUpV.multiplyScalar(e),this.panOffset.add(this.panUpV)}pan(e,t){let i=this.domElement;if(i&&this.object.isPerspectiveCamera){let n=this.object.position;this.panV.copy(n).sub(this.target);let r=this.panV.length();r*=Math.tan(this.object.fov/2*Math.PI/180),this.panLeft(2*e*r/i.clientHeight,this.object.matrixWorld),this.panUp(2*t*r/i.clientHeight,this.object.matrixWorld)}else i&&this.object.isOrthographicCamera&&(this.panLeft(e*(this.object.right-this.object.left)/this.object.zoom/i.clientWidth,this.object.matrixWorld),this.panUp(t*(this.object.top-this.object.bottom)/this.object.zoom/i.clientHeight,this.object.matrixWorld));this.dispatchEvent(axe)}dollyOut(e){this.object.isPerspectiveCamera?this.scale/=e:this.object.isOrthographicCamera&&(this.object.zoom*=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(VD)}dollyIn(e){this.object.isPerspectiveCamera?this.scale*=e:this.object.isOrthographicCamera&&(this.object.zoom/=e,this.zoomLimitsEnabled&&(this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom))),this.object.updateProjectionMatrix(),this.zoomChanged=!0),this.dispatchEvent(VD)}zoomOut(e=this.getZoomScale()){this.dispatchEvent(zu),this.dollyOut(e),this.dispatchEvent(ku)}zoomIn(e=this.getZoomScale()){this.dispatchEvent(zu),this.dollyIn(e),this.dispatchEvent(ku)}handleMouseDownRotate(e){this.rotateStart.set(e.clientX,e.clientY)}handleMouseDownDolly(e){this.dollyStart.set(e.clientX,e.clientY)}handleMouseDownPan(e){this.panStart.set(e.clientX,e.clientY)}handleMouseMoveRotate(e,t=1){e.movementX!==void 0?this.rotateDelta.set(e.movementX,e.movementY):(this.rotateEnd.set(e.clientX,e.clientY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd)),this.rotateDelta.multiplyScalar(this.rotateSpeed*t).rotateAround(HD,-this.object.angleOffsetFromUp);let i=this.domElement,n=this.useWindowEvents?window.innerHeight:i.clientHeight,r=2*Math.PI*this.rotateDelta.x/n,s=2*Math.PI*this.rotateDelta.y/n;this.rotateLeft(r),this.rotateUp(s),this.update()}handleMouseMoveDolly(e){this.dollyEnd.set(e.clientX,e.clientY),this.dollyDelta.subVectors(this.dollyEnd,this.dollyStart),this.dollyDelta.y>0?this.dollyOut(this.getZoomScale()):this.dollyDelta.y<0&&this.dollyIn(this.getZoomScale()),this.dollyStart.copy(this.dollyEnd),this.update()}handleMouseMovePan(e,t=1){e.movementX!==void 0?this.panDelta.set(e.movementX,e.movementY):(this.panEnd.set(e.clientX,e.clientY),this.panDelta.subVectors(this.panEnd,this.panStart),this.panStart.copy(this.panEnd)),this.panDelta.multiplyScalar(this.panSpeed*t),this.pan(this.panDelta.x,this.panDelta.y),this.update()}handleMouseWheel(e){if(Yhe===!1&&m1(e)===!1&&dxe(e)===!0){if(this.enablePan===!1)return;this.gesture?(this.panDelta.set(-e.deltaX,-e.deltaY).multiplyScalar(this.panSpeed),this.panDelta.x=Math.min(Math.abs(this.panDelta.x),100)*(this.panDelta.x<0?-1:1),this.panDelta.y=Math.min(Math.abs(this.panDelta.y),100)*(this.panDelta.y<0?-1:1),e.altKey?this.pan(0,this.panDelta.y):e.shiftKey?this.pan(this.panDelta.x,0):this.pan(this.panDelta.x,this.panDelta.y),this.update()):(this.gesture=!0,this.isPointerDown=!0),window.clearTimeout(this.timer),this.timer=window.setTimeout(()=>{this.gesture=!1,this.isPointerDown=!1},30)}else{if(this.enableZoom===!1)return;e.deltaY===0?e.deltaX<0?this.dollyIn(this.getZoomScale()):e.deltaX>0&&this.dollyOut(this.getZoomScale()):e.deltaY<0?this.dollyIn(this.getZoomScale()):e.deltaY>0&&this.dollyOut(this.getZoomScale()),this.update(),this.gesture=!1,this.isPointerDown=!1}}handleTouchStartRotate(){if(dt.length===2){let e=.5*(dt[0].pageX+dt[1].pageX),t=.5*(dt[0].pageY+dt[1].pageY);this.rotateStart.set(e,t)}else this.rotateStart.set(dt[0].pageX,dt[0].pageY)}handleTouchStartPan(){if(dt.length===2){let e=.5*(dt[0].pageX+dt[1].pageX),t=.5*(dt[0].pageY+dt[1].pageY);this.panStart.set(e,t)}else this.panStart.set(dt[0].pageX,dt[0].pageY)}handleTouchStartDolly(){let e=dt[0].pageX-dt[1].pageX,t=dt[0].pageY-dt[1].pageY,i=Math.sqrt(e*e+t*t);this.dollyStart.set(0,i)}handleTouchStartDollyPan(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enablePan&&this.handleTouchStartPan()}handleTouchStartDollyRotate(){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchStartDolly(),this.enableRotate&&this.handleTouchStartRotate()}handleTouchMoveRotate(e){if(dt.length===2){let i=hb(e),n=.5*(e.pageX+i.x),r=.5*(e.pageY+i.y);this.rotateEnd.set(n,r)}else{if(e.pointerId!==dt[0].pointerId)return;this.rotateEnd.set(e.pageX,e.pageY)}this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart).multiplyScalar(this.rotateSpeed);let t=this.domElement;t&&(this.rotateLeft(2*Math.PI*this.rotateDelta.x/t.clientHeight),this.rotateUp(2*Math.PI*this.rotateDelta.y/t.clientHeight)),this.rotateStart.copy(this.rotateEnd)}handleTouchMovePan(e){if(dt.length===2){let t=hb(e),i=.5*(e.pageX+t.x),n=.5*(e.pageY+t.y);this.panEnd.set(i,n)}else{if(e.pointerId!==dt[0].pointerId)return;this.panEnd.set(e.pageX,e.pageY)}this.panDelta.subVectors(this.panEnd,this.panStart).multiplyScalar(this.panSpeed),this.pan(this.panDelta.x,this.panDelta.y),this.panStart.copy(this.panEnd)}handleTouchMoveDolly(e){let t=hb(e),i=e.pageX-t.x,n=e.pageY-t.y,r=Math.sqrt(i*i+n*n);this.dollyEnd.set(0,r),this.dollyDelta.set(0,Math.pow(this.dollyEnd.y/this.dollyStart.y,this.zoomSpeed)),this.dollyOut(this.dollyDelta.y),this.dollyStart.copy(this.dollyEnd)}handleTouchMoveDollyPan(e){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(e),this.enablePan&&this.handleTouchMovePan(e)}handleTouchMoveDollyRotate(e){this.enableZoom&&this.isTouchZoom===!0&&this.handleTouchMoveDolly(e),this.enableRotate&&this.handleTouchMoveRotate(e)}checkRaycastLock(){var e;if(this.object.data.raycastLock){if(this.options.isPlayMode)return!1;{let t=(e=this.options)==null?void 0:e.showCameraLock;return t&&t(),!0}}else return!1}};function Oa(e){let t=Math.PI*2;for(;e<=-Math.PI;)e+=t;for(;e>Math.PI;)e-=t;return e}function jD(e){return 1-Math.pow(1-e,4)}function dxe(e){return e.wheelDeltaY===0||e.deltaY===0?g2&&e.shiftKey&&Math.abs(e.wheelDeltaX)>=120?!1:e.wheelDeltaX?e.wheelDeltaX===-3*e.deltaX:e.deltaMode===0:e.wheelDeltaY?e.wheelDeltaY===-3*e.deltaY:e.deltaMode===0}var WD=class{constructor(e,t,i,n,r,s){this.id=e,this.data=t,this.object=i,this.currentIntersectedObjects=[],this.disabled=!1,this.actions=cs(t,t.actions,n,r,s,i),this.target=t.target,this.useToggle=t.toggle,this.triggeringObjects=t.triggeringObjects.map(a=>n.scene.find(a))}isValidTriggeringObject(e){return this.target==="all"?!0:this.triggeringObjects.some(t=>t===e||t.isAncestorOf(e.uuid)||e.isAncestorOf(t.uuid))}disconnect(){kr(this.actions)}dispatch(){this.disabled||(this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.object.dispatchEvent({type:"beginEvent",eventName:"Trigger"}),this.useToggle?(this.actions.Transition.forEach(e=>{e.toggle()}),this.actions.SwitchCamera.forEach(e=>{e.toggle()})):(this.actions.Transition.forEach(e=>{e.play()}),this.actions.SwitchCamera.forEach(e=>{e.play()})),this.actions.Link.forEach(e=>{e.dispatch()}),this.actions.Reset.forEach(e=>{e.dispatch()}),this.actions.Create.forEach(e=>{e.dispatch()}),this.actions.Destroy.forEach(e=>{e.dispatch(!1)}),this.actions.Audio.forEach(e=>{e.dispatchBasic()}),this.actions.Video.forEach(e=>{e.dispatchBasic()}),this.actions.SceneTransition.forEach(e=>{e.dispatch()}))}},zt;tue.then(e=>zt=e);var Wi=new T,Ys=new At,Dl=new T,uw=new bn(0,0,0,"YXZ"),XD=new bn(0,0,0,"XYZ"),Eo=new T,qD=new T,YD=new T(1,1,1),Vu=new At,dw=new ke,pxe=new ke,fxe={type:"updateMatrix"},VM={type:"beginEvent",eventName:"Collision"},mxe={type:"beginEvent",eventName:"Trigger"};function gxe(e){if(L0.physicsEnabled(e.scene.objects))return!0;let t=!1;return e.scene.objects.traverse((i,n)=>{if(n.events){if(Array.isArray(n.events)){for(let r of n.events)if(r.data.disabled!==!0&&r.data.type==="GameControl"&&r.data.collisionEnabled){t=!0;break}}else for(let r of Object.values(n.events))if(r.disabled!==!0&&r.type==="GameControl"&&r.collisionEnabled){t=!0;break}}}),t}var Sx=e=>e.states.some(t=>t.data.position!==void 0||t.data.rotation!==void 0||t.data.hiddenMatrix!==void 0||t.data.cloner!==void 0||t.data.pathSnapping!==void 0),vxe=class{constructor(e){this.eventContext=e,this.isEnabled=!1,this.gameControl=null,this.joysticks=[],this.joystickToGameControls=[],this.sharedGameControlGlobals={entitiesWithTransformAnim:[],entityToCollisionEvents:{},colliderToEntity:new Map,triggers:[],gamePads:[],createdObjects:[],nCreatedPerAction:{}},this.sensorToTriggerEvent={},this.eventManager=void 0,this.needsCollisionDetection=!1,this.initializationCounter=-1,this.rigidBodyToMesh=new Map,this.nActiveRigidBodies=0,this.collisionEvents=[],this.isExport=!1,this.processRigidBody=t=>{if(t.bodyType()!==zt.RigidBodyType.Dynamic)return;t.isSleeping()||this.nActiveRigidBodies++;let[i,n,r]=this.rigidBodyToMesh.get(t.handle);if(Wi.copy(t.translation()).multiplyScalar(this.pixelsPerMeter),Ys.copy(t.rotation()),i.matrixWorld.compose(Wi,Ys,n),i.hasNonUniformScale&&i.matrixWorld.multiply(i.shearScale),i.dispatchEvent(fxe),r){let s=i.cloner;if(s&&s.objectForSample===void 0){s.matrixWorld.copy(i.matrixWorld);for(let a of s.children)a.updateMatrixWorld(!0)}for(let a of i.children)a.updateMatrixWorld(!0)}},this.accumulator=0,this.handleCollisionEvents=(t,i,n)=>{var a,o,l,c;if(n===!1)return;let r,s;if(this.sensorToTriggerEvent[t]?(r=this.sensorToTriggerEvent[t],s=this.sharedGameControlGlobals.colliderToEntity.get(i)):this.sensorToTriggerEvent[i]&&(r=this.sensorToTriggerEvent[i],s=this.sharedGameControlGlobals.colliderToEntity.get(t)),r&&s&&r.isValidTriggeringObject(s)){r.dispatch();return}for(let u=this.sharedGameControlGlobals.createdObjects.length-1;u>=0;u--){let h=this.sharedGameControlGlobals.createdObjects[u];if(h.userData.hasCollisionDestroy&&(((a=h.rigidBody)==null?void 0:a.collider(0).handle)===t||((o=h.rigidBody)==null?void 0:o.collider(0).handle)===i)){this.sharedGameControlGlobals.createdObjects.splice(u,1),h.removeFromParent(),requestAnimationFrame(()=>{var d;return(d=this.sharedGameControlGlobals.rapierWorld)==null?void 0:d.removeRigidBody(h.rigidBody)});break}}if(((l=this.gameControl)==null?void 0:l.object)===this.sharedGameControlGlobals.colliderToEntity.get(t)){let u=this.sharedGameControlGlobals.colliderToEntity.get(i),h=this.sharedGameControlGlobals.entityToCollisionEvents[u.uuid];if(h===void 0)return;for(let d of h)d.data.target==="character"&&this.dispatchCollisionEvent(d,u,i)}else if(((c=this.gameControl)==null?void 0:c.object)===this.sharedGameControlGlobals.colliderToEntity.get(i)){let u=this.sharedGameControlGlobals.colliderToEntity.get(t),h=this.sharedGameControlGlobals.entityToCollisionEvents[u.uuid];if(h===void 0)return;for(let d of h)d.data.target==="character"&&this.dispatchCollisionEvent(d,u,t)}else{let u=this.sharedGameControlGlobals.colliderToEntity.get(t),h=this.sharedGameControlGlobals.entityToCollisionEvents[u.uuid];if(h!==void 0)for(let f of h)f.data.target==="scene"&&this.dispatchCollisionEvent(f,u,t);let d=this.sharedGameControlGlobals.colliderToEntity.get(i),p=this.sharedGameControlGlobals.entityToCollisionEvents[d==null?void 0:d.uuid];if(p!==void 0)for(let f of p)f.data.target==="scene"&&this.dispatchCollisionEvent(f,d,i)}},this.isExport=e.isExport,this.sharedAssets=e.sharedAssets,this.renderer=e.renderer,this.requestRender=e.requestRender,this.domElement=this.renderer.domElement,this.pixelsPerMeter=Dz,this.gravity=this.page.data.globalPhysics.gravity}get page(){return this.eventContext.page}attachVRControllers(e){e.forEach(t=>{t.addEventListener("connected",i=>{"gamepad"in i.data&&"axes"in i.data.gamepad&&this.sharedGameControlGlobals.gamePads.push(i.data.gamepad)})})}markIsDestroyTarget(){this.page.traverseVisibleEntity(e=>{var i,n;let t=e.dataPatched;for(let r of t.events){if(r.data.disabled===!0)continue;let s=(n=(i=r.data.actions)==null?void 0:i.find(a=>a.data.type==="Destroy"))==null?void 0:n.data;if(s)for(let a of s.objects){let o=this.page.scene.find(a);o&&(o.userData.hasDestroy=!0)}}})}markIsDragObject(){this.page.traverseVisibleEntity(e=>{let t=e.dataPatched;for(let i of t.events)if(!(i.data.disabled===!0||i.data.type!=="DragDrop"))for(let n of i.data.objects){let r=this.page.scene.find(n);r&&(r.userData.hasDrag=!0)}})}initBVH(){let e=[];if(this.page.traverseChildren(t=>{var o,l;let i;if(t instanceof ha)return;t instanceof Wn?i=t.object:i=t;let n=i.dataPatched;if(((o=n.physics)==null?void 0:o.enabled)==="visibility"?!n.visible:!((l=n.physics)!=null&&l.enabled))return!0;let r=t.geometry,s=i.userData.hasDestroy===!0,a=i.userData.hasDrag===!0;if(Sx(n)||s||a||i.dataPatched.events.some(c=>c.data.disabled!==!0&&c.data.type==="GameControl"))return t.updateMatrixWorldSVD(),this.addBoundsTree(t),!0;r&&e.push(jo(r,t.matrixWorld))}),e.length>0){let t=bh(e,!1);this.sharedGameControlGlobals.staticMeshBVH=new Hm(t)}}addRigidBody(e,t,i){let n=[],r="geometry"in e?e.geometry:void 0,s=t.dataPatched;if((r==null?void 0:r.getAttribute("position"))!==void 0&&n.push(jo(r,e.shearScale)),s.physics.fusedBody){let a=this.gatherChildrenGeom(e,n);e.traverseObject(a),e.children.forEach(l=>l.updateMatrixWorld(!0));let o=e.cloner;o&&o.objectForSample===void 0&&s.physics.rigidBody==="dynamic"&&(o.traverseObject(a),o.children.forEach(l=>l.updateMatrixWorld(!0)))}if(n.length>0){let a,o=!i.fromCreate&&s.physics.rigidBody==="dynamic"||i.fromCreate&&i.dynamic;o?(a=zt.RigidBodyDesc.dynamic(),a.setLinearDamping(s.physics.damping).setAngularDamping(s.physics.damping).setAdditionalMass(1e-9).setGravityScale(s.physics.gravityScale).enabledRotations(...s.physics.enabledRotation).enabledTranslations(...s.physics.enabledTranslation)):(i.hasTransformAnim||i.hasFollow||i.hasDrag)&&!i.fromCreate?(a=zt.RigidBodyDesc.kinematicPositionBased(),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e)):a=zt.RigidBodyDesc.fixed();let l=bh(n);(e.hasNonUniformScale?e.matrixWorldRigid:e.matrixWorld).decompose(Wi,Ys,Dl),e.position0=Wi.clone().divideScalar(this.pixelsPerMeter),e.rotation0=Ys.clone(),Wi.divideScalar(this.pixelsPerMeter),a.setTranslation(Wi.x,Wi.y,Wi.z).setRotation(Ys),r?l==null||l.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter):l==null||l.scale(Dl.x/this.pixelsPerMeter,Dl.y/this.pixelsPerMeter,Dl.z/this.pixelsPerMeter);let c=this.sharedGameControlGlobals.rapierWorld.createRigidBody(a);o&&this.rigidBodyToMesh.set(c.handle,[e,Dl.clone(),s.physics.fusedBody]);let u=!(s.geometry===void 0||s.geometry.type==="SubdivGeometry"||s.geometry.type==="NonParametricGeometry"||s.geometry.type==="BooleanGeometry"||s.geometry.type==="VectorGeometry"||s.geometry.type==="StarGeometry"||s.geometry.type==="RectangleGeometry"||s.geometry.type==="EllipseGeometry"||s.geometry.type==="TriangleGeometry"||s.geometry.type==="TorusGeometry"||s.geometry.type==="HelixGeometry");try{this.addCollider(c,s.physics,l,t,u)}catch{try{this.addCollider(c,s.physics,l,t,!1)}catch(h){console.error(h)}}e.rigidBody=c}}addBoundsTree(e){var i;let t=[];if(((i=e.geometry)==null?void 0:i.getAttribute("position"))!==void 0&&t.push(jo(e.geometry,e.shearScale)),e.traverseObject(this.gatherChildrenGeom(e,t)),e.children.forEach(n=>n.updateMatrixWorld(!0)),t.length>0){let n=bh(t,!1);e.bvhGeometry=n,e.bvhGeometry.boundsTree=new Hm(n),this.sharedGameControlGlobals.entitiesWithTransformAnim.push(e)}}addCollider(e,t,i,n,r=!0){var o,l;if((i==null?void 0:i.getAttribute("position").count)===0||((o=i==null?void 0:i.getIndex())==null?void 0:o.count)===0)return;let s;i&&(t.colliderType==="trimesh"?s=zt.ColliderDesc.trimesh(i.getAttribute("position").array,i.getIndex().array):s=zt.ColliderDesc.convexMesh(i.getAttribute("position").array,r?i.getIndex().array:void 0)),s.setFrictionCombineRule(zt.CoefficientCombineRule.Average).setRestitutionCombineRule(zt.CoefficientCombineRule.Average).setDensity(t.density).setFriction(t.friction).setRestitution(t.restitution);let a=this.sharedGameControlGlobals.rapierWorld.createCollider(s,e);this.sharedGameControlGlobals.colliderToEntity.set(a.handle,n),(l=this.sharedGameControlGlobals.entityToCollisionEvents[n.uuid])!=null&&l.some(c=>c.target==="scene")&&a.setActiveEvents(zt.ActiveEvents.COLLISION_EVENTS)}gatherChildrenGeom(e,t){return(i,n)=>{var o;if(n===0)return;let r;if(i instanceof ha)if(i.objectForSample){if(i.objectForSample.dataPatched.physics.fusedBody)return;r=i.object}else return i.object.dataPatched.physics.fusedBody===!0&&i.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(i instanceof Wn)r=i.object;else if(r=i,(o=r.dataPatched.cloner)==null?void 0:o.hideBase)return!0;let s=r.dataPatched;if(s.physics.enabled==="visibility"?!s.visible:!s.physics.enabled)return!0;n===1?e.hasNonUniformScale?i.matrixWorld.multiplyMatrices(e.shearScale,i.hiddenMatrix):i.matrixWorld.copy(i.hiddenMatrix):i.matrixWorld.multiplyMatrices(i.parent.matrixWorld,i.hiddenMatrix),i.matrixWorld.multiply(i.matrix);let a=i.geometry;(a==null?void 0:a.getAttribute("position"))!==void 0&&t.push(jo(a,i.matrixWorld))}}activate(e){var d,p;if(this.isEnabled)return;this.isEnabled=!0,this.eventManager=e,this.usePhysics=this.page.data.globalPhysics.usePhysics;let t=this.page.playCamera,i=!1,n=5,r=8,s=9,a="drag",o=this.page.data.publish.gameControlObject,l=o!==null?this.page.find(o):null,c=null;if(l)for(let f of l.data.events){if(f.data.disabled||f.data.type!=="GameControl")break;let v=l;for(;this.usePhysics&&((d=v=v.parent)==null?void 0:d.parent)!==null&&!((p=v.data.physics)!=null&&p.fusedBody););f.data.collisionEnabled&&(this.needsCollisionDetection=!0),c===null&&(c=f.data)}if(l&&c){i=i||c.camera===t.uuid||l.uuid===t.uuid;let f=new Lz(l,this.renderer.domElement,c,this.eventContext.page.data.globalPhysics,this,l.uuid!==t.uuid&&c.camera===t.uuid,t,this.page,this.sharedAssets);this.gameControl=f,n=c.joystickPosLoc,r=c.joystickRotLoc,s=c.jumpTouchButtonLoc,a=c.rotByTouch,ts&&c.touchControl&&(this.joystickToGameControls[n]="pos",c.moveMode==="walk"&&(this.joystickToGameControls[s]="jmp"),a==="joystick"&&(this.joystickToGameControls[r]="rot"))}if(this.gameControl&&this.gameControl.data.navmesh.enabled){let f=this.gameControl.data;if(!this.navigationMeshWrapper){this.navigationMeshWrapper=new ixe(this.usePhysics,this.isExport);let v;f.collider.type==="sphere"?v=f.collider.radius*2:v=f.collider.height,v=Math.floor(v/f.navmesh.ch-1),this.navigationMeshWrapper.init({...f.navmesh,walkableHeight:v},this.gameControl,this.eventContext)}}if(i===!1){let{enableRotate:f,enablePan:v,enableZoom:m,autoRotate:g,hoverRotatePanMode:y}=this.eventManager.publish.orbitControls;(f||v||m||g||y!==0)&&(this.orbitControls=new kz(t,this.renderer.domElement,{isExport:this.isExport,isPlayMode:!0}),this.orbitControls.addEventListener("change",this.requestRender),this.orbitControls.addEventListener("end",this.requestRender),this.orbitControls.addEventListener("start",this.requestRender),this.orbitControls.fromJSON(this.eventManager.publish.orbitControls,this.eventManager.publish.mouseEventTarget),this.orbitControls.useKeyEvents=!1,this.orbitControls.addEventListenersToCamera(),this.orbitControls.connect(),this.orbitControls.update())}let u=this.renderer.domElement.width/this.renderer.getPixelRatio(),h=this.renderer.domElement.height/this.renderer.getPixelRatio();this.joystickToGameControls.forEach((f,v)=>{let m=document.body.appendChild(document.createElement("div")),[g,y,x]=this.eventManager.eventContext.publish.joystickSizeAndXYOffset[v],_=(u-5*g)/4+g,b={},w=f==="jmp",M=w?0:g;v<10?(v<5?b.top=M/2:b.bottom=M/2,b.left=M/2+v%5*_):v===10?(b.left=M/2,b.top=h/2):(b.right=M/2,b.top=h/2),b.top?b.top-=y[1]:b.bottom+=y[1],b.left?b.left+=y[0]:b.right-=y[0];for(let E in b)b[E]+="px";if(w){let E=m.appendChild(document.createElement("div"));Object.assign(E.style,b,{position:"absolute",width:g+"px",height:g+"px",backgroundColor:`rgba(255,255,255,${x==="show"?.4:0})`,zIndex:"9999",borderRadius:g+"px",border:x==="show"?"solid 2px rgba(0, 0, 0, .1)":"none",display:"flex",alignItems:"center",justifyContent:"center",touchAction:"none"});let P=g/16*16*.4;x==="show"&&(E.innerHTML=`
						<svg width="${P}" height="${g*.4}" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path d="M2 10L8 4L14 10" stroke="black" stroke-opacity="40%" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
						</svg>
					`),E.addEventListener("pointerdown",()=>{this.gameControl.movementState.jump=1,this.requestRender()}),E.addEventListener("touchend",I=>I.preventDefault()),this.joysticks[v]=[void 0,m];return}let S={zone:m,mode:"static",position:b,size:g};x==="hide"&&(S.restOpacity=0);let C=B1e.create(S);C.on("move",(E,P)=>{let I=this.gameControl;f==="pos"?P.force<.2?I.moveForce=0:(I.movementState.movePosZ=Math.sin(-P.angle.radian),I.movementState.movePosX=Math.cos(-P.angle.radian),P.force>1.2?I.movementState.run=1:I.movementState.run=0,P.force<.3?I.moveForce=(P.force-.2)/.1:I.moveForce=1):f==="rot"&&(P.force<.2?I.rotForce=0:(I.movementState.rotPosX=P.vector.y,I.movementState.rotPosY=-P.vector.x,P.force<.3?I.rotForce=(P.force-.2)/.1:I.rotForce=1)),this.requestRender()}),C.on("end",(E,P)=>{let I=this.gameControl;f==="pos"?(I.movementState.movePosZ=0,I.movementState.movePosX=0,I.moveForce=1):f==="rot"&&(I.movementState.rotPosX=0,I.movementState.rotPosY=0,I.rotForce=1)}),this.joysticks[v]=[C,m]}),this.markIsDestroyTarget(),this.markIsDragObject(),this.rebuildBVH(),this.initializationCounter++,window.setTimeout(()=>{this.collisionEvents.forEach(f=>f.disabled=!1)},80)}initPhysics(){var a;(a=this.sharedGameControlGlobals.rapierWorld)==null||a.free(),this.sharedGameControlGlobals.rapierWorld=new zt.World(new zt.Vector3(0,this.gravity,0)),this.events=new zt.EventQueue(!0);let e=[],t=[];if(this.page.traverseChildren(o=>{var g,y,x,_;let l;if(o instanceof ha)if(o.objectForSample){if(o.objectForSample.dataPatched.physics.fusedBody)return;l=o.object}else return o.object.dataPatched.physics.fusedBody===!0&&o.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(o instanceof Wn)l=o.object;else if(l=o,((g=l.dataPatched.cloner)==null?void 0:g.disabled)===!1&&((y=l.dataPatched.cloner)==null?void 0:y.hideBase)&&((x=l.dataPatched.physics)==null?void 0:x.fusedBody)!==!0)return!0;let c=l.dataPatched,u;for(let b of c.events)b.data.disabled!==!0&&b.data.type==="GameControl"&&(u=b.data);if(!c.physics||(c.physics.enabled==="visibility"?!c.visible:!c.physics.enabled))return!0;o.updateMatrixWorldSVD();let h=Sx(c),d=!1,p=l.userData.hasDestroy,f=l.userData.hasDrag,v=!1;for(let b of c.events)if(b.data.disabled!==!0){if(b.data.type==="Collision"){d=!0;let w=new qye(b.id,b.data,l,this.page,this.sharedAssets,this.eventManager);w.disabled=!0,this.collisionEvents.push(w),this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid]&&this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid].every(M=>M.id!==b.id)?this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid].push(w):this.sharedGameControlGlobals.entityToCollisionEvents[l.uuid]=[w]}else if(b.data.type==="Follow"){v=!0;let w=b.data.target;o.traverseVisible(M=>{M.userData.isFollowingObj=w})}}c.physics.rigidBody==="dynamic"&&c.physics.fusedBody===!1&&(o.matrixWorldFusedFalse=o.matrixWorld.clone());let m=o.geometry;if(u!==void 0){let b=zt.RigidBodyDesc.kinematicPositionBased();(o.hasNonUniformScale?o.matrixWorldRigid:o.matrixWorld).decompose(Wi,Ys,Dl),o.position0=Wi.clone().divideScalar(this.pixelsPerMeter),o.rotation0=Ys.clone(),Wi.divideScalar(this.pixelsPerMeter),b.setTranslation(Wi.x,Wi.y,Wi.z).setRotation(Ys);let w=this.sharedGameControlGlobals.rapierWorld.createRigidBody(b);o.rigidBody=w;let M;u.collider.type==="sphere"?M=zt.ColliderDesc.ball(u.collider.radius/this.pixelsPerMeter):u.collider.type==="capsule"?M=zt.ColliderDesc.capsule((u.collider.height/2-u.collider.radius)/this.pixelsPerMeter,u.collider.radius/this.pixelsPerMeter):M=zt.ColliderDesc.cuboid(u.collider.width/this.pixelsPerMeter/2,u.collider.height/this.pixelsPerMeter/2,u.collider.depth/this.pixelsPerMeter/2),M.setFrictionCombineRule(zt.CoefficientCombineRule.Average).setRestitutionCombineRule(zt.CoefficientCombineRule.Average).setDensity(c.physics.density).setFriction(c.physics.friction).setRestitution(c.physics.restitution);let S=this.sharedGameControlGlobals.rapierWorld.createCollider(M,w);this.sharedGameControlGlobals.colliderToEntity.set(S.handle,l),Wi.fromArray(u.collider.position).multiply(Dl.setFromMatrixScale(l.matrixWorld)).divideScalar(this.pixelsPerMeter),S.setTranslationWrtParent(Wi);let C=new At().setFromEuler(new bn().setFromVector3(new T().fromArray(u.collider.rotation)));S.setRotationWrtParent(C),S.setActiveEvents(zt.ActiveEvents.COLLISION_EVENTS),this.generateSensorColliderDescs(l,!0)}else c.physics.rigidBody==="dynamic"||h||v||p||f||d?(this.addRigidBody(o,l,{hasFollow:v,hasTransformAnim:h,hasDrag:f}),this.generateSensorColliderDescs(l,c.physics.fusedBody)):(m&&e.push(jo(m,o.matrixWorld)),c.physics.fusedBody&&o.traverseObject((b,w)=>{var E;if(w===0)return;let M;if(b instanceof ha)if(b.objectForSample){if(b.objectForSample.dataPatched.physics.fusedBody)return;M=b.object}else return b.object.dataPatched.physics.fusedBody===!0&&b.object.dataPatched.physics.rigidBody==="dynamic"?!0:void 0;else if(b instanceof Wn)M=b.object;else if(M=b,(E=M.dataPatched.cloner)==null?void 0:E.hideBase)return!0;let S=M.dataPatched;if(S.physics.enabled==="visibility"?!S.visible:!S.physics.enabled)return!0;let C=b.geometry;(C==null?void 0:C.getAttribute("position"))!==void 0&&e.push(jo(C,b.matrixWorld))}),this.generateSensorColliderDescs(l,c.physics.fusedBody,t));if(((_=c.physics)==null?void 0:_.fusedBody)===!0||u)return!0}),e.length===0)return;let i=bh(e);i.scale(1/this.pixelsPerMeter,1/this.pixelsPerMeter,1/this.pixelsPerMeter);let n=zt.RigidBodyDesc.fixed(),r=this.sharedGameControlGlobals.rapierWorld.createRigidBody(n),s=zt.ColliderDesc.trimesh(i.getAttribute("position").array,i.getIndex().array).setFrictionCombineRule(zt.CoefficientCombineRule.Multiply).setRestitutionCombineRule(zt.CoefficientCombineRule.Multiply).setFriction(1).setRestitution(1);this.sharedGameControlGlobals.rapierWorld.createCollider(s,r);for(let[o,l]of t){let c=this.sharedGameControlGlobals.rapierWorld.createCollider(o,r);this.sensorToTriggerEvent[c.handle]=l}}updatePositions(){return this.nActiveRigidBodies=0,this.sharedGameControlGlobals.rapierWorld.forEachRigidBody(this.processRigidBody),this.nActiveRigidBodies>0}rebuildBVH(){this.usePhysics?(this.gameControl===null||this.needsCollisionDetection)&&this.initPhysics():(this.page.traverseEntity(e=>{for(let t of e.dataPatched.events)if(t.data.type==="Trigger"&&t.data.disabled!==!0){let i=new WD(t.id,t.data,e,this.page,this.sharedAssets,this.eventManager),n=new ke().compose(Eo.fromArray(t.data.position),Vu.setFromEuler(XD.fromArray(t.data.rotation)),YD);if(t.data.triggerZone==="box"){let r=new Vi;r.min.fromArray(t.data.size).multiplyScalar(-.5),r.max.fromArray(t.data.size).multiplyScalar(.5),this.sharedGameControlGlobals.triggers.push([r,n,e,i])}else this.sharedGameControlGlobals.triggers.push([t.data.radius,n,e,i])}}),this.needsCollisionDetection&&this.initBVH())}disconnectEvents(){this.collisionEvents.forEach(e=>e.disconnect()),this.sharedGameControlGlobals.triggers.forEach(e=>e[3].disconnect()),this.sharedGameControlGlobals.triggers.length=0}deactivate(){var e,t,i,n;if(this.isEnabled){this.isEnabled=!1,this.page.traverse(r=>{let s=r;s.matrixWorldFusedFalse&&(s.matrixWorldFusedFalse=void 0),s.rigidBody&&(s.rigidBody=void 0),s.position0&&(s.position0=void 0),s.rotation0&&(s.rotation0=void 0)}),(e=this.sharedGameControlGlobals.rapierWorld)==null||e.free(),this.sharedGameControlGlobals.rapierWorld=void 0,this.sharedGameControlGlobals.staticMeshBVH=void 0,this.accumulator=0,this.sharedGameControlGlobals.entitiesWithTransformAnim=[],this.disconnectEvents(),(t=this.gameControl)==null||t.reset(),(i=this.gameControl)==null||i.dispose(),this.gameControl=null,this.initializationCounter=-1,this.joysticks.forEach(([r,s])=>{r==null||r.destroy(),s.remove()}),this.joystickToGameControls=[],this.joysticks=[],this.orbitControls&&(this.orbitControls.dispose(),this.orbitControls=void 0),(n=this.navigationMeshWrapper)==null||n.dispose(),this.navigationMeshWrapper=void 0;for(let r of Object.values(this.sharedGameControlGlobals.entityToCollisionEvents))r.forEach(s=>s.disconnect());this.sharedGameControlGlobals.entityToCollisionEvents={},this.page.updateMatrixWorld(!0)}}update(e,t,i){if(!this.isEnabled)return!0;let n=!0;if(this.orbitControls!==void 0&&this.orbitControls.needsUpdate&&(n=!this.orbitControls.update()),this.initializationCounter>=0&&this.initializationCounter<2?(this.initializationCounter++,n=!1):this.initializationCounter===2&&this.gameControl&&(n=!this.gameControl.update(e,t,i)&&n),this.usePhysics){let r=.016666666666666666;if(e===0)n=this.stepPhysics()&&n;else{let s=e/1e3;s<r&&s>r*.55&&(s=r),this.accumulator+=s;let a=performance.now(),o=0,l=6;for(;this.accumulator>=r&&o<l&&(n=this.stepPhysics()&&n,this.accumulator-=r,o++,!(performance.now()-a>r*1e3)););this.accumulator=this.accumulator%r}}return n}stepPhysics(){var e;for(let t of this.sharedGameControlGlobals.entitiesWithTransformAnim){(t.hasNonUniformScale?t.matrixWorldRigid:t.matrixWorld).decompose(Wi,Ys,Dl),uw.setFromQuaternion(Ys);let i=t;i.prevR===void 0?(i.prevR=uw.clone(),i.prevT=Wi.clone()):(i.prevR.copy(uw),i.prevT.copy(Wi)),t.rigidBody&&(t.rigidBody.setNextKinematicTranslation(Wi.divideScalar(this.pixelsPerMeter)),t.rigidBody.setNextKinematicRotation(Ys))}return this.sharedGameControlGlobals.rapierWorld.step(this.events),(e=this.events)==null||e.drainCollisionEvents(this.handleCollisionEvents),!this.updatePositions()}dispatchCollisionEvent(e,t,i){var s;let n=((s=this.sharedGameControlGlobals.rapierWorld)==null?void 0:s.getCollider(i))._parent,r;if(t.cloner){for(let a of t.cloner.children)if(a.rigidBody===n){r=a;break}}e.dispatch(r),t.dispatchEvent(VM)}updateUseWindowEvents(e){var t;(t=this.orbitControls)==null||t.updateUseWindowEvents(e)}generateSensorColliderDescs(e,t,i){let n=pxe.copy(e.matrixWorld).invert();e.traverseEntity((r,s)=>{if(t===!1&&s===1)return!0;for(let a of r.dataPatched.events)if(a.data.type==="Trigger"&&a.data.disabled!==!0){let o=new WD(a.id,a.data,r,this.page,this.sharedAssets,this.eventManager),l;if(a.data.triggerZone==="box"?l=zt.ColliderDesc.cuboid(...a.data.size.map(c=>c/(2*this.pixelsPerMeter))):l=zt.ColliderDesc.ball(a.data.radius/this.pixelsPerMeter),l.setDensity(0).setSensor(!0).setActiveEvents(zt.ActiveEvents.COLLISION_EVENTS),Eo.fromArray(a.data.position),Vu.setFromEuler(XD.fromArray(a.data.rotation)),dw.compose(Eo,Vu,YD).premultiply(r.matrixWorld),i?(dw.decompose(Eo,Vu,qD),l.setActiveCollisionTypes(zt.ActiveCollisionTypes.KINEMATIC_FIXED|zt.ActiveCollisionTypes.DYNAMIC_FIXED)):(dw.premultiply(n).decompose(Eo,Vu,qD),e.rigidBody.bodyType()===zt.RigidBodyType.Dynamic||(e.rigidBody.bodyType()===zt.RigidBodyType.Fixed?l.setActiveCollisionTypes(zt.ActiveCollisionTypes.KINEMATIC_FIXED|zt.ActiveCollisionTypes.DYNAMIC_FIXED):l.setActiveCollisionTypes(zt.ActiveCollisionTypes.KINEMATIC_KINEMATIC|zt.ActiveCollisionTypes.DYNAMIC_KINEMATIC))),Eo.divideScalar(this.pixelsPerMeter),l.setTranslation(Eo.x,Eo.y,Eo.z),l.setRotation(Vu),i)i.push([l,o]);else{let c=this.sharedGameControlGlobals.rapierWorld.createCollider(l,e.rigidBody);this.sensorToTriggerEvent[c.handle]=o}}})}};function yxe(e){let t=this._clip.duration,i=this._clip.start??0,n=this.loop,r=this.time+e,s=this._loopCount,a=n===xE;if(e===0)return s===-1?r:a&&(s&1)===1?t-(r-i):r;if(n===CB){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),r>=t||r<i){let o=Math.floor((r-i)/(t-i));r-=(t-i)*o,s+=Math.abs(o);let l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,a||(r=e>0?t:i,this.repetitions===1&&(r=t)),this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){let c=e<0;this._setEndings(c,!c,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=r;if(a&&(s&1)===1)return t-(r-i)}return r}var ZD=!1,xxe=class{constructor(e,t,i,n){this.scene=e,this.requestRender=t,this.updateDisplayProgress=i,this.animationInspectorState=n,this.clipIdToAction={},this.activeClip=null,this.needsUpdate=!1,this.addClip=r=>{r.data.type==="Empty"&&r.data.animations&&r.data.animations.forEach((s,a)=>{let o=s[0]+"/";if(Array.isArray(r.identity)?o+=r.identity[0]:o+=r.uuid,this.clipIdToAction[o])return;let l=fS.parse(JSON.parse(s[2]));r.animations[a]=l;let c=this.mixer.clipAction(l,r);ZD===!1&&(Object.getPrototypeOf(c)._updateTime=yxe,ZD=!0),c.clampWhenFinished=!0,this.clipIdToAction[o]=c})},this.mixer=new xie(e),this.scene.traverseEntity(this.addClip)}deleteClip(e,t){let i=this.scene.find(t);if(!i)return;let n=i.animations.find(s=>s.uuid===e);if(!n)return;let r=this.clipIdToAction[e];!r||(r.stop(),this.mixer.uncacheClip(n),delete this.clipIdToAction[e],i.animations=i.animations.filter(s=>s.uuid!==e))}get isPlaying(){return Object.values(this.clipIdToAction).some(e=>e.isRunning())}playFromInspector(e){this.mixer.stopAllAction();let t=this.clipIdToAction[e];!t||(t.play(),this.activeClip=t.getClip(),this.requestRender())}onExitPlayMode(){Object.values(this.clipIdToAction).forEach(e=>{e.repetitions=1/0,e.loop=EB}),this.mixer.stopAllAction(),this.requestRender()}play(e){let t=e.clipId+"/"+e.object,i=this.clipIdToAction[t];if(i)return e&&(e.repeat>=0&&(i.repetitions=e.repeat+1),e.direction==="pingpong"&&e.repeat!==0&&(i.loop=xE)),i.play(),i.paused=!1,this.requestRender(),i}resumeFromInspector(e){let t=this.clipIdToAction[e];!t||(t.play(),t.paused=!1,this.requestRender())}pauseFromInspector(e){let t=this.clipIdToAction[e];!t||(t.paused=!0)}stop(){this.mixer.stopAllAction(),this.requestRender()}update(e){var t;if(this.needsUpdate)this.needsUpdate=!1;else if(this.isPlaying===!1||(t=this.animationInspectorState)!=null&&t.isScrubbing)return;this.mixer.update(e/1e3),this.activeClip&&this.updateDisplayProgress(Math.round(this.mixer.time/this.activeClip.duration*this.maxFrames%this.maxFrames)),this.requestRender()}get maxFrames(){var e,t;return((t=(e=this.activeClip)==null?void 0:e.tracks[0])==null?void 0:t.times.length)??0}setProgressFromInspector(e,t){if(!this.clipIdToAction[t])return;this.activeClip!==this.clipIdToAction[t].getClip()&&this.playFromInspector(t);let i=this.clipIdToAction[t].paused;this.clipIdToAction[t].paused=!1,this.mixer.setTime(Math.min(this.maxFrames?e/this.maxFrames:0,.9999)*this.activeClip.duration),this.requestRender(),i&&(this.clipIdToAction[t].paused=!0)}},pw=new WeakMap,_xe=class extends IE{constructor(e){super(e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(e){return this.decoderPath=e,this}setDecoderConfig(e){return this.decoderConfig=e,this}setWorkerLimit(e){return this.workerLimit=e,this}load(e,t,i,n){let r=new mS(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(e,s=>{this.decodeDracoFile(s,t).catch(n)},i,n)}decodeDracoFile(e,t,i,n){let r={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:n||this.defaultAttributeTypes,useUniqueIDs:!!i};return this.decodeGeometry(e,r).then(t)}decodeGeometry(e,t){let i=JSON.stringify(t);if(pw.has(e)){let o=pw.get(e);if(o.key===i)return o.promise;if(e.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let n,r=this.workerNextTaskID++,s=e.byteLength,a=this._getWorker(r,s).then(o=>(n=o,new Promise((l,c)=>{n._callbacks[r]={resolve:l,reject:c},n.postMessage({type:"decode",id:r,taskConfig:t,buffer:e},[e])}))).then(o=>this._createGeometry(o.geometry));return a.catch(()=>!0).then(()=>{n&&r&&this._releaseTask(n,r)}),pw.set(e,{key:i,promise:a}),a}_createGeometry(e){let t=new mt;e.index&&t.setIndex(new gt(e.index.array,1));for(let i=0;i<e.attributes.length;i++){let n=e.attributes[i],r=n.name,s=n.array,a=n.itemSize;t.setAttribute(r,new gt(s,a))}return t}_loadLibrary(e,t){let i=new mS(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise((n,r)=>{i.load(e,n,void 0,r)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;let e=typeof WebAssembly!="object"||this.decoderConfig.type==="js",t=[];return e?t.push(this._loadLibrary("draco_decoder.js","text")):(t.push(this._loadLibrary("draco_wasm_wrapper.js","text")),t.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(t).then(i=>{let n=i[0];e||(this.decoderConfig.wasmBinary=i[1]);let r=bxe.toString(),s=["/* draco decoder */",n,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([s]))}),this.decoderPending}_getWorker(e,t){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){let n=new Worker(this.workerSourceURL);n._callbacks={},n._taskCosts={},n._taskLoad=0,n.postMessage({type:"init",decoderConfig:this.decoderConfig}),n.onmessage=function(r){let s=r.data;switch(s.type){case"decode":n._callbacks[s.id].resolve(s);break;case"error":n._callbacks[s.id].reject(s);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+s.type+'"')}},this.workerPool.push(n)}else this.workerPool.sort(function(n,r){return n._taskLoad>r._taskLoad?-1:1});let i=this.workerPool[this.workerPool.length-1];return i._taskCosts[e]=t,i._taskLoad+=t,i})}_releaseTask(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}debug(){console.log("Task load: ",this.workerPool.map(e=>e._taskLoad))}dispose(){for(let e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}};function bxe(){let e,t;onmessage=function(a){let o=a.data;switch(o.type){case"init":e=o.decoderConfig,t=new Promise(function(u){e.onModuleLoaded=function(h){u({draco:h})},DracoDecoderModule(e)});break;case"decode":let l=o.buffer,c=o.taskConfig;t.then(u=>{let h=u.draco,d=new h.Decoder,p=new h.DecoderBuffer;p.Init(new Int8Array(l),l.byteLength);try{let f=i(h,d,p,c),v=f.attributes.map(m=>m.array.buffer);f.index&&v.push(f.index.array.buffer),self.postMessage({type:"decode",id:o.id,geometry:f},v)}catch(f){console.error(f),self.postMessage({type:"error",id:o.id,error:f.message})}finally{h.destroy(p),h.destroy(d)}});break}};function i(a,o,l,c){let u=c.attributeIDs,h=c.attributeTypes,d,p,f=o.GetEncodedGeometryType(l);if(f===a.TRIANGULAR_MESH)d=new a.Mesh,p=o.DecodeBufferToMesh(l,d);else if(f===a.POINT_CLOUD)d=new a.PointCloud,p=o.DecodeBufferToPointCloud(l,d);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!p.ok()||d.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+p.error_msg());let v={index:null,attributes:[]};for(let m in u){let g=self[h[m]],y,x;if(c.useUniqueIDs)x=u[m],y=o.GetAttributeByUniqueId(d,x);else{if(x=o.GetAttributeId(d,a[u[m]]),x===-1)continue;y=o.GetAttribute(d,x)}v.attributes.push(r(a,o,d,m,g,y))}return f===a.TRIANGULAR_MESH&&(v.index=n(a,o,d)),a.destroy(d),v}function n(a,o,l){let c=l.num_faces()*3,u=c*4,h=a._malloc(u);o.GetTrianglesUInt32Array(l,u,h);let d=new Uint32Array(a.HEAPF32.buffer,h,c).slice();return a._free(h),{array:d,itemSize:1}}function r(a,o,l,c,u,h){let d=h.num_components(),p=l.num_points()*d,f=p*u.BYTES_PER_ELEMENT,v=s(a,u),m=a._malloc(f);o.GetAttributeDataArrayForAllPoints(l,h,v,f,m);let g=new u(a.HEAPF32.buffer,m,p).slice();return a._free(m),{name:c,array:g,itemSize:d}}function s(a,o){switch(o){case Float32Array:return a.DT_FLOAT32;case Int8Array:return a.DT_INT8;case Int16Array:return a.DT_INT16;case Int32Array:return a.DT_INT32;case Uint8Array:return a.DT_UINT8;case Uint16Array:return a.DT_UINT16;case Uint32Array:return a.DT_UINT32}}}var nc;function wxe(){return nc||(nc=new _xe,nc.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.2/").preload()),nc.decoderPending}async function Sxe(e){if(nc){let t={attributeIDs:nc.defaultAttributeIDs,attributeTypes:nc.defaultAttributeTypes,useUniqueIDs:!1},i;try{i=await nc.decodeGeometry(new Int8Array(e).buffer,t)}catch(n){console.error(n)}if(i)return{index:i.index?{array:i.index.array}:void 0,attributes:Object.entries(i.attributes).map(([n,r])=>({name:n,itemSize:r.itemSize,array:r.array}))}}return null}async function Mxe(e,t){let[i,n]=rU(LS.deserialize(new Uint8Array(e)));AU(i);let r=[];i.scene.objects.traverse((s,a)=>{a.type==="Mesh"&&a.geometry.type==="NonParametricGeometry"&&a.geometry.data.draco!==void 0&&r.push(a)}),r.length&&await wxe();for(let s of r){let a=await Sxe(Cn(s.geometry.data.draco));if(a){a.index&&(s.geometry.data.index={array:a.index.array,itemSize:1,normalized:!1,type:"Uint32Array"});let o={};a.attributes.forEach(({name:l,array:c,itemSize:u})=>{o[l]={array:c,itemSize:u,type:"Float32Array",normalized:!1}}),s.geometry.data.attributes=o,s.geometry.data.draco=void 0}}return t&&t(i),n.result().data}var Cxe=class{constructor(e,t,i,n,r,s,a){this.id=e,this.data=t,this.dataEvent=i,this.object=n,this.stage=!1,this.actions=cs(i,t.actions,r,s,a,n)}disconnect(){kr(this.actions)}dispatchIn(){this.actions.Audio.forEach(e=>e.dispatchBasic()),this.actions.Video.forEach(e=>e.dispatchBasic()),this.actions.Create.forEach(e=>e.dispatch()),this.actions.Destroy.forEach(e=>e.dispatch()),this.actions.Reset.forEach(e=>e.dispatch()),this.actions.Link.forEach(e=>e.dispatch()),this.actions.Transition.forEach(e=>{e.object.currentTransitionEvent!==this&&(e.object.currentTransitionEvent=this,e.init())}),this.actions.Transition.forEach(e=>e.toggle()),this.actions.Animation.forEach(e=>e.play()),this.actions.SwitchCamera.forEach(e=>e.play()),this.actions.SceneTransition.forEach(e=>e.dispatch())}dispatchOut(){this.actions.Transition.forEach(e=>{e.toggle()})}},Exe=class extends po{constructor(e,t){super(e),this.eventManager=t,this.breakpoints=[],this.helperResize=(i,n)=>{this.breakpoints.forEach(r=>{let s=BS.deviceToSize(r.data.size),a=r.dataEvent.orientation==="horizontal"?i:n,o;switch(r.data.operator){case"<":o=a<s[0];break;case">":o=a>s[0];break;case"<>":o=a>s[0]&&a<s[1];break}r.stage!==o&&(r.stage=o,r.stage?r.dispatchIn():r.dispatchOut())})},this.onResize=()=>{let{innerWidth:i,innerHeight:n}=window;this.helperResize(i,n)},this.onResizeObserver=new ResizeObserver(i=>{for(let n of i){let{width:r,height:s}=n.contentRect;this.helperResize(r,s)}})}connect(){let{page:e,sharedAssets:t,domElement:i,isExport:n,frame:r}=this.eventContext;n?window.addEventListener("resize",this.onResize):r.preset==="fullscreen"?this.onResizeObserver.observe(i):window.addEventListener("resize",this.onResize),e.traverseEntity(s=>{var a;if(!(!s.visible||!((a=s.data)!=null&&a.events.length)))for(let{data:o}of s.data.events)o.disabled||o.type==="Resize"&&o.breakpoints.forEach(({data:l,id:c})=>{try{let u=new Cxe(c,l,o,s,e,t,this.eventManager);this.breakpoints.push(u)}catch{}})})}disconnect(){let{isExport:e,frame:t}=this.eventContext;e?window.removeEventListener("resize",this.onResize):t.preset==="fullscreen"?this.onResizeObserver.disconnect():window.removeEventListener("resize",this.onResize),this.breakpoints.forEach(i=>{i.disconnect()}),this.breakpoints=[]}},QD=Object.keys(Nz).filter(e=>isNaN(Number(e))),Axe=class{constructor(e,t,i,n){this.publish=e,this.controlsManager=t,this.animationControls=i,this.eventContext=n,this.isEnabled=!1,this.activateCount=0,this.onResetRaycaster=()=>{this.eventContext.raycasterNeedsUpdate=!0},this.onTouchMovePreventScroll=r=>{(r.touches.length>1||this.preventTouchScroll)&&r.preventDefault()},this.onMouseWheelPreventScroll=r=>{this.preventScroll&&r.preventDefault()},this.stopRaycast=e.stopRaycast,this.preventScroll=e.preventScroll,this.preventTouchScroll=e.preventTouchScroll,this.hideCursor=e.hideCursor,this.requestRender=n.requestRender}activate(){if(this.isEnabled)return;this.isEnabled=!0,this.handlers={Spline:new gye(this.eventContext),Conditional:new Sye(this.eventContext,this),Start:new Xye(this.eventContext,this),Basic:new yye(this.eventContext,this),MouseHover:new Vye(this.eventContext,this),Scroll:new jye(this.eventContext,this),Follow:new Iye(this.eventContext,this),DragDrop:new Tye(this.eventContext,this),LookAt:new Fye(this.eventContext),Resize:new Exe(this.eventContext,this)};let{page:e,domElement:t,eventElement:i}=this.eventContext;this.hideCursor&&(t.style.cursor="none"),e.traverseEntity(n=>{n.addEventListener("requestRender",this.requestRender)}),Object.values(this.handlers).forEach(n=>n.connect()),QD.forEach(n=>{(Object.values(this.handlers).some(r=>r.domEventsNeeded.has(n))||n==="pointerdown"&&this.controlsManager.navigationMeshWrapper)&&(t.addEventListener(n,this.onResetRaycaster),i.addEventListener(n,this.onResetRaycaster))}),t.addEventListener("wheel",this.onMouseWheelPreventScroll),t.addEventListener("touchmove",this.onTouchMovePreventScroll),this.activateCount++}deactivate(){var i;if(!this.isEnabled)return;this.isEnabled=!1;let{page:e,domElement:t}=this.eventContext;t.style.cursor="",Object.values(this.handlers).forEach(n=>n.disconnect()),(i=this.controlsManager.gameControl)==null||i.disposeActions(),this.controlsManager.disconnectEvents(),e.traverseEntity(n=>{n.removeEventListener("requestRender",this.requestRender)}),QD.forEach(n=>{t.removeEventListener(n,this.onResetRaycaster)}),t.removeEventListener("touchmove",this.onTouchMovePreventScroll),t.removeEventListener("wheel",this.onMouseWheelPreventScroll),this.animationControls.onExitPlayMode()}get isPaused(){return this.isEnabled}pause(){this.deactivate()}resume(){this.activate()}reset(){this.deactivate(),this.activate(),this.controlsManager.page.updateMatrixWorld(!0),this.controlsManager.rebuildBVH()}updateUseWindowEvents(e){let t=this.isEnabled;t&&this.deactivate(),this.eventContext.useWindowEvents=e,t&&this.activate()}},Txe=class{constructor(e,t,i,n,r){this._aspect=1,this.enableResponsive=!1,this._renderer=e,this._camera=t,this._frameSize=new te().copy(i),this._editorSize=new te().copy(n),this._aspect=t.aspect,this._fov=r??t.fov}set frameSize(e){this._frameSize.copy(e)}updateRenderer(){!this._renderer||this._renderer.setSize(this._frameSize.x,this._frameSize.y)}updateViewport(){if(!this._renderer||!this._camera||this._camera.cameraType!=="PerspectiveCamera")return;let e=this._frameSize.x,t=this._frameSize.y,i=this._editorSize.y;this._aspect=e/t,t<=i&&(this._camera.zoom*=i/t),this._renderer.setViewport(0,0,e,t)}updateCamera(e=!0){if(this._camera)if(this._camera.cameraType==="PerspectiveCamera"){let t=this._frameSize.y,i=this._editorSize.y,n=this._fov;if(e&&t>i){let r=Pxe(t,1080,2160,1,15)/100;n*=t/i,n*=1-r}this._camera.aspect=this._aspect,this._camera.fov=n,this._camera.updateProjectionMatrix()}else this._camera.setViewplaneSize(this._frameSize.x,this._frameSize.y,this.enableResponsive)}setCamera(e){this._camera=e,this._aspect=e.aspect,this._fov=e.fov}revert(){let e=window.innerWidth,t=window.innerHeight;this._renderer&&(this._renderer.setViewport(0,0,e,t),this._renderer.setSize(e,t)),this._camera&&(this._camera.aspect=e/t,this._camera.fov=this._fov,this._camera.setViewplaneSize(e,t,this.enableResponsive),this._camera.updateProjectionMatrix())}};function Pxe(e,t,i,n,r){return(e-t)/(i-t)*(r-n)+n}var Dxe=class{get sharedAssets(){return this.shared}constructor(e,t={}){this.shared=new TA(e.shared,t),this.scene=new UA(e.scene,this.sharedAssets)}reset(e,t){this.scene.clearScene(),this.sharedAssets.reset(e.shared),this.scene.resetAfterClear(e.scene,this.sharedAssets)}resetPersonalCameraFromDocumentData(){for(let e of this.scene.children)e instanceof bc&&e.personalCamera.updateState(e.data.camera,{scene:this.scene,shared:this.shared})}dispose(){this.scene.dispose(),this.shared.dispose()}gc(){this.shared.geometryCache.startGc(),this.shared.geometryCache2.startGc(),this.scene.traverseEntity(e=>{e instanceof dr&&e.markGeometryAsReachable(this.shared)}),this.shared.geometryCache.endGc(),this.shared.geometryCache2.endGc()}},Lxe=class{constructor({x:e=10,y:t=10}){this._startTime=0;let i=document.getElementById("spe-perfs");i?this.element=i:(this.element=document.createElement("div"),document.body.appendChild(this.element),this.element.style.position="absolute",this.element.style.zIndex="10000",this.element.style.fontFamily="monospace",this.element.style.background="black",this.element.style.color="white",this.element.style.padding="10px",this.element.style.opacity="0.5",this.element.style.fontSize="11px",this.element.setAttribute("id","spe-perfs")),this.element.style.left=`${e}px`,this.element.style.top=`${t}px`}dispose(){var e;(e=this.element.parentElement)==null||e.removeChild(this.element)}start(){this._startTime=performance.now()}end(){let e=performance.now()-this._startTime;this.element.innerHTML=e.toFixed(3)+" ms"}};function Rxe(e){let t;if(e.index)for(let i=0;i<e.index.array.length;i+=3)t=e.index.array[i],e.index.array[i]=e.index.array[i+2],e.index.array[i+2]=t}function Km(e){return e instanceof U0?"SubdivObject":e.geometry.type==="NonParametricGeometry"?"NonParametric":"Mesh"}function Ixe(e,t){let i={};return e.traverseEntity(n=>{var l;if(!n.visible||!(n instanceof zr)||n.type!=="Mesh"||Array.isArray(n.material)||n.states&&Object.keys(n.states).length)return;let r=n.parent;for(;r;){if(r instanceof zr&&n.states&&Object.keys(n.states).length)return;r=r.parent}let s=n.material.uuid,a=t.shared.materials[s];if(a){if(!Xn.isMergable(a))return}else{let c=(l=t.scene.objects.get(n.uuid))==null?void 0:l.data;if(c&&"material"in c&&typeof c.material!="string"){if(!Xn.isMergable(c.material))return;s=Xn.getHash(c.material)}}i[s]||(i[s]={});let o=i[s][Km(n)];if(o){if(o.push(n),n.cloner)for(let c of n.cloner.children)o.push(c)}else if(i[s][Km(n)]=[n],n.cloner)for(let c of n.cloner.children)i[s][Km(n)].push(c)}),i}function Oxe(e){let t=0;return Object.values(e).forEach(i=>{Object.values(i).forEach(n=>{let r=n.length;r>t&&(t=r)})}),t}function Bxe(e,t){let i=Ixe(t,e),n=Oxe(i),r=new Array(n),s=0,a=new Array(n),o=0,l=new Array(n),c=0,u=new Array(n),h=0;for(let[d,p]of Object.entries(i))for(let f of Object.values(p)){if(o=0,c=0,f.forEach(m=>{m instanceof zr&&(a[o++]=m.geometry.clone(),l[c++]=m)}),c<2)continue;for(let m=0;m<c;m++)l[m].updateWorldMatrix(!0,!1),a[m].applyMatrix4(l[m].matrixWorld),l[m].matrixWorld.determinant()<0&&Rxe(a[m]);let v=bh(a.slice(0,o),!1);if(v){let m;switch(d){case"SubdivObject":{console.warn("Turning subdiv object into mesh"),m=new Ar(v,l[0].material);break}default:{m=new Ar(v,l[0].material);break}}m.castShadow=l[0].castShadow,m.receiveShadow=l[0].receiveShadow,t.add(m);let g=y=>{h=0;for(let x of y)x.children&&g(x.children),x instanceof zr&&(Array.isArray(x.material)||i[x.material.uuid]&&i[x.material.uuid][Km(x)]&&i[x.material.uuid][Km(x)].length>1||(u[h++]=x));for(let x=0;x<h;x++)t.attach(u[x])};for(let y=0;y<c;y++){let x=l[y];g(x.children),r[s++]=x}}}for(let d=0;d<s;d++)r[d].removeFromParent()}var Nxe=Gp(aZ(),1),Uxe=new te;function Fxe(e){let t="The Spline Runtime only accepts .splinecode files that are generated from Spline export panel.";e.endsWith(".spline")?console.warn(t+" The .spline files are only meant to be used by the Editor."):e.endsWith(".splinecode")||console.warn(t)}var zxe=class{constructor(e,{renderOnDemand:t,renderMode:i="auto"}={}){this._viewportMode=1,this._viewportWidth=window.innerWidth,this._viewportHeight=window.innerHeight,this._proxyObjectCache=new Map,this._isPaused=!1,this._renderRequested=!1,this._skipRender=!1,this.time=performance.now(),this.dt=0,this.currentTAAFrame=0,this.disposed=!1,this._requestRenderAutoMode=()=>{this._skipRender=!1},this.requestRender=()=>{this._renderRequested=!0},this.render=n=>{var r,s,a,o,l,c,u,h,d,p,f,v;if(this.time=n,this._lastTime&&(this.dt=this.time-this._lastTime),this._lastTime=this.time,(r=this._perfs)==null||r.start(),!this._renderer){(s=this._perfs)==null||s.end();return}if(!this._isPaused&&(this.renderMode==="manual"&&!this._renderRequested||this.renderMode==="auto"&&this._skipRender)){(a=this._perfs)==null||a.end();return}if(this._renderRequested=!1,this._skipRender=!0,this._controls&&(this._skipRender=this._controls.update(this.dt)),this._eventManager&&((o=this._eventManager.handlers)!=null&&o.Start.hasVideoAction||(l=this._eventManager.handlers)!=null&&l.Basic.hasVideoAction||(c=this._eventManager.handlers)!=null&&c.Conditional.hasVideoAction)&&(this._skipRender=!1),(u=this._animationControls)==null||u.update(this.dt),this._skipRender?(this.currentTAAFrame++,this.currentTAAFrame<32?this._skipRender=!1:this.currentTAAFrame=0):this.currentTAAFrame=0,this._scene&&this._scene.activeCamera!==this._camera&&(this._camera=this._scene.activeCamera),(h=this._eventManager)!=null&&h.isEnabled&&(((d=this._eventManager.handlers)==null?void 0:d.Follow).onAnimationFrameDamping(),((p=this._eventManager.handlers)==null?void 0:p.LookAt).onAnimationFrameDamping(),((f=this._eventManager.handlers)==null?void 0:f.DragDrop).onAnimationFrameDamping()),this._scene&&this._camera){if(this._scene.pathConstraints.applyConstraints(this._scene),this._renderer.sceneTransitionTimeRemaining>0){this._renderer.sceneTransitionTimeRemaining-=this.dt;let m=1-this._renderer.sceneTransitionTimeRemaining/this._renderer.sceneTransitionDuration;this._renderer.pipeline.sceneTransitionPass.uniforms.mixRatio.value=m,this._skipRender=!1}else this._renderer.pipeline.sceneTransitionFromTexture=null;this._renderer.renderSplineScene(this._scene,this._camera)}this.canvas.dispatchEvent(this._renderedEvent),(v=this._perfs)==null||v.end()},this._resize=()=>{var n,r,s,a,o,l,c,u,h,d;if(this._renderer){if(this._viewportMode===1&&this._frameView&&(this._frameView.frameSize=Uxe.set(this._viewportWidth,this._viewportHeight)),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._camera=(n=this._scene)==null?void 0:n.activeCamera,(c=this._scene)==null||c.updateViewPlaneSize(((s=(r=this._frameView)==null?void 0:r.frameSize)==null?void 0:s.x)??this._viewportWidth,((o=(a=this._frameView)==null?void 0:a.frameSize)==null?void 0:o.y)??this._viewportHeight,((l=this._frameView)==null?void 0:l.enableResponsive)??!1),this._camera){let p=Object.values(((u=this._data)==null?void 0:u.frames)??{})[0].preset??"fullscreen";(h=this._frameView)==null||h.setCamera(this._camera),(d=this._frameView)==null||d.updateCamera(p!=="fullscreen"),this._camera.cameraType==="PerspectiveCamera"&&(this._camera.aspect=this._viewportWidth/this._viewportHeight),this._camera.updateProjectionMatrix()}this._requestRenderAutoMode()}},this._debouncedResize=eA(this._resize,10),this.canvas=e,this.renderMode=t?"auto":i,this._renderedEvent=new CustomEvent("rendered",{bubbles:!0}),Object.defineProperty(this._renderedEvent,"target",{writable:!1,value:this}),window.location.search.includes("perfs")&&(this._perfs=new Lxe({x:10,y:10})),Khe(e)}async load(e,t){Fxe(e),this.disposed=!1;let i=await(await fetch(e,t)).arrayBuffer();await this.start(i)}async start(e,{interactive:t=!0}={}){var a,o,l;if(this.disposed)return;let i=await Mxe(e);this._data=i,i.version&&(0,Nxe.default)(i.version,"0.9.455")>0&&console.warn("Your .splinecode file is more recent than the library. Please upgrade @splinetool/runtime to the latest version."),await Promise.all([GP(i)&&mfe(),Nme(i)&&dfe(),L0.physicsEnabled(i.scene.objects)&&iue(),zP(i)&&Sme(),rxe(i)&&eue()].filter(Boolean)),(a=this._eventManager)==null||a.deactivate(),(o=this._controls)==null||o.deactivate(),(l=this._scene)==null||l.dispose();let n=new Dxe(i);if(n.resetPersonalCameraFromDocumentData(),this._scene=n.scene,this._sharedAssetsManager=n.sharedAssets,this._camera=this._scene.activeCamera,window.location.search.includes("merge-geometries")){let c=performance.now();Bxe(i,n.scene);let u=performance.now();console.log("Merged geometries in ",u-c," ms")}GP(i)&&this._scene.traverse(c=>{qa(c)&&c.recomputeBoolean()}),this._sharedAssetsManager.setRequestRender(()=>{var c;this._requestRenderAutoMode(),(c=this._scene)==null||c.traverse(u=>{u instanceof ha&&u.pendingMediaLoad&&u.update()})});let r=Object.keys(i.shared.fonts).map(c=>this._sharedAssetsManager.getFont(c).loadingPromise);Promise.all(r).then(()=>{n.scene.markNeedsUpdateRendererDirty(),this._requestRenderAutoMode()}),zP(i)&&gxe(i)&&await Promise.all(r),this._scene.rewriteEventsBeforeGoToPlayMode(),ZA(this._scene.activePage,this._sharedAssetsManager),this._renderer||(this._renderer=new u1e({canvas:this.canvas,antialias:!1,alpha:!0,stencil:!1,depth:!1,powerPreference:"high-performance"}),this._renderer.hdTransmission=i.scene.publish.hdTransmission===!0,this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.pipeline.addEventListener("smaaloaded",this._requestRenderAutoMode)),i.scene.blueNoiseTextureData!==void 0&&this._renderer.pipeline.updateBlueNoiseTexture(i.scene.blueNoiseTextureData);let s=Object.values(i.frames)[0];if(this._frameView?this._frameView.setCamera(this._camera):(s.preset==="fullscreen"?(this._viewportMode=1,this.canvas.style.display="block",this.canvas.parentElement&&(this._viewportWidth=this.canvas.parentElement.clientWidth||300,this.canvas.style.width="100%"),this.canvas.parentElement&&(this._viewportHeight=this.canvas.parentElement.clientHeight||150,this.canvas.style.height="100%")):(this._viewportMode=2,this._viewportWidth=s.size[0],this._viewportHeight=s.size[1],this.canvas.style.width=`${this._viewportWidth}px`,this.canvas.style.height=`${this._viewportHeight}px`),this._renderer.setSize(this._viewportWidth,this._viewportHeight,!1),this._frameView=new Txe(this._renderer,this._camera,new te(this._viewportWidth,this._viewportHeight),new te(window.innerWidth,window.innerHeight)),this._frameView.enableResponsive=(s.allowResponsive??!1)&&s.preset==="fullscreen"),t){let c=new fye(this._renderer,this.data.scene.publish,this._scene,()=>this._scene.activeCamera,this._sharedAssetsManager,this._requestRenderAutoMode,!0,s);this._scene.updateMatrixWorld(!0),this._controls=new vxe(c),this._animationControls=new xxe(this._scene,this._requestRenderAutoMode),this._eventManager=new Axe(i.scene.publish,this._controls,this._animationControls,c),this._eventManager.activate(),this._controls.activate(this._eventManager)}this._resize(),this.dt===0&&(this.render(performance.now()),setTimeout(()=>{var c;(c=this._renderer)==null||c.setAnimationLoop(this.render)},0)),this._resizeObserverTimeout=setTimeout(()=>{!this._resizeObserver&&this.canvas.parentElement&&(this._resizeObserver=new ResizeObserver(()=>{this._viewportWidth=this.canvas.clientWidth,this._viewportHeight=this.canvas.clientHeight,this._debouncedResize()}),this._resizeObserver.observe(this.canvas.parentElement))},300)}findObjectById(e){var i;let t=(i=this._scene)==null?void 0:i.getObjectByProperty("uuid",e);return this._createProxyObject(t)}findObjectByName(e){var i;let t=(i=this._scene)==null?void 0:i.getObjectByName(e);return this._createProxyObject(t)}getAllObjects(){var t;let e=[];return(t=this._scene)==null||t.traverseEntity(i=>{if(i.uuid!==rf&&!this._scene.isInvisibleObjects(i)&&!(i instanceof bc)){let n=this._createProxyObject(i);n&&e.push(n)}}),e}getSplineEvents(){var e,t;return((t=(e=this._eventManager)==null?void 0:e.handlers)==null?void 0:t.Spline).splineEvents}emitEvent(e,t){var i;(i=this.findObjectById(t)||this.findObjectByName(t))==null||i.emitEvent(e)}emitEventReverse(e,t){var i;(i=this.findObjectById(t)||this.findObjectByName(t))==null||i.emitEventReverse(e)}addEventListener(e,t){this.canvas.addEventListener(e,t)}removeEventListener(e,t){this.canvas.removeEventListener(e,t)}setZoom(e){var t,i;((t=this._controls)==null?void 0:t.orbitControls)instanceof kz&&((i=this._controls)==null||i.orbitControls.zoomOut(e))}get eventManager(){return this._eventManager}get controls(){return this._controls}setSize(e,t){this._viewportWidth=e,this._viewportHeight=t,this._viewportMode=2,this._resize()}setBackgroundColor(e){var a;let{r:t,g:i,b:n,a:r}={r:0,g:0,b:0,a:1},s=new Or(t,i,n,r);try{s.setStyle(e)}catch{console.error("This is not a valid css color",e)}(a=this._scene)==null||a.activePage.setBackgroundColor(s),this._requestRenderAutoMode()}dispose(){var e,t,i,n,r,s,a;this.disposed=!0,(e=this._eventManager)==null||e.deactivate(),(t=this._scene)==null||t.dispose(),(i=this._sharedAssetsManager)==null||i.dispose(),this._proxyObjectCache.forEach(o=>{b8.unsubscribe(o)}),(n=this._renderer)==null||n.setAnimationLoop(null),(r=this._renderer)==null||r.dispose(),this._renderer=void 0,(s=this._sharedAssetsManager)==null||s.dispose(),this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=void 0),this._resizeObserverTimeout!==void 0&&clearTimeout(this._resizeObserverTimeout),this.canvas.style.width="",this.canvas.style.height="",this.canvas.removeAttribute("width"),this.canvas.removeAttribute("height"),this._frameView&&(this._frameView=void 0),(a=this._controls)==null||a.deactivate(),$he(this.canvas)}get isStopped(){return this._isPaused}stop(){var e,t,i;this._isPaused||((e=this._renderer)==null||e.setAnimationLoop(null),this._isPaused=!0,(t=this._eventManager)==null||t.pause(),(i=this._controls)!=null&&i.orbitControls&&(this._controls.orbitControls.enabled=!1))}play(){var e,t,i;!this._isPaused||(this._isPaused=!1,(e=this._eventManager)==null||e.resume(),(t=this._controls)!=null&&t.orbitControls&&(this._controls.orbitControls.enabled=!0),(i=this._renderer)==null||i.setAnimationLoop(this.render))}setGlobalEvents(e){var t;(t=this._eventManager)==null||t.updateUseWindowEvents(e)}get data(){return this._data}_createProxyObject(e){var r;if(e==null)return;if(this._proxyObjectCache.has(e.uuid))return this._proxyObjectCache.get(e.uuid);let t;e.traverseAncestors(s=>{s instanceof bc&&(t=s.name)});let i={name:e.name,uuid:e.uuid,visible:e.visible,intensity:e.intensity,position:e.position,rotation:e.rotation,scale:e.scale,type:e.data.type,page:t,parentUuid:e.parent instanceof bc||e instanceof UA||(r=e.parent)==null?void 0:r.uuid,emitEvent(s){e.dispatchEvent({type:"userEvent",eventName:s})},emitEventReverse(s){e.dispatchEvent({type:"userEvent",eventName:s,reverse:!0})}},n=b8(i,(s,a)=>{var o;typeof e[s]!="object"&&((o=Object.getOwnPropertyDescriptor(e,s))!=null&&o.writable)&&(e[s]=a),this._requestRenderAutoMode(),e.updateMatrix()});return this._proxyObjectCache.set(e.uuid,n),n}},J1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},HM={},kxe={get exports(){return HM},set exports(e){HM=e}},Jf={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KD;function Vxe(){if(KD)return Jf;KD=1;var e=zp,t=Symbol.for("react.element"),i=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,r=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function a(o,l,c){var u,h={},d=null,p=null;c!==void 0&&(d=""+c),l.key!==void 0&&(d=""+l.key),l.ref!==void 0&&(p=l.ref);for(u in l)n.call(l,u)&&!s.hasOwnProperty(u)&&(h[u]=l[u]);if(o&&o.defaultProps)for(u in l=o.defaultProps,l)h[u]===void 0&&(h[u]=l[u]);return{$$typeof:t,type:o,key:d,ref:p,props:h,_owner:r.current}}return Jf.Fragment=i,Jf.jsx=a,Jf.jsxs=a,Jf}(function(e){e.exports=Vxe()})(kxe);const GM=HM.jsx;var Hxe="Expected a function",$D=0/0,Gxe="[object Symbol]",jxe=/^\s+|\s+$/g,Wxe=/^[-+]0x[0-9a-f]+$/i,Xxe=/^0b[01]+$/i,qxe=/^0o[0-7]+$/i,Yxe=parseInt,Zxe=typeof J1=="object"&&J1&&J1.Object===Object&&J1,Qxe=typeof self=="object"&&self&&self.Object===Object&&self,Kxe=Zxe||Qxe||Function("return this")(),$xe=Object.prototype,Jxe=$xe.toString,e2e=Math.max,t2e=Math.min,fw=function(){return Kxe.Date.now()};function i2e(e,t,i){var n,r,s,a,o,l,c=0,u=!1,h=!1,d=!0;if(typeof e!="function")throw new TypeError(Hxe);t=JD(t)||0,jM(i)&&(u=!!i.leading,h="maxWait"in i,s=h?e2e(JD(i.maxWait)||0,t):s,d="trailing"in i?!!i.trailing:d);function p(w){var M=n,S=r;return n=r=void 0,c=w,a=e.apply(S,M),a}function f(w){return c=w,o=setTimeout(g,t),u?p(w):a}function v(w){var M=w-l,S=w-c,C=t-M;return h?t2e(C,s-S):C}function m(w){var M=w-l,S=w-c;return l===void 0||M>=t||M<0||h&&S>=s}function g(){var w=fw();if(m(w))return y(w);o=setTimeout(g,v(w))}function y(w){return o=void 0,d&&n?p(w):(n=r=void 0,a)}function x(){o!==void 0&&clearTimeout(o),c=0,n=l=r=o=void 0}function _(){return o===void 0?a:y(fw())}function b(){var w=fw(),M=m(w);if(n=arguments,r=this,l=w,M){if(o===void 0)return f(l);if(h)return o=setTimeout(g,t),p(l)}return o===void 0&&(o=setTimeout(g,t)),a}return b.cancel=x,b.flush=_,b}function jM(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function n2e(e){return!!e&&typeof e=="object"}function r2e(e){return typeof e=="symbol"||n2e(e)&&Jxe.call(e)==Gxe}function JD(e){if(typeof e=="number")return e;if(r2e(e))return $D;if(jM(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=jM(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(jxe,"");var i=Xxe.test(e);return i||qxe.test(e)?Yxe(e.slice(2),i?2:8):Wxe.test(e)?$D:+e}var s2e=i2e;function a2e(e){return t=>{e.forEach(i=>{typeof i=="function"?i(t):i!=null&&(i.current=t)})}}const o2e=[],l2e={width:"100%",height:"100%"},c2e=ze.forwardRef(function({className:e,children:t,debounceTime:i=300,ignoreDimensions:n=o2e,parentSizeStyles:r,enableDebounceLeadingCall:s=!0,resizeObserverPolyfill:a,...o},l){const c=ze.useRef(null),u=ze.useRef(0),[h,d]=ze.useState({width:0,height:0,top:0,left:0}),p=ze.useMemo(()=>{const f=Array.isArray(n)?n:[n];return s2e(v=>{d(m=>Object.keys(m).filter(g=>m[g]!==v[g]).every(g=>f.includes(g))?m:v)},i,{leading:s})},[i,s,n]);return ze.useEffect(()=>{const f=a||window.ResizeObserver,v=new f(m=>{m.forEach(g=>{const{left:y,top:x,width:_,height:b}=(g==null?void 0:g.contentRect)??{};u.current=window.requestAnimationFrame(()=>{p({width:_,height:b,top:x,left:y})})})});return c.current&&v.observe(c.current),()=>{window.cancelAnimationFrame(u.current),v.disconnect(),p.cancel()}},[p,a]),GM("div",{style:{...l2e,...r},ref:a2e([l,c]),className:e,...o,children:t({...h,ref:c.current,resize:p})})}),h2e=ze.forwardRef(({scene:e,style:t,onMouseDown:i,onMouseUp:n,onMouseHover:r,onKeyDown:s,onKeyUp:a,onStart:o,onLookAt:l,onFollow:c,onWheel:u,onLoad:h,renderOnDemand:d=!0,...p},f)=>{const v=ze.useRef(null),[m,g]=ze.useState(!0);return ze.useEffect(()=>{g(!0);let y;const x=[{name:"mouseDown",cb:i},{name:"mouseUp",cb:n},{name:"mouseHover",cb:r},{name:"keyDown",cb:s},{name:"keyUp",cb:a},{name:"start",cb:o},{name:"lookAt",cb:l},{name:"follow",cb:c},{name:"scroll",cb:u}];if(v.current){y=new zxe(v.current,{renderOnDemand:d});async function _(){await y.load(e);for(let b of x)b.cb&&y.addEventListener(b.name,b.cb);g(!1),h==null||h(y)}_()}return()=>{for(let _ of x)_.cb&&y.removeEventListener(_.name,_.cb);y.dispose()}},[e]),GM(c2e,{ref:f,parentSizeStyles:t,debounceTime:50,...p,children:()=>GM("canvas",{ref:v,style:{display:m?"none":"block"}})})});function u2e(){return ee.jsx(h2e,{className:"border border-red-500",scene:"https://prod.spline.design/dpTC477hE8QyTukQ/scene.splinecode"})}const d2e={visible:{opacity:1,y:0,transition:{delay:.05}},hidden:{opacity:0,y:100}},p2e=1,f2e=2,e7={visible:e=>({opacity:1,x:0,transition:{delay:.2*e}}),hidden:{opacity:0,x:-100}};function m2e(){const[e,t]=useState({x:0,y:0}),i=n=>{const{clientX:r,clientY:s}=n;t({x:r,y:s})};return ze.useEffect(()=>{const n=document.querySelector(".background-element");return n&&n.addEventListener("mousemove",i),()=>{n&&n.removeEventListener("mousemove",i)}},[]),ee.jsxs("div",{className:"snap-start relative h-full w-full snap-y",children:[ee.jsx("img",{src:qx.boy,autoPlay:!0,loop:!0,muted:!0,className:"w-full absolute bottom-0 translate-y-[30%] h-[140px] lh-32 blur-sm"}),ee.jsxs("div",{className:" mt-32 flex flex-col min-h-[200vh] relative snap-start",children:[ee.jsx("style",{children:`
            .background-element {
              cursor: url('path/to/your-cursor-image.png') ${e.x}px ${e.y}px, auto;
            }
          `}),ee.jsx("div",{className:" w-[100%] h-[100%]  absolute z-[9999]",children:ee.jsx(u2e,{"events-target":"global",mousePosition:e})}),ee.jsxs("div",{className:"z-30 h-full -top-3 flex flex-col gap-[25vh]",children:[ee.jsx(XY,{}),ee.jsxs(cr.div,{variants:d2e,initial:"hidden",whileInView:"visible",className:"w-full flex flex-col justify-center items-center text-center  gap-6 ",children:[ee.jsx("h1",{className:"font-black text-4xl tablet:text-7xl max-w-[60%] tablet:max-w-[32.3125rem] text-transparent bg-clip-text bg-gradient-to-r from-[#F5D1FF] to-[#ffffff]  ",children:"The Universe Unveiled."}),ee.jsx("p",{className:"max-w-[30.6rem] text-[#FFD1D1] text-base font-extralight",children:"Discover the Hidden Wonders of the Cosmos - Dive into the Universe's Greatest Mysteries with Our A.I"})]}),ee.jsx("div",{className:" w-full h-full flex flex-col justify-end items-center",children:ee.jsxs("div",{children:[ee.jsx("p",{className:" font-semibold text-[10.79px] text-[#818B95]",children:"COMMUNITY-OWNED AND OPERATED"}),ee.jsxs("div",{className:" tablet:flex gap-24",children:[ee.jsx(cr.p,{variants:e7,initial:"hidden",whileInView:"visible",custom:p2e,className:" tracking-[-0.166875rem] max-w-[486px] font-extrabold text-[47.74px]",children:"Enter a new universe of connected services."}),ee.jsx(cr.p,{variants:e7,initial:"hidden",whileInView:"visible",custom:f2e,className:" font-extrabold text-[62.43px] tracking-[-3.55px]",children:"246+"})]})]})}),ee.jsxs("button",{className:"w-[80%] mx-auto flex gap-4  items-center ",children:[ee.jsxs("span",{className:"pb-1 font-semibold text-[20.33px]",children:["Powerful features"," "]}),ee.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:ee.jsx("path",{d:"M8.32641 15.1154L6.76619 13.5703L11.4393 8.89726H0.0860438V6.64024H11.4393L6.76619 1.97474L8.32641 0.422102L15.6731 7.76875L8.32641 15.1154Z",fill:"white"})})]})]})]})]})}/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const $A="156",Hu={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Gu={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},g2e=0,t7=1,v2e=2,Vz=1,y2e=2,No=3,Rc=0,Br=1,Ya=2,wc=0,lp=1,i7=2,n7=3,r7=4,x2e=5,dd=100,_2e=101,b2e=102,s7=103,a7=104,w2e=200,S2e=201,M2e=202,C2e=203,Hz=204,Gz=205,E2e=206,A2e=207,T2e=208,P2e=209,D2e=210,L2e=0,R2e=1,I2e=2,WM=3,O2e=4,B2e=5,N2e=6,U2e=7,jz=0,F2e=1,z2e=2,Sc=0,k2e=1,V2e=2,H2e=3,G2e=4,j2e=5,Wz=300,Op=301,Bp=302,XM=303,qM=304,P2=306,YM=1e3,ra=1001,ZM=1002,or=1003,o7=1004,mw=1005,As=1006,W2e=1007,k0=1008,Mc=1009,X2e=1010,q2e=1011,JA=1012,Xz=1013,rc=1014,sc=1015,V0=1016,qz=1017,Yz=1018,Oh=1020,Y2e=1021,sa=1023,Z2e=1024,Q2e=1025,Bh=1026,Np=1027,K2e=1028,Zz=1029,$2e=1030,Qz=1031,Kz=1033,gw=33776,vw=33777,yw=33778,xw=33779,l7=35840,c7=35841,h7=35842,u7=35843,J2e=36196,d7=37492,p7=37496,f7=37808,m7=37809,g7=37810,v7=37811,y7=37812,x7=37813,_7=37814,b7=37815,w7=37816,S7=37817,M7=37818,C7=37819,E7=37820,A7=37821,_w=36492,T7=36494,P7=36495,e_e=36283,D7=36284,L7=36285,R7=36286,$z=3e3,Nh=3001,t_e=3200,i_e=3201,Jz=0,n_e=1,Uh="",gi="srgb",lo="srgb-linear",D2="display-p3",bw=7680,r_e=519,s_e=512,a_e=513,o_e=514,l_e=515,c_e=516,h_e=517,u_e=518,d_e=519,I7=35044,O7="300 es",QM=1035,Ko=2e3,Mx=2001;class lu{addEventListener(t,i){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[t]===void 0&&(n[t]=[]),n[t].indexOf(i)===-1&&n[t].push(i)}hasEventListener(t,i){if(this._listeners===void 0)return!1;const n=this._listeners;return n[t]!==void 0&&n[t].indexOf(i)!==-1}removeEventListener(t,i){if(this._listeners===void 0)return;const r=this._listeners[t];if(r!==void 0){const s=r.indexOf(i);s!==-1&&r.splice(s,1)}}dispatchEvent(t){if(this._listeners===void 0)return;const n=this._listeners[t.type];if(n!==void 0){t.target=this;const r=n.slice(0);for(let s=0,a=r.length;s<a;s++)r[s].call(this,t);t.target=null}}}const Fn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let B7=1234567;const $m=Math.PI/180,H0=180/Math.PI;function lf(){const e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Fn[e&255]+Fn[e>>8&255]+Fn[e>>16&255]+Fn[e>>24&255]+"-"+Fn[t&255]+Fn[t>>8&255]+"-"+Fn[t>>16&15|64]+Fn[t>>24&255]+"-"+Fn[i&63|128]+Fn[i>>8&255]+"-"+Fn[i>>16&255]+Fn[i>>24&255]+Fn[n&255]+Fn[n>>8&255]+Fn[n>>16&255]+Fn[n>>24&255]).toLowerCase()}function Hn(e,t,i){return Math.max(t,Math.min(i,e))}function e4(e,t){return(e%t+t)%t}function p_e(e,t,i,n,r){return n+(e-t)*(r-n)/(i-t)}function f_e(e,t,i){return e!==t?(i-e)/(t-e):0}function Jm(e,t,i){return(1-i)*e+i*t}function m_e(e,t,i,n){return Jm(e,t,1-Math.exp(-i*n))}function g_e(e,t=1){return t-Math.abs(e4(e,t*2)-t)}function v_e(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t),e*e*(3-2*e))}function y_e(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t),e*e*e*(e*(e*6-15)+10))}function x_e(e,t){return e+Math.floor(Math.random()*(t-e+1))}function __e(e,t){return e+Math.random()*(t-e)}function b_e(e){return e*(.5-Math.random())}function w_e(e){e!==void 0&&(B7=e);let t=B7+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function S_e(e){return e*$m}function M_e(e){return e*H0}function KM(e){return(e&e-1)===0&&e!==0}function C_e(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function Cx(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function E_e(e,t,i,n,r){const s=Math.cos,a=Math.sin,o=s(i/2),l=a(i/2),c=s((t+n)/2),u=a((t+n)/2),h=s((t-n)/2),d=a((t-n)/2),p=s((n-t)/2),f=a((n-t)/2);switch(r){case"XYX":e.set(o*u,l*h,l*d,o*c);break;case"YZY":e.set(l*d,o*u,l*h,o*c);break;case"ZXZ":e.set(l*h,l*d,o*u,o*c);break;case"XZX":e.set(o*u,l*f,l*p,o*c);break;case"YXY":e.set(l*p,o*u,l*f,o*c);break;case"ZYZ":e.set(l*f,l*p,o*u,o*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function pd(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function er(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(e*4294967295);case Uint16Array:return Math.round(e*65535);case Uint8Array:return Math.round(e*255);case Int32Array:return Math.round(e*2147483647);case Int16Array:return Math.round(e*32767);case Int8Array:return Math.round(e*127);default:throw new Error("Invalid component type.")}}const A_e={DEG2RAD:$m,RAD2DEG:H0,generateUUID:lf,clamp:Hn,euclideanModulo:e4,mapLinear:p_e,inverseLerp:f_e,lerp:Jm,damp:m_e,pingpong:g_e,smoothstep:v_e,smootherstep:y_e,randInt:x_e,randFloat:__e,randFloatSpread:b_e,seededRandom:w_e,degToRad:S_e,radToDeg:M_e,isPowerOfTwo:KM,ceilPowerOfTwo:C_e,floorPowerOfTwo:Cx,setQuaternionFromProperEuler:E_e,normalize:er,denormalize:pd};class Pt{constructor(t=0,i=0){Pt.prototype.isVector2=!0,this.x=t,this.y=i}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,i){return this.x=t,this.y=i,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this}addScaledVector(t,i){return this.x+=t.x*i,this.y+=t.y*i,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const i=this.x,n=this.y,r=t.elements;return this.x=r[0]*i+r[3]*n+r[6],this.y=r[1]*i+r[4]*n+r[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this}clampScalar(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this}clampLength(t,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const i=Math.sqrt(this.lengthSq()*t.lengthSq());if(i===0)return Math.PI/2;const n=this.dot(t)/i;return Math.acos(Hn(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const i=this.x-t.x,n=this.y-t.y;return i*i+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this}lerpVectors(t,i,n){return this.x=t.x+(i.x-t.x)*n,this.y=t.y+(i.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,i=0){return this.x=t[i],this.y=t[i+1],this}toArray(t=[],i=0){return t[i]=this.x,t[i+1]=this.y,t}fromBufferAttribute(t,i){return this.x=t.getX(i),this.y=t.getY(i),this}rotateAround(t,i){const n=Math.cos(i),r=Math.sin(i),s=this.x-t.x,a=this.y-t.y;return this.x=s*n-a*r+t.x,this.y=s*r+a*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ut{constructor(t,i,n,r,s,a,o,l,c){Ut.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],t!==void 0&&this.set(t,i,n,r,s,a,o,l,c)}set(t,i,n,r,s,a,o,l,c){const u=this.elements;return u[0]=t,u[1]=r,u[2]=o,u[3]=i,u[4]=s,u[5]=l,u[6]=n,u[7]=a,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const i=this.elements,n=t.elements;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],this}extractBasis(t,i,n){return t.setFromMatrix3Column(this,0),i.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const i=t.elements;return this.set(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,i){const n=t.elements,r=i.elements,s=this.elements,a=n[0],o=n[3],l=n[6],c=n[1],u=n[4],h=n[7],d=n[2],p=n[5],f=n[8],v=r[0],m=r[3],g=r[6],y=r[1],x=r[4],_=r[7],b=r[2],w=r[5],M=r[8];return s[0]=a*v+o*y+l*b,s[3]=a*m+o*x+l*w,s[6]=a*g+o*_+l*M,s[1]=c*v+u*y+h*b,s[4]=c*m+u*x+h*w,s[7]=c*g+u*_+h*M,s[2]=d*v+p*y+f*b,s[5]=d*m+p*x+f*w,s[8]=d*g+p*_+f*M,this}multiplyScalar(t){const i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=t,i[4]*=t,i[7]*=t,i[2]*=t,i[5]*=t,i[8]*=t,this}determinant(){const t=this.elements,i=t[0],n=t[1],r=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],u=t[8];return i*a*u-i*o*c-n*s*u+n*o*l+r*s*c-r*a*l}invert(){const t=this.elements,i=t[0],n=t[1],r=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],u=t[8],h=u*a-o*c,d=o*l-u*s,p=c*s-a*l,f=i*h+n*d+r*p;if(f===0)return this.set(0,0,0,0,0,0,0,0,0);const v=1/f;return t[0]=h*v,t[1]=(r*c-u*n)*v,t[2]=(o*n-r*a)*v,t[3]=d*v,t[4]=(u*i-r*l)*v,t[5]=(r*s-o*i)*v,t[6]=p*v,t[7]=(n*l-c*i)*v,t[8]=(a*i-n*s)*v,this}transpose(){let t;const i=this.elements;return t=i[1],i[1]=i[3],i[3]=t,t=i[2],i[2]=i[6],i[6]=t,t=i[5],i[5]=i[7],i[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const i=this.elements;return t[0]=i[0],t[1]=i[3],t[2]=i[6],t[3]=i[1],t[4]=i[4],t[5]=i[7],t[6]=i[2],t[7]=i[5],t[8]=i[8],this}setUvTransform(t,i,n,r,s,a,o){const l=Math.cos(s),c=Math.sin(s);return this.set(n*l,n*c,-n*(l*a+c*o)+a+t,-r*c,r*l,-r*(-c*a+l*o)+o+i,0,0,1),this}scale(t,i){return this.premultiply(ww.makeScale(t,i)),this}rotate(t){return this.premultiply(ww.makeRotation(-t)),this}translate(t,i){return this.premultiply(ww.makeTranslation(t,i)),this}makeTranslation(t,i){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,i,0,0,1),this}makeRotation(t){const i=Math.cos(t),n=Math.sin(t);return this.set(i,-n,0,n,i,0,0,0,1),this}makeScale(t,i){return this.set(t,0,0,0,i,0,0,0,1),this}equals(t){const i=this.elements,n=t.elements;for(let r=0;r<9;r++)if(i[r]!==n[r])return!1;return!0}fromArray(t,i=0){for(let n=0;n<9;n++)this.elements[n]=t[n+i];return this}toArray(t=[],i=0){const n=this.elements;return t[i]=n[0],t[i+1]=n[1],t[i+2]=n[2],t[i+3]=n[3],t[i+4]=n[4],t[i+5]=n[5],t[i+6]=n[6],t[i+7]=n[7],t[i+8]=n[8],t}clone(){return new this.constructor().fromArray(this.elements)}}const ww=new Ut;function ek(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}function G0(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function T_e(){const e=G0("canvas");return e.style.display="block",e}const N7={};function e0(e){e in N7||(N7[e]=!0,console.warn(e))}function cp(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function Sw(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}const P_e=new Ut().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),D_e=new Ut().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]);function L_e(e){return e.convertSRGBToLinear().applyMatrix3(D_e)}function R_e(e){return e.applyMatrix3(P_e).convertLinearToSRGB()}const I_e={[lo]:e=>e,[gi]:e=>e.convertSRGBToLinear(),[D2]:L_e},O_e={[lo]:e=>e,[gi]:e=>e.convertLinearToSRGB(),[D2]:R_e},Zs={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(e){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!e},get workingColorSpace(){return lo},set workingColorSpace(e){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,i){if(this.enabled===!1||t===i||!t||!i)return e;const n=I_e[t],r=O_e[i];if(n===void 0||r===void 0)throw new Error(`Unsupported color space conversion, "${t}" to "${i}".`);return r(n(e))},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}};let ju;class tk{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let i;if(t instanceof HTMLCanvasElement)i=t;else{ju===void 0&&(ju=G0("canvas")),ju.width=t.width,ju.height=t.height;const n=ju.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),i=ju}return i.width>2048||i.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),i.toDataURL("image/jpeg",.6)):i.toDataURL("image/png")}static sRGBToLinear(t){if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap){const i=G0("canvas");i.width=t.width,i.height=t.height;const n=i.getContext("2d");n.drawImage(t,0,0,t.width,t.height);const r=n.getImageData(0,0,t.width,t.height),s=r.data;for(let a=0;a<s.length;a++)s[a]=cp(s[a]/255)*255;return n.putImageData(r,0,0),i}else if(t.data){const i=t.data.slice(0);for(let n=0;n<i.length;n++)i instanceof Uint8Array||i instanceof Uint8ClampedArray?i[n]=Math.floor(cp(i[n]/255)*255):i[n]=cp(i[n]);return{data:i,width:t.width,height:t.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let B_e=0;class ik{constructor(t=null){this.isSource=!0,Object.defineProperty(this,"id",{value:B_e++}),this.uuid=lf(),this.data=t,this.version=0}set needsUpdate(t){t===!0&&this.version++}toJSON(t){const i=t===void 0||typeof t=="string";if(!i&&t.images[this.uuid]!==void 0)return t.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let a=0,o=r.length;a<o;a++)r[a].isDataTexture?s.push(Mw(r[a].image)):s.push(Mw(r[a]))}else s=Mw(r);n.url=s}return i||(t.images[this.uuid]=n),n}}function Mw(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?tk.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let N_e=0;class Nr extends lu{constructor(t=Nr.DEFAULT_IMAGE,i=Nr.DEFAULT_MAPPING,n=ra,r=ra,s=As,a=k0,o=sa,l=Mc,c=Nr.DEFAULT_ANISOTROPY,u=Uh){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:N_e++}),this.uuid=lf(),this.name="",this.source=new ik(t),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=s,this.minFilter=a,this.anisotropy=c,this.format=o,this.internalFormat=null,this.type=l,this.offset=new Pt(0,0),this.repeat=new Pt(1,1),this.center=new Pt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ut,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof u=="string"?this.colorSpace=u:(e0("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=u===Nh?gi:Uh),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const i=t===void 0||typeof t=="string";if(!i&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),i||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==Wz)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case YM:t.x=t.x-Math.floor(t.x);break;case ra:t.x=t.x<0?0:1;break;case ZM:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case YM:t.y=t.y-Math.floor(t.y);break;case ra:t.y=t.y<0?0:1;break;case ZM:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return e0("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===gi?Nh:$z}set encoding(t){e0("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=t===Nh?gi:Uh}}Nr.DEFAULT_IMAGE=null;Nr.DEFAULT_MAPPING=Wz;Nr.DEFAULT_ANISOTROPY=1;class xi{constructor(t=0,i=0,n=0,r=1){xi.prototype.isVector4=!0,this.x=t,this.y=i,this.z=n,this.w=r}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,i,n,r){return this.x=t,this.y=i,this.z=n,this.w=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this.w=t.w+i.w,this}addScaledVector(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this.w+=t.w*i,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this.w=t.w-i.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const i=this.x,n=this.y,r=this.z,s=this.w,a=t.elements;return this.x=a[0]*i+a[4]*n+a[8]*r+a[12]*s,this.y=a[1]*i+a[5]*n+a[9]*r+a[13]*s,this.z=a[2]*i+a[6]*n+a[10]*r+a[14]*s,this.w=a[3]*i+a[7]*n+a[11]*r+a[15]*s,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const i=Math.sqrt(1-t.w*t.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/i,this.y=t.y/i,this.z=t.z/i),this}setAxisAngleFromRotationMatrix(t){let i,n,r,s;const l=t.elements,c=l[0],u=l[4],h=l[8],d=l[1],p=l[5],f=l[9],v=l[2],m=l[6],g=l[10];if(Math.abs(u-d)<.01&&Math.abs(h-v)<.01&&Math.abs(f-m)<.01){if(Math.abs(u+d)<.1&&Math.abs(h+v)<.1&&Math.abs(f+m)<.1&&Math.abs(c+p+g-3)<.1)return this.set(1,0,0,0),this;i=Math.PI;const x=(c+1)/2,_=(p+1)/2,b=(g+1)/2,w=(u+d)/4,M=(h+v)/4,S=(f+m)/4;return x>_&&x>b?x<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(x),r=w/n,s=M/n):_>b?_<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(_),n=w/r,s=S/r):b<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(b),n=M/s,r=S/s),this.set(n,r,s,i),this}let y=Math.sqrt((m-f)*(m-f)+(h-v)*(h-v)+(d-u)*(d-u));return Math.abs(y)<.001&&(y=1),this.x=(m-f)/y,this.y=(h-v)/y,this.z=(d-u)/y,this.w=Math.acos((c+p+g-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this.w=Math.max(t.w,Math.min(i.w,this.w)),this}clampScalar(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this.z=Math.max(t,Math.min(i,this.z)),this.w=Math.max(t,Math.min(i,this.w)),this}clampLength(t,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this.w+=(t.w-this.w)*i,this}lerpVectors(t,i,n){return this.x=t.x+(i.x-t.x)*n,this.y=t.y+(i.y-t.y)*n,this.z=t.z+(i.z-t.z)*n,this.w=t.w+(i.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,i=0){return this.x=t[i],this.y=t[i+1],this.z=t[i+2],this.w=t[i+3],this}toArray(t=[],i=0){return t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t[i+3]=this.w,t}fromBufferAttribute(t,i){return this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this.w=t.getW(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class U_e extends lu{constructor(t=1,i=1,n={}){super(),this.isRenderTarget=!0,this.width=t,this.height=i,this.depth=1,this.scissor=new xi(0,0,t,i),this.scissorTest=!1,this.viewport=new xi(0,0,t,i);const r={width:t,height:i,depth:1};n.encoding!==void 0&&(e0("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),n.colorSpace=n.encoding===Nh?gi:Uh),this.texture=new Nr(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.internalFormat=n.internalFormat!==void 0?n.internalFormat:null,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:As,this.depthBuffer=n.depthBuffer!==void 0?n.depthBuffer:!0,this.stencilBuffer=n.stencilBuffer!==void 0?n.stencilBuffer:!1,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null,this.samples=n.samples!==void 0?n.samples:0}setSize(t,i,n=1){(this.width!==t||this.height!==i||this.depth!==n)&&(this.width=t,this.height=i,this.depth=n,this.texture.image.width=t,this.texture.image.height=i,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,t,i),this.scissor.set(0,0,t,i)}clone(){return new this.constructor().copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.scissor.copy(t.scissor),this.scissorTest=t.scissorTest,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.isRenderTargetTexture=!0;const i=Object.assign({},t.texture.image);return this.texture.source=new ik(i),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,t.depthTexture!==null&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Qh extends U_e{constructor(t=1,i=1,n={}){super(t,i,n),this.isWebGLRenderTarget=!0}}class nk extends Nr{constructor(t=null,i=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:i,height:n,depth:r},this.magFilter=or,this.minFilter=or,this.wrapR=ra,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class F_e extends Nr{constructor(t=null,i=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:i,height:n,depth:r},this.magFilter=or,this.minFilter=or,this.wrapR=ra,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Kh{constructor(t=0,i=0,n=0,r=1){this.isQuaternion=!0,this._x=t,this._y=i,this._z=n,this._w=r}static slerpFlat(t,i,n,r,s,a,o){let l=n[r+0],c=n[r+1],u=n[r+2],h=n[r+3];const d=s[a+0],p=s[a+1],f=s[a+2],v=s[a+3];if(o===0){t[i+0]=l,t[i+1]=c,t[i+2]=u,t[i+3]=h;return}if(o===1){t[i+0]=d,t[i+1]=p,t[i+2]=f,t[i+3]=v;return}if(h!==v||l!==d||c!==p||u!==f){let m=1-o;const g=l*d+c*p+u*f+h*v,y=g>=0?1:-1,x=1-g*g;if(x>Number.EPSILON){const b=Math.sqrt(x),w=Math.atan2(b,g*y);m=Math.sin(m*w)/b,o=Math.sin(o*w)/b}const _=o*y;if(l=l*m+d*_,c=c*m+p*_,u=u*m+f*_,h=h*m+v*_,m===1-o){const b=1/Math.sqrt(l*l+c*c+u*u+h*h);l*=b,c*=b,u*=b,h*=b}}t[i]=l,t[i+1]=c,t[i+2]=u,t[i+3]=h}static multiplyQuaternionsFlat(t,i,n,r,s,a){const o=n[r],l=n[r+1],c=n[r+2],u=n[r+3],h=s[a],d=s[a+1],p=s[a+2],f=s[a+3];return t[i]=o*f+u*h+l*p-c*d,t[i+1]=l*f+u*d+c*h-o*p,t[i+2]=c*f+u*p+o*d-l*h,t[i+3]=u*f-o*h-l*d-c*p,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,i,n,r){return this._x=t,this._y=i,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,i){const n=t._x,r=t._y,s=t._z,a=t._order,o=Math.cos,l=Math.sin,c=o(n/2),u=o(r/2),h=o(s/2),d=l(n/2),p=l(r/2),f=l(s/2);switch(a){case"XYZ":this._x=d*u*h+c*p*f,this._y=c*p*h-d*u*f,this._z=c*u*f+d*p*h,this._w=c*u*h-d*p*f;break;case"YXZ":this._x=d*u*h+c*p*f,this._y=c*p*h-d*u*f,this._z=c*u*f-d*p*h,this._w=c*u*h+d*p*f;break;case"ZXY":this._x=d*u*h-c*p*f,this._y=c*p*h+d*u*f,this._z=c*u*f+d*p*h,this._w=c*u*h-d*p*f;break;case"ZYX":this._x=d*u*h-c*p*f,this._y=c*p*h+d*u*f,this._z=c*u*f-d*p*h,this._w=c*u*h+d*p*f;break;case"YZX":this._x=d*u*h+c*p*f,this._y=c*p*h+d*u*f,this._z=c*u*f-d*p*h,this._w=c*u*h-d*p*f;break;case"XZY":this._x=d*u*h-c*p*f,this._y=c*p*h-d*u*f,this._z=c*u*f+d*p*h,this._w=c*u*h+d*p*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return i!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,i){const n=i/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const i=t.elements,n=i[0],r=i[4],s=i[8],a=i[1],o=i[5],l=i[9],c=i[2],u=i[6],h=i[10],d=n+o+h;if(d>0){const p=.5/Math.sqrt(d+1);this._w=.25/p,this._x=(u-l)*p,this._y=(s-c)*p,this._z=(a-r)*p}else if(n>o&&n>h){const p=2*Math.sqrt(1+n-o-h);this._w=(u-l)/p,this._x=.25*p,this._y=(r+a)/p,this._z=(s+c)/p}else if(o>h){const p=2*Math.sqrt(1+o-n-h);this._w=(s-c)/p,this._x=(r+a)/p,this._y=.25*p,this._z=(l+u)/p}else{const p=2*Math.sqrt(1+h-n-o);this._w=(a-r)/p,this._x=(s+c)/p,this._y=(l+u)/p,this._z=.25*p}return this._onChangeCallback(),this}setFromUnitVectors(t,i){let n=t.dot(i)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*i.z-t.z*i.y,this._y=t.z*i.x-t.x*i.z,this._z=t.x*i.y-t.y*i.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(Hn(this.dot(t),-1,1)))}rotateTowards(t,i){const n=this.angleTo(t);if(n===0)return this;const r=Math.min(1,i/n);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,i){const n=t._x,r=t._y,s=t._z,a=t._w,o=i._x,l=i._y,c=i._z,u=i._w;return this._x=n*u+a*o+r*c-s*l,this._y=r*u+a*l+s*o-n*c,this._z=s*u+a*c+n*l-r*o,this._w=a*u-n*o-r*l-s*c,this._onChangeCallback(),this}slerp(t,i){if(i===0)return this;if(i===1)return this.copy(t);const n=this._x,r=this._y,s=this._z,a=this._w;let o=a*t._w+n*t._x+r*t._y+s*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=a,this._x=n,this._y=r,this._z=s,this;const l=1-o*o;if(l<=Number.EPSILON){const p=1-i;return this._w=p*a+i*this._w,this._x=p*n+i*this._x,this._y=p*r+i*this._y,this._z=p*s+i*this._z,this.normalize(),this._onChangeCallback(),this}const c=Math.sqrt(l),u=Math.atan2(c,o),h=Math.sin((1-i)*u)/c,d=Math.sin(i*u)/c;return this._w=a*h+this._w*d,this._x=n*h+this._x*d,this._y=r*h+this._y*d,this._z=s*h+this._z*d,this._onChangeCallback(),this}slerpQuaternions(t,i,n){return this.copy(t).slerp(i,n)}random(){const t=Math.random(),i=Math.sqrt(1-t),n=Math.sqrt(t),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(i*Math.cos(r),n*Math.sin(s),n*Math.cos(s),i*Math.sin(r))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,i=0){return this._x=t[i],this._y=t[i+1],this._z=t[i+2],this._w=t[i+3],this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._w,t}fromBufferAttribute(t,i){return this._x=t.getX(i),this._y=t.getY(i),this._z=t.getZ(i),this._w=t.getW(i),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class fe{constructor(t=0,i=0,n=0){fe.prototype.isVector3=!0,this.x=t,this.y=i,this.z=n}set(t,i,n){return n===void 0&&(n=this.z),this.x=t,this.y=i,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this}addScaledVector(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this}applyEuler(t){return this.applyQuaternion(U7.setFromEuler(t))}applyAxisAngle(t,i){return this.applyQuaternion(U7.setFromAxisAngle(t,i))}applyMatrix3(t){const i=this.x,n=this.y,r=this.z,s=t.elements;return this.x=s[0]*i+s[3]*n+s[6]*r,this.y=s[1]*i+s[4]*n+s[7]*r,this.z=s[2]*i+s[5]*n+s[8]*r,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const i=this.x,n=this.y,r=this.z,s=t.elements,a=1/(s[3]*i+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*i+s[4]*n+s[8]*r+s[12])*a,this.y=(s[1]*i+s[5]*n+s[9]*r+s[13])*a,this.z=(s[2]*i+s[6]*n+s[10]*r+s[14])*a,this}applyQuaternion(t){const i=this.x,n=this.y,r=this.z,s=t.x,a=t.y,o=t.z,l=t.w,c=l*i+a*r-o*n,u=l*n+o*i-s*r,h=l*r+s*n-a*i,d=-s*i-a*n-o*r;return this.x=c*l+d*-s+u*-o-h*-a,this.y=u*l+d*-a+h*-s-c*-o,this.z=h*l+d*-o+c*-a-u*-s,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const i=this.x,n=this.y,r=this.z,s=t.elements;return this.x=s[0]*i+s[4]*n+s[8]*r,this.y=s[1]*i+s[5]*n+s[9]*r,this.z=s[2]*i+s[6]*n+s[10]*r,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this}clampScalar(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this.z=Math.max(t,Math.min(i,this.z)),this}clampLength(t,i){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(i,n)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this}lerpVectors(t,i,n){return this.x=t.x+(i.x-t.x)*n,this.y=t.y+(i.y-t.y)*n,this.z=t.z+(i.z-t.z)*n,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,i){const n=t.x,r=t.y,s=t.z,a=i.x,o=i.y,l=i.z;return this.x=r*l-s*o,this.y=s*a-n*l,this.z=n*o-r*a,this}projectOnVector(t){const i=t.lengthSq();if(i===0)return this.set(0,0,0);const n=t.dot(this)/i;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return Cw.copy(this).projectOnVector(t),this.sub(Cw)}reflect(t){return this.sub(Cw.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const i=Math.sqrt(this.lengthSq()*t.lengthSq());if(i===0)return Math.PI/2;const n=this.dot(t)/i;return Math.acos(Hn(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const i=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return i*i+n*n+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,i,n){const r=Math.sin(i)*t;return this.x=r*Math.sin(n),this.y=Math.cos(i)*t,this.z=r*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,i,n){return this.x=t*Math.sin(i),this.y=n,this.z=t*Math.cos(i),this}setFromMatrixPosition(t){const i=t.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this}setFromMatrixScale(t){const i=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=i,this.y=n,this.z=r,this}setFromMatrixColumn(t,i){return this.fromArray(t.elements,i*4)}setFromMatrix3Column(t,i){return this.fromArray(t.elements,i*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,i=0){return this.x=t[i],this.y=t[i+1],this.z=t[i+2],this}toArray(t=[],i=0){return t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t}fromBufferAttribute(t,i){return this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=(Math.random()-.5)*2,i=Math.random()*Math.PI*2,n=Math.sqrt(1-t**2);return this.x=n*Math.cos(i),this.y=n*Math.sin(i),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Cw=new fe,U7=new Kh;class pg{constructor(t=new fe(1/0,1/0,1/0),i=new fe(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=i}set(t,i){return this.min.copy(t),this.max.copy(i),this}setFromArray(t){this.makeEmpty();for(let i=0,n=t.length;i<n;i+=3)this.expandByPoint(To.fromArray(t,i));return this}setFromBufferAttribute(t){this.makeEmpty();for(let i=0,n=t.count;i<n;i++)this.expandByPoint(To.fromBufferAttribute(t,i));return this}setFromPoints(t){this.makeEmpty();for(let i=0,n=t.length;i<n;i++)this.expandByPoint(t[i]);return this}setFromCenterAndSize(t,i){const n=To.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t,i=!1){return this.makeEmpty(),this.expandByObject(t,i)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,i=!1){if(t.updateWorldMatrix(!1,!1),t.boundingBox!==void 0)t.boundingBox===null&&t.computeBoundingBox(),Wu.copy(t.boundingBox),Wu.applyMatrix4(t.matrixWorld),this.union(Wu);else{const r=t.geometry;if(r!==void 0)if(i&&r.attributes!==void 0&&r.attributes.position!==void 0){const s=r.attributes.position;for(let a=0,o=s.count;a<o;a++)To.fromBufferAttribute(s,a).applyMatrix4(t.matrixWorld),this.expandByPoint(To)}else r.boundingBox===null&&r.computeBoundingBox(),Wu.copy(r.boundingBox),Wu.applyMatrix4(t.matrixWorld),this.union(Wu)}const n=t.children;for(let r=0,s=n.length;r<s;r++)this.expandByObject(n[r],i);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,i){return i.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,To),To.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let i,n;return t.normal.x>0?(i=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(i=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(i+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(i+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(i+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(i+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),i<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(em),ev.subVectors(this.max,em),Xu.subVectors(t.a,em),qu.subVectors(t.b,em),Yu.subVectors(t.c,em),Ll.subVectors(qu,Xu),Rl.subVectors(Yu,qu),Qc.subVectors(Xu,Yu);let i=[0,-Ll.z,Ll.y,0,-Rl.z,Rl.y,0,-Qc.z,Qc.y,Ll.z,0,-Ll.x,Rl.z,0,-Rl.x,Qc.z,0,-Qc.x,-Ll.y,Ll.x,0,-Rl.y,Rl.x,0,-Qc.y,Qc.x,0];return!Ew(i,Xu,qu,Yu,ev)||(i=[1,0,0,0,1,0,0,0,1],!Ew(i,Xu,qu,Yu,ev))?!1:(tv.crossVectors(Ll,Rl),i=[tv.x,tv.y,tv.z],Ew(i,Xu,qu,Yu,ev))}clampPoint(t,i){return i.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,To).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=this.getSize(To).length()*.5),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(Ao[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Ao[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Ao[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Ao[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Ao[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Ao[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Ao[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Ao[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Ao),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const Ao=[new fe,new fe,new fe,new fe,new fe,new fe,new fe,new fe],To=new fe,Wu=new pg,Xu=new fe,qu=new fe,Yu=new fe,Ll=new fe,Rl=new fe,Qc=new fe,em=new fe,ev=new fe,tv=new fe,Kc=new fe;function Ew(e,t,i,n,r){for(let s=0,a=e.length-3;s<=a;s+=3){Kc.fromArray(e,s);const o=r.x*Math.abs(Kc.x)+r.y*Math.abs(Kc.y)+r.z*Math.abs(Kc.z),l=t.dot(Kc),c=i.dot(Kc),u=n.dot(Kc);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>o)return!1}return!0}const z_e=new pg,tm=new fe,Aw=new fe;class t4{constructor(t=new fe,i=-1){this.center=t,this.radius=i}set(t,i){return this.center.copy(t),this.radius=i,this}setFromPoints(t,i){const n=this.center;i!==void 0?n.copy(i):z_e.setFromPoints(t).getCenter(n);let r=0;for(let s=0,a=t.length;s<a;s++)r=Math.max(r,n.distanceToSquared(t[s]));return this.radius=Math.sqrt(r),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const i=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=i*i}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,i){const n=this.center.distanceToSquared(t);return i.copy(t),n>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;tm.subVectors(t,this.center);const i=tm.lengthSq();if(i>this.radius*this.radius){const n=Math.sqrt(i),r=(n-this.radius)*.5;this.center.addScaledVector(tm,r/n),this.radius+=r}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(this.center.equals(t.center)===!0?this.radius=Math.max(this.radius,t.radius):(Aw.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(tm.copy(t.center).add(Aw)),this.expandByPoint(tm.copy(t.center).sub(Aw))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Po=new fe,Tw=new fe,iv=new fe,Il=new fe,Pw=new fe,nv=new fe,Dw=new fe;class rk{constructor(t=new fe,i=new fe(0,0,-1)){this.origin=t,this.direction=i}set(t,i){return this.origin.copy(t),this.direction.copy(i),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,i){return i.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Po)),this}closestPointToPoint(t,i){i.subVectors(t,this.origin);const n=i.dot(this.direction);return n<0?i.copy(this.origin):i.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const i=Po.subVectors(t,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(t):(Po.copy(this.origin).addScaledVector(this.direction,i),Po.distanceToSquared(t))}distanceSqToSegment(t,i,n,r){Tw.copy(t).add(i).multiplyScalar(.5),iv.copy(i).sub(t).normalize(),Il.copy(this.origin).sub(Tw);const s=t.distanceTo(i)*.5,a=-this.direction.dot(iv),o=Il.dot(this.direction),l=-Il.dot(iv),c=Il.lengthSq(),u=Math.abs(1-a*a);let h,d,p,f;if(u>0)if(h=a*l-o,d=a*o-l,f=s*u,h>=0)if(d>=-f)if(d<=f){const v=1/u;h*=v,d*=v,p=h*(h+a*d+2*o)+d*(a*h+d+2*l)+c}else d=s,h=Math.max(0,-(a*d+o)),p=-h*h+d*(d+2*l)+c;else d=-s,h=Math.max(0,-(a*d+o)),p=-h*h+d*(d+2*l)+c;else d<=-f?(h=Math.max(0,-(-a*s+o)),d=h>0?-s:Math.min(Math.max(-s,-l),s),p=-h*h+d*(d+2*l)+c):d<=f?(h=0,d=Math.min(Math.max(-s,-l),s),p=d*(d+2*l)+c):(h=Math.max(0,-(a*s+o)),d=h>0?s:Math.min(Math.max(-s,-l),s),p=-h*h+d*(d+2*l)+c);else d=a>0?-s:s,h=Math.max(0,-(a*d+o)),p=-h*h+d*(d+2*l)+c;return n&&n.copy(this.origin).addScaledVector(this.direction,h),r&&r.copy(Tw).addScaledVector(iv,d),p}intersectSphere(t,i){Po.subVectors(t.center,this.origin);const n=Po.dot(this.direction),r=Po.dot(Po)-n*n,s=t.radius*t.radius;if(r>s)return null;const a=Math.sqrt(s-r),o=n-a,l=n+a;return l<0?null:o<0?this.at(l,i):this.at(o,i)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const i=t.normal.dot(this.direction);if(i===0)return t.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/i;return n>=0?n:null}intersectPlane(t,i){const n=this.distanceToPlane(t);return n===null?null:this.at(n,i)}intersectsPlane(t){const i=t.distanceToPoint(this.origin);return i===0||t.normal.dot(this.direction)*i<0}intersectBox(t,i){let n,r,s,a,o,l;const c=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z,d=this.origin;return c>=0?(n=(t.min.x-d.x)*c,r=(t.max.x-d.x)*c):(n=(t.max.x-d.x)*c,r=(t.min.x-d.x)*c),u>=0?(s=(t.min.y-d.y)*u,a=(t.max.y-d.y)*u):(s=(t.max.y-d.y)*u,a=(t.min.y-d.y)*u),n>a||s>r||((s>n||isNaN(n))&&(n=s),(a<r||isNaN(r))&&(r=a),h>=0?(o=(t.min.z-d.z)*h,l=(t.max.z-d.z)*h):(o=(t.max.z-d.z)*h,l=(t.min.z-d.z)*h),n>l||o>r)||((o>n||n!==n)&&(n=o),(l<r||r!==r)&&(r=l),r<0)?null:this.at(n>=0?n:r,i)}intersectsBox(t){return this.intersectBox(t,Po)!==null}intersectTriangle(t,i,n,r,s){Pw.subVectors(i,t),nv.subVectors(n,t),Dw.crossVectors(Pw,nv);let a=this.direction.dot(Dw),o;if(a>0){if(r)return null;o=1}else if(a<0)o=-1,a=-a;else return null;Il.subVectors(this.origin,t);const l=o*this.direction.dot(nv.crossVectors(Il,nv));if(l<0)return null;const c=o*this.direction.dot(Pw.cross(Il));if(c<0||l+c>a)return null;const u=-o*Il.dot(Dw);return u<0?null:this.at(u/a,s)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Ki{constructor(t,i,n,r,s,a,o,l,c,u,h,d,p,f,v,m){Ki.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t!==void 0&&this.set(t,i,n,r,s,a,o,l,c,u,h,d,p,f,v,m)}set(t,i,n,r,s,a,o,l,c,u,h,d,p,f,v,m){const g=this.elements;return g[0]=t,g[4]=i,g[8]=n,g[12]=r,g[1]=s,g[5]=a,g[9]=o,g[13]=l,g[2]=c,g[6]=u,g[10]=h,g[14]=d,g[3]=p,g[7]=f,g[11]=v,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Ki().fromArray(this.elements)}copy(t){const i=this.elements,n=t.elements;return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],this}copyPosition(t){const i=this.elements,n=t.elements;return i[12]=n[12],i[13]=n[13],i[14]=n[14],this}setFromMatrix3(t){const i=t.elements;return this.set(i[0],i[3],i[6],0,i[1],i[4],i[7],0,i[2],i[5],i[8],0,0,0,0,1),this}extractBasis(t,i,n){return t.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,i,n){return this.set(t.x,i.x,n.x,0,t.y,i.y,n.y,0,t.z,i.z,n.z,0,0,0,0,1),this}extractRotation(t){const i=this.elements,n=t.elements,r=1/Zu.setFromMatrixColumn(t,0).length(),s=1/Zu.setFromMatrixColumn(t,1).length(),a=1/Zu.setFromMatrixColumn(t,2).length();return i[0]=n[0]*r,i[1]=n[1]*r,i[2]=n[2]*r,i[3]=0,i[4]=n[4]*s,i[5]=n[5]*s,i[6]=n[6]*s,i[7]=0,i[8]=n[8]*a,i[9]=n[9]*a,i[10]=n[10]*a,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromEuler(t){const i=this.elements,n=t.x,r=t.y,s=t.z,a=Math.cos(n),o=Math.sin(n),l=Math.cos(r),c=Math.sin(r),u=Math.cos(s),h=Math.sin(s);if(t.order==="XYZ"){const d=a*u,p=a*h,f=o*u,v=o*h;i[0]=l*u,i[4]=-l*h,i[8]=c,i[1]=p+f*c,i[5]=d-v*c,i[9]=-o*l,i[2]=v-d*c,i[6]=f+p*c,i[10]=a*l}else if(t.order==="YXZ"){const d=l*u,p=l*h,f=c*u,v=c*h;i[0]=d+v*o,i[4]=f*o-p,i[8]=a*c,i[1]=a*h,i[5]=a*u,i[9]=-o,i[2]=p*o-f,i[6]=v+d*o,i[10]=a*l}else if(t.order==="ZXY"){const d=l*u,p=l*h,f=c*u,v=c*h;i[0]=d-v*o,i[4]=-a*h,i[8]=f+p*o,i[1]=p+f*o,i[5]=a*u,i[9]=v-d*o,i[2]=-a*c,i[6]=o,i[10]=a*l}else if(t.order==="ZYX"){const d=a*u,p=a*h,f=o*u,v=o*h;i[0]=l*u,i[4]=f*c-p,i[8]=d*c+v,i[1]=l*h,i[5]=v*c+d,i[9]=p*c-f,i[2]=-c,i[6]=o*l,i[10]=a*l}else if(t.order==="YZX"){const d=a*l,p=a*c,f=o*l,v=o*c;i[0]=l*u,i[4]=v-d*h,i[8]=f*h+p,i[1]=h,i[5]=a*u,i[9]=-o*u,i[2]=-c*u,i[6]=p*h+f,i[10]=d-v*h}else if(t.order==="XZY"){const d=a*l,p=a*c,f=o*l,v=o*c;i[0]=l*u,i[4]=-h,i[8]=c*u,i[1]=d*h+v,i[5]=a*u,i[9]=p*h-f,i[2]=f*h-p,i[6]=o*u,i[10]=v*h+d}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromQuaternion(t){return this.compose(k_e,t,V_e)}lookAt(t,i,n){const r=this.elements;return Xr.subVectors(t,i),Xr.lengthSq()===0&&(Xr.z=1),Xr.normalize(),Ol.crossVectors(n,Xr),Ol.lengthSq()===0&&(Math.abs(n.z)===1?Xr.x+=1e-4:Xr.z+=1e-4,Xr.normalize(),Ol.crossVectors(n,Xr)),Ol.normalize(),rv.crossVectors(Xr,Ol),r[0]=Ol.x,r[4]=rv.x,r[8]=Xr.x,r[1]=Ol.y,r[5]=rv.y,r[9]=Xr.y,r[2]=Ol.z,r[6]=rv.z,r[10]=Xr.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,i){const n=t.elements,r=i.elements,s=this.elements,a=n[0],o=n[4],l=n[8],c=n[12],u=n[1],h=n[5],d=n[9],p=n[13],f=n[2],v=n[6],m=n[10],g=n[14],y=n[3],x=n[7],_=n[11],b=n[15],w=r[0],M=r[4],S=r[8],C=r[12],E=r[1],P=r[5],I=r[9],D=r[13],L=r[2],B=r[6],j=r[10],z=r[14],O=r[3],H=r[7],k=r[11],N=r[15];return s[0]=a*w+o*E+l*L+c*O,s[4]=a*M+o*P+l*B+c*H,s[8]=a*S+o*I+l*j+c*k,s[12]=a*C+o*D+l*z+c*N,s[1]=u*w+h*E+d*L+p*O,s[5]=u*M+h*P+d*B+p*H,s[9]=u*S+h*I+d*j+p*k,s[13]=u*C+h*D+d*z+p*N,s[2]=f*w+v*E+m*L+g*O,s[6]=f*M+v*P+m*B+g*H,s[10]=f*S+v*I+m*j+g*k,s[14]=f*C+v*D+m*z+g*N,s[3]=y*w+x*E+_*L+b*O,s[7]=y*M+x*P+_*B+b*H,s[11]=y*S+x*I+_*j+b*k,s[15]=y*C+x*D+_*z+b*N,this}multiplyScalar(t){const i=this.elements;return i[0]*=t,i[4]*=t,i[8]*=t,i[12]*=t,i[1]*=t,i[5]*=t,i[9]*=t,i[13]*=t,i[2]*=t,i[6]*=t,i[10]*=t,i[14]*=t,i[3]*=t,i[7]*=t,i[11]*=t,i[15]*=t,this}determinant(){const t=this.elements,i=t[0],n=t[4],r=t[8],s=t[12],a=t[1],o=t[5],l=t[9],c=t[13],u=t[2],h=t[6],d=t[10],p=t[14],f=t[3],v=t[7],m=t[11],g=t[15];return f*(+s*l*h-r*c*h-s*o*d+n*c*d+r*o*p-n*l*p)+v*(+i*l*p-i*c*d+s*a*d-r*a*p+r*c*u-s*l*u)+m*(+i*c*h-i*o*p-s*a*h+n*a*p+s*o*u-n*c*u)+g*(-r*o*u-i*l*h+i*o*d+r*a*h-n*a*d+n*l*u)}transpose(){const t=this.elements;let i;return i=t[1],t[1]=t[4],t[4]=i,i=t[2],t[2]=t[8],t[8]=i,i=t[6],t[6]=t[9],t[9]=i,i=t[3],t[3]=t[12],t[12]=i,i=t[7],t[7]=t[13],t[13]=i,i=t[11],t[11]=t[14],t[14]=i,this}setPosition(t,i,n){const r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=i,r[14]=n),this}invert(){const t=this.elements,i=t[0],n=t[1],r=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],u=t[8],h=t[9],d=t[10],p=t[11],f=t[12],v=t[13],m=t[14],g=t[15],y=h*m*c-v*d*c+v*l*p-o*m*p-h*l*g+o*d*g,x=f*d*c-u*m*c-f*l*p+a*m*p+u*l*g-a*d*g,_=u*v*c-f*h*c+f*o*p-a*v*p-u*o*g+a*h*g,b=f*h*l-u*v*l-f*o*d+a*v*d+u*o*m-a*h*m,w=i*y+n*x+r*_+s*b;if(w===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const M=1/w;return t[0]=y*M,t[1]=(v*d*s-h*m*s-v*r*p+n*m*p+h*r*g-n*d*g)*M,t[2]=(o*m*s-v*l*s+v*r*c-n*m*c-o*r*g+n*l*g)*M,t[3]=(h*l*s-o*d*s-h*r*c+n*d*c+o*r*p-n*l*p)*M,t[4]=x*M,t[5]=(u*m*s-f*d*s+f*r*p-i*m*p-u*r*g+i*d*g)*M,t[6]=(f*l*s-a*m*s-f*r*c+i*m*c+a*r*g-i*l*g)*M,t[7]=(a*d*s-u*l*s+u*r*c-i*d*c-a*r*p+i*l*p)*M,t[8]=_*M,t[9]=(f*h*s-u*v*s-f*n*p+i*v*p+u*n*g-i*h*g)*M,t[10]=(a*v*s-f*o*s+f*n*c-i*v*c-a*n*g+i*o*g)*M,t[11]=(u*o*s-a*h*s-u*n*c+i*h*c+a*n*p-i*o*p)*M,t[12]=b*M,t[13]=(u*v*r-f*h*r+f*n*d-i*v*d-u*n*m+i*h*m)*M,t[14]=(f*o*r-a*v*r-f*n*l+i*v*l+a*n*m-i*o*m)*M,t[15]=(a*h*r-u*o*r+u*n*l-i*h*l-a*n*d+i*o*d)*M,this}scale(t){const i=this.elements,n=t.x,r=t.y,s=t.z;return i[0]*=n,i[4]*=r,i[8]*=s,i[1]*=n,i[5]*=r,i[9]*=s,i[2]*=n,i[6]*=r,i[10]*=s,i[3]*=n,i[7]*=r,i[11]*=s,this}getMaxScaleOnAxis(){const t=this.elements,i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(i,n,r))}makeTranslation(t,i,n){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,i,0,0,1,n,0,0,0,1),this}makeRotationX(t){const i=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,i,-n,0,0,n,i,0,0,0,0,1),this}makeRotationY(t){const i=Math.cos(t),n=Math.sin(t);return this.set(i,0,n,0,0,1,0,0,-n,0,i,0,0,0,0,1),this}makeRotationZ(t){const i=Math.cos(t),n=Math.sin(t);return this.set(i,-n,0,0,n,i,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,i){const n=Math.cos(i),r=Math.sin(i),s=1-n,a=t.x,o=t.y,l=t.z,c=s*a,u=s*o;return this.set(c*a+n,c*o-r*l,c*l+r*o,0,c*o+r*l,u*o+n,u*l-r*a,0,c*l-r*o,u*l+r*a,s*l*l+n,0,0,0,0,1),this}makeScale(t,i,n){return this.set(t,0,0,0,0,i,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,i,n,r,s,a){return this.set(1,n,s,0,t,1,a,0,i,r,1,0,0,0,0,1),this}compose(t,i,n){const r=this.elements,s=i._x,a=i._y,o=i._z,l=i._w,c=s+s,u=a+a,h=o+o,d=s*c,p=s*u,f=s*h,v=a*u,m=a*h,g=o*h,y=l*c,x=l*u,_=l*h,b=n.x,w=n.y,M=n.z;return r[0]=(1-(v+g))*b,r[1]=(p+_)*b,r[2]=(f-x)*b,r[3]=0,r[4]=(p-_)*w,r[5]=(1-(d+g))*w,r[6]=(m+y)*w,r[7]=0,r[8]=(f+x)*M,r[9]=(m-y)*M,r[10]=(1-(d+v))*M,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}decompose(t,i,n){const r=this.elements;let s=Zu.set(r[0],r[1],r[2]).length();const a=Zu.set(r[4],r[5],r[6]).length(),o=Zu.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),t.x=r[12],t.y=r[13],t.z=r[14],Qs.copy(this);const c=1/s,u=1/a,h=1/o;return Qs.elements[0]*=c,Qs.elements[1]*=c,Qs.elements[2]*=c,Qs.elements[4]*=u,Qs.elements[5]*=u,Qs.elements[6]*=u,Qs.elements[8]*=h,Qs.elements[9]*=h,Qs.elements[10]*=h,i.setFromRotationMatrix(Qs),n.x=s,n.y=a,n.z=o,this}makePerspective(t,i,n,r,s,a,o=Ko){const l=this.elements,c=2*s/(i-t),u=2*s/(n-r),h=(i+t)/(i-t),d=(n+r)/(n-r);let p,f;if(o===Ko)p=-(a+s)/(a-s),f=-2*a*s/(a-s);else if(o===Mx)p=-a/(a-s),f=-a*s/(a-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);return l[0]=c,l[4]=0,l[8]=h,l[12]=0,l[1]=0,l[5]=u,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=p,l[14]=f,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(t,i,n,r,s,a,o=Ko){const l=this.elements,c=1/(i-t),u=1/(n-r),h=1/(a-s),d=(i+t)*c,p=(n+r)*u;let f,v;if(o===Ko)f=(a+s)*h,v=-2*h;else if(o===Mx)f=s*h,v=-1*h;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-d,l[1]=0,l[5]=2*u,l[9]=0,l[13]=-p,l[2]=0,l[6]=0,l[10]=v,l[14]=-f,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(t){const i=this.elements,n=t.elements;for(let r=0;r<16;r++)if(i[r]!==n[r])return!1;return!0}fromArray(t,i=0){for(let n=0;n<16;n++)this.elements[n]=t[n+i];return this}toArray(t=[],i=0){const n=this.elements;return t[i]=n[0],t[i+1]=n[1],t[i+2]=n[2],t[i+3]=n[3],t[i+4]=n[4],t[i+5]=n[5],t[i+6]=n[6],t[i+7]=n[7],t[i+8]=n[8],t[i+9]=n[9],t[i+10]=n[10],t[i+11]=n[11],t[i+12]=n[12],t[i+13]=n[13],t[i+14]=n[14],t[i+15]=n[15],t}}const Zu=new fe,Qs=new Ki,k_e=new fe(0,0,0),V_e=new fe(1,1,1),Ol=new fe,rv=new fe,Xr=new fe,F7=new Ki,z7=new Kh;class L2{constructor(t=0,i=0,n=0,r=L2.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=i,this._z=n,this._order=r}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,i,n,r=this._order){return this._x=t,this._y=i,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,i=this._order,n=!0){const r=t.elements,s=r[0],a=r[4],o=r[8],l=r[1],c=r[5],u=r[9],h=r[2],d=r[6],p=r[10];switch(i){case"XYZ":this._y=Math.asin(Hn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-u,p),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(d,c),this._z=0);break;case"YXZ":this._x=Math.asin(-Hn(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(o,p),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-h,s),this._z=0);break;case"ZXY":this._x=Math.asin(Hn(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-h,p),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Hn(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(d,p),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-a,c));break;case"YZX":this._z=Math.asin(Hn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-h,s)):(this._x=0,this._y=Math.atan2(o,p));break;case"XZY":this._z=Math.asin(-Hn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-u,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,n===!0&&this._onChangeCallback(),this}setFromQuaternion(t,i,n){return F7.makeRotationFromQuaternion(t),this.setFromRotationMatrix(F7,i,n)}setFromVector3(t,i=this._order){return this.set(t.x,t.y,t.z,i)}reorder(t){return z7.setFromEuler(this),this.setFromQuaternion(z7,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],i=0){return t[i]=this._x,t[i+1]=this._y,t[i+2]=this._z,t[i+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}L2.DEFAULT_ORDER="XYZ";class sk{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}}let H_e=0;const k7=new fe,Qu=new Kh,Do=new Ki,sv=new fe,im=new fe,G_e=new fe,j_e=new Kh,V7=new fe(1,0,0),H7=new fe(0,1,0),G7=new fe(0,0,1),W_e={type:"added"},X_e={type:"removed"};class mr extends lu{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:H_e++}),this.uuid=lf(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=mr.DEFAULT_UP.clone();const t=new fe,i=new L2,n=new Kh,r=new fe(1,1,1);function s(){n.setFromEuler(i,!1)}function a(){i.setFromQuaternion(n,void 0,!1)}i._onChange(s),n._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Ki},normalMatrix:{value:new Ut}}),this.matrix=new Ki,this.matrixWorld=new Ki,this.matrixAutoUpdate=mr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=mr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new sk,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,i){this.quaternion.setFromAxisAngle(t,i)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,i){return Qu.setFromAxisAngle(t,i),this.quaternion.multiply(Qu),this}rotateOnWorldAxis(t,i){return Qu.setFromAxisAngle(t,i),this.quaternion.premultiply(Qu),this}rotateX(t){return this.rotateOnAxis(V7,t)}rotateY(t){return this.rotateOnAxis(H7,t)}rotateZ(t){return this.rotateOnAxis(G7,t)}translateOnAxis(t,i){return k7.copy(t).applyQuaternion(this.quaternion),this.position.add(k7.multiplyScalar(i)),this}translateX(t){return this.translateOnAxis(V7,t)}translateY(t){return this.translateOnAxis(H7,t)}translateZ(t){return this.translateOnAxis(G7,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(Do.copy(this.matrixWorld).invert())}lookAt(t,i,n){t.isVector3?sv.copy(t):sv.set(t,i,n);const r=this.parent;this.updateWorldMatrix(!0,!1),im.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Do.lookAt(im,sv,this.up):Do.lookAt(sv,im,this.up),this.quaternion.setFromRotationMatrix(Do),r&&(Do.extractRotation(r.matrixWorld),Qu.setFromRotationMatrix(Do),this.quaternion.premultiply(Qu.invert()))}add(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(W_e)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const i=this.children.indexOf(t);return i!==-1&&(t.parent=null,this.children.splice(i,1),t.dispatchEvent(X_e)),this}removeFromParent(){const t=this.parent;return t!==null&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),Do.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),Do.multiply(t.parent.matrixWorld)),t.applyMatrix4(Do),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,i){if(this[t]===i)return this;for(let n=0,r=this.children.length;n<r;n++){const a=this.children[n].getObjectByProperty(t,i);if(a!==void 0)return a}}getObjectsByProperty(t,i){let n=[];this[t]===i&&n.push(this);for(let r=0,s=this.children.length;r<s;r++){const a=this.children[r].getObjectsByProperty(t,i);a.length>0&&(n=n.concat(a))}return n}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(im,t,G_e),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(im,j_e,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(t){t(this);const i=this.children;for(let n=0,r=i.length;n<r;n++)i[n].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);const i=this.children;for(let n=0,r=i.length;n<r;n++)i[n].traverseVisible(t)}traverseAncestors(t){const i=this.parent;i!==null&&(t(i),i.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const i=this.children;for(let n=0,r=i.length;n<r;n++){const s=i[n];(s.matrixWorldAutoUpdate===!0||t===!0)&&s.updateMatrixWorld(t)}}updateWorldMatrix(t,i){const n=this.parent;if(t===!0&&n!==null&&n.matrixWorldAutoUpdate===!0&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0){const r=this.children;for(let s=0,a=r.length;s<a;s++){const o=r[s];o.matrixWorldAutoUpdate===!0&&o.updateWorldMatrix(!1,!0)}}}toJSON(t){const i=t===void 0||typeof t=="string",n={};i&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON()));function s(o,l){return o[l.uuid]===void 0&&(o[l.uuid]=l.toJSON(t)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(t.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const l=o.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++){const h=l[c];s(t.shapes,h)}else s(t.shapes,l)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(t.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let l=0,c=this.material.length;l<c;l++)o.push(s(t.materials,this.material[l]));r.material=o}else r.material=s(t.materials,this.material);if(this.children.length>0){r.children=[];for(let o=0;o<this.children.length;o++)r.children.push(this.children[o].toJSON(t).object)}if(this.animations.length>0){r.animations=[];for(let o=0;o<this.animations.length;o++){const l=this.animations[o];r.animations.push(s(t.animations,l))}}if(i){const o=a(t.geometries),l=a(t.materials),c=a(t.textures),u=a(t.images),h=a(t.shapes),d=a(t.skeletons),p=a(t.animations),f=a(t.nodes);o.length>0&&(n.geometries=o),l.length>0&&(n.materials=l),c.length>0&&(n.textures=c),u.length>0&&(n.images=u),h.length>0&&(n.shapes=h),d.length>0&&(n.skeletons=d),p.length>0&&(n.animations=p),f.length>0&&(n.nodes=f)}return n.object=r,n;function a(o){const l=[];for(const c in o){const u=o[c];delete u.metadata,l.push(u)}return l}}clone(t){return new this.constructor().copy(this,t)}copy(t,i=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),i===!0)for(let n=0;n<t.children.length;n++){const r=t.children[n];this.add(r.clone())}return this}}mr.DEFAULT_UP=new fe(0,1,0);mr.DEFAULT_MATRIX_AUTO_UPDATE=!0;mr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Ks=new fe,Lo=new fe,Lw=new fe,Ro=new fe,Ku=new fe,$u=new fe,j7=new fe,Rw=new fe,Iw=new fe,Ow=new fe;let av=!1;class ia{constructor(t=new fe,i=new fe,n=new fe){this.a=t,this.b=i,this.c=n}static getNormal(t,i,n,r){r.subVectors(n,i),Ks.subVectors(t,i),r.cross(Ks);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(t,i,n,r,s){Ks.subVectors(r,i),Lo.subVectors(n,i),Lw.subVectors(t,i);const a=Ks.dot(Ks),o=Ks.dot(Lo),l=Ks.dot(Lw),c=Lo.dot(Lo),u=Lo.dot(Lw),h=a*c-o*o;if(h===0)return s.set(-2,-1,-1);const d=1/h,p=(c*l-o*u)*d,f=(a*u-o*l)*d;return s.set(1-p-f,f,p)}static containsPoint(t,i,n,r){return this.getBarycoord(t,i,n,r,Ro),Ro.x>=0&&Ro.y>=0&&Ro.x+Ro.y<=1}static getUV(t,i,n,r,s,a,o,l){return av===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),av=!0),this.getInterpolation(t,i,n,r,s,a,o,l)}static getInterpolation(t,i,n,r,s,a,o,l){return this.getBarycoord(t,i,n,r,Ro),l.setScalar(0),l.addScaledVector(s,Ro.x),l.addScaledVector(a,Ro.y),l.addScaledVector(o,Ro.z),l}static isFrontFacing(t,i,n,r){return Ks.subVectors(n,i),Lo.subVectors(t,i),Ks.cross(Lo).dot(r)<0}set(t,i,n){return this.a.copy(t),this.b.copy(i),this.c.copy(n),this}setFromPointsAndIndices(t,i,n,r){return this.a.copy(t[i]),this.b.copy(t[n]),this.c.copy(t[r]),this}setFromAttributeAndIndices(t,i,n,r){return this.a.fromBufferAttribute(t,i),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,r),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return Ks.subVectors(this.c,this.b),Lo.subVectors(this.a,this.b),Ks.cross(Lo).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return ia.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,i){return ia.getBarycoord(t,this.a,this.b,this.c,i)}getUV(t,i,n,r,s){return av===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),av=!0),ia.getInterpolation(t,this.a,this.b,this.c,i,n,r,s)}getInterpolation(t,i,n,r,s){return ia.getInterpolation(t,this.a,this.b,this.c,i,n,r,s)}containsPoint(t){return ia.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return ia.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,i){const n=this.a,r=this.b,s=this.c;let a,o;Ku.subVectors(r,n),$u.subVectors(s,n),Rw.subVectors(t,n);const l=Ku.dot(Rw),c=$u.dot(Rw);if(l<=0&&c<=0)return i.copy(n);Iw.subVectors(t,r);const u=Ku.dot(Iw),h=$u.dot(Iw);if(u>=0&&h<=u)return i.copy(r);const d=l*h-u*c;if(d<=0&&l>=0&&u<=0)return a=l/(l-u),i.copy(n).addScaledVector(Ku,a);Ow.subVectors(t,s);const p=Ku.dot(Ow),f=$u.dot(Ow);if(f>=0&&p<=f)return i.copy(s);const v=p*c-l*f;if(v<=0&&c>=0&&f<=0)return o=c/(c-f),i.copy(n).addScaledVector($u,o);const m=u*f-p*h;if(m<=0&&h-u>=0&&p-f>=0)return j7.subVectors(s,r),o=(h-u)/(h-u+(p-f)),i.copy(r).addScaledVector(j7,o);const g=1/(m+v+d);return a=v*g,o=d*g,i.copy(n).addScaledVector(Ku,a).addScaledVector($u,o)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let q_e=0;class fg extends lu{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:q_e++}),this.uuid=lf(),this.name="",this.type="Material",this.blending=lp,this.side=Rc,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Hz,this.blendDst=Gz,this.blendEquation=dd,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=WM,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=r_e,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=bw,this.stencilZFail=bw,this.stencilZPass=bw,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(const i in t){const n=t[i];if(n===void 0){console.warn(`THREE.Material: parameter '${i}' has value of undefined.`);continue}const r=this[i];if(r===void 0){console.warn(`THREE.Material: '${i}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[i]=n}}toJSON(t){const i=t===void 0||typeof t=="string";i&&(t={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==lp&&(n.blending=this.blending),this.side!==Rc&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=this.alphaHash),this.alphaToCoverage===!0&&(n.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.forceSinglePass===!0&&(n.forceSinglePass=this.forceSinglePass),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=this.flatShading),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(s){const a=[];for(const o in s){const l=s[o];delete l.metadata,a.push(l)}return a}if(i){const s=r(t.textures),a=r(t.images);s.length>0&&(n.textures=s),a.length>0&&(n.images=a)}return n}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const i=t.clippingPlanes;let n=null;if(i!==null){const r=i.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=i[s].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}}const ak={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},$s={h:0,s:0,l:0},ov={h:0,s:0,l:0};function Bw(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*6*(2/3-i):e}class ri{constructor(t,i,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,i,n)}set(t,i,n){if(i===void 0&&n===void 0){const r=t;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(t,i,n);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,i=gi){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,Zs.toWorkingColorSpace(this,i),this}setRGB(t,i,n,r=Zs.workingColorSpace){return this.r=t,this.g=i,this.b=n,Zs.toWorkingColorSpace(this,r),this}setHSL(t,i,n,r=Zs.workingColorSpace){if(t=e4(t,1),i=Hn(i,0,1),n=Hn(n,0,1),i===0)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+i):n+i-n*i,a=2*n-s;this.r=Bw(a,s,t+1/3),this.g=Bw(a,s,t),this.b=Bw(a,s,t-1/3)}return Zs.toWorkingColorSpace(this,r),this}setStyle(t,i=gi){function n(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(t)){let s;const a=r[1],o=r[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,i);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,i);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,i);break;default:console.warn("THREE.Color: Unknown color model "+t)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(t)){const s=r[1],a=s.length;if(a===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,i);if(a===6)return this.setHex(parseInt(s,16),i);console.warn("THREE.Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,i);return this}setColorName(t,i=gi){const n=ak[t.toLowerCase()];return n!==void 0?this.setHex(n,i):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=cp(t.r),this.g=cp(t.g),this.b=cp(t.b),this}copyLinearToSRGB(t){return this.r=Sw(t.r),this.g=Sw(t.g),this.b=Sw(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=gi){return Zs.fromWorkingColorSpace(zn.copy(this),t),Math.round(Hn(zn.r*255,0,255))*65536+Math.round(Hn(zn.g*255,0,255))*256+Math.round(Hn(zn.b*255,0,255))}getHexString(t=gi){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,i=Zs.workingColorSpace){Zs.fromWorkingColorSpace(zn.copy(this),i);const n=zn.r,r=zn.g,s=zn.b,a=Math.max(n,r,s),o=Math.min(n,r,s);let l,c;const u=(o+a)/2;if(o===a)l=0,c=0;else{const h=a-o;switch(c=u<=.5?h/(a+o):h/(2-a-o),a){case n:l=(r-s)/h+(r<s?6:0);break;case r:l=(s-n)/h+2;break;case s:l=(n-r)/h+4;break}l/=6}return t.h=l,t.s=c,t.l=u,t}getRGB(t,i=Zs.workingColorSpace){return Zs.fromWorkingColorSpace(zn.copy(this),i),t.r=zn.r,t.g=zn.g,t.b=zn.b,t}getStyle(t=gi){Zs.fromWorkingColorSpace(zn.copy(this),t);const i=zn.r,n=zn.g,r=zn.b;return t!==gi?`color(${t} ${i.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(i*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(t,i,n){return this.getHSL($s),$s.h+=t,$s.s+=i,$s.l+=n,this.setHSL($s.h,$s.s,$s.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,i){return this.r=t.r+i.r,this.g=t.g+i.g,this.b=t.b+i.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,i){return this.r+=(t.r-this.r)*i,this.g+=(t.g-this.g)*i,this.b+=(t.b-this.b)*i,this}lerpColors(t,i,n){return this.r=t.r+(i.r-t.r)*n,this.g=t.g+(i.g-t.g)*n,this.b=t.b+(i.b-t.b)*n,this}lerpHSL(t,i){this.getHSL($s),t.getHSL(ov);const n=Jm($s.h,ov.h,i),r=Jm($s.s,ov.s,i),s=Jm($s.l,ov.l,i);return this.setHSL(n,r,s),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const i=this.r,n=this.g,r=this.b,s=t.elements;return this.r=s[0]*i+s[3]*n+s[6]*r,this.g=s[1]*i+s[4]*n+s[7]*r,this.b=s[2]*i+s[5]*n+s[8]*r,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,i=0){return this.r=t[i],this.g=t[i+1],this.b=t[i+2],this}toArray(t=[],i=0){return t[i]=this.r,t[i+1]=this.g,t[i+2]=this.b,t}fromBufferAttribute(t,i){return this.r=t.getX(i),this.g=t.getY(i),this.b=t.getZ(i),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const zn=new ri;ri.NAMES=ak;class Ex extends fg{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new ri(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=jz,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const Xi=new fe,lv=new Pt;class io{constructor(t,i,n=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=i,this.count=t!==void 0?t.length/i:0,this.normalized=n,this.usage=I7,this.updateRange={offset:0,count:-1},this.gpuType=sc,this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,i,n){t*=this.itemSize,n*=i.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[t+r]=i.array[n+r];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(this.itemSize===2)for(let i=0,n=this.count;i<n;i++)lv.fromBufferAttribute(this,i),lv.applyMatrix3(t),this.setXY(i,lv.x,lv.y);else if(this.itemSize===3)for(let i=0,n=this.count;i<n;i++)Xi.fromBufferAttribute(this,i),Xi.applyMatrix3(t),this.setXYZ(i,Xi.x,Xi.y,Xi.z);return this}applyMatrix4(t){for(let i=0,n=this.count;i<n;i++)Xi.fromBufferAttribute(this,i),Xi.applyMatrix4(t),this.setXYZ(i,Xi.x,Xi.y,Xi.z);return this}applyNormalMatrix(t){for(let i=0,n=this.count;i<n;i++)Xi.fromBufferAttribute(this,i),Xi.applyNormalMatrix(t),this.setXYZ(i,Xi.x,Xi.y,Xi.z);return this}transformDirection(t){for(let i=0,n=this.count;i<n;i++)Xi.fromBufferAttribute(this,i),Xi.transformDirection(t),this.setXYZ(i,Xi.x,Xi.y,Xi.z);return this}set(t,i=0){return this.array.set(t,i),this}getComponent(t,i){let n=this.array[t*this.itemSize+i];return this.normalized&&(n=pd(n,this.array)),n}setComponent(t,i,n){return this.normalized&&(n=er(n,this.array)),this.array[t*this.itemSize+i]=n,this}getX(t){let i=this.array[t*this.itemSize];return this.normalized&&(i=pd(i,this.array)),i}setX(t,i){return this.normalized&&(i=er(i,this.array)),this.array[t*this.itemSize]=i,this}getY(t){let i=this.array[t*this.itemSize+1];return this.normalized&&(i=pd(i,this.array)),i}setY(t,i){return this.normalized&&(i=er(i,this.array)),this.array[t*this.itemSize+1]=i,this}getZ(t){let i=this.array[t*this.itemSize+2];return this.normalized&&(i=pd(i,this.array)),i}setZ(t,i){return this.normalized&&(i=er(i,this.array)),this.array[t*this.itemSize+2]=i,this}getW(t){let i=this.array[t*this.itemSize+3];return this.normalized&&(i=pd(i,this.array)),i}setW(t,i){return this.normalized&&(i=er(i,this.array)),this.array[t*this.itemSize+3]=i,this}setXY(t,i,n){return t*=this.itemSize,this.normalized&&(i=er(i,this.array),n=er(n,this.array)),this.array[t+0]=i,this.array[t+1]=n,this}setXYZ(t,i,n,r){return t*=this.itemSize,this.normalized&&(i=er(i,this.array),n=er(n,this.array),r=er(r,this.array)),this.array[t+0]=i,this.array[t+1]=n,this.array[t+2]=r,this}setXYZW(t,i,n,r,s){return t*=this.itemSize,this.normalized&&(i=er(i,this.array),n=er(n,this.array),r=er(r,this.array),s=er(s,this.array)),this.array[t+0]=i,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=s,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==I7&&(t.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(t.updateRange=this.updateRange),t}}class ok extends io{constructor(t,i,n){super(new Uint16Array(t),i,n)}}class lk extends io{constructor(t,i,n){super(new Uint32Array(t),i,n)}}class ss extends io{constructor(t,i,n){super(new Float32Array(t),i,n)}}let Y_e=0;const _s=new Ki,Nw=new mr,Ju=new fe,qr=new pg,nm=new pg,yn=new fe;class ml extends lu{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Y_e++}),this.uuid=lf(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(ek(t)?lk:ok)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,i){return this.attributes[t]=i,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,i,n=0){this.groups.push({start:t,count:i,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,i){this.drawRange.start=t,this.drawRange.count=i}applyMatrix4(t){const i=this.attributes.position;i!==void 0&&(i.applyMatrix4(t),i.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new Ut().getNormalMatrix(t);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(t),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return _s.makeRotationFromQuaternion(t),this.applyMatrix4(_s),this}rotateX(t){return _s.makeRotationX(t),this.applyMatrix4(_s),this}rotateY(t){return _s.makeRotationY(t),this.applyMatrix4(_s),this}rotateZ(t){return _s.makeRotationZ(t),this.applyMatrix4(_s),this}translate(t,i,n){return _s.makeTranslation(t,i,n),this.applyMatrix4(_s),this}scale(t,i,n){return _s.makeScale(t,i,n),this.applyMatrix4(_s),this}lookAt(t){return Nw.lookAt(t),Nw.updateMatrix(),this.applyMatrix4(Nw.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ju).negate(),this.translate(Ju.x,Ju.y,Ju.z),this}setFromPoints(t){const i=[];for(let n=0,r=t.length;n<r;n++){const s=t[n];i.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new ss(i,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new pg);const t=this.attributes.position,i=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new fe(-1/0,-1/0,-1/0),new fe(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),i)for(let n=0,r=i.length;n<r;n++){const s=i[n];qr.setFromBufferAttribute(s),this.morphTargetsRelative?(yn.addVectors(this.boundingBox.min,qr.min),this.boundingBox.expandByPoint(yn),yn.addVectors(this.boundingBox.max,qr.max),this.boundingBox.expandByPoint(yn)):(this.boundingBox.expandByPoint(qr.min),this.boundingBox.expandByPoint(qr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new t4);const t=this.attributes.position,i=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new fe,1/0);return}if(t){const n=this.boundingSphere.center;if(qr.setFromBufferAttribute(t),i)for(let s=0,a=i.length;s<a;s++){const o=i[s];nm.setFromBufferAttribute(o),this.morphTargetsRelative?(yn.addVectors(qr.min,nm.min),qr.expandByPoint(yn),yn.addVectors(qr.max,nm.max),qr.expandByPoint(yn)):(qr.expandByPoint(nm.min),qr.expandByPoint(nm.max))}qr.getCenter(n);let r=0;for(let s=0,a=t.count;s<a;s++)yn.fromBufferAttribute(t,s),r=Math.max(r,n.distanceToSquared(yn));if(i)for(let s=0,a=i.length;s<a;s++){const o=i[s],l=this.morphTargetsRelative;for(let c=0,u=o.count;c<u;c++)yn.fromBufferAttribute(o,c),l&&(Ju.fromBufferAttribute(t,c),yn.add(Ju)),r=Math.max(r,n.distanceToSquared(yn))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,i=this.attributes;if(t===null||i.position===void 0||i.normal===void 0||i.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.array,r=i.position.array,s=i.normal.array,a=i.uv.array,o=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new io(new Float32Array(4*o),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let E=0;E<o;E++)c[E]=new fe,u[E]=new fe;const h=new fe,d=new fe,p=new fe,f=new Pt,v=new Pt,m=new Pt,g=new fe,y=new fe;function x(E,P,I){h.fromArray(r,E*3),d.fromArray(r,P*3),p.fromArray(r,I*3),f.fromArray(a,E*2),v.fromArray(a,P*2),m.fromArray(a,I*2),d.sub(h),p.sub(h),v.sub(f),m.sub(f);const D=1/(v.x*m.y-m.x*v.y);isFinite(D)&&(g.copy(d).multiplyScalar(m.y).addScaledVector(p,-v.y).multiplyScalar(D),y.copy(p).multiplyScalar(v.x).addScaledVector(d,-m.x).multiplyScalar(D),c[E].add(g),c[P].add(g),c[I].add(g),u[E].add(y),u[P].add(y),u[I].add(y))}let _=this.groups;_.length===0&&(_=[{start:0,count:n.length}]);for(let E=0,P=_.length;E<P;++E){const I=_[E],D=I.start,L=I.count;for(let B=D,j=D+L;B<j;B+=3)x(n[B+0],n[B+1],n[B+2])}const b=new fe,w=new fe,M=new fe,S=new fe;function C(E){M.fromArray(s,E*3),S.copy(M);const P=c[E];b.copy(P),b.sub(M.multiplyScalar(M.dot(P))).normalize(),w.crossVectors(S,P);const D=w.dot(u[E])<0?-1:1;l[E*4]=b.x,l[E*4+1]=b.y,l[E*4+2]=b.z,l[E*4+3]=D}for(let E=0,P=_.length;E<P;++E){const I=_[E],D=I.start,L=I.count;for(let B=D,j=D+L;B<j;B+=3)C(n[B+0]),C(n[B+1]),C(n[B+2])}}computeVertexNormals(){const t=this.index,i=this.getAttribute("position");if(i!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new io(new Float32Array(i.count*3),3),this.setAttribute("normal",n);else for(let d=0,p=n.count;d<p;d++)n.setXYZ(d,0,0,0);const r=new fe,s=new fe,a=new fe,o=new fe,l=new fe,c=new fe,u=new fe,h=new fe;if(t)for(let d=0,p=t.count;d<p;d+=3){const f=t.getX(d+0),v=t.getX(d+1),m=t.getX(d+2);r.fromBufferAttribute(i,f),s.fromBufferAttribute(i,v),a.fromBufferAttribute(i,m),u.subVectors(a,s),h.subVectors(r,s),u.cross(h),o.fromBufferAttribute(n,f),l.fromBufferAttribute(n,v),c.fromBufferAttribute(n,m),o.add(u),l.add(u),c.add(u),n.setXYZ(f,o.x,o.y,o.z),n.setXYZ(v,l.x,l.y,l.z),n.setXYZ(m,c.x,c.y,c.z)}else for(let d=0,p=i.count;d<p;d+=3)r.fromBufferAttribute(i,d+0),s.fromBufferAttribute(i,d+1),a.fromBufferAttribute(i,d+2),u.subVectors(a,s),h.subVectors(r,s),u.cross(h),n.setXYZ(d+0,u.x,u.y,u.z),n.setXYZ(d+1,u.x,u.y,u.z),n.setXYZ(d+2,u.x,u.y,u.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const t=this.attributes.normal;for(let i=0,n=t.count;i<n;i++)yn.fromBufferAttribute(t,i),yn.normalize(),t.setXYZ(i,yn.x,yn.y,yn.z)}toNonIndexed(){function t(o,l){const c=o.array,u=o.itemSize,h=o.normalized,d=new c.constructor(l.length*u);let p=0,f=0;for(let v=0,m=l.length;v<m;v++){o.isInterleavedBufferAttribute?p=l[v]*o.data.stride+o.offset:p=l[v]*u;for(let g=0;g<u;g++)d[f++]=c[p++]}return new io(d,u,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const i=new ml,n=this.index.array,r=this.attributes;for(const o in r){const l=r[o],c=t(l,n);i.setAttribute(o,c)}const s=this.morphAttributes;for(const o in s){const l=[],c=s[o];for(let u=0,h=c.length;u<h;u++){const d=c[u],p=t(d,n);l.push(p)}i.morphAttributes[o]=l}i.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,l=a.length;o<l;o++){const c=a[o];i.addGroup(c.start,c.count,c.materialIndex)}return i}toJSON(){const t={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(t[c]=l[c]);return t}t.data={attributes:{}};const i=this.index;i!==null&&(t.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});const n=this.attributes;for(const l in n){const c=n[l];t.data.attributes[l]=c.toJSON(t.data)}const r={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let h=0,d=c.length;h<d;h++){const p=c[h];u.push(p.toJSON(t.data))}u.length>0&&(r[l]=u,s=!0)}s&&(t.data.morphAttributes=r,t.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(t.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return o!==null&&(t.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const i={};this.name=t.name;const n=t.index;n!==null&&this.setIndex(n.clone(i));const r=t.attributes;for(const c in r){const u=r[c];this.setAttribute(c,u.clone(i))}const s=t.morphAttributes;for(const c in s){const u=[],h=s[c];for(let d=0,p=h.length;d<p;d++)u.push(h[d].clone(i));this.morphAttributes[c]=u}this.morphTargetsRelative=t.morphTargetsRelative;const a=t.groups;for(let c=0,u=a.length;c<u;c++){const h=a[c];this.addGroup(h.start,h.count,h.materialIndex)}const o=t.boundingBox;o!==null&&(this.boundingBox=o.clone());const l=t.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const W7=new Ki,$c=new rk,cv=new t4,X7=new fe,ed=new fe,td=new fe,id=new fe,Uw=new fe,hv=new fe,uv=new Pt,dv=new Pt,pv=new Pt,q7=new fe,Y7=new fe,Z7=new fe,fv=new fe,mv=new fe;class da extends mr{constructor(t=new ml,i=new Ex){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=i,this.updateMorphTargets()}copy(t,i){return super.copy(t,i),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}updateMorphTargets(){const i=this.geometry.morphAttributes,n=Object.keys(i);if(n.length>0){const r=i[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}getVertexPosition(t,i){const n=this.geometry,r=n.attributes.position,s=n.morphAttributes.position,a=n.morphTargetsRelative;i.fromBufferAttribute(r,t);const o=this.morphTargetInfluences;if(s&&o){hv.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=o[l],h=s[l];u!==0&&(Uw.fromBufferAttribute(h,t),a?hv.addScaledVector(Uw,u):hv.addScaledVector(Uw.sub(i),u))}i.add(hv)}return i}raycast(t,i){const n=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),cv.copy(n.boundingSphere),cv.applyMatrix4(s),$c.copy(t.ray).recast(t.near),!(cv.containsPoint($c.origin)===!1&&($c.intersectSphere(cv,X7)===null||$c.origin.distanceToSquared(X7)>(t.far-t.near)**2))&&(W7.copy(s).invert(),$c.copy(t.ray).applyMatrix4(W7),!(n.boundingBox!==null&&$c.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(t,i,$c)))}_computeIntersections(t,i,n){let r;const s=this.geometry,a=this.material,o=s.index,l=s.attributes.position,c=s.attributes.uv,u=s.attributes.uv1,h=s.attributes.normal,d=s.groups,p=s.drawRange;if(o!==null)if(Array.isArray(a))for(let f=0,v=d.length;f<v;f++){const m=d[f],g=a[m.materialIndex],y=Math.max(m.start,p.start),x=Math.min(o.count,Math.min(m.start+m.count,p.start+p.count));for(let _=y,b=x;_<b;_+=3){const w=o.getX(_),M=o.getX(_+1),S=o.getX(_+2);r=gv(this,g,t,n,c,u,h,w,M,S),r&&(r.faceIndex=Math.floor(_/3),r.face.materialIndex=m.materialIndex,i.push(r))}}else{const f=Math.max(0,p.start),v=Math.min(o.count,p.start+p.count);for(let m=f,g=v;m<g;m+=3){const y=o.getX(m),x=o.getX(m+1),_=o.getX(m+2);r=gv(this,a,t,n,c,u,h,y,x,_),r&&(r.faceIndex=Math.floor(m/3),i.push(r))}}else if(l!==void 0)if(Array.isArray(a))for(let f=0,v=d.length;f<v;f++){const m=d[f],g=a[m.materialIndex],y=Math.max(m.start,p.start),x=Math.min(l.count,Math.min(m.start+m.count,p.start+p.count));for(let _=y,b=x;_<b;_+=3){const w=_,M=_+1,S=_+2;r=gv(this,g,t,n,c,u,h,w,M,S),r&&(r.faceIndex=Math.floor(_/3),r.face.materialIndex=m.materialIndex,i.push(r))}}else{const f=Math.max(0,p.start),v=Math.min(l.count,p.start+p.count);for(let m=f,g=v;m<g;m+=3){const y=m,x=m+1,_=m+2;r=gv(this,a,t,n,c,u,h,y,x,_),r&&(r.faceIndex=Math.floor(m/3),i.push(r))}}}}function Z_e(e,t,i,n,r,s,a,o){let l;if(t.side===Br?l=n.intersectTriangle(a,s,r,!0,o):l=n.intersectTriangle(r,s,a,t.side===Rc,o),l===null)return null;mv.copy(o),mv.applyMatrix4(e.matrixWorld);const c=i.ray.origin.distanceTo(mv);return c<i.near||c>i.far?null:{distance:c,point:mv.clone(),object:e}}function gv(e,t,i,n,r,s,a,o,l,c){e.getVertexPosition(o,ed),e.getVertexPosition(l,td),e.getVertexPosition(c,id);const u=Z_e(e,t,i,n,ed,td,id,fv);if(u){r&&(uv.fromBufferAttribute(r,o),dv.fromBufferAttribute(r,l),pv.fromBufferAttribute(r,c),u.uv=ia.getInterpolation(fv,ed,td,id,uv,dv,pv,new Pt)),s&&(uv.fromBufferAttribute(s,o),dv.fromBufferAttribute(s,l),pv.fromBufferAttribute(s,c),u.uv1=ia.getInterpolation(fv,ed,td,id,uv,dv,pv,new Pt),u.uv2=u.uv1),a&&(q7.fromBufferAttribute(a,o),Y7.fromBufferAttribute(a,l),Z7.fromBufferAttribute(a,c),u.normal=ia.getInterpolation(fv,ed,td,id,q7,Y7,Z7,new fe),u.normal.dot(n.direction)>0&&u.normal.multiplyScalar(-1));const h={a:o,b:l,c,normal:new fe,materialIndex:0};ia.getNormal(ed,td,id,h.normal),u.face=h}return u}class mg extends ml{constructor(t=1,i=1,n=1,r=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:i,depth:n,widthSegments:r,heightSegments:s,depthSegments:a};const o=this;r=Math.floor(r),s=Math.floor(s),a=Math.floor(a);const l=[],c=[],u=[],h=[];let d=0,p=0;f("z","y","x",-1,-1,n,i,t,a,s,0),f("z","y","x",1,-1,n,i,-t,a,s,1),f("x","z","y",1,1,t,n,i,r,a,2),f("x","z","y",1,-1,t,n,-i,r,a,3),f("x","y","z",1,-1,t,i,n,r,s,4),f("x","y","z",-1,-1,t,i,-n,r,s,5),this.setIndex(l),this.setAttribute("position",new ss(c,3)),this.setAttribute("normal",new ss(u,3)),this.setAttribute("uv",new ss(h,2));function f(v,m,g,y,x,_,b,w,M,S,C){const E=_/M,P=b/S,I=_/2,D=b/2,L=w/2,B=M+1,j=S+1;let z=0,O=0;const H=new fe;for(let k=0;k<j;k++){const N=k*P-D;for(let F=0;F<B;F++){const Q=F*E-I;H[v]=Q*y,H[m]=N*x,H[g]=L,c.push(H.x,H.y,H.z),H[v]=0,H[m]=0,H[g]=w>0?1:-1,u.push(H.x,H.y,H.z),h.push(F/M),h.push(1-k/S),z+=1}}for(let k=0;k<S;k++)for(let N=0;N<M;N++){const F=d+N+B*k,Q=d+N+B*(k+1),G=d+(N+1)+B*(k+1),K=d+(N+1)+B*k;l.push(F,Q,K),l.push(Q,G,K),O+=6}o.addGroup(p,O,C),p+=O,d+=z}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new mg(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function Up(e){const t={};for(const i in e){t[i]={};for(const n in e[i]){const r=e[i][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[i][n]=null):t[i][n]=r.clone():Array.isArray(r)?t[i][n]=r.slice():t[i][n]=r}}return t}function ir(e){const t={};for(let i=0;i<e.length;i++){const n=Up(e[i]);for(const r in n)t[r]=n[r]}return t}function Q_e(e){const t=[];for(let i=0;i<e.length;i++)t.push(e[i].clone());return t}function ck(e){return e.getRenderTarget()===null?e.outputColorSpace:lo}const K_e={clone:Up,merge:ir};var $_e=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,J_e=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class $h extends fg{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=$_e,this.fragmentShader=J_e,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,t!==void 0&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Up(t.uniforms),this.uniformsGroups=Q_e(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const i=super.toJSON(t);i.glslVersion=this.glslVersion,i.uniforms={};for(const r in this.uniforms){const a=this.uniforms[r].value;a&&a.isTexture?i.uniforms[r]={type:"t",value:a.toJSON(t).uuid}:a&&a.isColor?i.uniforms[r]={type:"c",value:a.getHex()}:a&&a.isVector2?i.uniforms[r]={type:"v2",value:a.toArray()}:a&&a.isVector3?i.uniforms[r]={type:"v3",value:a.toArray()}:a&&a.isVector4?i.uniforms[r]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?i.uniforms[r]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?i.uniforms[r]={type:"m4",value:a.toArray()}:i.uniforms[r]={value:a}}Object.keys(this.defines).length>0&&(i.defines=this.defines),i.vertexShader=this.vertexShader,i.fragmentShader=this.fragmentShader,i.lights=this.lights,i.clipping=this.clipping;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(i.extensions=n),i}}class hk extends mr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ki,this.projectionMatrix=new Ki,this.projectionMatrixInverse=new Ki,this.coordinateSystem=Ko}copy(t,i){return super.copy(t,i),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this.coordinateSystem=t.coordinateSystem,this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return t.set(-i[8],-i[9],-i[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,i){super.updateWorldMatrix(t,i),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class Kr extends hk{constructor(t=50,i=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=i,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,i){return super.copy(t,i),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const i=.5*this.getFilmHeight()/t;this.fov=H0*2*Math.atan(i),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan($m*.5*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return H0*2*Math.atan(Math.tan($m*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,i,n,r,s,a){this.aspect=t/i,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=i,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let i=t*Math.tan($m*.5*this.fov)/this.zoom,n=2*i,r=this.aspect*n,s=-.5*r;const a=this.view;if(this.view!==null&&this.view.enabled){const l=a.fullWidth,c=a.fullHeight;s+=a.offsetX*r/l,i-=a.offsetY*n/c,r*=a.width/l,n*=a.height/c}const o=this.filmOffset;o!==0&&(s+=t*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,i,i-n,t,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const i=super.toJSON(t);return i.object.fov=this.fov,i.object.zoom=this.zoom,i.object.near=this.near,i.object.far=this.far,i.object.focus=this.focus,i.object.aspect=this.aspect,this.view!==null&&(i.object.view=Object.assign({},this.view)),i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i}}const nd=-90,rd=1;class ebe extends mr{constructor(t,i,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null;const r=new Kr(nd,rd,t,i);r.layers=this.layers,this.add(r);const s=new Kr(nd,rd,t,i);s.layers=this.layers,this.add(s);const a=new Kr(nd,rd,t,i);a.layers=this.layers,this.add(a);const o=new Kr(nd,rd,t,i);o.layers=this.layers,this.add(o);const l=new Kr(nd,rd,t,i);l.layers=this.layers,this.add(l);const c=new Kr(nd,rd,t,i);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const t=this.coordinateSystem,i=this.children.concat(),[n,r,s,a,o,l]=i;for(const c of i)this.remove(c);if(t===Ko)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(t===Mx)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+t);for(const c of i)this.add(c),c.updateMatrixWorld()}update(t,i){this.parent===null&&this.updateMatrixWorld();const n=this.renderTarget;this.coordinateSystem!==t.coordinateSystem&&(this.coordinateSystem=t.coordinateSystem,this.updateCoordinateSystem());const[r,s,a,o,l,c]=this.children,u=t.getRenderTarget(),h=t.xr.enabled;t.xr.enabled=!1;const d=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0),t.render(i,r),t.setRenderTarget(n,1),t.render(i,s),t.setRenderTarget(n,2),t.render(i,a),t.setRenderTarget(n,3),t.render(i,o),t.setRenderTarget(n,4),t.render(i,l),n.texture.generateMipmaps=d,t.setRenderTarget(n,5),t.render(i,c),t.setRenderTarget(u),t.xr.enabled=h,n.texture.needsPMREMUpdate=!0}}class i4 extends Nr{constructor(t,i,n,r,s,a,o,l,c,u){t=t!==void 0?t:[],i=i!==void 0?i:Op,super(t,i,n,r,s,a,o,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}class tbe extends Qh{constructor(t=1,i={}){super(t,t,i),this.isWebGLCubeRenderTarget=!0;const n={width:t,height:t,depth:1},r=[n,n,n,n,n,n];i.encoding!==void 0&&(e0("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===Nh?gi:Uh),this.texture=new i4(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:As}fromEquirectangularTexture(t,i){this.texture.type=i.type,this.texture.colorSpace=i.colorSpace,this.texture.generateMipmaps=i.generateMipmaps,this.texture.minFilter=i.minFilter,this.texture.magFilter=i.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new mg(5,5,5),s=new $h({name:"CubemapFromEquirect",uniforms:Up(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:Br,blending:wc});s.uniforms.tEquirect.value=i;const a=new da(r,s),o=i.minFilter;return i.minFilter===k0&&(i.minFilter=As),new ebe(1,10,this).update(t,a),i.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(t,i,n,r){const s=t.getRenderTarget();for(let a=0;a<6;a++)t.setRenderTarget(this,a),t.clear(i,n,r);t.setRenderTarget(s)}}const Fw=new fe,ibe=new fe,nbe=new Ut;class Vl{constructor(t=new fe(1,0,0),i=0){this.isPlane=!0,this.normal=t,this.constant=i}set(t,i){return this.normal.copy(t),this.constant=i,this}setComponents(t,i,n,r){return this.normal.set(t,i,n),this.constant=r,this}setFromNormalAndCoplanarPoint(t,i){return this.normal.copy(t),this.constant=-i.dot(this.normal),this}setFromCoplanarPoints(t,i,n){const r=Fw.subVectors(n,i).cross(ibe.subVectors(t,i)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,i){return i.copy(t).addScaledVector(this.normal,-this.distanceToPoint(t))}intersectLine(t,i){const n=t.delta(Fw),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(t.start)===0?i.copy(t.start):null;const s=-(t.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:i.copy(t.start).addScaledVector(n,s)}intersectsLine(t){const i=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return i<0&&n>0||n<0&&i>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,i){const n=i||nbe.getNormalMatrix(t),r=this.coplanarPoint(Fw).applyMatrix4(t),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Jc=new t4,vv=new fe;class n4{constructor(t=new Vl,i=new Vl,n=new Vl,r=new Vl,s=new Vl,a=new Vl){this.planes=[t,i,n,r,s,a]}set(t,i,n,r,s,a){const o=this.planes;return o[0].copy(t),o[1].copy(i),o[2].copy(n),o[3].copy(r),o[4].copy(s),o[5].copy(a),this}copy(t){const i=this.planes;for(let n=0;n<6;n++)i[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t,i=Ko){const n=this.planes,r=t.elements,s=r[0],a=r[1],o=r[2],l=r[3],c=r[4],u=r[5],h=r[6],d=r[7],p=r[8],f=r[9],v=r[10],m=r[11],g=r[12],y=r[13],x=r[14],_=r[15];if(n[0].setComponents(l-s,d-c,m-p,_-g).normalize(),n[1].setComponents(l+s,d+c,m+p,_+g).normalize(),n[2].setComponents(l+a,d+u,m+f,_+y).normalize(),n[3].setComponents(l-a,d-u,m-f,_-y).normalize(),n[4].setComponents(l-o,d-h,m-v,_-x).normalize(),i===Ko)n[5].setComponents(l+o,d+h,m+v,_+x).normalize();else if(i===Mx)n[5].setComponents(o,h,v,x).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+i);return this}intersectsObject(t){if(t.boundingSphere!==void 0)t.boundingSphere===null&&t.computeBoundingSphere(),Jc.copy(t.boundingSphere).applyMatrix4(t.matrixWorld);else{const i=t.geometry;i.boundingSphere===null&&i.computeBoundingSphere(),Jc.copy(i.boundingSphere).applyMatrix4(t.matrixWorld)}return this.intersectsSphere(Jc)}intersectsSprite(t){return Jc.center.set(0,0,0),Jc.radius=.7071067811865476,Jc.applyMatrix4(t.matrixWorld),this.intersectsSphere(Jc)}intersectsSphere(t){const i=this.planes,n=t.center,r=-t.radius;for(let s=0;s<6;s++)if(i[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(t){const i=this.planes;for(let n=0;n<6;n++){const r=i[n];if(vv.x=r.normal.x>0?t.max.x:t.min.x,vv.y=r.normal.y>0?t.max.y:t.min.y,vv.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(vv)<0)return!1}return!0}containsPoint(t){const i=this.planes;for(let n=0;n<6;n++)if(i[n].distanceToPoint(t)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function uk(){let e=null,t=!1,i=null,n=null;function r(s,a){i(s,a),n=e.requestAnimationFrame(r)}return{start:function(){t!==!0&&i!==null&&(n=e.requestAnimationFrame(r),t=!0)},stop:function(){e.cancelAnimationFrame(n),t=!1},setAnimationLoop:function(s){i=s},setContext:function(s){e=s}}}function rbe(e,t){const i=t.isWebGL2,n=new WeakMap;function r(c,u){const h=c.array,d=c.usage,p=e.createBuffer();e.bindBuffer(u,p),e.bufferData(u,h,d),c.onUploadCallback();let f;if(h instanceof Float32Array)f=e.FLOAT;else if(h instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(i)f=e.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else f=e.UNSIGNED_SHORT;else if(h instanceof Int16Array)f=e.SHORT;else if(h instanceof Uint32Array)f=e.UNSIGNED_INT;else if(h instanceof Int32Array)f=e.INT;else if(h instanceof Int8Array)f=e.BYTE;else if(h instanceof Uint8Array)f=e.UNSIGNED_BYTE;else if(h instanceof Uint8ClampedArray)f=e.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:p,type:f,bytesPerElement:h.BYTES_PER_ELEMENT,version:c.version}}function s(c,u,h){const d=u.array,p=u.updateRange;e.bindBuffer(h,c),p.count===-1?e.bufferSubData(h,0,d):(i?e.bufferSubData(h,p.offset*d.BYTES_PER_ELEMENT,d,p.offset,p.count):e.bufferSubData(h,p.offset*d.BYTES_PER_ELEMENT,d.subarray(p.offset,p.offset+p.count)),p.count=-1),u.onUploadCallback()}function a(c){return c.isInterleavedBufferAttribute&&(c=c.data),n.get(c)}function o(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=n.get(c);u&&(e.deleteBuffer(u.buffer),n.delete(c))}function l(c,u){if(c.isGLBufferAttribute){const d=n.get(c);(!d||d.version<c.version)&&n.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);const h=n.get(c);h===void 0?n.set(c,r(c,u)):h.version<c.version&&(s(h.buffer,c,u),h.version=c.version)}return{get:a,remove:o,update:l}}class r4 extends ml{constructor(t=1,i=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:i,widthSegments:n,heightSegments:r};const s=t/2,a=i/2,o=Math.floor(n),l=Math.floor(r),c=o+1,u=l+1,h=t/o,d=i/l,p=[],f=[],v=[],m=[];for(let g=0;g<u;g++){const y=g*d-a;for(let x=0;x<c;x++){const _=x*h-s;f.push(_,-y,0),v.push(0,0,1),m.push(x/o),m.push(1-g/l)}}for(let g=0;g<l;g++)for(let y=0;y<o;y++){const x=y+c*g,_=y+c*(g+1),b=y+1+c*(g+1),w=y+1+c*g;p.push(x,_,w),p.push(_,b,w)}this.setIndex(p),this.setAttribute("position",new ss(f,3)),this.setAttribute("normal",new ss(v,3)),this.setAttribute("uv",new ss(m,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new r4(t.width,t.height,t.widthSegments,t.heightSegments)}}var sbe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,abe=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,obe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,lbe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,cbe=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,hbe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,ube=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,dbe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,pbe=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,fbe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,mbe=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,gbe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,vbe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,ybe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,xbe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,_be=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,bbe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,wbe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Sbe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Mbe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,Cbe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Ebe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,Abe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Tbe=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Pbe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Dbe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,Lbe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Rbe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Ibe="gl_FragColor = linearToOutputTexel( gl_FragColor );",Obe=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Bbe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Nbe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Ube=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Fbe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,zbe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,kbe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Vbe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,Hbe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Gbe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,jbe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,Wbe=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,Xbe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,qbe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Ybe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,Zbe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Qbe=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,Kbe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,$be=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Jbe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,ewe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,twe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	anisotropyV /= material.anisotropy;
	material.anisotropy = saturate( material.anisotropy );
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;
#endif`,iwe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,nwe=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,rwe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometry.viewDir, geometry.normal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,swe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,awe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,owe=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,lwe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,cwe=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,hwe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,uwe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,dwe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,pwe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,fwe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,mwe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,gwe=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,vwe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,ywe=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,xwe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,_we=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 geometryNormal = normal;`,bwe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,wwe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Swe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Mwe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Cwe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Ewe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,Awe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,Twe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Pwe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Dwe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Lwe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Rwe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Iwe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Owe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Bwe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Nwe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Uwe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Fwe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,zwe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,kwe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Vwe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Hwe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Gwe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,jwe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Wwe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Xwe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,qwe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Ywe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Zwe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Qwe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,Kwe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,$we=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Jwe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,e3e=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,t3e=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const i3e=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,n3e=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,r3e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,s3e=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,a3e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,o3e=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,l3e=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,c3e=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,h3e=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,u3e=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,d3e=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,p3e=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,f3e=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,m3e=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,g3e=`#include <common>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,v3e=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,y3e=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,x3e=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,_3e=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,b3e=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,w3e=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,S3e=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,M3e=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,C3e=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,E3e=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,A3e=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,T3e=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,P3e=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,D3e=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,L3e=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,R3e=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,I3e=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,O3e=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,B3e=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,It={alphahash_fragment:sbe,alphahash_pars_fragment:abe,alphamap_fragment:obe,alphamap_pars_fragment:lbe,alphatest_fragment:cbe,alphatest_pars_fragment:hbe,aomap_fragment:ube,aomap_pars_fragment:dbe,begin_vertex:pbe,beginnormal_vertex:fbe,bsdfs:mbe,iridescence_fragment:gbe,bumpmap_pars_fragment:vbe,clipping_planes_fragment:ybe,clipping_planes_pars_fragment:xbe,clipping_planes_pars_vertex:_be,clipping_planes_vertex:bbe,color_fragment:wbe,color_pars_fragment:Sbe,color_pars_vertex:Mbe,color_vertex:Cbe,common:Ebe,cube_uv_reflection_fragment:Abe,defaultnormal_vertex:Tbe,displacementmap_pars_vertex:Pbe,displacementmap_vertex:Dbe,emissivemap_fragment:Lbe,emissivemap_pars_fragment:Rbe,colorspace_fragment:Ibe,colorspace_pars_fragment:Obe,envmap_fragment:Bbe,envmap_common_pars_fragment:Nbe,envmap_pars_fragment:Ube,envmap_pars_vertex:Fbe,envmap_physical_pars_fragment:Qbe,envmap_vertex:zbe,fog_vertex:kbe,fog_pars_vertex:Vbe,fog_fragment:Hbe,fog_pars_fragment:Gbe,gradientmap_pars_fragment:jbe,lightmap_fragment:Wbe,lightmap_pars_fragment:Xbe,lights_lambert_fragment:qbe,lights_lambert_pars_fragment:Ybe,lights_pars_begin:Zbe,lights_toon_fragment:Kbe,lights_toon_pars_fragment:$be,lights_phong_fragment:Jbe,lights_phong_pars_fragment:ewe,lights_physical_fragment:twe,lights_physical_pars_fragment:iwe,lights_fragment_begin:nwe,lights_fragment_maps:rwe,lights_fragment_end:swe,logdepthbuf_fragment:awe,logdepthbuf_pars_fragment:owe,logdepthbuf_pars_vertex:lwe,logdepthbuf_vertex:cwe,map_fragment:hwe,map_pars_fragment:uwe,map_particle_fragment:dwe,map_particle_pars_fragment:pwe,metalnessmap_fragment:fwe,metalnessmap_pars_fragment:mwe,morphcolor_vertex:gwe,morphnormal_vertex:vwe,morphtarget_pars_vertex:ywe,morphtarget_vertex:xwe,normal_fragment_begin:_we,normal_fragment_maps:bwe,normal_pars_fragment:wwe,normal_pars_vertex:Swe,normal_vertex:Mwe,normalmap_pars_fragment:Cwe,clearcoat_normal_fragment_begin:Ewe,clearcoat_normal_fragment_maps:Awe,clearcoat_pars_fragment:Twe,iridescence_pars_fragment:Pwe,opaque_fragment:Dwe,packing:Lwe,premultiplied_alpha_fragment:Rwe,project_vertex:Iwe,dithering_fragment:Owe,dithering_pars_fragment:Bwe,roughnessmap_fragment:Nwe,roughnessmap_pars_fragment:Uwe,shadowmap_pars_fragment:Fwe,shadowmap_pars_vertex:zwe,shadowmap_vertex:kwe,shadowmask_pars_fragment:Vwe,skinbase_vertex:Hwe,skinning_pars_vertex:Gwe,skinning_vertex:jwe,skinnormal_vertex:Wwe,specularmap_fragment:Xwe,specularmap_pars_fragment:qwe,tonemapping_fragment:Ywe,tonemapping_pars_fragment:Zwe,transmission_fragment:Qwe,transmission_pars_fragment:Kwe,uv_pars_fragment:$we,uv_pars_vertex:Jwe,uv_vertex:e3e,worldpos_vertex:t3e,background_vert:i3e,background_frag:n3e,backgroundCube_vert:r3e,backgroundCube_frag:s3e,cube_vert:a3e,cube_frag:o3e,depth_vert:l3e,depth_frag:c3e,distanceRGBA_vert:h3e,distanceRGBA_frag:u3e,equirect_vert:d3e,equirect_frag:p3e,linedashed_vert:f3e,linedashed_frag:m3e,meshbasic_vert:g3e,meshbasic_frag:v3e,meshlambert_vert:y3e,meshlambert_frag:x3e,meshmatcap_vert:_3e,meshmatcap_frag:b3e,meshnormal_vert:w3e,meshnormal_frag:S3e,meshphong_vert:M3e,meshphong_frag:C3e,meshphysical_vert:E3e,meshphysical_frag:A3e,meshtoon_vert:T3e,meshtoon_frag:P3e,points_vert:D3e,points_frag:L3e,shadow_vert:R3e,shadow_frag:I3e,sprite_vert:O3e,sprite_frag:B3e},Ye={common:{diffuse:{value:new ri(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Ut},alphaMap:{value:null},alphaMapTransform:{value:new Ut},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Ut}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Ut}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Ut}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Ut},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Ut},normalScale:{value:new Pt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Ut},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Ut}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Ut}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Ut}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ri(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new ri(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Ut},alphaTest:{value:0},uvTransform:{value:new Ut}},sprite:{diffuse:{value:new ri(16777215)},opacity:{value:1},center:{value:new Pt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Ut},alphaMap:{value:null},alphaMapTransform:{value:new Ut},alphaTest:{value:0}}},Ha={basic:{uniforms:ir([Ye.common,Ye.specularmap,Ye.envmap,Ye.aomap,Ye.lightmap,Ye.fog]),vertexShader:It.meshbasic_vert,fragmentShader:It.meshbasic_frag},lambert:{uniforms:ir([Ye.common,Ye.specularmap,Ye.envmap,Ye.aomap,Ye.lightmap,Ye.emissivemap,Ye.bumpmap,Ye.normalmap,Ye.displacementmap,Ye.fog,Ye.lights,{emissive:{value:new ri(0)}}]),vertexShader:It.meshlambert_vert,fragmentShader:It.meshlambert_frag},phong:{uniforms:ir([Ye.common,Ye.specularmap,Ye.envmap,Ye.aomap,Ye.lightmap,Ye.emissivemap,Ye.bumpmap,Ye.normalmap,Ye.displacementmap,Ye.fog,Ye.lights,{emissive:{value:new ri(0)},specular:{value:new ri(1118481)},shininess:{value:30}}]),vertexShader:It.meshphong_vert,fragmentShader:It.meshphong_frag},standard:{uniforms:ir([Ye.common,Ye.envmap,Ye.aomap,Ye.lightmap,Ye.emissivemap,Ye.bumpmap,Ye.normalmap,Ye.displacementmap,Ye.roughnessmap,Ye.metalnessmap,Ye.fog,Ye.lights,{emissive:{value:new ri(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:It.meshphysical_vert,fragmentShader:It.meshphysical_frag},toon:{uniforms:ir([Ye.common,Ye.aomap,Ye.lightmap,Ye.emissivemap,Ye.bumpmap,Ye.normalmap,Ye.displacementmap,Ye.gradientmap,Ye.fog,Ye.lights,{emissive:{value:new ri(0)}}]),vertexShader:It.meshtoon_vert,fragmentShader:It.meshtoon_frag},matcap:{uniforms:ir([Ye.common,Ye.bumpmap,Ye.normalmap,Ye.displacementmap,Ye.fog,{matcap:{value:null}}]),vertexShader:It.meshmatcap_vert,fragmentShader:It.meshmatcap_frag},points:{uniforms:ir([Ye.points,Ye.fog]),vertexShader:It.points_vert,fragmentShader:It.points_frag},dashed:{uniforms:ir([Ye.common,Ye.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:It.linedashed_vert,fragmentShader:It.linedashed_frag},depth:{uniforms:ir([Ye.common,Ye.displacementmap]),vertexShader:It.depth_vert,fragmentShader:It.depth_frag},normal:{uniforms:ir([Ye.common,Ye.bumpmap,Ye.normalmap,Ye.displacementmap,{opacity:{value:1}}]),vertexShader:It.meshnormal_vert,fragmentShader:It.meshnormal_frag},sprite:{uniforms:ir([Ye.sprite,Ye.fog]),vertexShader:It.sprite_vert,fragmentShader:It.sprite_frag},background:{uniforms:{uvTransform:{value:new Ut},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:It.background_vert,fragmentShader:It.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:It.backgroundCube_vert,fragmentShader:It.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:It.cube_vert,fragmentShader:It.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:It.equirect_vert,fragmentShader:It.equirect_frag},distanceRGBA:{uniforms:ir([Ye.common,Ye.displacementmap,{referencePosition:{value:new fe},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:It.distanceRGBA_vert,fragmentShader:It.distanceRGBA_frag},shadow:{uniforms:ir([Ye.lights,Ye.fog,{color:{value:new ri(0)},opacity:{value:1}}]),vertexShader:It.shadow_vert,fragmentShader:It.shadow_frag}};Ha.physical={uniforms:ir([Ha.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Ut},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Ut},clearcoatNormalScale:{value:new Pt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Ut},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Ut},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Ut},sheen:{value:0},sheenColor:{value:new ri(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Ut},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Ut},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Ut},transmissionSamplerSize:{value:new Pt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Ut},attenuationDistance:{value:0},attenuationColor:{value:new ri(0)},specularColor:{value:new ri(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Ut},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Ut},anisotropyVector:{value:new Pt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Ut}}]),vertexShader:It.meshphysical_vert,fragmentShader:It.meshphysical_frag};const yv={r:0,b:0,g:0};function N3e(e,t,i,n,r,s,a){const o=new ri(0);let l=s===!0?0:1,c,u,h=null,d=0,p=null;function f(m,g){let y=!1,x=g.isScene===!0?g.background:null;x&&x.isTexture&&(x=(g.backgroundBlurriness>0?i:t).get(x)),x===null?v(o,l):x&&x.isColor&&(v(x,1),y=!0);const _=e.xr.getEnvironmentBlendMode();_==="additive"?n.buffers.color.setClear(0,0,0,1,a):_==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,a),(e.autoClear||y)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),x&&(x.isCubeTexture||x.mapping===P2)?(u===void 0&&(u=new da(new mg(1,1,1),new $h({name:"BackgroundCubeMaterial",uniforms:Up(Ha.backgroundCube.uniforms),vertexShader:Ha.backgroundCube.vertexShader,fragmentShader:Ha.backgroundCube.fragmentShader,side:Br,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(b,w,M){this.matrixWorld.copyPosition(M.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),u.material.uniforms.envMap.value=x,u.material.uniforms.flipEnvMap.value=x.isCubeTexture&&x.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=g.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,u.material.toneMapped=x.colorSpace!==gi,(h!==x||d!==x.version||p!==e.toneMapping)&&(u.material.needsUpdate=!0,h=x,d=x.version,p=e.toneMapping),u.layers.enableAll(),m.unshift(u,u.geometry,u.material,0,0,null)):x&&x.isTexture&&(c===void 0&&(c=new da(new r4(2,2),new $h({name:"BackgroundMaterial",uniforms:Up(Ha.background.uniforms),vertexShader:Ha.background.vertexShader,fragmentShader:Ha.background.fragmentShader,side:Rc,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(c)),c.material.uniforms.t2D.value=x,c.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,c.material.toneMapped=x.colorSpace!==gi,x.matrixAutoUpdate===!0&&x.updateMatrix(),c.material.uniforms.uvTransform.value.copy(x.matrix),(h!==x||d!==x.version||p!==e.toneMapping)&&(c.material.needsUpdate=!0,h=x,d=x.version,p=e.toneMapping),c.layers.enableAll(),m.unshift(c,c.geometry,c.material,0,0,null))}function v(m,g){m.getRGB(yv,ck(e)),n.buffers.color.setClear(yv.r,yv.g,yv.b,g,a)}return{getClearColor:function(){return o},setClearColor:function(m,g=1){o.set(m),l=g,v(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(m){l=m,v(o,l)},render:f}}function U3e(e,t,i,n){const r=e.getParameter(e.MAX_VERTEX_ATTRIBS),s=n.isWebGL2?null:t.get("OES_vertex_array_object"),a=n.isWebGL2||s!==null,o={},l=m(null);let c=l,u=!1;function h(L,B,j,z,O){let H=!1;if(a){const k=v(z,j,B);c!==k&&(c=k,p(c.object)),H=g(L,z,j,O),H&&y(L,z,j,O)}else{const k=B.wireframe===!0;(c.geometry!==z.id||c.program!==j.id||c.wireframe!==k)&&(c.geometry=z.id,c.program=j.id,c.wireframe=k,H=!0)}O!==null&&i.update(O,e.ELEMENT_ARRAY_BUFFER),(H||u)&&(u=!1,S(L,B,j,z),O!==null&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,i.get(O).buffer))}function d(){return n.isWebGL2?e.createVertexArray():s.createVertexArrayOES()}function p(L){return n.isWebGL2?e.bindVertexArray(L):s.bindVertexArrayOES(L)}function f(L){return n.isWebGL2?e.deleteVertexArray(L):s.deleteVertexArrayOES(L)}function v(L,B,j){const z=j.wireframe===!0;let O=o[L.id];O===void 0&&(O={},o[L.id]=O);let H=O[B.id];H===void 0&&(H={},O[B.id]=H);let k=H[z];return k===void 0&&(k=m(d()),H[z]=k),k}function m(L){const B=[],j=[],z=[];for(let O=0;O<r;O++)B[O]=0,j[O]=0,z[O]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:B,enabledAttributes:j,attributeDivisors:z,object:L,attributes:{},index:null}}function g(L,B,j,z){const O=c.attributes,H=B.attributes;let k=0;const N=j.getAttributes();for(const F in N)if(N[F].location>=0){const G=O[F];let K=H[F];if(K===void 0&&(F==="instanceMatrix"&&L.instanceMatrix&&(K=L.instanceMatrix),F==="instanceColor"&&L.instanceColor&&(K=L.instanceColor)),G===void 0||G.attribute!==K||K&&G.data!==K.data)return!0;k++}return c.attributesNum!==k||c.index!==z}function y(L,B,j,z){const O={},H=B.attributes;let k=0;const N=j.getAttributes();for(const F in N)if(N[F].location>=0){let G=H[F];G===void 0&&(F==="instanceMatrix"&&L.instanceMatrix&&(G=L.instanceMatrix),F==="instanceColor"&&L.instanceColor&&(G=L.instanceColor));const K={};K.attribute=G,G&&G.data&&(K.data=G.data),O[F]=K,k++}c.attributes=O,c.attributesNum=k,c.index=z}function x(){const L=c.newAttributes;for(let B=0,j=L.length;B<j;B++)L[B]=0}function _(L){b(L,0)}function b(L,B){const j=c.newAttributes,z=c.enabledAttributes,O=c.attributeDivisors;j[L]=1,z[L]===0&&(e.enableVertexAttribArray(L),z[L]=1),O[L]!==B&&((n.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[n.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](L,B),O[L]=B)}function w(){const L=c.newAttributes,B=c.enabledAttributes;for(let j=0,z=B.length;j<z;j++)B[j]!==L[j]&&(e.disableVertexAttribArray(j),B[j]=0)}function M(L,B,j,z,O,H,k){k===!0?e.vertexAttribIPointer(L,B,j,O,H):e.vertexAttribPointer(L,B,j,z,O,H)}function S(L,B,j,z){if(n.isWebGL2===!1&&(L.isInstancedMesh||z.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)return;x();const O=z.attributes,H=j.getAttributes(),k=B.defaultAttributeValues;for(const N in H){const F=H[N];if(F.location>=0){let Q=O[N];if(Q===void 0&&(N==="instanceMatrix"&&L.instanceMatrix&&(Q=L.instanceMatrix),N==="instanceColor"&&L.instanceColor&&(Q=L.instanceColor)),Q!==void 0){const G=Q.normalized,K=Q.itemSize,W=i.get(Q);if(W===void 0)continue;const se=W.buffer,ie=W.type,re=W.bytesPerElement,de=n.isWebGL2===!0&&(ie===e.INT||ie===e.UNSIGNED_INT||Q.gpuType===Xz);if(Q.isInterleavedBufferAttribute){const he=Q.data,X=he.stride,Ee=Q.offset;if(he.isInstancedInterleavedBuffer){for(let Oe=0;Oe<F.locationSize;Oe++)b(F.location+Oe,he.meshPerAttribute);L.isInstancedMesh!==!0&&z._maxInstanceCount===void 0&&(z._maxInstanceCount=he.meshPerAttribute*he.count)}else for(let Oe=0;Oe<F.locationSize;Oe++)_(F.location+Oe);e.bindBuffer(e.ARRAY_BUFFER,se);for(let Oe=0;Oe<F.locationSize;Oe++)M(F.location+Oe,K/F.locationSize,ie,G,X*re,(Ee+K/F.locationSize*Oe)*re,de)}else{if(Q.isInstancedBufferAttribute){for(let he=0;he<F.locationSize;he++)b(F.location+he,Q.meshPerAttribute);L.isInstancedMesh!==!0&&z._maxInstanceCount===void 0&&(z._maxInstanceCount=Q.meshPerAttribute*Q.count)}else for(let he=0;he<F.locationSize;he++)_(F.location+he);e.bindBuffer(e.ARRAY_BUFFER,se);for(let he=0;he<F.locationSize;he++)M(F.location+he,K/F.locationSize,ie,G,K*re,K/F.locationSize*he*re,de)}}else if(k!==void 0){const G=k[N];if(G!==void 0)switch(G.length){case 2:e.vertexAttrib2fv(F.location,G);break;case 3:e.vertexAttrib3fv(F.location,G);break;case 4:e.vertexAttrib4fv(F.location,G);break;default:e.vertexAttrib1fv(F.location,G)}}}}w()}function C(){I();for(const L in o){const B=o[L];for(const j in B){const z=B[j];for(const O in z)f(z[O].object),delete z[O];delete B[j]}delete o[L]}}function E(L){if(o[L.id]===void 0)return;const B=o[L.id];for(const j in B){const z=B[j];for(const O in z)f(z[O].object),delete z[O];delete B[j]}delete o[L.id]}function P(L){for(const B in o){const j=o[B];if(j[L.id]===void 0)continue;const z=j[L.id];for(const O in z)f(z[O].object),delete z[O];delete j[L.id]}}function I(){D(),u=!0,c!==l&&(c=l,p(c.object))}function D(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:h,reset:I,resetDefaultState:D,dispose:C,releaseStatesOfGeometry:E,releaseStatesOfProgram:P,initAttributes:x,enableAttribute:_,disableUnusedAttributes:w}}function F3e(e,t,i,n){const r=n.isWebGL2;let s;function a(c){s=c}function o(c,u){e.drawArrays(s,c,u),i.update(u,s,1)}function l(c,u,h){if(h===0)return;let d,p;if(r)d=e,p="drawArraysInstanced";else if(d=t.get("ANGLE_instanced_arrays"),p="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[p](s,c,u,h),i.update(u,s,h)}this.setMode=a,this.render=o,this.renderInstances=l}function z3e(e,t,i){let n;function r(){if(n!==void 0)return n;if(t.has("EXT_texture_filter_anisotropic")===!0){const M=t.get("EXT_texture_filter_anisotropic");n=e.getParameter(M.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else n=0;return n}function s(M){if(M==="highp"){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";M="mediump"}return M==="mediump"&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const a=typeof WebGL2RenderingContext<"u"&&e.constructor.name==="WebGL2RenderingContext";let o=i.precision!==void 0?i.precision:"highp";const l=s(o);l!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",l,"instead."),o=l);const c=a||t.has("WEBGL_draw_buffers"),u=i.logarithmicDepthBuffer===!0,h=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),d=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),p=e.getParameter(e.MAX_TEXTURE_SIZE),f=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),v=e.getParameter(e.MAX_VERTEX_ATTRIBS),m=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),g=e.getParameter(e.MAX_VARYING_VECTORS),y=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),x=d>0,_=a||t.has("OES_texture_float"),b=x&&_,w=a?e.getParameter(e.MAX_SAMPLES):0;return{isWebGL2:a,drawBuffers:c,getMaxAnisotropy:r,getMaxPrecision:s,precision:o,logarithmicDepthBuffer:u,maxTextures:h,maxVertexTextures:d,maxTextureSize:p,maxCubemapSize:f,maxAttributes:v,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:y,vertexTextures:x,floatFragmentTextures:_,floatVertexTextures:b,maxSamples:w}}function k3e(e){const t=this;let i=null,n=0,r=!1,s=!1;const a=new Vl,o=new Ut,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d){const p=h.length!==0||d||n!==0||r;return r=d,n=h.length,p},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,d){i=u(h,d,0)},this.setState=function(h,d,p){const f=h.clippingPlanes,v=h.clipIntersection,m=h.clipShadows,g=e.get(h);if(!r||f===null||f.length===0||s&&!m)s?u(null):c();else{const y=s?0:n,x=y*4;let _=g.clippingState||null;l.value=_,_=u(f,d,x,p);for(let b=0;b!==x;++b)_[b]=i[b];g.clippingState=_,this.numIntersection=v?this.numPlanes:0,this.numPlanes+=y}};function c(){l.value!==i&&(l.value=i,l.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function u(h,d,p,f){const v=h!==null?h.length:0;let m=null;if(v!==0){if(m=l.value,f!==!0||m===null){const g=p+v*4,y=d.matrixWorldInverse;o.getNormalMatrix(y),(m===null||m.length<g)&&(m=new Float32Array(g));for(let x=0,_=p;x!==v;++x,_+=4)a.copy(h[x]).applyMatrix4(y,o),a.normal.toArray(m,_),m[_+3]=a.constant}l.value=m,l.needsUpdate=!0}return t.numPlanes=v,t.numIntersection=0,m}}function V3e(e){let t=new WeakMap;function i(a,o){return o===XM?a.mapping=Op:o===qM&&(a.mapping=Bp),a}function n(a){if(a&&a.isTexture&&a.isRenderTargetTexture===!1){const o=a.mapping;if(o===XM||o===qM)if(t.has(a)){const l=t.get(a).texture;return i(l,a.mapping)}else{const l=a.image;if(l&&l.height>0){const c=new tbe(l.height/2);return c.fromEquirectangularTexture(e,a),t.set(a,c),a.addEventListener("dispose",r),i(c.texture,a.mapping)}else return null}}return a}function r(a){const o=a.target;o.removeEventListener("dispose",r);const l=t.get(o);l!==void 0&&(t.delete(o),l.dispose())}function s(){t=new WeakMap}return{get:n,dispose:s}}class H3e extends hk{constructor(t=-1,i=1,n=1,r=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=i,this.top=n,this.bottom=r,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(t,i){return super.copy(t,i),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this}setViewOffset(t,i,n,r,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=i,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-t,a=n+t,o=r+i,l=r-i;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,a=s+c*this.view.width,o-=u*this.view.offsetY,l=o-u*this.view.height}this.projectionMatrix.makeOrthographic(s,a,o,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const i=super.toJSON(t);return i.object.zoom=this.zoom,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,i.object.near=this.near,i.object.far=this.far,this.view!==null&&(i.object.view=Object.assign({},this.view)),i}}const Fd=4,Q7=[.125,.215,.35,.446,.526,.582],mh=20,zw=new H3e,K7=new ri;let kw=null;const lh=(1+Math.sqrt(5))/2,sd=1/lh,$7=[new fe(1,1,1),new fe(-1,1,1),new fe(1,1,-1),new fe(-1,1,-1),new fe(0,lh,sd),new fe(0,lh,-sd),new fe(sd,0,lh),new fe(-sd,0,lh),new fe(lh,sd,0),new fe(-lh,sd,0)];class J7{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t,i=0,n=.1,r=100){kw=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(t,n,r,s),i>0&&this._blur(s,0,0,i),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(t,i=null){return this._fromTexture(t,i)}fromCubemap(t,i=null){return this._fromTexture(t,i)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=iL(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=tL(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(kw),t.scissorTest=!1,xv(t,0,0,t.width,t.height)}_fromTexture(t,i){t.mapping===Op||t.mapping===Bp?this._setSize(t.image.length===0?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),kw=this._renderer.getRenderTarget();const n=i||this._allocateTargets();return this._textureToCubeUV(t,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const t=3*Math.max(this._cubeSize,112),i=4*this._cubeSize,n={magFilter:As,minFilter:As,generateMipmaps:!1,type:V0,format:sa,colorSpace:lo,depthBuffer:!1},r=eL(t,i,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==t||this._pingPongRenderTarget.height!==i){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=eL(t,i,n);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=G3e(s)),this._blurMaterial=j3e(s,t,i)}return r}_compileMaterial(t){const i=new da(this._lodPlanes[0],t);this._renderer.compile(i,zw)}_sceneToCubeUV(t,i,n,r){const o=new Kr(90,1,i,n),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,h=u.autoClear,d=u.toneMapping;u.getClearColor(K7),u.toneMapping=Sc,u.autoClear=!1;const p=new Ex({name:"PMREM.Background",side:Br,depthWrite:!1,depthTest:!1}),f=new da(new mg,p);let v=!1;const m=t.background;m?m.isColor&&(p.color.copy(m),t.background=null,v=!0):(p.color.copy(K7),v=!0);for(let g=0;g<6;g++){const y=g%3;y===0?(o.up.set(0,l[g],0),o.lookAt(c[g],0,0)):y===1?(o.up.set(0,0,l[g]),o.lookAt(0,c[g],0)):(o.up.set(0,l[g],0),o.lookAt(0,0,c[g]));const x=this._cubeSize;xv(r,y*x,g>2?x:0,x,x),u.setRenderTarget(r),v&&u.render(f,o),u.render(t,o)}f.geometry.dispose(),f.material.dispose(),u.toneMapping=d,u.autoClear=h,t.background=m}_textureToCubeUV(t,i){const n=this._renderer,r=t.mapping===Op||t.mapping===Bp;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=iL()),this._cubemapMaterial.uniforms.flipEnvMap.value=t.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=tL());const s=r?this._cubemapMaterial:this._equirectMaterial,a=new da(this._lodPlanes[0],s),o=s.uniforms;o.envMap.value=t;const l=this._cubeSize;xv(i,0,0,3*l,2*l),n.setRenderTarget(i),n.render(a,zw)}_applyPMREM(t){const i=this._renderer,n=i.autoClear;i.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),a=$7[(r-1)%$7.length];this._blur(t,r-1,r,s,a)}i.autoClear=n}_blur(t,i,n,r,s){const a=this._pingPongRenderTarget;this._halfBlur(t,a,i,n,r,"latitudinal",s),this._halfBlur(a,t,n,n,r,"longitudinal",s)}_halfBlur(t,i,n,r,s,a,o){const l=this._renderer,c=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const u=3,h=new da(this._lodPlanes[r],c),d=c.uniforms,p=this._sizeLods[n]-1,f=isFinite(s)?Math.PI/(2*p):2*Math.PI/(2*mh-1),v=s/f,m=isFinite(s)?1+Math.floor(u*v):mh;m>mh&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${m} samples when the maximum is set to ${mh}`);const g=[];let y=0;for(let M=0;M<mh;++M){const S=M/v,C=Math.exp(-S*S/2);g.push(C),M===0?y+=C:M<m&&(y+=2*C)}for(let M=0;M<g.length;M++)g[M]=g[M]/y;d.envMap.value=t.texture,d.samples.value=m,d.weights.value=g,d.latitudinal.value=a==="latitudinal",o&&(d.poleAxis.value=o);const{_lodMax:x}=this;d.dTheta.value=f,d.mipInt.value=x-n;const _=this._sizeLods[r],b=3*_*(r>x-Fd?r-x+Fd:0),w=4*(this._cubeSize-_);xv(i,b,w,3*_,2*_),l.setRenderTarget(i),l.render(h,zw)}}function G3e(e){const t=[],i=[],n=[];let r=e;const s=e-Fd+1+Q7.length;for(let a=0;a<s;a++){const o=Math.pow(2,r);i.push(o);let l=1/o;a>e-Fd?l=Q7[a-e+Fd-1]:a===0&&(l=0),n.push(l);const c=1/(o-2),u=-c,h=1+c,d=[u,u,h,u,h,h,u,u,h,h,u,h],p=6,f=6,v=3,m=2,g=1,y=new Float32Array(v*f*p),x=new Float32Array(m*f*p),_=new Float32Array(g*f*p);for(let w=0;w<p;w++){const M=w%3*2/3-1,S=w>2?0:-1,C=[M,S,0,M+2/3,S,0,M+2/3,S+1,0,M,S,0,M+2/3,S+1,0,M,S+1,0];y.set(C,v*f*w),x.set(d,m*f*w);const E=[w,w,w,w,w,w];_.set(E,g*f*w)}const b=new ml;b.setAttribute("position",new io(y,v)),b.setAttribute("uv",new io(x,m)),b.setAttribute("faceIndex",new io(_,g)),t.push(b),r>Fd&&r--}return{lodPlanes:t,sizeLods:i,sigmas:n}}function eL(e,t,i){const n=new Qh(e,t,i);return n.texture.mapping=P2,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function xv(e,t,i,n,r){e.viewport.set(t,i,n,r),e.scissor.set(t,i,n,r)}function j3e(e,t,i){const n=new Float32Array(mh),r=new fe(0,1,0);return new $h({name:"SphericalGaussianBlur",defines:{n:mh,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:s4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:wc,depthTest:!1,depthWrite:!1})}function tL(){return new $h({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:s4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:wc,depthTest:!1,depthWrite:!1})}function iL(){return new $h({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:s4(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:wc,depthTest:!1,depthWrite:!1})}function s4(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function W3e(e){let t=new WeakMap,i=null;function n(o){if(o&&o.isTexture){const l=o.mapping,c=l===XM||l===qM,u=l===Op||l===Bp;if(c||u)if(o.isRenderTargetTexture&&o.needsPMREMUpdate===!0){o.needsPMREMUpdate=!1;let h=t.get(o);return i===null&&(i=new J7(e)),h=c?i.fromEquirectangular(o,h):i.fromCubemap(o,h),t.set(o,h),h.texture}else{if(t.has(o))return t.get(o).texture;{const h=o.image;if(c&&h&&h.height>0||u&&h&&r(h)){i===null&&(i=new J7(e));const d=c?i.fromEquirectangular(o):i.fromCubemap(o);return t.set(o,d),o.addEventListener("dispose",s),d.texture}else return null}}}return o}function r(o){let l=0;const c=6;for(let u=0;u<c;u++)o[u]!==void 0&&l++;return l===c}function s(o){const l=o.target;l.removeEventListener("dispose",s);const c=t.get(l);c!==void 0&&(t.delete(l),c.dispose())}function a(){t=new WeakMap,i!==null&&(i.dispose(),i=null)}return{get:n,dispose:a}}function X3e(e){const t={};function i(n){if(t[n]!==void 0)return t[n];let r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(n){return i(n)!==null},init:function(n){n.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture")},get:function(n){const r=i(n);return r===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),r}}}function q3e(e,t,i,n){const r={},s=new WeakMap;function a(h){const d=h.target;d.index!==null&&t.remove(d.index);for(const f in d.attributes)t.remove(d.attributes[f]);for(const f in d.morphAttributes){const v=d.morphAttributes[f];for(let m=0,g=v.length;m<g;m++)t.remove(v[m])}d.removeEventListener("dispose",a),delete r[d.id];const p=s.get(d);p&&(t.remove(p),s.delete(d)),n.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,i.memory.geometries--}function o(h,d){return r[d.id]===!0||(d.addEventListener("dispose",a),r[d.id]=!0,i.memory.geometries++),d}function l(h){const d=h.attributes;for(const f in d)t.update(d[f],e.ARRAY_BUFFER);const p=h.morphAttributes;for(const f in p){const v=p[f];for(let m=0,g=v.length;m<g;m++)t.update(v[m],e.ARRAY_BUFFER)}}function c(h){const d=[],p=h.index,f=h.attributes.position;let v=0;if(p!==null){const y=p.array;v=p.version;for(let x=0,_=y.length;x<_;x+=3){const b=y[x+0],w=y[x+1],M=y[x+2];d.push(b,w,w,M,M,b)}}else if(f!==void 0){const y=f.array;v=f.version;for(let x=0,_=y.length/3-1;x<_;x+=3){const b=x+0,w=x+1,M=x+2;d.push(b,w,w,M,M,b)}}else return;const m=new(ek(d)?lk:ok)(d,1);m.version=v;const g=s.get(h);g&&t.remove(g),s.set(h,m)}function u(h){const d=s.get(h);if(d){const p=h.index;p!==null&&d.version<p.version&&c(h)}else c(h);return s.get(h)}return{get:o,update:l,getWireframeAttribute:u}}function Y3e(e,t,i,n){const r=n.isWebGL2;let s;function a(d){s=d}let o,l;function c(d){o=d.type,l=d.bytesPerElement}function u(d,p){e.drawElements(s,p,o,d*l),i.update(p,s,1)}function h(d,p,f){if(f===0)return;let v,m;if(r)v=e,m="drawElementsInstanced";else if(v=t.get("ANGLE_instanced_arrays"),m="drawElementsInstancedANGLE",v===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}v[m](s,p,o,d*l,f),i.update(p,s,f)}this.setMode=a,this.setIndex=c,this.render=u,this.renderInstances=h}function Z3e(e){const t={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,a,o){switch(i.calls++,a){case e.TRIANGLES:i.triangles+=o*(s/3);break;case e.LINES:i.lines+=o*(s/2);break;case e.LINE_STRIP:i.lines+=o*(s-1);break;case e.LINE_LOOP:i.lines+=o*s;break;case e.POINTS:i.points+=o*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function r(){i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:t,render:i,programs:null,autoReset:!0,reset:r,update:n}}function Q3e(e,t){return e[0]-t[0]}function K3e(e,t){return Math.abs(t[1])-Math.abs(e[1])}function $3e(e,t,i){const n={},r=new Float32Array(8),s=new WeakMap,a=new xi,o=[];for(let c=0;c<8;c++)o[c]=[c,0];function l(c,u,h){const d=c.morphTargetInfluences;if(t.isWebGL2===!0){const f=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,v=f!==void 0?f.length:0;let m=s.get(u);if(m===void 0||m.count!==v){let B=function(){D.dispose(),s.delete(u),u.removeEventListener("dispose",B)};var p=B;m!==void 0&&m.texture.dispose();const x=u.morphAttributes.position!==void 0,_=u.morphAttributes.normal!==void 0,b=u.morphAttributes.color!==void 0,w=u.morphAttributes.position||[],M=u.morphAttributes.normal||[],S=u.morphAttributes.color||[];let C=0;x===!0&&(C=1),_===!0&&(C=2),b===!0&&(C=3);let E=u.attributes.position.count*C,P=1;E>t.maxTextureSize&&(P=Math.ceil(E/t.maxTextureSize),E=t.maxTextureSize);const I=new Float32Array(E*P*4*v),D=new nk(I,E,P,v);D.type=sc,D.needsUpdate=!0;const L=C*4;for(let j=0;j<v;j++){const z=w[j],O=M[j],H=S[j],k=E*P*4*j;for(let N=0;N<z.count;N++){const F=N*L;x===!0&&(a.fromBufferAttribute(z,N),I[k+F+0]=a.x,I[k+F+1]=a.y,I[k+F+2]=a.z,I[k+F+3]=0),_===!0&&(a.fromBufferAttribute(O,N),I[k+F+4]=a.x,I[k+F+5]=a.y,I[k+F+6]=a.z,I[k+F+7]=0),b===!0&&(a.fromBufferAttribute(H,N),I[k+F+8]=a.x,I[k+F+9]=a.y,I[k+F+10]=a.z,I[k+F+11]=H.itemSize===4?a.w:1)}}m={count:v,texture:D,size:new Pt(E,P)},s.set(u,m),u.addEventListener("dispose",B)}let g=0;for(let x=0;x<d.length;x++)g+=d[x];const y=u.morphTargetsRelative?1:1-g;h.getUniforms().setValue(e,"morphTargetBaseInfluence",y),h.getUniforms().setValue(e,"morphTargetInfluences",d),h.getUniforms().setValue(e,"morphTargetsTexture",m.texture,i),h.getUniforms().setValue(e,"morphTargetsTextureSize",m.size)}else{const f=d===void 0?0:d.length;let v=n[u.id];if(v===void 0||v.length!==f){v=[];for(let _=0;_<f;_++)v[_]=[_,0];n[u.id]=v}for(let _=0;_<f;_++){const b=v[_];b[0]=_,b[1]=d[_]}v.sort(K3e);for(let _=0;_<8;_++)_<f&&v[_][1]?(o[_][0]=v[_][0],o[_][1]=v[_][1]):(o[_][0]=Number.MAX_SAFE_INTEGER,o[_][1]=0);o.sort(Q3e);const m=u.morphAttributes.position,g=u.morphAttributes.normal;let y=0;for(let _=0;_<8;_++){const b=o[_],w=b[0],M=b[1];w!==Number.MAX_SAFE_INTEGER&&M?(m&&u.getAttribute("morphTarget"+_)!==m[w]&&u.setAttribute("morphTarget"+_,m[w]),g&&u.getAttribute("morphNormal"+_)!==g[w]&&u.setAttribute("morphNormal"+_,g[w]),r[_]=M,y+=M):(m&&u.hasAttribute("morphTarget"+_)===!0&&u.deleteAttribute("morphTarget"+_),g&&u.hasAttribute("morphNormal"+_)===!0&&u.deleteAttribute("morphNormal"+_),r[_]=0)}const x=u.morphTargetsRelative?1:1-y;h.getUniforms().setValue(e,"morphTargetBaseInfluence",x),h.getUniforms().setValue(e,"morphTargetInfluences",r)}}return{update:l}}function J3e(e,t,i,n){let r=new WeakMap;function s(l){const c=n.render.frame,u=l.geometry,h=t.get(l,u);if(r.get(h)!==c&&(t.update(h),r.set(h,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",o)===!1&&l.addEventListener("dispose",o),r.get(l)!==c&&(i.update(l.instanceMatrix,e.ARRAY_BUFFER),l.instanceColor!==null&&i.update(l.instanceColor,e.ARRAY_BUFFER),r.set(l,c))),l.isSkinnedMesh){const d=l.skeleton;r.get(d)!==c&&(d.update(),r.set(d,c))}return h}function a(){r=new WeakMap}function o(l){const c=l.target;c.removeEventListener("dispose",o),i.remove(c.instanceMatrix),c.instanceColor!==null&&i.remove(c.instanceColor)}return{update:s,dispose:a}}const dk=new Nr,pk=new nk,fk=new F_e,mk=new i4,nL=[],rL=[],sL=new Float32Array(16),aL=new Float32Array(9),oL=new Float32Array(4);function cf(e,t,i){const n=e[0];if(n<=0||n>0)return e;const r=t*i;let s=nL[r];if(s===void 0&&(s=new Float32Array(r),nL[r]=s),t!==0){n.toArray(s,0);for(let a=1,o=0;a!==t;++a)o+=i,e[a].toArray(s,o)}return s}function pn(e,t){if(e.length!==t.length)return!1;for(let i=0,n=e.length;i<n;i++)if(e[i]!==t[i])return!1;return!0}function fn(e,t){for(let i=0,n=t.length;i<n;i++)e[i]=t[i]}function R2(e,t){let i=rL[t];i===void 0&&(i=new Int32Array(t),rL[t]=i);for(let n=0;n!==t;++n)i[n]=e.allocateTextureUnit();return i}function eSe(e,t){const i=this.cache;i[0]!==t&&(e.uniform1f(this.addr,t),i[0]=t)}function tSe(e,t){const i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(pn(i,t))return;e.uniform2fv(this.addr,t),fn(i,t)}}function iSe(e,t){const i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else if(t.r!==void 0)(i[0]!==t.r||i[1]!==t.g||i[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),i[0]=t.r,i[1]=t.g,i[2]=t.b);else{if(pn(i,t))return;e.uniform3fv(this.addr,t),fn(i,t)}}function nSe(e,t){const i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(pn(i,t))return;e.uniform4fv(this.addr,t),fn(i,t)}}function rSe(e,t){const i=this.cache,n=t.elements;if(n===void 0){if(pn(i,t))return;e.uniformMatrix2fv(this.addr,!1,t),fn(i,t)}else{if(pn(i,n))return;oL.set(n),e.uniformMatrix2fv(this.addr,!1,oL),fn(i,n)}}function sSe(e,t){const i=this.cache,n=t.elements;if(n===void 0){if(pn(i,t))return;e.uniformMatrix3fv(this.addr,!1,t),fn(i,t)}else{if(pn(i,n))return;aL.set(n),e.uniformMatrix3fv(this.addr,!1,aL),fn(i,n)}}function aSe(e,t){const i=this.cache,n=t.elements;if(n===void 0){if(pn(i,t))return;e.uniformMatrix4fv(this.addr,!1,t),fn(i,t)}else{if(pn(i,n))return;sL.set(n),e.uniformMatrix4fv(this.addr,!1,sL),fn(i,n)}}function oSe(e,t){const i=this.cache;i[0]!==t&&(e.uniform1i(this.addr,t),i[0]=t)}function lSe(e,t){const i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(pn(i,t))return;e.uniform2iv(this.addr,t),fn(i,t)}}function cSe(e,t){const i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else{if(pn(i,t))return;e.uniform3iv(this.addr,t),fn(i,t)}}function hSe(e,t){const i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(pn(i,t))return;e.uniform4iv(this.addr,t),fn(i,t)}}function uSe(e,t){const i=this.cache;i[0]!==t&&(e.uniform1ui(this.addr,t),i[0]=t)}function dSe(e,t){const i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(pn(i,t))return;e.uniform2uiv(this.addr,t),fn(i,t)}}function pSe(e,t){const i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else{if(pn(i,t))return;e.uniform3uiv(this.addr,t),fn(i,t)}}function fSe(e,t){const i=this.cache;if(t.x!==void 0)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(pn(i,t))return;e.uniform4uiv(this.addr,t),fn(i,t)}}function mSe(e,t,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTexture2D(t||dk,r)}function gSe(e,t,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTexture3D(t||fk,r)}function vSe(e,t,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTextureCube(t||mk,r)}function ySe(e,t,i){const n=this.cache,r=i.allocateTextureUnit();n[0]!==r&&(e.uniform1i(this.addr,r),n[0]=r),i.setTexture2DArray(t||pk,r)}function xSe(e){switch(e){case 5126:return eSe;case 35664:return tSe;case 35665:return iSe;case 35666:return nSe;case 35674:return rSe;case 35675:return sSe;case 35676:return aSe;case 5124:case 35670:return oSe;case 35667:case 35671:return lSe;case 35668:case 35672:return cSe;case 35669:case 35673:return hSe;case 5125:return uSe;case 36294:return dSe;case 36295:return pSe;case 36296:return fSe;case 35678:case 36198:case 36298:case 36306:case 35682:return mSe;case 35679:case 36299:case 36307:return gSe;case 35680:case 36300:case 36308:case 36293:return vSe;case 36289:case 36303:case 36311:case 36292:return ySe}}function _Se(e,t){e.uniform1fv(this.addr,t)}function bSe(e,t){const i=cf(t,this.size,2);e.uniform2fv(this.addr,i)}function wSe(e,t){const i=cf(t,this.size,3);e.uniform3fv(this.addr,i)}function SSe(e,t){const i=cf(t,this.size,4);e.uniform4fv(this.addr,i)}function MSe(e,t){const i=cf(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,i)}function CSe(e,t){const i=cf(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,i)}function ESe(e,t){const i=cf(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,i)}function ASe(e,t){e.uniform1iv(this.addr,t)}function TSe(e,t){e.uniform2iv(this.addr,t)}function PSe(e,t){e.uniform3iv(this.addr,t)}function DSe(e,t){e.uniform4iv(this.addr,t)}function LSe(e,t){e.uniform1uiv(this.addr,t)}function RSe(e,t){e.uniform2uiv(this.addr,t)}function ISe(e,t){e.uniform3uiv(this.addr,t)}function OSe(e,t){e.uniform4uiv(this.addr,t)}function BSe(e,t,i){const n=this.cache,r=t.length,s=R2(i,r);pn(n,s)||(e.uniform1iv(this.addr,s),fn(n,s));for(let a=0;a!==r;++a)i.setTexture2D(t[a]||dk,s[a])}function NSe(e,t,i){const n=this.cache,r=t.length,s=R2(i,r);pn(n,s)||(e.uniform1iv(this.addr,s),fn(n,s));for(let a=0;a!==r;++a)i.setTexture3D(t[a]||fk,s[a])}function USe(e,t,i){const n=this.cache,r=t.length,s=R2(i,r);pn(n,s)||(e.uniform1iv(this.addr,s),fn(n,s));for(let a=0;a!==r;++a)i.setTextureCube(t[a]||mk,s[a])}function FSe(e,t,i){const n=this.cache,r=t.length,s=R2(i,r);pn(n,s)||(e.uniform1iv(this.addr,s),fn(n,s));for(let a=0;a!==r;++a)i.setTexture2DArray(t[a]||pk,s[a])}function zSe(e){switch(e){case 5126:return _Se;case 35664:return bSe;case 35665:return wSe;case 35666:return SSe;case 35674:return MSe;case 35675:return CSe;case 35676:return ESe;case 5124:case 35670:return ASe;case 35667:case 35671:return TSe;case 35668:case 35672:return PSe;case 35669:case 35673:return DSe;case 5125:return LSe;case 36294:return RSe;case 36295:return ISe;case 36296:return OSe;case 35678:case 36198:case 36298:case 36306:case 35682:return BSe;case 35679:case 36299:case 36307:return NSe;case 35680:case 36300:case 36308:case 36293:return USe;case 36289:case 36303:case 36311:case 36292:return FSe}}class kSe{constructor(t,i,n){this.id=t,this.addr=n,this.cache=[],this.setValue=xSe(i.type)}}class VSe{constructor(t,i,n){this.id=t,this.addr=n,this.cache=[],this.size=i.size,this.setValue=zSe(i.type)}}class HSe{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,i,n){const r=this.seq;for(let s=0,a=r.length;s!==a;++s){const o=r[s];o.setValue(t,i[o.id],n)}}}const Vw=/(\w+)(\])?(\[|\.)?/g;function lL(e,t){e.seq.push(t),e.map[t.id]=t}function GSe(e,t,i){const n=e.name,r=n.length;for(Vw.lastIndex=0;;){const s=Vw.exec(n),a=Vw.lastIndex;let o=s[1];const l=s[2]==="]",c=s[3];if(l&&(o=o|0),c===void 0||c==="["&&a+2===r){lL(i,c===void 0?new kSe(o,e,t):new VSe(o,e,t));break}else{let h=i.map[o];h===void 0&&(h=new HSe(o),lL(i,h)),i=h}}}class Zv{constructor(t,i){this.seq=[],this.map={};const n=t.getProgramParameter(i,t.ACTIVE_UNIFORMS);for(let r=0;r<n;++r){const s=t.getActiveUniform(i,r),a=t.getUniformLocation(i,s.name);GSe(s,a,this)}}setValue(t,i,n,r){const s=this.map[i];s!==void 0&&s.setValue(t,n,r)}setOptional(t,i,n){const r=i[n];r!==void 0&&this.setValue(t,n,r)}static upload(t,i,n,r){for(let s=0,a=i.length;s!==a;++s){const o=i[s],l=n[o.id];l.needsUpdate!==!1&&o.setValue(t,l.value,r)}}static seqWithValue(t,i){const n=[];for(let r=0,s=t.length;r!==s;++r){const a=t[r];a.id in i&&n.push(a)}return n}}function cL(e,t,i){const n=e.createShader(t);return e.shaderSource(n,i),e.compileShader(n),n}let jSe=0;function WSe(e,t){const i=e.split(`
`),n=[],r=Math.max(t-6,0),s=Math.min(t+6,i.length);for(let a=r;a<s;a++){const o=a+1;n.push(`${o===t?">":" "} ${o}: ${i[a]}`)}return n.join(`
`)}function XSe(e){switch(e){case lo:return["Linear","( value )"];case gi:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",e),["Linear","( value )"]}}function hL(e,t,i){const n=e.getShaderParameter(t,e.COMPILE_STATUS),r=e.getShaderInfoLog(t).trim();if(n&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const a=parseInt(s[1]);return i.toUpperCase()+`

`+r+`

`+WSe(e.getShaderSource(t),a)}else return r}function qSe(e,t){const i=XSe(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function YSe(e,t){let i;switch(t){case k2e:i="Linear";break;case V2e:i="Reinhard";break;case H2e:i="OptimizedCineon";break;case G2e:i="ACESFilmic";break;case j2e:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),i="Linear"}return"vec3 "+e+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function ZSe(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.normalMapTangentSpace||e.clearcoatNormalMap||e.flatShading||e.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(xm).join(`
`)}function QSe(e){const t=[];for(const i in e){const n=e[i];n!==!1&&t.push("#define "+i+" "+n)}return t.join(`
`)}function KSe(e,t){const i={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const s=e.getActiveAttrib(t,r),a=s.name;let o=1;s.type===e.FLOAT_MAT2&&(o=2),s.type===e.FLOAT_MAT3&&(o=3),s.type===e.FLOAT_MAT4&&(o=4),i[a]={type:s.type,location:e.getAttribLocation(t,a),locationSize:o}}return i}function xm(e){return e!==""}function uL(e,t){const i=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function dL(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const $Se=/^[ \t]*#include +<([\w\d./]+)>/gm;function $M(e){return e.replace($Se,eMe)}const JSe=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function eMe(e,t){let i=It[t];if(i===void 0){const n=JSe.get(t);if(n!==void 0)i=It[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,n);else throw new Error("Can not resolve #include <"+t+">")}return $M(i)}const tMe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function pL(e){return e.replace(tMe,iMe)}function iMe(e,t,i,n){let r="";for(let s=parseInt(t);s<parseInt(i);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function fL(e){let t="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?t+=`
#define HIGH_PRECISION`:e.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function nMe(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===Vz?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===y2e?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===No&&(t="SHADOWMAP_TYPE_VSM"),t}function rMe(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Op:case Bp:t="ENVMAP_TYPE_CUBE";break;case P2:t="ENVMAP_TYPE_CUBE_UV";break}return t}function sMe(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case Bp:t="ENVMAP_MODE_REFRACTION";break}return t}function aMe(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case jz:t="ENVMAP_BLENDING_MULTIPLY";break;case F2e:t="ENVMAP_BLENDING_MIX";break;case z2e:t="ENVMAP_BLENDING_ADD";break}return t}function oMe(e){const t=e.envMapCubeUVHeight;if(t===null)return null;const i=Math.log2(t)-2,n=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,i),7*16)),texelHeight:n,maxMip:i}}function lMe(e,t,i,n){const r=e.getContext(),s=i.defines;let a=i.vertexShader,o=i.fragmentShader;const l=nMe(i),c=rMe(i),u=sMe(i),h=aMe(i),d=oMe(i),p=i.isWebGL2?"":ZSe(i),f=QSe(s),v=r.createProgram();let m,g,y=i.glslVersion?"#version "+i.glslVersion+`
`:"";i.isRawShaderMaterial?(m=["#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,f].filter(xm).join(`
`),m.length>0&&(m+=`
`),g=[p,"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,f].filter(xm).join(`
`),g.length>0&&(g+=`
`)):(m=[fL(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,f,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+u:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.displacementMap?"#define USE_DISPLACEMENTMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.mapUv?"#define MAP_UV "+i.mapUv:"",i.alphaMapUv?"#define ALPHAMAP_UV "+i.alphaMapUv:"",i.lightMapUv?"#define LIGHTMAP_UV "+i.lightMapUv:"",i.aoMapUv?"#define AOMAP_UV "+i.aoMapUv:"",i.emissiveMapUv?"#define EMISSIVEMAP_UV "+i.emissiveMapUv:"",i.bumpMapUv?"#define BUMPMAP_UV "+i.bumpMapUv:"",i.normalMapUv?"#define NORMALMAP_UV "+i.normalMapUv:"",i.displacementMapUv?"#define DISPLACEMENTMAP_UV "+i.displacementMapUv:"",i.metalnessMapUv?"#define METALNESSMAP_UV "+i.metalnessMapUv:"",i.roughnessMapUv?"#define ROUGHNESSMAP_UV "+i.roughnessMapUv:"",i.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+i.anisotropyMapUv:"",i.clearcoatMapUv?"#define CLEARCOATMAP_UV "+i.clearcoatMapUv:"",i.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+i.clearcoatNormalMapUv:"",i.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+i.clearcoatRoughnessMapUv:"",i.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+i.iridescenceMapUv:"",i.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+i.iridescenceThicknessMapUv:"",i.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+i.sheenColorMapUv:"",i.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+i.sheenRoughnessMapUv:"",i.specularMapUv?"#define SPECULARMAP_UV "+i.specularMapUv:"",i.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+i.specularColorMapUv:"",i.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+i.specularIntensityMapUv:"",i.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+i.transmissionMapUv:"",i.thicknessMapUv?"#define THICKNESSMAP_UV "+i.thicknessMapUv:"",i.vertexTangents&&i.flatShading===!1?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.morphColors&&i.isWebGL2?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.useLegacyLights?"#define LEGACY_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(xm).join(`
`),g=[p,fL(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,f,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+c:"",i.envMap?"#define "+u:"",i.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropy?"#define USE_ANISOTROPY":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.vertexTangents&&i.flatShading===!1?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+l:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.useLegacyLights?"#define LEGACY_LIGHTS":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==Sc?"#define TONE_MAPPING":"",i.toneMapping!==Sc?It.tonemapping_pars_fragment:"",i.toneMapping!==Sc?YSe("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",It.colorspace_pars_fragment,qSe("linearToOutputTexel",i.outputColorSpace),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(xm).join(`
`)),a=$M(a),a=uL(a,i),a=dL(a,i),o=$M(o),o=uL(o,i),o=dL(o,i),a=pL(a),o=pL(o),i.isWebGL2&&i.isRawShaderMaterial!==!0&&(y=`#version 300 es
`,m=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+m,g=["#define varying in",i.glslVersion===O7?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===O7?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+g);const x=y+m+a,_=y+g+o,b=cL(r,r.VERTEX_SHADER,x),w=cL(r,r.FRAGMENT_SHADER,_);if(r.attachShader(v,b),r.attachShader(v,w),i.index0AttributeName!==void 0?r.bindAttribLocation(v,0,i.index0AttributeName):i.morphTargets===!0&&r.bindAttribLocation(v,0,"position"),r.linkProgram(v),e.debug.checkShaderErrors){const C=r.getProgramInfoLog(v).trim(),E=r.getShaderInfoLog(b).trim(),P=r.getShaderInfoLog(w).trim();let I=!0,D=!0;if(r.getProgramParameter(v,r.LINK_STATUS)===!1)if(I=!1,typeof e.debug.onShaderError=="function")e.debug.onShaderError(r,v,b,w);else{const L=hL(r,b,"vertex"),B=hL(r,w,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(v,r.VALIDATE_STATUS)+`

Program Info Log: `+C+`
`+L+`
`+B)}else C!==""?console.warn("THREE.WebGLProgram: Program Info Log:",C):(E===""||P==="")&&(D=!1);D&&(this.diagnostics={runnable:I,programLog:C,vertexShader:{log:E,prefix:m},fragmentShader:{log:P,prefix:g}})}r.deleteShader(b),r.deleteShader(w);let M;this.getUniforms=function(){return M===void 0&&(M=new Zv(r,v)),M};let S;return this.getAttributes=function(){return S===void 0&&(S=KSe(r,v)),S},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(v),this.program=void 0},this.type=i.shaderType,this.name=i.shaderName,this.id=jSe++,this.cacheKey=t,this.usedTimes=1,this.program=v,this.vertexShader=b,this.fragmentShader=w,this}let cMe=0;class hMe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const i=t.vertexShader,n=t.fragmentShader,r=this._getShaderStage(i),s=this._getShaderStage(n),a=this._getShaderCacheForMaterial(t);return a.has(r)===!1&&(a.add(r),r.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(t){const i=this.materialCache.get(t);for(const n of i)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const i=this.materialCache;let n=i.get(t);return n===void 0&&(n=new Set,i.set(t,n)),n}_getShaderStage(t){const i=this.shaderCache;let n=i.get(t);return n===void 0&&(n=new uMe(t),i.set(t,n)),n}}class uMe{constructor(t){this.id=cMe++,this.code=t,this.usedTimes=0}}function dMe(e,t,i,n,r,s,a){const o=new sk,l=new hMe,c=[],u=r.isWebGL2,h=r.logarithmicDepthBuffer,d=r.vertexTextures;let p=r.precision;const f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function v(C){return C===0?"uv":`uv${C}`}function m(C,E,P,I,D){const L=I.fog,B=D.geometry,j=C.isMeshStandardMaterial?I.environment:null,z=(C.isMeshStandardMaterial?i:t).get(C.envMap||j),O=z&&z.mapping===P2?z.image.height:null,H=f[C.type];C.precision!==null&&(p=r.getMaxPrecision(C.precision),p!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",p,"instead."));const k=B.morphAttributes.position||B.morphAttributes.normal||B.morphAttributes.color,N=k!==void 0?k.length:0;let F=0;B.morphAttributes.position!==void 0&&(F=1),B.morphAttributes.normal!==void 0&&(F=2),B.morphAttributes.color!==void 0&&(F=3);let Q,G,K,W;if(H){const vt=Ha[H];Q=vt.vertexShader,G=vt.fragmentShader}else Q=C.vertexShader,G=C.fragmentShader,l.update(C),K=l.getVertexShaderID(C),W=l.getFragmentShaderID(C);const se=e.getRenderTarget(),ie=D.isInstancedMesh===!0,re=!!C.map,de=!!C.matcap,he=!!z,X=!!C.aoMap,Ee=!!C.lightMap,Oe=!!C.bumpMap,Me=!!C.normalMap,Ne=!!C.displacementMap,He=!!C.emissiveMap,Pe=!!C.metalnessMap,Ce=!!C.roughnessMap,je=C.anisotropy>0,qe=C.clearcoat>0,q=C.iridescence>0,A=C.sheen>0,R=C.transmission>0,$=je&&!!C.anisotropyMap,le=qe&&!!C.clearcoatMap,ue=qe&&!!C.clearcoatNormalMap,we=qe&&!!C.clearcoatRoughnessMap,De=q&&!!C.iridescenceMap,ne=q&&!!C.iridescenceThicknessMap,oe=A&&!!C.sheenColorMap,Y=A&&!!C.sheenRoughnessMap,me=!!C.specularMap,Le=!!C.specularColorMap,Ae=!!C.specularIntensityMap,Ue=R&&!!C.transmissionMap,$e=R&&!!C.thicknessMap,at=!!C.gradientMap,U=!!C.alphaMap,ae=C.alphaTest>0,J=!!C.alphaHash,ge=!!C.extensions,Te=!!B.attributes.uv1,Qe=!!B.attributes.uv2,_t=!!B.attributes.uv3;let Tt=Sc;return C.toneMapped&&(se===null||se.isXRRenderTarget===!0)&&(Tt=e.toneMapping),{isWebGL2:u,shaderID:H,shaderType:C.type,shaderName:C.name,vertexShader:Q,fragmentShader:G,defines:C.defines,customVertexShaderID:K,customFragmentShaderID:W,isRawShaderMaterial:C.isRawShaderMaterial===!0,glslVersion:C.glslVersion,precision:p,instancing:ie,instancingColor:ie&&D.instanceColor!==null,supportsVertexTextures:d,outputColorSpace:se===null?e.outputColorSpace:se.isXRRenderTarget===!0?se.texture.colorSpace:lo,map:re,matcap:de,envMap:he,envMapMode:he&&z.mapping,envMapCubeUVHeight:O,aoMap:X,lightMap:Ee,bumpMap:Oe,normalMap:Me,displacementMap:d&&Ne,emissiveMap:He,normalMapObjectSpace:Me&&C.normalMapType===n_e,normalMapTangentSpace:Me&&C.normalMapType===Jz,metalnessMap:Pe,roughnessMap:Ce,anisotropy:je,anisotropyMap:$,clearcoat:qe,clearcoatMap:le,clearcoatNormalMap:ue,clearcoatRoughnessMap:we,iridescence:q,iridescenceMap:De,iridescenceThicknessMap:ne,sheen:A,sheenColorMap:oe,sheenRoughnessMap:Y,specularMap:me,specularColorMap:Le,specularIntensityMap:Ae,transmission:R,transmissionMap:Ue,thicknessMap:$e,gradientMap:at,opaque:C.transparent===!1&&C.blending===lp,alphaMap:U,alphaTest:ae,alphaHash:J,combine:C.combine,mapUv:re&&v(C.map.channel),aoMapUv:X&&v(C.aoMap.channel),lightMapUv:Ee&&v(C.lightMap.channel),bumpMapUv:Oe&&v(C.bumpMap.channel),normalMapUv:Me&&v(C.normalMap.channel),displacementMapUv:Ne&&v(C.displacementMap.channel),emissiveMapUv:He&&v(C.emissiveMap.channel),metalnessMapUv:Pe&&v(C.metalnessMap.channel),roughnessMapUv:Ce&&v(C.roughnessMap.channel),anisotropyMapUv:$&&v(C.anisotropyMap.channel),clearcoatMapUv:le&&v(C.clearcoatMap.channel),clearcoatNormalMapUv:ue&&v(C.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:we&&v(C.clearcoatRoughnessMap.channel),iridescenceMapUv:De&&v(C.iridescenceMap.channel),iridescenceThicknessMapUv:ne&&v(C.iridescenceThicknessMap.channel),sheenColorMapUv:oe&&v(C.sheenColorMap.channel),sheenRoughnessMapUv:Y&&v(C.sheenRoughnessMap.channel),specularMapUv:me&&v(C.specularMap.channel),specularColorMapUv:Le&&v(C.specularColorMap.channel),specularIntensityMapUv:Ae&&v(C.specularIntensityMap.channel),transmissionMapUv:Ue&&v(C.transmissionMap.channel),thicknessMapUv:$e&&v(C.thicknessMap.channel),alphaMapUv:U&&v(C.alphaMap.channel),vertexTangents:!!B.attributes.tangent&&(Me||je),vertexColors:C.vertexColors,vertexAlphas:C.vertexColors===!0&&!!B.attributes.color&&B.attributes.color.itemSize===4,vertexUv1s:Te,vertexUv2s:Qe,vertexUv3s:_t,pointsUvs:D.isPoints===!0&&!!B.attributes.uv&&(re||U),fog:!!L,useFog:C.fog===!0,fogExp2:L&&L.isFogExp2,flatShading:C.flatShading===!0,sizeAttenuation:C.sizeAttenuation===!0,logarithmicDepthBuffer:h,skinning:D.isSkinnedMesh===!0,morphTargets:B.morphAttributes.position!==void 0,morphNormals:B.morphAttributes.normal!==void 0,morphColors:B.morphAttributes.color!==void 0,morphTargetsCount:N,morphTextureStride:F,numDirLights:E.directional.length,numPointLights:E.point.length,numSpotLights:E.spot.length,numSpotLightMaps:E.spotLightMap.length,numRectAreaLights:E.rectArea.length,numHemiLights:E.hemi.length,numDirLightShadows:E.directionalShadowMap.length,numPointLightShadows:E.pointShadowMap.length,numSpotLightShadows:E.spotShadowMap.length,numSpotLightShadowsWithMaps:E.numSpotLightShadowsWithMaps,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:C.dithering,shadowMapEnabled:e.shadowMap.enabled&&P.length>0,shadowMapType:e.shadowMap.type,toneMapping:Tt,useLegacyLights:e._useLegacyLights,decodeVideoTexture:re&&C.map.isVideoTexture===!0&&C.map.colorSpace===gi,premultipliedAlpha:C.premultipliedAlpha,doubleSided:C.side===Ya,flipSided:C.side===Br,useDepthPacking:C.depthPacking>=0,depthPacking:C.depthPacking||0,index0AttributeName:C.index0AttributeName,extensionDerivatives:ge&&C.extensions.derivatives===!0,extensionFragDepth:ge&&C.extensions.fragDepth===!0,extensionDrawBuffers:ge&&C.extensions.drawBuffers===!0,extensionShaderTextureLOD:ge&&C.extensions.shaderTextureLOD===!0,rendererExtensionFragDepth:u||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||n.has("EXT_shader_texture_lod"),customProgramCacheKey:C.customProgramCacheKey()}}function g(C){const E=[];if(C.shaderID?E.push(C.shaderID):(E.push(C.customVertexShaderID),E.push(C.customFragmentShaderID)),C.defines!==void 0)for(const P in C.defines)E.push(P),E.push(C.defines[P]);return C.isRawShaderMaterial===!1&&(y(E,C),x(E,C),E.push(e.outputColorSpace)),E.push(C.customProgramCacheKey),E.join()}function y(C,E){C.push(E.precision),C.push(E.outputColorSpace),C.push(E.envMapMode),C.push(E.envMapCubeUVHeight),C.push(E.mapUv),C.push(E.alphaMapUv),C.push(E.lightMapUv),C.push(E.aoMapUv),C.push(E.bumpMapUv),C.push(E.normalMapUv),C.push(E.displacementMapUv),C.push(E.emissiveMapUv),C.push(E.metalnessMapUv),C.push(E.roughnessMapUv),C.push(E.anisotropyMapUv),C.push(E.clearcoatMapUv),C.push(E.clearcoatNormalMapUv),C.push(E.clearcoatRoughnessMapUv),C.push(E.iridescenceMapUv),C.push(E.iridescenceThicknessMapUv),C.push(E.sheenColorMapUv),C.push(E.sheenRoughnessMapUv),C.push(E.specularMapUv),C.push(E.specularColorMapUv),C.push(E.specularIntensityMapUv),C.push(E.transmissionMapUv),C.push(E.thicknessMapUv),C.push(E.combine),C.push(E.fogExp2),C.push(E.sizeAttenuation),C.push(E.morphTargetsCount),C.push(E.morphAttributeCount),C.push(E.numDirLights),C.push(E.numPointLights),C.push(E.numSpotLights),C.push(E.numSpotLightMaps),C.push(E.numHemiLights),C.push(E.numRectAreaLights),C.push(E.numDirLightShadows),C.push(E.numPointLightShadows),C.push(E.numSpotLightShadows),C.push(E.numSpotLightShadowsWithMaps),C.push(E.shadowMapType),C.push(E.toneMapping),C.push(E.numClippingPlanes),C.push(E.numClipIntersection),C.push(E.depthPacking)}function x(C,E){o.disableAll(),E.isWebGL2&&o.enable(0),E.supportsVertexTextures&&o.enable(1),E.instancing&&o.enable(2),E.instancingColor&&o.enable(3),E.matcap&&o.enable(4),E.envMap&&o.enable(5),E.normalMapObjectSpace&&o.enable(6),E.normalMapTangentSpace&&o.enable(7),E.clearcoat&&o.enable(8),E.iridescence&&o.enable(9),E.alphaTest&&o.enable(10),E.vertexColors&&o.enable(11),E.vertexAlphas&&o.enable(12),E.vertexUv1s&&o.enable(13),E.vertexUv2s&&o.enable(14),E.vertexUv3s&&o.enable(15),E.vertexTangents&&o.enable(16),E.anisotropy&&o.enable(17),C.push(o.mask),o.disableAll(),E.fog&&o.enable(0),E.useFog&&o.enable(1),E.flatShading&&o.enable(2),E.logarithmicDepthBuffer&&o.enable(3),E.skinning&&o.enable(4),E.morphTargets&&o.enable(5),E.morphNormals&&o.enable(6),E.morphColors&&o.enable(7),E.premultipliedAlpha&&o.enable(8),E.shadowMapEnabled&&o.enable(9),E.useLegacyLights&&o.enable(10),E.doubleSided&&o.enable(11),E.flipSided&&o.enable(12),E.useDepthPacking&&o.enable(13),E.dithering&&o.enable(14),E.transmission&&o.enable(15),E.sheen&&o.enable(16),E.opaque&&o.enable(17),E.pointsUvs&&o.enable(18),E.decodeVideoTexture&&o.enable(19),C.push(o.mask)}function _(C){const E=f[C.type];let P;if(E){const I=Ha[E];P=K_e.clone(I.uniforms)}else P=C.uniforms;return P}function b(C,E){let P;for(let I=0,D=c.length;I<D;I++){const L=c[I];if(L.cacheKey===E){P=L,++P.usedTimes;break}}return P===void 0&&(P=new lMe(e,E,C,s),c.push(P)),P}function w(C){if(--C.usedTimes===0){const E=c.indexOf(C);c[E]=c[c.length-1],c.pop(),C.destroy()}}function M(C){l.remove(C)}function S(){l.dispose()}return{getParameters:m,getProgramCacheKey:g,getUniforms:_,acquireProgram:b,releaseProgram:w,releaseShaderCache:M,programs:c,dispose:S}}function pMe(){let e=new WeakMap;function t(s){let a=e.get(s);return a===void 0&&(a={},e.set(s,a)),a}function i(s){e.delete(s)}function n(s,a,o){e.get(s)[a]=o}function r(){e=new WeakMap}return{get:t,remove:i,update:n,dispose:r}}function fMe(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function mL(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function gL(){const e=[];let t=0;const i=[],n=[],r=[];function s(){t=0,i.length=0,n.length=0,r.length=0}function a(h,d,p,f,v,m){let g=e[t];return g===void 0?(g={id:h.id,object:h,geometry:d,material:p,groupOrder:f,renderOrder:h.renderOrder,z:v,group:m},e[t]=g):(g.id=h.id,g.object=h,g.geometry=d,g.material=p,g.groupOrder=f,g.renderOrder=h.renderOrder,g.z=v,g.group=m),t++,g}function o(h,d,p,f,v,m){const g=a(h,d,p,f,v,m);p.transmission>0?n.push(g):p.transparent===!0?r.push(g):i.push(g)}function l(h,d,p,f,v,m){const g=a(h,d,p,f,v,m);p.transmission>0?n.unshift(g):p.transparent===!0?r.unshift(g):i.unshift(g)}function c(h,d){i.length>1&&i.sort(h||fMe),n.length>1&&n.sort(d||mL),r.length>1&&r.sort(d||mL)}function u(){for(let h=t,d=e.length;h<d;h++){const p=e[h];if(p.id===null)break;p.id=null,p.object=null,p.geometry=null,p.material=null,p.group=null}}return{opaque:i,transmissive:n,transparent:r,init:s,push:o,unshift:l,finish:u,sort:c}}function mMe(){let e=new WeakMap;function t(n,r){const s=e.get(n);let a;return s===void 0?(a=new gL,e.set(n,[a])):r>=s.length?(a=new gL,s.push(a)):a=s[r],a}function i(){e=new WeakMap}return{get:t,dispose:i}}function gMe(){const e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let i;switch(t.type){case"DirectionalLight":i={direction:new fe,color:new ri};break;case"SpotLight":i={position:new fe,direction:new fe,color:new ri,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new fe,color:new ri,distance:0,decay:0};break;case"HemisphereLight":i={direction:new fe,skyColor:new ri,groundColor:new ri};break;case"RectAreaLight":i={color:new ri,position:new fe,halfWidth:new fe,halfHeight:new fe};break}return e[t.id]=i,i}}}function vMe(){const e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let i;switch(t.type){case"DirectionalLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Pt};break;case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Pt};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Pt,shadowCameraNear:1,shadowCameraFar:1e3};break}return e[t.id]=i,i}}}let yMe=0;function xMe(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function _Me(e,t){const i=new gMe,n=vMe(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let u=0;u<9;u++)r.probe.push(new fe);const s=new fe,a=new Ki,o=new Ki;function l(u,h){let d=0,p=0,f=0;for(let P=0;P<9;P++)r.probe[P].set(0,0,0);let v=0,m=0,g=0,y=0,x=0,_=0,b=0,w=0,M=0,S=0;u.sort(xMe);const C=h===!0?Math.PI:1;for(let P=0,I=u.length;P<I;P++){const D=u[P],L=D.color,B=D.intensity,j=D.distance,z=D.shadow&&D.shadow.map?D.shadow.map.texture:null;if(D.isAmbientLight)d+=L.r*B*C,p+=L.g*B*C,f+=L.b*B*C;else if(D.isLightProbe)for(let O=0;O<9;O++)r.probe[O].addScaledVector(D.sh.coefficients[O],B);else if(D.isDirectionalLight){const O=i.get(D);if(O.color.copy(D.color).multiplyScalar(D.intensity*C),D.castShadow){const H=D.shadow,k=n.get(D);k.shadowBias=H.bias,k.shadowNormalBias=H.normalBias,k.shadowRadius=H.radius,k.shadowMapSize=H.mapSize,r.directionalShadow[v]=k,r.directionalShadowMap[v]=z,r.directionalShadowMatrix[v]=D.shadow.matrix,_++}r.directional[v]=O,v++}else if(D.isSpotLight){const O=i.get(D);O.position.setFromMatrixPosition(D.matrixWorld),O.color.copy(L).multiplyScalar(B*C),O.distance=j,O.coneCos=Math.cos(D.angle),O.penumbraCos=Math.cos(D.angle*(1-D.penumbra)),O.decay=D.decay,r.spot[g]=O;const H=D.shadow;if(D.map&&(r.spotLightMap[M]=D.map,M++,H.updateMatrices(D),D.castShadow&&S++),r.spotLightMatrix[g]=H.matrix,D.castShadow){const k=n.get(D);k.shadowBias=H.bias,k.shadowNormalBias=H.normalBias,k.shadowRadius=H.radius,k.shadowMapSize=H.mapSize,r.spotShadow[g]=k,r.spotShadowMap[g]=z,w++}g++}else if(D.isRectAreaLight){const O=i.get(D);O.color.copy(L).multiplyScalar(B),O.halfWidth.set(D.width*.5,0,0),O.halfHeight.set(0,D.height*.5,0),r.rectArea[y]=O,y++}else if(D.isPointLight){const O=i.get(D);if(O.color.copy(D.color).multiplyScalar(D.intensity*C),O.distance=D.distance,O.decay=D.decay,D.castShadow){const H=D.shadow,k=n.get(D);k.shadowBias=H.bias,k.shadowNormalBias=H.normalBias,k.shadowRadius=H.radius,k.shadowMapSize=H.mapSize,k.shadowCameraNear=H.camera.near,k.shadowCameraFar=H.camera.far,r.pointShadow[m]=k,r.pointShadowMap[m]=z,r.pointShadowMatrix[m]=D.shadow.matrix,b++}r.point[m]=O,m++}else if(D.isHemisphereLight){const O=i.get(D);O.skyColor.copy(D.color).multiplyScalar(B*C),O.groundColor.copy(D.groundColor).multiplyScalar(B*C),r.hemi[x]=O,x++}}y>0&&(t.isWebGL2||e.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=Ye.LTC_FLOAT_1,r.rectAreaLTC2=Ye.LTC_FLOAT_2):e.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=Ye.LTC_HALF_1,r.rectAreaLTC2=Ye.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=d,r.ambient[1]=p,r.ambient[2]=f;const E=r.hash;(E.directionalLength!==v||E.pointLength!==m||E.spotLength!==g||E.rectAreaLength!==y||E.hemiLength!==x||E.numDirectionalShadows!==_||E.numPointShadows!==b||E.numSpotShadows!==w||E.numSpotMaps!==M)&&(r.directional.length=v,r.spot.length=g,r.rectArea.length=y,r.point.length=m,r.hemi.length=x,r.directionalShadow.length=_,r.directionalShadowMap.length=_,r.pointShadow.length=b,r.pointShadowMap.length=b,r.spotShadow.length=w,r.spotShadowMap.length=w,r.directionalShadowMatrix.length=_,r.pointShadowMatrix.length=b,r.spotLightMatrix.length=w+M-S,r.spotLightMap.length=M,r.numSpotLightShadowsWithMaps=S,E.directionalLength=v,E.pointLength=m,E.spotLength=g,E.rectAreaLength=y,E.hemiLength=x,E.numDirectionalShadows=_,E.numPointShadows=b,E.numSpotShadows=w,E.numSpotMaps=M,r.version=yMe++)}function c(u,h){let d=0,p=0,f=0,v=0,m=0;const g=h.matrixWorldInverse;for(let y=0,x=u.length;y<x;y++){const _=u[y];if(_.isDirectionalLight){const b=r.directional[d];b.direction.setFromMatrixPosition(_.matrixWorld),s.setFromMatrixPosition(_.target.matrixWorld),b.direction.sub(s),b.direction.transformDirection(g),d++}else if(_.isSpotLight){const b=r.spot[f];b.position.setFromMatrixPosition(_.matrixWorld),b.position.applyMatrix4(g),b.direction.setFromMatrixPosition(_.matrixWorld),s.setFromMatrixPosition(_.target.matrixWorld),b.direction.sub(s),b.direction.transformDirection(g),f++}else if(_.isRectAreaLight){const b=r.rectArea[v];b.position.setFromMatrixPosition(_.matrixWorld),b.position.applyMatrix4(g),o.identity(),a.copy(_.matrixWorld),a.premultiply(g),o.extractRotation(a),b.halfWidth.set(_.width*.5,0,0),b.halfHeight.set(0,_.height*.5,0),b.halfWidth.applyMatrix4(o),b.halfHeight.applyMatrix4(o),v++}else if(_.isPointLight){const b=r.point[p];b.position.setFromMatrixPosition(_.matrixWorld),b.position.applyMatrix4(g),p++}else if(_.isHemisphereLight){const b=r.hemi[m];b.direction.setFromMatrixPosition(_.matrixWorld),b.direction.transformDirection(g),m++}}}return{setup:l,setupView:c,state:r}}function vL(e,t){const i=new _Me(e,t),n=[],r=[];function s(){n.length=0,r.length=0}function a(h){n.push(h)}function o(h){r.push(h)}function l(h){i.setup(n,h)}function c(h){i.setupView(n,h)}return{init:s,state:{lightsArray:n,shadowsArray:r,lights:i},setupLights:l,setupLightsView:c,pushLight:a,pushShadow:o}}function bMe(e,t){let i=new WeakMap;function n(s,a=0){const o=i.get(s);let l;return o===void 0?(l=new vL(e,t),i.set(s,[l])):a>=o.length?(l=new vL(e,t),o.push(l)):l=o[a],l}function r(){i=new WeakMap}return{get:n,dispose:r}}class wMe extends fg{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=t_e,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}class SMe extends fg{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}const MMe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,CMe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function EMe(e,t,i){let n=new n4;const r=new Pt,s=new Pt,a=new xi,o=new wMe({depthPacking:i_e}),l=new SMe,c={},u=i.maxTextureSize,h={[Rc]:Br,[Br]:Rc,[Ya]:Ya},d=new $h({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Pt},radius:{value:4}},vertexShader:MMe,fragmentShader:CMe}),p=d.clone();p.defines.HORIZONTAL_PASS=1;const f=new ml;f.setAttribute("position",new io(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const v=new da(f,d),m=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Vz;let g=this.type;this.render=function(b,w,M){if(m.enabled===!1||m.autoUpdate===!1&&m.needsUpdate===!1||b.length===0)return;const S=e.getRenderTarget(),C=e.getActiveCubeFace(),E=e.getActiveMipmapLevel(),P=e.state;P.setBlending(wc),P.buffers.color.setClear(1,1,1,1),P.buffers.depth.setTest(!0),P.setScissorTest(!1);const I=g!==No&&this.type===No,D=g===No&&this.type!==No;for(let L=0,B=b.length;L<B;L++){const j=b[L],z=j.shadow;if(z===void 0){console.warn("THREE.WebGLShadowMap:",j,"has no shadow.");continue}if(z.autoUpdate===!1&&z.needsUpdate===!1)continue;r.copy(z.mapSize);const O=z.getFrameExtents();if(r.multiply(O),s.copy(z.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/O.x),r.x=s.x*O.x,z.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/O.y),r.y=s.y*O.y,z.mapSize.y=s.y)),z.map===null||I===!0||D===!0){const k=this.type!==No?{minFilter:or,magFilter:or}:{};z.map!==null&&z.map.dispose(),z.map=new Qh(r.x,r.y,k),z.map.texture.name=j.name+".shadowMap",z.camera.updateProjectionMatrix()}e.setRenderTarget(z.map),e.clear();const H=z.getViewportCount();for(let k=0;k<H;k++){const N=z.getViewport(k);a.set(s.x*N.x,s.y*N.y,s.x*N.z,s.y*N.w),P.viewport(a),z.updateMatrices(j,k),n=z.getFrustum(),_(w,M,z.camera,j,this.type)}z.isPointLightShadow!==!0&&this.type===No&&y(z,M),z.needsUpdate=!1}g=this.type,m.needsUpdate=!1,e.setRenderTarget(S,C,E)};function y(b,w){const M=t.update(v);d.defines.VSM_SAMPLES!==b.blurSamples&&(d.defines.VSM_SAMPLES=b.blurSamples,p.defines.VSM_SAMPLES=b.blurSamples,d.needsUpdate=!0,p.needsUpdate=!0),b.mapPass===null&&(b.mapPass=new Qh(r.x,r.y)),d.uniforms.shadow_pass.value=b.map.texture,d.uniforms.resolution.value=b.mapSize,d.uniforms.radius.value=b.radius,e.setRenderTarget(b.mapPass),e.clear(),e.renderBufferDirect(w,null,M,d,v,null),p.uniforms.shadow_pass.value=b.mapPass.texture,p.uniforms.resolution.value=b.mapSize,p.uniforms.radius.value=b.radius,e.setRenderTarget(b.map),e.clear(),e.renderBufferDirect(w,null,M,p,v,null)}function x(b,w,M,S){let C=null;const E=M.isPointLight===!0?b.customDistanceMaterial:b.customDepthMaterial;if(E!==void 0)C=E;else if(C=M.isPointLight===!0?l:o,e.localClippingEnabled&&w.clipShadows===!0&&Array.isArray(w.clippingPlanes)&&w.clippingPlanes.length!==0||w.displacementMap&&w.displacementScale!==0||w.alphaMap&&w.alphaTest>0||w.map&&w.alphaTest>0){const P=C.uuid,I=w.uuid;let D=c[P];D===void 0&&(D={},c[P]=D);let L=D[I];L===void 0&&(L=C.clone(),D[I]=L),C=L}if(C.visible=w.visible,C.wireframe=w.wireframe,S===No?C.side=w.shadowSide!==null?w.shadowSide:w.side:C.side=w.shadowSide!==null?w.shadowSide:h[w.side],C.alphaMap=w.alphaMap,C.alphaTest=w.alphaTest,C.map=w.map,C.clipShadows=w.clipShadows,C.clippingPlanes=w.clippingPlanes,C.clipIntersection=w.clipIntersection,C.displacementMap=w.displacementMap,C.displacementScale=w.displacementScale,C.displacementBias=w.displacementBias,C.wireframeLinewidth=w.wireframeLinewidth,C.linewidth=w.linewidth,M.isPointLight===!0&&C.isMeshDistanceMaterial===!0){const P=e.properties.get(C);P.light=M}return C}function _(b,w,M,S,C){if(b.visible===!1)return;if(b.layers.test(w.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&C===No)&&(!b.frustumCulled||n.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(M.matrixWorldInverse,b.matrixWorld);const I=t.update(b),D=b.material;if(Array.isArray(D)){const L=I.groups;for(let B=0,j=L.length;B<j;B++){const z=L[B],O=D[z.materialIndex];if(O&&O.visible){const H=x(b,O,S,C);e.renderBufferDirect(M,null,I,H,b,z)}}}else if(D.visible){const L=x(b,D,S,C);e.renderBufferDirect(M,null,I,L,b,null)}}const P=b.children;for(let I=0,D=P.length;I<D;I++)_(P[I],w,M,S,C)}}function AMe(e,t,i){const n=i.isWebGL2;function r(){let U=!1;const ae=new xi;let J=null;const ge=new xi(0,0,0,0);return{setMask:function(Te){J!==Te&&!U&&(e.colorMask(Te,Te,Te,Te),J=Te)},setLocked:function(Te){U=Te},setClear:function(Te,Qe,_t,Tt,Ri){Ri===!0&&(Te*=Tt,Qe*=Tt,_t*=Tt),ae.set(Te,Qe,_t,Tt),ge.equals(ae)===!1&&(e.clearColor(Te,Qe,_t,Tt),ge.copy(ae))},reset:function(){U=!1,J=null,ge.set(-1,0,0,0)}}}function s(){let U=!1,ae=null,J=null,ge=null;return{setTest:function(Te){Te?se(e.DEPTH_TEST):ie(e.DEPTH_TEST)},setMask:function(Te){ae!==Te&&!U&&(e.depthMask(Te),ae=Te)},setFunc:function(Te){if(J!==Te){switch(Te){case L2e:e.depthFunc(e.NEVER);break;case R2e:e.depthFunc(e.ALWAYS);break;case I2e:e.depthFunc(e.LESS);break;case WM:e.depthFunc(e.LEQUAL);break;case O2e:e.depthFunc(e.EQUAL);break;case B2e:e.depthFunc(e.GEQUAL);break;case N2e:e.depthFunc(e.GREATER);break;case U2e:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}J=Te}},setLocked:function(Te){U=Te},setClear:function(Te){ge!==Te&&(e.clearDepth(Te),ge=Te)},reset:function(){U=!1,ae=null,J=null,ge=null}}}function a(){let U=!1,ae=null,J=null,ge=null,Te=null,Qe=null,_t=null,Tt=null,Ri=null;return{setTest:function(vt){U||(vt?se(e.STENCIL_TEST):ie(e.STENCIL_TEST))},setMask:function(vt){ae!==vt&&!U&&(e.stencilMask(vt),ae=vt)},setFunc:function(vt,Hi,ei){(J!==vt||ge!==Hi||Te!==ei)&&(e.stencilFunc(vt,Hi,ei),J=vt,ge=Hi,Te=ei)},setOp:function(vt,Hi,ei){(Qe!==vt||_t!==Hi||Tt!==ei)&&(e.stencilOp(vt,Hi,ei),Qe=vt,_t=Hi,Tt=ei)},setLocked:function(vt){U=vt},setClear:function(vt){Ri!==vt&&(e.clearStencil(vt),Ri=vt)},reset:function(){U=!1,ae=null,J=null,ge=null,Te=null,Qe=null,_t=null,Tt=null,Ri=null}}}const o=new r,l=new s,c=new a,u=new WeakMap,h=new WeakMap;let d={},p={},f=new WeakMap,v=[],m=null,g=!1,y=null,x=null,_=null,b=null,w=null,M=null,S=null,C=!1,E=null,P=null,I=null,D=null,L=null;const B=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let j=!1,z=0;const O=e.getParameter(e.VERSION);O.indexOf("WebGL")!==-1?(z=parseFloat(/^WebGL (\d)/.exec(O)[1]),j=z>=1):O.indexOf("OpenGL ES")!==-1&&(z=parseFloat(/^OpenGL ES (\d)/.exec(O)[1]),j=z>=2);let H=null,k={};const N=e.getParameter(e.SCISSOR_BOX),F=e.getParameter(e.VIEWPORT),Q=new xi().fromArray(N),G=new xi().fromArray(F);function K(U,ae,J,ge){const Te=new Uint8Array(4),Qe=e.createTexture();e.bindTexture(U,Qe),e.texParameteri(U,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(U,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let _t=0;_t<J;_t++)n&&(U===e.TEXTURE_3D||U===e.TEXTURE_2D_ARRAY)?e.texImage3D(ae,0,e.RGBA,1,1,ge,0,e.RGBA,e.UNSIGNED_BYTE,Te):e.texImage2D(ae+_t,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,Te);return Qe}const W={};W[e.TEXTURE_2D]=K(e.TEXTURE_2D,e.TEXTURE_2D,1),W[e.TEXTURE_CUBE_MAP]=K(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),n&&(W[e.TEXTURE_2D_ARRAY]=K(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),W[e.TEXTURE_3D]=K(e.TEXTURE_3D,e.TEXTURE_3D,1,1)),o.setClear(0,0,0,1),l.setClear(1),c.setClear(0),se(e.DEPTH_TEST),l.setFunc(WM),Ne(!1),He(t7),se(e.CULL_FACE),Oe(wc);function se(U){d[U]!==!0&&(e.enable(U),d[U]=!0)}function ie(U){d[U]!==!1&&(e.disable(U),d[U]=!1)}function re(U,ae){return p[U]!==ae?(e.bindFramebuffer(U,ae),p[U]=ae,n&&(U===e.DRAW_FRAMEBUFFER&&(p[e.FRAMEBUFFER]=ae),U===e.FRAMEBUFFER&&(p[e.DRAW_FRAMEBUFFER]=ae)),!0):!1}function de(U,ae){let J=v,ge=!1;if(U)if(J=f.get(ae),J===void 0&&(J=[],f.set(ae,J)),U.isWebGLMultipleRenderTargets){const Te=U.texture;if(J.length!==Te.length||J[0]!==e.COLOR_ATTACHMENT0){for(let Qe=0,_t=Te.length;Qe<_t;Qe++)J[Qe]=e.COLOR_ATTACHMENT0+Qe;J.length=Te.length,ge=!0}}else J[0]!==e.COLOR_ATTACHMENT0&&(J[0]=e.COLOR_ATTACHMENT0,ge=!0);else J[0]!==e.BACK&&(J[0]=e.BACK,ge=!0);ge&&(i.isWebGL2?e.drawBuffers(J):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(J))}function he(U){return m!==U?(e.useProgram(U),m=U,!0):!1}const X={[dd]:e.FUNC_ADD,[_2e]:e.FUNC_SUBTRACT,[b2e]:e.FUNC_REVERSE_SUBTRACT};if(n)X[s7]=e.MIN,X[a7]=e.MAX;else{const U=t.get("EXT_blend_minmax");U!==null&&(X[s7]=U.MIN_EXT,X[a7]=U.MAX_EXT)}const Ee={[w2e]:e.ZERO,[S2e]:e.ONE,[M2e]:e.SRC_COLOR,[Hz]:e.SRC_ALPHA,[D2e]:e.SRC_ALPHA_SATURATE,[T2e]:e.DST_COLOR,[E2e]:e.DST_ALPHA,[C2e]:e.ONE_MINUS_SRC_COLOR,[Gz]:e.ONE_MINUS_SRC_ALPHA,[P2e]:e.ONE_MINUS_DST_COLOR,[A2e]:e.ONE_MINUS_DST_ALPHA};function Oe(U,ae,J,ge,Te,Qe,_t,Tt){if(U===wc){g===!0&&(ie(e.BLEND),g=!1);return}if(g===!1&&(se(e.BLEND),g=!0),U!==x2e){if(U!==y||Tt!==C){if((x!==dd||w!==dd)&&(e.blendEquation(e.FUNC_ADD),x=dd,w=dd),Tt)switch(U){case lp:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case i7:e.blendFunc(e.ONE,e.ONE);break;case n7:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case r7:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",U);break}else switch(U){case lp:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case i7:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case n7:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case r7:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",U);break}_=null,b=null,M=null,S=null,y=U,C=Tt}return}Te=Te||ae,Qe=Qe||J,_t=_t||ge,(ae!==x||Te!==w)&&(e.blendEquationSeparate(X[ae],X[Te]),x=ae,w=Te),(J!==_||ge!==b||Qe!==M||_t!==S)&&(e.blendFuncSeparate(Ee[J],Ee[ge],Ee[Qe],Ee[_t]),_=J,b=ge,M=Qe,S=_t),y=U,C=!1}function Me(U,ae){U.side===Ya?ie(e.CULL_FACE):se(e.CULL_FACE);let J=U.side===Br;ae&&(J=!J),Ne(J),U.blending===lp&&U.transparent===!1?Oe(wc):Oe(U.blending,U.blendEquation,U.blendSrc,U.blendDst,U.blendEquationAlpha,U.blendSrcAlpha,U.blendDstAlpha,U.premultipliedAlpha),l.setFunc(U.depthFunc),l.setTest(U.depthTest),l.setMask(U.depthWrite),o.setMask(U.colorWrite);const ge=U.stencilWrite;c.setTest(ge),ge&&(c.setMask(U.stencilWriteMask),c.setFunc(U.stencilFunc,U.stencilRef,U.stencilFuncMask),c.setOp(U.stencilFail,U.stencilZFail,U.stencilZPass)),Ce(U.polygonOffset,U.polygonOffsetFactor,U.polygonOffsetUnits),U.alphaToCoverage===!0?se(e.SAMPLE_ALPHA_TO_COVERAGE):ie(e.SAMPLE_ALPHA_TO_COVERAGE)}function Ne(U){E!==U&&(U?e.frontFace(e.CW):e.frontFace(e.CCW),E=U)}function He(U){U!==g2e?(se(e.CULL_FACE),U!==P&&(U===t7?e.cullFace(e.BACK):U===v2e?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):ie(e.CULL_FACE),P=U}function Pe(U){U!==I&&(j&&e.lineWidth(U),I=U)}function Ce(U,ae,J){U?(se(e.POLYGON_OFFSET_FILL),(D!==ae||L!==J)&&(e.polygonOffset(ae,J),D=ae,L=J)):ie(e.POLYGON_OFFSET_FILL)}function je(U){U?se(e.SCISSOR_TEST):ie(e.SCISSOR_TEST)}function qe(U){U===void 0&&(U=e.TEXTURE0+B-1),H!==U&&(e.activeTexture(U),H=U)}function q(U,ae,J){J===void 0&&(H===null?J=e.TEXTURE0+B-1:J=H);let ge=k[J];ge===void 0&&(ge={type:void 0,texture:void 0},k[J]=ge),(ge.type!==U||ge.texture!==ae)&&(H!==J&&(e.activeTexture(J),H=J),e.bindTexture(U,ae||W[U]),ge.type=U,ge.texture=ae)}function A(){const U=k[H];U!==void 0&&U.type!==void 0&&(e.bindTexture(U.type,null),U.type=void 0,U.texture=void 0)}function R(){try{e.compressedTexImage2D.apply(e,arguments)}catch(U){console.error("THREE.WebGLState:",U)}}function $(){try{e.compressedTexImage3D.apply(e,arguments)}catch(U){console.error("THREE.WebGLState:",U)}}function le(){try{e.texSubImage2D.apply(e,arguments)}catch(U){console.error("THREE.WebGLState:",U)}}function ue(){try{e.texSubImage3D.apply(e,arguments)}catch(U){console.error("THREE.WebGLState:",U)}}function we(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(U){console.error("THREE.WebGLState:",U)}}function De(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(U){console.error("THREE.WebGLState:",U)}}function ne(){try{e.texStorage2D.apply(e,arguments)}catch(U){console.error("THREE.WebGLState:",U)}}function oe(){try{e.texStorage3D.apply(e,arguments)}catch(U){console.error("THREE.WebGLState:",U)}}function Y(){try{e.texImage2D.apply(e,arguments)}catch(U){console.error("THREE.WebGLState:",U)}}function me(){try{e.texImage3D.apply(e,arguments)}catch(U){console.error("THREE.WebGLState:",U)}}function Le(U){Q.equals(U)===!1&&(e.scissor(U.x,U.y,U.z,U.w),Q.copy(U))}function Ae(U){G.equals(U)===!1&&(e.viewport(U.x,U.y,U.z,U.w),G.copy(U))}function Ue(U,ae){let J=h.get(ae);J===void 0&&(J=new WeakMap,h.set(ae,J));let ge=J.get(U);ge===void 0&&(ge=e.getUniformBlockIndex(ae,U.name),J.set(U,ge))}function $e(U,ae){const ge=h.get(ae).get(U);u.get(ae)!==ge&&(e.uniformBlockBinding(ae,ge,U.__bindingPointIndex),u.set(ae,ge))}function at(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),n===!0&&(e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),d={},H=null,k={},p={},f=new WeakMap,v=[],m=null,g=!1,y=null,x=null,_=null,b=null,w=null,M=null,S=null,C=!1,E=null,P=null,I=null,D=null,L=null,Q.set(0,0,e.canvas.width,e.canvas.height),G.set(0,0,e.canvas.width,e.canvas.height),o.reset(),l.reset(),c.reset()}return{buffers:{color:o,depth:l,stencil:c},enable:se,disable:ie,bindFramebuffer:re,drawBuffers:de,useProgram:he,setBlending:Oe,setMaterial:Me,setFlipSided:Ne,setCullFace:He,setLineWidth:Pe,setPolygonOffset:Ce,setScissorTest:je,activeTexture:qe,bindTexture:q,unbindTexture:A,compressedTexImage2D:R,compressedTexImage3D:$,texImage2D:Y,texImage3D:me,updateUBOMapping:Ue,uniformBlockBinding:$e,texStorage2D:ne,texStorage3D:oe,texSubImage2D:le,texSubImage3D:ue,compressedTexSubImage2D:we,compressedTexSubImage3D:De,scissor:Le,viewport:Ae,reset:at}}function TMe(e,t,i,n,r,s,a){const o=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,h=r.maxSamples,d=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,p=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),f=new WeakMap;let v;const m=new WeakMap;let g=!1;try{g=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(A,R){return g?new OffscreenCanvas(A,R):G0("canvas")}function x(A,R,$,le){let ue=1;if((A.width>le||A.height>le)&&(ue=le/Math.max(A.width,A.height)),ue<1||R===!0)if(typeof HTMLImageElement<"u"&&A instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&A instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&A instanceof ImageBitmap){const we=R?Cx:Math.floor,De=we(ue*A.width),ne=we(ue*A.height);v===void 0&&(v=y(De,ne));const oe=$?y(De,ne):v;return oe.width=De,oe.height=ne,oe.getContext("2d").drawImage(A,0,0,De,ne),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+A.width+"x"+A.height+") to ("+De+"x"+ne+")."),oe}else return"data"in A&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+A.width+"x"+A.height+")."),A;return A}function _(A){return KM(A.width)&&KM(A.height)}function b(A){return o?!1:A.wrapS!==ra||A.wrapT!==ra||A.minFilter!==or&&A.minFilter!==As}function w(A,R){return A.generateMipmaps&&R&&A.minFilter!==or&&A.minFilter!==As}function M(A){e.generateMipmap(A)}function S(A,R,$,le,ue=!1){if(o===!1)return R;if(A!==null){if(e[A]!==void 0)return e[A];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+A+"'")}let we=R;return R===e.RED&&($===e.FLOAT&&(we=e.R32F),$===e.HALF_FLOAT&&(we=e.R16F),$===e.UNSIGNED_BYTE&&(we=e.R8)),R===e.RED_INTEGER&&($===e.UNSIGNED_BYTE&&(we=e.R8UI),$===e.UNSIGNED_SHORT&&(we=e.R16UI),$===e.UNSIGNED_INT&&(we=e.R32UI),$===e.BYTE&&(we=e.R8I),$===e.SHORT&&(we=e.R16I),$===e.INT&&(we=e.R32I)),R===e.RG&&($===e.FLOAT&&(we=e.RG32F),$===e.HALF_FLOAT&&(we=e.RG16F),$===e.UNSIGNED_BYTE&&(we=e.RG8)),R===e.RGBA&&($===e.FLOAT&&(we=e.RGBA32F),$===e.HALF_FLOAT&&(we=e.RGBA16F),$===e.UNSIGNED_BYTE&&(we=le===gi&&ue===!1?e.SRGB8_ALPHA8:e.RGBA8),$===e.UNSIGNED_SHORT_4_4_4_4&&(we=e.RGBA4),$===e.UNSIGNED_SHORT_5_5_5_1&&(we=e.RGB5_A1)),(we===e.R16F||we===e.R32F||we===e.RG16F||we===e.RG32F||we===e.RGBA16F||we===e.RGBA32F)&&t.get("EXT_color_buffer_float"),we}function C(A,R,$){return w(A,$)===!0||A.isFramebufferTexture&&A.minFilter!==or&&A.minFilter!==As?Math.log2(Math.max(R.width,R.height))+1:A.mipmaps!==void 0&&A.mipmaps.length>0?A.mipmaps.length:A.isCompressedTexture&&Array.isArray(A.image)?R.mipmaps.length:1}function E(A){return A===or||A===o7||A===mw?e.NEAREST:e.LINEAR}function P(A){const R=A.target;R.removeEventListener("dispose",P),D(R),R.isVideoTexture&&f.delete(R)}function I(A){const R=A.target;R.removeEventListener("dispose",I),B(R)}function D(A){const R=n.get(A);if(R.__webglInit===void 0)return;const $=A.source,le=m.get($);if(le){const ue=le[R.__cacheKey];ue.usedTimes--,ue.usedTimes===0&&L(A),Object.keys(le).length===0&&m.delete($)}n.remove(A)}function L(A){const R=n.get(A);e.deleteTexture(R.__webglTexture);const $=A.source,le=m.get($);delete le[R.__cacheKey],a.memory.textures--}function B(A){const R=A.texture,$=n.get(A),le=n.get(R);if(le.__webglTexture!==void 0&&(e.deleteTexture(le.__webglTexture),a.memory.textures--),A.depthTexture&&A.depthTexture.dispose(),A.isWebGLCubeRenderTarget)for(let ue=0;ue<6;ue++){if(Array.isArray($.__webglFramebuffer[ue]))for(let we=0;we<$.__webglFramebuffer[ue].length;we++)e.deleteFramebuffer($.__webglFramebuffer[ue][we]);else e.deleteFramebuffer($.__webglFramebuffer[ue]);$.__webglDepthbuffer&&e.deleteRenderbuffer($.__webglDepthbuffer[ue])}else{if(Array.isArray($.__webglFramebuffer))for(let ue=0;ue<$.__webglFramebuffer.length;ue++)e.deleteFramebuffer($.__webglFramebuffer[ue]);else e.deleteFramebuffer($.__webglFramebuffer);if($.__webglDepthbuffer&&e.deleteRenderbuffer($.__webglDepthbuffer),$.__webglMultisampledFramebuffer&&e.deleteFramebuffer($.__webglMultisampledFramebuffer),$.__webglColorRenderbuffer)for(let ue=0;ue<$.__webglColorRenderbuffer.length;ue++)$.__webglColorRenderbuffer[ue]&&e.deleteRenderbuffer($.__webglColorRenderbuffer[ue]);$.__webglDepthRenderbuffer&&e.deleteRenderbuffer($.__webglDepthRenderbuffer)}if(A.isWebGLMultipleRenderTargets)for(let ue=0,we=R.length;ue<we;ue++){const De=n.get(R[ue]);De.__webglTexture&&(e.deleteTexture(De.__webglTexture),a.memory.textures--),n.remove(R[ue])}n.remove(R),n.remove(A)}let j=0;function z(){j=0}function O(){const A=j;return A>=l&&console.warn("THREE.WebGLTextures: Trying to use "+A+" texture units while this GPU supports only "+l),j+=1,A}function H(A){const R=[];return R.push(A.wrapS),R.push(A.wrapT),R.push(A.wrapR||0),R.push(A.magFilter),R.push(A.minFilter),R.push(A.anisotropy),R.push(A.internalFormat),R.push(A.format),R.push(A.type),R.push(A.generateMipmaps),R.push(A.premultiplyAlpha),R.push(A.flipY),R.push(A.unpackAlignment),R.push(A.colorSpace),R.join()}function k(A,R){const $=n.get(A);if(A.isVideoTexture&&qe(A),A.isRenderTargetTexture===!1&&A.version>0&&$.__version!==A.version){const le=A.image;if(le===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(le.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{re($,A,R);return}}i.bindTexture(e.TEXTURE_2D,$.__webglTexture,e.TEXTURE0+R)}function N(A,R){const $=n.get(A);if(A.version>0&&$.__version!==A.version){re($,A,R);return}i.bindTexture(e.TEXTURE_2D_ARRAY,$.__webglTexture,e.TEXTURE0+R)}function F(A,R){const $=n.get(A);if(A.version>0&&$.__version!==A.version){re($,A,R);return}i.bindTexture(e.TEXTURE_3D,$.__webglTexture,e.TEXTURE0+R)}function Q(A,R){const $=n.get(A);if(A.version>0&&$.__version!==A.version){de($,A,R);return}i.bindTexture(e.TEXTURE_CUBE_MAP,$.__webglTexture,e.TEXTURE0+R)}const G={[YM]:e.REPEAT,[ra]:e.CLAMP_TO_EDGE,[ZM]:e.MIRRORED_REPEAT},K={[or]:e.NEAREST,[o7]:e.NEAREST_MIPMAP_NEAREST,[mw]:e.NEAREST_MIPMAP_LINEAR,[As]:e.LINEAR,[W2e]:e.LINEAR_MIPMAP_NEAREST,[k0]:e.LINEAR_MIPMAP_LINEAR},W={[s_e]:e.NEVER,[d_e]:e.ALWAYS,[a_e]:e.LESS,[l_e]:e.LEQUAL,[o_e]:e.EQUAL,[u_e]:e.GEQUAL,[c_e]:e.GREATER,[h_e]:e.NOTEQUAL};function se(A,R,$){if($?(e.texParameteri(A,e.TEXTURE_WRAP_S,G[R.wrapS]),e.texParameteri(A,e.TEXTURE_WRAP_T,G[R.wrapT]),(A===e.TEXTURE_3D||A===e.TEXTURE_2D_ARRAY)&&e.texParameteri(A,e.TEXTURE_WRAP_R,G[R.wrapR]),e.texParameteri(A,e.TEXTURE_MAG_FILTER,K[R.magFilter]),e.texParameteri(A,e.TEXTURE_MIN_FILTER,K[R.minFilter])):(e.texParameteri(A,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(A,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),(A===e.TEXTURE_3D||A===e.TEXTURE_2D_ARRAY)&&e.texParameteri(A,e.TEXTURE_WRAP_R,e.CLAMP_TO_EDGE),(R.wrapS!==ra||R.wrapT!==ra)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(A,e.TEXTURE_MAG_FILTER,E(R.magFilter)),e.texParameteri(A,e.TEXTURE_MIN_FILTER,E(R.minFilter)),R.minFilter!==or&&R.minFilter!==As&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),R.compareFunction&&(e.texParameteri(A,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(A,e.TEXTURE_COMPARE_FUNC,W[R.compareFunction])),t.has("EXT_texture_filter_anisotropic")===!0){const le=t.get("EXT_texture_filter_anisotropic");if(R.magFilter===or||R.minFilter!==mw&&R.minFilter!==k0||R.type===sc&&t.has("OES_texture_float_linear")===!1||o===!1&&R.type===V0&&t.has("OES_texture_half_float_linear")===!1)return;(R.anisotropy>1||n.get(R).__currentAnisotropy)&&(e.texParameterf(A,le.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(R.anisotropy,r.getMaxAnisotropy())),n.get(R).__currentAnisotropy=R.anisotropy)}}function ie(A,R){let $=!1;A.__webglInit===void 0&&(A.__webglInit=!0,R.addEventListener("dispose",P));const le=R.source;let ue=m.get(le);ue===void 0&&(ue={},m.set(le,ue));const we=H(R);if(we!==A.__cacheKey){ue[we]===void 0&&(ue[we]={texture:e.createTexture(),usedTimes:0},a.memory.textures++,$=!0),ue[we].usedTimes++;const De=ue[A.__cacheKey];De!==void 0&&(ue[A.__cacheKey].usedTimes--,De.usedTimes===0&&L(R)),A.__cacheKey=we,A.__webglTexture=ue[we].texture}return $}function re(A,R,$){let le=e.TEXTURE_2D;(R.isDataArrayTexture||R.isCompressedArrayTexture)&&(le=e.TEXTURE_2D_ARRAY),R.isData3DTexture&&(le=e.TEXTURE_3D);const ue=ie(A,R),we=R.source;i.bindTexture(le,A.__webglTexture,e.TEXTURE0+$);const De=n.get(we);if(we.version!==De.__version||ue===!0){i.activeTexture(e.TEXTURE0+$),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,R.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,R.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,R.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE);const ne=b(R)&&_(R.image)===!1;let oe=x(R.image,ne,!1,u);oe=q(R,oe);const Y=_(oe)||o,me=s.convert(R.format,R.colorSpace);let Le=s.convert(R.type),Ae=S(R.internalFormat,me,Le,R.colorSpace,R.isVideoTexture);se(le,R,Y);let Ue;const $e=R.mipmaps,at=o&&R.isVideoTexture!==!0,U=De.__version===void 0||ue===!0,ae=C(R,oe,Y);if(R.isDepthTexture)Ae=e.DEPTH_COMPONENT,o?R.type===sc?Ae=e.DEPTH_COMPONENT32F:R.type===rc?Ae=e.DEPTH_COMPONENT24:R.type===Oh?Ae=e.DEPTH24_STENCIL8:Ae=e.DEPTH_COMPONENT16:R.type===sc&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),R.format===Bh&&Ae===e.DEPTH_COMPONENT&&R.type!==JA&&R.type!==rc&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),R.type=rc,Le=s.convert(R.type)),R.format===Np&&Ae===e.DEPTH_COMPONENT&&(Ae=e.DEPTH_STENCIL,R.type!==Oh&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),R.type=Oh,Le=s.convert(R.type))),U&&(at?i.texStorage2D(e.TEXTURE_2D,1,Ae,oe.width,oe.height):i.texImage2D(e.TEXTURE_2D,0,Ae,oe.width,oe.height,0,me,Le,null));else if(R.isDataTexture)if($e.length>0&&Y){at&&U&&i.texStorage2D(e.TEXTURE_2D,ae,Ae,$e[0].width,$e[0].height);for(let J=0,ge=$e.length;J<ge;J++)Ue=$e[J],at?i.texSubImage2D(e.TEXTURE_2D,J,0,0,Ue.width,Ue.height,me,Le,Ue.data):i.texImage2D(e.TEXTURE_2D,J,Ae,Ue.width,Ue.height,0,me,Le,Ue.data);R.generateMipmaps=!1}else at?(U&&i.texStorage2D(e.TEXTURE_2D,ae,Ae,oe.width,oe.height),i.texSubImage2D(e.TEXTURE_2D,0,0,0,oe.width,oe.height,me,Le,oe.data)):i.texImage2D(e.TEXTURE_2D,0,Ae,oe.width,oe.height,0,me,Le,oe.data);else if(R.isCompressedTexture)if(R.isCompressedArrayTexture){at&&U&&i.texStorage3D(e.TEXTURE_2D_ARRAY,ae,Ae,$e[0].width,$e[0].height,oe.depth);for(let J=0,ge=$e.length;J<ge;J++)Ue=$e[J],R.format!==sa?me!==null?at?i.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,J,0,0,0,Ue.width,Ue.height,oe.depth,me,Ue.data,0,0):i.compressedTexImage3D(e.TEXTURE_2D_ARRAY,J,Ae,Ue.width,Ue.height,oe.depth,0,Ue.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):at?i.texSubImage3D(e.TEXTURE_2D_ARRAY,J,0,0,0,Ue.width,Ue.height,oe.depth,me,Le,Ue.data):i.texImage3D(e.TEXTURE_2D_ARRAY,J,Ae,Ue.width,Ue.height,oe.depth,0,me,Le,Ue.data)}else{at&&U&&i.texStorage2D(e.TEXTURE_2D,ae,Ae,$e[0].width,$e[0].height);for(let J=0,ge=$e.length;J<ge;J++)Ue=$e[J],R.format!==sa?me!==null?at?i.compressedTexSubImage2D(e.TEXTURE_2D,J,0,0,Ue.width,Ue.height,me,Ue.data):i.compressedTexImage2D(e.TEXTURE_2D,J,Ae,Ue.width,Ue.height,0,Ue.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):at?i.texSubImage2D(e.TEXTURE_2D,J,0,0,Ue.width,Ue.height,me,Le,Ue.data):i.texImage2D(e.TEXTURE_2D,J,Ae,Ue.width,Ue.height,0,me,Le,Ue.data)}else if(R.isDataArrayTexture)at?(U&&i.texStorage3D(e.TEXTURE_2D_ARRAY,ae,Ae,oe.width,oe.height,oe.depth),i.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,oe.width,oe.height,oe.depth,me,Le,oe.data)):i.texImage3D(e.TEXTURE_2D_ARRAY,0,Ae,oe.width,oe.height,oe.depth,0,me,Le,oe.data);else if(R.isData3DTexture)at?(U&&i.texStorage3D(e.TEXTURE_3D,ae,Ae,oe.width,oe.height,oe.depth),i.texSubImage3D(e.TEXTURE_3D,0,0,0,0,oe.width,oe.height,oe.depth,me,Le,oe.data)):i.texImage3D(e.TEXTURE_3D,0,Ae,oe.width,oe.height,oe.depth,0,me,Le,oe.data);else if(R.isFramebufferTexture){if(U)if(at)i.texStorage2D(e.TEXTURE_2D,ae,Ae,oe.width,oe.height);else{let J=oe.width,ge=oe.height;for(let Te=0;Te<ae;Te++)i.texImage2D(e.TEXTURE_2D,Te,Ae,J,ge,0,me,Le,null),J>>=1,ge>>=1}}else if($e.length>0&&Y){at&&U&&i.texStorage2D(e.TEXTURE_2D,ae,Ae,$e[0].width,$e[0].height);for(let J=0,ge=$e.length;J<ge;J++)Ue=$e[J],at?i.texSubImage2D(e.TEXTURE_2D,J,0,0,me,Le,Ue):i.texImage2D(e.TEXTURE_2D,J,Ae,me,Le,Ue);R.generateMipmaps=!1}else at?(U&&i.texStorage2D(e.TEXTURE_2D,ae,Ae,oe.width,oe.height),i.texSubImage2D(e.TEXTURE_2D,0,0,0,me,Le,oe)):i.texImage2D(e.TEXTURE_2D,0,Ae,me,Le,oe);w(R,Y)&&M(le),De.__version=we.version,R.onUpdate&&R.onUpdate(R)}A.__version=R.version}function de(A,R,$){if(R.image.length!==6)return;const le=ie(A,R),ue=R.source;i.bindTexture(e.TEXTURE_CUBE_MAP,A.__webglTexture,e.TEXTURE0+$);const we=n.get(ue);if(ue.version!==we.__version||le===!0){i.activeTexture(e.TEXTURE0+$),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,R.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,R.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,R.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE);const De=R.isCompressedTexture||R.image[0].isCompressedTexture,ne=R.image[0]&&R.image[0].isDataTexture,oe=[];for(let J=0;J<6;J++)!De&&!ne?oe[J]=x(R.image[J],!1,!0,c):oe[J]=ne?R.image[J].image:R.image[J],oe[J]=q(R,oe[J]);const Y=oe[0],me=_(Y)||o,Le=s.convert(R.format,R.colorSpace),Ae=s.convert(R.type),Ue=S(R.internalFormat,Le,Ae,R.colorSpace),$e=o&&R.isVideoTexture!==!0,at=we.__version===void 0||le===!0;let U=C(R,Y,me);se(e.TEXTURE_CUBE_MAP,R,me);let ae;if(De){$e&&at&&i.texStorage2D(e.TEXTURE_CUBE_MAP,U,Ue,Y.width,Y.height);for(let J=0;J<6;J++){ae=oe[J].mipmaps;for(let ge=0;ge<ae.length;ge++){const Te=ae[ge];R.format!==sa?Le!==null?$e?i.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+J,ge,0,0,Te.width,Te.height,Le,Te.data):i.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+J,ge,Ue,Te.width,Te.height,0,Te.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):$e?i.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+J,ge,0,0,Te.width,Te.height,Le,Ae,Te.data):i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+J,ge,Ue,Te.width,Te.height,0,Le,Ae,Te.data)}}}else{ae=R.mipmaps,$e&&at&&(ae.length>0&&U++,i.texStorage2D(e.TEXTURE_CUBE_MAP,U,Ue,oe[0].width,oe[0].height));for(let J=0;J<6;J++)if(ne){$e?i.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+J,0,0,0,oe[J].width,oe[J].height,Le,Ae,oe[J].data):i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+J,0,Ue,oe[J].width,oe[J].height,0,Le,Ae,oe[J].data);for(let ge=0;ge<ae.length;ge++){const Qe=ae[ge].image[J].image;$e?i.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+J,ge+1,0,0,Qe.width,Qe.height,Le,Ae,Qe.data):i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+J,ge+1,Ue,Qe.width,Qe.height,0,Le,Ae,Qe.data)}}else{$e?i.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+J,0,0,0,Le,Ae,oe[J]):i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+J,0,Ue,Le,Ae,oe[J]);for(let ge=0;ge<ae.length;ge++){const Te=ae[ge];$e?i.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+J,ge+1,0,0,Le,Ae,Te.image[J]):i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+J,ge+1,Ue,Le,Ae,Te.image[J])}}}w(R,me)&&M(e.TEXTURE_CUBE_MAP),we.__version=ue.version,R.onUpdate&&R.onUpdate(R)}A.__version=R.version}function he(A,R,$,le,ue,we){const De=s.convert($.format,$.colorSpace),ne=s.convert($.type),oe=S($.internalFormat,De,ne,$.colorSpace);if(!n.get(R).__hasExternalTextures){const me=Math.max(1,R.width>>we),Le=Math.max(1,R.height>>we);ue===e.TEXTURE_3D||ue===e.TEXTURE_2D_ARRAY?i.texImage3D(ue,we,oe,me,Le,R.depth,0,De,ne,null):i.texImage2D(ue,we,oe,me,Le,0,De,ne,null)}i.bindFramebuffer(e.FRAMEBUFFER,A),je(R)?d.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,le,ue,n.get($).__webglTexture,0,Ce(R)):(ue===e.TEXTURE_2D||ue>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&ue<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,le,ue,n.get($).__webglTexture,we),i.bindFramebuffer(e.FRAMEBUFFER,null)}function X(A,R,$){if(e.bindRenderbuffer(e.RENDERBUFFER,A),R.depthBuffer&&!R.stencilBuffer){let le=e.DEPTH_COMPONENT16;if($||je(R)){const ue=R.depthTexture;ue&&ue.isDepthTexture&&(ue.type===sc?le=e.DEPTH_COMPONENT32F:ue.type===rc&&(le=e.DEPTH_COMPONENT24));const we=Ce(R);je(R)?d.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,we,le,R.width,R.height):e.renderbufferStorageMultisample(e.RENDERBUFFER,we,le,R.width,R.height)}else e.renderbufferStorage(e.RENDERBUFFER,le,R.width,R.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,A)}else if(R.depthBuffer&&R.stencilBuffer){const le=Ce(R);$&&je(R)===!1?e.renderbufferStorageMultisample(e.RENDERBUFFER,le,e.DEPTH24_STENCIL8,R.width,R.height):je(R)?d.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,le,e.DEPTH24_STENCIL8,R.width,R.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,R.width,R.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,A)}else{const le=R.isWebGLMultipleRenderTargets===!0?R.texture:[R.texture];for(let ue=0;ue<le.length;ue++){const we=le[ue],De=s.convert(we.format,we.colorSpace),ne=s.convert(we.type),oe=S(we.internalFormat,De,ne,we.colorSpace),Y=Ce(R);$&&je(R)===!1?e.renderbufferStorageMultisample(e.RENDERBUFFER,Y,oe,R.width,R.height):je(R)?d.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,Y,oe,R.width,R.height):e.renderbufferStorage(e.RENDERBUFFER,oe,R.width,R.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function Ee(A,R){if(R&&R.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(e.FRAMEBUFFER,A),!(R.depthTexture&&R.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!n.get(R.depthTexture).__webglTexture||R.depthTexture.image.width!==R.width||R.depthTexture.image.height!==R.height)&&(R.depthTexture.image.width=R.width,R.depthTexture.image.height=R.height,R.depthTexture.needsUpdate=!0),k(R.depthTexture,0);const le=n.get(R.depthTexture).__webglTexture,ue=Ce(R);if(R.depthTexture.format===Bh)je(R)?d.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,le,0,ue):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,le,0);else if(R.depthTexture.format===Np)je(R)?d.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,le,0,ue):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,le,0);else throw new Error("Unknown depthTexture format")}function Oe(A){const R=n.get(A),$=A.isWebGLCubeRenderTarget===!0;if(A.depthTexture&&!R.__autoAllocateDepthBuffer){if($)throw new Error("target.depthTexture not supported in Cube render targets");Ee(R.__webglFramebuffer,A)}else if($){R.__webglDepthbuffer=[];for(let le=0;le<6;le++)i.bindFramebuffer(e.FRAMEBUFFER,R.__webglFramebuffer[le]),R.__webglDepthbuffer[le]=e.createRenderbuffer(),X(R.__webglDepthbuffer[le],A,!1)}else i.bindFramebuffer(e.FRAMEBUFFER,R.__webglFramebuffer),R.__webglDepthbuffer=e.createRenderbuffer(),X(R.__webglDepthbuffer,A,!1);i.bindFramebuffer(e.FRAMEBUFFER,null)}function Me(A,R,$){const le=n.get(A);R!==void 0&&he(le.__webglFramebuffer,A,A.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),$!==void 0&&Oe(A)}function Ne(A){const R=A.texture,$=n.get(A),le=n.get(R);A.addEventListener("dispose",I),A.isWebGLMultipleRenderTargets!==!0&&(le.__webglTexture===void 0&&(le.__webglTexture=e.createTexture()),le.__version=R.version,a.memory.textures++);const ue=A.isWebGLCubeRenderTarget===!0,we=A.isWebGLMultipleRenderTargets===!0,De=_(A)||o;if(ue){$.__webglFramebuffer=[];for(let ne=0;ne<6;ne++)if(o&&R.mipmaps&&R.mipmaps.length>0){$.__webglFramebuffer[ne]=[];for(let oe=0;oe<R.mipmaps.length;oe++)$.__webglFramebuffer[ne][oe]=e.createFramebuffer()}else $.__webglFramebuffer[ne]=e.createFramebuffer()}else{if(o&&R.mipmaps&&R.mipmaps.length>0){$.__webglFramebuffer=[];for(let ne=0;ne<R.mipmaps.length;ne++)$.__webglFramebuffer[ne]=e.createFramebuffer()}else $.__webglFramebuffer=e.createFramebuffer();if(we)if(r.drawBuffers){const ne=A.texture;for(let oe=0,Y=ne.length;oe<Y;oe++){const me=n.get(ne[oe]);me.__webglTexture===void 0&&(me.__webglTexture=e.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(o&&A.samples>0&&je(A)===!1){const ne=we?R:[R];$.__webglMultisampledFramebuffer=e.createFramebuffer(),$.__webglColorRenderbuffer=[],i.bindFramebuffer(e.FRAMEBUFFER,$.__webglMultisampledFramebuffer);for(let oe=0;oe<ne.length;oe++){const Y=ne[oe];$.__webglColorRenderbuffer[oe]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,$.__webglColorRenderbuffer[oe]);const me=s.convert(Y.format,Y.colorSpace),Le=s.convert(Y.type),Ae=S(Y.internalFormat,me,Le,Y.colorSpace,A.isXRRenderTarget===!0),Ue=Ce(A);e.renderbufferStorageMultisample(e.RENDERBUFFER,Ue,Ae,A.width,A.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+oe,e.RENDERBUFFER,$.__webglColorRenderbuffer[oe])}e.bindRenderbuffer(e.RENDERBUFFER,null),A.depthBuffer&&($.__webglDepthRenderbuffer=e.createRenderbuffer(),X($.__webglDepthRenderbuffer,A,!0)),i.bindFramebuffer(e.FRAMEBUFFER,null)}}if(ue){i.bindTexture(e.TEXTURE_CUBE_MAP,le.__webglTexture),se(e.TEXTURE_CUBE_MAP,R,De);for(let ne=0;ne<6;ne++)if(o&&R.mipmaps&&R.mipmaps.length>0)for(let oe=0;oe<R.mipmaps.length;oe++)he($.__webglFramebuffer[ne][oe],A,R,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+ne,oe);else he($.__webglFramebuffer[ne],A,R,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+ne,0);w(R,De)&&M(e.TEXTURE_CUBE_MAP),i.unbindTexture()}else if(we){const ne=A.texture;for(let oe=0,Y=ne.length;oe<Y;oe++){const me=ne[oe],Le=n.get(me);i.bindTexture(e.TEXTURE_2D,Le.__webglTexture),se(e.TEXTURE_2D,me,De),he($.__webglFramebuffer,A,me,e.COLOR_ATTACHMENT0+oe,e.TEXTURE_2D,0),w(me,De)&&M(e.TEXTURE_2D)}i.unbindTexture()}else{let ne=e.TEXTURE_2D;if((A.isWebGL3DRenderTarget||A.isWebGLArrayRenderTarget)&&(o?ne=A.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),i.bindTexture(ne,le.__webglTexture),se(ne,R,De),o&&R.mipmaps&&R.mipmaps.length>0)for(let oe=0;oe<R.mipmaps.length;oe++)he($.__webglFramebuffer[oe],A,R,e.COLOR_ATTACHMENT0,ne,oe);else he($.__webglFramebuffer,A,R,e.COLOR_ATTACHMENT0,ne,0);w(R,De)&&M(ne),i.unbindTexture()}A.depthBuffer&&Oe(A)}function He(A){const R=_(A)||o,$=A.isWebGLMultipleRenderTargets===!0?A.texture:[A.texture];for(let le=0,ue=$.length;le<ue;le++){const we=$[le];if(w(we,R)){const De=A.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,ne=n.get(we).__webglTexture;i.bindTexture(De,ne),M(De),i.unbindTexture()}}}function Pe(A){if(o&&A.samples>0&&je(A)===!1){const R=A.isWebGLMultipleRenderTargets?A.texture:[A.texture],$=A.width,le=A.height;let ue=e.COLOR_BUFFER_BIT;const we=[],De=A.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,ne=n.get(A),oe=A.isWebGLMultipleRenderTargets===!0;if(oe)for(let Y=0;Y<R.length;Y++)i.bindFramebuffer(e.FRAMEBUFFER,ne.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+Y,e.RENDERBUFFER,null),i.bindFramebuffer(e.FRAMEBUFFER,ne.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+Y,e.TEXTURE_2D,null,0);i.bindFramebuffer(e.READ_FRAMEBUFFER,ne.__webglMultisampledFramebuffer),i.bindFramebuffer(e.DRAW_FRAMEBUFFER,ne.__webglFramebuffer);for(let Y=0;Y<R.length;Y++){we.push(e.COLOR_ATTACHMENT0+Y),A.depthBuffer&&we.push(De);const me=ne.__ignoreDepthValues!==void 0?ne.__ignoreDepthValues:!1;if(me===!1&&(A.depthBuffer&&(ue|=e.DEPTH_BUFFER_BIT),A.stencilBuffer&&(ue|=e.STENCIL_BUFFER_BIT)),oe&&e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,ne.__webglColorRenderbuffer[Y]),me===!0&&(e.invalidateFramebuffer(e.READ_FRAMEBUFFER,[De]),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[De])),oe){const Le=n.get(R[Y]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,Le,0)}e.blitFramebuffer(0,0,$,le,0,0,$,le,ue,e.NEAREST),p&&e.invalidateFramebuffer(e.READ_FRAMEBUFFER,we)}if(i.bindFramebuffer(e.READ_FRAMEBUFFER,null),i.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),oe)for(let Y=0;Y<R.length;Y++){i.bindFramebuffer(e.FRAMEBUFFER,ne.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+Y,e.RENDERBUFFER,ne.__webglColorRenderbuffer[Y]);const me=n.get(R[Y]).__webglTexture;i.bindFramebuffer(e.FRAMEBUFFER,ne.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+Y,e.TEXTURE_2D,me,0)}i.bindFramebuffer(e.DRAW_FRAMEBUFFER,ne.__webglMultisampledFramebuffer)}}function Ce(A){return Math.min(h,A.samples)}function je(A){const R=n.get(A);return o&&A.samples>0&&t.has("WEBGL_multisampled_render_to_texture")===!0&&R.__useRenderToTexture!==!1}function qe(A){const R=a.render.frame;f.get(A)!==R&&(f.set(A,R),A.update())}function q(A,R){const $=A.colorSpace,le=A.format,ue=A.type;return A.isCompressedTexture===!0||A.isVideoTexture===!0||A.format===QM||$!==lo&&$!==Uh&&($===gi||$===D2?o===!1?t.has("EXT_sRGB")===!0&&le===sa?(A.format=QM,A.minFilter=As,A.generateMipmaps=!1):R=tk.sRGBToLinear(R):(le!==sa||ue!==Mc)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",$)),R}this.allocateTextureUnit=O,this.resetTextureUnits=z,this.setTexture2D=k,this.setTexture2DArray=N,this.setTexture3D=F,this.setTextureCube=Q,this.rebindTextures=Me,this.setupRenderTarget=Ne,this.updateRenderTargetMipmap=He,this.updateMultisampleRenderTarget=Pe,this.setupDepthRenderbuffer=Oe,this.setupFrameBufferTexture=he,this.useMultisampledRTT=je}const PMe=0,tn=1;function DMe(e,t,i){const n=i.isWebGL2;function r(s,a=Uh){let o;const l=a===gi||a===D2?tn:PMe;if(s===Mc)return e.UNSIGNED_BYTE;if(s===qz)return e.UNSIGNED_SHORT_4_4_4_4;if(s===Yz)return e.UNSIGNED_SHORT_5_5_5_1;if(s===X2e)return e.BYTE;if(s===q2e)return e.SHORT;if(s===JA)return e.UNSIGNED_SHORT;if(s===Xz)return e.INT;if(s===rc)return e.UNSIGNED_INT;if(s===sc)return e.FLOAT;if(s===V0)return n?e.HALF_FLOAT:(o=t.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(s===Y2e)return e.ALPHA;if(s===sa)return e.RGBA;if(s===Z2e)return e.LUMINANCE;if(s===Q2e)return e.LUMINANCE_ALPHA;if(s===Bh)return e.DEPTH_COMPONENT;if(s===Np)return e.DEPTH_STENCIL;if(s===QM)return o=t.get("EXT_sRGB"),o!==null?o.SRGB_ALPHA_EXT:null;if(s===K2e)return e.RED;if(s===Zz)return e.RED_INTEGER;if(s===$2e)return e.RG;if(s===Qz)return e.RG_INTEGER;if(s===Kz)return e.RGBA_INTEGER;if(s===gw||s===vw||s===yw||s===xw)if(l===tn)if(o=t.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(s===gw)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===vw)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===yw)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===xw)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=t.get("WEBGL_compressed_texture_s3tc"),o!==null){if(s===gw)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===vw)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===yw)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===xw)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===l7||s===c7||s===h7||s===u7)if(o=t.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(s===l7)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===c7)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===h7)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===u7)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===J2e)return o=t.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===d7||s===p7)if(o=t.get("WEBGL_compressed_texture_etc"),o!==null){if(s===d7)return l===tn?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(s===p7)return l===tn?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===f7||s===m7||s===g7||s===v7||s===y7||s===x7||s===_7||s===b7||s===w7||s===S7||s===M7||s===C7||s===E7||s===A7)if(o=t.get("WEBGL_compressed_texture_astc"),o!==null){if(s===f7)return l===tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===m7)return l===tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===g7)return l===tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===v7)return l===tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===y7)return l===tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===x7)return l===tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===_7)return l===tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===b7)return l===tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===w7)return l===tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===S7)return l===tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===M7)return l===tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===C7)return l===tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===E7)return l===tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===A7)return l===tn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===_w||s===T7||s===P7)if(o=t.get("EXT_texture_compression_bptc"),o!==null){if(s===_w)return l===tn?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(s===T7)return o.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(s===P7)return o.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(s===e_e||s===D7||s===L7||s===R7)if(o=t.get("EXT_texture_compression_rgtc"),o!==null){if(s===_w)return o.COMPRESSED_RED_RGTC1_EXT;if(s===D7)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===L7)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===R7)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===Oh?n?e.UNSIGNED_INT_24_8:(o=t.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null):e[s]!==void 0?e[s]:null}return{convert:r}}class LMe extends Kr{constructor(t=[]){super(),this.isArrayCamera=!0,this.cameras=t}}class _v extends mr{constructor(){super(),this.isGroup=!0,this.type="Group"}}const RMe={type:"move"};class Hw{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new _v,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new _v,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new fe,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new fe),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new _v,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new fe,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new fe),this._grip}dispatchEvent(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this._hand!==null&&this._hand.dispatchEvent(t),this}connect(t){if(t&&t.hand){const i=this._hand;if(i)for(const n of t.hand.values())this._getHandJoint(i,n)}return this.dispatchEvent({type:"connected",data:t}),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(t,i,n){let r=null,s=null,a=null;const o=this._targetRay,l=this._grip,c=this._hand;if(t&&i.session.visibilityState!=="visible-blurred"){if(c&&t.hand){a=!0;for(const v of t.hand.values()){const m=i.getJointPose(v,n),g=this._getHandJoint(c,v);m!==null&&(g.matrix.fromArray(m.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.matrixWorldNeedsUpdate=!0,g.jointRadius=m.radius),g.visible=m!==null}const u=c.joints["index-finger-tip"],h=c.joints["thumb-tip"],d=u.position.distanceTo(h.position),p=.02,f=.005;c.inputState.pinching&&d>p+f?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!c.inputState.pinching&&d<=p-f&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else l!==null&&t.gripSpace&&(s=i.getPose(t.gripSpace,n),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));o!==null&&(r=i.getPose(t.targetRaySpace,n),r===null&&s!==null&&(r=s),r!==null&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(RMe)))}return o!==null&&(o.visible=r!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=a!==null),this}_getHandJoint(t,i){if(t.joints[i.jointName]===void 0){const n=new _v;n.matrixAutoUpdate=!1,n.visible=!1,t.joints[i.jointName]=n,t.add(n)}return t.joints[i.jointName]}}class IMe extends Nr{constructor(t,i,n,r,s,a,o,l,c,u){if(u=u!==void 0?u:Bh,u!==Bh&&u!==Np)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&u===Bh&&(n=rc),n===void 0&&u===Np&&(n=Oh),super(null,r,s,a,o,l,u,n,c),this.isDepthTexture=!0,this.image={width:t,height:i},this.magFilter=o!==void 0?o:or,this.minFilter=l!==void 0?l:or,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(t){return super.copy(t),this.compareFunction=t.compareFunction,this}toJSON(t){const i=super.toJSON(t);return this.compareFunction!==null&&(i.compareFunction=this.compareFunction),i}}class OMe extends lu{constructor(t,i){super();const n=this;let r=null,s=1,a=null,o="local-floor",l=1,c=null,u=null,h=null,d=null,p=null,f=null;const v=i.getContextAttributes();let m=null,g=null;const y=[],x=[],_=new Kr;_.layers.enable(1),_.viewport=new xi;const b=new Kr;b.layers.enable(2),b.viewport=new xi;const w=[_,b],M=new LMe;M.layers.enable(1),M.layers.enable(2);let S=null,C=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(N){let F=y[N];return F===void 0&&(F=new Hw,y[N]=F),F.getTargetRaySpace()},this.getControllerGrip=function(N){let F=y[N];return F===void 0&&(F=new Hw,y[N]=F),F.getGripSpace()},this.getHand=function(N){let F=y[N];return F===void 0&&(F=new Hw,y[N]=F),F.getHandSpace()};function E(N){const F=x.indexOf(N.inputSource);if(F===-1)return;const Q=y[F];Q!==void 0&&(Q.update(N.inputSource,N.frame,c||a),Q.dispatchEvent({type:N.type,data:N.inputSource}))}function P(){r.removeEventListener("select",E),r.removeEventListener("selectstart",E),r.removeEventListener("selectend",E),r.removeEventListener("squeeze",E),r.removeEventListener("squeezestart",E),r.removeEventListener("squeezeend",E),r.removeEventListener("end",P),r.removeEventListener("inputsourceschange",I);for(let N=0;N<y.length;N++){const F=x[N];F!==null&&(x[N]=null,y[N].disconnect(F))}S=null,C=null,t.setRenderTarget(m),p=null,d=null,h=null,r=null,g=null,k.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(N){s=N,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(N){o=N,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||a},this.setReferenceSpace=function(N){c=N},this.getBaseLayer=function(){return d!==null?d:p},this.getBinding=function(){return h},this.getFrame=function(){return f},this.getSession=function(){return r},this.setSession=async function(N){if(r=N,r!==null){if(m=t.getRenderTarget(),r.addEventListener("select",E),r.addEventListener("selectstart",E),r.addEventListener("selectend",E),r.addEventListener("squeeze",E),r.addEventListener("squeezestart",E),r.addEventListener("squeezeend",E),r.addEventListener("end",P),r.addEventListener("inputsourceschange",I),v.xrCompatible!==!0&&await i.makeXRCompatible(),r.renderState.layers===void 0||t.capabilities.isWebGL2===!1){const F={antialias:r.renderState.layers===void 0?v.antialias:!0,alpha:!0,depth:v.depth,stencil:v.stencil,framebufferScaleFactor:s};p=new XRWebGLLayer(r,i,F),r.updateRenderState({baseLayer:p}),g=new Qh(p.framebufferWidth,p.framebufferHeight,{format:sa,type:Mc,colorSpace:t.outputColorSpace,stencilBuffer:v.stencil})}else{let F=null,Q=null,G=null;v.depth&&(G=v.stencil?i.DEPTH24_STENCIL8:i.DEPTH_COMPONENT24,F=v.stencil?Np:Bh,Q=v.stencil?Oh:rc);const K={colorFormat:i.RGBA8,depthFormat:G,scaleFactor:s};h=new XRWebGLBinding(r,i),d=h.createProjectionLayer(K),r.updateRenderState({layers:[d]}),g=new Qh(d.textureWidth,d.textureHeight,{format:sa,type:Mc,depthTexture:new IMe(d.textureWidth,d.textureHeight,Q,void 0,void 0,void 0,void 0,void 0,void 0,F),stencilBuffer:v.stencil,colorSpace:t.outputColorSpace,samples:v.antialias?4:0});const W=t.properties.get(g);W.__ignoreDepthValues=d.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(l),c=null,a=await r.requestReferenceSpace(o),k.setContext(r),k.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode};function I(N){for(let F=0;F<N.removed.length;F++){const Q=N.removed[F],G=x.indexOf(Q);G>=0&&(x[G]=null,y[G].disconnect(Q))}for(let F=0;F<N.added.length;F++){const Q=N.added[F];let G=x.indexOf(Q);if(G===-1){for(let W=0;W<y.length;W++)if(W>=x.length){x.push(Q),G=W;break}else if(x[W]===null){x[W]=Q,G=W;break}if(G===-1)break}const K=y[G];K&&K.connect(Q)}}const D=new fe,L=new fe;function B(N,F,Q){D.setFromMatrixPosition(F.matrixWorld),L.setFromMatrixPosition(Q.matrixWorld);const G=D.distanceTo(L),K=F.projectionMatrix.elements,W=Q.projectionMatrix.elements,se=K[14]/(K[10]-1),ie=K[14]/(K[10]+1),re=(K[9]+1)/K[5],de=(K[9]-1)/K[5],he=(K[8]-1)/K[0],X=(W[8]+1)/W[0],Ee=se*he,Oe=se*X,Me=G/(-he+X),Ne=Me*-he;F.matrixWorld.decompose(N.position,N.quaternion,N.scale),N.translateX(Ne),N.translateZ(Me),N.matrixWorld.compose(N.position,N.quaternion,N.scale),N.matrixWorldInverse.copy(N.matrixWorld).invert();const He=se+Me,Pe=ie+Me,Ce=Ee-Ne,je=Oe+(G-Ne),qe=re*ie/Pe*He,q=de*ie/Pe*He;N.projectionMatrix.makePerspective(Ce,je,qe,q,He,Pe),N.projectionMatrixInverse.copy(N.projectionMatrix).invert()}function j(N,F){F===null?N.matrixWorld.copy(N.matrix):N.matrixWorld.multiplyMatrices(F.matrixWorld,N.matrix),N.matrixWorldInverse.copy(N.matrixWorld).invert()}this.updateCamera=function(N){if(r===null)return;M.near=b.near=_.near=N.near,M.far=b.far=_.far=N.far,(S!==M.near||C!==M.far)&&(r.updateRenderState({depthNear:M.near,depthFar:M.far}),S=M.near,C=M.far);const F=N.parent,Q=M.cameras;j(M,F);for(let G=0;G<Q.length;G++)j(Q[G],F);Q.length===2?B(M,_,b):M.projectionMatrix.copy(_.projectionMatrix),z(N,M,F)};function z(N,F,Q){Q===null?N.matrix.copy(F.matrixWorld):(N.matrix.copy(Q.matrixWorld),N.matrix.invert(),N.matrix.multiply(F.matrixWorld)),N.matrix.decompose(N.position,N.quaternion,N.scale),N.updateMatrixWorld(!0),N.projectionMatrix.copy(F.projectionMatrix),N.projectionMatrixInverse.copy(F.projectionMatrixInverse),N.isPerspectiveCamera&&(N.fov=H0*2*Math.atan(1/N.projectionMatrix.elements[5]),N.zoom=1)}this.getCamera=function(){return M},this.getFoveation=function(){if(!(d===null&&p===null))return l},this.setFoveation=function(N){l=N,d!==null&&(d.fixedFoveation=N),p!==null&&p.fixedFoveation!==void 0&&(p.fixedFoveation=N)};let O=null;function H(N,F){if(u=F.getViewerPose(c||a),f=F,u!==null){const Q=u.views;p!==null&&(t.setRenderTargetFramebuffer(g,p.framebuffer),t.setRenderTarget(g));let G=!1;Q.length!==M.cameras.length&&(M.cameras.length=0,G=!0);for(let K=0;K<Q.length;K++){const W=Q[K];let se=null;if(p!==null)se=p.getViewport(W);else{const re=h.getViewSubImage(d,W);se=re.viewport,K===0&&(t.setRenderTargetTextures(g,re.colorTexture,d.ignoreDepthValues?void 0:re.depthStencilTexture),t.setRenderTarget(g))}let ie=w[K];ie===void 0&&(ie=new Kr,ie.layers.enable(K),ie.viewport=new xi,w[K]=ie),ie.matrix.fromArray(W.transform.matrix),ie.matrix.decompose(ie.position,ie.quaternion,ie.scale),ie.projectionMatrix.fromArray(W.projectionMatrix),ie.projectionMatrixInverse.copy(ie.projectionMatrix).invert(),ie.viewport.set(se.x,se.y,se.width,se.height),K===0&&(M.matrix.copy(ie.matrix),M.matrix.decompose(M.position,M.quaternion,M.scale)),G===!0&&M.cameras.push(ie)}}for(let Q=0;Q<y.length;Q++){const G=x[Q],K=y[Q];G!==null&&K!==void 0&&K.update(G,F,c||a)}O&&O(N,F),F.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:F}),f=null}const k=new uk;k.setAnimationLoop(H),this.setAnimationLoop=function(N){O=N},this.dispose=function(){}}}function BMe(e,t){function i(m,g){m.matrixAutoUpdate===!0&&m.updateMatrix(),g.value.copy(m.matrix)}function n(m,g){g.color.getRGB(m.fogColor.value,ck(e)),g.isFog?(m.fogNear.value=g.near,m.fogFar.value=g.far):g.isFogExp2&&(m.fogDensity.value=g.density)}function r(m,g,y,x,_){g.isMeshBasicMaterial||g.isMeshLambertMaterial?s(m,g):g.isMeshToonMaterial?(s(m,g),h(m,g)):g.isMeshPhongMaterial?(s(m,g),u(m,g)):g.isMeshStandardMaterial?(s(m,g),d(m,g),g.isMeshPhysicalMaterial&&p(m,g,_)):g.isMeshMatcapMaterial?(s(m,g),f(m,g)):g.isMeshDepthMaterial?s(m,g):g.isMeshDistanceMaterial?(s(m,g),v(m,g)):g.isMeshNormalMaterial?s(m,g):g.isLineBasicMaterial?(a(m,g),g.isLineDashedMaterial&&o(m,g)):g.isPointsMaterial?l(m,g,y,x):g.isSpriteMaterial?c(m,g):g.isShadowMaterial?(m.color.value.copy(g.color),m.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function s(m,g){m.opacity.value=g.opacity,g.color&&m.diffuse.value.copy(g.color),g.emissive&&m.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(m.map.value=g.map,i(g.map,m.mapTransform)),g.alphaMap&&(m.alphaMap.value=g.alphaMap,i(g.alphaMap,m.alphaMapTransform)),g.bumpMap&&(m.bumpMap.value=g.bumpMap,i(g.bumpMap,m.bumpMapTransform),m.bumpScale.value=g.bumpScale,g.side===Br&&(m.bumpScale.value*=-1)),g.normalMap&&(m.normalMap.value=g.normalMap,i(g.normalMap,m.normalMapTransform),m.normalScale.value.copy(g.normalScale),g.side===Br&&m.normalScale.value.negate()),g.displacementMap&&(m.displacementMap.value=g.displacementMap,i(g.displacementMap,m.displacementMapTransform),m.displacementScale.value=g.displacementScale,m.displacementBias.value=g.displacementBias),g.emissiveMap&&(m.emissiveMap.value=g.emissiveMap,i(g.emissiveMap,m.emissiveMapTransform)),g.specularMap&&(m.specularMap.value=g.specularMap,i(g.specularMap,m.specularMapTransform)),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest);const y=t.get(g).envMap;if(y&&(m.envMap.value=y,m.flipEnvMap.value=y.isCubeTexture&&y.isRenderTargetTexture===!1?-1:1,m.reflectivity.value=g.reflectivity,m.ior.value=g.ior,m.refractionRatio.value=g.refractionRatio),g.lightMap){m.lightMap.value=g.lightMap;const x=e._useLegacyLights===!0?Math.PI:1;m.lightMapIntensity.value=g.lightMapIntensity*x,i(g.lightMap,m.lightMapTransform)}g.aoMap&&(m.aoMap.value=g.aoMap,m.aoMapIntensity.value=g.aoMapIntensity,i(g.aoMap,m.aoMapTransform))}function a(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,g.map&&(m.map.value=g.map,i(g.map,m.mapTransform))}function o(m,g){m.dashSize.value=g.dashSize,m.totalSize.value=g.dashSize+g.gapSize,m.scale.value=g.scale}function l(m,g,y,x){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.size.value=g.size*y,m.scale.value=x*.5,g.map&&(m.map.value=g.map,i(g.map,m.uvTransform)),g.alphaMap&&(m.alphaMap.value=g.alphaMap,i(g.alphaMap,m.alphaMapTransform)),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest)}function c(m,g){m.diffuse.value.copy(g.color),m.opacity.value=g.opacity,m.rotation.value=g.rotation,g.map&&(m.map.value=g.map,i(g.map,m.mapTransform)),g.alphaMap&&(m.alphaMap.value=g.alphaMap,i(g.alphaMap,m.alphaMapTransform)),g.alphaTest>0&&(m.alphaTest.value=g.alphaTest)}function u(m,g){m.specular.value.copy(g.specular),m.shininess.value=Math.max(g.shininess,1e-4)}function h(m,g){g.gradientMap&&(m.gradientMap.value=g.gradientMap)}function d(m,g){m.metalness.value=g.metalness,g.metalnessMap&&(m.metalnessMap.value=g.metalnessMap,i(g.metalnessMap,m.metalnessMapTransform)),m.roughness.value=g.roughness,g.roughnessMap&&(m.roughnessMap.value=g.roughnessMap,i(g.roughnessMap,m.roughnessMapTransform)),t.get(g).envMap&&(m.envMapIntensity.value=g.envMapIntensity)}function p(m,g,y){m.ior.value=g.ior,g.sheen>0&&(m.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),m.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(m.sheenColorMap.value=g.sheenColorMap,i(g.sheenColorMap,m.sheenColorMapTransform)),g.sheenRoughnessMap&&(m.sheenRoughnessMap.value=g.sheenRoughnessMap,i(g.sheenRoughnessMap,m.sheenRoughnessMapTransform))),g.clearcoat>0&&(m.clearcoat.value=g.clearcoat,m.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(m.clearcoatMap.value=g.clearcoatMap,i(g.clearcoatMap,m.clearcoatMapTransform)),g.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap,i(g.clearcoatRoughnessMap,m.clearcoatRoughnessMapTransform)),g.clearcoatNormalMap&&(m.clearcoatNormalMap.value=g.clearcoatNormalMap,i(g.clearcoatNormalMap,m.clearcoatNormalMapTransform),m.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),g.side===Br&&m.clearcoatNormalScale.value.negate())),g.iridescence>0&&(m.iridescence.value=g.iridescence,m.iridescenceIOR.value=g.iridescenceIOR,m.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(m.iridescenceMap.value=g.iridescenceMap,i(g.iridescenceMap,m.iridescenceMapTransform)),g.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=g.iridescenceThicknessMap,i(g.iridescenceThicknessMap,m.iridescenceThicknessMapTransform))),g.transmission>0&&(m.transmission.value=g.transmission,m.transmissionSamplerMap.value=y.texture,m.transmissionSamplerSize.value.set(y.width,y.height),g.transmissionMap&&(m.transmissionMap.value=g.transmissionMap,i(g.transmissionMap,m.transmissionMapTransform)),m.thickness.value=g.thickness,g.thicknessMap&&(m.thicknessMap.value=g.thicknessMap,i(g.thicknessMap,m.thicknessMapTransform)),m.attenuationDistance.value=g.attenuationDistance,m.attenuationColor.value.copy(g.attenuationColor)),g.anisotropy>0&&(m.anisotropyVector.value.set(g.anisotropy*Math.cos(g.anisotropyRotation),g.anisotropy*Math.sin(g.anisotropyRotation)),g.anisotropyMap&&(m.anisotropyMap.value=g.anisotropyMap,i(g.anisotropyMap,m.anisotropyMapTransform))),m.specularIntensity.value=g.specularIntensity,m.specularColor.value.copy(g.specularColor),g.specularColorMap&&(m.specularColorMap.value=g.specularColorMap,i(g.specularColorMap,m.specularColorMapTransform)),g.specularIntensityMap&&(m.specularIntensityMap.value=g.specularIntensityMap,i(g.specularIntensityMap,m.specularIntensityMapTransform))}function f(m,g){g.matcap&&(m.matcap.value=g.matcap)}function v(m,g){const y=t.get(g).light;m.referencePosition.value.setFromMatrixPosition(y.matrixWorld),m.nearDistance.value=y.shadow.camera.near,m.farDistance.value=y.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function NMe(e,t,i,n){let r={},s={},a=[];const o=i.isWebGL2?e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(y,x){const _=x.program;n.uniformBlockBinding(y,_)}function c(y,x){let _=r[y.id];_===void 0&&(f(y),_=u(y),r[y.id]=_,y.addEventListener("dispose",m));const b=x.program;n.updateUBOMapping(y,b);const w=t.render.frame;s[y.id]!==w&&(d(y),s[y.id]=w)}function u(y){const x=h();y.__bindingPointIndex=x;const _=e.createBuffer(),b=y.__size,w=y.usage;return e.bindBuffer(e.UNIFORM_BUFFER,_),e.bufferData(e.UNIFORM_BUFFER,b,w),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,x,_),_}function h(){for(let y=0;y<o;y++)if(a.indexOf(y)===-1)return a.push(y),y;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(y){const x=r[y.id],_=y.uniforms,b=y.__cache;e.bindBuffer(e.UNIFORM_BUFFER,x);for(let w=0,M=_.length;w<M;w++){const S=_[w];if(p(S,w,b)===!0){const C=S.__offset,E=Array.isArray(S.value)?S.value:[S.value];let P=0;for(let I=0;I<E.length;I++){const D=E[I],L=v(D);typeof D=="number"?(S.__data[0]=D,e.bufferSubData(e.UNIFORM_BUFFER,C+P,S.__data)):D.isMatrix3?(S.__data[0]=D.elements[0],S.__data[1]=D.elements[1],S.__data[2]=D.elements[2],S.__data[3]=D.elements[0],S.__data[4]=D.elements[3],S.__data[5]=D.elements[4],S.__data[6]=D.elements[5],S.__data[7]=D.elements[0],S.__data[8]=D.elements[6],S.__data[9]=D.elements[7],S.__data[10]=D.elements[8],S.__data[11]=D.elements[0]):(D.toArray(S.__data,P),P+=L.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,C,S.__data)}}e.bindBuffer(e.UNIFORM_BUFFER,null)}function p(y,x,_){const b=y.value;if(_[x]===void 0){if(typeof b=="number")_[x]=b;else{const w=Array.isArray(b)?b:[b],M=[];for(let S=0;S<w.length;S++)M.push(w[S].clone());_[x]=M}return!0}else if(typeof b=="number"){if(_[x]!==b)return _[x]=b,!0}else{const w=Array.isArray(_[x])?_[x]:[_[x]],M=Array.isArray(b)?b:[b];for(let S=0;S<w.length;S++){const C=w[S];if(C.equals(M[S])===!1)return C.copy(M[S]),!0}}return!1}function f(y){const x=y.uniforms;let _=0;const b=16;let w=0;for(let M=0,S=x.length;M<S;M++){const C=x[M],E={boundary:0,storage:0},P=Array.isArray(C.value)?C.value:[C.value];for(let I=0,D=P.length;I<D;I++){const L=P[I],B=v(L);E.boundary+=B.boundary,E.storage+=B.storage}if(C.__data=new Float32Array(E.storage/Float32Array.BYTES_PER_ELEMENT),C.__offset=_,M>0){w=_%b;const I=b-w;w!==0&&I-E.boundary<0&&(_+=b-w,C.__offset=_)}_+=E.storage}return w=_%b,w>0&&(_+=b-w),y.__size=_,y.__cache={},this}function v(y){const x={boundary:0,storage:0};return typeof y=="number"?(x.boundary=4,x.storage=4):y.isVector2?(x.boundary=8,x.storage=8):y.isVector3||y.isColor?(x.boundary=16,x.storage=12):y.isVector4?(x.boundary=16,x.storage=16):y.isMatrix3?(x.boundary=48,x.storage=48):y.isMatrix4?(x.boundary=64,x.storage=64):y.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",y),x}function m(y){const x=y.target;x.removeEventListener("dispose",m);const _=a.indexOf(x.__bindingPointIndex);a.splice(_,1),e.deleteBuffer(r[x.id]),delete r[x.id],delete s[x.id]}function g(){for(const y in r)e.deleteBuffer(r[y]);a=[],r={},s={}}return{bind:l,update:c,dispose:g}}class gk{constructor(t={}){const{canvas:i=T_e(),context:n=null,depth:r=!0,stencil:s=!0,alpha:a=!1,antialias:o=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:h=!1}=t;this.isWebGLRenderer=!0;let d;n!==null?d=n.getContextAttributes().alpha:d=a;const p=new Uint32Array(4),f=new Int32Array(4);let v=null,m=null;const g=[],y=[];this.domElement=i,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=gi,this._useLegacyLights=!1,this.toneMapping=Sc,this.toneMappingExposure=1;const x=this;let _=!1,b=0,w=0,M=null,S=-1,C=null;const E=new xi,P=new xi;let I=null;const D=new ri(0);let L=0,B=i.width,j=i.height,z=1,O=null,H=null;const k=new xi(0,0,B,j),N=new xi(0,0,B,j);let F=!1;const Q=new n4;let G=!1,K=!1,W=null;const se=new Ki,ie=new Pt,re=new fe,de={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function he(){return M===null?z:1}let X=n;function Ee(V,ce){for(let ye=0;ye<V.length;ye++){const pe=V[ye],_e=i.getContext(pe,ce);if(_e!==null)return _e}return null}try{const V={alpha:!0,depth:r,stencil:s,antialias:o,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:h};if("setAttribute"in i&&i.setAttribute("data-engine",`three.js r${$A}`),i.addEventListener("webglcontextlost",ae,!1),i.addEventListener("webglcontextrestored",J,!1),i.addEventListener("webglcontextcreationerror",ge,!1),X===null){const ce=["webgl2","webgl","experimental-webgl"];if(x.isWebGL1Renderer===!0&&ce.shift(),X=Ee(ce,V),X===null)throw Ee(ce)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&X instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),X.getShaderPrecisionFormat===void 0&&(X.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(V){throw console.error("THREE.WebGLRenderer: "+V.message),V}let Oe,Me,Ne,He,Pe,Ce,je,qe,q,A,R,$,le,ue,we,De,ne,oe,Y,me,Le,Ae,Ue,$e;function at(){Oe=new X3e(X),Me=new z3e(X,Oe,t),Oe.init(Me),Ae=new DMe(X,Oe,Me),Ne=new AMe(X,Oe,Me),He=new Z3e(X),Pe=new pMe,Ce=new TMe(X,Oe,Ne,Pe,Me,Ae,He),je=new V3e(x),qe=new W3e(x),q=new rbe(X,Me),Ue=new U3e(X,Oe,q,Me),A=new q3e(X,q,He,Ue),R=new J3e(X,A,q,He),Y=new $3e(X,Me,Ce),De=new k3e(Pe),$=new dMe(x,je,qe,Oe,Me,Ue,De),le=new BMe(x,Pe),ue=new mMe,we=new bMe(Oe,Me),oe=new N3e(x,je,qe,Ne,R,d,l),ne=new EMe(x,R,Me),$e=new NMe(X,He,Me,Ne),me=new F3e(X,Oe,He,Me),Le=new Y3e(X,Oe,He,Me),He.programs=$.programs,x.capabilities=Me,x.extensions=Oe,x.properties=Pe,x.renderLists=ue,x.shadowMap=ne,x.state=Ne,x.info=He}at();const U=new OMe(x,X);this.xr=U,this.getContext=function(){return X},this.getContextAttributes=function(){return X.getContextAttributes()},this.forceContextLoss=function(){const V=Oe.get("WEBGL_lose_context");V&&V.loseContext()},this.forceContextRestore=function(){const V=Oe.get("WEBGL_lose_context");V&&V.restoreContext()},this.getPixelRatio=function(){return z},this.setPixelRatio=function(V){V!==void 0&&(z=V,this.setSize(B,j,!1))},this.getSize=function(V){return V.set(B,j)},this.setSize=function(V,ce,ye=!0){if(U.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}B=V,j=ce,i.width=Math.floor(V*z),i.height=Math.floor(ce*z),ye===!0&&(i.style.width=V+"px",i.style.height=ce+"px"),this.setViewport(0,0,V,ce)},this.getDrawingBufferSize=function(V){return V.set(B*z,j*z).floor()},this.setDrawingBufferSize=function(V,ce,ye){B=V,j=ce,z=ye,i.width=Math.floor(V*ye),i.height=Math.floor(ce*ye),this.setViewport(0,0,V,ce)},this.getCurrentViewport=function(V){return V.copy(E)},this.getViewport=function(V){return V.copy(k)},this.setViewport=function(V,ce,ye,pe){V.isVector4?k.set(V.x,V.y,V.z,V.w):k.set(V,ce,ye,pe),Ne.viewport(E.copy(k).multiplyScalar(z).floor())},this.getScissor=function(V){return V.copy(N)},this.setScissor=function(V,ce,ye,pe){V.isVector4?N.set(V.x,V.y,V.z,V.w):N.set(V,ce,ye,pe),Ne.scissor(P.copy(N).multiplyScalar(z).floor())},this.getScissorTest=function(){return F},this.setScissorTest=function(V){Ne.setScissorTest(F=V)},this.setOpaqueSort=function(V){O=V},this.setTransparentSort=function(V){H=V},this.getClearColor=function(V){return V.copy(oe.getClearColor())},this.setClearColor=function(){oe.setClearColor.apply(oe,arguments)},this.getClearAlpha=function(){return oe.getClearAlpha()},this.setClearAlpha=function(){oe.setClearAlpha.apply(oe,arguments)},this.clear=function(V=!0,ce=!0,ye=!0){let pe=0;if(V){let _e=!1;if(M!==null){const Ve=M.texture.format;_e=Ve===Kz||Ve===Qz||Ve===Zz}if(_e){const Ve=M.texture.type,tt=Ve===Mc||Ve===rc||Ve===JA||Ve===Oh||Ve===qz||Ve===Yz,st=oe.getClearColor(),lt=oe.getClearAlpha(),wt=st.r,it=st.g,Ze=st.b;tt?(p[0]=wt,p[1]=it,p[2]=Ze,p[3]=lt,X.clearBufferuiv(X.COLOR,0,p)):(f[0]=wt,f[1]=it,f[2]=Ze,f[3]=lt,X.clearBufferiv(X.COLOR,0,f))}else pe|=X.COLOR_BUFFER_BIT}ce&&(pe|=X.DEPTH_BUFFER_BIT),ye&&(pe|=X.STENCIL_BUFFER_BIT),X.clear(pe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){i.removeEventListener("webglcontextlost",ae,!1),i.removeEventListener("webglcontextrestored",J,!1),i.removeEventListener("webglcontextcreationerror",ge,!1),ue.dispose(),we.dispose(),Pe.dispose(),je.dispose(),qe.dispose(),R.dispose(),Ue.dispose(),$e.dispose(),$.dispose(),U.dispose(),U.removeEventListener("sessionstart",vt),U.removeEventListener("sessionend",Hi),W&&(W.dispose(),W=null),ei.stop()};function ae(V){V.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),_=!0}function J(){console.log("THREE.WebGLRenderer: Context Restored."),_=!1;const V=He.autoReset,ce=ne.enabled,ye=ne.autoUpdate,pe=ne.needsUpdate,_e=ne.type;at(),He.autoReset=V,ne.enabled=ce,ne.autoUpdate=ye,ne.needsUpdate=pe,ne.type=_e}function ge(V){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",V.statusMessage)}function Te(V){const ce=V.target;ce.removeEventListener("dispose",Te),Qe(ce)}function Qe(V){_t(V),Pe.remove(V)}function _t(V){const ce=Pe.get(V).programs;ce!==void 0&&(ce.forEach(function(ye){$.releaseProgram(ye)}),V.isShaderMaterial&&$.releaseShaderCache(V))}this.renderBufferDirect=function(V,ce,ye,pe,_e,Ve){ce===null&&(ce=de);const tt=_e.isMesh&&_e.matrixWorld.determinant()<0,st=xe(V,ce,ye,pe,_e);Ne.setMaterial(pe,tt);let lt=ye.index,wt=1;if(pe.wireframe===!0){if(lt=A.getWireframeAttribute(ye),lt===void 0)return;wt=2}const it=ye.drawRange,Ze=ye.attributes.position;let li=it.start*wt,pi=(it.start+it.count)*wt;Ve!==null&&(li=Math.max(li,Ve.start*wt),pi=Math.min(pi,(Ve.start+Ve.count)*wt)),lt!==null?(li=Math.max(li,0),pi=Math.min(pi,lt.count)):Ze!=null&&(li=Math.max(li,0),pi=Math.min(pi,Ze.count));const Gi=pi-li;if(Gi<0||Gi===1/0)return;Ue.setup(_e,pe,st,ye,lt);let ds,ci=me;if(lt!==null&&(ds=q.get(lt),ci=Le,ci.setIndex(ds)),_e.isMesh)pe.wireframe===!0?(Ne.setLineWidth(pe.wireframeLinewidth*he()),ci.setMode(X.LINES)):ci.setMode(X.TRIANGLES);else if(_e.isLine){let Rt=pe.linewidth;Rt===void 0&&(Rt=1),Ne.setLineWidth(Rt*he()),_e.isLineSegments?ci.setMode(X.LINES):_e.isLineLoop?ci.setMode(X.LINE_LOOP):ci.setMode(X.LINE_STRIP)}else _e.isPoints?ci.setMode(X.POINTS):_e.isSprite&&ci.setMode(X.TRIANGLES);if(_e.isInstancedMesh)ci.renderInstances(li,Gi,_e.count);else if(ye.isInstancedBufferGeometry){const Rt=ye._maxInstanceCount!==void 0?ye._maxInstanceCount:1/0,Ii=Math.min(ye.instanceCount,Rt);ci.renderInstances(li,Gi,Ii)}else ci.render(li,Gi)},this.compile=function(V,ce){function ye(pe,_e,Ve){pe.transparent===!0&&pe.side===Ya&&pe.forceSinglePass===!1?(pe.side=Br,pe.needsUpdate=!0,be(pe,_e,Ve),pe.side=Rc,pe.needsUpdate=!0,be(pe,_e,Ve),pe.side=Ya):be(pe,_e,Ve)}m=we.get(V),m.init(),y.push(m),V.traverseVisible(function(pe){pe.isLight&&pe.layers.test(ce.layers)&&(m.pushLight(pe),pe.castShadow&&m.pushShadow(pe))}),m.setupLights(x._useLegacyLights),V.traverse(function(pe){const _e=pe.material;if(_e)if(Array.isArray(_e))for(let Ve=0;Ve<_e.length;Ve++){const tt=_e[Ve];ye(tt,V,pe)}else ye(_e,V,pe)}),y.pop(),m=null};let Tt=null;function Ri(V){Tt&&Tt(V)}function vt(){ei.stop()}function Hi(){ei.start()}const ei=new uk;ei.setAnimationLoop(Ri),typeof self<"u"&&ei.setContext(self),this.setAnimationLoop=function(V){Tt=V,U.setAnimationLoop(V),V===null?ei.stop():ei.start()},U.addEventListener("sessionstart",vt),U.addEventListener("sessionend",Hi),this.render=function(V,ce){if(ce!==void 0&&ce.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(_===!0)return;V.matrixWorldAutoUpdate===!0&&V.updateMatrixWorld(),ce.parent===null&&ce.matrixWorldAutoUpdate===!0&&ce.updateMatrixWorld(),U.enabled===!0&&U.isPresenting===!0&&(U.cameraAutoUpdate===!0&&U.updateCamera(ce),ce=U.getCamera()),V.isScene===!0&&V.onBeforeRender(x,V,ce,M),m=we.get(V,y.length),m.init(),y.push(m),se.multiplyMatrices(ce.projectionMatrix,ce.matrixWorldInverse),Q.setFromProjectionMatrix(se),K=this.localClippingEnabled,G=De.init(this.clippingPlanes,K),v=ue.get(V,g.length),v.init(),g.push(v),hf(V,ce,0,x.sortObjects),v.finish(),x.sortObjects===!0&&v.sort(O,H),this.info.render.frame++,G===!0&&De.beginShadows();const ye=m.state.shadowsArray;if(ne.render(ye,V,ce),G===!0&&De.endShadows(),this.info.autoReset===!0&&this.info.reset(),oe.render(v,V),m.setupLights(x._useLegacyLights),ce.isArrayCamera){const pe=ce.cameras;for(let _e=0,Ve=pe.length;_e<Ve;_e++){const tt=pe[_e];gg(v,V,tt,tt.viewport)}}else gg(v,V,ce);M!==null&&(Ce.updateMultisampleRenderTarget(M),Ce.updateRenderTargetMipmap(M)),V.isScene===!0&&V.onAfterRender(x,V,ce),Ue.resetDefaultState(),S=-1,C=null,y.pop(),y.length>0?m=y[y.length-1]:m=null,g.pop(),g.length>0?v=g[g.length-1]:v=null};function hf(V,ce,ye,pe){if(V.visible===!1)return;if(V.layers.test(ce.layers)){if(V.isGroup)ye=V.renderOrder;else if(V.isLOD)V.autoUpdate===!0&&V.update(ce);else if(V.isLight)m.pushLight(V),V.castShadow&&m.pushShadow(V);else if(V.isSprite){if(!V.frustumCulled||Q.intersectsSprite(V)){pe&&re.setFromMatrixPosition(V.matrixWorld).applyMatrix4(se);const tt=R.update(V),st=V.material;st.visible&&v.push(V,tt,st,ye,re.z,null)}}else if((V.isMesh||V.isLine||V.isPoints)&&(!V.frustumCulled||Q.intersectsObject(V))){const tt=R.update(V),st=V.material;if(pe&&(V.boundingSphere!==void 0?(V.boundingSphere===null&&V.computeBoundingSphere(),re.copy(V.boundingSphere.center)):(tt.boundingSphere===null&&tt.computeBoundingSphere(),re.copy(tt.boundingSphere.center)),re.applyMatrix4(V.matrixWorld).applyMatrix4(se)),Array.isArray(st)){const lt=tt.groups;for(let wt=0,it=lt.length;wt<it;wt++){const Ze=lt[wt],li=st[Ze.materialIndex];li&&li.visible&&v.push(V,tt,li,ye,re.z,Ze)}}else st.visible&&v.push(V,tt,st,ye,re.z,null)}}const Ve=V.children;for(let tt=0,st=Ve.length;tt<st;tt++)hf(Ve[tt],ce,ye,pe)}function gg(V,ce,ye,pe){const _e=V.opaque,Ve=V.transmissive,tt=V.transparent;m.setupLightsView(ye),G===!0&&De.setGlobalState(x.clippingPlanes,ye),Ve.length>0&&O2(_e,Ve,ce,ye),pe&&Ne.viewport(E.copy(pe)),_e.length>0&&cu(_e,ce,ye),Ve.length>0&&cu(Ve,ce,ye),tt.length>0&&cu(tt,ce,ye),Ne.buffers.depth.setTest(!0),Ne.buffers.depth.setMask(!0),Ne.buffers.color.setMask(!0),Ne.setPolygonOffset(!1)}function O2(V,ce,ye,pe){const _e=Me.isWebGL2;W===null&&(W=new Qh(1,1,{generateMipmaps:!0,type:Oe.has("EXT_color_buffer_half_float")?V0:Mc,minFilter:k0,samples:_e?4:0})),x.getDrawingBufferSize(ie),_e?W.setSize(ie.x,ie.y):W.setSize(Cx(ie.x),Cx(ie.y));const Ve=x.getRenderTarget();x.setRenderTarget(W),x.getClearColor(D),L=x.getClearAlpha(),L<1&&x.setClearColor(16777215,.5),x.clear();const tt=x.toneMapping;x.toneMapping=Sc,cu(V,ye,pe),Ce.updateMultisampleRenderTarget(W),Ce.updateRenderTargetMipmap(W);let st=!1;for(let lt=0,wt=ce.length;lt<wt;lt++){const it=ce[lt],Ze=it.object,li=it.geometry,pi=it.material,Gi=it.group;if(pi.side===Ya&&Ze.layers.test(pe.layers)){const ds=pi.side;pi.side=Br,pi.needsUpdate=!0,Z(Ze,ye,pe,li,pi,Gi),pi.side=ds,pi.needsUpdate=!0,st=!0}}st===!0&&(Ce.updateMultisampleRenderTarget(W),Ce.updateRenderTargetMipmap(W)),x.setRenderTarget(Ve),x.setClearColor(D,L),x.toneMapping=tt}function cu(V,ce,ye){const pe=ce.isScene===!0?ce.overrideMaterial:null;for(let _e=0,Ve=V.length;_e<Ve;_e++){const tt=V[_e],st=tt.object,lt=tt.geometry,wt=pe===null?tt.material:pe,it=tt.group;st.layers.test(ye.layers)&&Z(st,ce,ye,lt,wt,it)}}function Z(V,ce,ye,pe,_e,Ve){V.onBeforeRender(x,ce,ye,pe,_e,Ve),V.modelViewMatrix.multiplyMatrices(ye.matrixWorldInverse,V.matrixWorld),V.normalMatrix.getNormalMatrix(V.modelViewMatrix),_e.onBeforeRender(x,ce,ye,pe,V,Ve),_e.transparent===!0&&_e.side===Ya&&_e.forceSinglePass===!1?(_e.side=Br,_e.needsUpdate=!0,x.renderBufferDirect(ye,ce,pe,_e,V,Ve),_e.side=Rc,_e.needsUpdate=!0,x.renderBufferDirect(ye,ce,pe,_e,V,Ve),_e.side=Ya):x.renderBufferDirect(ye,ce,pe,_e,V,Ve),V.onAfterRender(x,ce,ye,pe,_e,Ve)}function be(V,ce,ye){ce.isScene!==!0&&(ce=de);const pe=Pe.get(V),_e=m.state.lights,Ve=m.state.shadowsArray,tt=_e.state.version,st=$.getParameters(V,_e.state,Ve,ce,ye),lt=$.getProgramCacheKey(st);let wt=pe.programs;pe.environment=V.isMeshStandardMaterial?ce.environment:null,pe.fog=ce.fog,pe.envMap=(V.isMeshStandardMaterial?qe:je).get(V.envMap||pe.environment),wt===void 0&&(V.addEventListener("dispose",Te),wt=new Map,pe.programs=wt);let it=wt.get(lt);if(it!==void 0){if(pe.currentProgram===it&&pe.lightsStateVersion===tt)return Re(V,st),it}else st.uniforms=$.getUniforms(V),V.onBuild(ye,st,x),V.onBeforeCompile(st,x),it=$.acquireProgram(st,lt),wt.set(lt,it),pe.uniforms=st.uniforms;const Ze=pe.uniforms;(!V.isShaderMaterial&&!V.isRawShaderMaterial||V.clipping===!0)&&(Ze.clippingPlanes=De.uniform),Re(V,st),pe.needsLights=rt(V),pe.lightsStateVersion=tt,pe.needsLights&&(Ze.ambientLightColor.value=_e.state.ambient,Ze.lightProbe.value=_e.state.probe,Ze.directionalLights.value=_e.state.directional,Ze.directionalLightShadows.value=_e.state.directionalShadow,Ze.spotLights.value=_e.state.spot,Ze.spotLightShadows.value=_e.state.spotShadow,Ze.rectAreaLights.value=_e.state.rectArea,Ze.ltc_1.value=_e.state.rectAreaLTC1,Ze.ltc_2.value=_e.state.rectAreaLTC2,Ze.pointLights.value=_e.state.point,Ze.pointLightShadows.value=_e.state.pointShadow,Ze.hemisphereLights.value=_e.state.hemi,Ze.directionalShadowMap.value=_e.state.directionalShadowMap,Ze.directionalShadowMatrix.value=_e.state.directionalShadowMatrix,Ze.spotShadowMap.value=_e.state.spotShadowMap,Ze.spotLightMatrix.value=_e.state.spotLightMatrix,Ze.spotLightMap.value=_e.state.spotLightMap,Ze.pointShadowMap.value=_e.state.pointShadowMap,Ze.pointShadowMatrix.value=_e.state.pointShadowMatrix);const li=it.getUniforms(),pi=Zv.seqWithValue(li.seq,Ze);return pe.currentProgram=it,pe.uniformsList=pi,it}function Re(V,ce){const ye=Pe.get(V);ye.outputColorSpace=ce.outputColorSpace,ye.instancing=ce.instancing,ye.instancingColor=ce.instancingColor,ye.skinning=ce.skinning,ye.morphTargets=ce.morphTargets,ye.morphNormals=ce.morphNormals,ye.morphColors=ce.morphColors,ye.morphTargetsCount=ce.morphTargetsCount,ye.numClippingPlanes=ce.numClippingPlanes,ye.numIntersection=ce.numClipIntersection,ye.vertexAlphas=ce.vertexAlphas,ye.vertexTangents=ce.vertexTangents,ye.toneMapping=ce.toneMapping}function xe(V,ce,ye,pe,_e){ce.isScene!==!0&&(ce=de),Ce.resetTextureUnits();const Ve=ce.fog,tt=pe.isMeshStandardMaterial?ce.environment:null,st=M===null?x.outputColorSpace:M.isXRRenderTarget===!0?M.texture.colorSpace:lo,lt=(pe.isMeshStandardMaterial?qe:je).get(pe.envMap||tt),wt=pe.vertexColors===!0&&!!ye.attributes.color&&ye.attributes.color.itemSize===4,it=!!ye.attributes.tangent&&(!!pe.normalMap||pe.anisotropy>0),Ze=!!ye.morphAttributes.position,li=!!ye.morphAttributes.normal,pi=!!ye.morphAttributes.color;let Gi=Sc;pe.toneMapped&&(M===null||M.isXRRenderTarget===!0)&&(Gi=x.toneMapping);const ds=ye.morphAttributes.position||ye.morphAttributes.normal||ye.morphAttributes.color,ci=ds!==void 0?ds.length:0,Rt=Pe.get(pe),Ii=m.state.lights;if(G===!0&&(K===!0||V!==C)){const Hr=V===C&&pe.id===S;De.setState(pe,V,Hr)}let ti=!1;pe.version===Rt.__version?(Rt.needsLights&&Rt.lightsStateVersion!==Ii.state.version||Rt.outputColorSpace!==st||_e.isInstancedMesh&&Rt.instancing===!1||!_e.isInstancedMesh&&Rt.instancing===!0||_e.isSkinnedMesh&&Rt.skinning===!1||!_e.isSkinnedMesh&&Rt.skinning===!0||_e.isInstancedMesh&&Rt.instancingColor===!0&&_e.instanceColor===null||_e.isInstancedMesh&&Rt.instancingColor===!1&&_e.instanceColor!==null||Rt.envMap!==lt||pe.fog===!0&&Rt.fog!==Ve||Rt.numClippingPlanes!==void 0&&(Rt.numClippingPlanes!==De.numPlanes||Rt.numIntersection!==De.numIntersection)||Rt.vertexAlphas!==wt||Rt.vertexTangents!==it||Rt.morphTargets!==Ze||Rt.morphNormals!==li||Rt.morphColors!==pi||Rt.toneMapping!==Gi||Me.isWebGL2===!0&&Rt.morphTargetsCount!==ci)&&(ti=!0):(ti=!0,Rt.__version=pe.version);let zs=Rt.currentProgram;ti===!0&&(zs=be(pe,ce,_e));let On=!1,fo=!1,uf=!1;const mn=zs.getUniforms(),kc=Rt.uniforms;if(Ne.useProgram(zs.program)&&(On=!0,fo=!0,uf=!0),pe.id!==S&&(S=pe.id,fo=!0),On||C!==V){mn.setValue(X,"projectionMatrix",V.projectionMatrix),mn.setValue(X,"viewMatrix",V.matrixWorldInverse);const Hr=mn.map.cameraPosition;Hr!==void 0&&Hr.setValue(X,re.setFromMatrixPosition(V.matrixWorld)),Me.logarithmicDepthBuffer&&mn.setValue(X,"logDepthBufFC",2/(Math.log(V.far+1)/Math.LN2)),(pe.isMeshPhongMaterial||pe.isMeshToonMaterial||pe.isMeshLambertMaterial||pe.isMeshBasicMaterial||pe.isMeshStandardMaterial||pe.isShaderMaterial)&&mn.setValue(X,"isOrthographic",V.isOrthographicCamera===!0),C!==V&&(C=V,fo=!0,uf=!0)}if(_e.isSkinnedMesh){mn.setOptional(X,_e,"bindMatrix"),mn.setOptional(X,_e,"bindMatrixInverse");const Hr=_e.skeleton;Hr&&(Me.floatVertexTextures?(Hr.boneTexture===null&&Hr.computeBoneTexture(),mn.setValue(X,"boneTexture",Hr.boneTexture,Ce),mn.setValue(X,"boneTextureSize",Hr.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const B2=ye.morphAttributes;if((B2.position!==void 0||B2.normal!==void 0||B2.color!==void 0&&Me.isWebGL2===!0)&&Y.update(_e,ye,zs),(fo||Rt.receiveShadow!==_e.receiveShadow)&&(Rt.receiveShadow=_e.receiveShadow,mn.setValue(X,"receiveShadow",_e.receiveShadow)),pe.isMeshGouraudMaterial&&pe.envMap!==null&&(kc.envMap.value=lt,kc.flipEnvMap.value=lt.isCubeTexture&&lt.isRenderTargetTexture===!1?-1:1),fo&&(mn.setValue(X,"toneMappingExposure",x.toneMappingExposure),Rt.needsLights&&Ie(kc,uf),Ve&&pe.fog===!0&&le.refreshFogUniforms(kc,Ve),le.refreshMaterialUniforms(kc,pe,z,j,W),Zv.upload(X,Rt.uniformsList,kc,Ce)),pe.isShaderMaterial&&pe.uniformsNeedUpdate===!0&&(Zv.upload(X,Rt.uniformsList,kc,Ce),pe.uniformsNeedUpdate=!1),pe.isSpriteMaterial&&mn.setValue(X,"center",_e.center),mn.setValue(X,"modelViewMatrix",_e.modelViewMatrix),mn.setValue(X,"normalMatrix",_e.normalMatrix),mn.setValue(X,"modelMatrix",_e.matrixWorld),pe.isShaderMaterial||pe.isRawShaderMaterial){const Hr=pe.uniformsGroups;for(let N2=0,xk=Hr.length;N2<xk;N2++)if(Me.isWebGL2){const o4=Hr[N2];$e.update(o4,zs),$e.bind(o4,zs)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return zs}function Ie(V,ce){V.ambientLightColor.needsUpdate=ce,V.lightProbe.needsUpdate=ce,V.directionalLights.needsUpdate=ce,V.directionalLightShadows.needsUpdate=ce,V.pointLights.needsUpdate=ce,V.pointLightShadows.needsUpdate=ce,V.spotLights.needsUpdate=ce,V.spotLightShadows.needsUpdate=ce,V.rectAreaLights.needsUpdate=ce,V.hemisphereLights.needsUpdate=ce}function rt(V){return V.isMeshLambertMaterial||V.isMeshToonMaterial||V.isMeshPhongMaterial||V.isMeshStandardMaterial||V.isShadowMaterial||V.isShaderMaterial&&V.lights===!0}this.getActiveCubeFace=function(){return b},this.getActiveMipmapLevel=function(){return w},this.getRenderTarget=function(){return M},this.setRenderTargetTextures=function(V,ce,ye){Pe.get(V.texture).__webglTexture=ce,Pe.get(V.depthTexture).__webglTexture=ye;const pe=Pe.get(V);pe.__hasExternalTextures=!0,pe.__hasExternalTextures&&(pe.__autoAllocateDepthBuffer=ye===void 0,pe.__autoAllocateDepthBuffer||Oe.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),pe.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(V,ce){const ye=Pe.get(V);ye.__webglFramebuffer=ce,ye.__useDefaultFramebuffer=ce===void 0},this.setRenderTarget=function(V,ce=0,ye=0){M=V,b=ce,w=ye;let pe=!0,_e=null,Ve=!1,tt=!1;if(V){const lt=Pe.get(V);lt.__useDefaultFramebuffer!==void 0?(Ne.bindFramebuffer(X.FRAMEBUFFER,null),pe=!1):lt.__webglFramebuffer===void 0?Ce.setupRenderTarget(V):lt.__hasExternalTextures&&Ce.rebindTextures(V,Pe.get(V.texture).__webglTexture,Pe.get(V.depthTexture).__webglTexture);const wt=V.texture;(wt.isData3DTexture||wt.isDataArrayTexture||wt.isCompressedArrayTexture)&&(tt=!0);const it=Pe.get(V).__webglFramebuffer;V.isWebGLCubeRenderTarget?(Array.isArray(it[ce])?_e=it[ce][ye]:_e=it[ce],Ve=!0):Me.isWebGL2&&V.samples>0&&Ce.useMultisampledRTT(V)===!1?_e=Pe.get(V).__webglMultisampledFramebuffer:Array.isArray(it)?_e=it[ye]:_e=it,E.copy(V.viewport),P.copy(V.scissor),I=V.scissorTest}else E.copy(k).multiplyScalar(z).floor(),P.copy(N).multiplyScalar(z).floor(),I=F;if(Ne.bindFramebuffer(X.FRAMEBUFFER,_e)&&Me.drawBuffers&&pe&&Ne.drawBuffers(V,_e),Ne.viewport(E),Ne.scissor(P),Ne.setScissorTest(I),Ve){const lt=Pe.get(V.texture);X.framebufferTexture2D(X.FRAMEBUFFER,X.COLOR_ATTACHMENT0,X.TEXTURE_CUBE_MAP_POSITIVE_X+ce,lt.__webglTexture,ye)}else if(tt){const lt=Pe.get(V.texture),wt=ce||0;X.framebufferTextureLayer(X.FRAMEBUFFER,X.COLOR_ATTACHMENT0,lt.__webglTexture,ye||0,wt)}S=-1},this.readRenderTargetPixels=function(V,ce,ye,pe,_e,Ve,tt){if(!(V&&V.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let st=Pe.get(V).__webglFramebuffer;if(V.isWebGLCubeRenderTarget&&tt!==void 0&&(st=st[tt]),st){Ne.bindFramebuffer(X.FRAMEBUFFER,st);try{const lt=V.texture,wt=lt.format,it=lt.type;if(wt!==sa&&Ae.convert(wt)!==X.getParameter(X.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Ze=it===V0&&(Oe.has("EXT_color_buffer_half_float")||Me.isWebGL2&&Oe.has("EXT_color_buffer_float"));if(it!==Mc&&Ae.convert(it)!==X.getParameter(X.IMPLEMENTATION_COLOR_READ_TYPE)&&!(it===sc&&(Me.isWebGL2||Oe.has("OES_texture_float")||Oe.has("WEBGL_color_buffer_float")))&&!Ze){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ce>=0&&ce<=V.width-pe&&ye>=0&&ye<=V.height-_e&&X.readPixels(ce,ye,pe,_e,Ae.convert(wt),Ae.convert(it),Ve)}finally{const lt=M!==null?Pe.get(M).__webglFramebuffer:null;Ne.bindFramebuffer(X.FRAMEBUFFER,lt)}}},this.copyFramebufferToTexture=function(V,ce,ye=0){const pe=Math.pow(2,-ye),_e=Math.floor(ce.image.width*pe),Ve=Math.floor(ce.image.height*pe);Ce.setTexture2D(ce,0),X.copyTexSubImage2D(X.TEXTURE_2D,ye,0,0,V.x,V.y,_e,Ve),Ne.unbindTexture()},this.copyTextureToTexture=function(V,ce,ye,pe=0){const _e=ce.image.width,Ve=ce.image.height,tt=Ae.convert(ye.format),st=Ae.convert(ye.type);Ce.setTexture2D(ye,0),X.pixelStorei(X.UNPACK_FLIP_Y_WEBGL,ye.flipY),X.pixelStorei(X.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ye.premultiplyAlpha),X.pixelStorei(X.UNPACK_ALIGNMENT,ye.unpackAlignment),ce.isDataTexture?X.texSubImage2D(X.TEXTURE_2D,pe,V.x,V.y,_e,Ve,tt,st,ce.image.data):ce.isCompressedTexture?X.compressedTexSubImage2D(X.TEXTURE_2D,pe,V.x,V.y,ce.mipmaps[0].width,ce.mipmaps[0].height,tt,ce.mipmaps[0].data):X.texSubImage2D(X.TEXTURE_2D,pe,V.x,V.y,tt,st,ce.image),pe===0&&ye.generateMipmaps&&X.generateMipmap(X.TEXTURE_2D),Ne.unbindTexture()},this.copyTextureToTexture3D=function(V,ce,ye,pe,_e=0){if(x.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Ve=V.max.x-V.min.x+1,tt=V.max.y-V.min.y+1,st=V.max.z-V.min.z+1,lt=Ae.convert(pe.format),wt=Ae.convert(pe.type);let it;if(pe.isData3DTexture)Ce.setTexture3D(pe,0),it=X.TEXTURE_3D;else if(pe.isDataArrayTexture)Ce.setTexture2DArray(pe,0),it=X.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}X.pixelStorei(X.UNPACK_FLIP_Y_WEBGL,pe.flipY),X.pixelStorei(X.UNPACK_PREMULTIPLY_ALPHA_WEBGL,pe.premultiplyAlpha),X.pixelStorei(X.UNPACK_ALIGNMENT,pe.unpackAlignment);const Ze=X.getParameter(X.UNPACK_ROW_LENGTH),li=X.getParameter(X.UNPACK_IMAGE_HEIGHT),pi=X.getParameter(X.UNPACK_SKIP_PIXELS),Gi=X.getParameter(X.UNPACK_SKIP_ROWS),ds=X.getParameter(X.UNPACK_SKIP_IMAGES),ci=ye.isCompressedTexture?ye.mipmaps[0]:ye.image;X.pixelStorei(X.UNPACK_ROW_LENGTH,ci.width),X.pixelStorei(X.UNPACK_IMAGE_HEIGHT,ci.height),X.pixelStorei(X.UNPACK_SKIP_PIXELS,V.min.x),X.pixelStorei(X.UNPACK_SKIP_ROWS,V.min.y),X.pixelStorei(X.UNPACK_SKIP_IMAGES,V.min.z),ye.isDataTexture||ye.isData3DTexture?X.texSubImage3D(it,_e,ce.x,ce.y,ce.z,Ve,tt,st,lt,wt,ci.data):ye.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),X.compressedTexSubImage3D(it,_e,ce.x,ce.y,ce.z,Ve,tt,st,lt,ci.data)):X.texSubImage3D(it,_e,ce.x,ce.y,ce.z,Ve,tt,st,lt,wt,ci),X.pixelStorei(X.UNPACK_ROW_LENGTH,Ze),X.pixelStorei(X.UNPACK_IMAGE_HEIGHT,li),X.pixelStorei(X.UNPACK_SKIP_PIXELS,pi),X.pixelStorei(X.UNPACK_SKIP_ROWS,Gi),X.pixelStorei(X.UNPACK_SKIP_IMAGES,ds),_e===0&&pe.generateMipmaps&&X.generateMipmap(it),Ne.unbindTexture()},this.initTexture=function(V){V.isCubeTexture?Ce.setTextureCube(V,0):V.isData3DTexture?Ce.setTexture3D(V,0):V.isDataArrayTexture||V.isCompressedArrayTexture?Ce.setTexture2DArray(V,0):Ce.setTexture2D(V,0),Ne.unbindTexture()},this.resetState=function(){b=0,w=0,M=null,Ne.reset(),Ue.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ko}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(t){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!t}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===gi?Nh:$z}set outputEncoding(t){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=t===Nh?gi:lo}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(t){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=t}}class UMe extends gk{}UMe.prototype.isWebGL1Renderer=!0;class FMe extends mr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,i){return super.copy(t,i),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const i=super.toJSON(t);return this.fog!==null&&(i.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(i.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(i.object.backgroundIntensity=this.backgroundIntensity),i}}class a4 extends ml{constructor(t=.5,i=1,n=32,r=1,s=0,a=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:i,thetaSegments:n,phiSegments:r,thetaStart:s,thetaLength:a},n=Math.max(3,n),r=Math.max(1,r);const o=[],l=[],c=[],u=[];let h=t;const d=(i-t)/r,p=new fe,f=new Pt;for(let v=0;v<=r;v++){for(let m=0;m<=n;m++){const g=s+m/n*a;p.x=h*Math.cos(g),p.y=h*Math.sin(g),l.push(p.x,p.y,p.z),c.push(0,0,1),f.x=(p.x/i+1)/2,f.y=(p.y/i+1)/2,u.push(f.x,f.y)}h+=d}for(let v=0;v<r;v++){const m=v*(n+1);for(let g=0;g<n;g++){const y=g+m,x=y,_=y+n+1,b=y+n+2,w=y+1;o.push(x,_,w),o.push(_,b,w)}}this.setIndex(o),this.setAttribute("position",new ss(l,3)),this.setAttribute("normal",new ss(c,3)),this.setAttribute("uv",new ss(u,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new a4(t.innerRadius,t.outerRadius,t.thetaSegments,t.phiSegments,t.thetaStart,t.thetaLength)}}class Ax extends ml{constructor(t=1,i=32,n=16,r=0,s=Math.PI*2,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:i,heightSegments:n,phiStart:r,phiLength:s,thetaStart:a,thetaLength:o},i=Math.max(3,Math.floor(i)),n=Math.max(2,Math.floor(n));const l=Math.min(a+o,Math.PI);let c=0;const u=[],h=new fe,d=new fe,p=[],f=[],v=[],m=[];for(let g=0;g<=n;g++){const y=[],x=g/n;let _=0;g===0&&a===0?_=.5/i:g===n&&l===Math.PI&&(_=-.5/i);for(let b=0;b<=i;b++){const w=b/i;h.x=-t*Math.cos(r+w*s)*Math.sin(a+x*o),h.y=t*Math.cos(a+x*o),h.z=t*Math.sin(r+w*s)*Math.sin(a+x*o),f.push(h.x,h.y,h.z),d.copy(h).normalize(),v.push(d.x,d.y,d.z),m.push(w+_,1-x),y.push(c++)}u.push(y)}for(let g=0;g<n;g++)for(let y=0;y<i;y++){const x=u[g][y+1],_=u[g][y],b=u[g+1][y],w=u[g+1][y+1];(g!==0||a>0)&&p.push(x,_,w),(g!==n-1||l<Math.PI)&&p.push(_,b,w)}this.setIndex(p),this.setAttribute("position",new ss(f,3)),this.setAttribute("normal",new ss(v,3)),this.setAttribute("uv",new ss(m,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new Ax(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class zMe extends fg{constructor(t){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ri(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ri(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Jz,this.normalScale=new Pt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}const yL={enabled:!1,files:{},add:function(e,t){this.enabled!==!1&&(this.files[e]=t)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class kMe{constructor(t,i,n){const r=this;let s=!1,a=0,o=0,l;const c=[];this.onStart=void 0,this.onLoad=t,this.onProgress=i,this.onError=n,this.itemStart=function(u){o++,s===!1&&r.onStart!==void 0&&r.onStart(u,a,o),s=!0},this.itemEnd=function(u){a++,r.onProgress!==void 0&&r.onProgress(u,a,o),a===o&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(u){r.onError!==void 0&&r.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,h){return c.push(u,h),this},this.removeHandler=function(u){const h=c.indexOf(u);return h!==-1&&c.splice(h,2),this},this.getHandler=function(u){for(let h=0,d=c.length;h<d;h+=2){const p=c[h],f=c[h+1];if(p.global&&(p.lastIndex=0),p.test(u))return f}return null}}}const VMe=new kMe;class I2{constructor(t){this.manager=t!==void 0?t:VMe,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,i){const n=this;return new Promise(function(r,s){n.load(t,r,i,s)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}I2.DEFAULT_MATERIAL_NAME="__DEFAULT";class vk extends I2{constructor(t){super(t)}load(t,i,n,r){this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const s=this,a=yL.get(t);if(a!==void 0)return s.manager.itemStart(t),setTimeout(function(){i&&i(a),s.manager.itemEnd(t)},0),a;const o=G0("img");function l(){u(),yL.add(t,this),i&&i(this),s.manager.itemEnd(t)}function c(h){u(),r&&r(h),s.manager.itemError(t),s.manager.itemEnd(t)}function u(){o.removeEventListener("load",l,!1),o.removeEventListener("error",c,!1)}return o.addEventListener("load",l,!1),o.addEventListener("error",c,!1),t.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),s.manager.itemStart(t),o.src=t,o}}class HMe extends I2{constructor(t){super(t)}load(t,i,n,r){const s=new i4;s.colorSpace=gi;const a=new vk(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let o=0;function l(c){a.load(t[c],function(u){s.images[c]=u,o++,o===6&&(s.needsUpdate=!0,i&&i(s))},void 0,r)}for(let c=0;c<t.length;++c)l(c);return s}}class GMe extends I2{constructor(t){super(t)}load(t,i,n,r){const s=new Nr,a=new vk(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(t,function(o){s.image=o,s.needsUpdate=!0,i!==void 0&&i(s)},n,r),s}}class yk extends mr{constructor(t,i=1){super(),this.isLight=!0,this.type="Light",this.color=new ri(t),this.intensity=i}dispose(){}copy(t,i){return super.copy(t,i),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const i=super.toJSON(t);return i.object.color=this.color.getHex(),i.object.intensity=this.intensity,this.groundColor!==void 0&&(i.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(i.object.distance=this.distance),this.angle!==void 0&&(i.object.angle=this.angle),this.decay!==void 0&&(i.object.decay=this.decay),this.penumbra!==void 0&&(i.object.penumbra=this.penumbra),this.shadow!==void 0&&(i.object.shadow=this.shadow.toJSON()),i}}const Gw=new Ki,xL=new fe,_L=new fe;class jMe{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Pt(512,512),this.map=null,this.mapPass=null,this.matrix=new Ki,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new n4,this._frameExtents=new Pt(1,1),this._viewportCount=1,this._viewports=[new xi(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const i=this.camera,n=this.matrix;xL.setFromMatrixPosition(t.matrixWorld),i.position.copy(xL),_L.setFromMatrixPosition(t.target.matrixWorld),i.lookAt(_L),i.updateMatrixWorld(),Gw.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Gw),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(Gw)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const t={};return this.bias!==0&&(t.bias=this.bias),this.normalBias!==0&&(t.normalBias=this.normalBias),this.radius!==1&&(t.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}const bL=new Ki,rm=new fe,jw=new fe;class WMe extends jMe{constructor(){super(new Kr(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Pt(4,2),this._viewportCount=6,this._viewports=[new xi(2,1,1,1),new xi(0,1,1,1),new xi(3,1,1,1),new xi(1,1,1,1),new xi(3,0,1,1),new xi(1,0,1,1)],this._cubeDirections=[new fe(1,0,0),new fe(-1,0,0),new fe(0,0,1),new fe(0,0,-1),new fe(0,1,0),new fe(0,-1,0)],this._cubeUps=[new fe(0,1,0),new fe(0,1,0),new fe(0,1,0),new fe(0,1,0),new fe(0,0,1),new fe(0,0,-1)]}updateMatrices(t,i=0){const n=this.camera,r=this.matrix,s=t.distance||n.far;s!==n.far&&(n.far=s,n.updateProjectionMatrix()),rm.setFromMatrixPosition(t.matrixWorld),n.position.copy(rm),jw.copy(n.position),jw.add(this._cubeDirections[i]),n.up.copy(this._cubeUps[i]),n.lookAt(jw),n.updateMatrixWorld(),r.makeTranslation(-rm.x,-rm.y,-rm.z),bL.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(bL)}}class wL extends yk{constructor(t,i,n=0,r=2){super(t,i),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new WMe}get power(){return this.intensity*4*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t,i){return super.copy(t,i),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}class XMe extends yk{constructor(t,i){super(t,i),this.isAmbientLight=!0,this.type="AmbientLight"}}class SL{constructor(t=1,i=0,n=0){return this.radius=t,this.phi=i,this.theta=n,this}set(t,i,n){return this.radius=t,this.phi=i,this.theta=n,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,i,n){return this.radius=Math.sqrt(t*t+i*i+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,n),this.phi=Math.acos(Hn(i/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:$A}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=$A);const ML={type:"change"},Ww={type:"start"},CL={type:"end"},bv=new rk,EL=new Vl,qMe=Math.cos(70*A_e.DEG2RAD);class YMe extends lu{constructor(t,i){super(),this.object=t,this.domElement=i,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new fe,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Hu.ROTATE,MIDDLE:Hu.DOLLY,RIGHT:Hu.PAN},this.touches={ONE:Gu.ROTATE,TWO:Gu.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return o.phi},this.getAzimuthalAngle=function(){return o.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(Y){Y.addEventListener("keydown",R),this._domElementKeyEvents=Y},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",R),this._domElementKeyEvents=null},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(ML),n.update(),s=r.NONE},this.update=function(){const Y=new fe,me=new Kh().setFromUnitVectors(t.up,new fe(0,1,0)),Le=me.clone().invert(),Ae=new fe,Ue=new Kh,$e=new fe,at=2*Math.PI;return function(ae=null){const J=n.object.position;Y.copy(J).sub(n.target),Y.applyQuaternion(me),o.setFromVector3(Y),n.autoRotate&&s===r.NONE&&P(C(ae)),n.enableDamping?(o.theta+=l.theta*n.dampingFactor,o.phi+=l.phi*n.dampingFactor):(o.theta+=l.theta,o.phi+=l.phi);let ge=n.minAzimuthAngle,Te=n.maxAzimuthAngle;isFinite(ge)&&isFinite(Te)&&(ge<-Math.PI?ge+=at:ge>Math.PI&&(ge-=at),Te<-Math.PI?Te+=at:Te>Math.PI&&(Te-=at),ge<=Te?o.theta=Math.max(ge,Math.min(Te,o.theta)):o.theta=o.theta>(ge+Te)/2?Math.max(ge,o.theta):Math.min(Te,o.theta)),o.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,o.phi)),o.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(u,n.dampingFactor):n.target.add(u),n.zoomToCursor&&w||n.object.isOrthographicCamera?o.radius=H(o.radius):o.radius=H(o.radius*c),Y.setFromSpherical(o),Y.applyQuaternion(Le),J.copy(n.target).add(Y),n.object.lookAt(n.target),n.enableDamping===!0?(l.theta*=1-n.dampingFactor,l.phi*=1-n.dampingFactor,u.multiplyScalar(1-n.dampingFactor)):(l.set(0,0,0),u.set(0,0,0));let Qe=!1;if(n.zoomToCursor&&w){let _t=null;if(n.object.isPerspectiveCamera){const Tt=Y.length();_t=H(Tt*c);const Ri=Tt-_t;n.object.position.addScaledVector(_,Ri),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const Tt=new fe(b.x,b.y,0);Tt.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/c)),n.object.updateProjectionMatrix(),Qe=!0;const Ri=new fe(b.x,b.y,0);Ri.unproject(n.object),n.object.position.sub(Ri).add(Tt),n.object.updateMatrixWorld(),_t=Y.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;_t!==null&&(this.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(_t).add(n.object.position):(bv.origin.copy(n.object.position),bv.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(bv.direction))<qMe?t.lookAt(n.target):(EL.setFromNormalAndCoplanarPoint(n.object.up,n.target),bv.intersectPlane(EL,n.target))))}else n.object.isOrthographicCamera&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/c)),n.object.updateProjectionMatrix(),Qe=!0);return c=1,w=!1,Qe||Ae.distanceToSquared(n.object.position)>a||8*(1-Ue.dot(n.object.quaternion))>a||$e.distanceToSquared(n.target)>0?(n.dispatchEvent(ML),Ae.copy(n.object.position),Ue.copy(n.object.quaternion),$e.copy(n.target),Qe=!1,!0):!1}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",ue),n.domElement.removeEventListener("pointerdown",Pe),n.domElement.removeEventListener("pointercancel",je),n.domElement.removeEventListener("wheel",A),n.domElement.removeEventListener("pointermove",Ce),n.domElement.removeEventListener("pointerup",je),n._domElementKeyEvents!==null&&(n._domElementKeyEvents.removeEventListener("keydown",R),n._domElementKeyEvents=null)};const n=this,r={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=r.NONE;const a=1e-6,o=new SL,l=new SL;let c=1;const u=new fe,h=new Pt,d=new Pt,p=new Pt,f=new Pt,v=new Pt,m=new Pt,g=new Pt,y=new Pt,x=new Pt,_=new fe,b=new Pt;let w=!1;const M=[],S={};function C(Y){return Y!==null?2*Math.PI/60*n.autoRotateSpeed*Y:2*Math.PI/60/60*n.autoRotateSpeed}function E(){return Math.pow(.95,n.zoomSpeed)}function P(Y){l.theta-=Y}function I(Y){l.phi-=Y}const D=function(){const Y=new fe;return function(Le,Ae){Y.setFromMatrixColumn(Ae,0),Y.multiplyScalar(-Le),u.add(Y)}}(),L=function(){const Y=new fe;return function(Le,Ae){n.screenSpacePanning===!0?Y.setFromMatrixColumn(Ae,1):(Y.setFromMatrixColumn(Ae,0),Y.crossVectors(n.object.up,Y)),Y.multiplyScalar(Le),u.add(Y)}}(),B=function(){const Y=new fe;return function(Le,Ae){const Ue=n.domElement;if(n.object.isPerspectiveCamera){const $e=n.object.position;Y.copy($e).sub(n.target);let at=Y.length();at*=Math.tan(n.object.fov/2*Math.PI/180),D(2*Le*at/Ue.clientHeight,n.object.matrix),L(2*Ae*at/Ue.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(D(Le*(n.object.right-n.object.left)/n.object.zoom/Ue.clientWidth,n.object.matrix),L(Ae*(n.object.top-n.object.bottom)/n.object.zoom/Ue.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function j(Y){n.object.isPerspectiveCamera||n.object.isOrthographicCamera?c/=Y:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function z(Y){n.object.isPerspectiveCamera||n.object.isOrthographicCamera?c*=Y:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function O(Y){if(!n.zoomToCursor)return;w=!0;const me=n.domElement.getBoundingClientRect(),Le=Y.clientX-me.left,Ae=Y.clientY-me.top,Ue=me.width,$e=me.height;b.x=Le/Ue*2-1,b.y=-(Ae/$e)*2+1,_.set(b.x,b.y,1).unproject(n.object).sub(n.object.position).normalize()}function H(Y){return Math.max(n.minDistance,Math.min(n.maxDistance,Y))}function k(Y){h.set(Y.clientX,Y.clientY)}function N(Y){O(Y),g.set(Y.clientX,Y.clientY)}function F(Y){f.set(Y.clientX,Y.clientY)}function Q(Y){d.set(Y.clientX,Y.clientY),p.subVectors(d,h).multiplyScalar(n.rotateSpeed);const me=n.domElement;P(2*Math.PI*p.x/me.clientHeight),I(2*Math.PI*p.y/me.clientHeight),h.copy(d),n.update()}function G(Y){y.set(Y.clientX,Y.clientY),x.subVectors(y,g),x.y>0?j(E()):x.y<0&&z(E()),g.copy(y),n.update()}function K(Y){v.set(Y.clientX,Y.clientY),m.subVectors(v,f).multiplyScalar(n.panSpeed),B(m.x,m.y),f.copy(v),n.update()}function W(Y){O(Y),Y.deltaY<0?z(E()):Y.deltaY>0&&j(E()),n.update()}function se(Y){let me=!1;switch(Y.code){case n.keys.UP:Y.ctrlKey||Y.metaKey||Y.shiftKey?I(2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):B(0,n.keyPanSpeed),me=!0;break;case n.keys.BOTTOM:Y.ctrlKey||Y.metaKey||Y.shiftKey?I(-2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):B(0,-n.keyPanSpeed),me=!0;break;case n.keys.LEFT:Y.ctrlKey||Y.metaKey||Y.shiftKey?P(2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):B(n.keyPanSpeed,0),me=!0;break;case n.keys.RIGHT:Y.ctrlKey||Y.metaKey||Y.shiftKey?P(-2*Math.PI*n.rotateSpeed/n.domElement.clientHeight):B(-n.keyPanSpeed,0),me=!0;break}me&&(Y.preventDefault(),n.update())}function ie(){if(M.length===1)h.set(M[0].pageX,M[0].pageY);else{const Y=.5*(M[0].pageX+M[1].pageX),me=.5*(M[0].pageY+M[1].pageY);h.set(Y,me)}}function re(){if(M.length===1)f.set(M[0].pageX,M[0].pageY);else{const Y=.5*(M[0].pageX+M[1].pageX),me=.5*(M[0].pageY+M[1].pageY);f.set(Y,me)}}function de(){const Y=M[0].pageX-M[1].pageX,me=M[0].pageY-M[1].pageY,Le=Math.sqrt(Y*Y+me*me);g.set(0,Le)}function he(){n.enableZoom&&de(),n.enablePan&&re()}function X(){n.enableZoom&&de(),n.enableRotate&&ie()}function Ee(Y){if(M.length==1)d.set(Y.pageX,Y.pageY);else{const Le=oe(Y),Ae=.5*(Y.pageX+Le.x),Ue=.5*(Y.pageY+Le.y);d.set(Ae,Ue)}p.subVectors(d,h).multiplyScalar(n.rotateSpeed);const me=n.domElement;P(2*Math.PI*p.x/me.clientHeight),I(2*Math.PI*p.y/me.clientHeight),h.copy(d)}function Oe(Y){if(M.length===1)v.set(Y.pageX,Y.pageY);else{const me=oe(Y),Le=.5*(Y.pageX+me.x),Ae=.5*(Y.pageY+me.y);v.set(Le,Ae)}m.subVectors(v,f).multiplyScalar(n.panSpeed),B(m.x,m.y),f.copy(v)}function Me(Y){const me=oe(Y),Le=Y.pageX-me.x,Ae=Y.pageY-me.y,Ue=Math.sqrt(Le*Le+Ae*Ae);y.set(0,Ue),x.set(0,Math.pow(y.y/g.y,n.zoomSpeed)),j(x.y),g.copy(y)}function Ne(Y){n.enableZoom&&Me(Y),n.enablePan&&Oe(Y)}function He(Y){n.enableZoom&&Me(Y),n.enableRotate&&Ee(Y)}function Pe(Y){n.enabled!==!1&&(M.length===0&&(n.domElement.setPointerCapture(Y.pointerId),n.domElement.addEventListener("pointermove",Ce),n.domElement.addEventListener("pointerup",je)),we(Y),Y.pointerType==="touch"?$(Y):qe(Y))}function Ce(Y){n.enabled!==!1&&(Y.pointerType==="touch"?le(Y):q(Y))}function je(Y){De(Y),M.length===0&&(n.domElement.releasePointerCapture(Y.pointerId),n.domElement.removeEventListener("pointermove",Ce),n.domElement.removeEventListener("pointerup",je)),n.dispatchEvent(CL),s=r.NONE}function qe(Y){let me;switch(Y.button){case 0:me=n.mouseButtons.LEFT;break;case 1:me=n.mouseButtons.MIDDLE;break;case 2:me=n.mouseButtons.RIGHT;break;default:me=-1}switch(me){case Hu.DOLLY:if(n.enableZoom===!1)return;N(Y),s=r.DOLLY;break;case Hu.ROTATE:if(Y.ctrlKey||Y.metaKey||Y.shiftKey){if(n.enablePan===!1)return;F(Y),s=r.PAN}else{if(n.enableRotate===!1)return;k(Y),s=r.ROTATE}break;case Hu.PAN:if(Y.ctrlKey||Y.metaKey||Y.shiftKey){if(n.enableRotate===!1)return;k(Y),s=r.ROTATE}else{if(n.enablePan===!1)return;F(Y),s=r.PAN}break;default:s=r.NONE}s!==r.NONE&&n.dispatchEvent(Ww)}function q(Y){switch(s){case r.ROTATE:if(n.enableRotate===!1)return;Q(Y);break;case r.DOLLY:if(n.enableZoom===!1)return;G(Y);break;case r.PAN:if(n.enablePan===!1)return;K(Y);break}}function A(Y){n.enabled===!1||n.enableZoom===!1||s!==r.NONE||(Y.preventDefault(),n.dispatchEvent(Ww),W(Y),n.dispatchEvent(CL))}function R(Y){n.enabled===!1||n.enablePan===!1||se(Y)}function $(Y){switch(ne(Y),M.length){case 1:switch(n.touches.ONE){case Gu.ROTATE:if(n.enableRotate===!1)return;ie(),s=r.TOUCH_ROTATE;break;case Gu.PAN:if(n.enablePan===!1)return;re(),s=r.TOUCH_PAN;break;default:s=r.NONE}break;case 2:switch(n.touches.TWO){case Gu.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;he(),s=r.TOUCH_DOLLY_PAN;break;case Gu.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;X(),s=r.TOUCH_DOLLY_ROTATE;break;default:s=r.NONE}break;default:s=r.NONE}s!==r.NONE&&n.dispatchEvent(Ww)}function le(Y){switch(ne(Y),s){case r.TOUCH_ROTATE:if(n.enableRotate===!1)return;Ee(Y),n.update();break;case r.TOUCH_PAN:if(n.enablePan===!1)return;Oe(Y),n.update();break;case r.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;Ne(Y),n.update();break;case r.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;He(Y),n.update();break;default:s=r.NONE}}function ue(Y){n.enabled!==!1&&Y.preventDefault()}function we(Y){M.push(Y)}function De(Y){delete S[Y.pointerId];for(let me=0;me<M.length;me++)if(M[me].pointerId==Y.pointerId){M.splice(me,1);return}}function ne(Y){let me=S[Y.pointerId];me===void 0&&(me=new Pt,S[Y.pointerId]=me),me.set(Y.pageX,Y.pageY)}function oe(Y){const me=Y.pointerId===M[0].pointerId?M[1]:M[0];return S[me.pointerId]}n.domElement.addEventListener("contextmenu",ue),n.domElement.addEventListener("pointerdown",Pe),n.domElement.addEventListener("pointercancel",je),n.domElement.addEventListener("wheel",A,{passive:!1}),this.update()}}const ad="/assets/stars-8f5d7c32.jpg",ZMe="/assets/sun-f22b1cfb.jpg",QMe="/assets/mercury-7dcb6a51.jpg",KMe="/assets/venus-11f97521.jpg",$Me="/assets/earth-9a94a536.jpg",JMe="/assets/mars-5dcab1de.jpg",eCe="/assets/jupiter-e166b2a7.jpg",tCe="/assets/saturn-40529949.jpg",iCe="/assets/saturn ring-00207137.png",nCe="/assets/uranus-492a6dc5.jpg",rCe="/assets/uranus ring-ec5fa257.png",sCe="/assets/neptune-c1c9acc0.jpg",aCe="/assets/pluto-fa8407a6.jpg";zp.memo(()=>{const e=ze.useRef(),t=ze.useRef(),i=ze.useRef(),n=ze.useRef();ze.useEffect(()=>{const r=new gk({antialias:!0});r.setSize(window.innerWidth,window.innerHeight),e.current=r,document.body.appendChild(r.domElement);const s=new FMe;t.current=s;const a=new Kr(45,window.innerWidth/window.innerHeight,.1,1e3);i.current=a,a.position.set(-90,140,140);const o=new YMe(a,r.domElement);n.current=o,o.update();const l=new XMe(16777215);s.add(l);const c=new HMe;s.background=c.load([ad,ad,ad,ad,ad,ad]);const u=new GMe,h=new Ax(16,30,30),d=new Ex({map:u.load(ZMe)}),p=new da(h,d);s.add(p);function f(B,j,z,O){const H=new Ax(B,30,30),k=new zMe({map:u.load(j)}),N=new da(H,k),F=new mr;if(F.add(N),O){const Q=new a4(O.innerRadius,O.outerRadius,32),G=new Ex({map:u.load(O.texture),side:Ya}),K=new da(Q,G);F.add(K),K.position.x=z,K.rotation.x=-.5*Math.PI}return s.add(F),N.position.x=z,{mesh:N,obj:F}}const v=f(3.2,QMe,28),m=f(5.8,KMe,44),g=f(6,$Me,62),y=f(4,JMe,78),x=f(12,eCe,100),_=f(10,tCe,138,{innerRadius:10,outerRadius:20,texture:iCe}),b=f(7,nCe,176,{innerRadius:7,outerRadius:12,texture:rCe}),w=f(7,sCe,200),M=f(2.8,aCe,216),S=new wL(16777215,2,300);s.add(S);const C=new wL(16777215,1,300),E=p.position;C.position.copy(E),s.add(C);function P(){p.rotateY(.004),v.mesh.rotateY(.004),m.mesh.rotateY(.002),g.mesh.rotateY(.02),y.mesh.rotateY(.018),x.mesh.rotateY(.04),_.mesh.rotateY(.038),b.mesh.rotateY(.03),w.mesh.rotateY(.032),M.mesh.rotateY(.008),v.obj.rotateY(.04),m.obj.rotateY(.015),g.obj.rotateY(.01),y.obj.rotateY(.008),x.obj.rotateY(.002),_.obj.rotateY(9e-4),b.obj.rotateY(4e-4),w.obj.rotateY(1e-4),M.obj.rotateY(7e-5),e.current.render(t.current,i.current)}e.current.setAnimationLoop(P);const I=()=>{i.current.aspect=window.innerWidth/window.innerHeight,i.current.updateProjectionMatrix(),e.current.setSize(window.innerWidth,window.innerHeight)};window.addEventListener("resize",I);function D(B){B.preventDefault()}e.current.domElement.addEventListener("gesturechange",D,!1);const L=B=>{B.preventDefault()};return e.current.domElement.addEventListener("mousewheel",L,!1),()=>{window.removeEventListener("resize",I),e.current.domElement.removeEventListener("gesturechange",D),e.current.domElement.removeEventListener("mousewheel",L),p.geometry.dispose(),p.material.dispose(),v.mesh.geometry.dispose(),v.mesh.material.dispose(),m.mesh.geometry.dispose(),m.mesh.material.dispose(),g.mesh.geometry.dispose(),g.mesh.material.dispose(),y.mesh.geometry.dispose(),y.mesh.material.dispose(),x.mesh.geometry.dispose(),x.mesh.material.dispose(),_.mesh.geometry.dispose(),_.mesh.material.dispose(),b.mesh.geometry.dispose(),b.mesh.material.dispose(),w.mesh.geometry.dispose(),w.mesh.material.dispose(),M.mesh.geometry.dispose(),M.mesh.material.dispose(),e.current.dispose()}},[])});const oCe={visible:{opacity:1,scale:1.25,transition:{duration:.45}},hidden:{opacity:0,scale:1}};function lCe(){const e=ze.useRef(null),{scrollYProgress:t}=SY({target:e,offset:["start end","end start"]});return T5(t,i=>i>=1?"sticky":"absolute"),T5(t,i=>i>=1?"20%":"0"),ee.jsxs("div",{className:"snap-start mt-32 w-full mx-auto flex flex-col gap-14 items-center mb-[25vh]",children:[ee.jsx("p",{className:" text-[51px] font-medium tracking-[-1.12px]",children:"Chatbot that"}),ee.jsx("p",{className:" font-normal text-center max-w-[605px] text-[22px]",children:"Designed to the last pixel and engineered with unforgiving precision, Linear combines UI elegance with world-class performance."}),ee.jsx("div",{className:" bgforthis  h-[150vh] origin-center  mx-auto w-full relative flex justify-center",children:ee.jsx(cr.img,{variants:oCe,initial:"hidden",whileInView:"visible",src:jn.ArtificiumChatbox,alt:"",className:" mt-12 z-30 mx-auto lw-[100%] tablet: w-[80%] h-[85vh] sticky top-[15%] "})})]})}const cCe={visible:e=>({opacity:1,y:0,transition:{delay:.5*e}}),hidden:{opacity:0,y:100}},hCe=[{title:"Connect",label:"Connect chains",description:"Grow the economy of your chain by connecting to Cosmos Hub services using IBC protocol.",logo:jn.connectlogo},{title:"Integrate",label:"Provide services",description:"Get support to bring users to the Interchain by providing services such as exchanges, wallets, and more.",logo:jn.integratelogo},{title:"Validate",label:"Become a validator",description:"Join the ranks of trusted and decentralized validator operators in the network and help secure Cosmos Hub.",logo:jn.validatelogo}];function uCe(){const[e,t]=ze.useState({x:0,y:0}),i=n=>{const{clientX:r,clientY:s}=n;t({x:r,y:s})};return ze.useEffect(()=>(window.addEventListener("mousemove",i),()=>{window.removeEventListener("mousemove",i)}),[]),ee.jsxs("div",{className:"snap-center min-h-[100vh] mt-[50vh] ltablet:mt-[25vh]  tablet:flex items-center justify-between mx-auto relative bghere overflow-hidden ",children:[ee.jsx("div",{id:"blob",style:{left:`${e.x}px`,top:`${e.y}px`}}),ee.jsx("div",{id:"blur"}),ee.jsx("div",{className:"absolute h-[20vh] top-0 translate-y-[-50%] w-full bg-gradient-to-b from-[#000000] to-transparent from-70% z-50 blur-sm border border-transparent"}),ee.jsx("div",{className:"z-[99999] w-[80%] h-[100vh] tablet:flex items-center justify-between mx-auto",children:hCe.map((n,r)=>ee.jsxs(cr.div,{variants:cCe,initial:"hidden",whileInView:"visible",custom:r,className:"max-w-[271px] h-[100vh] tablet:h-fit mb-12 tablet:mb-0",children:[ee.jsx("p",{className:" font-semibold text-[13px] text-[#808181]",children:n.title}),ee.jsxs("div",{className:" mt-[62.33px]",children:[ee.jsxs("h1",{className:" font-bold text-[27.43px] tracking-[-0.73px] flex gap-4",children:[n.label,ee.jsx("svg",{width:"13",height:"13",viewBox:"0 0 13 13",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:ee.jsx("path",{d:"M2.28863 12.3882L0.478813 10.5784L8.11941 2.93022H2.3795L2.39464 0.461607H12.3978V10.4724H9.91408L9.92922 4.74004L2.28863 12.3882Z",fill:"white"})})]}),ee.jsx("p",{className:" mt-4 font-light text-base",children:n.description}),ee.jsx("img",{src:n.logo,alt:"",className:" mt-16"})]})]},r))}),ee.jsx("div",{className:"absolute h-[20vh] bottom-0 translate-y-[50%] w-full bg-gradient-to-t from-[#000000] to-transparent from-70% z-50 blur-sm border border-transparent"})]})}const AL={visible:{opacity:1,x:0,transition:{delay:.25}},hidden:{opacity:0,x:-100}},TL={visible:{opacity:1,y:0,transition:{delay:.5}},hidden:{opacity:0,y:100}};function dCe(){return ee.jsxs("div",{className:"snap-start mt-[25vh] flex flex-col items-center max-w-[95%] mx-auto",children:[ee.jsx("h1",{className:" text-center max-w-[445px] font-medium text-[51px] tracking-[-1.12px] leading-[56px]",children:"Unlike any tool you’ve used before"}),ee.jsx("p",{className:" mt-[27px] max-w-[605px] text-center font-normal text-[22px] leading-[28.6px] text-[#B4BCD0]",children:"Designed to the last pixel and engineered with unforgiving precision, Linear combines UI elegance with world-class performance."}),ee.jsxs("div",{className:" mx-auto mt-[138px] max-w-[100%] w-[90%]",children:[ee.jsxs("div",{className:"flex flex-col tablet:flex-row justify-between gap-4 ",children:[ee.jsx(cr.img,{variants:AL,initial:"hidden",whileInView:"visible",src:jn.unlikelefttop,alt:"",className:" max-h-[90vh]"}),ee.jsx(cr.img,{variants:TL,initial:"hidden",whileInView:"visible",src:jn.unlikerighttop,alt:"",className:" max-h-[90vh]"})]}),ee.jsxs("div",{className:"flex flex-col tablet:flex-row justify-between gap-4 mt-4 tablet:mt-[32.13px] ",children:[ee.jsx(cr.img,{variants:AL,initial:"hidden",whileInView:"visible",src:jn.unlikebottomleft,alt:"",className:" max-h-[90vh]"}),ee.jsx(cr.img,{variants:TL,initial:"hidden",whileInView:"visible",src:jn.unlikebottomright,alt:"",className:" max-h-[90vh]"})]})]})]})}const pCe={visible:{opacity:1,x:0,transition:{delay:.25}},hidden:{opacity:0,x:-100}};function PL(){return ee.jsxs(cr.div,{variants:pCe,initial:"hidden",whileInView:"visible",className:"flex flex-col justify-between max-w-[323px] h-[358px]  py-[41.31px] px-[32.34px] rounded-[20px] border-x border-y bg-opacity-[0.13] bg-gradient-to-tr from-transparent via-[#3B3B3B] to-transparent from-[20%] via-[100%] to-[100%] ",children:[ee.jsx("p",{className:" font-semibold text-[13px] tracking-[1.04px] text-[#9A9A9A]",children:"WRAPPED ETH / BTC"}),ee.jsxs("div",{className:" mt-[47.52px] mb-[87.98px] font-extrabold text-[36.9px] tracking-[-1.42px] leading-[47.3px]",children:[ee.jsx("p",{children:"+ Ethereum."}),ee.jsx("p",{children:"+ Bitcoin."})]}),ee.jsx("p",{className:" font-light text-base text-[#959595]",children:"Coming soon"})]})}const fCe={visible:{opacity:1,y:0,transition:{delay:.5}},hidden:{opacity:0,y:100}};function DL(){return ee.jsx(cr.div,{variants:fCe,initial:"hidden",whileInView:"visible",children:ee.jsxs("div",{className:"flex flex-col justify-between tablet:max-w-[677.34px] tablet:w-[600px]  max-w-[323px] h-[358px]  py-[41.31px] px-[32.34px] rounded-[20px] border-x border-y bg-opacity-[0.13] bg-gradient-to-tr from-transparent via-[#3B3B3B] to-transparent from-[20%] via-[100%] to-[100%] ",children:[ee.jsx("p",{className:" font-semibold text-[13px] tracking-[1.04px] text-[#9A9A9A]",children:"WRAPPED ETH / BTC"}),ee.jsxs("div",{className:" mt-[47.52px] mb-[87.98px] font-extrabold text-[36.9px] tracking-[-1.42px] leading-[47.3px]",children:[ee.jsx("p",{children:"+ Ethereum."}),ee.jsx("p",{children:"+ Bitcoin."})]}),ee.jsx("p",{className:" font-light text-base text-[#959595]",children:"Coming soon"})]})})}function mCe(){const e=t=>{t.preventDefault()};return ee.jsxs("div",{className:"snap-start mx-auto flex flex-col items-center mt-[50vh] max-w-[90%] relative",children:[ee.jsx("video",{src:qx.exchangevid,autoPlay:!0,loop:!0,muted:!0,controls:!1,onContextMenu:e,className:" absolute w-full h-[85%] top-[50%] translate-y-[-50%] z-[-1]"}),ee.jsxs("div",{className:"flex flex-col tablet:flex-row items-center tablet:justify-between tablet:w-[80%] gap-4 tablet:gap-0 z-10",children:[ee.jsx(PL,{}),ee.jsx(DL,{})]}),ee.jsxs("div",{className:"flex flex-col tablet:flex-row items-center tablet:justify-between tablet:w-[80%] gap-4 tablet:gap-0 mt-4 tablet:mt-[7.5vh] lmt-[87.86px]",children:[ee.jsx(DL,{}),ee.jsx(PL,{})]})]})}const gCe={visible:{opacity:1,y:0,transition:{delay:.25}},hidden:{opacity:0,y:100}},vCe={visible:{opacity:1,x:0,transition:{delay:.5}},hidden:{opacity:0,x:100}},yCe={visible:e=>({opacity:1,y:0,transition:{delay:.2*e}}),hidden:{opacity:0,y:100}};function xCe(){const e=[{logo:jn.communitychatlogo,heading:"Community Chat",description:"Ask general questions and chat with the worldwide community on Telegram."},{logo:jn.twitterlogo,heading:"Twitter",description:"Follow @cosmos to get the latest news and updates from across the ecosystem."},{logo:jn.developerchatlogo,heading:"Developer Chat",description:"Have technical questions about Cosmos tools? Ask a developer on the Community Discord."},{logo:jn.cosmosforumlogo,heading:"Cosmos Forum",description:"Thinking about becoming a validator or interested in network matters? Join the discussion."}];return ee.jsxs("div",{className:"snap-start mt-[50vh] min-h-[100vh] block tablet:flex justify-between mx-auto w-[80%] max-w-[100vw] lmax-w-[1043px]",children:[ee.jsxs(cr.div,{variants:gCe,initial:"hidden",whileInView:"visible",className:" max-w-[411px] flex flex-col gap-[34.33px]",children:[ee.jsx("h1",{className:" text-5xl tablet:text-[65.34px] font-extrabold tracking-[-3.7px] leading-[79.1px]",children:"Meet the worldwide community."}),ee.jsx("p",{className:"text-[#D1D1D2] text-[21.33px] tracking-[-0.16px]  leading-[34px] font-extralight",children:"Join a fast-growing community of developers and innovators connected all over the world, building the new era of the internet."}),ee.jsxs("h1",{className:" font-semibold text-[20.33px] tracking-[-0.36px] leading-[27.4px] flex gap-4",children:["Community",ee.jsx("svg",{width:"13",height:"13",viewBox:"0 0 13 13",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:ee.jsx("path",{d:"M2.28863 12.3882L0.478813 10.5784L8.11941 2.93022H2.3795L2.39464 0.461607H12.3978V10.4724H9.91408L9.92922 4.74004L2.28863 12.3882Z",fill:"white"})})]})]}),ee.jsx(cr.div,{variants:vCe,initial:"hidden",whileInView:"visible",className:" mt-[25vh] tablet:mt-0 max-w-[447.67px] flex  flex-col gap-16",children:e.map((t,i)=>ee.jsxs(cr.div,{variants:yCe,initial:"hidden",whileInView:"visible",custom:i,className:" flex  gap-[44.63px]",children:[ee.jsx("div",{children:ee.jsx("img",{src:t.logo,alt:"",className:" min-h-[32px] min-w-[32px]"})}),ee.jsxs("div",{children:[ee.jsxs("h1",{className:" font-bold text-[20.33px] tracking-[-0.63px] leading-[27.4px] flex gap-[12.62px]",children:[t.heading,ee.jsx("svg",{width:"10",height:"10",viewBox:"0 0 13 13",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:ee.jsx("path",{d:"M2.28863 12.3882L0.478813 10.5784L8.11941 2.93022H2.3795L2.39464 0.461607H12.3978V10.4724H9.91408L9.92922 4.74004L2.28863 12.3882Z",fill:"white"})})]}),ee.jsx("p",{className:" mt-[9px] font-light text-[#808081] text-base",children:t.description})]})]},i))})]})}function _Ce(){return ee.jsx("div",{className:"snap-start mt-[25vh] w-full h-full",children:ee.jsxs("div",{className:" mt-[50vh] w-full flex flex-col items-center gap-[70px]",children:[ee.jsx("img",{src:jn.xailogo,alt:"",className:" h-[69px] w-[73.39px]"}),ee.jsxs("h1",{className:" font-medium text-[51px] tracking-[-0.57px] leading-[51px] text-transparent bg-clip-text bg-gradient-to-br from-[#F6F6F6] via-[#A4A4A5] to-[#F3F3F3] text-center",children:[ee.jsx("p",{children:"Built for the future."}),ee.jsx("p",{children:"Available today."})]}),ee.jsxs("div",{className:"flex items-center text-base font-medium leading-[24.5px] w-full max-w-[331.05px] justify-between",children:[ee.jsx("button",{className:" bg-gradient-to-r from-[#455EB5] from-50% via-[#6040D2] to-[#673FD7] px-6 py-3 rounded-full whitespace-nowrap",children:"Sign up for free"}),ee.jsxs("button",{className:"flex items-center px-6 py-3 rounded-full gap-2 bg-[#1A191C] border border-[#252427] whitespace-nowrap",children:[ee.jsxs("svg",{width:"17",height:"17",viewBox:"0 0 17 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[ee.jsx("path",{d:"M8.18333 2.26001H2.49536V7.94774H8.18333V2.26001Z",fill:"#F3F4F7"}),ee.jsx("path",{d:"M14.4958 2.26001H8.80786V7.94773H14.4958V2.26001Z",fill:"#F3F4F7"}),ee.jsx("path",{d:"M8.18333 8.57227H2.49536V14.26H8.18333V8.57227Z",fill:"#F3F4F7"}),ee.jsx("path",{d:"M14.4958 8.57251H8.80786V14.2602H14.4958V8.57251Z",fill:"#F3F4F7"})]}),ee.jsx("span",{className:"leading-[24.5px] pb-[2px]",children:" Download"})]})]})]})})}function bCe(){return ee.jsxs("div",{className:"flex gap-4 items-center",children:[ee.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[ee.jsx("g",{"clip-path":"url(#clip0_36_761)",children:ee.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M23 0.000976563H1C0.734784 0.000976563 0.48043 0.106333 0.292893 0.29387C0.105357 0.481406 0 0.73576 0 1.00098V23.001C0 23.2662 0.105357 23.5205 0.292893 23.7081C0.48043 23.8956 0.734784 24.001 1 24.001H23C23.2652 24.001 23.5196 23.8956 23.7071 23.7081C23.8946 23.5205 24 23.2662 24 23.001V1.00098C24 0.73576 23.8946 0.481406 23.7071 0.29387C23.5196 0.106333 23.2652 0.000976564 23 0.000976563ZM19.938 5.68698L18.651 6.92098C18.5966 6.96244 18.5545 7.01798 18.5293 7.08159C18.5041 7.1452 18.4967 7.21449 18.508 7.28198V16.35C18.4967 16.4175 18.5041 16.4867 18.5293 16.5504C18.5545 16.614 18.5966 16.6695 18.651 16.711L19.908 17.945V18.216H13.586V17.945L14.886 16.681C15.014 16.553 15.014 16.515 15.014 16.32V8.99098L11.393 18.191H10.904L6.691 8.99098V15.154C6.67366 15.2818 6.68562 15.4118 6.72599 15.5343C6.76636 15.6568 6.83407 15.7685 6.924 15.861L8.618 17.915V18.186H3.818V17.915L5.509 15.861C5.5982 15.7685 5.6644 15.6563 5.70227 15.5335C5.74014 15.4107 5.74861 15.2807 5.727 15.154V8.02798C5.73727 7.93061 5.72452 7.83219 5.68978 7.74065C5.65504 7.64911 5.59929 7.56701 5.527 7.50098L4.019 5.68698V5.41598H8.693L12.306 13.34L15.482 5.41598H19.938V5.68698Z",fill:"#8D8D8E"})}),ee.jsx("defs",{children:ee.jsx("clipPath",{id:"clip0_36_761",children:ee.jsx("rect",{width:"24",height:"24",fill:"white"})})})]}),ee.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:ee.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M24 4.60078C23.1 5.00078 22.2 5.30078 21.2 5.40078C22.2 4.80078 23 3.80078 23.4 2.70078C22.4 3.30078 21.4 3.70078 20.3 3.90078C19.4 2.90078 18.1 2.30078 16.7 2.30078C14 2.30078 11.8 4.50078 11.8 7.20078C11.8 7.60078 11.8 8.00078 11.9 8.30078C7.7 8.10078 4.1 6.10078 1.7 3.10078C1.2 3.90078 1 4.70078 1 5.60078C1 7.30078 1.9 8.80078 3.2 9.70078C2.4 9.70078 1.6 9.50078 1 9.10078C1 9.10078 1 9.10078 1 9.20078C1 11.6008 2.7 13.6008 4.9 14.0008C4.5 14.1008 4.1 14.2008 3.6 14.2008C3.3 14.2008 3 14.2008 2.7 14.1008C3.3 16.1008 5.1 17.5008 7.3 17.5008C5.6 18.8008 3.5 19.6008 1.2 19.6008C0.8 19.6008 0.4 19.6008 0 19.5008C2.2 20.9008 4.8 21.7008 7.5 21.7008C16.6 21.7008 21.5 14.2008 21.5 7.70078C21.5 7.50078 21.5 7.30078 21.5 7.10078C22.5 6.40078 23.3 5.50078 24 4.60078Z",fill:"#8D8D8E"})}),ee.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:ee.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M24 11.8009C24 10.2009 22.7 8.90088 21.1 8.90088C20.4 8.90088 19.8 9.10088 19.3 9.50088C17.5 8.40088 15.3 7.70088 12.9 7.60088L14.1 3.70088L17.5 4.50088C17.6 5.70088 18.6 6.70088 19.9 6.70088C21.2 6.70088 22.3 5.60088 22.3 4.30088C22.3 3.00088 21.2 1.90088 19.9 1.90088C19 1.90088 18.2 2.40088 17.8 3.20088L13.8 2.30088C13.5 2.20088 13.1 2.40088 13 2.70088L11.5 7.60088C9 7.70088 6.5 8.30088 4.7 9.50088C4.2 9.10088 3.6 8.90088 2.9 8.90088C1.3 8.90088 0 10.2009 0 11.8009C0 12.8009 0.5 13.7009 1.2 14.2009C1.2 14.4009 1.2 14.7009 1.2 14.9009C1.2 16.9009 2.4 18.7009 4.5 20.1009C6.5 21.4009 9.2 22.1009 12 22.1009C14.8 22.1009 17.5 21.4009 19.5 20.1009C21.6 18.7009 22.8 16.9009 22.8 14.9009C22.8 14.7009 22.8 14.5009 22.8 14.3009C23.5 13.7009 24 12.8009 24 11.8009ZM20 3.20088C20.6 3.20088 21.1 3.70088 21.1 4.30088C21.1 4.90088 20.6 5.40088 20 5.40088C19.4 5.40088 18.9 4.90088 18.9 4.30088C18.9 3.70088 19.4 3.20088 20 3.20088ZM6.8 13.6009C6.8 12.7009 7.6 12.0009 8.4 12.0009C9.3 12.0009 10 12.8009 10 13.6009C10 14.4009 9.3 15.2009 8.4 15.2009C7.6 15.2009 6.8 14.5009 6.8 13.6009ZM16 18.3009C15.2 19.1009 13.9 19.5009 12.1 19.5009C10.3 19.5009 9 19.1009 8.2 18.3009C7.9 18.0009 7.9 17.6009 8.2 17.4009C8.5 17.1009 8.9 17.1009 9.1 17.4009C9.7 18.0009 10.7 18.3009 12.1 18.3009C13.5 18.3009 14.5 18.0009 15.1 17.4009C15.4 17.1009 15.8 17.1009 16 17.4009C16.2 17.7009 16.2 18.1009 16 18.3009ZM15.6 15.2009C14.7 15.2009 13.9 14.5009 13.9 13.6009C13.9 12.7009 14.7 12.0009 15.6 12.0009C16.5 12.0009 17.2 12.8009 17.2 13.6009C17.2 14.4009 16.5 15.2009 15.6 15.2009Z",fill:"#8D8D8E"})}),ee.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[ee.jsx("g",{"clip-path":"url(#clip0_36_770)",children:ee.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M23.9528 2.52809C23.9334 2.43947 23.8909 2.35756 23.8296 2.29065C23.7683 2.22375 23.6904 2.17422 23.6038 2.14709C23.2885 2.08464 22.9622 2.10777 22.6588 2.21409C22.6588 2.21409 1.62985 9.77309 0.428846 10.6101C0.170846 10.7901 0.0838457 10.8951 0.0408457 11.0181C-0.167154 11.6181 0.479846 11.8761 0.479846 11.8761L5.89985 13.6421C5.99149 13.6585 6.08573 13.653 6.17485 13.6261C7.40685 12.8471 18.5748 5.79209 19.2238 5.55509C19.3238 5.52509 19.4008 5.55509 19.3808 5.63009C19.1228 6.53509 9.47185 15.1081 9.41885 15.1601C9.39303 15.1812 9.37292 15.2085 9.36034 15.2394C9.34777 15.2703 9.34313 15.3039 9.34685 15.3371L8.84085 20.6291C8.84085 20.6291 8.62885 22.2761 10.2758 20.6291C11.4438 19.4601 12.5648 18.4921 13.1248 18.0211C14.9888 19.3081 16.9938 20.7311 17.8588 21.4761C18.0043 21.6169 18.1767 21.727 18.3657 21.7997C18.5547 21.8723 18.7565 21.9062 18.9588 21.8991C19.208 21.8687 19.4421 21.7632 19.6298 21.5965C19.8176 21.4298 19.9501 21.2099 20.0098 20.9661C20.0098 20.9661 23.8398 5.54309 23.9678 3.47709C23.9808 3.27709 23.9978 3.14509 23.9998 3.00609C24.0061 2.84536 23.9902 2.68453 23.9528 2.52809Z",fill:"#8D8D8E"})}),ee.jsx("defs",{children:ee.jsx("clipPath",{id:"clip0_36_770",children:ee.jsx("rect",{width:"24",height:"24",fill:"white",transform:"translate(-0.000244141)"})})})]}),ee.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[ee.jsx("g",{"clip-path":"url(#clip0_36_773)",children:ee.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M19.54 0C20.896 0 22 1.104 22 2.472V24L19.42 21.72L17.968 20.376L16.432 18.948L17.068 21.168H3.46C2.104 21.168 1 20.064 1 18.696V2.472C1 1.104 2.104 0 3.46 0L19.54 0ZM14.908 15.672C17.56 15.588 18.58 13.848 18.58 13.848C18.58 9.984 16.852 6.852 16.852 6.852C15.124 5.556 13.48 5.592 13.48 5.592L13.312 5.784C15.352 6.408 16.3 7.308 16.3 7.308C15.052 6.624 13.828 6.288 12.688 6.156C11.824 6.06 10.996 6.084 10.264 6.18L10.06 6.204C9.64 6.24 8.62 6.396 7.336 6.96C6.892 7.164 6.628 7.308 6.628 7.308C6.628 7.308 7.624 6.36 9.784 5.736L9.664 5.592C9.664 5.592 8.02 5.556 6.292 6.852C6.292 6.852 4.564 9.984 4.564 13.848C4.564 13.848 5.572 15.588 8.224 15.672C8.224 15.672 8.668 15.132 9.028 14.676C7.504 14.22 6.928 13.26 6.928 13.26L7.264 13.464L7.312 13.5L7.359 13.527L7.373 13.533L7.42 13.56C7.72 13.728 8.02 13.86 8.296 13.968C8.788 14.16 9.376 14.352 10.06 14.484C10.96 14.652 12.016 14.712 13.168 14.496C13.732 14.4 14.308 14.232 14.908 13.98C15.328 13.824 15.796 13.596 16.288 13.272C16.288 13.272 15.688 14.256 14.116 14.7C14.476 15.156 14.908 15.672 14.908 15.672ZM9.328 10.068C8.644 10.068 8.104 10.668 8.104 11.4C8.104 12.132 8.656 12.732 9.328 12.732C10.012 12.732 10.552 12.132 10.552 11.4C10.564 10.668 10.012 10.068 9.328 10.068ZM13.708 10.068C13.024 10.068 12.484 10.668 12.484 11.4C12.484 12.132 13.036 12.732 13.708 12.732C14.392 12.732 14.932 12.132 14.932 11.4C14.932 10.668 14.392 10.068 13.708 10.068Z",fill:"#8D8D8E"})}),ee.jsx("defs",{children:ee.jsx("clipPath",{id:"clip0_36_773",children:ee.jsx("rect",{width:"24",height:"24",fill:"white"})})})]}),ee.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:ee.jsx("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M23.8 7.20107C23.8 7.20107 23.6 5.50107 22.8 4.80107C21.9 3.80107 20.9 3.80107 20.4 3.80107C17 3.60107 12 3.60107 12 3.60107C12 3.60107 7 3.60107 3.6 3.80107C3.1 3.90107 2.1 3.90107 1.2 4.80107C0.5 5.50107 0.2 7.20107 0.2 7.20107C0.2 7.20107 0 9.10107 0 11.1011V12.9011C0 14.8011 0.2 16.8011 0.2 16.8011C0.2 16.8011 0.4 18.5011 1.2 19.2011C2.1 20.2011 3.3 20.1011 3.8 20.2011C5.7 20.4011 12 20.4011 12 20.4011C12 20.4011 17 20.4011 20.4 20.1011C20.9 20.0011 21.9 20.0011 22.8 19.1011C23.5 18.4011 23.8 16.7011 23.8 16.7011C23.8 16.7011 24 14.8011 24 12.8011V11.0011C24 9.10107 23.8 7.20107 23.8 7.20107ZM9.5 15.1011V8.40107L16 11.8011L9.5 15.1011Z",fill:"#8D8D8E"})})]})}function wCe(){return ee.jsx("footer",{className:"snap-start w-[95%] h-full mx-auto mt-[25vh] mb-[3px] p-[1.1px] bg-gradient-to-tr from-[#FFFFFF]  to-[#353436] rounded-[37.39px]  ",children:ee.jsxs("div",{className:" min-h-fit lpt-[68px] py-[26.167px] px-[5%] tablet:px-[88px] bg-gradient-to-tr from-[#0D0C0F] to-[#222124] rounded-[37.39px] relative flex flex-col gap-[74px]",children:[ee.jsx("img",{src:jn.footervector,alt:"",className:"absolute right-0 top-0"}),ee.jsxs("div",{className:" flex w-[40%] justify-between",children:[ee.jsxs("div",{children:[ee.jsx("h3",{className:" font-medium text-[10px] text-[#5E5E61]",children:"COMPANY"}),ee.jsxs("ul",{className:" mt-4 text-[13px] font-normal flex flex-col gap-[7.5px] text-[#A9AAAD]",children:[ee.jsx("li",{children:"About"}),ee.jsx("li",{children:"Customers"}),ee.jsx("li",{children:"Blog"}),ee.jsx("li",{children:"Deploy"}),ee.jsx("li",{children:"Newsroom"})]})]}),ee.jsxs("div",{children:[ee.jsx("h3",{className:" font-medium text-[10px] text-[#5E5E61]",children:"RESOURCES"}),ee.jsxs("ul",{className:" mt-4 text-[13px] font-normal flex flex-col gap-[7.5px] text-[#A9AAAD]",children:[ee.jsx("li",{children:"FAQs"}),ee.jsx("li",{children:"Careers"}),ee.jsx("li",{children:"Partnerships"}),ee.jsx("li",{children:"Contact Us"}),ee.jsx("li",{children:"Changelog"}),ee.jsx("li",{children:"Sign up for The Recap"})]})]})]}),ee.jsx("hr",{className:"h-px bg-[#2B2B2D] border-0"}),ee.jsxs("div",{children:[ee.jsxs("div",{className:" tablet:flex gap-4 justify-between",children:[ee.jsx("img",{src:jn.cosmoslogo,alt:"",className:" border-r pr-6 border-[#2A292B] mb-4 tablet:mb-0"}),ee.jsx(bCe,{})]}),ee.jsxs("div",{className:" mt-[59.44px]",children:[ee.jsxs("p",{className:" font-light text-[13px] tracking-[0.05px] text-[#888789]",children:["Cosmos is a registered trademark of the"," ",ee.jsx("span",{className:" text-white",children:"Interchain Foundation."})]}),ee.jsx("p",{className:" pt-[22.99px] font-light text-[13px] text-[#888789] tracking-[0.05px] leading-[21.1px]",children:"This website is maintained by the Interchain Foundation (ICF) on behalf of the decentralized community. The contents and opinions of this website do not necessarily reflect those of the ICF. This website links to projects, dApps and cryptocurrency exchanges as a service to the public. The ICF does not warrant that the information provided by these websites is correct, complete, and up-to-date. The ICF is not responsible for the content of those websites and expressly rejects any liability for damages of any kind resulting from the use, reference to, or reliance on any information contained within these websites. If you spot an error or issue on this website, please email marketing-[at]-interchain.io"})]})]})]})})}function SCe(){const e=t=>{t.preventDefault()};return ee.jsxs("div",{className:"w-full relative snap-mandatory snap-y scroll-smooth",children:[ee.jsx(WY,{}),ee.jsx(CY,{}),ee.jsx(m2e,{}),ee.jsx(lCe,{}),ee.jsx(uCe,{}),ee.jsx(dCe,{}),ee.jsx(mCe,{}),ee.jsx(xCe,{}),ee.jsxs("div",{className:"relative my-[25vh] h-[100vh]",children:[ee.jsx("div",{className:"absolute h-[20vh] top-0 translate-y-[-50%] w-full bg-gradient-to-b from-[#000000] to-transparent from-70% z-50 blur-sm border border-transparent"}),ee.jsx("video",{src:qx.unstablepage,autoPlay:!0,loop:!0,muted:!0,controls:!1,onContextMenu:e,className:" absolute w-full h-[100vh] lw-[100vw] object-cover  z-[-1]"}),ee.jsx("div",{className:"absolute h-[20vh] bottom-0 translate-y-[50%] w-full bg-gradient-to-t from-[#000000] to-transparent from-70% z-50 blur-sm border border-transparent"})]}),ee.jsx(_Ce,{}),ee.jsx(wCe,{})]})}function MCe(){return ee.jsx(ee.Fragment,{children:ee.jsx(LG,{children:ee.jsx(KI,{path:"/",element:ee.jsx(SCe,{})})})})}Xw.createRoot(document.getElementById("root")).render(ee.jsx(zp.StrictMode,{children:ee.jsx(IG,{children:ee.jsx(MCe,{})})}))});export default CCe();
